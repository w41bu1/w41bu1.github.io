<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-11368 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress LearnPress Plugin."><meta name="keywords" content='analyst, plugin, broken access control'>
  <meta itemprop="name" content="CVE-2025-11368 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress LearnPress Plugin.">
  <meta itemprop="datePublished" content="2025-12-11T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-12-09T16:14:46+07:00">
  <meta itemprop="wordCount" content="1680">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg">
  <meta itemprop="keywords" content="Analyst,Plugin,Broken Access Control"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-11368 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress LearnPress Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-11T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-12-09T16:14:46+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Broken Access Control">
    <meta property="og:image" content="http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg">
  <meta name="twitter:title" content="CVE-2025-11368 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress LearnPress Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/" title="CVE-2025-11368 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-12-10-cve-2025-11815/" title="CVE-2025-11815 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2025-12-12-cve-2025-66072/" title="CVE-2025-66072 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/index.md" title="CVE-2025-11368 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-11368 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-12-11-cve-2025-11368\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, broken access control","wordcount":  1680 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-12-11-cve-2025-11368\/","datePublished": "2025-12-11T19:00:00+07:00","dateModified": "2025-12-09T16:14:46+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress LearnPress Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-12-11-cve-2025-11368/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-12-11-cve-2025-11368/">English</option><option value="/vi/posts/2025-12-11-cve-2025-11368/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-12-13-cve-2025-12174/" title="CVE-2025-12174 Analysis &amp; POC">CVE-2025-12174 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-12-cve-2025-66072/" title="CVE-2025-66072 Analysis &amp; POC">CVE-2025-66072 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-10-cve-2025-11815/" title="CVE-2025-11815 Analysis &amp; POC">CVE-2025-11815 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-09-cve-2025-64384/" title="CVE-2025-64384 Analysis &amp; POC">CVE-2025-64384 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-08-cve-2025-12887/" title="CVE-2025-12887 Analysis &amp; POC">CVE-2025-12887 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-07-cve-2025-11726/" title="CVE-2025-11726 Analysis &amp; POC">CVE-2025-11726 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-06-cve-2024-11600/" title="CVE-2024-11600 Analysis &amp; POC">CVE-2024-11600 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-05-cve-2025-48140/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-04-cve-2024-8672/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-03-cve-2025-30911/" title="CVE-2025-30911 Analysis &amp; POC">CVE-2025-30911 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-11368 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-12-11 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-11">2025-12-11</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-09 16:14:46"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-09">2025-12-09</time></span>&nbsp;<span title="1680 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1700 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>8 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-12-11-cve-2025-11368/app.jpg' alt="/posts/2025-12-11-cve-2025-11368/app.jpg"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>LearnPress – WordPress LMS Plugin</strong> cho <strong>WordPress</strong> tồn tại lỗ hổng <strong>Sensitive Information Disclosure</strong> trong tất cả các phiên bản cho đến, và bao gồm, <strong>4.2.9.4</strong>. Nguyên nhân là do thiếu <strong>capability checks</strong> trong <strong>REST endpoint</strong> <strong>/wp-json/lp/v1/load_content_via_ajax</strong> cho phép thực thi <strong>arbitrary callback</strong> của các <strong>admin-only template methods</strong>. Điều này khiến <strong>unauthenticated attackers</strong> có thể lấy được <strong>admin curriculum HTML</strong>, <strong>quiz questions with correct answers</strong>, <strong>course materials</strong>, và các <strong>sensitive educational content</strong> khác thông qua <strong>REST API endpoint</strong> nếu họ cung cấp được <strong>valid numeric IDs</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-11368"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-11368</a></li>
<li><strong>Vulnerability Type</strong>: Broken Access Control</li>
<li><strong>Affected Versions</strong>: &lt;= 4.2.9.4</li>
<li><strong>Patched Versions</strong>: 4.3.0</li>
<li><strong>CVSS severity</strong>: Low (5.3)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/learnpress/"target="_blank" rel="external nofollow noopener noreferrer">WordPress LearnPress Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>LearnPress</strong>:
<ul>
<li><code>4.2.9.4</code> – <strong>vulnerable</strong></li>
<li><code>4.3.0</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký REST API:</p>
<div class="highlight" title="class-lp-rest-ajax-controller.php v4.2.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="hl"><span class="lnt"> 3
</span></span><span class="hl"><span class="lnt"> 4
</span></span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="hl"><span class="lnt">14
</span></span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="hl"><span class="lnt">20
</span></span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LP_REST_AJAX_Controller</span> <span class="k">extends</span> <span class="nx">LP_Abstract_REST_Controller</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">namespace</span> <span class="o">=</span> <span class="s1">&#39;lp/v1&#39;</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">rest_base</span> <span class="o">=</span> <span class="s1">&#39;load_content_via_ajax&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">public</span> <span class="k">function</span> <span class="nf">register_routes</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">routes</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="s1">&#39;/&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">				<span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">					<span class="s1">&#39;methods&#39;</span>             <span class="o">=&gt;</span> <span class="nx">WP_REST_Server</span><span class="o">::</span><span class="na">ALLMETHODS</span><span class="p">,</span>
</span></span><span class="line hl"><span class="cl">					<span class="s1">&#39;callback&#39;</span>            <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;get_content&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">					<span class="s1">&#39;permission_callback&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;__return_true&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">				<span class="p">),</span>
</span></span><span class="line"><span class="cl">			<span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">		<span class="k">parent</span><span class="o">::</span><span class="na">register_routes</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Trong đoạn mã trên, <strong>class LP_REST_AJAX_Controller</strong> kế thừa từ <strong>LP_Abstract_REST_Controller</strong> và được sử dụng để đăng ký một <strong>REST API endpoint</strong> cho plugin <strong>LearnPress</strong>.</p>
<ul>
<li>
<p><strong>__construct()</strong>:</p>
<ul>
<li>Thiết lập <strong>namespace</strong> là <code>lp/v1</code>.</li>
<li>Thiết lập <strong>rest_base</strong> là <code>load_content_via_ajax</code>.</li>
<li>Gọi lại <strong>parent::__construct()</strong> để kế thừa các thiết lập từ lớp cha.</li>
</ul>
</li>
<li>
<p><strong>register_routes()</strong>:</p>
<ul>
<li>Khai báo một route <code>/</code> với các đặc điểm:
<ul>
<li><strong>methods</strong>: chấp nhận tất cả các phương thức HTTP (<strong>WP_REST_Server::ALLMETHODS</strong>).</li>
<li><strong>callback</strong>: gọi hàm <code>get_content</code>.</li>
<li><strong>permission_callback</strong>: luôn trả về <code>true</code>, tức là <strong>không có kiểm tra quyền hạn</strong>.</li>
</ul>
</li>
<li>Sau đó gọi lại <strong>parent::register_routes()</strong> để hoàn tất việc đăng ký.</li>
</ul>
</li>
</ul>
<div class="highlight" title="abstract-rest-controller.php v4.2.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="hl"><span class="lnt">18
</span></span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">register_routes</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">routes</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">routes</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$args</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$rest_base</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">rest_base</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$override</span>  <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_bool</span><span class="p">(</span> <span class="nx">end</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$override</span> <span class="o">=</span> <span class="nx">array_pop</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">is_numeric</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$rest_base</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">{</span><span class="nv">$rest_base</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nv">$key</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">    <span class="nx">register_rest_route</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">namespace</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$rest_base</span><span class="p">,</span> <span class="nv">$args</span><span class="p">,</span> <span class="nv">$override</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Như vậy, API này có endpoint: <code>/wp-json/lp/v1/load_content_via_ajax</code>, callback <code>get_content</code> sẽ được gọi để xử lý request đến.</p>
<div class="highlight" title="class-lp-rest-ajax-controller.php v4.2.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="hl"><span class="lnt">13
</span></span><span class="hl"><span class="lnt">14
</span></span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="hl"><span class="lnt">25
</span></span><span class="hl"><span class="lnt">26
</span></span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="hl"><span class="lnt">30
</span></span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="hl"><span class="lnt">41
</span></span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">get_content</span><span class="p">(</span> <span class="nx">WP_REST_Request</span> <span class="nv">$request</span> <span class="p">)</span><span class="o">:</span> <span class="nx">LP_REST_Response</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LP_REST_Response</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$params</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_params</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: params invalid!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// @var array $args
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$args</span>     <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">];</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$callBack</span> <span class="o">=</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_method</span><span class="p">()</span> <span class="o">===</span> <span class="s1">&#39;GET&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$args</span>     <span class="o">=</span> <span class="nx">LP_Helper</span><span class="o">::</span><span class="na">json_decode</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;args&#39;</span><span class="p">],</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$callBack</span> <span class="o">=</span> <span class="nx">LP_Helper</span><span class="o">::</span><span class="na">json_decode</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;callback&#39;</span><span class="p">],</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$callBack</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="k">empty</span><span class="p">(</span> <span class="nv">$callBack</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: callback invalid!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">    <span class="nv">$class</span>  <span class="o">=</span> <span class="nv">$callBack</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">];</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$method</span> <span class="o">=</span> <span class="nv">$callBack</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span>   <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Security: check callback is registered.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$allow_callbacks</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;lp/rest/ajax/allow_callback&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$callBackStr</span>     <span class="o">=</span> <span class="nv">$class</span> <span class="o">.</span> <span class="s1">&#39;:&#39;</span> <span class="o">.</span> <span class="nv">$method</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">in_array</span><span class="p">(</span> <span class="nv">$callBackStr</span><span class="p">,</span> <span class="nv">$allow_callbacks</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: callback is not register!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Check class and method is callable.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_callable</span><span class="p">(</span> <span class="p">[</span> <span class="nv">$class</span><span class="p">,</span> <span class="nv">$method</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">      <span class="nv">$data</span> <span class="o">=</span> <span class="nx">call_user_func</span><span class="p">(</span> <span class="p">[</span> <span class="nv">$class</span><span class="p">,</span> <span class="nv">$method</span> <span class="p">],</span> <span class="nv">$args</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: callback is not callable!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$data</span> <span class="nx">instanceof</span> <span class="k">stdClass</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$data</span><span class="o">-&gt;</span><span class="na">content</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: data content invalid!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">status</span>  <span class="o">=</span> <span class="s1">&#39;success&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">message</span> <span class="o">=</span> <span class="s1">&#39;Success!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">data</span>    <span class="o">=</span> <span class="nv">$data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Throwable</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">status</span>  <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">message</span> <span class="o">=</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Hàm nhận <code>callback</code> và <code>args</code> từ request, decode JSON nếu là GET, kiểm tra <code>callback</code> có đủ <code>class</code> và <code>method</code>, tạo chuỗi <code>class:method</code> và đối chiếu với danh sách callback hợp lệ do filter trả về; nếu không có trong danh sách thì báo lỗi, nếu có thì kiểm tra class–method có thể gọi được và thực thi <code>call_user_func</code> với <code>$args</code>, nhận về <code>$data</code> và trả trong response.</p>
<p>Hàng loạt các callback được đăng ký cho filter <code>lp/rest/ajax/allow_callback</code> thông qua hàm <code>add_filter</code>:</p>
<p><figure><a class="lightgallery" href="/posts/2025-12-11-cve-2025-11368/filter.png" title="Đăng ký callback cho filter lp/rest/ajax/allow_callback" data-thumbnail="/posts/2025-12-11-cve-2025-11368/filter.png" data-sub-html="<h2>Filter</h2><p>Đăng ký callback cho filter lp/rest/ajax/allow_callback</p>"><img loading="lazy" src='/posts/2025-12-11-cve-2025-11368/filter.png' alt="Filter" height="948" width="793"></a><figcaption class="image-caption">Đăng ký callback cho filter lp/rest/ajax/allow_callback</figcaption>
  </figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">allow_callback</span><span class="p">(</span> <span class="k">array</span> <span class="nv">$callbacks</span> <span class="p">)</span><span class="o">:</span> <span class="k">array</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$callbacks</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">get_class</span><span class="p">(</span> <span class="nv">$this</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;:render_edit_quiz&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$callbacks</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">get_class</span><span class="p">(</span> <span class="nv">$this</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;:render_list_items_not_assign&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nv">$callbacks</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Hàm nhận mảng <code>$callbacks</code> hiện có, sau đó thêm vào hai chuỗi dạng <code>TênClass:method</code> của class hiện tại, rồi trả lại mảng đó để WordPress sử dụng làm danh sách callback hợp lệ. Khi debug, ta sẽ thấy toàn bộ các callback được đăng ký:</p>
<p><figure><a class="lightgallery" href="/posts/2025-12-11-cve-2025-11368/allow.png" title="Danh sách các callback hợp lệ" data-thumbnail="/posts/2025-12-11-cve-2025-11368/allow.png" data-sub-html="<h2>Allow</h2><p>Danh sách các callback hợp lệ</p>"><img loading="lazy" src='/posts/2025-12-11-cve-2025-11368/allow.png' alt="Allow" height="869" width="955"></a><figcaption class="image-caption">Danh sách các callback hợp lệ</figcaption>
  </figure></p>
<div class="details admonition bug open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-bug" aria-hidden="true"></i>Lỗi</div>
  <div class="details-content">
    <div class="admonition-content"><p><strong>Lỗ hổng phát sinh do API không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.</strong> Điều này cho phép mọi người dùng – kể cả không có quyền quản trị – gọi vào endpoint và yêu cầu thực thi bất kỳ callback nào nằm trong danh sách callback hợp lệ, dù những callback đó lẽ ra chỉ dành cho admin.</p></div>
  </div>
</div><p><strong>Bản vá (v4.3.0)</strong> bổ sung vào hàm <code>get_content</code> bước xác thực quyền bằng cách kiểm tra <code>X-WP-Nonce</code> gửi kèm request.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_header</span><span class="p">(</span> <span class="s1">&#39;X-WP-Nonce&#39;</span> <span class="p">),</span> <span class="s1">&#39;wp_rest&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span> <span class="s1">&#39;Error: invalid nonce!&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu nonce không hợp lệ hoặc không khớp với action <code>wp_rest</code>, request sẽ bị chặn ngay, ngăn người dùng không có quyền truy cập vào các callback vốn chỉ dành cho admin.</p>
<p><figure><a class="lightgallery" href="/posts/2025-12-11-cve-2025-11368/diff.png" title="Diff code" data-thumbnail="/posts/2025-12-11-cve-2025-11368/diff.png" data-sub-html="<h2>Diff</h2><p>Diff code</p>"><img loading="lazy" src='/posts/2025-12-11-cve-2025-11368/diff.png' alt="Diff" height="790" width="1863"></a><figcaption class="image-caption">Diff code</figcaption>
  </figure></p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD

A["Unauthenticated attacker"]
--> B["Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax"]
--> C["Request includes callback (class + method) and args (lesson, quiz, material IDs...)"]
--> D["API receives request → invokes get_content()"]
--> E["permission_callback = __return_true → no capability checks"]
--> F["get_content() validates params but performs no permission or capability validation"]
--> G["Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback"]
--> H["Callback is valid but intended for admin-only template rendering"]
--> I["API executes the method using call_user_func([class, method], args)"]
--> J["Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials"]
--> K["Sensitive data is returned to the attacker through the REST API"]

</pre>
  <pre class="mermaid-dark">
graph TD

A["Unauthenticated attacker"]
--> B["Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax"]
--> C["Request includes callback (class + method) and args (lesson, quiz, material IDs...)"]
--> D["API receives request → invokes get_content()"]
--> E["permission_callback = __return_true → no capability checks"]
--> F["get_content() validates params but performs no permission or capability validation"]
--> G["Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback"]
--> H["Callback is valid but intended for admin-only template rendering"]
--> I["API executes the method using call_user_func([class, method], args)"]
--> J["Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials"]
--> K["Sensitive data is returned to the attacker through the REST API"]

</pre>
  <pre class="mermaid-neutral">
graph TD

A["Unauthenticated attacker"]
--> B["Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax"]
--> C["Request includes callback (class + method) and args (lesson, quiz, material IDs...)"]
--> D["API receives request → invokes get_content()"]
--> E["permission_callback = __return_true → no capability checks"]
--> F["get_content() validates params but performs no permission or capability validation"]
--> G["Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback"]
--> H["Callback is valid but intended for admin-only template rendering"]
--> I["API executes the method using call_user_func([class, method], args)"]
--> J["Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials"]
--> K["Sensitive data is returned to the attacker through the REST API"]

</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD

A["Unauthenticated attacker"]
--> B["Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax"]
--> C["Request includes callback (class + method) and args (lesson, quiz, material IDs...)"]
--> D["API receives request → invokes get_content()"]
--> E["permission_callback = __return_true → no capability checks"]
--> F["get_content() validates params but performs no permission or capability validation"]
--> G["Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback"]
--> H["Callback is valid but intended for admin-only template rendering"]
--> I["API executes the method using call_user_func([class, method], args)"]
--> J["Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials"]
--> K["Sensitive data is returned to the attacker through the REST API"]

</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Gửi request với Unauthenticated user:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/lp/v1/load_content_via_ajax</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="g">callback[class]=LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&amp;callback[method]=render_list_items_not_assign&amp;args[quiz_id]=483</span></span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-12-11-cve-2025-11368/result.png" title="Kết quả" data-thumbnail="/posts/2025-12-11-cve-2025-11368/result.png" data-sub-html="<h2>Result</h2><p>Kết quả</p>"><img loading="lazy" src='/posts/2025-12-11-cve-2025-11368/result.png' alt="Result" height="807" width="1315"></a><figcaption class="image-caption">Kết quả</figcaption>
  </figure></p>
<p><strong>Danh sách các callback hợp lệ khác:</strong></p>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\ListCoursesTemplate</span><span class="o">:</span><span class="nx">render_courses</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate</span><span class="o">:</span><span class="nx">render_courses</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\SingleCourseTemplate</span><span class="o">:</span><span class="nx">render_html_comments</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate</span><span class="o">:</span><span class="nx">renderContent</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate</span><span class="o">:</span><span class="nx">render_edit_course_curriculum</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate</span><span class="o">:</span><span class="nx">render_list_items_not_assign</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Admin\AdminEditQizTemplate</span><span class="o">:</span><span class="nx">render_edit_quiz</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Admin\AdminEditQizTemplate</span><span class="o">:</span><span class="nx">render_list_items_not_assign</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate</span><span class="o">:</span><span class="nx">render_edit_question</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\TemplateHooks\Course\CourseMaterialTemplate</span><span class="o">:</span><span class="nx">render_material_items</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid</span><span class="o">:</span><span class="nx">render_courses</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList</span><span class="o">:</span><span class="nx">render_courses</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem</span><span class="o">:</span><span class="nx">render_courses</span>
</span></span><span class="line"><span class="cl"><span class="nx">LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType</span><span class="o">:</span><span class="nx">render_courses</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng xuất phát từ việc endpoint REST API <strong>không kiểm tra quyền truy cập</strong>, cho phép kẻ tấn công chưa xác thực gọi trực tiếp các callback nội bộ vốn chỉ dành cho admin. Thông qua việc cung cấp ID hợp lệ, attacker có thể truy xuất <strong>curriculum</strong>, <strong>quiz</strong>, <strong>đáp án</strong>, và các <strong>nội dung giáo trình nhạy cảm</strong>. Bản vá 4.3.0 đã khắc phục bằng cách thêm kiểm tra <strong>X-WP-Nonce</strong>, ngăn truy cập trái phép vào các callback nhạy cảm.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>permission_callback = __return_true</strong> là nguyên nhân cốt lõi dẫn đến Broken Access Control.</li>
<li>Cho phép gọi callback nội bộ mà không xác thực quyền dẫn đến <strong>lộ dữ liệu nhạy cảm</strong>.</li>
<li>Các callback LearnPress được thiết kế cho môi trường admin nhưng lại phơi bày qua API công khai.</li>
<li>Biện pháp khắc phục hiệu quả là bổ sung kiểm tra <strong>wp_verify_nonce</strong> và ràng buộc quyền truy cập.</li>
<li>REST API trong WordPress cần luôn có <strong>capability checks</strong> khi xử lý các hành động quan trọng hoặc nhạy cảm.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/"target="_blank" rel="external nofollow noopener noreferrer">Broken Access Control</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-plugin-4-2-9-4-missing-authorization-to-unauthenticated-arbitrary-callback-execution-to-information-exposure-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress LearnPress Plugin &lt;= 4.2.9.4 is vulnerable to Broken Access Control</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-12-13-cve-2025-12174/" title="CVE-2025-12174 Analysis &amp; POC">CVE-2025-12174 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-12-cve-2025-66072/" title="CVE-2025-66072 Analysis &amp; POC">CVE-2025-66072 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-10-cve-2025-11815/" title="CVE-2025-11815 Analysis &amp; POC">CVE-2025-11815 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-09-cve-2025-64384/" title="CVE-2025-64384 Analysis &amp; POC">CVE-2025-64384 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-08-cve-2025-12887/" title="CVE-2025-12887 Analysis &amp; POC">CVE-2025-12887 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-07-cve-2025-11726/" title="CVE-2025-11726 Analysis &amp; POC">CVE-2025-11726 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-06-cve-2024-11600/" title="CVE-2024-11600 Analysis &amp; POC">CVE-2024-11600 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-05-cve-2025-48140/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-04-cve-2024-8672/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-03-cve-2025-30911/" title="CVE-2025-30911 Analysis &amp; POC">CVE-2025-30911 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-12-09 16:14:46">Cập nhật ngày 2025-12-09&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/44cc1987688599b32e6a8c3d61cd517ada7ad2bd" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2025-12-11-CVE-2025-11368&#10&#10Commit: 44cc1987688599b32e6a8c3d61cd517ada7ad2bd [44cc198]&#10Author: w41bu1&#10Date: 2025-12-09 16:14:46"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>44cc198</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-12-11-cve-2025-11368/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-12-11-CVE-2025-11368%5cindex.vi.md?plain=1" title="Xem mã nguồn"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-12-11-CVE-2025-11368%5cindex.vi.md" title="Chỉnh sửa trang này"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-11368&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-11368&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-12-11-CVE-2025-11368%5cindex.vi.md?plain=1%7c" title="Báo cáo lỗi"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file/D:%5cwork%5cproject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-12-11-CVE-2025-11368%5cindex.vi.md" title="Mở trong trình chỉnh sửa"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/" data-title="CVE-2025-11368 Analysis &amp; POC" data-hashtags="analyst,plugin,broken access control"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/" data-title="CVE-2025-11368 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/broken-access-control/" class="post-tag" title="Nhãn - Broken Access Control">Broken Access Control</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-12-10-cve-2025-11815/" class="post-nav-item" rel="prev" title="CVE-2025-11815 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-11815 Analysis &amp; POC</a><a href="/vi/posts/2025-12-12-cve-2025-66072/" class="post-nav-item" rel="next" title="CVE-2025-66072 Analysis &amp; POC">CVE-2025-66072 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/64b5a7cf7f33b7cf7e34c1af6f228b00.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
