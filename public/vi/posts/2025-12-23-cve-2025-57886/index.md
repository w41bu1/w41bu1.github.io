# CVE-2025-57886 Analysis & POC


<!--more-->

## CVE & Basic Info
Lỗ hổng **bỏ qua cơ chế phân quyền (Authorization Bypass) thông qua khóa do người dùng kiểm soát** trong plugin **Equalize Digital Accessibility Checker** của **Equalize Digital** cho phép khai thác việc **cấu hình sai các mức kiểm soát truy cập**. Lỗ hổng này ảnh hưởng đến **Accessibility Checker by Equalize Digital** từ phiên bản **không xác định** đến **1.30.0**.

* **CVE ID**: [CVE-2025-57886](https://www.cve.org/CVERecord?id=CVE-2025-57886)
* **Vulnerability Type**: Insecure Direct Object References (IDOR)
* **Affected Versions**: <= 1.30.0
* **Patched Versions**: 1.30.1
* **CVSS severity**: Low (5.4)
* **Required Privilege**: Contributor
* **Product**: [WordPress Accessibility Checker by Equalize Digital Plugin](https://wordpress.org/plugins/accessibility-checker/)

## Requirements
* **Local WordPress & Debugging**
    * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
    * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version** - **Accessibility Checker by Equalize Digital**:  
    * `1.30.0` – **vulnerable**  
    * `1.30.1` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) hoặc bất kỳ công cụ diff nào.

## Analysis 
Plugin đã đăng ký REST API:

```php {title="wclass-rest-api.php v1.30.0" data-open=true hl_lines=[]}
public function init_rest_routes() {
    $ns      = 'accessibility-checker/';
    $version = 'v1';

    add_action(
        'rest_api_init',
        function () use ( $ns, $version ) {
            register_rest_route(
                $ns . $version,
                '/post-scan-results/(?P<id>\d+)',
                [
                    'methods'             => 'POST',
                    'callback'            => [ $this, 'set_post_scan_results' ],
                    'args'                => [
                        'id' => [
                            'validate_callback' => function ( $param ) {
                                return is_numeric( $param );
                            },
                        ],
                    ],
                    'permission_callback' => function () {
                        return current_user_can( 'edit_posts' );
                    },
                ]
            );
        }
    );
}
```

## Flow
{{< mermaid >}}
flowchart TD

A["Authenticated user (Contributor+)"]
--> B["Click Duplicate link or craft URL manually"]
B --> C["Request: /wp-admin/post.php?action=mptt_duplicate_event&post={target_post_id}"]
C --> D["WordPress loads post.php"]
D --> E["do_action('post_action_mptt_duplicate_event', post_id)"]
E --> F["post_action_mptt_duplicate_event(post_id)"]
F --> G["get_post(post_id) without ownership check"]
G --> H["Check nonce + current_user_can('edit_posts')"]
H --> I["Permission granted (generic capability)"]
I --> J["Duplicate target post (content, meta, taxonomy, custom table)"]
J --> K["Create new draft owned by attacker"]
K --> L["Redirect to edit screen of duplicated post"]

{{< /mermaid >}}

## Proof of Concept (PoC)


## Conclusion


## Key Takeaways


## References
[IDOR](https://book.hacktricks.wiki/en/pentesting-web/idor.html)

[WordPress Accessibility Checker by Equalize Digital Plugin <= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)](https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability)  

---

> Tác giả: [Bui Van Y](github.com/w41bu1)  
> URL: http://localhost:1313/vi/posts/2025-12-23-cve-2025-57886/  

