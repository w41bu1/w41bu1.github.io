<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-4796 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Simple Payment Plugin."><meta name="keywords" content='analyst, plugin, Bypass Vulnerability'>
  <meta itemprop="name" content="CVE-2025-4796 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Simple Payment Plugin.">
  <meta itemprop="datePublished" content="2026-01-13T19:00:00+07:00">
  <meta itemprop="dateModified" content="2026-01-13T10:26:52+07:00">
  <meta itemprop="wordCount" content="2444">
  <meta itemprop="image" content="http://localhost:1313/posts/2026-01-13-cve-2025-6688/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Bypass Vulnerability"><meta property="og:url" content="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-4796 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Simple Payment Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-13T19:00:00+07:00">
    <meta property="article:modified_time" content="2026-01-13T10:26:52+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Bypass Vulnerability">
    <meta property="og:image" content="http://localhost:1313/posts/2026-01-13-cve-2025-6688/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2026-01-13-cve-2025-6688/app.png">
  <meta name="twitter:title" content="CVE-2025-4796 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Simple Payment Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" title="CVE-2025-4796 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/index.md" title="CVE-2025-4796 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-4796 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2026-01-13-cve-2025-6688\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, Bypass Vulnerability","wordcount":  2444 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2026-01-13-cve-2025-6688\/","datePublished": "2026-01-13T19:00:00+07:00","dateModified": "2026-01-13T10:26:52+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Simple Payment Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2026-01-13-cve-2025-6688/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2026-01-13-cve-2025-6688/">English</option><option value="/vi/posts/2026-01-13-cve-2025-6688/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC">CVE-2025-3102 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-4796 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2026-01-13 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-13">2026-01-13</time></span>&nbsp;<span title="Cập nhật ngày 2026-01-13 10:26:52"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2026-01-13">2026-01-13</time></span>&nbsp;<span title="2444 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 2500 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>12 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2026-01-13-cve-2025-6688/app.png' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2026-01-13-cve-2025-6688/app.png" height="500" width="1544"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-4796" target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-4796</a></li>
<li><strong>Vulnerability Type</strong>: Bypass Vulnerability</li>
<li><strong>Affected Versions</strong>: 1.3.6-2.3.8</li>
<li><strong>Patched Versions</strong>: 2.3.9</li>
<li><strong>CVSS severity</strong>: High (9.8)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/simple-payment/" target="_blank" rel="external nofollow noopener noreferrer">WordPress Simple Payment Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>Simple Payment</strong>:
<ul>
<li><code>2.3.8</code> – <strong>vulnerable</strong></li>
<li><code>2.3.9</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký action hook:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;parse_request&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;callback&#39;</span> <span class="p">]</span> <span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p><code>parse_request</code> là action hook được gọi rất sớm trong quá trình xử lý request, sau khi WordPress đã phân tích URL (query vars) và trước khi truy vấn database (<code>WP_Query</code>) được thực thi.</p>
<p>Khi có request đến, hàm <code>callback</code> sẽ được gọi để xử lý request tương ứng.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="simple-payment-plugin.php v2.3.8" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">simple-payment-plugin.php v2.3.8</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">callback</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$callback</span> <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">callback</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$info</span>     <span class="o">=</span> <span class="nx">parse_url</span><span class="p">(</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="nv">$callback</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$callback</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$ops</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$ops</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$url</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$engine</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">:</span> <span class="nx">self</span><span class="o">::</span><span class="na">param</span><span class="p">(</span> <span class="s1">&#39;engine&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$op</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">?</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span> <span class="nv">$op</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="nx">self</span><span class="o">::</span><span class="na">OPERATION_SUCCESS</span><span class="o">:</span> <span class="c1">// success
</span></span></span><span class="line"><span class="cl">                <span class="o">...</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;payment_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;payment_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nv">$params</span> <span class="o">=</span> <span class="nx">array_merge</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;payment_id&#39;</span><span class="p">]</span> <span class="p">),</span> <span class="nv">$_REQUEST</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="nv">$params</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">post_process</span><span class="p">(</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$engine</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">do_action</span><span class="p">(</span> <span class="s1">&#39;sp_payment_success&#39;</span><span class="p">,</span> <span class="nv">$params</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$status</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">OPERATION_ERROR</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getCode</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>    <span class="nv">$status</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getCode</span><span class="p">()</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">set_message</span><span class="p">(</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">isset</span><span class="p">(</span> <span class="nv">$status</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$status</span> <span class="o">:</span> <span class="nv">$_REQUEST</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nx">isset</span><span class="p">(</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$status</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="k">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Trong <code>callback()</code>, plugin kiểm tra URL hiện tại có khớp với URL callback đã cấu hình hay không. Nếu không khớp thì thoát ngay (return).</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="nv">$callback</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$callback</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Plugin phân tích đường dẫn (<code>REQUEST_URI</code>) thành các phần (<code>$ops</code>) và kiểm tra điều kiện hợp lệ của request:</p>
<ul>
<li>Có tham số <code>op</code> trong <code>$_REQUEST</code>, hoặc</li>
<li>URL có cấu trúc dạng <code>/a/b/</code>.</li>
</ul>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$ops</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;sp&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Plugin xác định:</p>
<ul>
<li><code>$engine</code>: lấy từ request, từ URL, hoặc từ cấu hình mặc định.</li>
<li><code>$op</code>: operation hiện tại.</li>
</ul>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$engine</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;engine&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">?</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">:</span> <span class="nx">self</span><span class="o">::</span><span class="na">param</span><span class="p">(</span> <span class="s1">&#39;engine&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$op</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">?</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">OP</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">:</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$ops</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Khi search với từ khóa <code>SimplePayment\\Engines</code>, ta thấy được danh sách các engine được khai báo:</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-13-cve-2025-6688/engine.png" title="Danh sách các engine" data-thumbnail="/posts/2026-01-13-cve-2025-6688/engine.png" data-sub-html="<h2>Engine</h2><p>Danh sách các engine</p>"><img loading="lazy" src='/posts/2026-01-13-cve-2025-6688/engine.png' alt="Engine" height="662" width="1380"></a><figcaption class="image-caption">Danh sách các engine</figcaption>
  </figure></p>
<p>Plugin xử lý theo <code>$op</code> bằng switch.
Khi <code>$op</code> là <code>success</code>:</p>
<ul>
<li>Nếu có <code>payment_id</code>, plugin gọi <code>$this-&gt;fetch()</code> để lấy thông tin thanh toán và gộp với dữ liệu request.</li>
<li>Nếu không có <code>payment_id</code>, sử dụng trực tiếp dữ liệu từ <code>$_REQUEST</code>.</li>
</ul>
<p>Sau khi chuẩn bị xong <code>$params</code>, plugin gọi <code>post_process($params, $engine)</code></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="simple-payment-plugin.php v2.3.8" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">simple-payment-plugin.php v2.3.8</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">post_process</span><span class="p">(</span> <span class="nv">$params</span> <span class="o">=</span> <span class="p">[],</span> <span class="nv">$engine</span> <span class="o">=</span> <span class="k">null</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setEngine</span><span class="p">(</span> <span class="nv">$engine</span> <span class="o">?</span> <span class="o">:</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span> <span class="s1">&#39;engine&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$params</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">&#39;sp_payment_post_process_filter&#39;</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">parent</span><span class="o">::</span><span class="na">post_process</span><span class="p">(</span> <span class="nv">$params</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$args</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">TRANSACTION_SUCCESS</span>
</span></span><span class="line"><span class="cl">      <span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">confirmation_code</span><span class="p">)</span> <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;confirmation_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">confirmation_code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">payments</span><span class="p">)</span> <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;payments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">payments</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">amount</span><span class="p">)</span> <span class="nv">$args</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">self</span><span class="o">::</span><span class="na">update</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">payment_id</span> <span class="o">?</span> <span class="o">:</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">transaction</span><span class="p">,</span> <span class="nv">$args</span> <span class="p">,</span> <span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">payment_id</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$a</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;user_create&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$b</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;user_create_step&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;user_create&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;disabled&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;user_create_step&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;post&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">get_current_user_id</span><span class="p">())</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create_user</span><span class="p">(</span><span class="nv">$params</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">do_action</span><span class="p">(</span> <span class="s1">&#39;sp_payment_post_process&#39;</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span><span class="p">(</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span> <span class="k">false</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm thực hiện set engine (theo các engine đã được khai báo) sau đó check điều kiện:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">parent</span><span class="o">::</span><span class="na">post_process</span><span class="p">(</span> <span class="nv">$params</span> <span class="p">)</span></span></span></code></pre></td></tr></table></div>
</div>
</div><div class="code-block highlight" data-mode="classic" data-copyable="true" title="SimplePayment.php v2.3.8" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">SimplePayment.php v2.3.8</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">post_process</span><span class="p">(</span><span class="nv">$params</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">engine</span><span class="o">-&gt;</span><span class="na">post_process</span><span class="p">(</span><span class="nv">$params</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">TRANSACTION_SUCCESS</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// TODO: run sucess webhook if necessary -
</span></span></span><span class="line"><span class="cl">      <span class="k">return</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">TRANSACTION_FAILED</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// TODO: run failed webhook if necessary.
</span></span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Tiếp tục gọi <code>$this-&gt;engine-&gt;post_process( $params )</code></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="engine_file v2.3.8" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">engine_file v2.3.8</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">post_process</span><span class="p">(</span><span class="nv">$params</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">transaction</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;lowprofilecode&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;lowprofilecode&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$params</span><span class="p">[</span> <span class="s1">&#39;transaction_id&#39;</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;transaction_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">transaction</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;:post_process&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;ResponseCode&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;ResponseCode&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;response_code&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="k">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;request&#39;</span> <span class="o">=&gt;</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$params</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;response&#39;</span> <span class="o">=&gt;</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;Operation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;payments&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;payments&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;monthly&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;recurr_at&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;post&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;reurring&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;provider&#39;</span><span class="p">)</span> <span class="k">return</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">recur_by_provider</span><span class="p">(</span><span class="nv">$params</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// TODO: update confirmation code con status
</span></span></span><span class="line"><span class="cl">    <span class="c1">//$this-&gt;confirmation_code = $response[&#39;confirmation_code&#39;];
</span></span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;ResponeCode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm thực hiện:</p>
<ul>
<li>Lưu transaction, request, response.</li>
<li>Xử lý logic recurring (nếu có).</li>
<li>Trả về <code>true</code> nếu giao dịch thành công.</li>
</ul>
<p>Nếu điều kiện trả về là <code>true</code>, hàm tiếp tục kiểm tra điều kiện tạo user:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span> <span class="s1">&#39;user_create&#39;</span> <span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;disabled&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span> <span class="s1">&#39;user_create_step&#39;</span> <span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;post&#39;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="o">!</span> <span class="nx">get_current_user_id</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create_user</span><span class="p">(</span> <span class="nv">$params</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div>
</div>
</div><ul>
<li><code>user_create ≠ disabled</code></li>
<li><code>user_create_step = post</code></li>
<li>Chưa có user đăng nhập (<code>!get_current_user_id()</code>)</li>
</ul>
<p>Ta có thể thay đổi 2 option này trong Admin Dashboard:</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2026-01-13-cve-2025-6688/option.png" title="Option trong Admin Dashboard" data-thumbnail="/posts/2026-01-13-cve-2025-6688/option.png" data-sub-html="<h2>Option</h2><p>Option trong Admin Dashboard</p>"><img loading="lazy" src='/posts/2026-01-13-cve-2025-6688/option.png' alt="Option" height="895" width="1919"></a><figcaption class="image-caption">Option trong Admin Dashboard</figcaption>
  </figure></p>
<p>Khi thỏa tất cả điều kiện trên, hệ thống gọi:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create_user</span><span class="p">(</span> <span class="nv">$params</span> <span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><div class="code-block highlight" data-mode="classic" data-copyable="true" title="simple-payment-plugin.php v2.3.8" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">simple-payment-plugin.php v2.3.8</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">create_user</span><span class="p">(</span><span class="nv">$params</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$email</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">EMAIL</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">EMAIL</span><span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$email</span><span class="p">)</span> <span class="k">return</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">email_exists</span><span class="p">(</span><span class="nv">$email</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$user_id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$username</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">USERNAME</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">USERNAME</span><span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_id</span> <span class="o">=</span> <span class="nv">$username</span> <span class="o">?</span> <span class="nx">username_exists</span><span class="p">(</span><span class="nv">$username</span><span class="p">)</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$user_id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nv">$username</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">FIRST_NAME</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">FIRST_NAME</span><span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$username</span><span class="p">)</span> <span class="nv">$username</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">LAST_NAME</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">LAST_NAME</span><span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$username</span><span class="p">)</span> <span class="nv">$username</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">FULL_NAME</span><span class="p">])</span> <span class="o">?</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$params</span><span class="p">[</span><span class="nx">self</span><span class="o">::</span><span class="na">FULL_NAME</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$username</span><span class="p">)</span> <span class="nv">$username</span> <span class="o">=</span> <span class="nx">wp_generate_password</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nv">$username</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_unique_username</span><span class="p">(</span><span class="nx">strtolower</span><span class="p">(</span><span class="nv">$username</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">param</span><span class="p">(</span><span class="s1">&#39;user_create_step&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;register&#39;</span><span class="p">)</span> <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">register_new_user</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$email</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="k">else</span> <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">wp_create_user</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nx">wp_generate_password</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="k">false</span><span class="p">),</span> <span class="nv">$email</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nx">do_action</span><span class="p">(</span><span class="s1">&#39;sp_user_created&#39;</span><span class="p">,</span> <span class="nv">$user_id</span><span class="p">,</span> <span class="nv">$params</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$user_id</span><span class="p">)</span> <span class="nx">wp_set_auth_cookie</span><span class="p">(</span><span class="nv">$user_id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">(</span><span class="nv">$user_id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Hàm sẽ kiểm tra email lấy từ request. Nếu email đã tồn tại trong hệ thống, hàm sẽ lấy ID của user tương ứng và gán cho biến <code>$user_id</code>.</p>
<p>Điều thực sự nguy hiểm là khi <code>$user_id</code> đã có giá trị, hàm <code>wp_set_auth_cookie()</code> sẽ được gọi để thiết lập cookie đăng nhập cho user tương ứng, đồng nghĩa với việc người dùng có thể được đăng nhập tự động mà không cần xác thực thêm. =&gt; <code>Bypass Vulnerability</code></p>
<p>Bản vá <code>v2.3.9</code> đã loại bỏ nguyên nhân gây bypass đăng nhập bằng cách thay đổi cách gọi <code>wp_set_auth_cookie()</code>.</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="simple-payment-plugin.php v2.3.9" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">simple-payment-plugin.php v2.3.9</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">create_user</span><span class="p">(</span> <span class="nv">$params</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$email</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">EMAIL</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">EMAIL</span> <span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$email</span> <span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$user_id</span> <span class="o">=</span> <span class="nx">email_exists</span><span class="p">(</span> <span class="nv">$email</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user_id</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$username</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$params</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">USERNAME</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$params</span><span class="p">[</span> <span class="nx">self</span><span class="o">::</span><span class="na">USERNAME</span> <span class="p">]</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_id</span>  <span class="o">=</span> <span class="nv">$username</span> <span class="o">?</span> <span class="nx">username_exists</span><span class="p">(</span> <span class="nv">$username</span> <span class="p">)</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user_id</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="o">...</span>
</span></span><span class="line"><span class="cl">            <span class="nx">wp_set_auth_cookie</span><span class="p">(</span> <span class="nv">$user_id</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$user_id</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// TODO: Login should be handled by developer implementation.
</span></span></span><span class="line"><span class="cl">        <span class="c1">// wp_set_auth_cookie( $user_id );
</span></span></span><span class="line"><span class="cl">        <span class="nx">do_action</span><span class="p">(</span> <span class="s1">&#39;sp_user_created&#39;</span><span class="p">,</span> <span class="nv">$user_id</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$user_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Chỉ set cookie cho user mới.</p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to plugin callback endpoint /a/b/ or matching configured callback path"]

B --> C["WordPress loads and triggers parse_request hook"]

C --> D["Simple Payment callback() is executed"]

D --> E{"Request path matches callback path ?"}
E -- No --> X["Request ignored"]
E -- Yes --> F["Parse REQUEST_URI into $ops"]

F --> G{"Has op parameter OR valid /sp/{engine}/{op} format ?"}
G -- No --> X
G -- Yes --> H["Extract engine and operation"]

H --> I{"op == success ?"}
I -- No --> X
I -- Yes --> J["Build $params from $_REQUEST or fetch(payment_id)"]

J --> K["Call post_process($params, $engine)"]

K --> L["setEngine() and apply sp_payment_post_process_filter"]

L --> M["parent::post_process($params)"]

M --> N["engine->post_process($params)"]

N --> O["Save transaction / request / response"]

O --> P{"ResponeCode == 0 ?"}
P -- No --> Y["Transaction failed → stop"]
P -- Yes --> Q["Transaction marked SUCCESS"]

Q --> R{"user_create != disabled<br/>AND user_create_step == post<br/>AND user not logged in ?"}
R -- No --> Z["Skip user creation"]
R -- Yes --> S["Call create_user($params)"]

S --> T["Extract email from $params"]

T --> U{"Email exists in WordPress ?"}
U -- Yes --> V["Get existing user_id"]
U -- No --> W["Create new user and get user_id"]

V --> AA["wp_set_auth_cookie(user_id)"]
W --> AA["wp_set_auth_cookie(user_id)"]

AA --> AB["User is automatically logged in"]

AB --> AC["Authentication Bypass achieved"]</pre>
  <pre class="mermaid-dark">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to plugin callback endpoint /a/b/ or matching configured callback path"]

B --> C["WordPress loads and triggers parse_request hook"]

C --> D["Simple Payment callback() is executed"]

D --> E{"Request path matches callback path ?"}
E -- No --> X["Request ignored"]
E -- Yes --> F["Parse REQUEST_URI into $ops"]

F --> G{"Has op parameter OR valid /sp/{engine}/{op} format ?"}
G -- No --> X
G -- Yes --> H["Extract engine and operation"]

H --> I{"op == success ?"}
I -- No --> X
I -- Yes --> J["Build $params from $_REQUEST or fetch(payment_id)"]

J --> K["Call post_process($params, $engine)"]

K --> L["setEngine() and apply sp_payment_post_process_filter"]

L --> M["parent::post_process($params)"]

M --> N["engine->post_process($params)"]

N --> O["Save transaction / request / response"]

O --> P{"ResponeCode == 0 ?"}
P -- No --> Y["Transaction failed → stop"]
P -- Yes --> Q["Transaction marked SUCCESS"]

Q --> R{"user_create != disabled<br/>AND user_create_step == post<br/>AND user not logged in ?"}
R -- No --> Z["Skip user creation"]
R -- Yes --> S["Call create_user($params)"]

S --> T["Extract email from $params"]

T --> U{"Email exists in WordPress ?"}
U -- Yes --> V["Get existing user_id"]
U -- No --> W["Create new user and get user_id"]

V --> AA["wp_set_auth_cookie(user_id)"]
W --> AA["wp_set_auth_cookie(user_id)"]

AA --> AB["User is automatically logged in"]

AB --> AC["Authentication Bypass achieved"]</pre>
  <pre class="mermaid-neutral">flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to plugin callback endpoint /a/b/ or matching configured callback path"]

B --> C["WordPress loads and triggers parse_request hook"]

C --> D["Simple Payment callback() is executed"]

D --> E{"Request path matches callback path ?"}
E -- No --> X["Request ignored"]
E -- Yes --> F["Parse REQUEST_URI into $ops"]

F --> G{"Has op parameter OR valid /sp/{engine}/{op} format ?"}
G -- No --> X
G -- Yes --> H["Extract engine and operation"]

H --> I{"op == success ?"}
I -- No --> X
I -- Yes --> J["Build $params from $_REQUEST or fetch(payment_id)"]

J --> K["Call post_process($params, $engine)"]

K --> L["setEngine() and apply sp_payment_post_process_filter"]

L --> M["parent::post_process($params)"]

M --> N["engine->post_process($params)"]

N --> O["Save transaction / request / response"]

O --> P{"ResponeCode == 0 ?"}
P -- No --> Y["Transaction failed → stop"]
P -- Yes --> Q["Transaction marked SUCCESS"]

Q --> R{"user_create != disabled<br/>AND user_create_step == post<br/>AND user not logged in ?"}
R -- No --> Z["Skip user creation"]
R -- Yes --> S["Call create_user($params)"]

S --> T["Extract email from $params"]

T --> U{"Email exists in WordPress ?"}
U -- Yes --> V["Get existing user_id"]
U -- No --> W["Create new user and get user_id"]

V --> AA["wp_set_auth_cookie(user_id)"]
W --> AA["wp_set_auth_cookie(user_id)"]

AA --> AB["User is automatically logged in"]

AB --> AC["Authentication Bypass achieved"]</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i></div>
<template><pre>flowchart TD
A["Attacker (Unauthenticated)"]
--> B["Send crafted HTTP request to plugin callback endpoint /a/b/ or matching configured callback path"]

B --> C["WordPress loads and triggers parse_request hook"]

C --> D["Simple Payment callback() is executed"]

D --> E{"Request path matches callback path ?"}
E -- No --> X["Request ignored"]
E -- Yes --> F["Parse REQUEST_URI into $ops"]

F --> G{"Has op parameter OR valid /sp/{engine}/{op} format ?"}
G -- No --> X
G -- Yes --> H["Extract engine and operation"]

H --> I{"op == success ?"}
I -- No --> X
I -- Yes --> J["Build $params from $_REQUEST or fetch(payment_id)"]

J --> K["Call post_process($params, $engine)"]

K --> L["setEngine() and apply sp_payment_post_process_filter"]

L --> M["parent::post_process($params)"]

M --> N["engine->post_process($params)"]

N --> O["Save transaction / request / response"]

O --> P{"ResponeCode == 0 ?"}
P -- No --> Y["Transaction failed → stop"]
P -- Yes --> Q["Transaction marked SUCCESS"]

Q --> R{"user_create != disabled<br/>AND user_create_step == post<br/>AND user not logged in ?"}
R -- No --> Z["Skip user creation"]
R -- Yes --> S["Call create_user($params)"]

S --> T["Extract email from $params"]

T --> U{"Email exists in WordPress ?"}
U -- Yes --> V["Get existing user_id"]
U -- No --> W["Create new user and get user_id"]

V --> AA["wp_set_auth_cookie(user_id)"]
W --> AA["wp_set_auth_cookie(user_id)"]

AA --> AB["User is automatically logged in"]

AB --> AC["Authentication Bypass achieved"]</pre></template>
</div><h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Gửi request:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-http"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/a/b/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="g">op=success&amp;engine=Cardcom&amp;user_create_step=post&amp;user_create=enable&amp;email=admin@gmail.com</span></span></span></code></pre></td></tr></table></div>
</div>
</div><h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>CVE-2025-4796 xảy ra do plugin xử lý callback thanh toán qua <code>parse_request</code> mà không có cơ chế xác thực. Attacker có thể gửi request giả mạo để kích hoạt luồng <code>OPERATION_SUCCESS</code> và gọi <code>create_user()</code>.</p>
<p>Trong phiên bản ≤ 2.3.8, nếu email tồn tại, plugin lấy <code>user_id</code> và gọi trực tiếp <code>wp_set_auth_cookie()</code>, cho phép đăng nhập vào tài khoản bất kỳ mà không cần xác thực, dẫn đến Authentication Bypass.</p>
<p>Phiên bản 2.3.9 đã loại bỏ việc tự động đăng nhập với user đã tồn tại, khắc phục nguyên nhân gây lỗ hổng.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Không xử lý logic nhạy cảm trên request không xác thực.</li>
<li>Không gọi <code>wp_set_auth_cookie()</code> dựa trên dữ liệu người dùng cung cấp.</li>
<li>Tách biệt rõ ràng giữa tạo user và đăng nhập.</li>
<li>Cẩn trọng khi sử dụng các hook chạy sớm như <code>parse_request</code>.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/" target="_blank" rel="external nofollow noopener noreferrer">Bypass Vulnerability</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/simple-payment/vulnerability/wordpress-simple-payment-plugin-1-3-6-2-3-8-authentication-bypass-vulnerability" target="_blank" rel="external nofollow noopener noreferrer">WordPress Simple Payment Plugin 1.3.6-2.3.8 is vulnerable to a high priority Bypass Vulnerability</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2026-01-14-cve-2025-3102/" title="CVE-2025-3102 Analysis &amp; POC">CVE-2025-3102 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-12-cve-2025-4796/" title="CVE-2025-4796 Analysis &amp; POC">CVE-2025-4796 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-11-cve-2025-8059/" title="CVE-2025-8059 Analysis &amp; POC">CVE-2025-8059 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-08-cve-2025-14156/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-07-cve-2025-2563/" title="CVE-2025-2563 Analysis &amp; POC">CVE-2025-2563 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-06-cve-2025-7654/" title="CVE-2025-7654 Analysis &amp; POC">CVE-2025-7654 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-05-cve-2025-55707/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-04-cve-2025-53425/" title="CVE-2025-53425 Analysis &amp; POC">CVE-2025-53425 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-03-cve-2025-6325/" title="CVE-2025-6325 Analysis &amp; POC">CVE-2025-6325 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2026-01-02-cve-2025-11923/" title="CVE-2025-11923 Analysis &amp; POC">CVE-2025-11923 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2026-01-13 10:26:52">Cập nhật ngày 2026-01-13&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/68e87f5b7a722fc6aa58fe445228914c746c503f" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2026-01-13-CVE-2025-6688&#10&#10Commit: 68e87f5b7a722fc6aa58fe445228914c746c503f [68e87f5b]&#10Author: w41bu1&#10Date: 2026-01-13 10:26:52"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>68e87f5b</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2026-01-13-cve-2025-6688/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-13-CVE-2025-6688/index.vi.md?plain=1" title="Xem mã nguồn" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2026-01-13-CVE-2025-6688/index.vi.md" title="Chỉnh sửa trang này" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-4796&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-4796&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2026-01-13-CVE-2025-6688/index.vi.md?plain=1%7c" title="Báo cáo lỗi" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2026-01-13-CVE-2025-6688/index.vi.md" title="Mở trong trình chỉnh sửa" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" data-title="CVE-2025-4796 Analysis &amp; POC" data-hashtags="analyst,plugin,Bypass Vulnerability"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/" data-title="CVE-2025-4796 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/bypass-vulnerability/" class="post-tag" title="Nhãn - Bypass Vulnerability">Bypass Vulnerability</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2026-01-12-cve-2025-4796/" class="post-nav-item" rel="prev" title="CVE-2025-4796 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-4796 Analysis &amp; POC</a><a href="/vi/posts/2026-01-14-cve-2025-3102/" class="post-nav-item" rel="next" title="CVE-2025-3102 Analysis &amp; POC">CVE-2025-3102 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/1283a400d983e74f5a063cd11f5951b9.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
