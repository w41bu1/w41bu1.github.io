<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-12887 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Post SMTP Plugin."><meta name="keywords" content='analyst, plugin, broken access control'>
  <meta itemprop="name" content="CVE-2025-12887 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Post SMTP Plugin.">
  <meta itemprop="datePublished" content="2025-12-08T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-12-07T23:16:37+07:00">
  <meta itemprop="wordCount" content="1449">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg">
  <meta itemprop="keywords" content="Analyst,Plugin,Broken Access Control"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-12887 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Post SMTP Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-08T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-12-07T23:16:37+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Broken Access Control">
    <meta property="og:image" content="http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg">
  <meta name="twitter:title" content="CVE-2025-12887 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Post SMTP Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/" title="CVE-2025-12887 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-12-07-cve-2025-11726/" title="CVE-2025-11726 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2025-12-09-cve-2025-64384/" title="CVE-2025-64384 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/index.md" title="CVE-2025-12887 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-12887 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-12-08-cve-2025-12887\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, broken access control","wordcount":  1449 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-12-08-cve-2025-12887\/","datePublished": "2025-12-08T19:00:00+07:00","dateModified": "2025-12-07T23:16:37+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Post SMTP Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Đổi chủ đề" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-12-08-cve-2025-12887/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-12-08-cve-2025-12887/">English</option><option value="/vi/posts/2025-12-08-cve-2025-12887/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-12-16-cve-2025-13956/" title="CVE-2025-13956 Analysis &amp; POC">CVE-2025-13956 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-15-cve-2025-14508/" title="CVE-2025-14508 Analysis &amp; POC">CVE-2025-14508 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-14-cve-2025-12349/" title="CVE-2025-12349 Analysis &amp; POC">CVE-2025-12349 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-13-cve-2025-12174/" title="CVE-2025-12174 Analysis &amp; POC">CVE-2025-12174 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-12-cve-2025-66072/" title="CVE-2025-66072 Analysis &amp; POC">CVE-2025-66072 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-11-cve-2025-11368/" title="CVE-2025-11368 Analysis &amp; POC">CVE-2025-11368 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-10-cve-2025-11815/" title="CVE-2025-11815 Analysis &amp; POC">CVE-2025-11815 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-09-cve-2025-64384/" title="CVE-2025-64384 Analysis &amp; POC">CVE-2025-64384 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-07-cve-2025-11726/" title="CVE-2025-11726 Analysis &amp; POC">CVE-2025-11726 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-12-26-cve-2025-3769/" title="CVE-2025-3769 Analysis &amp; POC">CVE-2025-3769 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-12887 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analysis/" class="post-category" title="Danh mục - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-12-08 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-08">2025-12-08</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-07 23:16:37"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-07">2025-12-07</time></span>&nbsp;<span title="1449 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1500 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>7 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2025-12-08-cve-2025-12887/app.jpg' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2025-12-08-cve-2025-12887/app.jpg" height="500" width="1544"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>Post SMTP</strong> cho <strong>WordPress</strong> dễ bị tấn công <strong>vượt quyền xác thực</strong> trong tất cả các <strong>phiên bản</strong> cho đến và bao gồm <strong>3.6.1</strong>. Nguyên nhân là do plugin không xác minh đúng cách rằng <strong>người dùng</strong> có được phép cập nhật <strong>token OAuth</strong> trong hàm <strong>&lsquo;handle_gmail_oauth_redirect&rsquo;</strong>. Điều này cho phép <strong>kẻ tấn công</strong> đã <strong>xác thực</strong>, với quyền truy cập từ cấp độ <strong>người đăng ký</strong> trở lên, chèn các <strong>thông tin xác thực OAuth</strong> không hợp lệ hoặc do <strong>kẻ tấn công kiểm soát</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-12887" target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-12887</a></li>
<li><strong>Vulnerability Type</strong>: Broken Access Control</li>
<li><strong>Affected Versions</strong>: &lt;= 3.6.1</li>
<li><strong>Patched Versions</strong>: 3.6.2</li>
<li><strong>CVSS severity</strong>: Low (5.4)</li>
<li><strong>Required Privilege</strong>: Contributor</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/post-smtp/" target="_blank" rel="external nofollow noopener noreferrer">WordPress Post SMTP Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>Post SMTP</strong>:
<ul>
<li><code>3.6.1</code> – <strong>vulnerable</strong></li>
<li><code>3.6.2</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký một action hook:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="NewWizard.php v3.6.1" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">NewWizard.php v3.6.1</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;`admin_init`&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;handle_gmail_oauth_redirect&#39;</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table></div>
</div>
</div><ul>
<li>
<p><strong>Hook <code>admin_init</code></strong><br>
Đây là một hook trong WordPress được kích hoạt <strong>mỗi khi một người dùng đã đăng nhập truy cập vào khu vực quản trị (admin area)</strong>. Nó chạy sớm trong quá trình khởi tạo trang quản trị, trước khi bất kỳ nội dung nào được hiển thị.</p>
</li>
<li>
<p><strong>Đăng ký action</strong><br>
Plugin Post SMTP đã đăng ký hàm <code>handle_gmail_oauth_redirect</code> với hook <code>admin_init</code>:
Điều này có nghĩa là <strong>bất kỳ người dùng nào đã đăng nhập</strong> (kể cả với quyền thấp như <em>subscriber</em>) đều có thể kích hoạt hàm này khi truy cập vào trang quản trị.</p>
</li>
</ul>
<p><strong>Trong phiên bản lỗi (v3.6.1):</strong></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="NewWizard.php v3.6.1" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">NewWizard.php v3.6.1</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="hl"><span class="lnt">21
</span></span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">handle_gmail_oauth_redirect</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Check if the required OAuth parameters are present in the URL.
</span></span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;gmail_oauth_redirect&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Sanitize and retrieve URL parameters
</span></span></span><span class="line"><span class="cl">        <span class="nv">$access_token</span>  <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$refresh_token</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$expires_in</span>    <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">intval</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span>           <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_email</span>    <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_email</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$auth_token_expires</span> <span class="o">=</span> <span class="nx">time</span><span class="p">()</span> <span class="o">+</span> <span class="nv">$expires_in</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$access_token</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$oauth_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;access_token&#39;</span>      <span class="o">=&gt;</span> <span class="nv">$access_token</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;refresh_token&#39;</span>     <span class="o">=&gt;</span> <span class="nv">$refresh_token</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;auth_token_expires&#39;</span><span class="o">=&gt;</span> <span class="nv">$auth_token_expires</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;vendor_name&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;google&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;user_email&#39;</span>        <span class="o">=&gt;</span> <span class="nv">$user_email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Save the OAuth parameters to the WordPress options table.
</span></span></span><span class="line hl"><span class="cl">            <span class="nx">update_option</span><span class="p">(</span> <span class="s1">&#39;postman_auth_token&#39;</span><span class="p">,</span> <span class="nv">$oauth_data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Logic của hàm <code>handle_gmail_oauth_redirect</code> cho thấy cách plugin Post SMTP xử lý việc nhận <strong>OAuth token</strong> từ Gmail. Tuy nhiên, có một số điểm yếu nghiêm trọng:</p>
<ul>
<li>Chỉ cần người dùng đã đăng nhập và truy cập vào trang quản trị với tham số <code>action=gmail_oauth_redirect</code> và <code>access_token</code> trong URL, logic update sẽ được gọi.</li>
<li>Không có bất kỳ <strong>kiểm tra quyền hạn (capability check)</strong> nào để đảm bảo chỉ quản trị viên mới được phép thực hiện.</li>
</ul>
<p><strong>Bản vá (v3.6.2):</strong></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="NewWizard.php v3.6.1" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">NewWizard.php v3.6.1</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="hl"><span class="lnt">11
</span></span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="hl"><span class="lnt">16
</span></span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="hl"><span class="lnt">38
</span></span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">handle_gmail_oauth_redirect</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Check if the required OAuth parameters are present in the URL.
</span></span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;gmail_oauth_redirect&#39;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="c1">// Capability check: Only allow administrators to update OAuth tokens
</span></span></span><span class="line hl"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;manage_options&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_die</span><span class="p">(</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;You do not have sufficient permissions to access this page.&#39;</span><span class="p">,</span> <span class="s1">&#39;post-smtp&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// CSRF protection: Verify nonce (required by security report)
</span></span></span><span class="line hl"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;_wpnonce&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;_wpnonce&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_die</span><span class="p">(</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;Security check failed. Nonce is missing.&#39;</span><span class="p">,</span> <span class="s1">&#39;post-smtp&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Verify the nonce
</span></span></span><span class="line hl"><span class="cl">    <span class="nv">$nonce</span> <span class="o">=</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;_wpnonce&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nv">$nonce</span><span class="p">,</span> <span class="s1">&#39;gmail_oauth_redirect&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_die</span><span class="p">(</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;Security check failed. Invalid nonce. Please try again.&#39;</span><span class="p">,</span> <span class="s1">&#39;post-smtp&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Sanitize and retrieve URL parameters
</span></span></span><span class="line"><span class="cl">        <span class="nv">$access_token</span>  <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$refresh_token</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$expires_in</span>    <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">intval</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span>           <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user_email</span>    <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">sanitize_email</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;user_email&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$auth_token_expires</span> <span class="o">=</span> <span class="nx">time</span><span class="p">()</span> <span class="o">+</span> <span class="nv">$expires_in</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$access_token</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$oauth_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;access_token&#39;</span>      <span class="o">=&gt;</span> <span class="nv">$access_token</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;refresh_token&#39;</span>     <span class="o">=&gt;</span> <span class="nv">$refresh_token</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;auth_token_expires&#39;</span><span class="o">=&gt;</span> <span class="nv">$auth_token_expires</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;vendor_name&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;google&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;user_email&#39;</span>        <span class="o">=&gt;</span> <span class="nv">$user_email</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Save the OAuth parameters to the WordPress options table.
</span></span></span><span class="line hl"><span class="cl">            <span class="nx">update_option</span><span class="p">(</span> <span class="s1">&#39;postman_auth_token&#39;</span><span class="p">,</span> <span class="nv">$oauth_data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Mở rộng hoặc thu gọn khối mã" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>Bản vá đã:</p>
<ol>
<li>
<p>Kiểm tra quyền hạn (Capability check):
Chỉ administrator (người có quyền <code>manage_options</code>) mới được phép cập nhật <strong>OAuth token</strong>.</p>
</li>
<li>
<p>Bảo vệ CSRF bằng nonce:
Thêm <strong>nonce verification</strong> để đảm bảo request thực sự được tạo từ trang hợp lệ trong WordPress, ngăn chặn tấn công <strong>CSRF (Cross-Site Request Forgery)</strong>.</p>
</li>
</ol>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD
A["Authenticated user (Subscriber or higher)"] 
--> B["Access admin area: /wp-admin/"]
--> C["admin_init hook is triggered"]
--> D["Post SMTP: handle_gmail_oauth_redirect() is executed"]
--> E{"Is GET[action] = gmail_oauth_redirect ?"}
E -- No --> F["Function exits – No impact"]
E -- Yes --> G["Read parameters from URL: access_token, refresh_token, expires_in, user_email"]
--> H{"Is access_token present ?"}
H -- No --> F
H -- Yes --> I["Build OAuth data array"]
--> J["update_option('postman_auth_token', oauth_data)"]
--> K["OAuth token is overwritten by attacker-controlled data"]
</pre>
  <pre class="mermaid-dark">
graph TD
A["Authenticated user (Subscriber or higher)"] 
--> B["Access admin area: /wp-admin/"]
--> C["admin_init hook is triggered"]
--> D["Post SMTP: handle_gmail_oauth_redirect() is executed"]
--> E{"Is GET[action] = gmail_oauth_redirect ?"}
E -- No --> F["Function exits – No impact"]
E -- Yes --> G["Read parameters from URL: access_token, refresh_token, expires_in, user_email"]
--> H{"Is access_token present ?"}
H -- No --> F
H -- Yes --> I["Build OAuth data array"]
--> J["update_option('postman_auth_token', oauth_data)"]
--> K["OAuth token is overwritten by attacker-controlled data"]
</pre>
  <pre class="mermaid-neutral">
graph TD
A["Authenticated user (Subscriber or higher)"] 
--> B["Access admin area: /wp-admin/"]
--> C["admin_init hook is triggered"]
--> D["Post SMTP: handle_gmail_oauth_redirect() is executed"]
--> E{"Is GET[action] = gmail_oauth_redirect ?"}
E -- No --> F["Function exits – No impact"]
E -- Yes --> G["Read parameters from URL: access_token, refresh_token, expires_in, user_email"]
--> H{"Is access_token present ?"}
H -- No --> F
H -- Yes --> I["Build OAuth data array"]
--> J["update_option('postman_auth_token', oauth_data)"]
--> K["OAuth token is overwritten by attacker-controlled data"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i></div>
<template><pre>
graph TD
A["Authenticated user (Subscriber or higher)"] 
--> B["Access admin area: /wp-admin/"]
--> C["admin_init hook is triggered"]
--> D["Post SMTP: handle_gmail_oauth_redirect() is executed"]
--> E{"Is GET[action] = gmail_oauth_redirect ?"}
E -- No --> F["Function exits – No impact"]
E -- Yes --> G["Read parameters from URL: access_token, refresh_token, expires_in, user_email"]
--> H{"Is access_token present ?"}
H -- No --> F
H -- Yes --> I["Build OAuth data array"]
--> J["update_option('postman_auth_token', oauth_data)"]
--> K["OAuth token is overwritten by attacker-controlled data"]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Gửi request bằng tài khoản <strong>Subcriber+</strong>:</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-http"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Chuyển đổi số dòng" role="button" title="Chuyển đổi số dòng"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Chuyển đổi xuống dòng" role="button" title="Chuyển đổi xuống dòng"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Sao chép vào bộ nhớ tạm" role="button" title="Sao chép vào bộ nhớ tạm"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">GET</span> <span class="nn">/wp-admin/?action=gmail_oauth_redirect&amp;access_token=access_token_payload&amp;refresh_token=refresh_to_payload&amp;expires_in=expires_in_payload&amp;user_email=user_email@gmail.com</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">subcriber+ cookie</span></span></span></code></pre></td></tr></table></div>
</div>
</div><h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng CVE-2025-12887 xuất phát từ việc plugin Post SMTP liên kết trực tiếp hàm <code>handle_gmail_oauth_redirect</code> vào hook <code>admin_init</code> mà không thực hiện bất kỳ kiểm tra quyền hạn hoặc cơ chế xác thực bổ sung nào. Điều này cho phép bất kỳ người dùng đã đăng nhập, kể cả với quyền thấp như <strong>Subscriber/Contributor</strong>, có thể gửi request tùy ý để ghi đè giá trị <code>postman_auth_token</code> trong bảng <code>options</code> của WordPress.</p>
<p>Việc thiếu <strong>capability check</strong> và <strong>nonce verification</strong> đã tạo ra một điểm yếu nghiêm trọng trong quy trình xử lý OAuth, dẫn đến nguy cơ chiếm quyền kiểm soát cấu hình gửi email của website. Bản vá ở phiên bản 3.6.2 đã khắc phục vấn đề bằng cách giới hạn quyền thực thi cho administrator và bổ sung kiểm tra nonce để ngăn chặn các request giả mạo.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Không bao giờ gắn các hành động nhạy cảm (như cập nhật token) vào hook chung như <code>admin_init</code> mà không kiểm tra quyền hạn người dùng.</li>
<li>Luôn sử dụng <code>current_user_can()</code> để đảm bảo chỉ các vai trò phù hợp mới có thể thực hiện hành vi nguy hiểm.</li>
<li>Bắt buộc triển khai <strong>nonce verification</strong> cho các request thay đổi trạng thái nhằm phòng chống CSRF.</li>
<li>Không nên tin tưởng dữ liệu đến từ <code>$_GET</code> hoặc <code>$_POST</code> mà thiếu cơ chế xác thực và phân quyền rõ ràng.</li>
<li>Việc cập nhật token OAuth cần được coi là hành động cấp quản trị và phải được bảo vệ tương đương các thay đổi quan trọng khác trong hệ thống.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/" target="_blank" rel="external nofollow noopener noreferrer">Broken Access Control</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/post-smtp/vulnerability/wordpress-post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-plugin-3-6-1-missing-authorization-to-authenticated-subscriber-oauth-token-update-vulnerability" target="_blank" rel="external nofollow noopener noreferrer">WordPress Post SMTP Plugin &lt;= 3.6.1 is vulnerable to Broken Access Control</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-12-16-cve-2025-13956/" title="CVE-2025-13956 Analysis &amp; POC">CVE-2025-13956 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-15-cve-2025-14508/" title="CVE-2025-14508 Analysis &amp; POC">CVE-2025-14508 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-14-cve-2025-12349/" title="CVE-2025-12349 Analysis &amp; POC">CVE-2025-12349 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-13-cve-2025-12174/" title="CVE-2025-12174 Analysis &amp; POC">CVE-2025-12174 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-12-cve-2025-66072/" title="CVE-2025-66072 Analysis &amp; POC">CVE-2025-66072 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-11-cve-2025-11368/" title="CVE-2025-11368 Analysis &amp; POC">CVE-2025-11368 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-10-cve-2025-11815/" title="CVE-2025-11815 Analysis &amp; POC">CVE-2025-11815 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-09-cve-2025-64384/" title="CVE-2025-64384 Analysis &amp; POC">CVE-2025-64384 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-07-cve-2025-11726/" title="CVE-2025-11726 Analysis &amp; POC">CVE-2025-11726 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-12-26-cve-2025-3769/" title="CVE-2025-3769 Analysis &amp; POC">CVE-2025-3769 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-12-07 23:16:37">Cập nhật ngày 2025-12-07&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/d8dc20aa9984d9c556f346e8cb4e306d799c6146" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2025-12-08-CVE-2025-12887&#10&#10Commit: d8dc20aa9984d9c556f346e8cb4e306d799c6146 [d8dc20aa]&#10Author: w41bu1&#10Date: 2025-12-07 23:16:37"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>d8dc20aa</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-12-08-cve-2025-12887/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-12-08-CVE-2025-12887/index.vi.md?plain=1" title="Xem mã nguồn" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2025-12-08-CVE-2025-12887/index.vi.md" title="Chỉnh sửa trang này" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-12887&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-12887&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-12-08-CVE-2025-12887/index.vi.md?plain=1%7c" title="Báo cáo lỗi" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2025-12-08-CVE-2025-12887/index.vi.md" title="Mở trong trình chỉnh sửa" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/" data-title="CVE-2025-12887 Analysis &amp; POC" data-hashtags="analyst,plugin,broken access control"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/" data-title="CVE-2025-12887 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/broken-access-control/" class="post-tag" title="Nhãn - Broken Access Control">Broken Access Control</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-12-07-cve-2025-11726/" class="post-nav-item" rel="prev" title="CVE-2025-11726 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-11726 Analysis &amp; POC</a><a href="/vi/posts/2025-12-09-cve-2025-64384/" class="post-nav-item" rel="next" title="CVE-2025-64384 Analysis &amp; POC">CVE-2025-64384 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Nội dung</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/js/config/8f896ce4c504e5a6dddf76ced8e897fb.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
